{
  "sha": "237df8fe1863bb47fcf71ce125cd962666173aaa",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MjM3ZGY4ZmUxODYzYmI0N2ZjZjcxY2UxMjVjZDk2MjY2NjE3M2FhYQ==",
  "commit": {
    "author": {
      "name": "Sudakshina Das",
      "email": "sudi.das@arm.com",
      "date": "2019-06-06T11:27:41Z"
    },
    "committer": {
      "name": "Sudakshina Das",
      "email": "sudi.das@arm.com",
      "date": "2019-06-06T11:27:41Z"
    },
    "message": "[BFD, AArch64] Fix PT_GNU_PROPERTY alignment issue\n\nIf the new GNU property section was being created by the linker\n(this will happen only if none of the inputs have any GNU property\nsection but the command line to the linker forces a bti with\n--force-bti), the alignment of the section and hence the program\nheader of PT_GNU_PROPERTY type was not being set correctly. This\npatch fixes this issue.\n\nbfd/ChangeLog:\n\n2019-06-06  Sudakshina Das  <sudi.das@arm.com>\n\n\t* elfxx-aarch64.c (_bfd_aarch64_elf_link_setup_gnu_properties): Set\n\talignment of the new gnu property section.\n\nld/ChangeLog:\n\n2019-06-06  Sudakshina Das  <sudi.das@arm.com>\n\n\t* testsuite/ld-aarch64/aarch64-elf.exp: Add new tests.\n\t* testsuite/ld-aarch64/property-bti-pac4-a.d: New test.\n\t* testsuite/ld-aarch64/property-bti-pac4-b.d: New test.\n\t* testsuite/ld-aarch64/property-bti-pac4.s: New test.",
    "tree": {
      "sha": "7b4985f06381f82de4c47129c59ef8c8b8a72487",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/7b4985f06381f82de4c47129c59ef8c8b8a72487"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/237df8fe1863bb47fcf71ce125cd962666173aaa",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/237df8fe1863bb47fcf71ce125cd962666173aaa",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/237df8fe1863bb47fcf71ce125cd962666173aaa",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/237df8fe1863bb47fcf71ce125cd962666173aaa/comments",
  "author": {
    "login": "sudakshina-das-arm",
    "id": 28538945,
    "node_id": "MDQ6VXNlcjI4NTM4OTQ1",
    "avatar_url": "https://avatars.githubusercontent.com/u/28538945?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sudakshina-das-arm",
    "html_url": "https://github.com/sudakshina-das-arm",
    "followers_url": "https://api.github.com/users/sudakshina-das-arm/followers",
    "following_url": "https://api.github.com/users/sudakshina-das-arm/following{/other_user}",
    "gists_url": "https://api.github.com/users/sudakshina-das-arm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sudakshina-das-arm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sudakshina-das-arm/subscriptions",
    "organizations_url": "https://api.github.com/users/sudakshina-das-arm/orgs",
    "repos_url": "https://api.github.com/users/sudakshina-das-arm/repos",
    "events_url": "https://api.github.com/users/sudakshina-das-arm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sudakshina-das-arm/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "sudakshina-das-arm",
    "id": 28538945,
    "node_id": "MDQ6VXNlcjI4NTM4OTQ1",
    "avatar_url": "https://avatars.githubusercontent.com/u/28538945?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sudakshina-das-arm",
    "html_url": "https://github.com/sudakshina-das-arm",
    "followers_url": "https://api.github.com/users/sudakshina-das-arm/followers",
    "following_url": "https://api.github.com/users/sudakshina-das-arm/following{/other_user}",
    "gists_url": "https://api.github.com/users/sudakshina-das-arm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sudakshina-das-arm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sudakshina-das-arm/subscriptions",
    "organizations_url": "https://api.github.com/users/sudakshina-das-arm/orgs",
    "repos_url": "https://api.github.com/users/sudakshina-das-arm/repos",
    "events_url": "https://api.github.com/users/sudakshina-das-arm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sudakshina-das-arm/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "8bf6d176b0a442a8091d338d4af971591d19922c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8bf6d176b0a442a8091d338d4af971591d19922c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/8bf6d176b0a442a8091d338d4af971591d19922c"
    }
  ],
  "stats": {
    "total": 65,
    "additions": 65,
    "deletions": 0
  },
  "files": [
    {
      "sha": "058e971f78e73df5bfa628548bc4c7c609e81b86",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/237df8fe1863bb47fcf71ce125cd962666173aaa/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/237df8fe1863bb47fcf71ce125cd962666173aaa/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=237df8fe1863bb47fcf71ce125cd962666173aaa",
      "patch": "@@ -1,3 +1,8 @@\n+2019-06-06  Sudakshina Das  <sudi.das@arm.com>\n+\n+\t* elfxx-aarch64.c (_bfd_aarch64_elf_link_setup_gnu_properties): Set\n+\talignment of the new gnu property section.\n+\n 2019-06-06  Sudakshina Das  <sudi.das@arm.com>\n \n \t* bfd-in.h: Change comment."
    },
    {
      "sha": "33af6c22e16b7534ed2fcc8e499fafd498d6835e",
      "filename": "bfd/elfxx-aarch64.c",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/237df8fe1863bb47fcf71ce125cd962666173aaa/bfd/elfxx-aarch64.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/237df8fe1863bb47fcf71ce125cd962666173aaa/bfd/elfxx-aarch64.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-aarch64.c?ref=237df8fe1863bb47fcf71ce125cd962666173aaa",
      "patch": "@@ -695,6 +695,7 @@ _bfd_aarch64_elf_link_setup_gnu_properties (struct bfd_link_info *info,\n   bfd *pbfd;\n   bfd *ebfd = NULL;\n   elf_property *prop;\n+  unsigned align;\n \n   uint32_t gnu_prop = *gprop;\n \n@@ -743,6 +744,13 @@ _bfd_aarch64_elf_link_setup_gnu_properties (struct bfd_link_info *info,\n \t    info->callbacks->einfo (\n \t      _(\"%F%P: failed to create GNU property section\\n\"));\n \n+          align = (bfd_get_mach (ebfd) & bfd_mach_aarch64_ilp32) ? 2 : 3;\n+          if (!bfd_set_section_alignment (ebfd, sec, align))\n+            {\n+              info->callbacks->einfo (_(\"%F%pA: failed to align section\\n\"),\n+                                      sec);\n+            }\n+\n \t  elf_section_type (sec) = SHT_NOTE;\n \t}\n     }"
    },
    {
      "sha": "acbbf946378246dbbc81100083c96ac46dae2352",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=237df8fe1863bb47fcf71ce125cd962666173aaa",
      "patch": "@@ -1,3 +1,10 @@\n+2019-06-06  Sudakshina Das  <sudi.das@arm.com>\n+\n+\t* testsuite/ld-aarch64/aarch64-elf.exp: Add new tests.\n+\t* testsuite/ld-aarch64/property-bti-pac4-a.d: New test.\n+\t* testsuite/ld-aarch64/property-bti-pac4-b.d: New test.\n+\t* testsuite/ld-aarch64/property-bti-pac4.s: New test.\n+\n 2019-06-06  Sudakshina Das  <sudi.das@arm.com>\n \n \t* NEWS: Update options names."
    },
    {
      "sha": "d0a588c5f92158f4fa39ed0078c6abd1bd699a4d",
      "filename": "ld/testsuite/ld-aarch64/aarch64-elf.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/testsuite/ld-aarch64/aarch64-elf.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/testsuite/ld-aarch64/aarch64-elf.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/aarch64-elf.exp?ref=237df8fe1863bb47fcf71ce125cd962666173aaa",
      "patch": "@@ -381,6 +381,8 @@ run_dump_test_lp64 \"pie-bind-locally\"\n run_dump_test \"property-bti-pac1\"\n run_dump_test \"property-bti-pac2\"\n run_dump_test \"property-bti-pac3\"\n+run_dump_test \"property-bti-pac4-a\"\n+run_dump_test \"property-bti-pac4-b\"\n run_dump_test \"bti-plt-1\"\n run_dump_test \"bti-plt-2\"\n "
    },
    {
      "sha": "d9aa5cfa44b832bdc0d8668cf72df5d30885487c",
      "filename": "ld/testsuite/ld-aarch64/property-bti-pac4-a.d",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/testsuite/ld-aarch64/property-bti-pac4-a.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/testsuite/ld-aarch64/property-bti-pac4-a.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/property-bti-pac4-a.d?ref=237df8fe1863bb47fcf71ce125cd962666173aaa",
      "patch": "@@ -0,0 +1,11 @@\n+#name: PT_GNU_PROPERTY alignment\n+#source: property-bti-pac4.s\n+#as: -mabi=lp64\n+#ld: -z force-bti -e main\n+#readelf: -l --wide\n+#target: *linux*\n+#warning: .*property-bti-pac4.*: warning: BTI turned on by -z force-bti.*\n+\n+#...\n+  GNU_PROPERTY .* +0x8\n+#..."
    },
    {
      "sha": "02f9fc5acaf861a331ec899663c1dad60371f996",
      "filename": "ld/testsuite/ld-aarch64/property-bti-pac4-b.d",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/testsuite/ld-aarch64/property-bti-pac4-b.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/testsuite/ld-aarch64/property-bti-pac4-b.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/property-bti-pac4-b.d?ref=237df8fe1863bb47fcf71ce125cd962666173aaa",
      "patch": "@@ -0,0 +1,11 @@\n+#name: PT_GNU_PROPERTY alignment ILP32\n+#source: property-bti-pac4.s\n+#as: -mabi=ilp32\n+#ld: -m [aarch64_choose_ilp32_emul] -z force-bti -e main\n+#readelf: -l --wide\n+#target: *linux*\n+#warning: .*property-bti-pac4.*: warning: BTI turned on by -z force-bti.*\n+\n+#...\n+  GNU_PROPERTY .* +0x4\n+#..."
    },
    {
      "sha": "a1122ff8e653de2776bcc1902661482ad0e0ee66",
      "filename": "ld/testsuite/ld-aarch64/property-bti-pac4.s",
      "status": "added",
      "additions": 21,
      "deletions": 0,
      "changes": 21,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/testsuite/ld-aarch64/property-bti-pac4.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/237df8fe1863bb47fcf71ce125cd962666173aaa/ld/testsuite/ld-aarch64/property-bti-pac4.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/property-bti-pac4.s?ref=237df8fe1863bb47fcf71ce125cd962666173aaa",
      "patch": "@@ -0,0 +1,21 @@\n+\t.arch armv8-a\n+\t.file\t\"t.c\"\n+\t.text\n+\t.align\t2\n+\t.p2align 3,,7\n+\t.global\tf\n+\t.type\tf, %function\n+f:\n+\tadd\tw0, w0, 1\n+\tret\n+\t.size\tf, .-f\n+\t.section\t.text.startup,\"ax\",@progbits\n+\t.align\t2\n+\t.p2align 3,,7\n+\t.global\tmain\n+\t.type\tmain, %function\n+main:\n+\tmov\tw0, 6\n+\tret\n+\t.size\tmain, .-main\n+\t.section\t.note.GNU-stack,\"\",@progbits"
    }
  ]
}