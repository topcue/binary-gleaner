{
  "sha": "40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NDBkMjIwMzVhN2ZjMjM5YWMxZTk0NGI3NWEyZTNlZTkwMjlkMWI3Ng==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-05-26T09:35:32Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-05-26T09:35:32Z"
    },
    "message": "[gdb/testsuite] Add test-case gold-gdb-index.exp\n\nThere's a PR binutils/15646 - \"gold-generated .gdb_index has duplicated\nsymbols that gdb-generated index doesn't\", and gdb contains a workaround,\nadded in commit 8943b87476 \"Work around gold/15646\".\n\nAdd a test-case testing this workaround.\n\nTested on x86_64-linux.\n\ngdb/testsuite/ChangeLog:\n\n2020-05-26  Tom de Vries  <tdevries@suse.de>\n\n\t* gdb.base/gold-gdb-index-2.c: New test.\n\t* gdb.base/gold-gdb-index.c: New test.\n\t* gdb.base/gold-gdb-index.exp: New file.\n\t* gdb.base/gold-gdb-index.h: New test.",
    "tree": {
      "sha": "9b7444fb769efdbc09a4cdce15030edef5a8a717",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/9b7444fb769efdbc09a4cdce15030edef5a8a717"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "c6412eeea9de28f1a7c69c1ea2dc5d736642648f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c6412eeea9de28f1a7c69c1ea2dc5d736642648f",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c6412eeea9de28f1a7c69c1ea2dc5d736642648f"
    }
  ],
  "stats": {
    "total": 132,
    "additions": 132,
    "deletions": 0
  },
  "files": [
    {
      "sha": "5c297306d2a23fde93e937f7d98034f75ae6d912",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
      "patch": "@@ -1,3 +1,10 @@\n+2020-05-26  Tom de Vries  <tdevries@suse.de>\n+\n+\t* gdb.base/gold-gdb-index-2.c: New test.\n+\t* gdb.base/gold-gdb-index.c: New test.\n+\t* gdb.base/gold-gdb-index.exp: New file.\n+\t* gdb.base/gold-gdb-index.h: New test.\n+\n 2020-05-25  Tom de Vries  <tdevries@suse.de>\n \n \t* boards/gold-gdb-index.exp: New file."
    },
    {
      "sha": "2df637b55410126635feb306ef667f80b4c98aee",
      "filename": "gdb/testsuite/gdb.base/gold-gdb-index-2.c",
      "status": "added",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/gdb.base/gold-gdb-index-2.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/gdb.base/gold-gdb-index-2.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/gold-gdb-index-2.c?ref=40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
      "patch": "@@ -0,0 +1,23 @@\n+/* This testcase is part of GDB, the GNU debugger.\n+\n+   Copyright 2020 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n+\n+#include \"gold-gdb-index.h\"\n+\n+namespace N1\n+{\n+  void bar () { C1::baz (); }\n+}"
    },
    {
      "sha": "e0f8c2e4197c4e38f8c71bffe5d10454e184403d",
      "filename": "gdb/testsuite/gdb.base/gold-gdb-index.c",
      "status": "added",
      "additions": 29,
      "deletions": 0,
      "changes": 29,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/gdb.base/gold-gdb-index.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/gdb.base/gold-gdb-index.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/gold-gdb-index.c?ref=40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
      "patch": "@@ -0,0 +1,29 @@\n+/* This testcase is part of GDB, the GNU debugger.\n+\n+   Copyright 2020 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n+\n+#include \"gold-gdb-index.h\"\n+\n+namespace N1\n+{\n+  void foo () { C1::baz (); }\n+}\n+\n+int\n+main ()\n+{\n+  return 0;\n+}"
    },
    {
      "sha": "e42bf439dd585f510698c3a7c62f18a63dd293b3",
      "filename": "gdb/testsuite/gdb.base/gold-gdb-index.exp",
      "status": "added",
      "additions": 48,
      "deletions": 0,
      "changes": 48,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/gdb.base/gold-gdb-index.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/gdb.base/gold-gdb-index.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/gold-gdb-index.exp?ref=40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
      "patch": "@@ -0,0 +1,48 @@\n+# Copyright 2020 Free Software Foundation, Inc.\n+\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n+\n+# This tests the gdb workaround for PR binutils/15646.\n+\n+standard_testfile .c gold-gdb-index-2.c\n+\n+if {[prepare_for_testing \"failed to prepare\" $testfile \"$srcfile $srcfile2\" \\\n+\t {debug c++ additional_flags=-fuse-ld=gold \\\n+\t      additional_flags=-Wl,--gdb-index \\\n+\t      additional_flags=-ggnu-pubnames}]} {\n+    return -1\n+}\n+\n+if { [readnow] } {\n+    return -1\n+}\n+\n+gdb_test_no_output \"set auto-solib-add off\"\n+\n+if ![runto_main] then {\n+    fail \"can't run to main\"\n+    return 0\n+}\n+\n+gdb_test_no_output \"set breakpoint pending off\"\n+gdb_test \"break N1::misspelled\" \"Function \\\"N1::misspelled\\\" not defined\\.\"\n+\n+gdb_test_multiple \"maint info symtabs\" \"\" {\n+    -re -wrap \"\\{ symtab \\[^\\r\\n\\]*gold-gdb-index-2.c.*\" {\n+\tfail $gdb_test_name\n+    }\n+    -re -wrap \"\" {\n+\tpass $gdb_test_name\n+    }\n+}"
    },
    {
      "sha": "81ebb7b16a51ab4d165e0df1516336b4da9ac829",
      "filename": "gdb/testsuite/gdb.base/gold-gdb-index.h",
      "status": "added",
      "additions": 25,
      "deletions": 0,
      "changes": 25,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/gdb.base/gold-gdb-index.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/40d22035a7fc239ac1e944b75a2e3ee9029d1b76/gdb/testsuite/gdb.base/gold-gdb-index.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/gold-gdb-index.h?ref=40d22035a7fc239ac1e944b75a2e3ee9029d1b76",
      "patch": "@@ -0,0 +1,25 @@\n+/* This testcase is part of GDB, the GNU debugger.\n+\n+   Copyright 2020 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n+\n+namespace N1\n+{\n+  class C1\n+  {\n+   public:\n+    static void baz () {}\n+  };\n+}"
    }
  ]
}