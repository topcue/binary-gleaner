{
  "sha": "cfc16775b7678e1ad8f9fce048652defd78e3787",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6Y2ZjMTY3NzViNzY3OGUxYWQ4ZjlmY2UwNDg2NTJkZWZkNzhlMzc4Nw==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-06-27T03:17:45Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-06-27T03:25:35Z"
    },
    "message": "asan: readelf: use after free in process_archive\n\nThis tidies up in cases where fuzzed thin archives hit the error return\npath in setup_nested_archive.\n\n\t* elfcomm.c (setup_nested_archive): Set nested_arch->file to NULL\n\tafter freeing.\n\t(release_archive): Set fields of arch to NULL after freeing.",
    "tree": {
      "sha": "c96a499b820e11d40ef063f32dd3e8243f47ff0b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c96a499b820e11d40ef063f32dd3e8243f47ff0b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/cfc16775b7678e1ad8f9fce048652defd78e3787",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cfc16775b7678e1ad8f9fce048652defd78e3787",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/cfc16775b7678e1ad8f9fce048652defd78e3787",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cfc16775b7678e1ad8f9fce048652defd78e3787/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "aa57a9d3b6b471e665639a6d927061cbf2529e2e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/aa57a9d3b6b471e665639a6d927061cbf2529e2e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/aa57a9d3b6b471e665639a6d927061cbf2529e2e"
    }
  ],
  "stats": {
    "total": 15,
    "additions": 14,
    "deletions": 1
  },
  "files": [
    {
      "sha": "13d9c3e0576a967358ff5dfdf085120aaf2c6759",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cfc16775b7678e1ad8f9fce048652defd78e3787/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cfc16775b7678e1ad8f9fce048652defd78e3787/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=cfc16775b7678e1ad8f9fce048652defd78e3787",
      "patch": "@@ -1,3 +1,9 @@\n+2020-06-27  Alan Modra  <amodra@gmail.com>\n+\n+\t* elfcomm.c (setup_nested_archive): Set nested_arch->file to NULL\n+\tafter freeing.\n+\t(release_archive): Set fields of arch to NULL after freeing.\n+\n 2020-06-26  Nick Alcock  <nick.alcock@oracle.com>\n \n \t* readelf.c (dump_section_as_ctf): Support .ctf archives using"
    },
    {
      "sha": "37f9dbe7eef7c096b768d06455f4613e2a2a6726",
      "filename": "binutils/elfcomm.c",
      "status": "modified",
      "additions": 8,
      "deletions": 1,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cfc16775b7678e1ad8f9fce048652defd78e3787/binutils/elfcomm.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cfc16775b7678e1ad8f9fce048652defd78e3787/binutils/elfcomm.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/elfcomm.c?ref=cfc16775b7678e1ad8f9fce048652defd78e3787",
      "patch": "@@ -727,7 +727,10 @@ setup_nested_archive (struct archive_info *nested_arch,\n \n   /* Close previous file and discard cached information.  */\n   if (nested_arch->file != NULL)\n-    fclose (nested_arch->file);\n+    {\n+      fclose (nested_arch->file);\n+      nested_arch->file = NULL;\n+    }\n   release_archive (nested_arch);\n \n   member_file = fopen (member_file_name, \"rb\");\n@@ -748,6 +751,10 @@ release_archive (struct archive_info * arch)\n   free (arch->index_array);\n   free (arch->sym_table);\n   free (arch->longnames);\n+  arch->file_name = NULL;\n+  arch->index_array = NULL;\n+  arch->sym_table = NULL;\n+  arch->longnames = NULL;\n }\n \n /* Get the name of an archive member from the current archive header."
    }
  ]
}