{
  "sha": "7770da971420cd3327326b6b8720383d23b5dbd3",
  "node_id": "C_kwDOANOeidoAKDc3NzBkYTk3MTQyMGNkMzMyNzMyNmI2Yjg3MjAzODNkMjNiNWRiZDM",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-11-15T08:32:26Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-11-15T08:32:26Z"
    },
    "message": "sim: run: fix crash in argc==0 error situation\n\nThe new argv processing code assumed that we were always passed a\ncommand line.  If we weren't, make sure we don't crash before we\nget a chance to output an error message about incorrect usage.",
    "tree": {
      "sha": "d27d8a7c92f3cbb05629357f6dee87db148c260b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d27d8a7c92f3cbb05629357f6dee87db148c260b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/7770da971420cd3327326b6b8720383d23b5dbd3",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7770da971420cd3327326b6b8720383d23b5dbd3",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/7770da971420cd3327326b6b8720383d23b5dbd3",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7770da971420cd3327326b6b8720383d23b5dbd3/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "145a603abc767c2a1e6fe7755c10686353bbcc8f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/145a603abc767c2a1e6fe7755c10686353bbcc8f",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/145a603abc767c2a1e6fe7755c10686353bbcc8f"
    }
  ],
  "stats": {
    "total": 24,
    "additions": 17,
    "deletions": 7
  },
  "files": [
    {
      "sha": "17e550e55577ee47b87a95a81c54e84e16afb1b9",
      "filename": "sim/common/sim-options.c",
      "status": "modified",
      "additions": 17,
      "deletions": 7,
      "changes": 24,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7770da971420cd3327326b6b8720383d23b5dbd3/sim/common/sim-options.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7770da971420cd3327326b6b8720383d23b5dbd3/sim/common/sim-options.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/sim-options.c?ref=7770da971420cd3327326b6b8720383d23b5dbd3",
      "patch": "@@ -615,16 +615,26 @@ sim_parse_args (SIM_DESC sd, char * const *argv)\n \t{\n \t  if (STATE_OPEN_KIND (sd) == SIM_OPEN_STANDALONE)\n \t    {\n-\t      char **new_argv = dupargv (argv + optind);\n+\t      char **new_argv;\n \n-\t      STATE_PROG_FILE (sd) = xstrdup (argv[optind]);\n-\t      if (STATE_PROG_ARGV0 (sd) != NULL)\n-\t\t{\n-\t\t  free (new_argv[0]);\n-\t\t  new_argv[0] = xstrdup (STATE_PROG_ARGV0 (sd));\n-\t\t}\n+\t      free (STATE_PROG_FILE (sd));\n+\t      STATE_PROG_FILE (sd) = NULL;\n+\n+\t      new_argv = dupargv (argv + optind);\n \t      freeargv (STATE_PROG_ARGV (sd));\n \t      STATE_PROG_ARGV (sd) = new_argv;\n+\n+\t      /* Skip steps when argc == 0.  */\n+\t      if (argv[optind] != NULL)\n+\t\t{\n+\t\t  STATE_PROG_FILE (sd) = xstrdup (argv[optind]);\n+\n+\t\t  if (STATE_PROG_ARGV0 (sd) != NULL)\n+\t\t    {\n+\t\t      free (new_argv[0]);\n+\t\t      new_argv[0] = xstrdup (STATE_PROG_ARGV0 (sd));\n+\t\t    }\n+\t\t}\n \t    }\n \t  break;\n \t}"
    }
  ]
}