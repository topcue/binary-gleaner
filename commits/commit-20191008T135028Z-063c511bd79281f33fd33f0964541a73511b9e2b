{
  "sha": "063c511bd79281f33fd33f0964541a73511b9e2b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDYzYzUxMWJkNzkyODFmMzNmZDMzZjA5NjQ1NDFhNzM1MTFiOWUyYg==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-10-08T13:37:29Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-10-08T13:50:28Z"
    },
    "message": "PR25078, stack overflow in function find_abstract_instance\n\n\tPR 25078\n\t* dwarf2.c (find_abstract_instance): Delete orig_info_ptr, add\n\trecur_count.  Error on recur_count reaching 100 rather than\n\tinfo_ptr matching orig_info_ptr.  Adjust calls.",
    "tree": {
      "sha": "203f7f0c9a4d8e444d304afde27dc8552405c0ee",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/203f7f0c9a4d8e444d304afde27dc8552405c0ee"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/063c511bd79281f33fd33f0964541a73511b9e2b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/063c511bd79281f33fd33f0964541a73511b9e2b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/063c511bd79281f33fd33f0964541a73511b9e2b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/063c511bd79281f33fd33f0964541a73511b9e2b/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "6446511295653d9b18e940d1d4757ccbe358879e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6446511295653d9b18e940d1d4757ccbe358879e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/6446511295653d9b18e940d1d4757ccbe358879e"
    }
  ],
  "stats": {
    "total": 42,
    "additions": 24,
    "deletions": 18
  },
  "files": [
    {
      "sha": "cf5b372860359e1ef9f7ecd262c00b86db94c17d",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/063c511bd79281f33fd33f0964541a73511b9e2b/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/063c511bd79281f33fd33f0964541a73511b9e2b/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=063c511bd79281f33fd33f0964541a73511b9e2b",
      "patch": "@@ -1,3 +1,10 @@\n+2019-10-08  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 25078\n+\t* dwarf2.c (find_abstract_instance): Delete orig_info_ptr, add\n+\trecur_count.  Error on recur_count reaching 100 rather than\n+\tinfo_ptr matching orig_info_ptr.  Adjust calls.\n+\n 2019-10-07  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n \n \t* elf32-msp430.c (elf32_msp430_merge_mspabi_attributes): Rename to.."
    },
    {
      "sha": "d39f4fdfe4b8bc3d3e9bbbd691c59b6abb6a3255",
      "filename": "bfd/dwarf2.c",
      "status": "modified",
      "additions": 17,
      "deletions": 18,
      "changes": 35,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/063c511bd79281f33fd33f0964541a73511b9e2b/bfd/dwarf2.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/063c511bd79281f33fd33f0964541a73511b9e2b/bfd/dwarf2.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/dwarf2.c?ref=063c511bd79281f33fd33f0964541a73511b9e2b",
      "patch": "@@ -2812,13 +2812,13 @@ static bfd_boolean comp_unit_maybe_decode_line_info (struct comp_unit *,\n \t\t\t\t\t\t     struct dwarf2_debug *);\n \n static bfd_boolean\n-find_abstract_instance (struct comp_unit *   unit,\n-\t\t\tbfd_byte *           orig_info_ptr,\n-\t\t\tstruct attribute *   attr_ptr,\n-\t\t\tconst char **        pname,\n-\t\t\tbfd_boolean *        is_linkage,\n-\t\t\tchar **              filename_ptr,\n-\t\t\tint *                linenumber_ptr)\n+find_abstract_instance (struct comp_unit *unit,\n+\t\t\tstruct attribute *attr_ptr,\n+\t\t\tunsigned int recur_count,\n+\t\t\tconst char **pname,\n+\t\t\tbfd_boolean *is_linkage,\n+\t\t\tchar **filename_ptr,\n+\t\t\tint *linenumber_ptr)\n {\n   bfd *abfd = unit->abfd;\n   bfd_byte *info_ptr;\n@@ -2829,6 +2829,14 @@ find_abstract_instance (struct comp_unit *   unit,\n   struct attribute attr;\n   const char *name = NULL;\n \n+  if (recur_count == 100)\n+    {\n+      _bfd_error_handler\n+\t(_(\"DWARF error: abstract instance recursion detected\"));\n+      bfd_set_error (bfd_error_bad_value);\n+      return FALSE;\n+    }\n+\n   /* DW_FORM_ref_addr can reference an entry in a different CU. It\n      is an offset from the .debug_info section, not the current CU.  */\n   if (attr_ptr->form == DW_FORM_ref_addr)\n@@ -2962,15 +2970,6 @@ find_abstract_instance (struct comp_unit *   unit,\n \t\t\t\t\t info_ptr, info_ptr_end);\n \t      if (info_ptr == NULL)\n \t\tbreak;\n-\t      /* It doesn't ever make sense for DW_AT_specification to\n-\t\t refer to the same DIE.  Stop simple recursion.  */\n-\t      if (info_ptr == orig_info_ptr)\n-\t\t{\n-\t\t  _bfd_error_handler\n-\t\t    (_(\"DWARF error: abstract instance recursion detected\"));\n-\t\t  bfd_set_error (bfd_error_bad_value);\n-\t\t  return FALSE;\n-\t\t}\n \t      switch (attr.name)\n \t\t{\n \t\tcase DW_AT_name:\n@@ -2984,7 +2983,7 @@ find_abstract_instance (struct comp_unit *   unit,\n \t\t    }\n \t\t  break;\n \t\tcase DW_AT_specification:\n-\t\t  if (!find_abstract_instance (unit, info_ptr, &attr,\n+\t\t  if (!find_abstract_instance (unit, &attr, recur_count + 1,\n \t\t\t\t\t       &name, is_linkage,\n \t\t\t\t\t       filename_ptr, linenumber_ptr))\n \t\t    return FALSE;\n@@ -3200,7 +3199,7 @@ scan_unit_for_symbols (struct comp_unit *unit)\n \n \t\tcase DW_AT_abstract_origin:\n \t\tcase DW_AT_specification:\n-\t\t  if (!find_abstract_instance (unit, info_ptr, &attr,\n+\t\t  if (!find_abstract_instance (unit, &attr, 0,\n \t\t\t\t\t       &func->name,\n \t\t\t\t\t       &func->is_linkage,\n \t\t\t\t\t       &func->file,"
    }
  ]
}