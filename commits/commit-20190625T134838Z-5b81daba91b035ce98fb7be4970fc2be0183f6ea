{
  "sha": "5b81daba91b035ce98fb7be4970fc2be0183f6ea",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NWI4MWRhYmE5MWIwMzVjZTk4ZmI3YmU0OTcwZmMyYmUwMTgzZjZlYQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-06-16T22:28:12Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-06-25T13:48:38Z"
    },
    "message": "Introduce refresh_window method\n\nThis replaces tui_refresh_win with a new refresh_window method.  This\nremoves another spot that was checking the window's type.\n\ngdb/ChangeLog\n2019-06-25  Tom Tromey  <tom@tromey.com>\n\n\t* tui/tui-winsource.c (tui_erase_source_content)\n\t(tui_show_source_content, tui_show_exec_info_content)\n\t(tui_erase_exec_info_content): Use refresh_window method.\n\t* tui/tui-wingeneral.h (tui_refresh_win): Don't declare.\n\t* tui/tui-wingeneral.c (tui_gen_win_info::refresh_window): Rename\n\tfrom tui_refresh_win.\n\t(tui_data_window::refresh_window): New method.\n\t(tui_win_info::refresh, tui_source_window_base::refresh)\n\t(tui_refresh_all): Use refresh_window method.\n\t* tui/tui-stack.c (tui_show_locator_content): Call refresh_window\n\tmethod.\n\t* tui/tui-regs.c (tui_display_register): Call refresh_window\n\tmethod.\n\t* tui/tui-layout.c (show_source_disasm_command)\n\t(show_source_or_disasm_and_command): Call refresh_window method.\n\t* tui/tui-data.h (struct tui_gen_win_info)\n\t(struct tui_data_window, struct tui_cmd_window) <refresh_window>:\n\tNew method.",
    "tree": {
      "sha": "95b05f93cccf3058b358619c00276272ecf23097",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/95b05f93cccf3058b358619c00276272ecf23097"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/5b81daba91b035ce98fb7be4970fc2be0183f6ea",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5b81daba91b035ce98fb7be4970fc2be0183f6ea",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/5b81daba91b035ce98fb7be4970fc2be0183f6ea",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5b81daba91b035ce98fb7be4970fc2be0183f6ea/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "cb2ce89305264543a4014d98bacb26800d92d394",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cb2ce89305264543a4014d98bacb26800d92d394",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/cb2ce89305264543a4014d98bacb26800d92d394"
    }
  ],
  "stats": {
    "total": 89,
    "additions": 58,
    "deletions": 31
  },
  "files": [
    {
      "sha": "25c2d01adc513606ecde719dfca22360bb3a89a2",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 21,
      "deletions": 0,
      "changes": 21,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=5b81daba91b035ce98fb7be4970fc2be0183f6ea",
      "patch": "@@ -1,3 +1,24 @@\n+2019-06-25  Tom Tromey  <tom@tromey.com>\n+\n+\t* tui/tui-winsource.c (tui_erase_source_content)\n+\t(tui_show_source_content, tui_show_exec_info_content)\n+\t(tui_erase_exec_info_content): Use refresh_window method.\n+\t* tui/tui-wingeneral.h (tui_refresh_win): Don't declare.\n+\t* tui/tui-wingeneral.c (tui_gen_win_info::refresh_window): Rename\n+\tfrom tui_refresh_win.\n+\t(tui_data_window::refresh_window): New method.\n+\t(tui_win_info::refresh, tui_source_window_base::refresh)\n+\t(tui_refresh_all): Use refresh_window method.\n+\t* tui/tui-stack.c (tui_show_locator_content): Call refresh_window\n+\tmethod.\n+\t* tui/tui-regs.c (tui_display_register): Call refresh_window\n+\tmethod.\n+\t* tui/tui-layout.c (show_source_disasm_command)\n+\t(show_source_or_disasm_and_command): Call refresh_window method.\n+\t* tui/tui-data.h (struct tui_gen_win_info)\n+\t(struct tui_data_window, struct tui_cmd_window) <refresh_window>:\n+\tNew method.\n+\n 2019-06-25  Tom Tromey  <tom@tromey.com>\n \n \t* tui/tui.c (tui_rl_other_window, tui_enable)"
    },
    {
      "sha": "8f77c9d4e07b09cfb9ed71ff5901c9ecd8c73f29",
      "filename": "gdb/tui/tui-data.h",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-data.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-data.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-data.h?ref=5b81daba91b035ce98fb7be4970fc2be0183f6ea",
      "patch": "@@ -48,6 +48,9 @@ struct tui_gen_win_info\n   {\n   }\n \n+  /* Call to refresh this window.  */\n+  virtual void refresh_window ();\n+\n   /* Window handle.  */\n   WINDOW *handle = nullptr;\n   /* Type of window.  */\n@@ -418,6 +421,8 @@ struct tui_data_window : public tui_win_info\n \n   void set_new_height (int height) override;\n \n+  void refresh_window () override;\n+\n   /* Start of data display content.  */\n   tui_win_content data_content = NULL;\n   int data_content_count = 0;\n@@ -456,6 +461,10 @@ struct tui_cmd_window : public tui_win_info\n \n   int max_height () const override;\n \n+  void refresh_window () override\n+  {\n+  }\n+\n   int start_line = 0;\n \n protected:"
    },
    {
      "sha": "d9e1617f19a7692a4da8ef16003a073fe887b687",
      "filename": "gdb/tui/tui-layout.c",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-layout.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-layout.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-layout.c?ref=5b81daba91b035ce98fb7be4970fc2be0183f6ea",
      "patch": "@@ -701,7 +701,7 @@ show_source_disasm_command (void)\n \t  TUI_CMD_WIN->can_highlight = false;\n \t  tui_make_visible (TUI_CMD_WIN);\n \t}\n-      tui_refresh_win (TUI_CMD_WIN);\n+      TUI_CMD_WIN->refresh_window ();\n       tui_set_current_layout_to (SRC_DISASSEM_COMMAND);\n     }\n }\n@@ -956,7 +956,7 @@ show_source_or_disasm_and_command (enum tui_layout_type layout_type)\n \t{\n \t  tui_win_list[CMD_WIN] = make_command_window (cmd_height,\n \t\t\t\t\t\t       src_height);\n-\t  tui_refresh_win (TUI_CMD_WIN);\n+\t  TUI_CMD_WIN->refresh_window ();\n \t}\n       else\n \t{"
    },
    {
      "sha": "c748d513fc34309d80e63b847a8c807057c1356b",
      "filename": "gdb/tui/tui-regs.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-regs.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-regs.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-regs.c?ref=5b81daba91b035ce98fb7be4970fc2be0183f6ea",
      "patch": "@@ -534,7 +534,7 @@ tui_display_register (struct tui_data_element *data,\n \t   to code that causes the compiler to generate an unused-value\n \t   warning.  */\n \t(void) wstandend (win_info->handle);\n-      tui_refresh_win (win_info);\n+      win_info->refresh_window ();\n     }\n }\n "
    },
    {
      "sha": "efa24453b6528a06b5a2dab4c15addd5b02963b1",
      "filename": "gdb/tui/tui-stack.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-stack.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-stack.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-stack.c?ref=5b81daba91b035ce98fb7be4970fc2be0183f6ea",
      "patch": "@@ -267,7 +267,7 @@ tui_show_locator_content (void)\n       waddstr (locator->handle, string);\n       wclrtoeol (locator->handle);\n       (void) wstandend (locator->handle);\n-      tui_refresh_win (locator);\n+      locator->refresh_window ();\n       wmove (locator->handle, 0, 0);\n       xfree (string);\n       locator->content_in_use = TRUE;"
    },
    {
      "sha": "f1089a9f38a09f09ffdc65aea282784f68f7c312",
      "filename": "gdb/tui/tui-wingeneral.c",
      "status": "modified",
      "additions": 19,
      "deletions": 21,
      "changes": 40,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-wingeneral.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-wingeneral.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-wingeneral.c?ref=5b81daba91b035ce98fb7be4970fc2be0183f6ea",
      "patch": "@@ -31,38 +31,36 @@\n ** PUBLIC FUNCTIONS\n ***********************/\n \n-/* Refresh the window.  */\n+/* See tui-data.h.  */\n+\n void\n-tui_refresh_win (struct tui_gen_win_info *win_info)\n+tui_gen_win_info::refresh_window ()\n {\n-  if (win_info->type == DATA_WIN && win_info->content_size > 0)\n-    {\n-      int i;\n+  if (handle != NULL)\n+    wrefresh (handle);\n+}\n \n-      for (i = 0; (i < win_info->content_size); i++)\n+/* See tui-data.h.  */\n+\n+void\n+tui_data_window::refresh_window ()\n+{\n+  if (content_size > 0)\n+    {\n+      for (int i = 0; i < content_size; i++)\n \t{\n \t  struct tui_gen_win_info *data_item_win_ptr;\n \n-\t  data_item_win_ptr = win_info->content[i]->which_element.data_window;\n+\t  data_item_win_ptr = content[i]->which_element.data_window;\n \t  if (data_item_win_ptr != NULL\n \t      && data_item_win_ptr->handle != NULL)\n \t    wrefresh (data_item_win_ptr->handle);\n \t}\n     }\n-  else if (win_info->type == CMD_WIN)\n-    {\n-      /* Do nothing.  */\n-    }\n   else\n-    {\n-      if (win_info->handle != NULL)\n-\twrefresh (win_info->handle);\n-    }\n-\n-  return;\n+    tui_gen_win_info::refresh_window ();\n }\n \n-\n /* Function to delete the curses window, checking for NULL.  */\n void\n tui_delete_win (WINDOW *window)\n@@ -260,7 +258,7 @@ void\n tui_win_info::refresh ()\n {\n   touchwin (handle);\n-  tui_refresh_win (this);\n+  refresh_window ();\n }\n \n /* See tui-data.h.  */\n@@ -269,7 +267,7 @@ void\n tui_source_window_base::refresh ()\n {\n   touchwin (execution_info->handle);\n-  tui_refresh_win (execution_info);\n+  execution_info->refresh_window ();\n   tui_win_info::refresh ();\n }\n \n@@ -289,7 +287,7 @@ tui_refresh_all (struct tui_win_info **list)\n   if (locator->is_visible)\n     {\n       touchwin (locator->handle);\n-      tui_refresh_win (locator);\n+      locator->refresh_window ();\n     }\n }\n "
    },
    {
      "sha": "15e61c94166d284450eba1211397e3860fe6411f",
      "filename": "gdb/tui/tui-wingeneral.h",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-wingeneral.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-wingeneral.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-wingeneral.h?ref=5b81daba91b035ce98fb7be4970fc2be0183f6ea",
      "patch": "@@ -39,6 +39,5 @@ extern void tui_highlight_win (struct tui_win_info *);\n extern void tui_check_and_display_highlight_if_needed (struct tui_win_info *);\n extern void tui_refresh_all (struct tui_win_info **);\n extern void tui_delete_win (WINDOW *window);\n-extern void tui_refresh_win (struct tui_gen_win_info *);\n \n #endif /* TUI_TUI_WINGENERAL_H */"
    },
    {
      "sha": "254c7e00dcb3392c87db89af53d06c725385fbfd",
      "filename": "gdb/tui/tui-winsource.c",
      "status": "modified",
      "additions": 5,
      "deletions": 5,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-winsource.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5b81daba91b035ce98fb7be4970fc2be0183f6ea/gdb/tui/tui-winsource.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-winsource.c?ref=5b81daba91b035ce98fb7be4970fc2be0183f6ea",
      "patch": "@@ -260,7 +260,7 @@ tui_erase_source_content (struct tui_win_info *win_info,\n \n \t  tui_set_source_content_nil (win_info, no_src_str);\n \t}\n-      tui_refresh_win (win_info);\n+      win_info->refresh_window ();\n     }\n }\n \n@@ -305,7 +305,7 @@ tui_show_source_content (struct tui_win_info *win_info)\n     tui_erase_source_content (win_info, TRUE);\n \n   tui_check_and_display_highlight_if_needed (win_info);\n-  tui_refresh_win (win_info);\n+  win_info->refresh_window ();\n   win_info->content_in_use = TRUE;\n }\n \n@@ -550,14 +550,14 @@ tui_show_exec_info_content (struct tui_win_info *win_info)\n   int cur_line;\n \n   werase (exec_info->handle);\n-  tui_refresh_win (exec_info);\n+  exec_info->refresh_window ();\n   for (cur_line = 1; (cur_line <= exec_info->content_size); cur_line++)\n     mvwaddstr (exec_info->handle,\n \t       cur_line,\n \t       0,\n \t       (char *) exec_info->content[cur_line - 1]\n \t\t\t  ->which_element.simple_string);\n-  tui_refresh_win (exec_info);\n+  exec_info->refresh_window ();\n   exec_info->content_in_use = TRUE;\n }\n \n@@ -569,7 +569,7 @@ tui_erase_exec_info_content (struct tui_win_info *win_info)\n   struct tui_gen_win_info *exec_info = base->execution_info;\n \n   werase (exec_info->handle);\n-  tui_refresh_win (exec_info);\n+  exec_info->refresh_window ();\n }\n \n void"
    }
  ]
}