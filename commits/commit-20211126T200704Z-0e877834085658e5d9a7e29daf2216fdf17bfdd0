{
  "sha": "0e877834085658e5d9a7e29daf2216fdf17bfdd0",
  "node_id": "C_kwDOANOeidoAKDBlODc3ODM0MDg1NjU4ZTVkOWE3ZTI5ZGFmMjIxNmZkZjE3YmZkZDA",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-11-22T04:05:32Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-11-26T20:07:04Z"
    },
    "message": "sim: testsuite: replace global_as_options with ASFLAGS_FOR_TARGET\n\nOnly a few tests actually use global_as_options, but we can replace the\nsim-specific settings with the dejagnu common ASFLAGS_FOR_TARGET and get\nthe same result.",
    "tree": {
      "sha": "16ed2d340271e22ead763133c6a828b3a7c9d5d0",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/16ed2d340271e22ead763133c6a828b3a7c9d5d0"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0e877834085658e5d9a7e29daf2216fdf17bfdd0",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0e877834085658e5d9a7e29daf2216fdf17bfdd0",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0e877834085658e5d9a7e29daf2216fdf17bfdd0",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0e877834085658e5d9a7e29daf2216fdf17bfdd0/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "f8080fb7a44b0a3a9699c188015106bc4b16076f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f8080fb7a44b0a3a9699c188015106bc4b16076f",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/f8080fb7a44b0a3a9699c188015106bc4b16076f"
    }
  ],
  "stats": {
    "total": 26,
    "additions": 8,
    "deletions": 18
  },
  "files": [
    {
      "sha": "908d56ab92d9aeca4864a71f9bd1a4197f99fd94",
      "filename": "sim/testsuite/cris/hw/rv-n-cris/rvc.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 6,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e877834085658e5d9a7e29daf2216fdf17bfdd0/sim/testsuite/cris/hw/rv-n-cris/rvc.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e877834085658e5d9a7e29daf2216fdf17bfdd0/sim/testsuite/cris/hw/rv-n-cris/rvc.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/testsuite/cris/hw/rv-n-cris/rvc.exp?ref=0e877834085658e5d9a7e29daf2216fdf17bfdd0",
      "patch": "@@ -21,7 +21,6 @@\n proc sim_has_rv_and_cris {} {\n     global srcdir\n     global subdir\n-    global global_as_options\n     global global_ld_options\n     global global_sim_options\n \n@@ -32,9 +31,6 @@ proc sim_has_rv_and_cris {} {\n     # what we want to do it to run the simulator without affecting the\n     # PASS/FAIL counters, and we can use e.g. run_sim_test for that.\n \n-    if ![info exists global_as_options] {\n-        set global_as_options \"\"\n-    }\n     if ![info exists global_ld_options] {\n         set global_ld_options \"\"\n     }\n@@ -43,7 +39,7 @@ proc sim_has_rv_and_cris {} {\n     }\n \n     set comp_output [target_assemble $srcdir/$subdir/quit.s quit.o \\\n-\t\t\t \"-I$srcdir/$subdir $global_as_options\"]\n+\t\t\t \"-I$srcdir/$subdir\"]\n \n     if ![string match \"\" $comp_output] {\n \tverbose -log \"$comp_output\" 3\n@@ -119,7 +115,6 @@ proc slurp_rv { file } {\n if [istarget cris*-*-*] {\n     global ASFLAGS_FOR_TARGET\n     set has_rv_and_cris [sim_has_rv_and_cris]\n-    global global_as_options\n     global global_ld_options\n     global global_sim_options\n "
    },
    {
      "sha": "68fe2ef3324aa4ef3d6e5039ef22e4060694e87f",
      "filename": "sim/testsuite/lib/sim-defs.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 6,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e877834085658e5d9a7e29daf2216fdf17bfdd0/sim/testsuite/lib/sim-defs.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e877834085658e5d9a7e29daf2216fdf17bfdd0/sim/testsuite/lib/sim-defs.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/testsuite/lib/sim-defs.exp?ref=0e877834085658e5d9a7e29daf2216fdf17bfdd0",
      "patch": "@@ -185,7 +185,6 @@ proc run_sim_test { name requested_machs } {\n     global opts\n     global cpu_option\n     global cpu_option_sep\n-    global global_as_options\n     global global_ld_options\n     global global_sim_options\n \n@@ -221,9 +220,6 @@ proc run_sim_test { name requested_machs } {\n     set opts(kfail) \"\"\n     set seen_output 0\n \n-    if ![info exists global_as_options] {\n-        set global_as_options \"\"\n-    }\n     if ![info exists global_ld_options] {\n         set global_ld_options \"\"\n     }\n@@ -324,7 +320,7 @@ proc run_sim_test { name requested_machs } {\n \t    }\n \t    set as_options \"$as_options $cpu_option$sep$mach\"\n \t}\n-\tregsub {(^ *| +)([^ ]+)} \"$as_options $global_as_options\" { -Wa,\\2} c_as_options\n+\tregsub {(^ *| +)([^ ]+)} \"$as_options\" { -Wa,\\2} c_as_options\n \n \tif ![info exists opts(ld,$mach)] {\n \t    set opts(ld,$mach) $opts(ld)\n@@ -345,7 +341,7 @@ proc run_sim_test { name requested_machs } {\n \t\t    [list \"incdir=$srcdir/$subdir\" \"additional_flags=$c_as_options\"]]\n \t\tset method \"compiling\"\n \t    } else {\n-\t\tset comp_output [target_assemble $sourcefile ${name}.o \"$as_options $global_as_options\"]\n+\t\tset comp_output [target_assemble $sourcefile ${name}.o \"$as_options\"]\n \t\tset method \"assembling\"\n \t    }\n "
    },
    {
      "sha": "ff96a683589bbed1980d2747b1ea090df670a715",
      "filename": "sim/testsuite/mips/basic.exp",
      "status": "modified",
      "additions": 3,
      "deletions": 4,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e877834085658e5d9a7e29daf2216fdf17bfdd0/sim/testsuite/mips/basic.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e877834085658e5d9a7e29daf2216fdf17bfdd0/sim/testsuite/mips/basic.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/testsuite/mips/basic.exp?ref=0e877834085658e5d9a7e29daf2216fdf17bfdd0",
      "patch": "@@ -27,11 +27,10 @@ proc run_hilo_test {testfile models nops} {\n \n # Runs micromips tests by adding -mmicromips to as options\n proc run_micromips_test { name requested_machs } {\n-    global global_as_options;\n-    set gas_old $global_as_options;\n-    append global_as_options \" -mmicromips \"\n+    global ASFLAGS_FOR_TARGET\n+    set ASFLAGS_FOR_TARGET \"-mmicromips\"\n     run_sim_test $name $requested_machs\n-    set global_as_options $gas_old\n+    unset ASFLAGS_FOR_TARGET\n }\n \n # Runs all specified tests"
    },
    {
      "sha": "233cd9a6ff99483448d6a68f8b095382fa6b1192",
      "filename": "sim/testsuite/sh/allinsn.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e877834085658e5d9a7e29daf2216fdf17bfdd0/sim/testsuite/sh/allinsn.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e877834085658e5d9a7e29daf2216fdf17bfdd0/sim/testsuite/sh/allinsn.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/testsuite/sh/allinsn.exp?ref=0e877834085658e5d9a7e29daf2216fdf17bfdd0",
      "patch": "@@ -2,12 +2,12 @@\n \n set all_machs \"sh shdsp\"\n \n-set global_as_options \"\"\n+global ASFLAGS_FOR_TARGET\n set global_ld_options \"\"\n \n foreach opt $board_variant_list {\n     switch \"x$opt\" {\n-\tx-ml { set global_as_options \"-little --defsym LITTLE=1\"\n+\tx-ml { set ASFLAGS_FOR_TARGET \"-little --defsym LITTLE=1\"\n \t       set global_ld_options \"-EL\" }\n     }\n }"
    }
  ]
}