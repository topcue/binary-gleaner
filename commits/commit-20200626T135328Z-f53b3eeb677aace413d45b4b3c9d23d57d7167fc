{
  "sha": "f53b3eeb677aace413d45b4b3c9d23d57d7167fc",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZjUzYjNlZWI2NzdhYWNlNDEzZDQ1YjRiM2M5ZDIzZDU3ZDcxNjdmYw==",
  "commit": {
    "author": {
      "name": "Gary Benson",
      "email": "gbenson@redhat.com",
      "date": "2020-06-26T13:53:28Z"
    },
    "committer": {
      "name": "Gary Benson",
      "email": "gbenson@redhat.com",
      "date": "2020-06-26T13:53:28Z"
    },
    "message": "Fix -Wstring-compare testcase build failure\n\nClang fails to compile the file gdb/testsuite/gdb.cp/try_catch.cc\nwith the following error:\n  warning: result of comparison against a string literal is\n  unspecified (use strncmp instead) [-Wstring-compare]\n\nThis commit fixes the error, replacing the pointer comparison with\na call to strcmp.  This commit also adds a final check: the test\nprogram is run to the final return statement, and the value of\n\"test\" is checked to ensure it is still \"true\" at that point.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.cp/try_catch.cc: Include string.h.\n\t(main): Replace comparison against string literal with\n\tstrcmp, avoiding build failure with -Wstring-compare.\n\tAdd \"marker test-complete\".\n\t* gdb.cp/try_catch.exp: Run the test to the above marker,\n\tthen verify that the value of \"test\" is still true.",
    "tree": {
      "sha": "c603ca7a67446c6ba38b29e3dec3a10c9a5cdb12",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c603ca7a67446c6ba38b29e3dec3a10c9a5cdb12"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/f53b3eeb677aace413d45b4b3c9d23d57d7167fc",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f53b3eeb677aace413d45b4b3c9d23d57d7167fc",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/f53b3eeb677aace413d45b4b3c9d23d57d7167fc",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f53b3eeb677aace413d45b4b3c9d23d57d7167fc/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "edf92af0fbc064243069578353ff569462c3df5b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/edf92af0fbc064243069578353ff569462c3df5b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/edf92af0fbc064243069578353ff569462c3df5b"
    }
  ],
  "stats": {
    "total": 18,
    "additions": 16,
    "deletions": 2
  },
  "files": [
    {
      "sha": "a01a065d814f1855f413acd867a9e2f2d48cbf1c",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f53b3eeb677aace413d45b4b3c9d23d57d7167fc/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f53b3eeb677aace413d45b4b3c9d23d57d7167fc/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=f53b3eeb677aace413d45b4b3c9d23d57d7167fc",
      "patch": "@@ -1,3 +1,12 @@\n+2020-06-26  Gary Benson <gbenson@redhat.com>\n+\n+\t* gdb.cp/try_catch.cc: Include string.h.\n+\t(main): Replace comparison against string literal with\n+\tstrcmp, avoiding build failure with -Wstring-compare.\n+\tAdd \"marker test-complete\".\n+\t* gdb.cp/try_catch.exp: Run the test to the above marker,\n+\tthen verify that the value of \"test\" is still true.\n+\n 2020-06-25  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* gdb.arch/riscv-tdesc-regs.exp: New test cases."
    },
    {
      "sha": "5f454f41ec5ff3f5febea8a910fc1288d9866298",
      "filename": "gdb/testsuite/gdb.cp/try_catch.cc",
      "status": "modified",
      "additions": 3,
      "deletions": 2,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f53b3eeb677aace413d45b4b3c9d23d57d7167fc/gdb/testsuite/gdb.cp/try_catch.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f53b3eeb677aace413d45b4b3c9d23d57d7167fc/gdb/testsuite/gdb.cp/try_catch.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.cp/try_catch.cc?ref=f53b3eeb677aace413d45b4b3c9d23d57d7167fc",
      "patch": "@@ -18,6 +18,7 @@\n #include <exception>\n #include <stdexcept>\n #include <string>\n+#include <string.h>\n \n enum region { oriental, egyptian, greek, etruscan, roman };\n \n@@ -129,8 +130,8 @@ int main()\n     }\n   catch (exception& obj)\n     {\n-      if (obj.what() != \"gdb.1\")\t// marker 3-catch\n+      if (strcmp (obj.what(), \"gdb.1\") != 0)\t// marker 3-catch\n \ttest &= false;\n     }\n-  return 0;\n+  return 0;\t// marker test-complete\n }"
    },
    {
      "sha": "b52e1a0a5221ee6050d75e2c4468b97606a96beb",
      "filename": "gdb/testsuite/gdb.cp/try_catch.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f53b3eeb677aace413d45b4b3c9d23d57d7167fc/gdb/testsuite/gdb.cp/try_catch.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f53b3eeb677aace413d45b4b3c9d23d57d7167fc/gdb/testsuite/gdb.cp/try_catch.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.cp/try_catch.exp?ref=f53b3eeb677aace413d45b4b3c9d23d57d7167fc",
      "patch": "@@ -63,5 +63,9 @@ gdb_continue_to_breakpoint \"marker 3-throw\"\n gdb_breakpoint [gdb_get_line_number \"marker 3-catch\"]\n gdb_continue_to_breakpoint \"marker 3-catch\"\n \n+gdb_breakpoint [gdb_get_line_number \"marker test-complete\"]\n+gdb_continue_to_breakpoint \"marker test-complete\"\n+gdb_test \"p test\" \"= true\"\n+\n gdb_exit\n return 0"
    }
  ]
}