{
  "sha": "7ee8c127555c89781bcd9451cdea54884f6ac155",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6N2VlOGMxMjc1NTVjODk3ODFiY2Q5NDUxY2RlYTU0ODg0ZjZhYzE1NQ==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-06-07T12:33:50Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-06-07T12:33:50Z"
    },
    "message": "[gdb/testsuite] Fix info-types-c.exp\n\nRecently, I've rewritten gdb.base/info-types.exp.tcl to do processing\nline-by-line (commit 2129a942553).\n\nWhen building gdb with -O0, this test passes for me, but with -O2 I sometimes\nrun into:\n...\nFAIL: gdb.base/info-types-c.exp: info types (state == 1)\n...\n\nThe output the failing gdb_test_multiple is trying to parse is:\n...\n(gdb) info types^M\nAll defined types:^M\n^M\nFile src/gdb/testsuite/gdb.base/info-types.c:^M\n52:     typedef enum {...} anon_enum_t;^M\n  ...\n(gdb)\n...\nand the FAIL with state == 1 means that:\n- the regexp for \"All defined types:\" did trigger, and that\n- the regexp for \"File .*info-types.c\" didn't trigger.\n\nThis is due to the fact that the empty line inbetween is supposed to be\nmatched by the \"random line\" regexp \"^\\r\\n(\\[^\\r\\n\\]*)(?=\\r\\n)\", which doesn't\nhappen because instead the earlier regexp consuming the gdb prompt matches.\n\nFix this by moving the \"random line\" regexp up.  [ Note that that regexp does\nnot consume the gdb prompt, because it requires (but doesn't consume) a\nterminating \"\\r\\n\".\n\nTested on x86_64-linux.\n\ngdb/testsuite/ChangeLog:\n\n2021-06-07  Tom de Vries  <tdevries@suse.de>\n\n\t* gdb.base/info-types.exp.tcl (run_test): Move \"random line\" regexp\n\tup.",
    "tree": {
      "sha": "34949a37167fbca1fcab2e104292b2e220f92b44",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/34949a37167fbca1fcab2e104292b2e220f92b44"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/7ee8c127555c89781bcd9451cdea54884f6ac155",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7ee8c127555c89781bcd9451cdea54884f6ac155",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/7ee8c127555c89781bcd9451cdea54884f6ac155",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7ee8c127555c89781bcd9451cdea54884f6ac155/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "6b5ba0d49e3d96454b4b43f8bc861394fcf694b6",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6b5ba0d49e3d96454b4b43f8bc861394fcf694b6",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/6b5ba0d49e3d96454b4b43f8bc861394fcf694b6"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 12,
    "deletions": 7
  },
  "files": [
    {
      "sha": "1607a0d6a1edaea468a9abff168c5c314a341a3f",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7ee8c127555c89781bcd9451cdea54884f6ac155/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7ee8c127555c89781bcd9451cdea54884f6ac155/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=7ee8c127555c89781bcd9451cdea54884f6ac155",
      "patch": "@@ -1,3 +1,8 @@\n+2021-06-07  Tom de Vries  <tdevries@suse.de>\n+\n+\t* gdb.base/info-types.exp.tcl (run_test): Move \"random line\" regexp\n+\tup.\n+\n 2021-06-06  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* gdb.server/stop-reply-no-thread-multi.exp: Clear sysroot when"
    },
    {
      "sha": "0eac3dbe67c18c2d612f34f19d5201d214137ff9",
      "filename": "gdb/testsuite/gdb.base/info-types.exp.tcl",
      "status": "modified",
      "additions": 7,
      "deletions": 7,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7ee8c127555c89781bcd9451cdea54884f6ac155/gdb/testsuite/gdb.base/info-types.exp.tcl",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7ee8c127555c89781bcd9451cdea54884f6ac155/gdb/testsuite/gdb.base/info-types.exp.tcl",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/info-types.exp.tcl?ref=7ee8c127555c89781bcd9451cdea54884f6ac155",
      "patch": "@@ -168,13 +168,6 @@ proc run_test { lang } {\n \t    if { $state == 2 } { set state -4 }\n \t    exp_continue\n \t}\n-\t-re -wrap \"\" {\n-\t    if { $state == 3} {\n-\t\tpass $gdb_test_name\n-\t    } else {\n-\t\tfail \"$gdb_test_name (state == $state)\"\n-\t    }\n-\t}\n \t-re \"^\\r\\n(\\[^\\r\\n\\]*)(?=\\r\\n)\" {\n \t    if { $state == 2 } {\n \t\tset line $expect_out(1,string)\n@@ -187,6 +180,13 @@ proc run_test { lang } {\n \t    }\n \t    exp_continue\n \t}\n+\t-re -wrap \"\" {\n+\t    if { $state == 3} {\n+\t\tpass $gdb_test_name\n+\t    } else {\n+\t\tfail \"$gdb_test_name (state == $state)\"\n+\t    }\n+\t}\n     }\n }\n "
    }
  ]
}