{
  "sha": "0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MGZjZjMzMWJiMTMzODZhNjM5OWQ4ZmY4YmZlZTA1ODdiZmIzODdmOA==",
  "commit": {
    "author": {
      "name": "Maciej W. Rozycki",
      "email": "macro@linux-mips.org",
      "date": "2020-12-05T11:18:14Z"
    },
    "committer": {
      "name": "Maciej W. Rozycki",
      "email": "macro@linux-mips.org",
      "date": "2020-12-05T11:18:14Z"
    },
    "message": "VAX/BFD: Do not warn about GOT addend mismatches if no GOT entry is made\n\nMatch the condition used in `elf_vax_instantiate_got_entries' for the\ncreation of GOT entries in the processing of R_VAX_GOT32 relocations in\n`elf_vax_check_relocs', removing incorrect warnings about a GOT addend\nmismatch like:\n\n./ld-new: tmpdir/got-local-ref-off-r.o: warning: GOT addend of 1 to `bar_hidden' does not match previous GOT addend of 0\n./ld-new: tmpdir/got-local-ref-off-r.o: warning: GOT addend of 2 to `bar_hidden' does not match previous GOT addend of 0\n\nand corresponding failures with the test cases newly added here:\n\nFAIL: GOT test (executable hidden reference with offset)\nFAIL: GOT test (executable visible reference with offset)\n\nfor symbols that are considered local for reasons other than having been\nforced local with a version script, which is usually the ELF visibility.\nCorrect code is produced regardless, but the warning breaks `-Werror'\ncompilation and may upset people regardless.\n\nInterestingly this shows with executable links only, because in shared\nlibrary links code from `elf_link_add_object_symbols' triggers:\n\n\t    /* If the symbol already has a dynamic index, but\n\t       visibility says it should not be visible, turn it into\n\t       a local symbol.  */\n\t    switch (ELF_ST_VISIBILITY (h->other))\n\t      {\n\t      case STV_INTERNAL:\n\t      case STV_HIDDEN:\n\t\t(*bed->elf_backend_hide_symbol) (info, h, TRUE);\n\t\tdynsym = FALSE;\n\t\tbreak;\n\t      }\n\nthat sets `h->forced_local' like with a version script.\n\nAdd suitable test cases including disassembly to verify correct code has\nbeen produced where no warnings have been issued, and that warnings do\nget issued where necessary.  Do not verify (broken) code produced in the\nlatter case; we should probably make the warning an error, or preferably\nactually start supporting GOT references with different addends as they\nappear feasible with explicitly relocated GOT that we use.\n\n\tbfd/\n\t* elf32-vax.c (elf_vax_check_relocs) <R_VAX_GOT32>: Use\n\tSYMBOL_REFERENCES_LOCAL rather than `h->forced_local' to check\n\twhether the symbol referred is local or not.\n\n\tld/\n\t* testsuite/ld-vax-elf/got-local-exe-off-hidden.dd: New test\n\tdump.\n\t* testsuite/ld-vax-elf/got-local-exe-off-visible.dd: New test\n\tdump.\n\t* testsuite/ld-vax-elf/got-local-lib-off-hidden.dd: New test\n\tdump.\n\t* testsuite/ld-vax-elf/got-local-lib-off-visible.ed: New test\n\tdump.\n\t* testsuite/ld-vax-elf/got-local-off-external.ed: New test dump.\n\t* testsuite/ld-vax-elf/got-local-exe-off.xd: New test dump.\n\t* testsuite/ld-vax-elf/got-local-lib-off.xd: New test dump.\n\t* testsuite/ld-vax-elf/got-local.ld: New test linker script.\n\t* testsuite/ld-vax-elf/got-local-aux-off.s: New test source.\n\t* testsuite/ld-vax-elf/got-local-def-off.s: New test source.\n\t* testsuite/ld-vax-elf/got-local-ref-off-external.s: New test\n\tsource.\n\t* testsuite/ld-vax-elf/got-local-ref-off-hidden.s: New test\n\tsource.\n\t* testsuite/ld-vax-elf/got-local-ref-off-visible.s: New test\n\tsource.\n\t* testsuite/ld-vax-elf/vax-elf.exp: Run the new tests.",
    "tree": {
      "sha": "08c7cb86ae55dd29ca3ea26ce352363407d86591",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/08c7cb86ae55dd29ca3ea26ce352363407d86591"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "3c7ba803ac3fbf2b3d7960c14867844238029d55",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3c7ba803ac3fbf2b3d7960c14867844238029d55",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/3c7ba803ac3fbf2b3d7960c14867844238029d55"
    }
  ],
  "stats": {
    "total": 248,
    "additions": 245,
    "deletions": 3
  },
  "files": [
    {
      "sha": "1cf06249f3e50ac95fd3cce5251b5c8e752417af",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -1,3 +1,9 @@\n+2020-12-05  Maciej W. Rozycki  <macro@linux-mips.org>\n+\n+\t* elf32-vax.c (elf_vax_check_relocs) <R_VAX_GOT32>: Use\n+\tSYMBOL_REFERENCES_LOCAL rather than `h->forced_local' to check\n+\twhether the symbol referred is local or not.\n+\n 2020-12-04  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR ld/27016"
    },
    {
      "sha": "a9581b82412c816fa2f392eb700b51bfebb5c404",
      "filename": "bfd/elf32-vax.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/bfd/elf32-vax.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/bfd/elf32-vax.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf32-vax.c?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -598,7 +598,7 @@ elf_vax_check_relocs (bfd *abfd, struct bfd_link_info *info, asection *sec,\n \n \t  /* If this is a local symbol, we resolve it directly without\n \t     creating a global offset table entry.  */\n-\t  if (h->forced_local\n+\t  if (SYMBOL_REFERENCES_LOCAL (info, h)\n \t      || h == elf_hash_table (info)->hgot\n \t      || h == elf_hash_table (info)->hplt)\n \t    break;"
    },
    {
      "sha": "9e72b31c9fabea0d97180d25ac569337edff7295",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 24,
      "deletions": 0,
      "changes": 24,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -1,3 +1,27 @@\n+2020-12-05  Maciej W. Rozycki  <macro@linux-mips.org>\n+\n+\t* testsuite/ld-vax-elf/got-local-exe-off-hidden.dd: New test\n+\tdump.\n+\t* testsuite/ld-vax-elf/got-local-exe-off-visible.dd: New test\n+\tdump.\n+\t* testsuite/ld-vax-elf/got-local-lib-off-hidden.dd: New test\n+\tdump.\n+\t* testsuite/ld-vax-elf/got-local-lib-off-visible.ed: New test\n+\tdump.\n+\t* testsuite/ld-vax-elf/got-local-off-external.ed: New test dump.\n+\t* testsuite/ld-vax-elf/got-local-exe-off.xd: New test dump.\n+\t* testsuite/ld-vax-elf/got-local-lib-off.xd: New test dump.\n+\t* testsuite/ld-vax-elf/got-local.ld: New test linker script.\n+\t* testsuite/ld-vax-elf/got-local-aux-off.s: New test source.\n+\t* testsuite/ld-vax-elf/got-local-def-off.s: New test source.\n+\t* testsuite/ld-vax-elf/got-local-ref-off-external.s: New test\n+\tsource.\n+\t* testsuite/ld-vax-elf/got-local-ref-off-hidden.s: New test\n+\tsource.\n+\t* testsuite/ld-vax-elf/got-local-ref-off-visible.s: New test\n+\tsource.\n+\t* testsuite/ld-vax-elf/vax-elf.exp: Run the new tests.\n+\n 2020-12-04  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR ld/27016"
    },
    {
      "sha": "36ea98777d25df1da5d13e4db02b9ce2e572d9cb",
      "filename": "ld/testsuite/ld-vax-elf/got-local-aux-off.s",
      "status": "added",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-aux-off.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-aux-off.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-aux-off.s?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,5 @@\n+\t.globl\tbaz\n+\t.type\tbaz, @object\n+baz:\n+\t.byte\t0, 1, 2\n+\t.size\tbaz, . - baz"
    },
    {
      "sha": "2ad0473e0d479aa2cfc1371a8d3624d2f4e54648",
      "filename": "ld/testsuite/ld-vax-elf/got-local-def-off.s",
      "status": "added",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-def-off.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-def-off.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-def-off.s?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,12 @@\n+\t.data\n+\t.globl\tbar_hidden\n+\t.type\tbar_hidden, @object\n+\t.hidden\tbar_hidden\n+bar_hidden:\n+\t.byte\t0, 1, 2\n+\t.size\tbar_hidden, . - bar_hidden\n+\t.globl\tbar_visible\n+\t.type\tbar_visible, @object\n+bar_visible:\n+\t.byte\t0, 1, 2\n+\t.size\tbar_visible, . - bar_visible"
    },
    {
      "sha": "4a1b54be93119ad8131ad1d1cf543f84f5e61550",
      "filename": "ld/testsuite/ld-vax-elf/got-local-exe-off-hidden.dd",
      "status": "added",
      "additions": 17,
      "deletions": 0,
      "changes": 17,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-exe-off-hidden.dd",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-exe-off-hidden.dd",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-exe-off-hidden.dd?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,17 @@\n+.*: +file format .*vax.*\n+\n+Disassembly of section \\.text:\n+\n+00000000 <foo>:\n+   0:\t00 00       \t\\.word 0x0000 # Entry mask: < >\n+   2:\t9e ef f8 1f \tmovab 2000 <bar_hidden>,r0\n+   6:\t00 00 50 \n+   9:\t9e ef f2 1f \tmovab 2001 <bar_hidden\\+0x1>,r0\n+   d:\t00 00 50 \n+  10:\t9e ef ec 1f \tmovab 2002 <bar_hidden\\+0x2>,r0\n+  14:\t00 00 50 \n+  17:\t9e ef e6 1f \tmovab 2003 <bar_visible>,r1\n+  1b:\t00 00 51 \n+  1e:\t9e ff dc 0f \tmovab \\*1000 <baz>,r2\n+  22:\t00 00 52 \n+  25:\t04          \tret"
    },
    {
      "sha": "8eddd364b45ff70a3bf15b6f3bd210901760a2f4",
      "filename": "ld/testsuite/ld-vax-elf/got-local-exe-off-visible.dd",
      "status": "added",
      "additions": 17,
      "deletions": 0,
      "changes": 17,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-exe-off-visible.dd",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-exe-off-visible.dd",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-exe-off-visible.dd?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,17 @@\n+.*: +file format .*vax.*\n+\n+Disassembly of section \\.text:\n+\n+00000000 <foo>:\n+   0:\t00 00       \t\\.word 0x0000 # Entry mask: < >\n+   2:\t9e ef f8 1f \tmovab 2000 <bar_hidden>,r0\n+   6:\t00 00 50 \n+   9:\t9e ef f4 1f \tmovab 2003 <bar_visible>,r1\n+   d:\t00 00 51 \n+  10:\t9e ef ee 1f \tmovab 2004 <bar_visible\\+0x1>,r1\n+  14:\t00 00 51 \n+  17:\t9e ef e8 1f \tmovab 2005 <bar_visible\\+0x2>,r1\n+  1b:\t00 00 51 \n+  1e:\t9e ff dc 0f \tmovab \\*1000 <baz>,r2\n+  22:\t00 00 52 \n+  25:\t04          \tret"
    },
    {
      "sha": "c4c1ab62c4839e3b0856309da0ac009c864f24da",
      "filename": "ld/testsuite/ld-vax-elf/got-local-exe-off.xd",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-exe-off.xd",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-exe-off.xd",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-exe-off.xd?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,3 @@\n+# Make sure there's only one GOT entry, for the symbol defined externally.\n+Hex dump of section '\\.got':\n+  0x00001000 00000000                            .*"
    },
    {
      "sha": "1e4dfe9448f637ce5c1b05c38d302a962f58d8b6",
      "filename": "ld/testsuite/ld-vax-elf/got-local-lib-off-hidden.dd",
      "status": "added",
      "additions": 17,
      "deletions": 0,
      "changes": 17,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-lib-off-hidden.dd",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-lib-off-hidden.dd",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-lib-off-hidden.dd?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,17 @@\n+.*: +file format .*vax.*\n+\n+Disassembly of section \\.text:\n+\n+00000000 <foo>:\n+   0:\t00 00       \t\\.word 0x0000 # Entry mask: < >\n+   2:\t9e ef f8 1f \tmovab 2000 <bar_hidden>,r0\n+   6:\t00 00 50 \n+   9:\t9e ef f2 1f \tmovab 2001 <bar_hidden\\+0x1>,r0\n+   d:\t00 00 50 \n+  10:\t9e ef ec 1f \tmovab 2002 <bar_hidden\\+0x2>,r0\n+  14:\t00 00 50 \n+  17:\t9e ff e7 0f \tmovab \\*1004 <bar_visible-0xfff>,r1\n+  1b:\t00 00 51 \n+  1e:\t9e ff dc 0f \tmovab \\*1000 <baz>,r2\n+  22:\t00 00 52 \n+  25:\t04          \tret"
    },
    {
      "sha": "d7eacd6b2130719197ca06f05c2efa441252cbed",
      "filename": "ld/testsuite/ld-vax-elf/got-local-lib-off-visible.ed",
      "status": "added",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-lib-off-visible.ed",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-lib-off-visible.ed",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-lib-off-visible.ed?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,2 @@\n+\\A[^\\n]*\\.o: warning: GOT addend of 1 to `bar_visible' does not match previous GOT addend of 0\n+[^\\n]*\\.o: warning: GOT addend of 2 to `bar_visible' does not match previous GOT addend of 0\\Z"
    },
    {
      "sha": "2f86b2b351f11fdc2dfa5c26ada0ee01f5b9b687",
      "filename": "ld/testsuite/ld-vax-elf/got-local-lib-off.xd",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-lib-off.xd",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-lib-off.xd",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-lib-off.xd?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,3 @@\n+# Make sure there are only two GOT entries, for the preemptible symbols.\n+Hex dump of section '\\.got':\n+  0x00001000 00000000 00000000                   .*"
    },
    {
      "sha": "773ea0fcd1d1f7f9df8bbad2d9bf6ef12812cd5c",
      "filename": "ld/testsuite/ld-vax-elf/got-local-off-external.ed",
      "status": "added",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-off-external.ed",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-off-external.ed",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-off-external.ed?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,2 @@\n+\\A[^\\n]*\\.o: warning: GOT addend of 1 to `baz' does not match previous GOT addend of 0\n+[^\\n]*\\.o: warning: GOT addend of 2 to `baz' does not match previous GOT addend of 0\\Z"
    },
    {
      "sha": "260194cc0cf0d2880df9b055659ddf91c2b18486",
      "filename": "ld/testsuite/ld-vax-elf/got-local-ref-off-external.s",
      "status": "added",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-ref-off-external.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-ref-off-external.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-ref-off-external.s?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,12 @@\n+\t.text\n+\t.globl\tfoo\n+\t.type\tfoo, @function\n+foo:\n+\t.word\t0\n+\tmovab\tbar_hidden, %r0\n+\tmovab\tbar_visible, %r1\n+\tmovab\tbaz, %r2\n+\tmovab\tbaz + 1, %r2\n+\tmovab\tbaz + 2, %r2\n+\tret\n+\t.size\tfoo, . - foo"
    },
    {
      "sha": "fdff42ca1e32a475f11cf7c3455b7e8b470e7890",
      "filename": "ld/testsuite/ld-vax-elf/got-local-ref-off-hidden.s",
      "status": "added",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-ref-off-hidden.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-ref-off-hidden.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-ref-off-hidden.s?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,12 @@\n+\t.text\n+\t.globl\tfoo\n+\t.type\tfoo, @function\n+foo:\n+\t.word\t0\n+\tmovab\tbar_hidden, %r0\n+\tmovab\tbar_hidden + 1, %r0\n+\tmovab\tbar_hidden + 2, %r0\n+\tmovab\tbar_visible, %r1\n+\tmovab\tbaz, %r2\n+\tret\n+\t.size\tfoo, . - foo"
    },
    {
      "sha": "cf3d0703bddee14d6785efb2253b5e6b948f0885",
      "filename": "ld/testsuite/ld-vax-elf/got-local-ref-off-visible.s",
      "status": "added",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-ref-off-visible.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local-ref-off-visible.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local-ref-off-visible.s?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,12 @@\n+\t.text\n+\t.globl\tfoo\n+\t.type\tfoo, @function\n+foo:\n+\t.word\t0\n+\tmovab\tbar_hidden, %r0\n+\tmovab\tbar_visible, %r1\n+\tmovab\tbar_visible + 1, %r1\n+\tmovab\tbar_visible + 2, %r1\n+\tmovab\tbaz, %r2\n+\tret\n+\t.size\tfoo, . - foo"
    },
    {
      "sha": "330046db9cabb12a7d36b7b813af7ce439af6619",
      "filename": "ld/testsuite/ld-vax-elf/got-local.ld",
      "status": "added",
      "additions": 17,
      "deletions": 0,
      "changes": 17,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local.ld",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/got-local.ld",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/got-local.ld?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -0,0 +1,17 @@\n+SECTIONS\n+{\n+  .text : { *(.text) }\n+  .hash : { *(.hash) }\n+  .dynsym : { *(.dynsym) }\n+  .dynstr : { *(.dynstr) }\n+  .rela.dyn : { *(.rela.*) }\n+  . = ALIGN (0x1000);\n+  .got : { *(.got) }\n+  . = ALIGN (0x1000);\n+  .data : { *(.data) }\n+  .dynamic : { *(.dynamic) }\n+  .symtab : { *(.symtab) }\n+  .strtab : { *(.strtab) }\n+  .shstrtab : { *(.shstrtab) }\n+  /DISCARD/ : { *(*) }\n+}"
    },
    {
      "sha": "fb1fc3bb2aec1ed9a99fa45823936c4ee6024ded",
      "filename": "ld/testsuite/ld-vax-elf/vax-elf.exp",
      "status": "modified",
      "additions": 83,
      "deletions": 2,
      "changes": 85,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/vax-elf.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fcf331bb13386a6399d8ff8bfee0587bfb387f8/ld/testsuite/ld-vax-elf/vax-elf.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-vax-elf/vax-elf.exp?ref=0fcf331bb13386a6399d8ff8bfee0587bfb387f8",
      "patch": "@@ -51,26 +51,56 @@ run_ld_link_tests [list \\\n \t  \"plt-local\"]]\n \n # Global offset table tests.  Make sure hidden symbols do not get GOT\n-# assignments.\n+# assignments.  Also verify offset references.\n run_ld_link_tests [list \\\n     [list \"GOT test (auxiliary shared library)\" \\\n \t  \"-shared\" \"\" \\\n \t  \"-k\" \\\n \t  { got-local-aux.s } \\\n \t  {} \\\n \t  \"got-local-aux.so\"] \\\n+    [list \"GOT test (auxiliary shared library for offsets)\" \\\n+\t  \"-shared\" \"\" \\\n+\t  \"-k\" \\\n+\t  { got-local-aux-off.s } \\\n+\t  {} \\\n+\t  \"got-local-aux-off.so\"] \\\n     [list \"GOT test (object 1)\" \\\n \t  \"-r\" \"\" \\\n \t  \"-k\" \\\n \t  { got-local-ref.s } \\\n \t  {} \\\n \t  \"got-local-ref-r.o\"] \\\n+    [list \"GOT test (object 1 hidden reference with offset)\" \\\n+\t  \"-r\" \"\" \\\n+\t  \"-k\" \\\n+\t  { got-local-ref-off-hidden.s } \\\n+\t  {} \\\n+\t  \"got-local-ref-off-hidden-r.o\"] \\\n+    [list \"GOT test (object 1 visible reference with offset)\" \\\n+\t  \"-r\" \"\" \\\n+\t  \"-k\" \\\n+\t  { got-local-ref-off-visible.s } \\\n+\t  {} \\\n+\t  \"got-local-ref-off-visible-r.o\"] \\\n+    [list \"GOT test (object 1 external reference with offset)\" \\\n+\t  \"-r\" \"\" \\\n+\t  \"-k\" \\\n+\t  { got-local-ref-off-external.s } \\\n+\t  {} \\\n+\t  \"got-local-ref-off-external-r.o\"] \\\n     [list \"GOT test (object 2)\" \\\n \t  \"-r\" \"\" \\\n \t  \"-k\" \\\n \t  { got-local-def.s } \\\n \t  {} \\\n \t  \"got-local-def-r.o\"] \\\n+    [list \"GOT test (object 2 for offsets)\" \\\n+\t  \"-r\" \"\" \\\n+\t  \"-k\" \\\n+\t  { got-local-def-off.s } \\\n+\t  {} \\\n+\t  \"got-local-def-off-r.o\"] \\\n     [list \"GOT test (executable)\" \\\n \t  \"-e 0 tmpdir/got-local-aux.so tmpdir/got-local-ref-r.o \\\n \t   tmpdir/got-local-def-r.o\" \"\" \\\n@@ -84,7 +114,58 @@ run_ld_link_tests [list \\\n \t  \"\" \\\n \t  {} \\\n \t  { { readelf \"-x .got\" got-local-lib.xd } } \\\n-\t  \"got-local-lib.so\"]]\n+\t  \"got-local-lib.so\"] \\\n+    [list \"GOT test (executable hidden reference with offset)\" \\\n+\t  \"-e 0 -T got-local.ld tmpdir/got-local-aux-off.so \\\n+\t   tmpdir/got-local-ref-off-hidden-r.o \\\n+\t   tmpdir/got-local-def-off-r.o\" \"\" \\\n+\t  \"\" \\\n+\t  {} \\\n+\t  { { readelf \"-x .got\" got-local-exe-off.xd } \\\n+\t    { objdump -d got-local-exe-off-hidden.dd } } \\\n+\t  \"got-local-exe-off-hidden\"] \\\n+    [list \"GOT test (shared library hidden reference with offset)\" \\\n+\t  \"-shared -T got-local.ld tmpdir/got-local-aux-off.so \\\n+\t   tmpdir/got-local-ref-off-hidden-r.o \\\n+\t   tmpdir/got-local-def-off-r.o\" \"\" \\\n+\t  \"\" \\\n+\t  {} \\\n+\t  { { readelf \"-x .got\" got-local-lib-off.xd } \\\n+\t    { objdump -d got-local-lib-off-hidden.dd } } \\\n+\t  \"got-local-lib-off-hidden.so\"] \\\n+    [list \"GOT test (executable visible reference with offset)\" \\\n+\t  \"-e 0 -T got-local.ld tmpdir/got-local-aux-off.so \\\n+\t   tmpdir/got-local-ref-off-visible-r.o \\\n+\t   tmpdir/got-local-def-off-r.o\" \"\" \\\n+\t  \"\" \\\n+\t  {} \\\n+\t  { { readelf \"-x .got\" got-local-exe-off.xd } \\\n+\t    { objdump -d got-local-exe-off-visible.dd } } \\\n+\t  \"got-local-exe-off-visible\"] \\\n+    [list \"GOT test (shared library visible reference with offset)\" \\\n+\t  \"-shared -T got-local.ld tmpdir/got-local-aux-off.so \\\n+\t   tmpdir/got-local-ref-off-visible-r.o \\\n+\t   tmpdir/got-local-def-off-r.o\" \"\" \\\n+\t  \"\" \\\n+\t  {} \\\n+\t  { { ld got-local-lib-off-visible.ed } } \\\n+\t  \"got-local-lib-off-visible.so\"] \\\n+    [list \"GOT test (executable external reference with offset)\" \\\n+\t  \"-e 0 -T got-local.ld tmpdir/got-local-aux-off.so \\\n+\t   tmpdir/got-local-ref-off-external-r.o \\\n+\t   tmpdir/got-local-def-off-r.o\" \"\" \\\n+\t  \"\" \\\n+\t  {} \\\n+\t  { { ld got-local-off-external.ed } } \\\n+\t  \"got-local-exe-off-external\"] \\\n+    [list \"GOT test (shared library external reference with offset)\" \\\n+\t  \"-shared -T got-local.ld tmpdir/got-local-aux-off.so \\\n+\t   tmpdir/got-local-ref-off-external-r.o \\\n+\t   tmpdir/got-local-def-off-r.o\" \"\" \\\n+\t  \"\" \\\n+\t  {} \\\n+\t  { { ld got-local-off-external.ed } } \\\n+\t  \"got-local-lib-off-external.so\"]]\n \n # Export class relocation tests.\n run_ld_link_tests [list \\"
    }
  ]
}