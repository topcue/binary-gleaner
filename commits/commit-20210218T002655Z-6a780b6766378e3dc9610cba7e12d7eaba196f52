{
  "sha": "6a780b6766378e3dc9610cba7e12d7eaba196f52",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NmE3ODBiNjc2NjM3OGUzZGM5NjEwY2JhN2UxMmQ3ZWFiYTE5NmY1Mg==",
  "commit": {
    "author": {
      "name": "Kevin Buettner",
      "email": "kevinb@redhat.com",
      "date": "2021-02-13T00:53:51Z"
    },
    "committer": {
      "name": "Kevin Buettner",
      "email": "kevinb@redhat.com",
      "date": "2021-02-18T00:26:55Z"
    },
    "message": "Fix completion related libstdc++ assert when using -D_GLIBCXX_DEBUG\n\nThis commit fixes a libstdc++ assertion failure encountered when\nrunning gdb.base/completion.exp.  In order to see this problem,\nGDB must be built with the follow CFLAGS and CXXFLAGS as part\nof the configure line:\n\n  CFLAGS='-D_GLIBCXX_DEBUG' CXXFLAGS='-D_GLIBCXX_DEBUG'\n\n(Also, this problem was encountered using Fedora rawhide.  It might\nnot be reproducible in Fedora versions prior to Fedora 34.)\n\nUsing the gdb.base/completion.exp test program, the problem can be\nobserved as follows:\n\n[kev@rawhide-1 gdb]$ ./gdb -q testsuite/outputs/gdb.base/completion/completion\nReading symbols from testsuite/outputs/gdb.base/completion/completion...\n(gdb) start\nTemporary breakpoint 1 at 0x401179: file ../../worktree-master/gdb/testsuite/gdb.base/break.c, line 43.\nStarting program: testsuite/outputs/gdb.base/completion/completion\n\nTemporary breakpoint 1, main (argc=1, argv=0x7fffffffd718, envp=0x7fffffffd728) at ../../worktree-master/gdb/testsuite/gdb.base/break.c:43\n43\t    if (argc == 12345) {  /* an unlikely value < 2^16, in case uninited */ /* set breakpoint 6 here */\n(gdb) p <TAB>/usr/include/c++/11/string_view:211: constexpr const value_type& std::basic_string_view<_CharT, _Traits>::operator[](std::basic_string_view<_CharT, _Traits>::size_type) const [with _CharT = char; _Traits = std::char_traits<char>; std::basic_string_view<_CharT, _Traits>::const_reference = const char&; std::basic_string_view<_CharT, _Traits>::size_type = long unsigned int]: Assertion '__pos < this->_M_len' failed.\nAborted (core dumped)\n\n(Note that I added \"<TAB>\" to make it clear where the tab key was\npressed.)\n\ngdb/ChangeLog:\n\n\t* ada-lang.c (ada_fold_name): Check for non-empty string prior\n\tto accessing it.\n\t(ada_lookup_name_info): Likewise.",
    "tree": {
      "sha": "ee995877d93c61636ae2a918c2446ef538edd7f9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/ee995877d93c61636ae2a918c2446ef538edd7f9"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/6a780b6766378e3dc9610cba7e12d7eaba196f52",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6a780b6766378e3dc9610cba7e12d7eaba196f52",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/6a780b6766378e3dc9610cba7e12d7eaba196f52",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6a780b6766378e3dc9610cba7e12d7eaba196f52/comments",
  "author": {
    "login": "KevinBuettner",
    "id": 65747518,
    "node_id": "MDQ6VXNlcjY1NzQ3NTE4",
    "avatar_url": "https://avatars.githubusercontent.com/u/65747518?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KevinBuettner",
    "html_url": "https://github.com/KevinBuettner",
    "followers_url": "https://api.github.com/users/KevinBuettner/followers",
    "following_url": "https://api.github.com/users/KevinBuettner/following{/other_user}",
    "gists_url": "https://api.github.com/users/KevinBuettner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KevinBuettner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KevinBuettner/subscriptions",
    "organizations_url": "https://api.github.com/users/KevinBuettner/orgs",
    "repos_url": "https://api.github.com/users/KevinBuettner/repos",
    "events_url": "https://api.github.com/users/KevinBuettner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KevinBuettner/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "KevinBuettner",
    "id": 65747518,
    "node_id": "MDQ6VXNlcjY1NzQ3NTE4",
    "avatar_url": "https://avatars.githubusercontent.com/u/65747518?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KevinBuettner",
    "html_url": "https://github.com/KevinBuettner",
    "followers_url": "https://api.github.com/users/KevinBuettner/followers",
    "following_url": "https://api.github.com/users/KevinBuettner/following{/other_user}",
    "gists_url": "https://api.github.com/users/KevinBuettner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KevinBuettner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KevinBuettner/subscriptions",
    "organizations_url": "https://api.github.com/users/KevinBuettner/orgs",
    "repos_url": "https://api.github.com/users/KevinBuettner/repos",
    "events_url": "https://api.github.com/users/KevinBuettner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KevinBuettner/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "afadac6170d88662156e540fdeb79a323261984c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/afadac6170d88662156e540fdeb79a323261984c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/afadac6170d88662156e540fdeb79a323261984c"
    }
  ],
  "stats": {
    "total": 10,
    "additions": 8,
    "deletions": 2
  },
  "files": [
    {
      "sha": "030eb9f59832c57661d1729c7045322783ab1d09",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6a780b6766378e3dc9610cba7e12d7eaba196f52/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6a780b6766378e3dc9610cba7e12d7eaba196f52/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=6a780b6766378e3dc9610cba7e12d7eaba196f52",
      "patch": "@@ -1,3 +1,9 @@\n+2021-02-17  Kevin Buettner  <kevinb@redhat.com>\n+\n+\t* ada-lang.c (ada_fold_name): Check for non-empty string prior\n+\tto accessing it.\n+\t(ada_lookup_name_info): Likewise.\n+\n 2021-02-13  Mike Frysinger  <vapier@gentoo.org>\n \n \t* aclocal.m4: Regenerate."
    },
    {
      "sha": "419347f776d9edbfaf45ae4ebab79fbece5fd9cc",
      "filename": "gdb/ada-lang.c",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6a780b6766378e3dc9610cba7e12d7eaba196f52/gdb/ada-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6a780b6766378e3dc9610cba7e12d7eaba196f52/gdb/ada-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ada-lang.c?ref=6a780b6766378e3dc9610cba7e12d7eaba196f52",
      "patch": "@@ -980,7 +980,7 @@ ada_fold_name (gdb::string_view name)\n   int len = name.size ();\n   GROW_VECT (fold_buffer, fold_buffer_size, len + 1);\n \n-  if (name[0] == '\\'')\n+  if (!name.empty () && name[0] == '\\'')\n     {\n       strncpy (fold_buffer, name.data () + 1, len - 2);\n       fold_buffer[len - 2] = '\\000';\n@@ -13650,7 +13650,7 @@ ada_lookup_name_info::ada_lookup_name_info (const lookup_name_info &lookup_name)\n {\n   gdb::string_view user_name = lookup_name.name ();\n \n-  if (user_name[0] == '<')\n+  if (!user_name.empty () && user_name[0] == '<')\n     {\n       if (user_name.back () == '>')\n \tm_encoded_name"
    }
  ]
}