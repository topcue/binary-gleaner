{
  "sha": "4bf094292c72b6d316a72ddc60739466c5085d3d",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NGJmMDk0MjkyYzcyYjZkMzE2YTcyZGRjNjA3Mzk0NjZjNTA4NWQzZA==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-07-21T05:09:29Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-07-21T10:05:34Z"
    },
    "message": "as_bad_subtract\n\nMany places report errors of the nature \"can't resolve a - b\".\nThis provides a utility function to report such errors consistently.\nI removed the section reporting and quotes around symbol names while I\nwas at it.  Compare\nifunc-2.s:4: Error: can't resolve `bar1' {.text.1 section} - `foo1' {.text.1 section}\nwith\nifunc-2.s:4: Error: can't resolve bar1 - foo1\n\nIn many cases the section names don't help the user very much in\nfiguring out what went wrong, and the quotes if present arguably ought\nto be placed around the entire expression:\ncan't resolve `bar1 - foo1'\n\nThe patch also tidies some tc_get_reloc functions that leak memory on\nerror paths.\n\n\t* write.h (as_bad_subtract): Declare.\n\t* write.c (as_bad_subtract): New function.\n\t(fixup_segment): Use as_bad_subtract.\n\t* config/tc-arc.c (md_apply_fix): Likewise.\n\t* config/tc-avr.c (md_apply_fix, tc_gen_reloc): Likewise.\n\t* config/tc-cris.c (md_apply_fix): Likewise.\n\t* config/tc-d10v.c (md_apply_fix): Likewise.\n\t* config/tc-d30v.c (md_apply_fix): Likewise.\n\t* config/tc-ft32.c (md_apply_fix): Likewise.\n\t* config/tc-h8300.c (tc_gen_reloc): Likewise.\n\t* config/tc-m68hc11.c (md_apply_fix): Likewise.\n\t* config/tc-mmix.c (mmix_frob_file): Likewise.\n\t* config/tc-mn10200.c (tc_gen_reloc): Likewise.\n\t* config/tc-nds32.c (nds32_apply_fix): Likewise.\n\t* config/tc-pru.c (md_apply_fix): Likewise.\n\t* config/tc-riscv.c (md_apply_fix): Likewise.\n\t* config/tc-s12z.c (md_apply_fix): Likewise.\n\t* config/tc-s390.c (md_apply_fix): Likewise.\n\t* config/tc-tilegx.c (md_apply_fix): Likewise.\n\t* config/tc-tilepro.c (md_apply_fix): Likewise.\n\t* config/tc-v850.c (md_apply_fix): Likewise.\n\t* config/tc-vax.c (md_apply_fix): Likewise.\n\t* config/tc-xc16x.c (tc_gen_reloc): Likewise.\n\t* config/tc-xgate.c (md_apply_fix): Likewise.\n\t* config/tc-xstormy16.c (xstormy16_md_apply_fix): Likewise.\n\t* config/tc-xtensa.c (md_apply_fix): Likewise.\n\t* config/tc-z80.c (tc_gen_reloc): Likewise.\n\t* config/tc-spu.c (md_apply_fix): Likewise.\n\t(tc_gen_reloc): Delete dead code.  Free memory on error.\n\t* config/tc-cr16.c (tc_gen_reloc): Use as_bad_subtract.  Free\n\ton error.\n\t* config/tc-crx.c (tc_gen_reloc): Likewise.\n\t* config/tc-ppc.c (tc_gen_reloc): Likewise.\n\t* testsuite/gas/i386/ifunc-2.l: Adjust to suit changed error message.\n\t* testsuite/gas/mips/lui-2.l: Likewise.\n\t* testsuite/gas/tic6x/reloc-bad-1.l: Likewise.",
    "tree": {
      "sha": "f76789cd3103c27fb5f2ff965ff2b0bf29e6e72e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/f76789cd3103c27fb5f2ff965ff2b0bf29e6e72e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4bf094292c72b6d316a72ddc60739466c5085d3d",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4bf094292c72b6d316a72ddc60739466c5085d3d",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4bf094292c72b6d316a72ddc60739466c5085d3d",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4bf094292c72b6d316a72ddc60739466c5085d3d/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e28a9225b85f2ee76760b4b93116a5630bdd0699",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e28a9225b85f2ee76760b4b93116a5630bdd0699",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e28a9225b85f2ee76760b4b93116a5630bdd0699"
    }
  ],
  "stats": {
    "total": 270,
    "additions": 121,
    "deletions": 149
  },
  "files": [
    {
      "sha": "d03dc72b401becc32c81aeed10aa169b7f584e5a",
      "filename": "gas/config/tc-arc.c",
      "status": "modified",
      "additions": 1,
      "deletions": 6,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-arc.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-arc.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-arc.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -2936,12 +2936,7 @@ md_apply_fix (fixS *fixP,\n \t}\n       else\n \t{\n-\t  as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t\t_(\"can't resolve `%s' {%s section} - `%s' {%s section}\"),\n-\t\t\tfx_addsy ? S_GET_NAME (fx_addsy) : \"0\",\n-\t\t\tsegment_name (add_symbol_segment),\n-\t\t\tS_GET_NAME (fx_subsy),\n-\t\t\tsegment_name (sub_symbol_segment));\n+\t  as_bad_subtract (fixP);\n \t  return;\n \t}\n     }"
    },
    {
      "sha": "40dcce7dca53bb089cb5a31cbbd95a21a8acea83",
      "filename": "gas/config/tc-avr.c",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-avr.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-avr.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-avr.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -1548,7 +1548,7 @@ md_apply_fix (fixS *fixP, valueT * valP, segT seg)\n              fixP->fx_r_type = BFD_RELOC_AVR_DIFF32;\n              break;\n            default:\n-             as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+             as_bad_subtract (fixP);\n              break;\n          }\n \n@@ -1560,7 +1560,7 @@ md_apply_fix (fixS *fixP, valueT * valP, segT seg)\n   }\n   /* We don't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   /* For the DIFF relocs, write the value into the object file while still\n      keeping fx_done FALSE, as both the difference (recorded in the object file)\n@@ -1824,7 +1824,7 @@ tc_gen_reloc (asection *seg ATTRIBUTE_UNUSED,\n \n   if (fixp->fx_subsy != NULL)\n     {\n-      as_bad_where (fixp->fx_file, fixp->fx_line, _(\"expression too complex\"));\n+      as_bad_subtract (fixp);\n       return NULL;\n     }\n "
    },
    {
      "sha": "8925650b592056cd765d9f314efba3ac9395c965",
      "filename": "gas/config/tc-cr16.c",
      "status": "modified",
      "additions": 4,
      "deletions": 8,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-cr16.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-cr16.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-cr16.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -573,14 +573,10 @@ tc_gen_reloc (asection *section ATTRIBUTE_UNUSED, fixS * fixP)\n       else\n \t{\n \t  /* We only resolve difference expressions in the same section.  */\n-\t  as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t\t_(\"can't resolve `%s' {%s section} - `%s' {%s section}\"),\n-\t\t\tfixP->fx_addsy ? S_GET_NAME (fixP->fx_addsy) : \"0\",\n-\t\t\tsegment_name (fixP->fx_addsy\n-\t\t\t\t      ? S_GET_SEGMENT (fixP->fx_addsy)\n-\t\t\t\t      : absolute_section),\n-\t\t\tS_GET_NAME (fixP->fx_subsy),\n-\t\t\tsegment_name (S_GET_SEGMENT (fixP->fx_addsy)));\n+\t  as_bad_subtract (fixP);\n+\t  free (reloc->sym_ptr_ptr);\n+\t  free (reloc);\n+\t  return NULL;\n \t}\n     }\n #ifdef OBJ_ELF"
    },
    {
      "sha": "02ce2acfe006d1191eec9caad4143093a535f58c",
      "filename": "gas/config/tc-cris.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-cris.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-cris.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-cris.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -4050,8 +4050,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg)\n \n   /* We can't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t  _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   /* This operand-type is scaled.  */\n   if (fixP->fx_r_type == BFD_RELOC_CRIS_LAPCQ_OFFSET)"
    },
    {
      "sha": "ebf38f69538d3b5d6f487c900d1f58c3b2505be1",
      "filename": "gas/config/tc-crx.c",
      "status": "modified",
      "additions": 4,
      "deletions": 8,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-crx.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-crx.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-crx.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -317,14 +317,10 @@ tc_gen_reloc (asection *section ATTRIBUTE_UNUSED, fixS * fixP)\n       else\n \t{\n \t  /* We only resolve difference expressions in the same section.  */\n-\t  as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t\t_(\"can't resolve `%s' {%s section} - `%s' {%s section}\"),\n-\t\t\tfixP->fx_addsy ? S_GET_NAME (fixP->fx_addsy) : \"0\",\n-\t\t\tsegment_name (fixP->fx_addsy\n-\t\t\t\t      ? S_GET_SEGMENT (fixP->fx_addsy)\n-\t\t\t\t      : absolute_section),\n-\t\t\tS_GET_NAME (fixP->fx_subsy),\n-\t\t\tsegment_name (S_GET_SEGMENT (fixP->fx_addsy)));\n+\t  as_bad_subtract (fixP);\n+\t  free (reloc->sym_ptr_ptr);\n+\t  free (reloc);\n+\t  return NULL;\n \t}\n     }\n "
    },
    {
      "sha": "b6437b113521f8c01fc321239a3df153007599d5",
      "filename": "gas/config/tc-d10v.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-d10v.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-d10v.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-d10v.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -1503,7 +1503,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n \n   /* We don't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   op_type = fixP->fx_r_type;\n   if (op_type & 2048)"
    },
    {
      "sha": "c48e4a3bba378aad393c3ca7bbe95a05af3cd5b4",
      "filename": "gas/config/tc-d30v.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-d30v.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-d30v.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-d30v.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -1906,7 +1906,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n \n   /* We don't support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   /* Fetch the instruction, insert the fully resolved operand\n      value, and stuff the instruction back again.  */"
    },
    {
      "sha": "928920f82e71975ccc5b2341a63a156c4e4df9b6",
      "filename": "gas/config/tc-ft32.c",
      "status": "modified",
      "additions": 2,
      "deletions": 3,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-ft32.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-ft32.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-ft32.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -570,8 +570,7 @@ md_apply_fix (fixS *fixP ATTRIBUTE_UNUSED,\n              fixP->fx_r_type = BFD_RELOC_FT32_DIFF32;\n              break;\n            default:\n-             as_bad_where (fixP->fx_file, fixP->fx_line,\n-                           _(\"expression too complex\"));\n+             as_bad_subtract (fixP);\n              break;\n          }\n \n@@ -584,7 +583,7 @@ md_apply_fix (fixS *fixP ATTRIBUTE_UNUSED,\n \n   /* We don't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   switch (fixP->fx_r_type)\n     {"
    },
    {
      "sha": "545c15e6ac691c98e461f8ddfc7036f4910b3d70",
      "filename": "gas/config/tc-h8300.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-h8300.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-h8300.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-h8300.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -2298,8 +2298,7 @@ tc_gen_reloc (asection *section ATTRIBUTE_UNUSED, fixS *fixp)\n       if ((S_GET_SEGMENT (fixp->fx_addsy) != S_GET_SEGMENT (fixp->fx_subsy))\n \t  || S_GET_SEGMENT (fixp->fx_addsy) == undefined_section)\n \t{\n-\t  as_bad_where (fixp->fx_file, fixp->fx_line,\n-\t\t\t_(\"Difference of symbols in different sections is not supported\"));\n+\t  as_bad_subtract (fixp);\n \t  return NULL;\n \t}\n     }"
    },
    {
      "sha": "a6e876c3f912cdf035006283ec09d9c74575b78b",
      "filename": "gas/config/tc-m68hc11.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-m68hc11.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-m68hc11.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-m68hc11.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -4334,7 +4334,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n \n   /* We don't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"Expression too complex.\"));\n+    as_bad_subtract (fixP);\n \n   /* Patch the instruction with the resolved operand.  Elf relocation\n      info will also be generated to take care of linker/loader fixups."
    },
    {
      "sha": "04a799a5a690bc9e3a7ee844a2d58b3a794f8b81",
      "filename": "gas/config/tc-mmix.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-mmix.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-mmix.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-mmix.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -3742,8 +3742,7 @@ mmix_frob_file (void)\n       /* This case isn't doable in general anyway, methinks.  */\n       if (fixP->fx_subsy != NULL)\n \t{\n-\t  as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t\t_(\"GREG expression too complicated\"));\n+\t  as_bad_subtract (fixP);\n \t  continue;\n \t}\n "
    },
    {
      "sha": "cbec5652dfad2196b7dfea56dcf98db8bcd5a51b",
      "filename": "gas/config/tc-mn10200.c",
      "status": "modified",
      "additions": 1,
      "deletions": 8,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-mn10200.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-mn10200.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-mn10200.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -762,14 +762,7 @@ tc_gen_reloc (asection *seg ATTRIBUTE_UNUSED, fixS *fixp)\n \t/* FIXME: We should try more ways to resolve difference expressions\n \t   here.  At least this is better than silently ignoring the\n \t   subtrahend.  */\n-\tas_bad_where (fixp->fx_file, fixp->fx_line,\n-\t\t      _(\"can't resolve `%s' {%s section} - `%s' {%s section}\"),\n-\t\t      fixp->fx_addsy ? S_GET_NAME (fixp->fx_addsy) : \"0\",\n-\t\t      segment_name (fixp->fx_addsy\n-\t\t\t\t    ? S_GET_SEGMENT (fixp->fx_addsy)\n-\t\t\t\t    : absolute_section),\n-\t\t      S_GET_NAME (fixp->fx_subsy),\n-\t\t      segment_name (S_GET_SEGMENT (fixp->fx_addsy)));\n+\tas_bad_subtract (fixp);\n     }\n \n   reloc->howto = bfd_reloc_type_lookup (stdoutput, fixp->fx_r_type);"
    },
    {
      "sha": "0ab436c5f19cd405ec84d731ec467b7cc2ff5507",
      "filename": "gas/config/tc-nds32.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-nds32.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-nds32.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-nds32.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -7825,8 +7825,7 @@ nds32_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n \t  /* cvt_frag_to_fill () has called output_leb128 () for us.  */\n \t  break;\n \tdefault:\n-\t  as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t\t_(\"expression too complex\"));\n+\t  as_bad_subtract (fixP);\n \t  return;\n \t}\n     }"
    },
    {
      "sha": "3eaeb892387422300b61c4a63aeb527258392070",
      "filename": "gas/config/tc-ppc.c",
      "status": "modified",
      "additions": 6,
      "deletions": 4,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-ppc.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-ppc.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-ppc.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -7476,7 +7476,7 @@ tc_gen_reloc (asection *seg ATTRIBUTE_UNUSED, fixS *fixp)\n     }\n   reloc->addend = fixp->fx_addnumber;\n \n-  if (fixp->fx_subsy && fixp->fx_addsy)\n+  if (fixp->fx_subsy != NULL)\n     {\n       relocs[1] = reloc = XNEW (arelent);\n       relocs[2] = NULL;\n@@ -7490,9 +7490,11 @@ tc_gen_reloc (asection *seg ATTRIBUTE_UNUSED, fixS *fixp)\n \n       if (reloc->howto == (reloc_howto_type *) NULL)\n         {\n-          as_bad_where (fixp->fx_file, fixp->fx_line,\n-            _(\"reloc %d not supported by object file format\"),\n-            BFD_RELOC_PPC_NEG);\n+\t  as_bad_subtract (fixp);\n+\t  free (relocs[1]->sym_ptr_ptr);\n+\t  free (relocs[1]);\n+\t  free (relocs[0]->sym_ptr_ptr);\n+\t  free (relocs[0]);\n \t  relocs[0] = NULL;\n         }\n     }"
    },
    {
      "sha": "16678b1333305c6ab059cdc6ff8a363781f7185d",
      "filename": "gas/config/tc-pru.c",
      "status": "modified",
      "additions": 2,
      "deletions": 3,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-pru.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-pru.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-pru.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -742,8 +742,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n \t  diffval /= 4;\n \t  break;\n \tdefault:\n-\t  as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t\t_(\"expression too complex\"));\n+\t  as_bad_subtract (fixP);\n \t  break;\n \t}\n \n@@ -753,7 +752,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n   }\n   /* We don't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   /* For the DIFF relocs, write the value into the object file while still\n      keeping fx_done FALSE, as both the difference (recorded in the object file)"
    },
    {
      "sha": "460667e4349f6b8685b18ae700631b0848181c4c",
      "filename": "gas/config/tc-riscv.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-riscv.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -3201,8 +3201,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n     }\n \n   if (fixP->fx_subsy != NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t  _(\"unsupported symbol subtraction\"));\n+    as_bad_subtract (fixP);\n \n   /* Add an R_RISCV_RELAX reloc if the reloc is relaxable.  */\n   if (relaxable && fixP->fx_tcbit && fixP->fx_addsy != NULL)"
    },
    {
      "sha": "11a412d33ca5a053b6e102c8a0f4649149d73b4c",
      "filename": "gas/config/tc-s12z.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-s12z.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-s12z.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-s12z.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -3933,7 +3933,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n \n   /* We don't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"Expression too complex.\"));\n+    as_bad_subtract (fixP);\n \n   /*\n     Patch the instruction with the resolved operand.  Elf relocation"
    },
    {
      "sha": "a203436878de46118b40e786054136a573c158ce",
      "filename": "gas/config/tc-s390.c",
      "status": "modified",
      "additions": 1,
      "deletions": 4,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-s390.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-s390.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-s390.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -2254,10 +2254,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n   where = fixP->fx_frag->fr_literal + fixP->fx_where;\n \n   if (fixP->fx_subsy != NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t  _(\"cannot emit relocation %s against subsy symbol %s\"),\n-\t\t  bfd_get_reloc_code_name (fixP->fx_r_type),\n-\t\t  S_GET_NAME (fixP->fx_subsy));\n+    as_bad_subtract (fixP);\n \n   if (fixP->fx_addsy != NULL)\n     {"
    },
    {
      "sha": "11fafa1a390541ee7da6d20214039f8126ca99c3",
      "filename": "gas/config/tc-spu.c",
      "status": "modified",
      "additions": 4,
      "deletions": 7,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-spu.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-spu.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-spu.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -868,19 +868,16 @@ tc_gen_reloc (asection *seg ATTRIBUTE_UNUSED, fixS *fixp)\n   arelent *reloc;\n   reloc = XNEW (arelent);\n   reloc->sym_ptr_ptr = XNEW (asymbol *);\n-  if (fixp->fx_addsy)\n-    *reloc->sym_ptr_ptr = symbol_get_bfdsym (fixp->fx_addsy);\n-  else if (fixp->fx_subsy)\n-    *reloc->sym_ptr_ptr = symbol_get_bfdsym (fixp->fx_subsy);\n-  else\n-    abort ();\n+  *reloc->sym_ptr_ptr = symbol_get_bfdsym (fixp->fx_addsy);\n   reloc->address = fixp->fx_frag->fr_address + fixp->fx_where;\n   reloc->howto = bfd_reloc_type_lookup (stdoutput, fixp->fx_r_type);\n   if (reloc->howto == (reloc_howto_type *) NULL)\n     {\n       as_bad_where (fixp->fx_file, fixp->fx_line,\n \t\t    _(\"reloc %d not supported by object file format\"),\n \t\t    (int) fixp->fx_r_type);\n+      free (reloc->sym_ptr_ptr);\n+      free (reloc);\n       return NULL;\n     }\n   reloc->addend = fixp->fx_addnumber;\n@@ -957,7 +954,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n   if (fixP->fx_subsy != (symbolS *) NULL)\n     {\n       /* We can't actually support subtracting a symbol.  */\n-      as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+      as_bad_subtract (fixP);\n     }\n \n   if (fixP->fx_addsy != NULL)"
    },
    {
      "sha": "97062c0d3652ad7e7007c62b6ce75523a6a56a6c",
      "filename": "gas/config/tc-tilegx.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-tilegx.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-tilegx.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-tilegx.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -1476,7 +1476,7 @@ md_apply_fix (fixS *fixP, valueT * valP, segT seg ATTRIBUTE_UNUSED)\n   if (fixP->fx_subsy != (symbolS *) NULL)\n     {\n       /* We can't actually support subtracting a symbol.  */\n-      as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+      as_bad_subtract (fixP);\n     }\n \n   /* Correct relocation types for pc-relativeness.  */"
    },
    {
      "sha": "11893bc34caa7588e890f8a92b54d2141274bd5a",
      "filename": "gas/config/tc-tilepro.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-tilepro.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-tilepro.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-tilepro.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -1334,7 +1334,7 @@ md_apply_fix (fixS *fixP, valueT * valP, segT seg ATTRIBUTE_UNUSED)\n   if (fixP->fx_subsy != (symbolS *) NULL)\n     {\n       /* We can't actually support subtracting a symbol.  */\n-      as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+      as_bad_subtract (fixP);\n     }\n \n   /* Correct relocation types for pc-relativeness.  */"
    },
    {
      "sha": "81449d05741bdf506010eb91497863c727f1ccca",
      "filename": "gas/config/tc-v850.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-v850.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-v850.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-v850.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -3447,8 +3447,7 @@ md_apply_fix (fixS *fixP, valueT *valueP, segT seg ATTRIBUTE_UNUSED)\n \t    value -= S_GET_VALUE (fixP->fx_subsy);\n \t  else\n \t    /* We don't actually support subtracting a symbol.  */\n-\t    as_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t\t  _(\"expression too complex\"));\n+\t    as_bad_subtract (fixP);\n \t}\n       fixP->fx_addnumber = value;\n     }"
    },
    {
      "sha": "efffc7d1fd2884099e1cd1c3473fccbe8bcee387",
      "filename": "gas/config/tc-vax.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-vax.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-vax.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-vax.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -279,7 +279,7 @@ md_apply_fix (fixS *fixP, valueT *valueP, segT seg ATTRIBUTE_UNUSED)\n   valueT value = * valueP;\n \n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   if (fixP->fx_addsy == NULL)\n     fixP->fx_done = 1;"
    },
    {
      "sha": "12d90703153ef3b8e8ebddf594262ac889e29987",
      "filename": "gas/config/tc-xc16x.c",
      "status": "modified",
      "additions": 2,
      "deletions": 3,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-xc16x.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-xc16x.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-xc16x.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -283,13 +283,12 @@ tc_gen_reloc (asection *section ATTRIBUTE_UNUSED, fixS *fixp)\n   arelent *rel;\n   bfd_reloc_code_real_type r_type;\n \n-  if (fixp->fx_addsy && fixp->fx_subsy)\n+  if (fixp->fx_subsy)\n     {\n       if ((S_GET_SEGMENT (fixp->fx_addsy) != S_GET_SEGMENT (fixp->fx_subsy))\n \t  || S_GET_SEGMENT (fixp->fx_addsy) == undefined_section)\n \t{\n-\t  as_bad_where (fixp->fx_file, fixp->fx_line,\n-\t\t\t_(\"Difference of symbols in different sections is not supported\"));\n+\t  as_bad_subtract (fixp);\n \t  return NULL;\n \t}\n     }"
    },
    {
      "sha": "f97540a32dcaa1cf23984ac1768bd489b347f8ac",
      "filename": "gas/config/tc-xgate.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-xgate.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-xgate.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-xgate.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -660,7 +660,7 @@ md_apply_fix (fixS * fixP, valueT * valP, segT seg ATTRIBUTE_UNUSED)\n \n   /* We don't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"Expression too complex.\"));\n+    as_bad_subtract (fixP);\n \n   where = fixP->fx_frag->fr_literal + fixP->fx_where;\n   opcode = bfd_getl16 (where);"
    },
    {
      "sha": "deb10810b06c2f5f755ce02ee120a2e22e0d3648",
      "filename": "gas/config/tc-xstormy16.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-xstormy16.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-xstormy16.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-xstormy16.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -479,7 +479,7 @@ xstormy16_md_apply_fix (fixS *   fixP,\n \n   /* We don't actually support subtracting a symbol.  */\n   if (fixP->fx_subsy != (symbolS *) NULL)\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   if ((int) fixP->fx_r_type >= (int) BFD_RELOC_UNUSED)\n     {"
    },
    {
      "sha": "b8634f782f88ec213fd4a846b8cb63805ea538be",
      "filename": "gas/config/tc-xtensa.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-xtensa.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-xtensa.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-xtensa.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -6006,7 +6006,7 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg)\n   if (fixP->fx_subsy && !(linkrelax && (fixP->fx_r_type == BFD_RELOC_32\n \t\t\t\t\t|| fixP->fx_r_type == BFD_RELOC_16\n \t\t\t\t\t|| fixP->fx_r_type == BFD_RELOC_8)))\n-    as_bad_where (fixP->fx_file, fixP->fx_line, _(\"expression too complex\"));\n+    as_bad_subtract (fixP);\n \n   switch (fixP->fx_r_type)\n     {"
    },
    {
      "sha": "052982fc65e13b33b562aa70ee66ac100890699d",
      "filename": "gas/config/tc-z80.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-z80.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/config/tc-z80.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-z80.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -3853,7 +3853,7 @@ tc_gen_reloc (asection *seg ATTRIBUTE_UNUSED , fixS *fixp)\n \n   if (fixp->fx_subsy != NULL)\n     {\n-      as_bad_where (fixp->fx_file, fixp->fx_line, _(\"expression too complex\"));\n+      as_bad_subtract (fixp);\n       return NULL;\n     }\n "
    },
    {
      "sha": "280a0c60d1bf8909d177f53bd1d81922d841caf4",
      "filename": "gas/testsuite/gas/i386/ifunc-2.l",
      "status": "modified",
      "additions": 60,
      "deletions": 60,
      "changes": 120,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/testsuite/gas/i386/ifunc-2.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/testsuite/gas/i386/ifunc-2.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/ifunc-2.l?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -1,61 +1,61 @@\n .*/ifunc-2\\.s: Assembler messages:\n-.*/ifunc-2\\.s:4: Error: can't resolve `bar1' {\\.text\\.1 section} - `foo1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:5: Error: can't resolve `bar2' {\\.text\\.2 section} - `foo2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:6: Error: can't resolve `bar1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:7: Error: can't resolve `bar2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:8: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:9: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:10: Error: can't resolve `bar1' {\\.text\\.1 section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:11: Error: can't resolve `abs1' {\\*ABS\\* section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:12: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:19: Error: can't resolve `bar1' {\\.text\\.1 section} - `foo1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:20: Error: can't resolve `bar2' {\\.text\\.2 section} - `foo2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:21: Error: can't resolve `bar1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:22: Error: can't resolve `bar2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:23: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:24: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:25: Error: can't resolve `bar1' {\\.text\\.1 section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:26: Error: can't resolve `abs1' {\\*ABS\\* section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:27: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:34: Error: can't resolve `bar1' {\\.text\\.1 section} - `foo1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:35: Error: can't resolve `bar2' {\\.text\\.2 section} - `foo2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:36: Error: can't resolve `bar1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:37: Error: can't resolve `bar2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:38: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:39: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:40: Error: can't resolve `bar1' {\\.text\\.1 section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:41: Error: can't resolve `abs1' {\\*ABS\\* section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:42: Error: can't resolve `\\.text\\.1' {\\.text\\.1 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:44: Error: can't resolve `abs1' {\\*ABS\\* section} - `abs2' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:45: Error: can't resolve `abs2' {\\*ABS\\* section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:50: Error: can't resolve `abs1' {\\*ABS\\* section} - `abs2' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:51: Error: can't resolve `abs2' {\\*ABS\\* section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:56: Error: can't resolve `abs1' {\\*ABS\\* section} - `abs2' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:57: Error: can't resolve `abs2' {\\*ABS\\* section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:62: Error: can't resolve `bar1' {\\.text\\.1 section} - `foo1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:63: Error: can't resolve `bar2' {\\.text\\.2 section} - `foo2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:64: Error: can't resolve `bar1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:65: Error: can't resolve `bar2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:66: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:67: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:68: Error: can't resolve `bar2' {\\.text\\.2 section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:69: Error: can't resolve `abs1' {\\*ABS\\* section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:70: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:77: Error: can't resolve `bar1' {\\.text\\.1 section} - `foo1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:78: Error: can't resolve `bar2' {\\.text\\.2 section} - `foo2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:79: Error: can't resolve `bar1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:80: Error: can't resolve `bar2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:81: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:82: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:83: Error: can't resolve `bar2' {\\.text\\.2 section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:84: Error: can't resolve `abs1' {\\*ABS\\* section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:85: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:92: Error: can't resolve `bar1' {\\.text\\.1 section} - `foo1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:93: Error: can't resolve `bar2' {\\.text\\.2 section} - `foo2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:94: Error: can't resolve `bar1' {\\.text\\.1 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:95: Error: can't resolve `bar2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:96: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar1' {\\.text\\.1 section}\n-.*/ifunc-2\\.s:97: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:98: Error: can't resolve `bar2' {\\.text\\.2 section} - `abs1' {\\*ABS\\* section}\n-.*/ifunc-2\\.s:99: Error: can't resolve `abs1' {\\*ABS\\* section} - `bar2' {\\.text\\.2 section}\n-.*/ifunc-2\\.s:100: Error: can't resolve `\\.text\\.2' {\\.text\\.2 section} - `bar2' {\\.text\\.2 section}\n+.*/ifunc-2\\.s:4: Error: can't resolve bar1 - foo1\n+.*/ifunc-2\\.s:5: Error: can't resolve bar2 - foo2\n+.*/ifunc-2\\.s:6: Error: can't resolve bar1 - bar2\n+.*/ifunc-2\\.s:7: Error: can't resolve bar2 - bar1\n+.*/ifunc-2\\.s:8: Error: can't resolve \\.text\\.1 - bar1\n+.*/ifunc-2\\.s:9: Error: can't resolve \\.text\\.1 - bar2\n+.*/ifunc-2\\.s:10: Error: can't resolve bar1 - abs1\n+.*/ifunc-2\\.s:11: Error: can't resolve abs1 - bar1\n+.*/ifunc-2\\.s:12: Error: can't resolve \\.text\\.1 - bar1\n+.*/ifunc-2\\.s:19: Error: can't resolve bar1 - foo1\n+.*/ifunc-2\\.s:20: Error: can't resolve bar2 - foo2\n+.*/ifunc-2\\.s:21: Error: can't resolve bar1 - bar2\n+.*/ifunc-2\\.s:22: Error: can't resolve bar2 - bar1\n+.*/ifunc-2\\.s:23: Error: can't resolve \\.text\\.1 - bar1\n+.*/ifunc-2\\.s:24: Error: can't resolve \\.text\\.1 - bar2\n+.*/ifunc-2\\.s:25: Error: can't resolve bar1 - abs1\n+.*/ifunc-2\\.s:26: Error: can't resolve abs1 - bar1\n+.*/ifunc-2\\.s:27: Error: can't resolve \\.text\\.1 - bar1\n+.*/ifunc-2\\.s:34: Error: can't resolve bar1 - foo1\n+.*/ifunc-2\\.s:35: Error: can't resolve bar2 - foo2\n+.*/ifunc-2\\.s:36: Error: can't resolve bar1 - bar2\n+.*/ifunc-2\\.s:37: Error: can't resolve bar2 - bar1\n+.*/ifunc-2\\.s:38: Error: can't resolve \\.text\\.1 - bar1\n+.*/ifunc-2\\.s:39: Error: can't resolve \\.text\\.1 - bar2\n+.*/ifunc-2\\.s:40: Error: can't resolve bar1 - abs1\n+.*/ifunc-2\\.s:41: Error: can't resolve abs1 - bar1\n+.*/ifunc-2\\.s:42: Error: can't resolve \\.text\\.1 - bar1\n+.*/ifunc-2\\.s:44: Error: can't resolve abs1 - abs2\n+.*/ifunc-2\\.s:45: Error: can't resolve abs2 - abs1\n+.*/ifunc-2\\.s:50: Error: can't resolve abs1 - abs2\n+.*/ifunc-2\\.s:51: Error: can't resolve abs2 - abs1\n+.*/ifunc-2\\.s:56: Error: can't resolve abs1 - abs2\n+.*/ifunc-2\\.s:57: Error: can't resolve abs2 - abs1\n+.*/ifunc-2\\.s:62: Error: can't resolve bar1 - foo1\n+.*/ifunc-2\\.s:63: Error: can't resolve bar2 - foo2\n+.*/ifunc-2\\.s:64: Error: can't resolve bar1 - bar2\n+.*/ifunc-2\\.s:65: Error: can't resolve bar2 - bar1\n+.*/ifunc-2\\.s:66: Error: can't resolve \\.text\\.2 - bar1\n+.*/ifunc-2\\.s:67: Error: can't resolve \\.text\\.2 - bar2\n+.*/ifunc-2\\.s:68: Error: can't resolve bar2 - abs1\n+.*/ifunc-2\\.s:69: Error: can't resolve abs1 - bar2\n+.*/ifunc-2\\.s:70: Error: can't resolve \\.text\\.2 - bar2\n+.*/ifunc-2\\.s:77: Error: can't resolve bar1 - foo1\n+.*/ifunc-2\\.s:78: Error: can't resolve bar2 - foo2\n+.*/ifunc-2\\.s:79: Error: can't resolve bar1 - bar2\n+.*/ifunc-2\\.s:80: Error: can't resolve bar2 - bar1\n+.*/ifunc-2\\.s:81: Error: can't resolve \\.text\\.2 - bar1\n+.*/ifunc-2\\.s:82: Error: can't resolve \\.text\\.2 - bar2\n+.*/ifunc-2\\.s:83: Error: can't resolve bar2 - abs1\n+.*/ifunc-2\\.s:84: Error: can't resolve abs1 - bar2\n+.*/ifunc-2\\.s:85: Error: can't resolve \\.text\\.2 - bar2\n+.*/ifunc-2\\.s:92: Error: can't resolve bar1 - foo1\n+.*/ifunc-2\\.s:93: Error: can't resolve bar2 - foo2\n+.*/ifunc-2\\.s:94: Error: can't resolve bar1 - bar2\n+.*/ifunc-2\\.s:95: Error: can't resolve bar2 - bar1\n+.*/ifunc-2\\.s:96: Error: can't resolve \\.text\\.2 - bar1\n+.*/ifunc-2\\.s:97: Error: can't resolve \\.text\\.2 - bar2\n+.*/ifunc-2\\.s:98: Error: can't resolve bar2 - abs1\n+.*/ifunc-2\\.s:99: Error: can't resolve abs1 - bar2\n+.*/ifunc-2\\.s:100: Error: can't resolve \\.text\\.2 - bar2"
    },
    {
      "sha": "713bd79804897091adea6a2344b510f356f39ac0",
      "filename": "gas/testsuite/gas/mips/lui-2.l",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/testsuite/gas/mips/lui-2.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/testsuite/gas/mips/lui-2.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/mips/lui-2.l?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -1,5 +1,5 @@\n .*\\.s: Assembler messages:\n .*\\.s:10: Error: invalid operands \\(\\*UND\\* and \\*UND\\* sections\\) for `/'\n .*\\.s:7: Error: PC-relative reference to a different section\n-.*\\.s:8: Error: can't resolve `baz' {\\*UND\\* section} - `bar' {\\*UND\\* section}\n-.*\\.s:9: Error: can't resolve `\\.text' {\\.text section} - `baz' {\\*UND\\* section}\n+.*\\.s:8: Error: can't resolve baz - bar\n+.*\\.s:9: Error: can't resolve \\.text - baz"
    },
    {
      "sha": "29272121cc2e4f98e400a2603c1d73a4e2d00b5a",
      "filename": "gas/testsuite/gas/tic6x/reloc-bad-1.l",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/testsuite/gas/tic6x/reloc-bad-1.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/testsuite/gas/tic6x/reloc-bad-1.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/tic6x/reloc-bad-1.l?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -1,2 +1,2 @@\n [^:]*: Assembler messages:\n-[^:]*:8: Error: can't resolve `a' \\{\\*UND\\* section\\} - `b' \\{\\*UND\\* section\\}\n+[^:]*:8: Error: can't resolve a - b"
    },
    {
      "sha": "253dfc476f8c9cd894f5debd4cf4a93ed03f9b52",
      "filename": "gas/write.c",
      "status": "modified",
      "additions": 10,
      "deletions": 6,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/write.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/write.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/write.c?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -899,6 +899,15 @@ adjust_reloc_syms (bfd *abfd ATTRIBUTE_UNUSED,\n   dump_section_relocs (abfd, sec, stderr);\n }\n \n+void\n+as_bad_subtract (fixS *fixp)\n+{\n+  as_bad_where (fixp->fx_file, fixp->fx_line,\n+\t\t_(\"can't resolve %s - %s\"),\n+\t\tfixp->fx_addsy ? S_GET_NAME (fixp->fx_addsy) : \"0\",\n+\t\tS_GET_NAME (fixp->fx_subsy));\n+}\n+\n /* fixup_segment()\n \n    Go through all the fixS's in a segment and see which ones can be\n@@ -1021,12 +1030,7 @@ fixup_segment (fixS *fixP, segT this_segment)\n \t\tas_bad_where (fixP->fx_file, fixP->fx_line,\n \t\t\t      _(\"register value used as expression\"));\n \t      else\n-\t\tas_bad_where (fixP->fx_file, fixP->fx_line,\n-\t\t\t      _(\"can't resolve `%s' {%s section} - `%s' {%s section}\"),\n-\t\t\t      fixP->fx_addsy ? S_GET_NAME (fixP->fx_addsy) : \"0\",\n-\t\t\t      segment_name (add_symbol_segment),\n-\t\t\t      S_GET_NAME (fixP->fx_subsy),\n-\t\t\t      segment_name (sub_symbol_segment));\n+\t\tas_bad_subtract (fixP);\n \t    }\n \t  else if (sub_symbol_segment != undefined_section\n \t\t   && ! bfd_is_com_section (sub_symbol_segment)"
    },
    {
      "sha": "74d07bff0eac237ddec1c9a5b4b6e94c8253f6c9",
      "filename": "gas/write.h",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/write.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4bf094292c72b6d316a72ddc60739466c5085d3d/gas/write.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/write.h?ref=4bf094292c72b6d316a72ddc60739466c5085d3d",
      "patch": "@@ -184,5 +184,6 @@ extern fixS *fix_at_start (fragS *, unsigned long, symbolS *,\n extern fixS *fix_new_exp (fragS *, unsigned long, unsigned long,\n \t\t\t  expressionS *, int, bfd_reloc_code_real_type);\n extern void write_print_statistics (FILE *);\n+extern void as_bad_subtract (fixS *);\n \n #endif /* __write_h__ */"
    }
  ]
}