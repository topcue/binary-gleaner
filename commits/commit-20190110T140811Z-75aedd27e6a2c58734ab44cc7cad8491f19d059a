{
  "sha": "75aedd27e6a2c58734ab44cc7cad8491f19d059a",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NzVhZWRkMjdlNmEyYzU4NzM0YWI0NGNjN2NhZDg0OTFmMTlkMDU5YQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2018-05-10T22:23:46Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-01-10T14:08:11Z"
    },
    "message": "Change add_psymbol_to_list to use an enum\n\nThis changes add_psymbol_to_list to use an enum, rather than a pointer\nto a vector, to decide where to put the new symbol.  This reduces the\nnumber of direct references to the static_psymbols and global_psymbols\nmembers of the objfile, which is handy in a later patch.\n\ngdb/ChangeLog\n2019-01-10  Tom Tromey  <tom@tromey.com>\n\n\t* xcoffread.c (scan_xcoff_symtab): Update.\n\t* psymtab.c (add_psymbol_to_list): Replace \"list\" parameter with\n\t\"where\".\n\t* mdebugread.c (parse_partial_symbols)\n\t(handle_psymbol_enumerators): Update.\n\t* dwarf2read.c (add_partial_symbol, load_partial_dies): Update.\n\t* dbxread.c (read_dbx_symtab): Update.\n\t* psympriv.h (psymbol_placement): New enum.\n\t(add_psymbol_to_list): Update.",
    "tree": {
      "sha": "6208568d9314888fffc6755303e953fa4064090a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6208568d9314888fffc6755303e953fa4064090a"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/75aedd27e6a2c58734ab44cc7cad8491f19d059a",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/75aedd27e6a2c58734ab44cc7cad8491f19d059a",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/75aedd27e6a2c58734ab44cc7cad8491f19d059a",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/75aedd27e6a2c58734ab44cc7cad8491f19d059a/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "939652a515a10654b16b97e7e2ea39c013714850",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/939652a515a10654b16b97e7e2ea39c013714850",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/939652a515a10654b16b97e7e2ea39c013714850"
    }
  ],
  "stats": {
    "total": 143,
    "additions": 81,
    "deletions": 62
  },
  "files": [
    {
      "sha": "e00047c27d5b4996c031f6d653355cf4903c9973",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=75aedd27e6a2c58734ab44cc7cad8491f19d059a",
      "patch": "@@ -1,3 +1,15 @@\n+2019-01-10  Tom Tromey  <tom@tromey.com>\n+\n+\t* xcoffread.c (scan_xcoff_symtab): Update.\n+\t* psymtab.c (add_psymbol_to_list): Replace \"list\" parameter with\n+\t\"where\".\n+\t* mdebugread.c (parse_partial_symbols)\n+\t(handle_psymbol_enumerators): Update.\n+\t* dwarf2read.c (add_partial_symbol, load_partial_dies): Update.\n+\t* dbxread.c (read_dbx_symtab): Update.\n+\t* psympriv.h (psymbol_placement): New enum.\n+\t(add_psymbol_to_list): Update.\n+\n 2019-01-10  Tom Tromey  <tom@tromey.com>\n \n \t* xcoffread.c (xcoff_start_psymtab): Remove global_psymbols and"
    },
    {
      "sha": "73e436f4f62fe5f3d5d0ef24f4e9cdf6882788fa",
      "filename": "gdb/dbxread.c",
      "status": "modified",
      "additions": 9,
      "deletions": 9,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/dbxread.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/dbxread.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/dbxread.c?ref=75aedd27e6a2c58734ab44cc7cad8491f19d059a",
      "patch": "@@ -1476,7 +1476,7 @@ read_dbx_symtab (minimal_symbol_reader &reader, struct objfile *objfile)\n \t      add_psymbol_to_list (sym_name, sym_len, 1,\n \t\t\t\t   VAR_DOMAIN, LOC_STATIC,\n \t\t\t\t   data_sect_index,\n-\t\t\t\t   &objfile->static_psymbols,\n+\t\t\t\t   psymbol_placement::STATIC,\n \t\t\t\t   nlist.n_value, psymtab_language, objfile);\n \t      continue;\n \n@@ -1486,7 +1486,7 @@ read_dbx_symtab (minimal_symbol_reader &reader, struct objfile *objfile)\n \t      add_psymbol_to_list (sym_name, sym_len, 1,\n \t\t\t\t   VAR_DOMAIN, LOC_STATIC,\n \t\t\t\t   data_sect_index,\n-\t\t\t\t   &objfile->global_psymbols,\n+\t\t\t\t   psymbol_placement::GLOBAL,\n \t\t\t\t   nlist.n_value, psymtab_language, objfile);\n \t      continue;\n \n@@ -1503,14 +1503,14 @@ read_dbx_symtab (minimal_symbol_reader &reader, struct objfile *objfile)\n \t\t{\n \t\t  add_psymbol_to_list (sym_name, sym_len, 1,\n \t\t\t\t       STRUCT_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t\t       &objfile->static_psymbols,\n+\t\t\t\t       psymbol_placement::STATIC,\n \t\t\t\t       0, psymtab_language, objfile);\n \t\t  if (p[2] == 't')\n \t\t    {\n \t\t      /* Also a typedef with the same name.  */\n \t\t      add_psymbol_to_list (sym_name, sym_len, 1,\n \t\t\t\t\t   VAR_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t\t\t   &objfile->static_psymbols,\n+\t\t\t\t\t   psymbol_placement::STATIC,\n \t\t\t\t\t   0, psymtab_language, objfile);\n \t\t      p += 1;\n \t\t    }\n@@ -1522,7 +1522,7 @@ read_dbx_symtab (minimal_symbol_reader &reader, struct objfile *objfile)\n \t\t{\n \t\t  add_psymbol_to_list (sym_name, sym_len, 1,\n \t\t\t\t       VAR_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t\t       &objfile->static_psymbols,\n+\t\t\t\t       psymbol_placement::STATIC,\n \t\t\t\t       0, psymtab_language, objfile);\n \t\t}\n \t    check_enum:\n@@ -1583,7 +1583,7 @@ read_dbx_symtab (minimal_symbol_reader &reader, struct objfile *objfile)\n \t\t\t enum constants in psymtabs, just in symtabs.  */\n \t\t      add_psymbol_to_list (p, q - p, 1,\n \t\t\t\t\t   VAR_DOMAIN, LOC_CONST, -1,\n-\t\t\t\t\t   &objfile->static_psymbols, 0,\n+\t\t\t\t\t   psymbol_placement::STATIC, 0,\n \t\t\t\t\t   psymtab_language, objfile);\n \t\t      /* Point past the name.  */\n \t\t      p = q;\n@@ -1601,7 +1601,7 @@ read_dbx_symtab (minimal_symbol_reader &reader, struct objfile *objfile)\n \t      /* Constant, e.g. from \"const\" in Pascal.  */\n \t      add_psymbol_to_list (sym_name, sym_len, 1,\n \t\t\t\t   VAR_DOMAIN, LOC_CONST, -1,\n-\t\t\t\t   &objfile->static_psymbols, 0,\n+\t\t\t\t   psymbol_placement::STATIC, 0,\n \t\t\t\t   psymtab_language, objfile);\n \t      continue;\n \n@@ -1657,7 +1657,7 @@ read_dbx_symtab (minimal_symbol_reader &reader, struct objfile *objfile)\n \t      add_psymbol_to_list (sym_name, sym_len, 1,\n \t\t\t\t   VAR_DOMAIN, LOC_BLOCK,\n \t\t\t\t   SECT_OFF_TEXT (objfile),\n-\t\t\t\t   &objfile->static_psymbols,\n+\t\t\t\t   psymbol_placement::STATIC,\n \t\t\t\t   nlist.n_value, psymtab_language, objfile);\n \t      continue;\n \n@@ -1716,7 +1716,7 @@ read_dbx_symtab (minimal_symbol_reader &reader, struct objfile *objfile)\n \t      add_psymbol_to_list (sym_name, sym_len, 1,\n \t\t\t\t   VAR_DOMAIN, LOC_BLOCK,\n \t\t\t\t   SECT_OFF_TEXT (objfile),\n-\t\t\t\t   &objfile->global_psymbols,\n+\t\t\t\t   psymbol_placement::GLOBAL,\n \t\t\t\t   nlist.n_value, psymtab_language, objfile);\n \t      continue;\n "
    },
    {
      "sha": "070a0c2195499098afd35ad062ab531d47160bdd",
      "filename": "gdb/dwarf2read.c",
      "status": "modified",
      "additions": 20,
      "deletions": 25,
      "changes": 45,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/dwarf2read.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/dwarf2read.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/dwarf2read.c?ref=75aedd27e6a2c58734ab44cc7cad8491f19d059a",
      "patch": "@@ -8888,7 +8888,7 @@ add_partial_symbol (struct partial_die_info *pdi, struct dwarf2_cu *cu)\n \t\t\t       built_actual_name != NULL,\n \t\t\t       VAR_DOMAIN, LOC_BLOCK,\n \t\t\t       SECT_OFF_TEXT (objfile),\n-\t\t\t       &objfile->global_psymbols,\n+\t\t\t       psymbol_placement::GLOBAL,\n \t\t\t       addr,\n \t\t\t       cu->language, objfile);\n \t}\n@@ -8898,25 +8898,20 @@ add_partial_symbol (struct partial_die_info *pdi, struct dwarf2_cu *cu)\n \t\t\t       built_actual_name != NULL,\n \t\t\t       VAR_DOMAIN, LOC_BLOCK,\n \t\t\t       SECT_OFF_TEXT (objfile),\n-\t\t\t       &objfile->static_psymbols,\n+\t\t\t       psymbol_placement::STATIC,\n \t\t\t       addr, cu->language, objfile);\n \t}\n \n       if (pdi->main_subprogram && actual_name != NULL)\n \tset_objfile_main_name (objfile, actual_name, cu->language);\n       break;\n     case DW_TAG_constant:\n-      {\n-\tstd::vector<partial_symbol *> *list;\n-\n-\tif (pdi->is_external)\n-\t  list = &objfile->global_psymbols;\n-\telse\n-\t  list = &objfile->static_psymbols;\n-\tadd_psymbol_to_list (actual_name, strlen (actual_name),\n-\t\t\t     built_actual_name != NULL, VAR_DOMAIN, LOC_STATIC,\n-\t\t\t     -1, list, 0, cu->language, objfile);\n-      }\n+      add_psymbol_to_list (actual_name, strlen (actual_name),\n+\t\t\t   built_actual_name != NULL, VAR_DOMAIN, LOC_STATIC,\n+\t\t\t   -1, (pdi->is_external\n+\t\t\t\t? psymbol_placement::GLOBAL\n+\t\t\t\t: psymbol_placement::STATIC),\n+\t\t\t   0, cu->language, objfile);\n       break;\n     case DW_TAG_variable:\n       if (pdi->d.locdesc)\n@@ -8951,7 +8946,7 @@ add_partial_symbol (struct partial_die_info *pdi, struct dwarf2_cu *cu)\n \t\t\t\t built_actual_name != NULL,\n \t\t\t\t VAR_DOMAIN, LOC_STATIC,\n \t\t\t\t SECT_OFF_TEXT (objfile),\n-\t\t\t\t &objfile->global_psymbols,\n+\t\t\t\t psymbol_placement::GLOBAL,\n \t\t\t\t addr, cu->language, objfile);\n \t}\n       else\n@@ -8970,7 +8965,7 @@ add_partial_symbol (struct partial_die_info *pdi, struct dwarf2_cu *cu)\n \t\t\t       built_actual_name != NULL,\n \t\t\t       VAR_DOMAIN, LOC_STATIC,\n \t\t\t       SECT_OFF_TEXT (objfile),\n-\t\t\t       &objfile->static_psymbols,\n+\t\t\t       psymbol_placement::STATIC,\n \t\t\t       has_loc ? addr : 0,\n \t\t\t       cu->language, objfile);\n \t}\n@@ -8981,22 +8976,22 @@ add_partial_symbol (struct partial_die_info *pdi, struct dwarf2_cu *cu)\n       add_psymbol_to_list (actual_name, strlen (actual_name),\n \t\t\t   built_actual_name != NULL,\n \t\t\t   VAR_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t   &objfile->static_psymbols,\n+\t\t\t   psymbol_placement::STATIC,\n \t\t\t   0, cu->language, objfile);\n       break;\n     case DW_TAG_imported_declaration:\n     case DW_TAG_namespace:\n       add_psymbol_to_list (actual_name, strlen (actual_name),\n \t\t\t   built_actual_name != NULL,\n \t\t\t   VAR_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t   &objfile->global_psymbols,\n+\t\t\t   psymbol_placement::GLOBAL,\n \t\t\t   0, cu->language, objfile);\n       break;\n     case DW_TAG_module:\n       add_psymbol_to_list (actual_name, strlen (actual_name),\n \t\t\t   built_actual_name != NULL,\n \t\t\t   MODULE_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t   &objfile->global_psymbols,\n+\t\t\t   psymbol_placement::GLOBAL,\n \t\t\t   0, cu->language, objfile);\n       break;\n     case DW_TAG_class_type:\n@@ -9021,8 +9016,8 @@ add_partial_symbol (struct partial_die_info *pdi, struct dwarf2_cu *cu)\n \t\t\t   built_actual_name != NULL,\n \t\t\t   STRUCT_DOMAIN, LOC_TYPEDEF, -1,\n \t\t\t   cu->language == language_cplus\n-\t\t\t   ? &objfile->global_psymbols\n-\t\t\t   : &objfile->static_psymbols,\n+\t\t\t   ? psymbol_placement::GLOBAL\n+\t\t\t   : psymbol_placement::STATIC,\n \t\t\t   0, cu->language, objfile);\n \n       break;\n@@ -9031,8 +9026,8 @@ add_partial_symbol (struct partial_die_info *pdi, struct dwarf2_cu *cu)\n \t\t\t   built_actual_name != NULL,\n \t\t\t   VAR_DOMAIN, LOC_CONST, -1,\n \t\t\t   cu->language == language_cplus\n-\t\t\t   ? &objfile->global_psymbols\n-\t\t\t   : &objfile->static_psymbols,\n+\t\t\t   ? psymbol_placement::GLOBAL\n+\t\t\t   : psymbol_placement::STATIC,\n \t\t\t   0, cu->language, objfile);\n       break;\n     default:\n@@ -18440,7 +18435,7 @@ load_partial_dies (const struct die_reader_specs *reader,\n \t  if (building_psymtab && pdi.name != NULL)\n \t    add_psymbol_to_list (pdi.name, strlen (pdi.name), 0,\n \t\t\t\t VAR_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t\t &objfile->static_psymbols,\n+\t\t\t\t psymbol_placement::STATIC,\n \t\t\t\t 0, cu->language, objfile);\n \t  info_ptr = locate_pdi_sibling (reader, &pdi, info_ptr);\n \t  continue;\n@@ -18475,8 +18470,8 @@ load_partial_dies (const struct die_reader_specs *reader,\n \t    add_psymbol_to_list (pdi.name, strlen (pdi.name), 0,\n \t\t\t\t VAR_DOMAIN, LOC_CONST, -1,\n \t\t\t\t cu->language == language_cplus\n-\t\t\t\t ? &objfile->global_psymbols\n-\t\t\t\t : &objfile->static_psymbols,\n+\t\t\t\t ? psymbol_placement::GLOBAL\n+\t\t\t\t : psymbol_placement::STATIC,\n \t\t\t\t 0, cu->language, objfile);\n \n \t  info_ptr = locate_pdi_sibling (reader, &pdi, info_ptr);"
    },
    {
      "sha": "6cf2cad182b7ea6cb49fe06e824a6bb95c516798",
      "filename": "gdb/mdebugread.c",
      "status": "modified",
      "additions": 15,
      "deletions": 15,
      "changes": 30,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/mdebugread.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/mdebugread.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/mdebugread.c?ref=75aedd27e6a2c58734ab44cc7cad8491f19d059a",
      "patch": "@@ -3048,7 +3048,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t     VAR_DOMAIN, LOC_STATIC,\n \t\t\t\t\t     SECT_OFF_DATA (objfile),\n-\t\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t\t     sh.value,\n \t\t\t\t\t     psymtab_language, objfile);\n \t\t\tcontinue;\n@@ -3059,7 +3059,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t     VAR_DOMAIN, LOC_STATIC,\n \t\t\t\t\t     SECT_OFF_DATA (objfile),\n-\t\t\t\t\t     &objfile->global_psymbols,\n+\t\t\t\t\t     psymbol_placement::GLOBAL,\n \t\t\t\t\t     sh.value,\n \t\t\t\t\t     psymtab_language, objfile);\n \t\t\tcontinue;\n@@ -3078,7 +3078,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\t    add_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t\t STRUCT_DOMAIN, LOC_TYPEDEF,\n \t\t\t\t\t\t -1,\n-\t\t\t\t\t\t &objfile->static_psymbols,\n+\t\t\t\t\t\t psymbol_placement::STATIC,\n \t\t\t\t\t\t 0, psymtab_language, objfile);\n \t\t\t    if (p[2] == 't')\n \t\t\t      {\n@@ -3087,7 +3087,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\t\t\t\t     p - namestring, 1,\n \t\t\t\t\t\t     VAR_DOMAIN, LOC_TYPEDEF,\n \t\t\t\t\t\t     -1,\n-\t\t\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t\t\t     0, psymtab_language,\n \t\t\t\t\t\t     objfile);\n \t\t\t\tp += 1;\n@@ -3101,7 +3101,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\t    add_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t\t VAR_DOMAIN, LOC_TYPEDEF,\n \t\t\t\t\t\t -1,\n-\t\t\t\t\t\t &objfile->static_psymbols,\n+\t\t\t\t\t\t psymbol_placement::STATIC,\n \t\t\t\t\t\t 0, psymtab_language, objfile);\n \t\t\t  }\n \t\t      check_enum:\n@@ -3166,7 +3166,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\t\tadd_psymbol_to_list (p, q - p, 1,\n \t\t\t\t\t\t     VAR_DOMAIN, LOC_CONST,\n \t\t\t\t\t\t     -1,\n-\t\t\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t\t\t     0, psymtab_language,\n \t\t\t\t\t\t     objfile);\n \t\t\t\t/* Point past the name.  */\n@@ -3184,7 +3184,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\t/* Constant, e.g. from \"const\" in Pascal.  */\n \t\t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t     VAR_DOMAIN, LOC_CONST, -1,\n-\t\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t\t     0, psymtab_language, objfile);\n \t\t\tcontinue;\n \n@@ -3198,7 +3198,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t     VAR_DOMAIN, LOC_BLOCK,\n \t\t\t\t\t     SECT_OFF_TEXT (objfile),\n-\t\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t\t     sh.value,\n \t\t\t\t\t     psymtab_language, objfile);\n \t\t\tcontinue;\n@@ -3217,7 +3217,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t     VAR_DOMAIN, LOC_BLOCK,\n \t\t\t\t\t     SECT_OFF_TEXT (objfile),\n-\t\t\t\t\t     &objfile->global_psymbols,\n+\t\t\t\t\t     psymbol_placement::GLOBAL,\n \t\t\t\t\t     sh.value,\n \t\t\t\t\t     psymtab_language, objfile);\n \t\t\tcontinue;\n@@ -3455,13 +3455,13 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t    add_psymbol_to_list (sym_name, strlen (sym_name), 1,\n \t\t\t\t\t VAR_DOMAIN, LOC_BLOCK,\n \t\t\t\t\t section,\n-\t\t\t\t\t &objfile->global_psymbols,\n+\t\t\t\t\t psymbol_placement::GLOBAL,\n \t\t\t\t\t sh.value, psymtab_language, objfile);\n \t\t  else\n \t\t    add_psymbol_to_list (sym_name, strlen (sym_name), 1,\n \t\t\t\t\t VAR_DOMAIN, LOC_BLOCK,\n \t\t\t\t\t section,\n-\t\t\t\t\t &objfile->static_psymbols,\n+\t\t\t\t\t psymbol_placement::STATIC,\n \t\t\t\t\t sh.value, psymtab_language, objfile);\n \n \t\t  procaddr = sh.value;\n@@ -3527,7 +3527,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t\t    {\n \t\t      add_psymbol_to_list (sym_name, strlen (sym_name), 1,\n \t\t\t\t\t   STRUCT_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t\t\t   &objfile->static_psymbols,\n+\t\t\t\t\t   psymbol_placement::STATIC,\n \t\t\t\t\t   0, psymtab_language, objfile);\n \t\t    }\n \t\t  handle_psymbol_enumerators (objfile, fh, sh.st, sh.value);\n@@ -3567,7 +3567,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t      /* Use this gdb symbol.  */\n \t      add_psymbol_to_list (sym_name, strlen (sym_name), 1,\n \t\t\t\t   VAR_DOMAIN, theclass, section,\n-\t\t\t\t   &objfile->static_psymbols,\n+\t\t\t\t   psymbol_placement::STATIC,\n \t\t\t\t   sh.value, psymtab_language, objfile);\n \t    skip:\n \t      cur_sdx++;\t/* Go to next file symbol.  */\n@@ -3647,7 +3647,7 @@ parse_partial_symbols (minimal_symbol_reader &reader,\n \t      add_psymbol_to_list (sym_name, strlen (sym_name), 1,\n \t\t\t\t   VAR_DOMAIN, theclass,\n \t\t\t\t   section,\n-\t\t\t\t   &objfile->global_psymbols,\n+\t\t\t\t   psymbol_placement::GLOBAL,\n \t\t\t\t   svalue, psymtab_language, objfile);\n \t    }\n \t}\n@@ -3808,7 +3808,7 @@ handle_psymbol_enumerators (struct objfile *objfile, FDR *fh, int stype,\n          in psymtabs, just in symtabs.  */\n       add_psymbol_to_list (name, strlen (name), 1,\n \t\t\t   VAR_DOMAIN, LOC_CONST, -1,\n-\t\t\t   &objfile->static_psymbols, 0,\n+\t\t\t   psymbol_placement::STATIC, 0,\n \t\t\t   psymtab_language, objfile);\n       ext_sym += external_sym_size;\n     }"
    },
    {
      "sha": "9f1af742842f2d840b1b8de62e4234db207e049f",
      "filename": "gdb/psympriv.h",
      "status": "modified",
      "additions": 10,
      "deletions": 1,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/psympriv.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/psympriv.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/psympriv.h?ref=75aedd27e6a2c58734ab44cc7cad8491f19d059a",
      "patch": "@@ -271,13 +271,22 @@ struct partial_symtab\n   void *read_symtab_private;\n };\n \n+/* Specify whether a partial psymbol should be allocated on the global\n+   list or the static list.  */\n+\n+enum class psymbol_placement\n+{\n+  STATIC,\n+  GLOBAL\n+};\n+\n /* Add any kind of symbol to a partial_symbol vector.  */\n \n extern void add_psymbol_to_list (const char *, int,\n \t\t\t\t int, domain_enum,\n \t\t\t\t enum address_class,\n \t\t\t\t short /* section */,\n-\t\t\t\t std::vector<partial_symbol *> *,\n+\t\t\t\t enum psymbol_placement,\n \t\t\t\t CORE_ADDR,\n \t\t\t\t enum language, struct objfile *);\n "
    },
    {
      "sha": "ddb8e767bb47b8f3d70dd06ef684812aa6deb0ac",
      "filename": "gdb/psymtab.c",
      "status": "modified",
      "additions": 6,
      "deletions": 3,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/psymtab.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/psymtab.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/psymtab.c?ref=75aedd27e6a2c58734ab44cc7cad8491f19d059a",
      "patch": "@@ -1638,7 +1638,7 @@ add_psymbol_to_list (const char *name, int namelength, int copy_name,\n \t\t     domain_enum domain,\n \t\t     enum address_class theclass,\n \t\t     short section,\n-\t\t     std::vector<partial_symbol *> *list,\n+\t\t     psymbol_placement where,\n \t\t     CORE_ADDR coreaddr,\n \t\t     enum language language, struct objfile *objfile)\n {\n@@ -1651,11 +1651,14 @@ add_psymbol_to_list (const char *name, int namelength, int copy_name,\n \t\t\t\tsection, coreaddr, language, objfile, &added);\n \n   /* Do not duplicate global partial symbols.  */\n-  if (list == &objfile->global_psymbols\n-      && !added)\n+  if (where == psymbol_placement::GLOBAL && !added)\n     return;\n \n   /* Save pointer to partial symbol in psymtab, growing symtab if needed.  */\n+  std::vector<partial_symbol *> *list\n+    = (where == psymbol_placement::STATIC\n+       ? &objfile->static_psymbols\n+       : &objfile->global_psymbols);\n   append_psymbol_to_list (list, psym, objfile);\n }\n "
    },
    {
      "sha": "76c683db0c77253ab4b5c2377028e59addfcc35e",
      "filename": "gdb/xcoffread.c",
      "status": "modified",
      "additions": 9,
      "deletions": 9,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/xcoffread.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/75aedd27e6a2c58734ab44cc7cad8491f19d059a/gdb/xcoffread.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/xcoffread.c?ref=75aedd27e6a2c58734ab44cc7cad8491f19d059a",
      "patch": "@@ -2654,7 +2654,7 @@ scan_xcoff_symtab (minimal_symbol_reader &reader,\n \t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t     VAR_DOMAIN, LOC_STATIC,\n \t\t\t\t     SECT_OFF_DATA (objfile),\n-\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t     symbol.n_value,\n \t\t\t\t     psymtab_language, objfile);\n \t\tcontinue;\n@@ -2665,7 +2665,7 @@ scan_xcoff_symtab (minimal_symbol_reader &reader,\n \t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t     VAR_DOMAIN, LOC_STATIC,\n \t\t\t\t     SECT_OFF_DATA (objfile),\n-\t\t\t\t     &objfile->global_psymbols,\n+\t\t\t\t     psymbol_placement::GLOBAL,\n \t\t\t\t     symbol.n_value,\n \t\t\t\t     psymtab_language, objfile);\n \t\tcontinue;\n@@ -2683,14 +2683,14 @@ scan_xcoff_symtab (minimal_symbol_reader &reader,\n \t\t  {\n \t\t    add_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t STRUCT_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t\t\t &objfile->static_psymbols,\n+\t\t\t\t\t psymbol_placement::STATIC,\n \t\t\t\t\t 0, psymtab_language, objfile);\n \t\t    if (p[2] == 't')\n \t\t      {\n \t\t\t/* Also a typedef with the same name.  */\n \t\t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t     VAR_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t\t     0, psymtab_language, objfile);\n \t\t\tp += 1;\n \t\t      }\n@@ -2702,7 +2702,7 @@ scan_xcoff_symtab (minimal_symbol_reader &reader,\n \t\t  {\n \t\t    add_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t\t VAR_DOMAIN, LOC_TYPEDEF, -1,\n-\t\t\t\t\t &objfile->static_psymbols,\n+\t\t\t\t\t psymbol_placement::STATIC,\n \t\t\t\t\t 0, psymtab_language, objfile);\n \t\t  }\n \t      check_enum:\n@@ -2764,7 +2764,7 @@ scan_xcoff_symtab (minimal_symbol_reader &reader,\n \t\t\t   enum constants in psymtabs, just in symtabs.  */\n \t\t\tadd_psymbol_to_list (p, q - p, 1,\n \t\t\t\t\t     VAR_DOMAIN, LOC_CONST, -1,\n-\t\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t\t     0, psymtab_language, objfile);\n \t\t\t/* Point past the name.  */\n \t\t\tp = q;\n@@ -2782,7 +2782,7 @@ scan_xcoff_symtab (minimal_symbol_reader &reader,\n \t\t/* Constant, e.g. from \"const\" in Pascal.  */\n \t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t     VAR_DOMAIN, LOC_CONST, -1,\n-\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t     0, psymtab_language, objfile);\n \t\tcontinue;\n \n@@ -2800,7 +2800,7 @@ scan_xcoff_symtab (minimal_symbol_reader &reader,\n \t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t     VAR_DOMAIN, LOC_BLOCK,\n \t\t\t\t     SECT_OFF_TEXT (objfile),\n-\t\t\t\t     &objfile->static_psymbols,\n+\t\t\t\t     psymbol_placement::STATIC,\n \t\t\t\t     symbol.n_value,\n \t\t\t\t     psymtab_language, objfile);\n \t\tcontinue;\n@@ -2830,7 +2830,7 @@ scan_xcoff_symtab (minimal_symbol_reader &reader,\n \t\tadd_psymbol_to_list (namestring, p - namestring, 1,\n \t\t\t\t     VAR_DOMAIN, LOC_BLOCK,\n \t\t\t\t     SECT_OFF_TEXT (objfile),\n-\t\t\t\t     &objfile->global_psymbols,\n+\t\t\t\t     psymbol_placement::GLOBAL,\n \t\t\t\t     symbol.n_value,\n \t\t\t\t     psymtab_language, objfile);\n \t\tcontinue;"
    }
  ]
}