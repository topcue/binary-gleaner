{
  "sha": "5216580d7a1134a9349ec045b475f5b40f499e5e",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NTIxNjU4MGQ3YTExMzRhOTM0OWVjMDQ1YjQ3NWY1YjQwZjQ5OWU1ZQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-07-06T14:10:50Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-08-13T20:52:10Z"
    },
    "message": "Don't track the contents of the execution info window\n\nThe curses library keeps track of the contents of each window, and can\nredraw the screen as needed.  This means that in most cases is no need\nfor the TUI windows to also keep track of their contents.  This patch\nremoves content tracking from the execution window, leaving that to\ncurses.\n\ngdb/ChangeLog\n2019-08-13  Tom Tromey  <tom@tromey.com>\n\n\t* tui/tui-winsource.h (struct tui_exec_info_window)\n\t<~tui_exec_info_window, maybe_allocate_content, get_content,\n\tm_content>: Remove.\n\t(struct tui_source_window_base) <set_exec_info_content,\n\tshow_exec_info_content>: Don't declare.\n\t* tui/tui-winsource.c\n\t(tui_exec_info_window::maybe_allocate_content): Remove.\n\t(tui_source_window_base::update_exec_info): Rename from\n\tset_exec_info_content.\n\t(tui_source_window_base::show_exec_info_content)\n\t(tui_source_window_base::update_exec_info): Remove.",
    "tree": {
      "sha": "4c6a230c52ac2e2344d1d004ad0a1aa688fdb5d5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/4c6a230c52ac2e2344d1d004ad0a1aa688fdb5d5"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/5216580d7a1134a9349ec045b475f5b40f499e5e",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5216580d7a1134a9349ec045b475f5b40f499e5e",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/5216580d7a1134a9349ec045b475f5b40f499e5e",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5216580d7a1134a9349ec045b475f5b40f499e5e/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "93858ad34ec1d2250d33365468c6721023786f51",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/93858ad34ec1d2250d33365468c6721023786f51",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/93858ad34ec1d2250d33365468c6721023786f51"
    }
  ],
  "stats": {
    "total": 92,
    "additions": 22,
    "deletions": 70
  },
  "files": [
    {
      "sha": "74f75956ed8f3ad01aa168cc485f42d6babf2f49",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5216580d7a1134a9349ec045b475f5b40f499e5e/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5216580d7a1134a9349ec045b475f5b40f499e5e/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=5216580d7a1134a9349ec045b475f5b40f499e5e",
      "patch": "@@ -1,3 +1,17 @@\n+2019-08-13  Tom Tromey  <tom@tromey.com>\n+\n+\t* tui/tui-winsource.h (struct tui_exec_info_window)\n+\t<~tui_exec_info_window, maybe_allocate_content, get_content,\n+\tm_content>: Remove.\n+\t(struct tui_source_window_base) <set_exec_info_content,\n+\tshow_exec_info_content>: Don't declare.\n+\t* tui/tui-winsource.c\n+\t(tui_exec_info_window::maybe_allocate_content): Remove.\n+\t(tui_source_window_base::update_exec_info): Rename from\n+\tset_exec_info_content.\n+\t(tui_source_window_base::show_exec_info_content)\n+\t(tui_source_window_base::update_exec_info): Remove.\n+\n 2019-08-13  Tom Tromey  <tom@tromey.com>\n \n \t* tui/tui-winsource.h (tui_clear_exec_info_content): Don't"
    },
    {
      "sha": "1b2b4393fd90ec29df9770bba80dad6731da912d",
      "filename": "gdb/tui/tui-winsource.c",
      "status": "modified",
      "additions": 8,
      "deletions": 48,
      "changes": 56,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5216580d7a1134a9349ec045b475f5b40f499e5e/gdb/tui/tui-winsource.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5216580d7a1134a9349ec045b475f5b40f499e5e/gdb/tui/tui-winsource.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-winsource.c?ref=5216580d7a1134a9349ec045b475f5b40f499e5e",
      "patch": "@@ -587,41 +587,22 @@ tui_update_breakpoint_info (struct tui_source_window_base *win,\n   return need_refresh;\n }\n \n-/* See tui-data.h.  */\n-\n-tui_exec_info_content *\n-tui_exec_info_window::maybe_allocate_content (int n_elements)\n-{\n-  if (m_content == nullptr)\n-    m_content = XNEWVEC (tui_exec_info_content, n_elements);\n-  return m_content;\n-}\n-\n-\n /* Function to initialize the content of the execution info window,\n    based upon the input window which is either the source or\n    disassembly window.  */\n void\n-tui_source_window_base::set_exec_info_content ()\n+tui_source_window_base::update_exec_info ()\n {\n-  tui_exec_info_content *exec_content\n-    = execution_info->maybe_allocate_content (height);\n-\n+  werase (execution_info->handle);\n   tui_update_breakpoint_info (this, nullptr, true);\n   for (int i = 0; i < content.size (); i++)\n     {\n-      tui_exec_info_content &element = exec_content[i];\n-      struct tui_source_element *src_element;\n-      tui_bp_flags mode;\n-\n-      src_element = &content[i];\n-\n-      memset (element, ' ', sizeof (tui_exec_info_content));\n-      element[TUI_EXECINFO_SIZE - 1] = 0;\n+      struct tui_source_element *src_element = &content[i];\n+      char element[TUI_EXECINFO_SIZE] = \"   \";\n \n       /* Now update the exec info content based upon the state\n \t of each line as indicated by the source content.  */\n-      mode = src_element->break_mode;\n+      tui_bp_flags mode = src_element->break_mode;\n       if (mode & TUI_BP_HIT)\n \telement[TUI_BP_HIT_POS] = (mode & TUI_BP_HARDWARE) ? 'H' : 'B';\n       else if (mode & (TUI_BP_ENABLED | TUI_BP_DISABLED))\n@@ -634,34 +615,13 @@ tui_source_window_base::set_exec_info_content ()\n \n       if (src_element->is_exec_point)\n \telement[TUI_EXEC_POS] = '>';\n-    }\n-}\n-\n \n-void\n-tui_source_window_base::show_exec_info_content ()\n-{\n-  struct tui_exec_info_window *exec_info = execution_info;\n-  const tui_exec_info_content *exec_content = exec_info->get_content ();\n-\n-  werase (exec_info->handle);\n-  for (int cur_line = 1; cur_line <= content.size (); cur_line++)\n-    mvwaddstr (exec_info->handle,\n-\t       cur_line,\n-\t       0,\n-\t       exec_content[cur_line - 1]);\n-  exec_info->refresh_window ();\n+      mvwaddstr (execution_info->handle, i + 1, 0, element);\n+    }\n+  execution_info->refresh_window ();\n }\n \n \n-/* Function to update the execution info window.  */\n-void\n-tui_source_window_base::update_exec_info ()\n-{\n-  set_exec_info_content ();\n-  show_exec_info_content ();\n-}\n-\n void\n tui_alloc_source_buffer (struct tui_source_window_base *win_info)\n {"
    },
    {
      "sha": "abb7ea34816bf6b992f31abba99fa5e9724b355f",
      "filename": "gdb/tui/tui-winsource.h",
      "status": "modified",
      "additions": 0,
      "deletions": 22,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5216580d7a1134a9349ec045b475f5b40f499e5e/gdb/tui/tui-winsource.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5216580d7a1134a9349ec045b475f5b40f499e5e/gdb/tui/tui-winsource.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-winsource.h?ref=5216580d7a1134a9349ec045b475f5b40f499e5e",
      "patch": "@@ -52,24 +52,6 @@ struct tui_exec_info_window : public tui_gen_win_info\n     : tui_gen_win_info (EXEC_INFO_WIN)\n   {\n   }\n-\n-  ~tui_exec_info_window () override\n-  {\n-    xfree (m_content);\n-  }\n-\n-  /* Get or allocate contents.  */\n-  tui_exec_info_content *maybe_allocate_content (int n_elements);\n-\n-  /* Return the contents.  */\n-  const tui_exec_info_content *get_content () const\n-  {\n-    return m_content;\n-  }\n-\n-private:\n-\n-  tui_exec_info_content *m_content = nullptr;\n };\n \n /* Elements in the Source/Disassembly Window.  */\n@@ -132,7 +114,6 @@ struct tui_source_window_base : public tui_win_info\n \n   void show_source_content ();\n \n-  void set_exec_info_content ();\n   void update_exec_info ();\n \n   /* Does the locator belong to this window?  */\n@@ -150,9 +131,6 @@ struct tui_source_window_base : public tui_win_info\n   struct gdbarch *gdbarch = nullptr;\n \n   std::vector<tui_source_element> content;\n-\n-private:\n-  void show_exec_info_content ();\n };\n \n /* Update the execution windows to show the active breakpoints.  This"
    }
  ]
}