{
  "sha": "d6dc01baf753ea9d27b504257fef51acabaaba20",
  "node_id": "C_kwDOANOeidoAKGQ2ZGMwMWJhZjc1M2VhOWQyN2I1MDQyNTdmZWY1MWFjYWJhYWJhMjA",
  "commit": {
    "author": {
      "name": "Markus Klein",
      "email": "markus.klein@sma.de",
      "date": "2021-10-28T16:17:25Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2021-10-28T16:17:25Z"
    },
    "message": "ARM assembler: Allow up to 32 single precision registers in the VPUSH and VPOP instructions.\n\n\tPR 28436\n\t* config/tc-arm.c (do_vfp_nsyn_push_pop_check): New function.\n\t(do_vfp_nsyn_pop): Use the new function.\n\t(do_vfp_nsyn_push): Use the new function.\n\t* testsuite/gas/arm/v8_1m-mve.s: Add new instructions.\n\t* testsuite/gas/arm/v8_1m-mve.d: Updated expected disassembly.",
    "tree": {
      "sha": "c79ac8565654a2e652fad083ce2061a5f285fa5e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c79ac8565654a2e652fad083ce2061a5f285fa5e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d6dc01baf753ea9d27b504257fef51acabaaba20",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d6dc01baf753ea9d27b504257fef51acabaaba20",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d6dc01baf753ea9d27b504257fef51acabaaba20",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d6dc01baf753ea9d27b504257fef51acabaaba20/comments",
  "author": null,
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "0fab795564847898adec8436f068ed6089876713",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0fab795564847898adec8436f068ed6089876713",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/0fab795564847898adec8436f068ed6089876713"
    }
  ],
  "stats": {
    "total": 58,
    "additions": 41,
    "deletions": 17
  },
  "files": [
    {
      "sha": "1133847e8201f23778323d36bcc9db03834ea474",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d6dc01baf753ea9d27b504257fef51acabaaba20/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d6dc01baf753ea9d27b504257fef51acabaaba20/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=d6dc01baf753ea9d27b504257fef51acabaaba20",
      "patch": "@@ -1,3 +1,12 @@\n+2021-10-28  Markus Klein  <markus.klein@sma.de>\n+\n+\tPR 28436\n+\t* config/tc-arm.c (do_vfp_nsyn_push_pop_check): New function.\n+\t(do_vfp_nsyn_pop): Use the new function.\n+\t(do_vfp_nsyn_push): Use the new function.\n+\t* testsuite/gas/arm/v8_1m-mve.s: Add new instructions.\n+\t* testsuite/gas/arm/v8_1m-mve.d: Updated expected disassembly.\n+\n 2021-09-27  Nick Alcock  <nick.alcock@oracle.com>\n \n \t* configure: Regenerate."
    },
    {
      "sha": "9ad7009ddb69d9536ecf4d72c611fdd1d8fcb7ee",
      "filename": "gas/config/tc-arm.c",
      "status": "modified",
      "additions": 23,
      "deletions": 17,
      "changes": 40,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d6dc01baf753ea9d27b504257fef51acabaaba20/gas/config/tc-arm.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d6dc01baf753ea9d27b504257fef51acabaaba20/gas/config/tc-arm.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-arm.c?ref=d6dc01baf753ea9d27b504257fef51acabaaba20",
      "patch": "@@ -20736,20 +20736,32 @@ do_neon_ldm_stm (void)\n   do_vfp_cond_or_thumb ();\n }\n \n+static void\n+do_vfp_nsyn_push_pop_check (void)\n+{\n+  constraint (!ARM_CPU_HAS_FEATURE (cpu_variant, fpu_vfp_ext_v1xd), _(BAD_FPU));\n+\n+  if (inst.operands[1].issingle)\n+    {\n+      constraint (inst.operands[1].imm < 1 || inst.operands[1].imm > 32,\n+\t\t  _(\"register list must contain at least 1 and at most 32 registers\"));\n+    }\n+  else\n+    {\n+      constraint (inst.operands[1].imm < 1 || inst.operands[1].imm > 16,\n+\t\t  _(\"register list must contain at least 1 and at most 16 registers\"));\n+    }\n+}\n+\n static void\n do_vfp_nsyn_pop (void)\n {\n   nsyn_insert_sp ();\n-  if (ARM_CPU_HAS_FEATURE (cpu_variant, mve_ext)) {\n-    return do_vfp_nsyn_opcode (\"vldm\");\n-  }\n \n-  constraint (!ARM_CPU_HAS_FEATURE (cpu_variant, fpu_vfp_ext_v1xd),\n-\t      _(BAD_FPU));\n+  if (ARM_CPU_HAS_FEATURE (cpu_variant, mve_ext))\n+    return do_vfp_nsyn_opcode (\"vldm\");\n \n-  constraint (inst.operands[1].imm < 1 || inst.operands[1].imm > 16,\n-\t      _(\"register list must contain at least 1 and at most 16 \"\n-\t\t\"registers\"));\n+  do_vfp_nsyn_push_pop_check ();\n \n   if (inst.operands[1].issingle)\n     do_vfp_nsyn_opcode (\"fldmias\");\n@@ -20761,24 +20773,18 @@ static void\n do_vfp_nsyn_push (void)\n {\n   nsyn_insert_sp ();\n-  if (ARM_CPU_HAS_FEATURE (cpu_variant, mve_ext)) {\n-    return do_vfp_nsyn_opcode (\"vstmdb\");\n-  }\n \n-  constraint (!ARM_CPU_HAS_FEATURE (cpu_variant, fpu_vfp_ext_v1xd),\n-\t      _(BAD_FPU));\n+  if (ARM_CPU_HAS_FEATURE (cpu_variant, mve_ext))\n+    return do_vfp_nsyn_opcode (\"vstmdb\");\n \n-  constraint (inst.operands[1].imm < 1 || inst.operands[1].imm > 16,\n-\t      _(\"register list must contain at least 1 and at most 16 \"\n-\t\t\"registers\"));\n+  do_vfp_nsyn_push_pop_check ();\n \n   if (inst.operands[1].issingle)\n     do_vfp_nsyn_opcode (\"fstmdbs\");\n   else\n     do_vfp_nsyn_opcode (\"fstmdbd\");\n }\n \n-\n static void\n do_neon_ldr_str (void)\n {"
    },
    {
      "sha": "a1eba2d3813a1b0814ec120729a7552e318862f3",
      "filename": "gas/testsuite/gas/arm/v8_1m-mve.d",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d6dc01baf753ea9d27b504257fef51acabaaba20/gas/testsuite/gas/arm/v8_1m-mve.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d6dc01baf753ea9d27b504257fef51acabaaba20/gas/testsuite/gas/arm/v8_1m-mve.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/arm/v8_1m-mve.d?ref=d6dc01baf753ea9d27b504257fef51acabaaba20",
      "patch": "@@ -25,3 +25,7 @@ Disassembly of section .text:\n  *[0-9a-f]+:\ted91 fb00 \tvldr\td15, \\[r1\\]\n  *[0-9a-f]+:\tedc1 fa00 \tvstr\ts31, \\[r1\\]\n  *[0-9a-f]+:\tedd1 fa00 \tvldr\ts31, \\[r1\\]\n+ *[0-9a-f]+:\ted2d 0a20 \tvpush\t{s0-s31}\n+ *[0-9a-f]+:\ted2d 0a10 \tvpush\t{s0-s15}\n+ *[0-9a-f]+:\tecbd 0a10 \tvpop\t{s0-s15}\n+ *[0-9a-f]+:\tecbd 0a20 \tvpop\t{s0-s31}"
    },
    {
      "sha": "df3442249ab5d06120505c1c7e990714c1326a63",
      "filename": "gas/testsuite/gas/arm/v8_1m-mve.s",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d6dc01baf753ea9d27b504257fef51acabaaba20/gas/testsuite/gas/arm/v8_1m-mve.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d6dc01baf753ea9d27b504257fef51acabaaba20/gas/testsuite/gas/arm/v8_1m-mve.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/arm/v8_1m-mve.s?ref=d6dc01baf753ea9d27b504257fef51acabaaba20",
      "patch": "@@ -22,3 +22,8 @@ vstr d15,[r1]\n vldr d15,[r1]\n vstr s31,[r1]\n vldr s31,[r1]\n+\t\n+vpush {s0-s31}\t\t// -> false error, is a valid command\n+vpush {s0-s15}\t\t// OK\n+vpop {s0-s15}\t\t// OK\n+vpop {s0-s31}\t\t// -> false error, is a valid command"
    }
  ]
}