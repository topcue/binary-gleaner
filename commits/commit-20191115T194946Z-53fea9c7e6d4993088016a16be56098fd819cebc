{
  "sha": "53fea9c7e6d4993088016a16be56098fd819cebc",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NTNmZWE5YzdlNmQ0OTkzMDg4MDE2YTE2YmU1NjA5OGZkODE5Y2ViYw==",
  "commit": {
    "author": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-10-31T21:02:41Z"
    },
    "committer": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-11-15T19:49:46Z"
    },
    "message": "Use ctime_r and localtime_r for threadsafety\n\nTo make these calls threadsafe. localtime_r is provided by gnulib if\nnecessary, and for ctime_r we can just use it because it is in a linux-\nspecific file.\n\ngdb/ChangeLog:\n\n2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n\n\t* maint.c (scoped_command_stats::print_time): Use localtime_r\n\tinstead of localtime (provided through gnulib if necessary).\n\t* nat/linux-osdata.c (time_from_time_t): Use ctime_r instead\n\tof ctime.\n\nChange-Id: I329bbdc39d5b576f51859ba00f1617e024c30cbd",
    "tree": {
      "sha": "b0bc7dda9acc3a99a84c9c540ee95bf11bf457ba",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/b0bc7dda9acc3a99a84c9c540ee95bf11bf457ba"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/53fea9c7e6d4993088016a16be56098fd819cebc",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/53fea9c7e6d4993088016a16be56098fd819cebc",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/53fea9c7e6d4993088016a16be56098fd819cebc",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/53fea9c7e6d4993088016a16be56098fd819cebc/comments",
  "author": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "f8e27d88e4c31089467d8717597c4153723081e6",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f8e27d88e4c31089467d8717597c4153723081e6",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/f8e27d88e4c31089467d8717597c4153723081e6"
    }
  ],
  "stats": {
    "total": 18,
    "additions": 15,
    "deletions": 3
  },
  "files": [
    {
      "sha": "f727aa4786c406ec5351a41ddf07472e0988237c",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/53fea9c7e6d4993088016a16be56098fd819cebc/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/53fea9c7e6d4993088016a16be56098fd819cebc/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=53fea9c7e6d4993088016a16be56098fd819cebc",
      "patch": "@@ -1,3 +1,10 @@\n+2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n+\n+\t* maint.c (scoped_command_stats::print_time): Use localtime_r\n+\tinstead of localtime (provided through gnulib if necessary).\n+\t* nat/linux-osdata.c (time_from_time_t): Use ctime_r instead\n+\tof ctime.\n+\n 2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n \n \t* gdbsupport/common-defs.h: Include time.h before pathmax.h to"
    },
    {
      "sha": "a253584a1509af9d81c3bc315e916b64c28bb72d",
      "filename": "gdb/maint.c",
      "status": "modified",
      "additions": 3,
      "deletions": 2,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/53fea9c7e6d4993088016a16be56098fd819cebc/gdb/maint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/53fea9c7e6d4993088016a16be56098fd819cebc/gdb/maint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/maint.c?ref=53fea9c7e6d4993088016a16be56098fd819cebc",
      "patch": "@@ -1039,10 +1039,11 @@ scoped_command_stats::print_time (const char *msg)\n   auto millis = ticks % 1000;\n \n   std::time_t as_time = system_clock::to_time_t (now);\n-  struct tm *tm = localtime (&as_time);\n+  struct tm tm;\n+  localtime_r (&as_time, &tm);\n \n   char out[100];\n-  strftime (out, sizeof (out), \"%F %H:%M:%S\", tm);\n+  strftime (out, sizeof (out), \"%F %H:%M:%S\", &tm);\n \n   printf_unfiltered (\"%s.%03d - %s\\n\", out, (int) millis, msg);\n }"
    },
    {
      "sha": "d82c062e6c234518f16b3d89aad7f34430860c5f",
      "filename": "gdb/nat/linux-osdata.c",
      "status": "modified",
      "additions": 5,
      "deletions": 1,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/53fea9c7e6d4993088016a16be56098fd819cebc/gdb/nat/linux-osdata.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/53fea9c7e6d4993088016a16be56098fd819cebc/gdb/nat/linux-osdata.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/nat/linux-osdata.c?ref=53fea9c7e6d4993088016a16be56098fd819cebc",
      "patch": "@@ -916,7 +916,11 @@ time_from_time_t (char *time, int maxlen, TIME_T seconds)\n     {\n       time_t t = (time_t) seconds;\n \n-      strncpy (time, ctime (&t), maxlen);\n+      /* Per the ctime_r manpage, this buffer needs to be at least 26\n+         characters long.  */\n+      char buf[30];\n+      const char *time_str = ctime_r (&t, buf);\n+      strncpy (time, time_str, maxlen);\n       time[maxlen - 1] = '\\0';\n     }\n }"
    }
  ]
}