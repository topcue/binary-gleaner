{
  "sha": "1a02d6b0ff80048df106cbb776a550278f8c9d9c",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MWEwMmQ2YjBmZjgwMDQ4ZGYxMDZjYmI3NzZhNTUwMjc4ZjhjOWQ5Yw==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-07-28T10:41:16Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-07-28T10:55:53Z"
    },
    "message": "x86: Handle {disp32} for (%bp)/(%ebp)/(%rbp)\n\nSince (%bp)/(%ebp)/(%rbp) are encoded as 0(%bp)/0(%ebp)/0(%rbp), use\ndisp32/disp16 on 0(%bp)/0(%ebp)/0(%rbp) for {disp32}.\n\nNote: Since there is no disp32 on 0(%bp), use disp16 instead.\n\n\tPR gas/26305\n\t* config/tc-i386.c (build_modrm_byte): Use disp32/disp16 on\n\t(%bp)/(%ebp)/(%rbp) for {disp32}.\n\t* doc/c-i386.texi: Update {disp32} documentation.\n\t* testsuite/gas/i386/pseudos.s: Add (%bp)/(%ebp) tests.\n\t* testsuite/gas/i386/x86-64-pseudos.s: Add (%ebp)/(%rbp) tests.\n\t* testsuite/gas/i386/pseudos.d: Updated.\n\t* testsuite/gas/i386/x86-64-pseudos.d: Likewise.",
    "tree": {
      "sha": "75a0bfd9d3535aa8d3f27240e3385348e4fe34c7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/75a0bfd9d3535aa8d3f27240e3385348e4fe34c7"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/1a02d6b0ff80048df106cbb776a550278f8c9d9c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1a02d6b0ff80048df106cbb776a550278f8c9d9c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/1a02d6b0ff80048df106cbb776a550278f8c9d9c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1a02d6b0ff80048df106cbb776a550278f8c9d9c/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "43d5901dedc7d0eefd7b677f555a4cbf470ee455",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/43d5901dedc7d0eefd7b677f555a4cbf470ee455",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/43d5901dedc7d0eefd7b677f555a4cbf470ee455"
    }
  ],
  "stats": {
    "total": 95,
    "additions": 92,
    "deletions": 3
  },
  "files": [
    {
      "sha": "ebc99b6e9c63d06440e24177b050c1af8225e0a6",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=1a02d6b0ff80048df106cbb776a550278f8c9d9c",
      "patch": "@@ -1,3 +1,14 @@\n+2020-07-28  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR gas/26305\n+\t* config/tc-i386.c (build_modrm_byte): Use disp32/disp16 on\n+\t(%bp)/(%ebp)/(%rbp) for {disp32}.\n+\t* doc/c-i386.texi: Update {disp32} documentation.\n+\t* testsuite/gas/i386/pseudos.s: Add (%bp)/(%ebp) tests.\n+\t* testsuite/gas/i386/x86-64-pseudos.s: Add (%ebp)/(%rbp) tests.\n+\t* testsuite/gas/i386/pseudos.d: Updated.\n+\t* testsuite/gas/i386/x86-64-pseudos.d: Likewise.\n+\n 2020-07-27  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* doc/as.texi: Replace preceeded with preceded."
    },
    {
      "sha": "11d0e992f970fc80ffde7be0247afe8da1363df3",
      "filename": "gas/config/tc-i386.c",
      "status": "modified",
      "additions": 10,
      "deletions": 2,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/config/tc-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/config/tc-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.c?ref=1a02d6b0ff80048df106cbb776a550278f8c9d9c",
      "patch": "@@ -8151,7 +8151,12 @@ build_modrm_byte (void)\n \t\t      if (operand_type_check (i.types[op], disp) == 0)\n \t\t\t{\n \t\t\t  /* fake (%bp) into 0(%bp)  */\n-\t\t\t  i.types[op].bitfield.disp8 = 1;\n+\t\t\t  if (i.disp_encoding == disp_encoding_32bit)\n+\t\t\t    /* NB: Use disp16 since there is no disp32\n+\t\t\t       in 16-bit mode.  */\n+\t\t\t    i.types[op].bitfield.disp16 = 1;\n+\t\t\t  else\n+\t\t\t    i.types[op].bitfield.disp8 = 1;\n \t\t\t  fake_zero_displacement = 1;\n \t\t\t}\n \t\t    }\n@@ -8196,7 +8201,10 @@ build_modrm_byte (void)\n \t      if (i.base_reg->reg_num == 5 && i.disp_operands == 0)\n \t\t{\n \t\t  fake_zero_displacement = 1;\n-\t\t  i.types[op].bitfield.disp8 = 1;\n+\t\t  if (i.disp_encoding == disp_encoding_32bit)\n+\t\t    i.types[op].bitfield.disp32 = 1;\n+\t\t  else\n+\t\t    i.types[op].bitfield.disp8 = 1;\n \t\t}\n \t      i.sib.scale = i.log2_scale_factor;\n \t      if (i.index_reg == 0)"
    },
    {
      "sha": "8be708e7450ad23bc64a89dc10b6564f2d2c029d",
      "filename": "gas/doc/c-i386.texi",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/doc/c-i386.texi",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/doc/c-i386.texi",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/doc/c-i386.texi?ref=1a02d6b0ff80048df106cbb776a550278f8c9d9c",
      "patch": "@@ -822,7 +822,7 @@ Different encoding options can be specified via pseudo prefixes:\n @samp{@{disp8@}} -- prefer 8-bit displacement.\n \n @item\n-@samp{@{disp32@}} -- prefer 32-bit displacement.\n+@samp{@{disp32@}} -- prefer 32-bit (16-bit in 16-bit mode) displacement.\n \n @item\n @samp{@{load@}} -- prefer load-form instruction."
    },
    {
      "sha": "76aae367b446ab37cfdc2c891bc2bda67a9d2f1b",
      "filename": "gas/testsuite/gas/i386/pseudos.d",
      "status": "modified",
      "additions": 18,
      "deletions": 0,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/testsuite/gas/i386/pseudos.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/testsuite/gas/i386/pseudos.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/pseudos.d?ref=1a02d6b0ff80048df106cbb776a550278f8c9d9c",
      "patch": "@@ -288,6 +288,15 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t0f 28 90 80 00 00 00 \tmovaps 0x80\\(%eax\\),%xmm2\n  +[a-f0-9]+:\t0f 28 90 80 00 00 00 \tmovaps 0x80\\(%eax\\),%xmm2\n  +[a-f0-9]+:\t0f 28 90 80 00 00 00 \tmovaps 0x80\\(%eax\\),%xmm2\n+ +[a-f0-9]+:\t8a 45 00             \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t8a 45 00             \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t8a 85 00 00 00 00    \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t67 8a 07             \tmov    \\(%bx\\),%al\n+ +[a-f0-9]+:\t67 8a 07             \tmov    \\(%bx\\),%al\n+ +[a-f0-9]+:\t67 8a 07             \tmov    \\(%bx\\),%al\n+ +[a-f0-9]+:\t67 8a 46 00          \tmov    0x0\\(%bp\\),%al\n+ +[a-f0-9]+:\t67 8a 46 00          \tmov    0x0\\(%bp\\),%al\n+ +[a-f0-9]+:\t67 8a 86 00 00       \tmov    0x0\\(%bp\\),%al\n  +[a-f0-9]+:\tc4 e1 78 28 d7       \tvmovaps %xmm7,%xmm2\n  +[a-f0-9]+:\tc4 e1 78 28 d7       \tvmovaps %xmm7,%xmm2\n  +[a-f0-9]+:\tc4 e1 78 29 fa       \tvmovaps %xmm7,%xmm2\n@@ -316,4 +325,13 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t0f 28 90 80 00 00 00 \tmovaps 0x80\\(%eax\\),%xmm2\n  +[a-f0-9]+:\t0f 28 90 80 00 00 00 \tmovaps 0x80\\(%eax\\),%xmm2\n  +[a-f0-9]+:\t0f 28 90 80 00 00 00 \tmovaps 0x80\\(%eax\\),%xmm2\n+ +[a-f0-9]+:\t8a 45 00             \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t8a 45 00             \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t8a 85 00 00 00 00    \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t67 8a 07             \tmov    \\(%bx\\),%al\n+ +[a-f0-9]+:\t67 8a 07             \tmov    \\(%bx\\),%al\n+ +[a-f0-9]+:\t67 8a 07             \tmov    \\(%bx\\),%al\n+ +[a-f0-9]+:\t67 8a 46 00          \tmov    0x0\\(%bp\\),%al\n+ +[a-f0-9]+:\t67 8a 46 00          \tmov    0x0\\(%bp\\),%al\n+ +[a-f0-9]+:\t67 8a 86 00 00       \tmov    0x0\\(%bp\\),%al\n #pass"
    },
    {
      "sha": "bc18654ced037e00e57dad3d065059e5fe1b031c",
      "filename": "gas/testsuite/gas/i386/pseudos.s",
      "status": "modified",
      "additions": 24,
      "deletions": 0,
      "changes": 24,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/testsuite/gas/i386/pseudos.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/testsuite/gas/i386/pseudos.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/pseudos.s?ref=1a02d6b0ff80048df106cbb776a550278f8c9d9c",
      "patch": "@@ -293,6 +293,18 @@ _start:\n \t{disp8} movaps 128(%eax),%xmm2\n \t{disp32} movaps 128(%eax),%xmm2\n \n+\tmovb (%ebp),%al\n+\t{disp8} movb (%ebp),%al\n+\t{disp32} movb (%ebp),%al\n+\n+\tmovb (%bx),%al\n+\t{disp8} movb (%bx),%al\n+\t{disp32} movb (%bx),%al\n+\n+\tmovb (%bp),%al\n+\t{disp8} movb (%bp),%al\n+\t{disp32} movb (%bp),%al\n+\n \t.intel_syntax noprefix\n \t{vex3} vmovaps xmm2,xmm7\n \t{vex3} {load} vmovaps xmm2,xmm7\n@@ -322,3 +334,15 @@ _start:\n \tmovaps xmm2,XMMWORD PTR [eax+128]\n \t{disp8} movaps xmm2,XMMWORD PTR [eax+128]\n \t{disp32} movaps xmm2,XMMWORD PTR [eax+128]\n+\n+\tmov al, BYTE PTR [ebp]\n+\t{disp8} mov al, BYTE PTR [ebp]\n+\t{disp32} mov al, BYTE PTR [ebp]\n+\n+\tmov al, BYTE PTR [bx]\n+\t{disp8} mov al, BYTE PTR [bx]\n+\t{disp32} mov al, BYTE PTR [bx]\n+\n+\tmov al, BYTE PTR [bp]\n+\t{disp8} mov al, BYTE PTR [bp]\n+\t{disp32} mov al, BYTE PTR [bp]"
    },
    {
      "sha": "0fb18a33696a389a2b54e6d2e2591e2d2d9eaad6",
      "filename": "gas/testsuite/gas/i386/x86-64-pseudos.d",
      "status": "modified",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/testsuite/gas/i386/x86-64-pseudos.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/testsuite/gas/i386/x86-64-pseudos.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-pseudos.d?ref=1a02d6b0ff80048df106cbb776a550278f8c9d9c",
      "patch": "@@ -315,6 +315,12 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t41 0f 28 10          \tmovaps \\(%r8\\),%xmm2\n  +[a-f0-9]+:\t40 0f 38 01 01       \trex phaddw \\(%rcx\\),%mm0\n  +[a-f0-9]+:\t41 0f 38 01 00       \tphaddw \\(%r8\\),%mm0\n+ +[a-f0-9]+:\t8a 45 00             \tmov    0x0\\(%rbp\\),%al\n+ +[a-f0-9]+:\t8a 45 00             \tmov    0x0\\(%rbp\\),%al\n+ +[a-f0-9]+:\t8a 85 00 00 00 00    \tmov    0x0\\(%rbp\\),%al\n+ +[a-f0-9]+:\t67 8a 45 00          \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t67 8a 45 00          \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t67 8a 85 00 00 00 00 \tmov    0x0\\(%ebp\\),%al\n  +[a-f0-9]+:\tc4 e1 78 28 d7       \tvmovaps %xmm7,%xmm2\n  +[a-f0-9]+:\tc4 e1 78 28 d7       \tvmovaps %xmm7,%xmm2\n  +[a-f0-9]+:\tc4 e1 78 29 fa       \tvmovaps %xmm7,%xmm2\n@@ -353,4 +359,10 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t41 0f 28 10          \tmovaps \\(%r8\\),%xmm2\n  +[a-f0-9]+:\t40 0f 38 01 01       \trex phaddw \\(%rcx\\),%mm0\n  +[a-f0-9]+:\t41 0f 38 01 00       \tphaddw \\(%r8\\),%mm0\n+ +[a-f0-9]+:\t8a 45 00             \tmov    0x0\\(%rbp\\),%al\n+ +[a-f0-9]+:\t8a 45 00             \tmov    0x0\\(%rbp\\),%al\n+ +[a-f0-9]+:\t8a 85 00 00 00 00    \tmov    0x0\\(%rbp\\),%al\n+ +[a-f0-9]+:\t67 8a 45 00          \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t67 8a 45 00          \tmov    0x0\\(%ebp\\),%al\n+ +[a-f0-9]+:\t67 8a 85 00 00 00 00 \tmov    0x0\\(%ebp\\),%al\n #pass"
    },
    {
      "sha": "3b3638cf750e2ebb5b67a0ac3ae70d334eb3e8fb",
      "filename": "gas/testsuite/gas/i386/x86-64-pseudos.s",
      "status": "modified",
      "additions": 16,
      "deletions": 0,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/testsuite/gas/i386/x86-64-pseudos.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a02d6b0ff80048df106cbb776a550278f8c9d9c/gas/testsuite/gas/i386/x86-64-pseudos.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-pseudos.s?ref=1a02d6b0ff80048df106cbb776a550278f8c9d9c",
      "patch": "@@ -320,6 +320,14 @@ _start:\n \t{rex} phaddw (%rcx),%mm0\n \t{rex} phaddw (%r8),%mm0\n \n+\tmovb (%rbp),%al\n+\t{disp8} movb (%rbp),%al\n+\t{disp32} movb (%rbp),%al\n+\n+\tmovb (%ebp),%al\n+\t{disp8} movb (%ebp),%al\n+\t{disp32} movb (%ebp),%al\n+\n \t.intel_syntax noprefix\n \t{vex3} vmovaps xmm2,xmm7\n \t{vex3} {load} vmovaps xmm2,xmm7\n@@ -359,3 +367,11 @@ _start:\n \t{rex} movaps xmm2,XMMWORD PTR [r8]\n \t{rex} phaddw mm0,QWORD PTR [rcx]\n \t{rex} phaddw mm0,QWORD PTR [r8]\n+\n+\tmov al, BYTE PTR [rbp]\n+\t{disp8} mov al, BYTE PTR [rbp]\n+\t{disp32} mov al, BYTE PTR [rbp]\n+\n+\tmov al, BYTE PTR [ebp]\n+\t{disp8} mov al, BYTE PTR [ebp]\n+\t{disp32} mov al, BYTE PTR [ebp]"
    }
  ]
}