{
  "sha": "1776e3e59ca6200dff981894361b8b49cb453766",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTc3NmUzZTU5Y2E2MjAwZGZmOTgxODk0MzYxYjhiNDljYjQ1Mzc2Ng==",
  "commit": {
    "author": {
      "name": "Nick Alcock",
      "email": "nick.alcock@oracle.com",
      "date": "2019-10-09T09:42:00Z"
    },
    "committer": {
      "name": "Nick Alcock",
      "email": "nick.alcock@oracle.com",
      "date": "2020-06-26T14:56:38Z"
    },
    "message": "Fix --enable-libctf and --disable-static\n\nThis fixes test runs and compilation when --disable-libctf,\n--disable-static, or --enable-shared are passed.\n\nChanges since v2: Use GCC_ENABLE and fix indentation.  Fix prototype\nusing 'void'.  Use 'unsupported' and gdb_caching_proc.\n\nChanges since v3: Adapt to upstream changes providing skip_ctf_tests.\n\nChanges since v4: Adapt to upstream changes in the seven months (!)\nsince I last looked at this.\n\ngdb/ChangeLog\n\t* configure.ac: Add --enable-libctf: handle --disable-static\n\tproperly.\n\t* acinclude.m4: sinclude ../config/enable.m4.\n\t* Makefile.in (aclocal_m4_deps): Adjust accordingly.\n\t(LIBCTF): Substitute in.\n\t(CTF_DEPS): New, likewise.\n\t(CLIBS): libctf needs symbols from libbfd: move earlier.\n\t(CDEPS): Use CTF_DEPS, not LIBCTF, now LIBCTF can include rpath\n\tflags.\n\t* ctfread.c: Surround in ENABLE_LIBCTF.\n\t(elfctf_build_psymtabs) [!ENABLE_LIBCTF]: New stub.\n\t* configure: Regenerate.\n\t* config.in: Likewise.\n\ngdb/testsuite/ChangeLog\n\t* configure.ac: Add --enable-libctf.\n\t* aclocal.m4: sinclude ../config/enable.m4.\n\t* Makefile.in (site.exp): Add enable_libctf to site.exp.\n\t* lib/gdb.exp (skip_ctf_tests): Use it.\n\t* gdb.base/ctf-constvars.exp: Error message tweak.\n\t* gdb.base/ctf-ptype.exp: Likewise.\n\t* configure: Regenerate.",
    "tree": {
      "sha": "bc9088101bf5941ecfb9455f668af46beaf53484",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/bc9088101bf5941ecfb9455f668af46beaf53484"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/1776e3e59ca6200dff981894361b8b49cb453766",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1776e3e59ca6200dff981894361b8b49cb453766",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/1776e3e59ca6200dff981894361b8b49cb453766",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1776e3e59ca6200dff981894361b8b49cb453766/comments",
  "author": {
    "login": "nickalcock",
    "id": 6503005,
    "node_id": "MDQ6VXNlcjY1MDMwMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6503005?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickalcock",
    "html_url": "https://github.com/nickalcock",
    "followers_url": "https://api.github.com/users/nickalcock/followers",
    "following_url": "https://api.github.com/users/nickalcock/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickalcock/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickalcock/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickalcock/subscriptions",
    "organizations_url": "https://api.github.com/users/nickalcock/orgs",
    "repos_url": "https://api.github.com/users/nickalcock/repos",
    "events_url": "https://api.github.com/users/nickalcock/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickalcock/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickalcock",
    "id": 6503005,
    "node_id": "MDQ6VXNlcjY1MDMwMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6503005?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickalcock",
    "html_url": "https://github.com/nickalcock",
    "followers_url": "https://api.github.com/users/nickalcock/followers",
    "following_url": "https://api.github.com/users/nickalcock/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickalcock/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickalcock/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickalcock/subscriptions",
    "organizations_url": "https://api.github.com/users/nickalcock/orgs",
    "repos_url": "https://api.github.com/users/nickalcock/repos",
    "events_url": "https://api.github.com/users/nickalcock/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickalcock/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d1c361252ba4902046fd7725f880fa166e88e3e4",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d1c361252ba4902046fd7725f880fa166e88e3e4",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d1c361252ba4902046fd7725f880fa166e88e3e4"
    }
  ],
  "stats": {
    "total": 152,
    "additions": 146,
    "deletions": 6
  },
  "files": [
    {
      "sha": "d09d316f76602b021a25a1cf2b824e5585ba27e0",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 16,
      "deletions": 0,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -1,3 +1,19 @@\n+2020-06-26  Nick Alcock  <nick.alcock@oracle.com>\n+\n+\t* configure.ac: Add --enable-libctf: handle --disable-static\n+\tproperly.\n+\t* acinclude.m4: sinclude ../config/enable.m4.\n+\t* Makefile.in (aclocal_m4_deps): Adjust accordingly.\n+\t(LIBCTF): Substitute in.\n+\t(CTF_DEPS): New, likewise.\n+\t(CLIBS): libctf needs symbols from libbfd: move earlier.\n+\t(CDEPS): Use CTF_DEPS, not LIBCTF, now LIBCTF can include rpath\n+\tflags.\n+\t* ctfread.c: Surround in ENABLE_LIBCTF.\n+\t(elfctf_build_psymtabs) [!ENABLE_LIBCTF]: New stub.\n+\t* configure: Regenerate.\n+\t* config.in: Likewise.\n+\n 2020-06-25  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* infcmd.c (set_inferior_io_terminal): Use make_unique_xstrdup."
    },
    {
      "sha": "9ae9fe2d1e146611325806283e78025d488458e3",
      "filename": "gdb/Makefile.in",
      "status": "modified",
      "additions": 5,
      "deletions": 3,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/Makefile.in?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -154,7 +154,8 @@ INCLUDE_CFLAGS = -I$(INCLUDE_DIR)\n LIBIBERTY = ../libiberty/libiberty.a\n \n # Where is the CTF library?  Typically in ../libctf.\n-LIBCTF = ../libctf/.libs/libctf.a\n+LIBCTF = @LIBCTF@\n+CTF_DEPS = @CTF_DEPS@\n \n # Where is the BFD library?  Typically in ../bfd.\n BFD_DIR = ../bfd\n@@ -614,15 +615,15 @@ INTERNAL_LDFLAGS = \\\n # Libraries and corresponding dependencies for compiling gdb.\n # XM_CLIBS, defined in *config files, have host-dependent libs.\n # LIBIBERTY appears twice on purpose.\n-CLIBS = $(SIM) $(READLINE) $(OPCODES) $(BFD) $(LIBCTF) $(ZLIB) \\\n+CLIBS = $(SIM) $(READLINE) $(OPCODES) $(LIBCTF) $(BFD) $(ZLIB) \\\n         $(LIBSUPPORT) $(INTL) $(LIBIBERTY) $(LIBDECNUMBER) \\\n \t$(XM_CLIBS) $(GDBTKLIBS) \\\n \t@LIBS@ @GUILE_LIBS@ @PYTHON_LIBS@ \\\n \t$(LIBEXPAT) $(LIBLZMA) $(LIBBABELTRACE) $(LIBIPT) \\\n \t$(WIN32LIBS) $(LIBGNU) $(LIBICONV) \\\n \t$(LIBMPFR) $(SRCHIGH_LIBS) $(LIBXXHASH) $(PTHREAD_LIBS) \\\n \t@LIBDEBUGINFOD@\n-CDEPS = $(NAT_CDEPS) $(SIM) $(BFD) $(READLINE_DEPS) $(LIBCTF) \\\n+CDEPS = $(NAT_CDEPS) $(SIM) $(BFD) $(READLINE_DEPS) $(CTF_DEPS) \\\n \t$(OPCODES) $(INTL_DEPS) $(LIBIBERTY) $(CONFIG_DEPS) $(LIBGNU) \\\n \t$(LIBSUPPORT)\n \n@@ -2006,6 +2007,7 @@ aclocal_m4_deps = \\\n \ttransform.m4 \\\n \t../bfd/bfd.m4 \\\n \t../config/acinclude.m4 \\\n+\t../config/enable.m4 \\\n \t../config/plugins.m4 \\\n \t../config/lead-dot.m4 \\\n \t../config/override.m4 \\"
    },
    {
      "sha": "6fbc88bb55cd3e28aca9c012ec34cc6ba7db4ec0",
      "filename": "gdb/acinclude.m4",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/acinclude.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/acinclude.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/acinclude.m4?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -24,6 +24,9 @@ m4_include(../bfd/bfd.m4)\n dnl This gets the standard macros.\n m4_include(../config/acinclude.m4)\n \n+dnl This gets GCC_ENABLE.\n+sinclude(../config/enable.m4)\n+\n dnl This gets AC_PLUGINS, needed by ACX_LARGEFILE.\n m4_include(../config/plugins.m4)\n "
    },
    {
      "sha": "340c421ca031d927a7784252ea717f68d3dd5261",
      "filename": "gdb/config.in",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/config.in?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -36,6 +36,9 @@\n /* Define to BFD's default target vector. */\n #undef DEFAULT_BFD_VEC\n \n+/* Handle .ctf type-info sections */\n+#undef ENABLE_LIBCTF\n+\n /* Define to 1 if translation of program messages to the user's native\n    language is requested. */\n #undef ENABLE_NLS"
    },
    {
      "sha": "e8bfdbc70996b3867978eeed04d150c3301aa107",
      "filename": "gdb/configure",
      "status": "modified",
      "additions": 40,
      "deletions": 0,
      "changes": 40,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -631,6 +631,9 @@ GDB_NM_FILE\n LTLIBXXHASH\n LIBXXHASH\n HAVE_LIBXXHASH\n+CTF_DEPS\n+LIBCTF\n+ENABLE_LIBCTF\n LTLIBBABELTRACE\n LIBBABELTRACE\n HAVE_LIBBABELTRACE\n@@ -917,6 +920,7 @@ with_babeltrace\n with_libbabeltrace_prefix\n with_libbabeltrace_type\n with_xxhash\n+enable_libctf\n with_libxxhash_prefix\n with_libxxhash_type\n enable_unit_tests\n@@ -1583,6 +1587,7 @@ Optional Features:\n                           gcc is used\n   --enable-ubsan          enable undefined behavior sanitizer (auto/yes/no)\n   --enable-sim            link gdb with simulator\n+  --enable-libctf         Handle .ctf type-info sections [default=yes]\n   --enable-unit-tests     Enable the inclusion of unit tests when compiling\n                           GDB\n \n@@ -18561,6 +18566,41 @@ else\n fi\n \n \n+ # Check whether --enable-libctf was given.\n+if test \"${enable_libctf+set}\" = set; then :\n+  enableval=$enable_libctf;\n+      case \"$enableval\" in\n+       yes|no) ;;\n+       *) as_fn_error $? \"Argument to enable/disable libctf must be yes or no\" \"$LINENO\" 5 ;;\n+      esac\n+\n+else\n+  enable_libctf=yes\n+fi\n+\n+\n+if test x${enable_static} = xno; then\n+  LIBCTF=\"-Wl,--rpath,../libctf/.libs ../libctf/.libs/libctf.so\"\n+  CTF_DEPS=\"../libctf/.libs/libctf.so\"\n+else\n+  LIBCTF=\"../libctf/.libs/libctf.a\"\n+  CTF_DEPS=\"$LIBCTF\"\n+fi\n+if test \"${enable_libctf}\" = yes; then\n+\n+$as_echo \"#define ENABLE_LIBCTF 1\" >>confdefs.h\n+\n+else\n+  LIBCTF=\n+  CTF_DEPS=\n+fi\n+\n+\n+\n+\n+# If nativefile (NAT_FILE) is not set in configure.nat, we link to an\n+# empty version.\n+\n if test \"x$with_xxhash\" != \"xno\"; then\n \n "
    },
    {
      "sha": "b975cec84fedc2f89a4ed3d96270dcadf70fd5ca",
      "filename": "gdb/configure.ac",
      "status": "modified",
      "additions": 21,
      "deletions": 0,
      "changes": 21,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure.ac?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -2066,6 +2066,27 @@ AC_ARG_WITH(xxhash,\n   AC_HELP_STRING([--with-xxhash], [use libxxhash for hashing (faster) (auto/yes/no)]),\n   [], [with_xxhash=auto])\n \n+GCC_ENABLE([libctf], [yes], [], [Handle .ctf type-info sections])\n+if test x${enable_static} = xno; then\n+  LIBCTF=\"-Wl,--rpath,../libctf/.libs ../libctf/.libs/libctf.so\"\n+  CTF_DEPS=\"../libctf/.libs/libctf.so\"\n+else\n+  LIBCTF=\"../libctf/.libs/libctf.a\"\n+  CTF_DEPS=\"$LIBCTF\"\n+fi\n+if test \"${enable_libctf}\" = yes; then\n+  AC_DEFINE(ENABLE_LIBCTF, 1, [Handle .ctf type-info sections])\n+else\n+  LIBCTF=\n+  CTF_DEPS=\n+fi\n+AC_SUBST(ENABLE_LIBCTF)\n+AC_SUBST(LIBCTF)\n+AC_SUBST(CTF_DEPS)\n+\n+# If nativefile (NAT_FILE) is not set in configure.nat, we link to an\n+# empty version.\n+\n if test \"x$with_xxhash\" != \"xno\"; then\n   AC_LIB_HAVE_LINKFLAGS([xxhash], [],\n \t\t\t[#include <xxhash.h>],"
    },
    {
      "sha": "f44cbecba09a282a53aa5542ba31f171aa41ac65",
      "filename": "gdb/ctfread.c",
      "status": "modified",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/ctfread.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/ctfread.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ctfread.c?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -81,6 +81,9 @@\n #include \"block.h\"\n #include \"ctfread.h\"\n #include \"psympriv.h\"\n+\n+#if ENABLE_LIBCTF\n+\n #include \"ctf.h\"\n #include \"ctf-api.h\"\n \n@@ -1485,3 +1488,13 @@ elfctf_build_psymtabs (struct objfile *of)\n \n   scan_partial_symbols (fp, of);\n }\n+\n+#else\n+\n+void\n+elfctf_build_psymtabs (struct objfile *of)\n+{\n+  /* Nothing to do if CTF is disabled.  */\n+}\n+\n+#endif /* ENABLE_LIBCTF */"
    },
    {
      "sha": "bf9d2c499e8ea429a85a5e6f4971bcd3b634bdc3",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -1,3 +1,13 @@\n+2020-06-26  Nick Alcock  <nick.alcock@oracle.com>\n+\n+\t* configure.ac: Add --enable-libctf.\n+\t* aclocal.m4: sinclude ../config/enable.m4.\n+\t* Makefile.in (site.exp): Add enable_libctf to site.exp.\n+\t* lib/gdb.exp (skip_ctf_tests): Use it.\n+\t* gdb.base/ctf-constvars.exp: Error message tweak.\n+\t* gdb.base/ctf-ptype.exp: Likewise.\n+\t* configure: Regenerate.\n+\n 2020-06-26  Gary Benson <gbenson@redhat.com>\n \n \t* gdb.cp/try_catch.cc: Include string.h."
    },
    {
      "sha": "61209d881c160ed944b2bbaa40f3dcd9a0558cc0",
      "filename": "gdb/testsuite/Makefile.in",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/Makefile.in?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -28,6 +28,7 @@ program_transform_name = @program_transform_name@\n build_canonical = @build@\n host_canonical = @host@\n target_canonical = @target@\n+enable_libctf = @enable_libctf@\n \n SHELL = @SHELL@\n EXEEXT = @EXEEXT@\n@@ -131,6 +132,7 @@ $(abs_builddir)/site.exp site.exp: ./config.status Makefile\n \t@echo \"set build_triplet ${build_canonical}\" >> ./tmp0\n \t@echo \"set srcdir ${abs_srcdir}\" >> ./tmp0\n \t@echo \"set tool gdb\" >> ./tmp0\n+\t@echo \"set enable_libctf ${enable_libctf}\" >> ./tmp0\n \t@echo 'source $${srcdir}/lib/append_gdb_boards_dir.exp' >> ./tmp0\n \t@echo \"## All variables above are generated by configure. Do Not Edit ##\" >> ./tmp0\n \t\t@cat ./tmp0 > site.exp"
    },
    {
      "sha": "c5d3ba527a766843fbeb9f26c72a2bda46595214",
      "filename": "gdb/testsuite/aclocal.m4",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/aclocal.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/aclocal.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/aclocal.m4?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -1,5 +1,6 @@\n m4_include(../../config/acx.m4)\n m4_include(../../config/override.m4)\n+m4_include(../../config/enable.m4)\n m4_include(../transform.m4)\n \n # AM_CONDITIONAL                                            -*- Autoconf -*-"
    },
    {
      "sha": "0de607446003ce8f36237efbf6c365cf176817e9",
      "filename": "gdb/testsuite/configure",
      "status": "modified",
      "additions": 18,
      "deletions": 0,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/configure?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -638,6 +638,7 @@ LDFLAGS\n CFLAGS\n CC\n RPATH_ENVVAR\n+enable_libctf\n subdirs\n target_noncanonical\n target_os\n@@ -694,6 +695,7 @@ ac_subst_files=''\n ac_user_opts='\n enable_option_checking\n enable_gdbtk\n+enable_libctf\n enable_shared\n '\n       ac_precious_vars='build_alias\n@@ -1323,6 +1325,7 @@ Optional Features:\n   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)\n   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]\n   --enable-gtk            enable gdbtk graphical user interface (GUI)\n+  --enable-libctf         Handle .ctf type-info sections [default=yes]\n   --enable-shared         build shared libraries deault=yes\n \n Some influential environment variables:\n@@ -2189,6 +2192,21 @@ subdirs=\"$subdirs gdb.gdbtk\"\n \n fi\n \n+ # Check whether --enable-libctf was given.\n+if test \"${enable_libctf+set}\" = set; then :\n+  enableval=$enable_libctf;\n+      case \"$enableval\" in\n+       yes|no) ;;\n+       *) as_fn_error $? \"Argument to enable/disable libctf must be yes or no\" \"$LINENO\" 5 ;;\n+      esac\n+\n+else\n+  enable_libctf=yes\n+fi\n+\n+\n+\n+\n # Enable shared libraries.\n # Check whether --enable-shared was given.\n if test \"${enable_shared+set}\" = set; then :"
    },
    {
      "sha": "cc62c3fc45b2a167da59d79f05fc6db51367bb48",
      "filename": "gdb/testsuite/configure.ac",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/configure.ac?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -43,6 +43,9 @@ if test $enable_gdbtk = yes; then\n    AC_CONFIG_SUBDIRS(gdb.gdbtk)\n fi\n \n+GCC_ENABLE([libctf], [yes], [], [Handle .ctf type-info sections])\n+AC_SUBST(enable_libctf)\n+\n # Enable shared libraries.\n AC_ARG_ENABLE(shared,\n [  --enable-shared         build shared libraries [deault=yes]],,"
    },
    {
      "sha": "38ee052cd59036749daaa845909858b197861873",
      "filename": "gdb/testsuite/gdb.base/ctf-constvars.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/gdb.base/ctf-constvars.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/gdb.base/ctf-constvars.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/ctf-constvars.exp?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -25,7 +25,7 @@\n # with mixed types.\n \n if [skip_ctf_tests] {\n-    unsupported \"no ctf debug format support\"\n+    unsupported \"no CTF debug format support, or CTF disabled in GDB\"\n     return 0\n }\n "
    },
    {
      "sha": "f981477839c600d05df74d0783c77493f96887df",
      "filename": "gdb/testsuite/gdb.base/ctf-ptype.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/gdb.base/ctf-ptype.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/gdb.base/ctf-ptype.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/ctf-ptype.exp?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -16,14 +16,15 @@\n # This file is a subset of ptype.exp written by Rob Savoye. (rob@cygnus.com)\n \n if [skip_ctf_tests] {\n-    unsupported \"no ctf debug format support\"\n+    unsupported \"no CTF debug format support, or CTF disabled in GDB\"\n     return 0\n }\n \n standard_testfile .c\n \n # Using `-gt` generates full-fledged CTF debug information.\n set opts \"additional_flags=-gt\"\n+\n if { [prepare_for_testing \"failed to prepare\" ${testfile} \\\n \t  [list $srcfile] [list $opts nowarnings]] } {\n     return 0"
    },
    {
      "sha": "e34513f14d3e8d09a84b2f38fe42c3584f35e120",
      "filename": "gdb/testsuite/lib/gdb.exp",
      "status": "modified",
      "additions": 8,
      "deletions": 1,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/lib/gdb.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1776e3e59ca6200dff981894361b8b49cb453766/gdb/testsuite/lib/gdb.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/gdb.exp?ref=1776e3e59ca6200dff981894361b8b49cb453766",
      "patch": "@@ -7169,9 +7169,16 @@ proc cmp_file_string { file str msg } {\n }\n \n # Does the compiler support CTF debug output using '-gt' compiler\n-# flag?  If not then we should skip these tests.\n+# flag?  If not then we should skip these tests.  We should also\n+# skip them if libctf was explicitly disabled.\n \n gdb_caching_proc skip_ctf_tests {\n+    global enable_libctf\n+\n+    if {$enable_libctf eq \"no\"} {\n+\treturn 1\n+    }\n+\n     return ![gdb_can_simple_compile ctfdebug {\n \tint main () {\n \t    return 0;"
    }
  ]
}