{
  "sha": "cee4c731af1e68814548ff00e4e7ecaa8ac07790",
  "node_id": "C_kwDOANOeidoAKGNlZTRjNzMxYWYxZTY4ODE0NTQ4ZmYwMGU0ZTdlY2FhOGFjMDc3OTA",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-09-27T04:13:56Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-09-28T05:51:38Z"
    },
    "message": "sim: drop weak func attrs on module inits\n\nWhen I first wrote this, I was thinking we'd scan all source files\nthat existed and generate a complete init list.  That means for any\nparticular build, we'd probably have a few functions that didn't\nexist, so weak attributes was necessary.  What I ended up scanning\nthough was only the source files that went into a particular build.\n\nThere was another concern too: a source file might be included, but\nthe build settings would cause all of its contents to be skipped\n(via CPP defines).  So scanning via naive grep would pick up names\nnot actually available.  A check of the source tree shows that we\nnever do this, and it's pretty easy to institute a policy that we\ndon't start (by at the very least including a stub init func).\n\nThe use of weak symbols ends up causing a problem in practice: for\na few modules (like profiling), nothing else pulls it in, so the\nlinker omits it entirely, which leads to the profiling module never\nbeing available.  So drop the weak markings since we know all these\nfuncs will be available.",
    "tree": {
      "sha": "71a3e95106d618c04ae02810eabf832dc2331e3b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/71a3e95106d618c04ae02810eabf832dc2331e3b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/cee4c731af1e68814548ff00e4e7ecaa8ac07790",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cee4c731af1e68814548ff00e4e7ecaa8ac07790",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/cee4c731af1e68814548ff00e4e7ecaa8ac07790",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cee4c731af1e68814548ff00e4e7ecaa8ac07790/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2c02075a8ec5223bc4cbcc9561eb91e28d46a9e5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2c02075a8ec5223bc4cbcc9561eb91e28d46a9e5",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/2c02075a8ec5223bc4cbcc9561eb91e28d46a9e5"
    }
  ],
  "stats": {
    "total": 2,
    "additions": 1,
    "deletions": 1
  },
  "files": [
    {
      "sha": "c9ea08f3ccb81a8a9c1b70e8c7ff9ee0c87df9ea",
      "filename": "sim/common/Make-common.in",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cee4c731af1e68814548ff00e4e7ecaa8ac07790/sim/common/Make-common.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cee4c731af1e68814548ff00e4e7ecaa8ac07790/sim/common/Make-common.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/Make-common.in?ref=cee4c731af1e68814548ff00e4e7ecaa8ac07790",
      "patch": "@@ -443,7 +443,7 @@ stamp-modules: Makefile $(SIM_OBJS:.o=.c)\n \techo '/* It is created automatically by the Makefile.  */'; \\\n \techo '#include \"libiberty.h\"'; \\\n \techo '#include \"sim-module.h\"'; \\\n-\tsed -e 's:\\(.*\\):extern __attribute__((__weak__)) MODULE_INIT_FN \\1;:' $@.l-tmp; \\\n+\tsed -e 's:\\(.*\\):extern MODULE_INIT_FN \\1;:' $@.l-tmp; \\\n \techo 'MODULE_INSTALL_FN * const sim_modules_detected[] = {'; \\\n \tsed -e 's:\\(.*\\):  \\1,:' $@.l-tmp; \\\n \techo '};'; \\"
    }
  ]
}