{
  "sha": "276cbbdf990f3f09acacdf3d9603b054ac7d29da",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6Mjc2Y2JiZGY5OTBmM2YwOWFjYWNkZjNkOTYwM2IwNTRhYzdkMjlkYQ==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-08-05T15:15:14Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-08-05T15:15:14Z"
    },
    "message": "Fix objcopy's note merging capabilities so that they no longer insist on the first note being a version note.\n\n\tPR 24874\n\t* objcopy.c (merge_gnu_build_notes): Do not insist on the first\n\tnote being a version note.",
    "tree": {
      "sha": "69fb381e93d2587d39c981cc4175e680f58180c5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/69fb381e93d2587d39c981cc4175e680f58180c5"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/276cbbdf990f3f09acacdf3d9603b054ac7d29da",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/276cbbdf990f3f09acacdf3d9603b054ac7d29da",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/276cbbdf990f3f09acacdf3d9603b054ac7d29da",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/276cbbdf990f3f09acacdf3d9603b054ac7d29da/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "580f1034d10934b757703110db068397c0c1e7bb",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/580f1034d10934b757703110db068397c0c1e7bb",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/580f1034d10934b757703110db068397c0c1e7bb"
    }
  ],
  "stats": {
    "total": 27,
    "additions": 16,
    "deletions": 11
  },
  "files": [
    {
      "sha": "411f835ef892d5129dec758214209c9070b4a290",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/276cbbdf990f3f09acacdf3d9603b054ac7d29da/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/276cbbdf990f3f09acacdf3d9603b054ac7d29da/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=276cbbdf990f3f09acacdf3d9603b054ac7d29da",
      "patch": "@@ -1,3 +1,10 @@\n+2019-08-05  Nick Clifton  <nickc@redhat.com>\n+\n+\tPR 24874\n+\t* objcopy.c (merge_gnu_build_notes): Do not insist on the first\n+\tnote being a version note.\n+\tRemove spurious debugging fprintf.\n+\n 2019-08-05  Nick Clifton  <nickc@redhat.com>\n \n \tPR 24829"
    },
    {
      "sha": "eb25421c6ece341e4728aae59123cc39f1568d1f",
      "filename": "binutils/objcopy.c",
      "status": "modified",
      "additions": 9,
      "deletions": 11,
      "changes": 20,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/276cbbdf990f3f09acacdf3d9603b054ac7d29da/binutils/objcopy.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/276cbbdf990f3f09acacdf3d9603b054ac7d29da/binutils/objcopy.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/objcopy.c?ref=276cbbdf990f3f09acacdf3d9603b054ac7d29da",
      "patch": "@@ -1996,7 +1996,6 @@ merge_gnu_build_notes (bfd * abfd, asection * sec, bfd_size_type size, bfd_byte\n   unsigned long       previous_open_end = 0;\n   long                relsize;\n \n-\n   relsize = bfd_get_reloc_upper_bound (abfd, sec);\n   if (relsize > 0)\n     {\n@@ -2013,7 +2012,8 @@ merge_gnu_build_notes (bfd * abfd, asection * sec, bfd_size_type size, bfd_byte\n     }\n   \n   /* Make a copy of the notes and convert to our internal format.\n-     Minimum size of a note is 12 bytes.  */\n+     Minimum size of a note is 12 bytes.  Also locate the version\n+     notes and check them.  */\n   pnote = pnotes = (objcopy_internal_note *) xcalloc ((size / 12), sizeof (* pnote));\n   while (remain >= 12)\n     {\n@@ -2182,12 +2182,10 @@ merge_gnu_build_notes (bfd * abfd, asection * sec, bfd_size_type size, bfd_byte\n   attribute_type_byte = version_1_seen ? 1 : 3;\n   val_start = attribute_type_byte + 1;\n \n-  /* The first note should be the first version note.  */\n-  if (pnotes[0].note.namedata[attribute_type_byte] != GNU_BUILD_ATTRIBUTE_VERSION)\n-    {\n-      err = _(\"bad GNU build attribute notes: first note not version note\");\n-      goto done;\n-    }\n+  /* We used to require that the first note be a version note,\n+     but this is no longer enforced.  Due to the problems with\n+     linking sections with the same name (eg .gnu.build.note.hot)\n+     we cannot guarantee that the first note will be a version note.  */\n \n   /* Now merge the notes.  The rules are:\n      1. Preserve the ordering of the notes.\n@@ -2204,8 +2202,9 @@ merge_gnu_build_notes (bfd * abfd, asection * sec, bfd_size_type size, bfd_byte\n \twith a non-empty description field must also be preserved *OR* the\n \tdescription field of the note must be changed to contain the starting\n \taddress to which it refers.\n-     6. Notes with the same start and end address can be deleted.  */\n-  for (pnote = pnotes + 1; pnote < pnotes_end; pnote ++)\n+     6. Notes with the same start and end address can be deleted.\n+     7. FIXME: Elminate duplicate version notes - even function specific ones ?  */\n+  for (pnote = pnotes; pnote < pnotes_end; pnote ++)\n     {\n       int                      note_type;\n       objcopy_internal_note *  back;\n@@ -2233,7 +2232,6 @@ merge_gnu_build_notes (bfd * abfd, asection * sec, bfd_size_type size, bfd_byte\n \t\t  && back->note.namesz == pnote->note.namesz\n \t\t  && memcmp (back->note.namedata, pnote->note.namedata, pnote->note.namesz) == 0)\n \t\t{\n- fprintf (stderr, \"DUP FUNXC\\n\");\n \t\t  duplicate_found = TRUE;\n \t\t  pnote->note.type = 0;\n \t\t  break;"
    }
  ]
}