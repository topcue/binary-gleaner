{
  "sha": "a816ba1897ae6939518d628cb58d6281c9b64a4f",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YTgxNmJhMTg5N2FlNjkzOTUxOGQ2MjhjYjU4ZDYyODFjOWI2NGE0Zg==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-04-08T20:33:35Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-04-08T20:47:58Z"
    },
    "message": "Share handle_load_dll and handle_unload_dll declarations\n\nThis changes nat/windows-nat.h to declare handle_load_dll and\nhandle_unload_dll.  The embedding application is required to implement\nthese -- while the actual code was difficult to share due to some\nother differences between the two programs, sharing the declaration\nlets a subsequent patch share more code that uses these as callbacks.\n\ngdb/ChangeLog\n2020-04-08  Tom Tromey  <tromey@adacore.com>\n\n\t* windows-nat.c (windows_nat::handle_load_dll)\n\t(windows_nat::handle_unload_dll): Rename.  No longer static.\n\t* nat/windows-nat.h (handle_load_dll, handle_unload_dll):\n\tDeclare.\n\ngdbserver/ChangeLog\n2020-04-08  Tom Tromey  <tromey@adacore.com>\n\n\t* win32-low.c (windows_nat::handle_load_dll): Rename from\n\thandle_load_dll.  No longer static.\n\t(windows_nat::handle_unload_dll): Rename from handle_unload_dll.\n\tNo longer static.",
    "tree": {
      "sha": "179eba68f717d61dac25ea5221d8c834944fdfe4",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/179eba68f717d61dac25ea5221d8c834944fdfe4"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/a816ba1897ae6939518d628cb58d6281c9b64a4f",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a816ba1897ae6939518d628cb58d6281c9b64a4f",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/a816ba1897ae6939518d628cb58d6281c9b64a4f",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a816ba1897ae6939518d628cb58d6281c9b64a4f/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a00caa12790706017c9331ad984b4f6b102db1b6",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a00caa12790706017c9331ad984b4f6b102db1b6",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/a00caa12790706017c9331ad984b4f6b102db1b6"
    }
  ],
  "stats": {
    "total": 78,
    "additions": 45,
    "deletions": 33
  },
  "files": [
    {
      "sha": "9a5e4168b1fe84e64e07ab50dd3998202e87cd74",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=a816ba1897ae6939518d628cb58d6281c9b64a4f",
      "patch": "@@ -1,3 +1,10 @@\n+2020-04-08  Tom Tromey  <tromey@adacore.com>\n+\n+\t* windows-nat.c (windows_nat::handle_load_dll)\n+\t(windows_nat::handle_unload_dll): Rename.  No longer static.\n+\t* nat/windows-nat.h (handle_load_dll, handle_unload_dll):\n+\tDeclare.\n+\n 2020-04-08  Tom Tromey  <tromey@adacore.com>\n \n \t* complaints.h (stop_whining): Declare at top-level."
    },
    {
      "sha": "2b2fd116269cda1d39f4607e538ef8dfc7913b39",
      "filename": "gdb/nat/windows-nat.h",
      "status": "modified",
      "additions": 19,
      "deletions": 0,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdb/nat/windows-nat.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdb/nat/windows-nat.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/nat/windows-nat.h?ref=a816ba1897ae6939518d628cb58d6281c9b64a4f",
      "patch": "@@ -125,6 +125,25 @@ extern windows_thread_info *thread_rec (ptid_t ptid,\n    This function must be supplied by the embedding application.  */\n extern int handle_output_debug_string (struct target_waitstatus *ourstatus);\n \n+/* Handle a DLL load event.\n+\n+   This function assumes that the current event did not occur during\n+   inferior initialization.\n+\n+   This function must be supplied by the embedding application.  */\n+\n+extern void handle_load_dll ();\n+\n+/* Handle a DLL unload event.\n+\n+   This function assumes that this event did not occur during inferior\n+   initialization.\n+\n+   This function must be supplied by the embedding application.  */\n+\n+extern void handle_unload_dll ();\n+\n+\n /* Currently executing process */\n extern HANDLE current_process_handle;\n extern DWORD current_process_id;"
    },
    {
      "sha": "81811681ef6cdcd7d8bba78de77a3a5992752b40",
      "filename": "gdb/windows-nat.c",
      "status": "modified",
      "additions": 6,
      "deletions": 17,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdb/windows-nat.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdb/windows-nat.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/windows-nat.c?ref=a816ba1897ae6939518d628cb58d6281c9b64a4f",
      "patch": "@@ -870,15 +870,10 @@ windows_make_so (const char *name, LPVOID load_addr)\n   return so;\n }\n \n-/* Handle a DLL load event, and return 1.\n-\n-   This function assumes that this event did not occur during inferior\n-   initialization, where their event info may be incomplete (see\n-   do_initial_windows_stuff and windows_add_all_dlls for more info\n-   on how we handle DLL loading during that phase).  */\n+/* See nat/windows-nat.h.  */\n \n-static void\n-handle_load_dll ()\n+void\n+windows_nat::handle_load_dll ()\n {\n   LOAD_DLL_DEBUG_INFO *event = &current_event.u.LoadDll;\n   const char *dll_name;\n@@ -911,16 +906,10 @@ windows_free_so (struct so_list *so)\n   xfree (so);\n }\n \n-/* Handle a DLL unload event.\n-   Return 1 if successful, or zero otherwise.\n-\n-   This function assumes that this event did not occur during inferior\n-   initialization, where their event info may be incomplete (see\n-   do_initial_windows_stuff and windows_add_all_dlls for more info\n-   on how we handle DLL loading during that phase).  */\n+/* See nat/windows-nat.h.  */\n \n-static void\n-handle_unload_dll ()\n+void\n+windows_nat::handle_unload_dll ()\n {\n   LPVOID lpBaseOfDll = current_event.u.UnloadDll.lpBaseOfDll;\n   struct so_list *so;"
    },
    {
      "sha": "e6213adf0feea52dfc038b89c03c31356c57bcd7",
      "filename": "gdbserver/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/ChangeLog?ref=a816ba1897ae6939518d628cb58d6281c9b64a4f",
      "patch": "@@ -1,3 +1,10 @@\n+2020-04-08  Tom Tromey  <tromey@adacore.com>\n+\n+\t* win32-low.c (windows_nat::handle_load_dll): Rename from\n+\thandle_load_dll.  No longer static.\n+\t(windows_nat::handle_unload_dll): Rename from handle_unload_dll.\n+\tNo longer static.\n+\n 2020-04-08  Tom Tromey  <tromey@adacore.com>\n \n \t* win32-low.c (handle_output_debug_string): Add parameter.  Change"
    },
    {
      "sha": "73d4a6a2d8aec61f99f1b2301c9d83175b5268e8",
      "filename": "gdbserver/win32-low.cc",
      "status": "modified",
      "additions": 6,
      "deletions": 16,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdbserver/win32-low.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a816ba1897ae6939518d628cb58d6281c9b64a4f/gdbserver/win32-low.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/win32-low.cc?ref=a816ba1897ae6939518d628cb58d6281c9b64a4f",
      "patch": "@@ -1123,15 +1123,10 @@ typedef HANDLE (WINAPI *winapi_CreateToolhelp32Snapshot) (DWORD, DWORD);\n typedef BOOL (WINAPI *winapi_Module32First) (HANDLE, LPMODULEENTRY32);\n typedef BOOL (WINAPI *winapi_Module32Next) (HANDLE, LPMODULEENTRY32);\n \n-/* Handle a DLL load event.\n-\n-   This function assumes that this event did not occur during inferior\n-   initialization, where their event info may be incomplete (see\n-   do_initial_child_stuff and win32_add_all_dlls for more info on\n-   how we handle DLL loading during that phase).  */\n+/* See nat/windows-nat.h.  */\n \n-static void\n-handle_load_dll (void)\n+void\n+windows_nat::handle_load_dll ()\n {\n   LOAD_DLL_DEBUG_INFO *event = &current_event.u.LoadDll;\n   const char *dll_name;\n@@ -1144,15 +1139,10 @@ handle_load_dll (void)\n   win32_add_one_solib (dll_name, (CORE_ADDR) (uintptr_t) event->lpBaseOfDll);\n }\n \n-/* Handle a DLL unload event.\n-\n-   This function assumes that this event did not occur during inferior\n-   initialization, where their event info may be incomplete (see\n-   do_initial_child_stuff and win32_add_one_solib for more info\n-   on how we handle DLL loading during that phase).  */\n+/* See nat/windows-nat.h.  */\n \n-static void\n-handle_unload_dll (void)\n+void\n+windows_nat::handle_unload_dll ()\n {\n   CORE_ADDR load_addr =\n \t  (CORE_ADDR) (uintptr_t) current_event.u.UnloadDll.lpBaseOfDll;"
    }
  ]
}