{
  "sha": "9ad7fdef7c72b2aca0398ce8e63b89e560873807",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OWFkN2ZkZWY3YzcyYjJhY2EwMzk4Y2U4ZTYzYjg5ZTU2MDg3MzgwNw==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-06-24T03:00:01Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-07-17T18:18:52Z"
    },
    "message": "Consolidate \"if\"s in tui_show_frame_info\n\ntui_show_frame_info has two parallel \"if\"s with the same condition and\nno intervening code.  The second \"if\" perhaps wasn't obviously\nidentical, but earlier refactorings made it clearer, by pointing out\nthat only source and disassembly windows can be handled here.  This\nmerges the two statements.\n\ngdb/ChangeLog\n2019-07-17  Tom Tromey  <tom@tromey.com>\n\n\t* tui/tui-stack.c (tui_show_frame_info): Consolidate \"if\"s.",
    "tree": {
      "sha": "84ba4c66969d0db89890d40a1209cca4a078abc0",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/84ba4c66969d0db89890d40a1209cca4a078abc0"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/9ad7fdef7c72b2aca0398ce8e63b89e560873807",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9ad7fdef7c72b2aca0398ce8e63b89e560873807",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/9ad7fdef7c72b2aca0398ce8e63b89e560873807",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9ad7fdef7c72b2aca0398ce8e63b89e560873807/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5813316fa4aeaf52f374c20c7fdb9747b88fa8ca",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5813316fa4aeaf52f374c20c7fdb9747b88fa8ca",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5813316fa4aeaf52f374c20c7fdb9747b88fa8ca"
    }
  ],
  "stats": {
    "total": 66,
    "additions": 31,
    "deletions": 35
  },
  "files": [
    {
      "sha": "54c19e0144a7268b44f05f1022a9b3764dd47fed",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9ad7fdef7c72b2aca0398ce8e63b89e560873807/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9ad7fdef7c72b2aca0398ce8e63b89e560873807/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=9ad7fdef7c72b2aca0398ce8e63b89e560873807",
      "patch": "@@ -1,3 +1,7 @@\n+2019-07-17  Tom Tromey  <tom@tromey.com>\n+\n+\t* tui/tui-stack.c (tui_show_frame_info): Consolidate \"if\"s.\n+\n 2019-07-17  Tom Tromey  <tom@tromey.com>\n \n \t* tui/tui-winsource.c (tui_update_source_window_as_is)"
    },
    {
      "sha": "e1b996d7e6cd9fd500222c34f360051c2e32ca9d",
      "filename": "gdb/tui/tui-stack.c",
      "status": "modified",
      "additions": 27,
      "deletions": 35,
      "changes": 62,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9ad7fdef7c72b2aca0398ce8e63b89e560873807/gdb/tui/tui-stack.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9ad7fdef7c72b2aca0398ce8e63b89e560873807/gdb/tui/tui-stack.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-stack.c?ref=9ad7fdef7c72b2aca0398ce8e63b89e560873807",
      "patch": "@@ -341,8 +341,6 @@ tui_show_frame_info (struct frame_info *fi)\n \n   if (fi)\n     {\n-      int start_line;\n-      CORE_ADDR low;\n       struct tui_locator_window *locator = tui_locator_win_info_ptr ();\n       int source_already_displayed;\n       CORE_ADDR pc;\n@@ -372,32 +370,15 @@ tui_show_frame_info (struct frame_info *fi)\n \treturn 0;\n \n       tui_show_locator_content ();\n-      start_line = 0;\n       for (struct tui_source_window_base *win_info : tui_source_windows ())\n \t{\n \t  if (win_info == TUI_SRC_WIN)\n \t    {\n-\t      start_line = (locator->line_no -\n-\t\t\t   (win_info->viewport_height / 2)) + 1;\n+\t      int start_line = (locator->line_no -\n+\t\t\t\t(win_info->viewport_height / 2)) + 1;\n \t      if (start_line <= 0)\n \t\tstart_line = 1;\n-\t    }\n-\t  else\n-\t    {\n-\t      if (find_pc_partial_function (get_frame_pc (fi),\n-\t\t\t\t\t    NULL, &low, NULL) == 0)\n-\t\t{\n-\t\t  /* There is no symbol available for current PC.  There is no\n-\t\t     safe way how to \"disassemble backwards\".  */\n-\t\t  low = get_frame_pc (fi);\n-\t\t}\n-\t      else\n-\t\tlow = tui_get_low_disassembly_address (get_frame_arch (fi),\n-\t\t\t\t\t\t       low, get_frame_pc (fi));\n-\t    }\n \n-\t  if (win_info == TUI_SRC_WIN)\n-\t    {\n \t      struct tui_line_or_address l;\n \n \t      l.loa = LOA_LINE;\n@@ -415,23 +396,34 @@ tui_show_frame_info (struct frame_info *fi)\n \t    }\n \t  else\n \t    {\n-\t      if (win_info == TUI_DISASM_WIN)\n+\t      CORE_ADDR low;\n+\n+\t      if (find_pc_partial_function (get_frame_pc (fi),\n+\t\t\t\t\t    NULL, &low, NULL) == 0)\n+\t\t{\n+\t\t  /* There is no symbol available for current PC.  There is no\n+\t\t     safe way how to \"disassemble backwards\".  */\n+\t\t  low = get_frame_pc (fi);\n+\t\t}\n+\t      else\n+\t\tlow = tui_get_low_disassembly_address (get_frame_arch (fi),\n+\t\t\t\t\t\t       low, get_frame_pc (fi));\n+\n+\t      struct tui_line_or_address a;\n+\n+\t      a.loa = LOA_ADDRESS;\n+\t      a.u.addr = low;\n+\t      if (!tui_addr_is_displayed (locator->addr,\n+\t\t\t\t\t  win_info, TRUE))\n+\t\ttui_update_source_window (win_info, get_frame_arch (fi),\n+\t\t\t\t\t  sal.symtab, a, TRUE);\n+\t      else\n \t\t{\n-\t\t  struct tui_line_or_address a;\n-\n-\t\t  a.loa = LOA_ADDRESS;\n-\t\t  a.u.addr = low;\n-\t\t  if (!tui_addr_is_displayed (locator->addr,\n-\t\t\t\t\t      win_info, TRUE))\n-\t\t    tui_update_source_window (win_info, get_frame_arch (fi),\n-\t\t\t\t\t      sal.symtab, a, TRUE);\n-\t\t  else\n-\t\t    {\n-\t\t      a.u.addr = locator->addr;\n-\t\t      win_info->set_is_exec_point_at (a);\n-\t\t    }\n+\t\t  a.u.addr = locator->addr;\n+\t\t  win_info->set_is_exec_point_at (a);\n \t\t}\n \t    }\n+\n \t  tui_update_exec_info (win_info);\n \t}\n "
    }
  ]
}