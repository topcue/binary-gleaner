{
  "sha": "0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDMzNTM3OGI0Y2QyZmM4MjQ2YjJlYjdjZmUyYjdlNGNmNzU3YTM3Nw==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-02-08T20:40:54Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-02-08T20:43:24Z"
    },
    "message": "Change dwarf2_per_objfile::die_type_hash to htab_up\n\nThis changes dwarf2_per_objfile::die_type_hash to be an htab_up,\nmoving its contents off the objfile obstack.\n\n2020-02-08  Tom Tromey  <tom@tromey.com>\n\n\t* dwarf2/read.c (set_die_type, get_die_type_at_offset): Update.\n\t* dwarf2/read.h (struct dwarf2_per_objfile) <die_type_hash>: Now\n\thtab_up.\n\nChange-Id: Ic651f99ebf71bf7ad2dc2880192adacf7b60964a",
    "tree": {
      "sha": "7d68ca72c898594e02babc75b5699846db445ecd",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/7d68ca72c898594e02babc75b5699846db445ecd"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "48b490f28a2152134a51215a06cb22c9b09a7a80",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/48b490f28a2152134a51215a06cb22c9b09a7a80",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/48b490f28a2152134a51215a06cb22c9b09a7a80"
    }
  ],
  "stats": {
    "total": 27,
    "additions": 14,
    "deletions": 13
  },
  "files": [
    {
      "sha": "014c85831daab7d6a797da7f8aaf60f7f960a8ee",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377",
      "patch": "@@ -1,3 +1,9 @@\n+2020-02-08  Tom Tromey  <tom@tromey.com>\n+\n+\t* dwarf2/read.c (set_die_type, get_die_type_at_offset): Update.\n+\t* dwarf2/read.h (struct dwarf2_per_objfile) <die_type_hash>: Now\n+\thtab_up.\n+\n 2020-02-08  Tom Tromey  <tom@tromey.com>\n \n \t* dwarf2/read.c (struct dwp_file) <loaded_cus, loaded_tus>: Now"
    },
    {
      "sha": "e42f4f25795a07dea834ea005d453500148f9a73",
      "filename": "gdb/dwarf2/read.c",
      "status": "modified",
      "additions": 7,
      "deletions": 12,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377/gdb/dwarf2/read.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377/gdb/dwarf2/read.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/dwarf2/read.c?ref=0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377",
      "patch": "@@ -25184,22 +25184,17 @@ set_die_type (struct die_info *die, struct type *type, struct dwarf2_cu *cu)\n     add_dyn_prop (DYN_PROP_DATA_LOCATION, prop, type);\n \n   if (dwarf2_per_objfile->die_type_hash == NULL)\n-    {\n-      dwarf2_per_objfile->die_type_hash =\n-\thtab_create_alloc_ex (127,\n-\t\t\t      per_cu_offset_and_type_hash,\n-\t\t\t      per_cu_offset_and_type_eq,\n-\t\t\t      NULL,\n-\t\t\t      &objfile->objfile_obstack,\n-\t\t\t      hashtab_obstack_allocate,\n-\t\t\t      dummy_obstack_deallocate);\n-    }\n+    dwarf2_per_objfile->die_type_hash\n+      = htab_up (htab_create_alloc (127,\n+\t\t\t\t    per_cu_offset_and_type_hash,\n+\t\t\t\t    per_cu_offset_and_type_eq,\n+\t\t\t\t    NULL, xcalloc, xfree));\n \n   ofs.per_cu = cu->per_cu;\n   ofs.sect_off = die->sect_off;\n   ofs.type = type;\n   slot = (struct dwarf2_per_cu_offset_and_type **)\n-    htab_find_slot (dwarf2_per_objfile->die_type_hash, &ofs, INSERT);\n+    htab_find_slot (dwarf2_per_objfile->die_type_hash.get (), &ofs, INSERT);\n   if (*slot)\n     complaint (_(\"A problem internal to GDB: DIE %s has type already set\"),\n \t       sect_offset_str (die->sect_off));\n@@ -25225,7 +25220,7 @@ get_die_type_at_offset (sect_offset sect_off,\n   ofs.per_cu = per_cu;\n   ofs.sect_off = sect_off;\n   slot = ((struct dwarf2_per_cu_offset_and_type *)\n-\t  htab_find (dwarf2_per_objfile->die_type_hash, &ofs));\n+\t  htab_find (dwarf2_per_objfile->die_type_hash.get (), &ofs));\n   if (slot)\n     return slot->type;\n   else"
    },
    {
      "sha": "c177747e32e8b7156171fb869b27168c1395604f",
      "filename": "gdb/dwarf2/read.h",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377/gdb/dwarf2/read.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377/gdb/dwarf2/read.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/dwarf2/read.h?ref=0335378b4cd2fc8246b2eb7cfe2b7e4cf757a377",
      "patch": "@@ -214,7 +214,7 @@ struct dwarf2_per_objfile\n   /* Table mapping type DIEs to their struct type *.\n      This is NULL if not allocated yet.\n      The mapping is done via (CU/TU + DIE offset) -> type.  */\n-  htab_t die_type_hash {};\n+  htab_up die_type_hash;\n \n   /* The CUs we recently read.  */\n   std::vector<dwarf2_per_cu_data *> just_read_cus;"
    }
  ]
}