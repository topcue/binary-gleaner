{
  "sha": "164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTY0ZDQ5Y2IxYzliOWY3ZTI5MTRjZjc4ZjY0ZjVmNTdjZWIwN2RkZQ==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2019-12-09T12:31:07Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2019-12-09T12:31:07Z"
    },
    "message": "x86/Intel: fix \"near ptr\" / \"far ptr\" handling\n\nCommit dc2be329b950 (\"i386: Only check suffix in instruction mnemonic\")\nbroke rejecting of these for floating point insns. Fix this by setting\nthe \"byte\" operand attribute, which will now (again) cause an error.\n\nFurthermore the diagnostic for the \"far ptr\" case in general and for the\n\"near ptr\" case in the non-float cases became \"invalid instruction\nsuffix\" instead of the intended \"operand size mismatch\". Fix this by\nalso setting the \"tbyte\" operand attribute (no insn template accepts\nboth byte and tbyte operands).",
    "tree": {
      "sha": "571ed2970908cb24c1d784d62fec02de5fc24c10",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/571ed2970908cb24c1d784d62fec02de5fc24c10"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/comments",
  "author": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a8f4f6b9bc2b1273cfa94fc1f21af7bcf13012d5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a8f4f6b9bc2b1273cfa94fc1f21af7bcf13012d5",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/a8f4f6b9bc2b1273cfa94fc1f21af7bcf13012d5"
    }
  ],
  "stats": {
    "total": 27,
    "additions": 24,
    "deletions": 3
  },
  "files": [
    {
      "sha": "f198b01a441080efe2dbe408442e2a19b88d522b",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde",
      "patch": "@@ -1,3 +1,11 @@\n+2019-12-09  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* config/tc-i386-intel.c (i386_intel_operand): Set \"byte\"\n+\tattribute suffix instead of suffix for floating point insns when\n+\thandling O_near_ptr / O_far_ptr.\n+\t* testsuite/gas/i386/intelbad.s: Add FPU tests.\n+\t* testsuite/gas/i386/intelbad.l: Adjust expectations.\n+\n 2019-12-09  Jan Beulich  <jbeulich@suse.com>\n \n \t* config/tc-i386-intel.c (i386_intel_operand): Set \"byte\""
    },
    {
      "sha": "8eb587b233e29bb2f4fa5f212e111879dce992f3",
      "filename": "gas/config/tc-i386-intel.c",
      "status": "modified",
      "additions": 6,
      "deletions": 3,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/gas/config/tc-i386-intel.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/gas/config/tc-i386-intel.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386-intel.c?ref=164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde",
      "patch": "@@ -718,9 +718,12 @@ i386_intel_operand (char *operand_string, int got_a_float)\n \tcase O_near_ptr:\n \t  if (current_templates->start->opcode_modifier.jump != JUMP\n \t      && current_templates->start->opcode_modifier.jump != JUMP_DWORD)\n-\t    suffix = got_a_float /* so it will cause an error */\n-\t\t     ? BYTE_MNEM_SUFFIX\n-\t\t     : LONG_DOUBLE_MNEM_SUFFIX;\n+\t    {\n+\t      /* cause an error */\n+\t      i.types[this_operand].bitfield.byte = 1;\n+\t      i.types[this_operand].bitfield.tbyte = 1;\n+\t      suffix = i.suffix;\n+\t    }\n \t  break;\n \n \tdefault:"
    },
    {
      "sha": "20809136fe02c1ff897b3939619862b119e06046",
      "filename": "gas/testsuite/gas/i386/intelbad.l",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/gas/testsuite/gas/i386/intelbad.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/gas/testsuite/gas/i386/intelbad.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/intelbad.l?ref=164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde",
      "patch": "@@ -157,3 +157,7 @@\n .*:176: Warning: .*\n .*:177: Error: .*\n .*:178: Error: .*\n+.*:180: Error: .*\n+.*:181: Error: .*\n+.*:183: Error: .*\n+.*:184: Error: .*"
    },
    {
      "sha": "afbb6035dad5c9cebb2584a3a9ee7b428cb1ed86",
      "filename": "gas/testsuite/gas/i386/intelbad.s",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/gas/testsuite/gas/i386/intelbad.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde/gas/testsuite/gas/i386/intelbad.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/intelbad.s?ref=164d49cb1c9b9f7e2914cf78f64f5f57ceb07dde",
      "patch": "@@ -176,3 +176,9 @@ start:\n \tlfs\teax, dword ptr [eax]\n \tlgs\teax, qword ptr [eax]\n \tlss\teax, tbyte ptr [eax]\n+\n+\tfld\tnear ptr [ebx]\n+\tfst\tfar ptr [ebx]\n+\n+\tfild\tfar ptr [ebx]\n+\tfist\tnear ptr [ebx]"
    }
  ]
}