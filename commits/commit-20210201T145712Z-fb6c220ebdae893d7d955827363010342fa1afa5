{
  "sha": "fb6c220ebdae893d7d955827363010342fa1afa5",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZmI2YzIyMGViZGFlODkzZDdkOTU1ODI3MzYzMDEwMzQyZmExYWZhNQ==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-01-29T22:35:50Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-02-01T14:57:12Z"
    },
    "message": "ld --defsym\n\nThis makes --defsym support the same expressions as assignment in a\nscript.  For example, --defsym 'HIDDEN(foo=0)', will define a hidden\nvisibility foo.\n\n\t* ldgram.y (defsym_expr): Use assignment rule.\n\t* ldlex.h (ldlex_defsym): Delete.\n\t* ldlex.l (DEFSYMEXP, ldlex_defsym): Delete.",
    "tree": {
      "sha": "72f615ae32e85635b5a6082e5839d155605b48b3",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/72f615ae32e85635b5a6082e5839d155605b48b3"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/fb6c220ebdae893d7d955827363010342fa1afa5",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fb6c220ebdae893d7d955827363010342fa1afa5",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/fb6c220ebdae893d7d955827363010342fa1afa5",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fb6c220ebdae893d7d955827363010342fa1afa5/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "40726f16a8d7105761e36398054860a923d4efc9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/40726f16a8d7105761e36398054860a923d4efc9",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/40726f16a8d7105761e36398054860a923d4efc9"
    }
  ],
  "stats": {
    "total": 35,
    "additions": 11,
    "deletions": 24
  },
  "files": [
    {
      "sha": "a84da33f8a749c9559e85f77fc9aa28546b087de",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb6c220ebdae893d7d955827363010342fa1afa5/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb6c220ebdae893d7d955827363010342fa1afa5/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=fb6c220ebdae893d7d955827363010342fa1afa5",
      "patch": "@@ -1,3 +1,9 @@\n+2021-02-01  Alan Modra  <amodra@gmail.com>\n+\n+\t* ldgram.y (defsym_expr): Use assignment rule.\n+\t* ldlex.h (ldlex_defsym): Delete.\n+\t* ldlex.l (DEFSYMEXP, ldlex_defsym): Delete.\n+\n 2021-02-01  Alan Modra  <amodra@gmail.com>\n \n \t* ldgram.y (section): Call ldlex_backup.  Remove empty action."
    },
    {
      "sha": "5912329c778def1db64349f37c66c0cd89a5003b",
      "filename": "ld/ldgram.y",
      "status": "modified",
      "additions": 3,
      "deletions": 6,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb6c220ebdae893d7d955827363010342fa1afa5/ld/ldgram.y",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb6c220ebdae893d7d955827363010342fa1afa5/ld/ldgram.y",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldgram.y?ref=fb6c220ebdae893d7d955827363010342fa1afa5",
      "patch": "@@ -176,12 +176,9 @@ filename:  NAME;\n \n \n defsym_expr:\n-\t\t{ ldlex_defsym(); }\n-\t\tNAME '=' exp\n-\t\t{\n-\t\t  ldlex_popstate();\n-\t\t  lang_add_assignment (exp_defsym ($2, $4));\n-\t\t}\n+\t\t{ ldlex_expression(); }\n+\t\tassignment\n+\t\t{ ldlex_popstate(); }\n \t;\n \n /* SYNTAX WITHIN AN MRI SCRIPT FILE */"
    },
    {
      "sha": "3ce1ad4471643e5d6edeece9ed77d595817b2cc0",
      "filename": "ld/ldlex.h",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb6c220ebdae893d7d955827363010342fa1afa5/ld/ldlex.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb6c220ebdae893d7d955827363010342fa1afa5/ld/ldlex.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldlex.h?ref=fb6c220ebdae893d7d955827363010342fa1afa5",
      "patch": "@@ -187,7 +187,6 @@ extern void ldlex_inputlist (void);\n extern void ldlex_mri_script (void);\n extern void ldlex_version_script (void);\n extern void ldlex_version_file (void);\n-extern void ldlex_defsym (void);\n extern void ldlex_expression (void);\n extern void ldlex_both (void);\n extern void ldlex_popstate (void);"
    },
    {
      "sha": "c1b15263587dae424e33c3e0dc709746be332a90",
      "filename": "ld/ldlex.l",
      "status": "modified",
      "additions": 2,
      "deletions": 17,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb6c220ebdae893d7d955827363010342fa1afa5/ld/ldlex.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb6c220ebdae893d7d955827363010342fa1afa5/ld/ldlex.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldlex.l?ref=fb6c220ebdae893d7d955827363010342fa1afa5",
      "patch": "@@ -79,7 +79,6 @@ static void lex_warn_invalid (char *where, char *what);\n \tSCRIPT\t\tdefinitely in a script\n \tINPUTLIST\tdefinitely in a script, a filename-list\n \tBOTH\t\teither EXPRESSION or SCRIPT\n-\tDEFSYMEXP\tin an argument to -defsym\n \tMRI\t\tin an MRI script\n \tVERS_START\tstarting a Sun style mapfile\n \tVERS_SCRIPT\ta Sun style mapfile\n@@ -107,7 +106,6 @@ V_IDENTIFIER [*?.$_a-zA-Z\\[\\]\\-\\!\\^\\\\]([*?.$_a-zA-Z0-9\\[\\]\\-\\!\\^\\\\]|::)*\n %s INPUTLIST\n %s EXPRESSION\n %s BOTH\n-%s DEFSYMEXP\n %s MRI\n %s VERS_START\n %s VERS_SCRIPT\n@@ -133,12 +131,6 @@ V_IDENTIFIER [*?.$_a-zA-Z\\[\\]\\-\\!\\^\\\\]([*?.$_a-zA-Z0-9\\[\\]\\-\\!\\^\\\\]|::)*\n <BOTH,SCRIPT,EXPRESSION,VERS_START,VERS_NODE,VERS_SCRIPT,INPUTLIST>\"/*\"\t{ comment (); }\n \n \n-<DEFSYMEXP>\"-\"\t\t\t{ RTOKEN('-');}\n-<DEFSYMEXP>\"+\"\t\t\t{ RTOKEN('+');}\n-<DEFSYMEXP>{SYMBOLNAMECHAR1}{SYMBOLNAMECHAR}* { yylval.name = xstrdup (yytext);\n-\t\t\t\t\t\treturn NAME; }\n-<DEFSYMEXP>\"=\"\t\t\t{ RTOKEN('='); }\n-\n <MRI,EXPRESSION>\"$\"([0-9A-Fa-f])+ {\n \t\t\t\tyylval.integer = bfd_scan_vma (yytext + 1, 0, 16);\n \t\t\t\tyylval.bigint.str = NULL;\n@@ -170,7 +162,7 @@ V_IDENTIFIER [*?.$_a-zA-Z\\[\\]\\-\\!\\^\\\\]([*?.$_a-zA-Z0-9\\[\\]\\-\\!\\^\\\\]|::)*\n \t\t\t\t   yylval.bigint.str = NULL;\n \t\t\t\t   return INT;\n \t\t\t\t }\n-<SCRIPT,DEFSYMEXP,MRI,BOTH,EXPRESSION>(((\"$\"|0[xX])([0-9A-Fa-f])+)|(([0-9])+))(M|K|m|k)? {\n+<SCRIPT,MRI,BOTH,EXPRESSION>(((\"$\"|0[xX])([0-9A-Fa-f])+)|(([0-9])+))(M|K|m|k)? {\n \t\t\t\t  char *s = yytext;\n \t\t\t\t  int ibase = 0;\n \n@@ -480,7 +472,7 @@ V_IDENTIFIER [*?.$_a-zA-Z\\[\\]\\-\\!\\^\\\\]([*?.$_a-zA-Z0-9\\[\\]\\-\\!\\^\\\\]|::)*\n }\n \n <SCRIPT,MRI,VERS_START,VERS_SCRIPT,VERS_NODE>.\tlex_warn_invalid (\" in script\", yytext);\n-<EXPRESSION,DEFSYMEXP,BOTH>.\tlex_warn_invalid (\" in expression\", yytext);\n+<EXPRESSION,BOTH>.\tlex_warn_invalid (\" in expression\", yytext);\n \n %%\n \f\n@@ -609,13 +601,6 @@ ldlex_version_file (void)\n   BEGIN (VERS_SCRIPT);\n }\n \n-void\n-ldlex_defsym (void)\n-{\n-  *(state_stack_p)++ = yy_start;\n-  BEGIN (DEFSYMEXP);\n-}\n-\n void\n ldlex_expression (void)\n {"
    }
  ]
}