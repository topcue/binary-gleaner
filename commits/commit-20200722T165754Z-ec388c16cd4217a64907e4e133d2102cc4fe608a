{
  "sha": "ec388c16cd4217a64907e4e133d2102cc4fe608a",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZWMzODhjMTZjZDQyMTdhNjQ5MDdlNGUxMzNkMjEwMmNjNGZlNjA4YQ==",
  "commit": {
    "author": {
      "name": "Nick Alcock",
      "email": "nick.alcock@oracle.com",
      "date": "2020-06-03T16:31:44Z"
    },
    "committer": {
      "name": "Nick Alcock",
      "email": "nick.alcock@oracle.com",
      "date": "2020-07-22T16:57:54Z"
    },
    "message": "libctf: error out on corrupt CTF with invalid header flags\n\nIf corrupt CTF with invalid header flags is passed in, return the new\nerror ECTF_FLAGS.\n\ninclude/\n\t* ctf-api.h (ECTF_FLAGS): New.\n\t(ECTF_NERR): Adjust.\n\t* ctf.h (CTF_F_MAX): New.\nlibctf/\n\t* ctf-open.c (ctf_bufopen_internal): Diagnose invalid flags.",
    "tree": {
      "sha": "b2843ad6885d24e75b5351487b008fe2598fa3d0",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/b2843ad6885d24e75b5351487b008fe2598fa3d0"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ec388c16cd4217a64907e4e133d2102cc4fe608a",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ec388c16cd4217a64907e4e133d2102cc4fe608a",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ec388c16cd4217a64907e4e133d2102cc4fe608a",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ec388c16cd4217a64907e4e133d2102cc4fe608a/comments",
  "author": {
    "login": "nickalcock",
    "id": 6503005,
    "node_id": "MDQ6VXNlcjY1MDMwMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6503005?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickalcock",
    "html_url": "https://github.com/nickalcock",
    "followers_url": "https://api.github.com/users/nickalcock/followers",
    "following_url": "https://api.github.com/users/nickalcock/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickalcock/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickalcock/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickalcock/subscriptions",
    "organizations_url": "https://api.github.com/users/nickalcock/orgs",
    "repos_url": "https://api.github.com/users/nickalcock/repos",
    "events_url": "https://api.github.com/users/nickalcock/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickalcock/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickalcock",
    "id": 6503005,
    "node_id": "MDQ6VXNlcjY1MDMwMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6503005?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickalcock",
    "html_url": "https://github.com/nickalcock",
    "followers_url": "https://api.github.com/users/nickalcock/followers",
    "following_url": "https://api.github.com/users/nickalcock/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickalcock/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickalcock/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickalcock/subscriptions",
    "organizations_url": "https://api.github.com/users/nickalcock/orgs",
    "repos_url": "https://api.github.com/users/nickalcock/repos",
    "events_url": "https://api.github.com/users/nickalcock/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickalcock/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "67d4cc671b7b3c49f748546a510005333fcbc465",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/67d4cc671b7b3c49f748546a510005333fcbc465",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/67d4cc671b7b3c49f748546a510005333fcbc465"
    }
  ],
  "stats": {
    "total": 21,
    "additions": 18,
    "deletions": 3
  },
  "files": [
    {
      "sha": "8a48d009a69a4d082c8aaf956030280fc9ad3cbb",
      "filename": "include/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ec388c16cd4217a64907e4e133d2102cc4fe608a/include/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ec388c16cd4217a64907e4e133d2102cc4fe608a/include/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ChangeLog?ref=ec388c16cd4217a64907e4e133d2102cc4fe608a",
      "patch": "@@ -1,3 +1,9 @@\n+2020-07-22  Nick Alcock  <nick.alcock@oracle.com>\n+\n+\t* ctf-api.h (ECTF_FLAGS): New.\n+\t(ECTF_NERR): Adjust.\n+\t* ctf.h (CTF_F_MAX): New.\n+\n 2020-07-22  Nick Alcock  <nick.alcock@oracle.com>\n \n \t* ctf-api.h (ECTF_NEXT_END): New error."
    },
    {
      "sha": "760b1e46dc653b210f81bfc4d0400c1f0ba25901",
      "filename": "include/ctf-api.h",
      "status": "modified",
      "additions": 3,
      "deletions": 2,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ec388c16cd4217a64907e4e133d2102cc4fe608a/include/ctf-api.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ec388c16cd4217a64907e4e133d2102cc4fe608a/include/ctf-api.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ctf-api.h?ref=ec388c16cd4217a64907e4e133d2102cc4fe608a",
      "patch": "@@ -207,10 +207,11 @@ enum\n    ECTF_NONREPRESENTABLE, /* Type not representable in CTF.  */\n    ECTF_NEXT_END,\t/* End of iteration.  */\n    ECTF_NEXT_WRONGFUN,\t/* Wrong iteration function called.  */\n-   ECTF_NEXT_WRONGFP\t/* Iteration entity changed in mid-iterate.  */\n+   ECTF_NEXT_WRONGFP,\t/* Iteration entity changed in mid-iterate.  */\n+   ECTF_FLAGS\t\t/* CTF header contains flags unknown to libctf.  */\n   };\n \n-#define ECTF_NERR (ECTF_NEXT_WRONGFP - ECTF_BASE + 1)\t/* Count of CTF errors.  */\n+#define ECTF_NERR (ECTF_FLAGS - ECTF_BASE + 1)\t/* Count of CTF errors.  */\n \n /* The CTF data model is inferred to be the caller's data model or the data\n    model of the given object, unless ctf_setmodel() is explicitly called.  */"
    },
    {
      "sha": "f251759afa1fb8d00a5826c604c9e4ae9c975277",
      "filename": "include/ctf.h",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ec388c16cd4217a64907e4e133d2102cc4fe608a/include/ctf.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ec388c16cd4217a64907e4e133d2102cc4fe608a/include/ctf.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ctf.h?ref=ec388c16cd4217a64907e4e133d2102cc4fe608a",
      "patch": "@@ -199,7 +199,8 @@ typedef struct ctf_header\n #define CTF_VERSION_3 4\n #define CTF_VERSION CTF_VERSION_3 /* Current version.  */\n \n-#define CTF_F_COMPRESS\t0x1\t/* Data buffer is compressed by libctf.  */\n+#define CTF_F_COMPRESS\t0x1\t\t/* Data buffer is compressed by libctf.  */\n+#define CTF_F_MAX\tCTF_F_COMPRESS\t/* The greatest flag value in use.  */\n \n typedef struct ctf_lblent\n {"
    },
    {
      "sha": "45caf217cb22244ad586c26f80b5d8909f777a90",
      "filename": "libctf/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ec388c16cd4217a64907e4e133d2102cc4fe608a/libctf/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ec388c16cd4217a64907e4e133d2102cc4fe608a/libctf/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/libctf/ChangeLog?ref=ec388c16cd4217a64907e4e133d2102cc4fe608a",
      "patch": "@@ -1,3 +1,7 @@\n+2020-07-22  Nick Alcock  <nick.alcock@oracle.com>\n+\n+\t* ctf-open.c (ctf_bufopen_internal): Diagnose invalid flags.\n+\n 2020-07-22  Nick Alcock  <nick.alcock@oracle.com>\n \n \tctf-decls.h (ctf_qsort_compar_thunk): Fix arg passing."
    },
    {
      "sha": "f8eeaab0168bd4df0cc10d22b1b1c9ecbfabf5c5",
      "filename": "libctf/ctf-open.c",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ec388c16cd4217a64907e4e133d2102cc4fe608a/libctf/ctf-open.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ec388c16cd4217a64907e4e133d2102cc4fe608a/libctf/ctf-open.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/libctf/ctf-open.c?ref=ec388c16cd4217a64907e4e133d2102cc4fe608a",
      "patch": "@@ -1384,6 +1384,9 @@ ctf_bufopen_internal (const ctf_sect_t *ctfsect, const ctf_sect_t *symsect,\n   if (pp->ctp_version < CTF_VERSION_3)\n     hdrsz = sizeof (ctf_header_v2_t);\n \n+  if (_libctf_unlikely_ (pp->ctp_flags > CTF_F_MAX))\n+    return (ctf_set_open_errno (errp, ECTF_FLAGS));\n+\n   if (ctfsect->cts_size < hdrsz)\n     return (ctf_set_open_errno (errp, ECTF_NOCTFBUF));\n "
    }
  ]
}