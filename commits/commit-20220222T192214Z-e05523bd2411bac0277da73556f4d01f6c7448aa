{
  "sha": "e05523bd2411bac0277da73556f4d01f6c7448aa",
  "node_id": "C_kwDOANOeidoAKGUwNTUyM2JkMjQxMWJhYzAyNzdkYTczNTU2ZjRkMDFmNmM3NDQ4YWE",
  "commit": {
    "author": {
      "name": "John Baldwin",
      "email": "jhb@FreeBSD.org",
      "date": "2022-02-22T19:22:14Z"
    },
    "committer": {
      "name": "John Baldwin",
      "email": "jhb@FreeBSD.org",
      "date": "2022-02-22T19:22:14Z"
    },
    "message": "Enable async mode in the target in attach_cmd.\n\nIf the attach target supports async mode, enable it after the\nattach target's ::attach method returns.",
    "tree": {
      "sha": "6bb11c7419e5c176e0ceec0c246ee850f6365cfc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6bb11c7419e5c176e0ceec0c246ee850f6365cfc"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e05523bd2411bac0277da73556f4d01f6c7448aa",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e05523bd2411bac0277da73556f4d01f6c7448aa",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e05523bd2411bac0277da73556f4d01f6c7448aa",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e05523bd2411bac0277da73556f4d01f6c7448aa/comments",
  "author": {
    "login": "bsdjhb",
    "id": 8976613,
    "node_id": "MDQ6VXNlcjg5NzY2MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8976613?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bsdjhb",
    "html_url": "https://github.com/bsdjhb",
    "followers_url": "https://api.github.com/users/bsdjhb/followers",
    "following_url": "https://api.github.com/users/bsdjhb/following{/other_user}",
    "gists_url": "https://api.github.com/users/bsdjhb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bsdjhb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bsdjhb/subscriptions",
    "organizations_url": "https://api.github.com/users/bsdjhb/orgs",
    "repos_url": "https://api.github.com/users/bsdjhb/repos",
    "events_url": "https://api.github.com/users/bsdjhb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bsdjhb/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "bsdjhb",
    "id": 8976613,
    "node_id": "MDQ6VXNlcjg5NzY2MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8976613?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bsdjhb",
    "html_url": "https://github.com/bsdjhb",
    "followers_url": "https://api.github.com/users/bsdjhb/followers",
    "following_url": "https://api.github.com/users/bsdjhb/following{/other_user}",
    "gists_url": "https://api.github.com/users/bsdjhb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bsdjhb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bsdjhb/subscriptions",
    "organizations_url": "https://api.github.com/users/bsdjhb/orgs",
    "repos_url": "https://api.github.com/users/bsdjhb/repos",
    "events_url": "https://api.github.com/users/bsdjhb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bsdjhb/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d0bbe64c5a3f9608ae5987f1267de7a734ee8151",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d0bbe64c5a3f9608ae5987f1267de7a734ee8151",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d0bbe64c5a3f9608ae5987f1267de7a734ee8151"
    }
  ],
  "stats": {
    "total": 26,
    "additions": 4,
    "deletions": 22
  },
  "files": [
    {
      "sha": "6f1f208160e07783e320047cd0908e6a1244d3ef",
      "filename": "gdb/fbsd-nat.c",
      "status": "modified",
      "additions": 0,
      "deletions": 13,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/fbsd-nat.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/fbsd-nat.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/fbsd-nat.c?ref=e05523bd2411bac0277da73556f4d01f6c7448aa",
      "patch": "@@ -1025,19 +1025,6 @@ fbsd_nat_target::close ()\n   inf_ptrace_target::close ();\n }\n \n-/* Implement the \"attach\" target method.  */\n-\n-void\n-fbsd_nat_target::attach (const char *args, int from_tty)\n-{\n-  inf_ptrace_target::attach (args, from_tty);\n-\n-  /* Curiously, the core does not do this automatically.  */\n-  if (target_can_async_p ())\n-    target_async (1);\n-}\n-\n-\n #ifdef TDP_RFPPWAIT\n /*\n   To catch fork events, PT_FOLLOW_FORK is set on every traced process"
    },
    {
      "sha": "0acfef2f1f12fc936e3e0536b2d3977581d2f36b",
      "filename": "gdb/fbsd-nat.h",
      "status": "modified",
      "additions": 0,
      "deletions": 2,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/fbsd-nat.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/fbsd-nat.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/fbsd-nat.h?ref=e05523bd2411bac0277da73556f4d01f6c7448aa",
      "patch": "@@ -77,8 +77,6 @@ class fbsd_nat_target : public inf_ptrace_target\n   thread_control_capabilities get_thread_control_capabilities () override\n   { return tc_schedlock; }\n \n-  void attach (const char *, int) override;\n-\n   void create_inferior (const char *, const std::string &,\n \t\t\tchar **, int) override;\n "
    },
    {
      "sha": "682bebe1229f606828b1caa9e0f62d3af209ff64",
      "filename": "gdb/infcmd.c",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/infcmd.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/infcmd.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/infcmd.c?ref=e05523bd2411bac0277da73556f4d01f6c7448aa",
      "patch": "@@ -2600,6 +2600,10 @@ attach_command (const char *args, int from_tty)\n \t\t\t     thread_state_string (thread->state));\n     }\n \n+  /* Enable async mode if it is supported by the target.  */\n+  if (target_can_async_p ())\n+    target_async (1);\n+\n   /* Set up the \"saved terminal modes\" of the inferior\n      based on what modes we are starting it with.  */\n   target_terminal::init ();"
    },
    {
      "sha": "055da9a0cf2ffdf26b47460bef0549cd1459441c",
      "filename": "gdb/linux-nat.c",
      "status": "modified",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/linux-nat.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/linux-nat.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/linux-nat.c?ref=e05523bd2411bac0277da73556f4d01f6c7448aa",
      "patch": "@@ -1159,9 +1159,6 @@ linux_nat_target::attach (const char *args, int from_tty)\n      threads and associate pthread info with each LWP.  */\n   linux_proc_attach_tgid_threads (lp->ptid.pid (),\n \t\t\t\t  attach_proc_task_lwp_callback);\n-\n-  if (target_can_async_p ())\n-    target_async (1);\n }\n \n /* Ptrace-detach the thread with pid PID.  */"
    },
    {
      "sha": "aa6a67a96e0a5be78243729611566358a20e96f4",
      "filename": "gdb/remote.c",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/remote.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e05523bd2411bac0277da73556f4d01f6c7448aa/gdb/remote.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/remote.c?ref=e05523bd2411bac0277da73556f4d01f6c7448aa",
      "patch": "@@ -6183,16 +6183,12 @@ extended_remote_target::attach (const char *args, int from_tty)\n \t=  remote_notif_parse (this, &notif_client_stop, wait_status);\n \n       push_stop_reply ((struct stop_reply *) reply);\n-\n-      if (target_can_async_p ())\n-\ttarget_async (1);\n     }\n   else\n     {\n       gdb_assert (wait_status == NULL);\n \n       gdb_assert (target_can_async_p ());\n-      target_async (1);\n     }\n }\n "
    }
  ]
}