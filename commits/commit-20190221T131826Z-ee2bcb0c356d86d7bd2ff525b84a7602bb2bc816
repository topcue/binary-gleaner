{
  "sha": "ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZWUyYmNiMGMzNTZkODZkN2JkMmZmNTI1Yjg0YTc2MDJiYjJiYzgxNg==",
  "commit": {
    "author": {
      "name": "Alan Hayward",
      "email": "alan.hayward@arm.com",
      "date": "2019-02-21T13:17:32Z"
    },
    "committer": {
      "name": "Alan Hayward",
      "email": "alan.hayward@arm.com",
      "date": "2019-02-21T13:18:26Z"
    },
    "message": "Disable styling when running in batch mode\n\nThe GCC Guality testsuite within GCC compiles C/C++ files in GCC at\nvarious optimization levels then debugs them in GDB, checking that\nprogram values can be read.  This is done within the dejagnu framework.\n\nThe new style options in GDB have broken many of the tests due to the\ntestsuite being unable to process the new control characters.  The fix\nin Guality is to either to improve the string matching or to disable\nstyling on the cli or init file (after checking gdb is recent enough\nto support styling).\n\nThis fix will also need making an any other testsuites in the wild\nthat use GDB.\n\nAn alternative would be to automatically disable styling when using GDB\nin batch mode.  The reasoning here is that batch mode is only used when\nautomating GDB and any output will be processed later either with text\nprocessing tools or viewed in text editors, many of these will not\ncorrectly handle the control characters by default.  This ensures GDB\ncontinues to work as expected.  Anyone who explicitly wants styling in\nbatch mode can enable it either in the init file or adding to the batch\nfile - but that would not be the standard use case.\n\nPatch simply disables style after reading the batch command flag, before\nreading in the init file or batch file.\n\ngdb/ChangeLog:\n\n\t* main.c (captured_main_1): Disable styling in batch mode.",
    "tree": {
      "sha": "78a0a7bc69d4884cca4124a4b699c966a696092e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/78a0a7bc69d4884cca4124a4b699c966a696092e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816/comments",
  "author": {
    "login": "a74nh",
    "id": 4146708,
    "node_id": "MDQ6VXNlcjQxNDY3MDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4146708?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/a74nh",
    "html_url": "https://github.com/a74nh",
    "followers_url": "https://api.github.com/users/a74nh/followers",
    "following_url": "https://api.github.com/users/a74nh/following{/other_user}",
    "gists_url": "https://api.github.com/users/a74nh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/a74nh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/a74nh/subscriptions",
    "organizations_url": "https://api.github.com/users/a74nh/orgs",
    "repos_url": "https://api.github.com/users/a74nh/repos",
    "events_url": "https://api.github.com/users/a74nh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/a74nh/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "a74nh",
    "id": 4146708,
    "node_id": "MDQ6VXNlcjQxNDY3MDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4146708?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/a74nh",
    "html_url": "https://github.com/a74nh",
    "followers_url": "https://api.github.com/users/a74nh/followers",
    "following_url": "https://api.github.com/users/a74nh/following{/other_user}",
    "gists_url": "https://api.github.com/users/a74nh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/a74nh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/a74nh/subscriptions",
    "organizations_url": "https://api.github.com/users/a74nh/orgs",
    "repos_url": "https://api.github.com/users/a74nh/repos",
    "events_url": "https://api.github.com/users/a74nh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/a74nh/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5cacf1c88f8afa5a3a1fb6d88c297e19d99f21e0",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5cacf1c88f8afa5a3a1fb6d88c297e19d99f21e0",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5cacf1c88f8afa5a3a1fb6d88c297e19d99f21e0"
    }
  ],
  "stats": {
    "total": 12,
    "additions": 11,
    "deletions": 1
  },
  "files": [
    {
      "sha": "fd704daf7b9fd740ae53b5c7fc6719f9b8d0c475",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816",
      "patch": "@@ -1,3 +1,7 @@\n+2019-02-21  Alan Hayward  <alan.hayward@arm.com>\n+\n+\t* main.c (captured_main_1): Disable styling in batch mode.\n+\n 2019-02-20  Tom Tromey  <tom@tromey.com>\n \n \t* symtab.c (symtab_symbol_info): Fix typos."
    },
    {
      "sha": "e14dd06fa8caa4641ace6eaef48669fe9d3b6502",
      "filename": "gdb/main.c",
      "status": "modified",
      "additions": 7,
      "deletions": 1,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816/gdb/main.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816/gdb/main.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/main.c?ref=ee2bcb0c356d86d7bd2ff525b84a7602bb2bc816",
      "patch": "@@ -47,6 +47,7 @@\n #include \"common/signals-state-save-restore.h\"\n #include <vector>\n #include \"common/pathstuff.h\"\n+#include \"cli/cli-style.h\"\n \n /* The selected interpreter.  This will be used as a set command\n    variable, so it should always be malloc'ed - since\n@@ -850,7 +851,12 @@ captured_main_1 (struct captured_main_args *context)\n       }\n \n     if (batch_flag)\n-      quiet = 1;\n+      {\n+\tquiet = 1;\n+\n+\t/* Disable all output styling when running in batch mode.  */\n+\tcli_styling = 0;\n+      }\n   }\n \n   save_original_signals_state (quiet);"
    }
  ]
}