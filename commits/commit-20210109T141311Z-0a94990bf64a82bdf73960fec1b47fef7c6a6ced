{
  "sha": "0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MGE5NDk5MGJmNjRhODJiZGY3Mzk2MGZlYzFiNDdmZWY3YzZhNmNlZA==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2021-01-09T14:11:06Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2021-01-09T14:13:11Z"
    },
    "message": "ld/x86-64: Properly Handle -z lam-u48/lam-u57\n\nProperly merge GNU properties for LAM_U48 and LAM_U57.\n\nbfd/\n\n\tPR ld/27166\n\t* elfxx-x86.c (_bfd_x86_elf_merge_gnu_properties): Handle\n\t-z lam-u48 and -z lam-u57.\n\nld/\n\n\tPR ld/27166\n\t* testsuite/ld-x86-64/lam-u48.rd: New file.\n\t* testsuite/ld-x86-64/lam-u57.rd: Likewise.\n\t* testsuite/ld-x86-64/x86-64.exp: Add PR ld/27166 tests.",
    "tree": {
      "sha": "739ccefb6a395a463262da661010b90716fe9ccc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/739ccefb6a395a463262da661010b90716fe9ccc"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "f41464416a1744ca0151d61de1a7e405664dd9b7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f41464416a1744ca0151d61de1a7e405664dd9b7",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/f41464416a1744ca0151d61de1a7e405664dd9b7"
    }
  ],
  "stats": {
    "total": 57,
    "additions": 55,
    "deletions": 2
  },
  "files": [
    {
      "sha": "d33445f87f3245d7ac782e724f0e50a3a6304577",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
      "patch": "@@ -1,3 +1,9 @@\n+2021-01-09  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/27166\n+\t* elfxx-x86.c (_bfd_x86_elf_merge_gnu_properties): Handle\n+\t-z lam-u48 and -z lam-u57.\n+\n 2021-01-09  Nick Clifton  <nickc@redhat.com>\n \n \t* version.m4: Change to 2.36.50."
    },
    {
      "sha": "3a0dffc4e6ec4c38e8f52fd83d9e1d9b7341b80f",
      "filename": "bfd/elfxx-x86.c",
      "status": "modified",
      "additions": 14,
      "deletions": 2,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/bfd/elfxx-x86.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/bfd/elfxx-x86.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-x86.c?ref=0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
      "patch": "@@ -2449,8 +2449,15 @@ _bfd_x86_elf_merge_gnu_properties (struct bfd_link_info *info,\n \t\tfeatures = GNU_PROPERTY_X86_FEATURE_1_IBT;\n \t      if (htab->params->shstk)\n \t\tfeatures |= GNU_PROPERTY_X86_FEATURE_1_SHSTK;\n-\t      /* Add GNU_PROPERTY_X86_FEATURE_1_IBT and\n-\t\t GNU_PROPERTY_X86_FEATURE_1_SHSTK.  */\n+\t      if (htab->params->lam_u48)\n+\t\tfeatures |= (GNU_PROPERTY_X86_FEATURE_1_LAM_U48\n+\t\t\t     | GNU_PROPERTY_X86_FEATURE_1_LAM_U57);\n+\t      else if (htab->params->lam_u57)\n+\t\tfeatures |= GNU_PROPERTY_X86_FEATURE_1_LAM_U57;\n+\t      /* Add GNU_PROPERTY_X86_FEATURE_1_IBT,\n+\t\t GNU_PROPERTY_X86_FEATURE_1_SHSTK,\n+\t\t GNU_PROPERTY_X86_FEATURE_1_LAM_U48 and\n+\t\t GNU_PROPERTY_X86_FEATURE_1_LAM_U57.  */\n \t      aprop->u.number |= features;\n \t    }\n \t  updated = number != (unsigned int) aprop->u.number;\n@@ -2470,6 +2477,11 @@ _bfd_x86_elf_merge_gnu_properties (struct bfd_link_info *info,\n \t\tfeatures = GNU_PROPERTY_X86_FEATURE_1_IBT;\n \t      if (htab->params->shstk)\n \t\tfeatures |= GNU_PROPERTY_X86_FEATURE_1_SHSTK;\n+\t      if (htab->params->lam_u48)\n+\t\tfeatures |= (GNU_PROPERTY_X86_FEATURE_1_LAM_U48\n+\t\t\t     | GNU_PROPERTY_X86_FEATURE_1_LAM_U57);\n+\t      else if (htab->params->lam_u57)\n+\t\tfeatures |= GNU_PROPERTY_X86_FEATURE_1_LAM_U57;\n \t    }\n \t  if (features)\n \t    {"
    },
    {
      "sha": "0628a4527a9d05664a14733c25a4db6d869ba72c",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
      "patch": "@@ -1,3 +1,10 @@\n+2021-01-09  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/27166\n+\t* testsuite/ld-x86-64/lam-u48.rd: New file.\n+\t* testsuite/ld-x86-64/lam-u57.rd: Likewise.\n+\t* testsuite/ld-x86-64/x86-64.exp: Add PR ld/27166 tests.\n+\n 2021-01-09  Nick Clifton  <nickc@redhat.com>\n \n \t* configure: Regenerate."
    },
    {
      "sha": "ad3126270594db4950c381fa9003f64476859e4d",
      "filename": "ld/testsuite/ld-x86-64/lam-u48.rd",
      "status": "added",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/ld/testsuite/ld-x86-64/lam-u48.rd",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/ld/testsuite/ld-x86-64/lam-u48.rd",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/lam-u48.rd?ref=0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
      "patch": "@@ -0,0 +1,6 @@\n+Displaying notes found in: .note.gnu.property\n+[ \t]+Owner[ \t]+Data size[ \t]+Description\n+  GNU                  0x[0-9a-f]+\tNT_GNU_PROPERTY_TYPE_0\n+#...\n+      Properties: x86 feature: .*LAM_U48, LAM_U57.*\n+#pass"
    },
    {
      "sha": "8b77e6311c0b9c309133afd2f5bf331810457f1e",
      "filename": "ld/testsuite/ld-x86-64/lam-u57.rd",
      "status": "added",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/ld/testsuite/ld-x86-64/lam-u57.rd",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/ld/testsuite/ld-x86-64/lam-u57.rd",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/lam-u57.rd?ref=0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
      "patch": "@@ -0,0 +1,6 @@\n+Displaying notes found in: .note.gnu.property\n+[ \t]+Owner[ \t]+Data size[ \t]+Description\n+  GNU                  0x[0-9a-f]+\tNT_GNU_PROPERTY_TYPE_0\n+#...\n+      Properties: x86 feature: .*LAM_U57.*\n+#pass"
    },
    {
      "sha": "83fdaa7db6599ce67534ebb3891b9d814ddf346e",
      "filename": "ld/testsuite/ld-x86-64/x86-64.exp",
      "status": "modified",
      "additions": 16,
      "deletions": 0,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/ld/testsuite/ld-x86-64/x86-64.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a94990bf64a82bdf73960fec1b47fef7c6a6ced/ld/testsuite/ld-x86-64/x86-64.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/x86-64.exp?ref=0a94990bf64a82bdf73960fec1b47fef7c6a6ced",
      "patch": "@@ -1452,6 +1452,22 @@ if { [isnative] && [check_compiler_available] } {\n \t\t{{error_output \"pr21997-1b.err\"}} \\\n \t\t\"pr21997-1b\" \\\n \t    ] \\\n+\t    [list \\\n+\t\t\"Build lam-u48.so\" \\\n+\t\t\"-shared -Wl,-z,lam-u48\" \\\n+\t\t\"\" \\\n+\t\t{dummy.s} \\\n+\t\t{{readelf -n lam-u48.rd}}  \\\n+\t\t\"lam-u48.so\" \\\n+\t    ] \\\n+\t    [list \\\n+\t\t\"Build lam-u57.so\" \\\n+\t\t\"-shared -Wl,-z,lam-u57\" \\\n+\t\t\"\" \\\n+\t\t{dummy.s} \\\n+\t\t{{readelf -n lam-u57.rd}}  \\\n+\t\t\"lam-u57.so\" \\\n+\t    ] \\\n \t]\n     }\n "
    }
  ]
}