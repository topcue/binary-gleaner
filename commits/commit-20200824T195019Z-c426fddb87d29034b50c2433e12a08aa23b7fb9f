{
  "sha": "c426fddb87d29034b50c2433e12a08aa23b7fb9f",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YzQyNmZkZGI4N2QyOTAzNGI1MGMyNDMzZTEyYTA4YWEyM2I3ZmI5Zg==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@efficios.com",
      "date": "2020-08-24T19:50:19Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2020-08-24T19:50:19Z"
    },
    "message": "gdb: add debug_prefixed_vprintf\n\nTo help ensure that all debug statements have the same format, introduce\nthe debug_prefixed_vprintf helper.  Implement linux_nat_debug_printf_1\nand infrun_debug_printf_1 with it.\n\nI would eventually like to style the module and function name with some\ncolor, to help them stick out, but I don't really know how to do that\nyet, it can always be done later.\n\ngdb/ChangeLog:\n\n\t* debug.h: New file.\n\t* debug.c (debug_prefixed_vprintf): New function.\n\t* infrun.c (infrun_debug_printf_1): Use debug_prefixed_vprintf.\n\t* linux-nat.c (linux_nat_debug_printf_1): Likewise.\n\nChange-Id: Iccc290a2dc6b5fffcbe1c2866ed8d804ad380764",
    "tree": {
      "sha": "ad01131718b794781fa9bf10ee550e7e9acd181a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/ad01131718b794781fa9bf10ee550e7e9acd181a"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/c426fddb87d29034b50c2433e12a08aa23b7fb9f",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c426fddb87d29034b50c2433e12a08aa23b7fb9f",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/c426fddb87d29034b50c2433e12a08aa23b7fb9f",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c426fddb87d29034b50c2433e12a08aa23b7fb9f/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "1eb8556f5a8b5712e765b9615f7c18ffb50253b6",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1eb8556f5a8b5712e765b9615f7c18ffb50253b6",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/1eb8556f5a8b5712e765b9615f7c18ffb50253b6"
    }
  ],
  "stats": {
    "total": 66,
    "additions": 56,
    "deletions": 10
  },
  "files": [
    {
      "sha": "ec69531e6b554408d1dec38aaf2b13409c8119c0",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=c426fddb87d29034b50c2433e12a08aa23b7fb9f",
      "patch": "@@ -1,3 +1,10 @@\n+2020-08-24  Simon Marchi  <simon.marchi@efficios.com>\n+\n+\t* debug.h: New file.\n+\t* debug.c (debug_prefixed_vprintf): New function.\n+\t* infrun.c (infrun_debug_printf_1): Use debug_prefixed_vprintf.\n+\t* linux-nat.c (linux_nat_debug_printf_1): Likewise.\n+\n 2020-08-24  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* infrun.h (infrun_debug_printf_1): New function declaration."
    },
    {
      "sha": "f845a7e3b1e708f99aea2e8665317c132de27dd1",
      "filename": "gdb/debug.c",
      "status": "modified",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/debug.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/debug.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/debug.c?ref=c426fddb87d29034b50c2433e12a08aa23b7fb9f",
      "patch": "@@ -19,10 +19,23 @@\n \n #include \"defs.h\"\n \n+#include \"debug.h\"\n+\n /* See gdbsupport/common-debug.h.  */\n \n void\n debug_vprintf (const char *fmt, va_list ap)\n {\n   vfprintf_unfiltered (gdb_stdlog, fmt, ap);\n }\n+\n+/* See debug.h.  */\n+\n+void\n+debug_prefixed_vprintf (const char *module, const char *func, const char *format,\n+\t\t\tva_list args)\n+{\n+  debug_printf (\"[%s] %s: \", module, func);\n+  debug_vprintf (format, args);\n+  debug_printf (\"\\n\");\n+}"
    },
    {
      "sha": "1d98fbebec6cf0c0ab75161b0fa51781baec258f",
      "filename": "gdb/debug.h",
      "status": "added",
      "additions": 32,
      "deletions": 0,
      "changes": 32,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/debug.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/debug.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/debug.h?ref=c426fddb87d29034b50c2433e12a08aa23b7fb9f",
      "patch": "@@ -0,0 +1,32 @@\n+/* Helpers to format and print debug statements\n+\n+   Copyright (C) 2020 Free Software Foundation, Inc.\n+\n+   This file is part of GDB.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n+\n+#ifndef DEBUG_H\n+#define DEBUG_H\n+\n+/* Print a debug statement prefixed with the module and function name, and\n+   with a newline at the end.  */\n+\n+void ATTRIBUTE_PRINTF (3, 0)\n+debug_prefixed_vprintf (const char *module, const char *func, const char *format,\n+\t\t\tva_list args);\n+\n+#endif /* DEBUG_H */\n+\n+"
    },
    {
      "sha": "938bc081a1c96ab0551046b6cccc777bd40dd78e",
      "filename": "gdb/infrun.c",
      "status": "modified",
      "additions": 2,
      "deletions": 5,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/infrun.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/infrun.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/infrun.c?ref=c426fddb87d29034b50c2433e12a08aa23b7fb9f",
      "patch": "@@ -70,6 +70,7 @@\n #include \"gdbsupport/selftest.h\"\n #include \"scoped-mock-context.h\"\n #include \"test-target.h\"\n+#include \"debug.h\"\n \n /* Prototypes for local functions */\n \n@@ -106,14 +107,10 @@ static int infrun_is_async = -1;\n void\n infrun_debug_printf_1 (const char *func_name, const char *fmt, ...)\n {\n-  debug_printf (\"[infrun] %s: \", func_name);\n-\n   va_list ap;\n   va_start (ap, fmt);\n-  debug_vprintf (fmt, ap);\n+  debug_prefixed_vprintf (\"infrun\", func_name, fmt, ap);\n   va_end (ap);\n-\n-  debug_printf (\"\\n\");\n }\n \n /* See infrun.h.  */"
    },
    {
      "sha": "b81014024c7a6eba0e805c7ea18c3f839e9bd98f",
      "filename": "gdb/linux-nat.c",
      "status": "modified",
      "additions": 2,
      "deletions": 5,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/linux-nat.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c426fddb87d29034b50c2433e12a08aa23b7fb9f/gdb/linux-nat.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/linux-nat.c?ref=c426fddb87d29034b50c2433e12a08aa23b7fb9f",
      "patch": "@@ -68,6 +68,7 @@\n #include \"gdbsupport/fileio.h\"\n #include \"gdbsupport/scope-exit.h\"\n #include \"gdbsupport/gdb-sigmask.h\"\n+#include \"debug.h\"\n \n /* This comment documents high-level logic of this file.\n \n@@ -203,14 +204,10 @@ show_debug_linux_nat (struct ui_file *file, int from_tty,\n static void ATTRIBUTE_PRINTF (2, 3)\n linux_nat_debug_printf_1 (const char *func_name, const char *fmt, ...)\n {\n-  debug_printf (\"[linux-nat] %s: \", func_name);\n-\n   va_list ap;\n   va_start (ap, fmt);\n-  debug_vprintf (fmt, ap);\n+  debug_prefixed_vprintf (\"linux-nat\", func_name, fmt, ap);\n   va_end (ap);\n-\n-  debug_printf (\"\\n\");\n }\n \n #define linux_nat_debug_printf(fmt, ...) \\"
    }
  ]
}