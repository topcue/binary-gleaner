{
  "sha": "ad118caa9f690114d11384b0813f30980cc333f3",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YWQxMThjYWE5ZjY5MDExNGQxMTM4NGIwODEzZjMwOTgwY2MzMzNmMw==",
  "commit": {
    "author": {
      "name": "Nick Alcock",
      "email": "nick.alcock@oracle.com",
      "date": "2019-06-04T14:04:49Z"
    },
    "committer": {
      "name": "Nick Alcock",
      "email": "nick.alcock@oracle.com",
      "date": "2019-06-04T16:05:08Z"
    },
    "message": "libctf: work on platforms without O_CLOEXEC.\n\n(Not tested on any such platforms, since I don't have access to any at\nthe moment.  Testing encouraged.)\n\nlibctf/\n\t* configure.ac: Check for O_CLOEXEC.\n\t* ctf-decls.h (O_CLOEXEC): Define (to 0), if need be.\n\t* config.h.in: Regenerate.",
    "tree": {
      "sha": "3261c7175a31eb17ae72c2a8f0d107c4d1ad9f59",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/3261c7175a31eb17ae72c2a8f0d107c4d1ad9f59"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ad118caa9f690114d11384b0813f30980cc333f3",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ad118caa9f690114d11384b0813f30980cc333f3",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ad118caa9f690114d11384b0813f30980cc333f3",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ad118caa9f690114d11384b0813f30980cc333f3/comments",
  "author": {
    "login": "nickalcock",
    "id": 6503005,
    "node_id": "MDQ6VXNlcjY1MDMwMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6503005?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickalcock",
    "html_url": "https://github.com/nickalcock",
    "followers_url": "https://api.github.com/users/nickalcock/followers",
    "following_url": "https://api.github.com/users/nickalcock/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickalcock/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickalcock/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickalcock/subscriptions",
    "organizations_url": "https://api.github.com/users/nickalcock/orgs",
    "repos_url": "https://api.github.com/users/nickalcock/repos",
    "events_url": "https://api.github.com/users/nickalcock/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickalcock/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickalcock",
    "id": 6503005,
    "node_id": "MDQ6VXNlcjY1MDMwMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6503005?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickalcock",
    "html_url": "https://github.com/nickalcock",
    "followers_url": "https://api.github.com/users/nickalcock/followers",
    "following_url": "https://api.github.com/users/nickalcock/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickalcock/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickalcock/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickalcock/subscriptions",
    "organizations_url": "https://api.github.com/users/nickalcock/orgs",
    "repos_url": "https://api.github.com/users/nickalcock/repos",
    "events_url": "https://api.github.com/users/nickalcock/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickalcock/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "6b22174ff163b828a2069f22353018ca97fc0fb4",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6b22174ff163b828a2069f22353018ca97fc0fb4",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/6b22174ff163b828a2069f22353018ca97fc0fb4"
    }
  ],
  "stats": {
    "total": 67,
    "additions": 67,
    "deletions": 0
  },
  "files": [
    {
      "sha": "52c2e1e8fcbd01de7e4aee7818b37b4a8b28c2bc",
      "filename": "libctf/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ad118caa9f690114d11384b0813f30980cc333f3/libctf/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ad118caa9f690114d11384b0813f30980cc333f3/libctf/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/libctf/ChangeLog?ref=ad118caa9f690114d11384b0813f30980cc333f3",
      "patch": "@@ -1,3 +1,10 @@\n+2019-06-04  Nick Alcock  <nick.alcock@oracle.com>\n+\n+\t* configure.ac: Check for O_CLOEXEC.\n+\t* ctf-decls.h (O_CLOEXEC): Define (to 0), if need be.\n+\t* config.h.in: Regenerate.\n+\t* configure: Likewise.\n+\n 2019-06-04  Nick Alcock  <nick.alcock@oracle.com>\n \n \t* qsort_r.c: Rename to..."
    },
    {
      "sha": "3f45cd6d745187e456eecdec88bd42cca6c70534",
      "filename": "libctf/config.h.in",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ad118caa9f690114d11384b0813f30980cc333f3/libctf/config.h.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ad118caa9f690114d11384b0813f30980cc333f3/libctf/config.h.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/libctf/config.h.in?ref=ad118caa9f690114d11384b0813f30980cc333f3",
      "patch": "@@ -24,6 +24,9 @@\n /* Define to 1 if you have a working `mmap' system call. */\n #undef HAVE_MMAP\n \n+/* Whether the platform has a definition of O_CLOEXEC. */\n+#undef HAVE_O_CLOEXEC\n+\n /* Define to 1 if you have the `pread' function. */\n #undef HAVE_PREAD\n "
    },
    {
      "sha": "31f166779eb453ad9af6c0653cb7561f70667324",
      "filename": "libctf/configure",
      "status": "modified",
      "additions": 37,
      "deletions": 0,
      "changes": 37,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ad118caa9f690114d11384b0813f30980cc333f3/libctf/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ad118caa9f690114d11384b0813f30980cc333f3/libctf/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/libctf/configure?ref=ad118caa9f690114d11384b0813f30980cc333f3",
      "patch": "@@ -6462,6 +6462,43 @@ else\n fi\n \n \n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for O_CLOEXEC\" >&5\n+$as_echo_n \"checking for O_CLOEXEC... \" >&6; }\n+if ${ac_cv_libctf_macro_O_CLOEXEC+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <fcntl.h>\n+                       #ifndef O_CLOEXEC\n+                         choke me;\n+                       #endif\n+\n+int\n+main ()\n+{\n+return O_CLOEXEC;\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_libctf_macro_O_CLOEXEC=yes\n+else\n+  ac_cv_libctf_macro_O_CLOEXEC=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_libctf_macro_O_CLOEXEC\" >&5\n+$as_echo \"$ac_cv_libctf_macro_O_CLOEXEC\" >&6; }\n+\n+if test $ac_cv_libctf_macro_O_CLOEXEC = yes; then\n+\n+$as_echo \"#define HAVE_O_CLOEXEC 1\" >>confdefs.h\n+\n+fi\n+\n ac_config_files=\"$ac_config_files Makefile\"\n \n ac_config_headers=\"$ac_config_headers config.h\""
    },
    {
      "sha": "2a1a80b7ecbb667f56dbc40293e73c788dc25d58",
      "filename": "libctf/configure.ac",
      "status": "modified",
      "additions": 16,
      "deletions": 0,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ad118caa9f690114d11384b0813f30980cc333f3/libctf/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ad118caa9f690114d11384b0813f30980cc333f3/libctf/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/libctf/configure.ac?ref=ad118caa9f690114d11384b0813f30980cc333f3",
      "patch": "@@ -133,6 +133,22 @@ esac\n \n AM_CONDITIONAL(NEED_CTF_QSORT_R, test \"${ac_cv_libctf_qsort_r_signature}\" = unknown)\n \n+AC_CACHE_CHECK([for O_CLOEXEC], [ac_cv_libctf_macro_O_CLOEXEC],\n+  [AC_LINK_IFELSE(\n+    [AC_LANG_PROGRAM([[#include <fcntl.h>\n+                       #ifndef O_CLOEXEC\n+                         choke me;\n+                       #endif\n+                     ]],\n+                     [[return O_CLOEXEC;]])],\n+    [ac_cv_libctf_macro_O_CLOEXEC=yes],\n+    [ac_cv_libctf_macro_O_CLOEXEC=no])])\n+\n+if test $ac_cv_libctf_macro_O_CLOEXEC = yes; then\n+  AC_DEFINE([HAVE_O_CLOEXEC], 1,\n+\t    [Whether the platform has a definition of O_CLOEXEC.])\n+fi\n+\n AC_CONFIG_FILES(Makefile)\n AC_CONFIG_HEADERS(config.h)\n AC_OUTPUT"
    },
    {
      "sha": "c840b793c9bdf8cb9983c42dd9f860f3c04a2e90",
      "filename": "libctf/ctf-decls.h",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ad118caa9f690114d11384b0813f30980cc333f3/libctf/ctf-decls.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ad118caa9f690114d11384b0813f30980cc333f3/libctf/ctf-decls.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/libctf/ctf-decls.h?ref=ad118caa9f690114d11384b0813f30980cc333f3",
      "patch": "@@ -62,6 +62,10 @@ void ctf_qsort_r (void *base, size_t nmemb, size_t size,\n \t      void *arg);\n #endif\n \n+#ifndef HAVE_O_CLOEXEC\n+# define O_CLOEXEC 0\n+#endif\n+\n #undef MAX\n #undef MIN\n #define MAX(a, b) ((a) > (b) ? (a) : (b))"
    }
  ]
}