{
  "sha": "c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YzY3OWVjOThhMTI5NmQ4ZGEzYjU5MjBhOTA1OGJhMTRiNDdjYTNhNA==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-06-24T11:00:19Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-06-24T11:00:31Z"
    },
    "message": "cris: Don't generate unnecessary dynamic tags\n\nDynamic tags, DT_JMPREL, PLTREL and PLTRELSZ, are needed only if there\nare relocation entries for PLT.  Don't generate them if there are no\nrelocation entries for PLT.\n\nbfd/\n\n\tPR ld/26083\n\t* elf32-cris.c (elf_cris_size_dynamic_sections): Call\n\t_bfd_elf_add_dynamic_tags.\n\nld/\n\n\tPR ld/26083\n\t* testsuite/ld-cris/libdso-15b.d: Updated.\n\t* testsuite/ld-cris/libdso-1c.d: Likewise.\n\t* testsuite/ld-cris/libdso-1d.d: Likewise.\n\t* testsuite/ld-cris/libdso-15c.d: New file.",
    "tree": {
      "sha": "1669a20b5d12c0e4cb2561dd58f25b06f5b71fbb",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/1669a20b5d12c0e4cb2561dd58f25b06f5b71fbb"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5376d47f66d0e4e07b3d42cb62ad07327cad4292",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5376d47f66d0e4e07b3d42cb62ad07327cad4292",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5376d47f66d0e4e07b3d42cb62ad07327cad4292"
    }
  ],
  "stats": {
    "total": 107,
    "additions": 49,
    "deletions": 58
  },
  "files": [
    {
      "sha": "f0d7414dc73bc85dec8455ca8877acd1ed15fa30",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
      "patch": "@@ -1,3 +1,9 @@\n+2020-06-24  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/26083\n+\t* elf32-cris.c (elf_cris_size_dynamic_sections): Call\n+\t_bfd_elf_add_dynamic_tags.\n+\n 2020-06-24  Alan Modra  <amodra@gmail.com>\n \n \t* vms-alpha.c (_bfd_vms_slurp_etir <ETIR__C_OPR_ASH>): Implement"
    },
    {
      "sha": "4360b5418c0ff273fc9cfc3b2827622eae0639b0",
      "filename": "bfd/elf32-cris.c",
      "status": "modified",
      "additions": 2,
      "deletions": 47,
      "changes": 49,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/bfd/elf32-cris.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/bfd/elf32-cris.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf32-cris.c?ref=c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
      "patch": "@@ -3513,7 +3513,6 @@ elf_cris_size_dynamic_sections (bfd *output_bfd ATTRIBUTE_UNUSED,\n   struct elf_cris_link_hash_table * htab;\n   bfd *dynobj;\n   asection *s;\n-  bfd_boolean plt;\n   bfd_boolean relocs;\n \n   htab = elf_cris_hash_table (info);\n@@ -3569,7 +3568,6 @@ elf_cris_size_dynamic_sections (bfd *output_bfd ATTRIBUTE_UNUSED,\n   /* The check_relocs and adjust_dynamic_symbol entry points have\n      determined the sizes of the various dynamic sections.  Allocate\n      memory for them.  */\n-  plt = FALSE;\n   relocs = FALSE;\n   for (s = dynobj->sections; s != NULL; s = s->next)\n     {\n@@ -3584,8 +3582,7 @@ elf_cris_size_dynamic_sections (bfd *output_bfd ATTRIBUTE_UNUSED,\n \n       if (strcmp (name, \".plt\") == 0)\n \t{\n-\t  /* Remember whether there is a PLT.  */\n-\t  plt = s->size != 0;\n+\t  ;\n \t}\n       else if (strcmp (name, \".got.plt\") == 0)\n \t{\n@@ -3650,49 +3647,7 @@ elf_cris_size_dynamic_sections (bfd *output_bfd ATTRIBUTE_UNUSED,\n \treturn FALSE;\n     }\n \n-  if (elf_hash_table (info)->dynamic_sections_created)\n-    {\n-      /* Add some entries to the .dynamic section.  We fill in the\n-\t values later, in elf_cris_finish_dynamic_sections, but we\n-\t must add the entries now so that we get the correct size for\n-\t the .dynamic section.  The DT_DEBUG entry is filled in by the\n-\t dynamic linker and used by the debugger.  */\n-#define add_dynamic_entry(TAG, VAL) \\\n-  _bfd_elf_add_dynamic_entry (info, TAG, VAL)\n-\n-      if (!bfd_link_pic (info))\n-\t{\n-\t  if (!add_dynamic_entry (DT_DEBUG, 0))\n-\t    return FALSE;\n-\t}\n-\n-      if (plt)\n-\t{\n-\t  if (!add_dynamic_entry (DT_PLTGOT, 0)\n-\t      || !add_dynamic_entry (DT_PLTRELSZ, 0)\n-\t      || !add_dynamic_entry (DT_PLTREL, DT_RELA)\n-\t      || !add_dynamic_entry (DT_JMPREL, 0))\n-\t    return FALSE;\n-\t}\n-\n-      if (relocs)\n-\t{\n-\t  if (!add_dynamic_entry (DT_RELA, 0)\n-\t      || !add_dynamic_entry (DT_RELASZ, 0)\n-\t      || !add_dynamic_entry (DT_RELAENT, sizeof (Elf32_External_Rela)))\n-\t    return FALSE;\n-\t}\n-\n-      if ((info->flags & DF_TEXTREL) != 0)\n-\t{\n-\t  if (!add_dynamic_entry (DT_TEXTREL, 0))\n-\t    return FALSE;\n-\t  info->flags |= DF_TEXTREL;\n-\t}\n-    }\n-#undef add_dynamic_entry\n-\n-  return TRUE;\n+  return _bfd_elf_add_dynamic_tags (output_bfd, info, relocs);\n }\n \n /* This function is called via elf_cris_link_hash_traverse if we are"
    },
    {
      "sha": "47500a11b86c29698b9828c9fc14d3ffb9557bf4",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
      "patch": "@@ -1,3 +1,11 @@\n+2020-06-24  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/26083\n+\t* testsuite/ld-cris/libdso-15b.d: Updated.\n+\t* testsuite/ld-cris/libdso-1c.d: Likewise.\n+\t* testsuite/ld-cris/libdso-1d.d: Likewise.\n+\t* testsuite/ld-cris/libdso-15c.d: New file.\n+\n 2020-06-24  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR ld/26163"
    },
    {
      "sha": "39e001a9273edd071425e87646ca5ac04afe619b",
      "filename": "ld/testsuite/ld-cris/libdso-15b.d",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/testsuite/ld-cris/libdso-15b.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/testsuite/ld-cris/libdso-15b.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-cris/libdso-15b.d?ref=c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
      "patch": "@@ -22,7 +22,7 @@ DYNAMIC SYMBOL TABLE:\n 0+[\t ]+DF \\*UND\\*[\t ]+0+  TST3[\t ]+expfn2\n #...\n Contents of section .rela.dyn:\n- 017c a4220000 0a040000 00000000 a8220000  .*\n+ 017c 8c220000 0a040000 00000000 90220000  .*\n  018c 0a050000 00000000                    .*\n Contents of section .plt:\n  0194 fce17e7e 0401307a 08013009 00000000  .*\n@@ -34,5 +34,5 @@ Contents of section .text:\n  01e0 00006fae d4ffffff                    .*\n #...\n Contents of section .got:\n- 2298 e8210000 00000000 00000000 00000000  .*\n- 22a8 00000000                             .*\n+ 2280 e8210000 00000000 00000000 00000000  .*\n+ 2290 00000000                             .*"
    },
    {
      "sha": "b0359905c24c8ae59d4ed8661437d81504af91bf",
      "filename": "ld/testsuite/ld-cris/libdso-15c.d",
      "status": "added",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/testsuite/ld-cris/libdso-15c.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/testsuite/ld-cris/libdso-15c.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-cris/libdso-15c.d?ref=c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
      "patch": "@@ -0,0 +1,22 @@\n+#source: expdref2.s\n+#as: --pic --no-underscore --em=criself\n+#ld: --shared -m crislinux --hash-style=sysv\n+#ld_after_inputfiles: tmpdir/libdso-15.so\n+#readelf: -d\n+\n+Dynamic section at offset 0x1e8 contains 14 entries:\n+  Tag        Type                         Name/Value\n+ 0x00000001 \\(NEEDED\\)                     Shared library: \\[tmpdir/libdso-15.so\\]\n+ 0x00000004 \\(HASH\\)                       0x94\n+ 0x00000005 \\(STRTAB\\)                     0x120\n+ 0x00000006 \\(SYMTAB\\)                     0xc0\n+ 0x0000000a \\(STRSZ\\)                      45 \\(bytes\\)\n+ 0x0000000b \\(SYMENT\\)                     16 \\(bytes\\)\n+ 0x00000003 \\(PLTGOT\\)                     0x2280\n+ 0x00000007 \\(RELA\\)                       0x17c\n+ 0x00000008 \\(RELASZ\\)                     24 \\(bytes\\)\n+ 0x00000009 \\(RELAENT\\)                    12 \\(bytes\\)\n+ 0x6ffffffe \\(VERNEED\\)                    0x15c\n+ 0x6fffffff \\(VERNEEDNUM\\)                 1\n+ 0x6ffffff0 \\(VERSYM\\)                     0x14e\n+ 0x00000000 \\(NULL\\)                       0x0"
    },
    {
      "sha": "2b9b13b660b6f04de836b43f0a0460715807c1e7",
      "filename": "ld/testsuite/ld-cris/libdso-1c.d",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/testsuite/ld-cris/libdso-1c.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/testsuite/ld-cris/libdso-1c.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-cris/libdso-1c.d?ref=c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
      "patch": "@@ -19,7 +19,7 @@ DYNAMIC SYMBOL TABLE:\n 0+[ \t]+DF \\*UND\\*\t0+[ \t]+TST2[\t ]+expfn\n #...\n Contents of section .rela.dyn:\n- 0140 68220000 0a020000 00000000 6c220000  .*\n+ 0140 50220000 0a020000 00000000 54220000  .*\n  0150 0a030000 00000000                    .*\n Contents of section .plt:\n  0158 fce17e7e 0401307a 08013009 00000000  .*\n@@ -31,5 +31,5 @@ Contents of section .text:\n  01a4 00006fae d4ffffff                    .*\n #...\n Contents of section .got:\n- 225c ac210000 00000000 00000000 00000000  .*\n- 226c 00000000                             .*\n+ 2244 ac210000 00000000 00000000 00000000  .*\n+ 2254 00000000                             .*"
    },
    {
      "sha": "83a43372edb28a3fe78d70962593cb189901da7b",
      "filename": "ld/testsuite/ld-cris/libdso-1d.d",
      "status": "modified",
      "additions": 5,
      "deletions": 5,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/testsuite/ld-cris/libdso-1d.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c679ec98a1296d8da3b5920a9058ba14b47ca3a4/ld/testsuite/ld-cris/libdso-1d.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-cris/libdso-1d.d?ref=c679ec98a1296d8da3b5920a9058ba14b47ca3a4",
      "patch": "@@ -14,10 +14,10 @@\n DYNAMIC SYMBOL TABLE:\n #...\n 0+1a6  w   DF .text\t0+2 expfn\n-0+2254  w   DO .data\t0+4 expobj\n+0+223c  w   DO .data\t0+4 expobj\n #...\n Contents of section .rela.dyn:\n- 0138 4c220000 0a020000 00000000 50220000  .*\n+ 0138 34220000 0a020000 00000000 38220000  .*\n  0148 0a030000 00000000                    .*\n Contents of section .plt:\n  0150 fce17e7e 0401307a 08013009 00000000  .*\n@@ -30,7 +30,7 @@ Contents of section .text:\n Contents of section .dynamic:\n #...\n Contents of section .got:\n- 2240 a8210000 00000000 00000000 00000000  .*\n- 2250 00000000                             .*\n+ 2228 a8210000 00000000 00000000 00000000  .*\n+ 2238 00000000                             .*\n Contents of section .data:\n- 2254 00000000                             .*\n+ 223c 00000000                             .*"
    }
  ]
}