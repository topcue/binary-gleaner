{
  "sha": "ce139cd560dcb85b09d4d257ac67ebffdf215859",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6Y2UxMzljZDU2MGRjYjg1YjA5ZDRkMjU3YWM2N2ViZmZkZjIxNTg1OQ==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-09-11T12:30:38Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-09-11T12:30:56Z"
    },
    "message": "Fix the debuglink following code to recursively load links found in the newly loaded debug info.\n\n\tPR 26595\n\t* dwarf.c (load_separate_debug_info): Return NULL rather than\n\tFALSE in error situations.\n\t(load_separate_debug_file): Move code to load debug links to ...\n\t(check_for_and_load_links): ... here.  New function.  Load\n\tseparate debug information pointed to by debuglink and\n\tdebugaltlink sections.  Recursively scan newly loaded debug\n\tinformation for more links and load them too.",
    "tree": {
      "sha": "cdb96ee32f9db63b845bc3fcd5ef5daba6c46b23",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/cdb96ee32f9db63b845bc3fcd5ef5daba6c46b23"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ce139cd560dcb85b09d4d257ac67ebffdf215859",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ce139cd560dcb85b09d4d257ac67ebffdf215859",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ce139cd560dcb85b09d4d257ac67ebffdf215859",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ce139cd560dcb85b09d4d257ac67ebffdf215859/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "7a4e8e7d551eaddc63c67d85c02c7573f5a56ae8",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7a4e8e7d551eaddc63c67d85c02c7573f5a56ae8",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/7a4e8e7d551eaddc63c67d85c02c7573f5a56ae8"
    }
  ],
  "stats": {
    "total": 87,
    "additions": 60,
    "deletions": 27
  },
  "files": [
    {
      "sha": "a925dbbbcd58bce9964286e894d675f577a022b2",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ce139cd560dcb85b09d4d257ac67ebffdf215859/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ce139cd560dcb85b09d4d257ac67ebffdf215859/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=ce139cd560dcb85b09d4d257ac67ebffdf215859",
      "patch": "@@ -1,3 +1,14 @@\n+2020-09-11  Nick Clifton  <nickc@redhat.com>\n+\n+\tPR 26595\n+\t* dwarf.c (load_separate_debug_info): Return NULL rather than\n+\tFALSE in error situations.\n+\t(load_separate_debug_file): Move code to load debug links to ...\n+\t(check_for_and_load_links): ... here.  New function.  Load\n+\tseparate debug information pointed to by debuglink and\n+\tdebugaltlink sections.  Recursively scan newly loaded debug\n+\tinformation for more links and load them too.\n+\n 2020-09-09  Alan Modra  <amodra@gmail.com>\n \n \tPR 26578"
    },
    {
      "sha": "603169226d4d53880c7226740f5d45d53a1213b7",
      "filename": "binutils/dwarf.c",
      "status": "modified",
      "additions": 49,
      "deletions": 27,
      "changes": 76,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ce139cd560dcb85b09d4d257ac67ebffdf215859/binutils/dwarf.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ce139cd560dcb85b09d4d257ac67ebffdf215859/binutils/dwarf.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/dwarf.c?ref=ce139cd560dcb85b09d4d257ac67ebffdf215859",
      "patch": "@@ -10459,7 +10459,7 @@ load_separate_debug_info (const char *            main_filename,\n     {\n       warn (_(\"Corrupt debuglink section: %s\\n\"),\n \t    xlink->name ? xlink->name : xlink->uncompressed_name);\n-      return FALSE;\n+      return NULL;\n     }\n     \n   /* Attempt to locate the separate file.\n@@ -10619,7 +10619,7 @@ load_separate_debug_info (const char *            main_filename,\n     {\n       warn (_(\"failed to open separate debug file: %s\\n\"), debug_filename);\n       free (debug_filename);\n-      return FALSE;\n+      return NULL;\n     }\n \n   /* FIXME: We do not check to see if there are any other separate debug info\n@@ -10664,6 +10664,52 @@ load_dwo_file (const char * main_filename, const char * name, const char * dir,\n   return separate_handle;\n }\n \n+/* Load a debuglink section and/or a debugaltlink section, if either are present.\n+   Recursively check the loaded files for more of these sections.\n+   FIXME: Should also check for DWO_* entries in the newlu loaded files.  */\n+\n+static void\n+check_for_and_load_links (void * file, const char * filename)\n+{\n+  void * handle = NULL;\n+\n+  if (load_debug_section (gnu_debugaltlink, file))\n+    {\n+      Build_id_data build_id_data;\n+\n+      handle = load_separate_debug_info (filename,\n+\t\t\t\t\t & debug_displays[gnu_debugaltlink].section,\n+\t\t\t\t\t parse_gnu_debugaltlink,\n+\t\t\t\t\t check_gnu_debugaltlink,\n+\t\t\t\t\t & build_id_data,\n+\t\t\t\t\t file);\n+      if (handle)\n+\t{\n+\t  assert (handle == first_separate_info->handle);\n+\t  check_for_and_load_links (first_separate_info->handle,\n+\t\t\t\t    first_separate_info->filename);\n+\t}\n+    }\n+\n+  if (load_debug_section (gnu_debuglink, file))\n+    {\n+      unsigned long crc32;\n+\n+      handle = load_separate_debug_info (filename,\n+\t\t\t\t\t & debug_displays[gnu_debuglink].section,\n+\t\t\t\t\t parse_gnu_debuglink,\n+\t\t\t\t\t check_gnu_debuglink,\n+\t\t\t\t\t & crc32,\n+\t\t\t\t\t file);\n+      if (handle)\n+\t{\n+\t  assert (handle == first_separate_info->handle);\n+\t  check_for_and_load_links (first_separate_info->handle,\n+\t\t\t\t    first_separate_info->filename);\n+\t}\n+    }\n+}\n+\n /* Load the separate debug info file(s) attached to FILE, if any exist.\n    Returns TRUE if any were found, FALSE otherwise.\n    If TRUE is returned then the linked list starting at first_separate_info\n@@ -10739,34 +10785,10 @@ load_separate_debug_files (void * file, const char * filename)\n     return FALSE;\n \n   /* FIXME: We do not check for the presence of both link sections in the same file.  */\n-  /* FIXME: We do not check the separate debug info file to see if it too contains debuglinks.  */\n   /* FIXME: We do not check for the presence of multiple, same-name debuglink sections.  */\n   /* FIXME: We do not check for the presence of a dwo link as well as a debuglink.  */\n \n-  if (load_debug_section (gnu_debugaltlink, file))\n-    {\n-      Build_id_data build_id_data;\n-\n-      load_separate_debug_info (filename,\n-\t\t\t\t& debug_displays[gnu_debugaltlink].section,\n-\t\t\t\tparse_gnu_debugaltlink,\n-\t\t\t\tcheck_gnu_debugaltlink,\n-\t\t\t\t& build_id_data,\n-\t\t\t\tfile);\n-    }\n-\n-  if (load_debug_section (gnu_debuglink, file))\n-    {\n-      unsigned long crc32;\n-\n-      load_separate_debug_info (filename,\n-\t\t\t\t& debug_displays[gnu_debuglink].section,\n-\t\t\t\tparse_gnu_debuglink,\n-\t\t\t\tcheck_gnu_debuglink,\n-\t\t\t\t& crc32,\n-\t\t\t\tfile);\n-    }\n-\n+  check_for_and_load_links (file, filename);\n   if (first_separate_info != NULL)\n     return TRUE;\n "
    }
  ]
}