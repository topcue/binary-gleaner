{
  "sha": "fa94b3a7c817a5e6615b24eeb3ac569b70af7e81",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZmE5NGIzYTdjODE3YTVlNjYxNWIyNGVlYjNhYzU2OWI3MGFmN2U4MQ==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2021-05-05T02:19:05Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2021-05-05T02:19:05Z"
    },
    "message": "gdb: update Type.fields doc based on actual GDB behavior\n\nI noticed two errors in the Type.fields documentation:\n\n1. It is possible to call `fields` on an array type, in which case it\n   returns one field representing the array's range.  It is not\n   mentioned.\n\n2. When calling `fields` on a type that doesn't have fields (by nature,\n   like an int), GDB raises a TypeError.  It does not return an empty\n   sequence, as currently documented.\n\nFix these, and change the text into a bullet list.  I find it easier to\nread than one big paragraph.\n\nThe first issue is already tested in gdb.python/py-type.exp, but the\nsecond one doesn't seem tested.  Add a test in gdb.python/py-type.exp\nfor it.\n\ngdb/doc/ChangeLog:\n\n\t* python.texi (Types In Python): Re-organize Type.fields doc.\n\tMention handling of array types.  Correct doc for when calling\n\tthe method on another type.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.python/py-type.exp (test_fields): Test calling fields on\n\tan int type.\n\nChange-Id: I11c688177504cb070b81a4446ac91dec50b56a22",
    "tree": {
      "sha": "a46071ff1dde3524530cc0074d5e8f9e2154c6b2",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/a46071ff1dde3524530cc0074d5e8f9e2154c6b2"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "bf06b2a2f9fdf4b267c22328ba0dc35c07919f5c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/bf06b2a2f9fdf4b267c22328ba0dc35c07919f5c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/bf06b2a2f9fdf4b267c22328ba0dc35c07919f5c"
    }
  ],
  "stats": {
    "total": 46,
    "additions": 40,
    "deletions": 6
  },
  "files": [
    {
      "sha": "ec961d232d1c890b2047d4bae16c1d57ce936c5d",
      "filename": "gdb/doc/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/gdb/doc/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/gdb/doc/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/doc/ChangeLog?ref=fa94b3a7c817a5e6615b24eeb3ac569b70af7e81",
      "patch": "@@ -1,3 +1,9 @@\n+2021-05-04  Simon Marchi  <simon.marchi@polymtl.ca>\n+\n+\t* python.texi (Types In Python): Re-organize Type.fields doc.\n+\tMention handling of array types.  Correct doc for when calling\n+\tthe method on another type.\n+\n 2021-04-28  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* gdb.texinfo (Initialization Files): Use @env when referencing"
    },
    {
      "sha": "482d328de44a93b91afa3bb8aa9ffde3a85d3aca",
      "filename": "gdb/doc/python.texi",
      "status": "modified",
      "additions": 26,
      "deletions": 6,
      "changes": 32,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/gdb/doc/python.texi",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/gdb/doc/python.texi",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/doc/python.texi?ref=fa94b3a7c817a5e6615b24eeb3ac569b70af7e81",
      "patch": "@@ -1163,12 +1163,32 @@ there is no associated objfile.\n The following methods are provided:\n \n @defun Type.fields ()\n-For structure and union types, this method returns the fields.  Range\n-types have two fields, the minimum and maximum values.  Enum types\n-have one field per enum constant.  Function and method types have one\n-field per parameter.  The base types of C@t{++} classes are also\n-represented as fields.  If the type has no fields, or does not fit\n-into one of these categories, an empty sequence will be returned.\n+\n+Return the fields of this type.  The behavior depends on the type code:\n+\n+@itemize @bullet\n+\n+@item\n+For structure and union types, this method returns the fields.\n+\n+@item\n+Range types have two fields, the minimum and maximum values.\n+\n+@item\n+Enum types have one field per enum constant.\n+\n+@item\n+Function and method types have one field per parameter.  The base types of\n+C@t{++} classes are also represented as fields.\n+\n+@item\n+Array types have one field representing the array's range.\n+\n+@item\n+If the type does not fit into one of these categories, a @code{TypeError}\n+is raised.\n+\n+@end itemize\n \n Each field is a @code{gdb.Field} object, with some pre-defined attributes:\n @table @code"
    },
    {
      "sha": "326ba47961f8d65acda18b14fbbe85d59a395ce9",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=fa94b3a7c817a5e6615b24eeb3ac569b70af7e81",
      "patch": "@@ -1,3 +1,8 @@\n+2021-05-04  Simon Marchi  <simon.marchi@polymtl.ca>\n+\n+\t* gdb.python/py-type.exp (test_fields): Test calling fields on\n+\tan int type.\n+\n 2021-05-04  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* gdb.python/flexible-array-member.exp: Adjust expected range"
    },
    {
      "sha": "733b25d3210688c2a718b00c8eaa1cd4a8754fbe",
      "filename": "gdb/testsuite/gdb.python/py-type.exp",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/gdb/testsuite/gdb.python/py-type.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fa94b3a7c817a5e6615b24eeb3ac569b70af7e81/gdb/testsuite/gdb.python/py-type.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.python/py-type.exp?ref=fa94b3a7c817a5e6615b24eeb3ac569b70af7e81",
      "patch": "@@ -175,6 +175,9 @@ proc test_fields {lang} {\n     gdb_test \"python print (len (gdb.parse_and_eval ('a_function').type.fields ()))\" \"2\"\n     gdb_test \"python print (gdb.parse_and_eval ('a_function').type.fields ()\\[0\\].type)\" \"int\"\n     gdb_test \"python print (gdb.parse_and_eval ('a_function').type.fields ()\\[1\\].type)\" \"char\"\n+\n+    # Test calling `fields` on a non-aggregate type.\n+    gdb_test \"python gdb.lookup_type('int').fields()\" \"TypeError: Type is not a structure, union, enum, or function type.*\"\n   }\n }\n "
    }
  ]
}