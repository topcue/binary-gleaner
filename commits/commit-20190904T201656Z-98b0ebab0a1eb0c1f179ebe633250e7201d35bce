{
  "sha": "98b0ebab0a1eb0c1f179ebe633250e7201d35bce",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OThiMGViYWIwYTFlYjBjMWYxNzllYmU2MzMyNTBlNzIwMWQzNWJjZQ==",
  "commit": {
    "author": {
      "name": "Philippe Waroquiers",
      "email": "philippe.waroquiers@skynet.be",
      "date": "2019-08-31T15:25:54Z"
    },
    "committer": {
      "name": "Philippe Waroquiers",
      "email": "philippe.waroquiers@skynet.be",
      "date": "2019-09-04T20:16:56Z"
    },
    "message": "Avoid expect's buffer overflow in info-var.exp test.\n\nOnce the executable is started, info variables can show thousands\nof variables belonging to glibc (see below).\n\nThis long list of variables then causes the test to fail, due\nto expect's buffer overflow:\n  Running /bd/home/philippe/gdb/git/build_binutils-gdb/gdb/testsuite/../../../binutils-gdb/gdb/testsuite/gdb.base/info-var.exp ...\n  ERROR: internal buffer is full.\n  ERROR: internal buffer is full.\n  ERROR: internal buffer is full.\n\nFix this by testing 'info variables' without running the executable.\n\ngdb ./info-var\n...\nReading symbols from ./info-var...\n(gdb) |info variables|wc\n     27      54     971\n(gdb) start\nTemporary breakpoint 1 at 0x1129: file /bd/home/philippe/gdb/git/build_binutils-gdb/gdb/testsuite/../../../binutils-gdb/gdb/testsuite/gdb.base/info-var-f1.c, line 23.\nStarting program: /bd/home/philippe/gdb/git/build_binutils-gdb/gdb/testsuite/outputs/gdb.base/info-var/info-var\n\nTemporary breakpoint 1, main ()\n    at /bd/home/philippe/gdb/git/build_binutils-gdb/gdb/testsuite/../../../binutils-gdb/gdb/testsuite/gdb.base/info-var-f1.c:23\n23\t  return global_var + get_offset() + f1_var;\n(gdb) |info variables|wc\n   4334   14581  130738\n(gdb)\n\ngdb/testsuite/ChangeLog\n2019-09-04  Philippe Waroquiers  <philippe.waroquiers@skynet.be>\n\n\t* gdb.base/info-var.exp: Test info variables without running\n\tto main, to avoid expect's buffer overflow.",
    "tree": {
      "sha": "634d07e6e3b2dd0a944d2a371a2227c5edba47bc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/634d07e6e3b2dd0a944d2a371a2227c5edba47bc"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/98b0ebab0a1eb0c1f179ebe633250e7201d35bce",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/98b0ebab0a1eb0c1f179ebe633250e7201d35bce",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/98b0ebab0a1eb0c1f179ebe633250e7201d35bce",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/98b0ebab0a1eb0c1f179ebe633250e7201d35bce/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "ee6d95574b4ebf6a9e791eb6eda495ad78a92dc9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ee6d95574b4ebf6a9e791eb6eda495ad78a92dc9",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/ee6d95574b4ebf6a9e791eb6eda495ad78a92dc9"
    }
  ],
  "stats": {
    "total": 12,
    "additions": 8,
    "deletions": 4
  },
  "files": [
    {
      "sha": "46c7b5f92761e9d2eab1961f503bf06ba2a77ad4",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/98b0ebab0a1eb0c1f179ebe633250e7201d35bce/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/98b0ebab0a1eb0c1f179ebe633250e7201d35bce/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=98b0ebab0a1eb0c1f179ebe633250e7201d35bce",
      "patch": "@@ -1,3 +1,8 @@\n+2019-09-04  Philippe Waroquiers  <philippe.waroquiers@skynet.be>\n+\n+\t* gdb.base/info-var.exp: Test info variables without running\n+\tto main, to avoid expect's buffer overflow.\n+\n 2019-09-03  Tom Tromey  <tromey@adacore.com>\n \n \t* gdb.ada/bias.exp: New file."
    },
    {
      "sha": "c9b7485ffb69d260f617f4611f77e669be0208ad",
      "filename": "gdb/testsuite/gdb.base/info-var.exp",
      "status": "modified",
      "additions": 3,
      "deletions": 4,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/98b0ebab0a1eb0c1f179ebe633250e7201d35bce/gdb/testsuite/gdb.base/info-var.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/98b0ebab0a1eb0c1f179ebe633250e7201d35bce/gdb/testsuite/gdb.base/info-var.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/info-var.exp?ref=98b0ebab0a1eb0c1f179ebe633250e7201d35bce",
      "patch": "@@ -22,10 +22,9 @@ if {[prepare_for_testing \"failed to prepare\" \\\n     return -1\n }\n \n-if ![runto_main] then {\n-    fail \"can't run to main\"\n-    return 0\n-}\n+# Note: we do not run to main, as otherwise, the output of info variables\n+# can be very long, showing thousands of glibc variables.\n+# This long output then causes expect's buffer to overflow.\n \n gdb_test \"info variables\" \\\n     [multi_line \\"
    }
  ]
}