{
  "sha": "f2d4211150abba189c4fcd2f7cf0290161474631",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZjJkNDIxMTE1MGFiYmExODljNGZjZDJmN2NmMDI5MDE2MTQ3NDYzMQ==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2021-06-02T08:50:29Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2021-06-02T09:22:11Z"
    },
    "message": "gdb/testsuite: only add -J option when compiling with gfortran\n\nWe currently make use of the -J option to gfortran in order that\ncompiled modules should be placed in the correct output directory.\nObviously different compilers, e.g. flang, will have different options\nto achieve the same result.\n\nThis commit makes it so we only add the -J flag when using a gcc\nbased (i.e. gfortran) compiler.\n\nI had a look through the flang help page and tried a few likely\nlooking options, but couldn't find anything that seemed to do the same\nthing, so, for now, I'm only adding an extra option when compiling\nwith gfortran.\n\nThis does mean that any compiler other than gfortran might run into\nproblems if running the testsuite in parallel due to modules of the\nsame name all being written to the same directory, and so possibly\noverwriting each other.\n\ngdb/testsuite/ChangeLog:\n\n\t* lib/gdb.exp (gdb_compile): Only add the -J option when using a\n\tgcc based Fortran compiler, for example, flang does not support\n\tthis option.",
    "tree": {
      "sha": "7d2bdcdf2c3c7f7324615a8468e2f212968ece9c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/7d2bdcdf2c3c7f7324615a8468e2f212968ece9c"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/f2d4211150abba189c4fcd2f7cf0290161474631",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f2d4211150abba189c4fcd2f7cf0290161474631",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/f2d4211150abba189c4fcd2f7cf0290161474631",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f2d4211150abba189c4fcd2f7cf0290161474631/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "8a222a6b0ffd3b70b511fb067557b9a57a958315",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8a222a6b0ffd3b70b511fb067557b9a57a958315",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/8a222a6b0ffd3b70b511fb067557b9a57a958315"
    }
  ],
  "stats": {
    "total": 10,
    "additions": 9,
    "deletions": 1
  },
  "files": [
    {
      "sha": "f34812d5580f7263ddc7b03694a70ec0f4bbdeb4",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f2d4211150abba189c4fcd2f7cf0290161474631/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f2d4211150abba189c4fcd2f7cf0290161474631/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=f2d4211150abba189c4fcd2f7cf0290161474631",
      "patch": "@@ -1,3 +1,9 @@\n+2021-06-02  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* lib/gdb.exp (gdb_compile): Only add the -J option when using a\n+\tgcc based Fortran compiler, for example, flang does not support\n+\tthis option.\n+\n 2021-06-02  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* lib/fortran.exp (fortran_int8): Escape '*' in pattern."
    },
    {
      "sha": "f6686e19162fade4cd3713ec4c62fdbfc689cd80",
      "filename": "gdb/testsuite/lib/gdb.exp",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f2d4211150abba189c4fcd2f7cf0290161474631/gdb/testsuite/lib/gdb.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f2d4211150abba189c4fcd2f7cf0290161474631/gdb/testsuite/lib/gdb.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/gdb.exp?ref=f2d4211150abba189c4fcd2f7cf0290161474631",
      "patch": "@@ -4098,7 +4098,9 @@ proc gdb_compile {source dest type options} {\n \t    || [lsearch -exact $options f90] != -1 } {\n \t# Fortran compile.\n \tset mod_path [standard_output_file \"\"]\n-\tlappend new_options \"additional_flags=-J${mod_path}\"\n+\tif [test_compiler_info \"gcc-*\"] {\n+\t    lappend new_options \"additional_flags=-J${mod_path}\"\n+\t}\n     }\n \n     set shlib_found 0"
    }
  ]
}