{
  "sha": "c54f15248ee990df6cea0b4730cd61b227a0e082",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YzU0ZjE1MjQ4ZWU5OTBkZjZjZWEwYjQ3MzBjZDYxYjIyN2EwZTA4Mg==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2019-04-26T14:52:00Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2019-04-26T14:52:09Z"
    },
    "message": "Don't complain undefined weak dynamic reference\n\nWhen undefined non-weak references in IR objects are optimized out\nby LTO, we can have weak dynamic referencs to symbols marked with\nbfd_link_hash_undefined.  We shouldn't complain such undefined weak\ndynamic references.\n\nbfd/\n\n\tPR ld/24486\n\t* elflink.c (elf_link_output_extsym): Don't complain undefined\n\tweak dynamic reference.\n\nld/\n\n\tPR ld/24486\n\t* testsuite/ld-plugin/lto.exp: Run PR ld/24486 tests.\n\t* testsuite/ld-plugin/pr24486a.c: New file.\n\t* testsuite/ld-plugin/pr24486b.c: Likewise.\n\t* testsuite/ld-plugin/pr24486c.c: Likewise.",
    "tree": {
      "sha": "c1549a19c4b4e75fb7ab4d6d8a03d6e75c5f0c67",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c1549a19c4b4e75fb7ab4d6d8a03d6e75c5f0c67"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/c54f15248ee990df6cea0b4730cd61b227a0e082",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c54f15248ee990df6cea0b4730cd61b227a0e082",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/c54f15248ee990df6cea0b4730cd61b227a0e082",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c54f15248ee990df6cea0b4730cd61b227a0e082/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "8e1920d611ab3330d6dfa610ff771cf5dc796097",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8e1920d611ab3330d6dfa610ff771cf5dc796097",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/8e1920d611ab3330d6dfa610ff771cf5dc796097"
    }
  ],
  "stats": {
    "total": 45,
    "additions": 44,
    "deletions": 1
  },
  "files": [
    {
      "sha": "b39197d55d3bff3edea57492c2865d1f683ab59c",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c54f15248ee990df6cea0b4730cd61b227a0e082/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c54f15248ee990df6cea0b4730cd61b227a0e082/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=c54f15248ee990df6cea0b4730cd61b227a0e082",
      "patch": "@@ -1,3 +1,9 @@\n+2019-04-26  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/24486\n+\t* elflink.c (elf_link_output_extsym): Don't complain undefined\n+\tweak dynamic reference.\n+\n 2019-04-25  Sudakshina Das  <sudi.das@arm.com>\n \n \t* elfnn-aarch64.c (PLT_BTI_ENTRY_SIZE): Remove."
    },
    {
      "sha": "ddeaa08d505fd55838dc1bef4b5e136a2c07207a",
      "filename": "bfd/elflink.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c54f15248ee990df6cea0b4730cd61b227a0e082/bfd/elflink.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c54f15248ee990df6cea0b4730cd61b227a0e082/bfd/elflink.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elflink.c?ref=c54f15248ee990df6cea0b4730cd61b227a0e082",
      "patch": "@@ -9776,7 +9776,7 @@ elf_link_output_extsym (struct bfd_hash_entry *bh, void *data)\n \n       /* If we are reporting errors for this situation then do so now.  */\n       if (!ignore_undef\n-\t  && h->ref_dynamic\n+\t  && h->ref_dynamic_nonweak\n \t  && (!h->ref_regular || flinfo->info->gc_sections)\n \t  && !elf_link_check_versioned_symbol (flinfo->info, bed, h)\n \t  && flinfo->info->unresolved_syms_in_shared_libs != RM_IGNORE)"
    },
    {
      "sha": "fed72c85cd7dfb3a2bef2d4714939943f4232698",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=c54f15248ee990df6cea0b4730cd61b227a0e082",
      "patch": "@@ -1,3 +1,11 @@\n+2019-04-26  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/24486\n+\t* testsuite/ld-plugin/lto.exp: Run PR ld/24486 tests.\n+\t* testsuite/ld-plugin/pr24486a.c: New file.\n+\t* testsuite/ld-plugin/pr24486b.c: Likewise.\n+\t* testsuite/ld-plugin/pr24486c.c: Likewise.\n+\n 2019-04-26  Nick Clifton  <nickc@redhat.com>\n \n \t* po/ru.po: Updated Russian translation."
    },
    {
      "sha": "e913c6f203de1a305116ebafea89505c12a343a8",
      "filename": "ld/testsuite/ld-plugin/lto.exp",
      "status": "modified",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/testsuite/ld-plugin/lto.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/testsuite/ld-plugin/lto.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/lto.exp?ref=c54f15248ee990df6cea0b4730cd61b227a0e082",
      "patch": "@@ -325,6 +325,18 @@ set lto_link_elf_tests [list \\\n   [list {Build pr22220main.o} \\\n    {} {-flto} \\\n    {pr22220main.cc} {} {} {c++}] \\\n+  [list \"Build pr24486a.o\" \\\n+   \"$plug_opt\" \"-flto -O2\" \\\n+   {pr24486a.c} {} \"\" \"c\"] \\\n+  [list \"Build pr24486b.so\" \\\n+   \"-shared\" \"-O2 -fpic\" \\\n+   {pr24486b.c} {} \"pr24486b.so\" \"c\"] \\\n+  [list \"Build pr24486c.so\" \\\n+   \"-shared -Wl,--no-as-needed tmpdir/pr24486b.so\" \"-O2 -fpic\" \\\n+   {pr24486c.c} {} \"pr24486c.so\" \"c\"] \\\n+  [list \"PR ld/24486\" \\\n+   \"-O2 -flto tmpdir/pr24486a.o tmpdir/pr24486c.so -Wl,--as-needed tmpdir/pr24486b.so\" \"\" \\\n+   {dummy.c} {} \"pr24486.exe\"] \\\n ]\n \n # PR 14918 checks that libgcc is not spuriously included in a shared link of"
    },
    {
      "sha": "def0139598434f84b06631de681cf1a5ffb5e32d",
      "filename": "ld/testsuite/ld-plugin/pr24486a.c",
      "status": "added",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/testsuite/ld-plugin/pr24486a.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/testsuite/ld-plugin/pr24486a.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/pr24486a.c?ref=c54f15248ee990df6cea0b4730cd61b227a0e082",
      "patch": "@@ -0,0 +1,8 @@\n+extern int FLAGS_verbose;\n+extern void bar (void);\n+int\n+a(void) {\n+return FLAGS_verbose;\n+}\n+void unused (void) { bar(); }\n+int main() { return a (); }"
    },
    {
      "sha": "3aabe2a3957b26e20dc3ed87b68d8aedfd48318b",
      "filename": "ld/testsuite/ld-plugin/pr24486b.c",
      "status": "added",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/testsuite/ld-plugin/pr24486b.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/testsuite/ld-plugin/pr24486b.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/pr24486b.c?ref=c54f15248ee990df6cea0b4730cd61b227a0e082",
      "patch": "@@ -0,0 +1,8 @@\n+extern void bar (void) __attribute__((weak));\n+\n+void\n+foo (void)\n+{\n+  if (bar)\n+    bar ();\n+}"
    },
    {
      "sha": "f289177d3e57cf5e1882e13d4966941919b57e37",
      "filename": "ld/testsuite/ld-plugin/pr24486c.c",
      "status": "added",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/testsuite/ld-plugin/pr24486c.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c54f15248ee990df6cea0b4730cd61b227a0e082/ld/testsuite/ld-plugin/pr24486c.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/pr24486c.c?ref=c54f15248ee990df6cea0b4730cd61b227a0e082",
      "patch": "@@ -0,0 +1 @@\n+int FLAGS_verbose;"
    }
  ]
}