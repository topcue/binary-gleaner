{
  "sha": "c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
  "node_id": "C_kwDOANOeidoAKGM4ZWQ4YzhhYzM4MDgxM2IzYTVkNDcxMzFjY2FkMWY3OTMwNWMxNmI",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-10-11T14:59:56Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-10-11T14:59:56Z"
    },
    "message": "[gdb/testsuite] Fix FAIL in gdb.mi/mi-var-child-f.exp\n\nWhen running test-case gdb.mi/mi-var-child-f.exp on openSUSE Tumbleweed\n(with glibc 2.34) I run into:\n...\n(gdb) ^M\nPASS: gdb.mi/mi-var-child-f.exp: mi runto prog_array\nExpecting: ^(-var-create array \\* array[^M\n]+)?(\\^done,name=\"array\",numchild=\"[0-9]+\",value=\".*\",type=.*,has_more=\"0\"[^M\n]+[(]gdb[)] ^M\n[ ]*)\n-var-create array * array^M\n&\"Attempt to use a type name as an expression.\\n\"^M\n^error,msg=\"-var-create: unable to create variable object\"^M\n(gdb) ^M\nFAIL: gdb.mi/mi-var-child-f.exp: create local variable array (unexpected output)\n...\n\nThe problem is that the name array is used both:\n- as the name for a local variable\n- as the name of a type in glibc, in file malloc/dynarray-skeleton.c, as included\n  by nss/nss_files/files-hosts.c.\n\nFix this by ignoring the shared lib symbols.\n\nLikewise in a couple of other fortran tests.\n\nTested on x86_64-linux.",
    "tree": {
      "sha": "0bc23fe2501be86948dd0e7ce0a77f5b5b8121fc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/0bc23fe2501be86948dd0e7ce0a77f5b5b8121fc"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "3a480f1e35b7e22a3ca6309dae8f665c8dacd104",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3a480f1e35b7e22a3ca6309dae8f665c8dacd104",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/3a480f1e35b7e22a3ca6309dae8f665c8dacd104"
    }
  ],
  "stats": {
    "total": 41,
    "additions": 41,
    "deletions": 0
  },
  "files": [
    {
      "sha": "9f192d66e1b25623da6497bf7ba8869c8501400c",
      "filename": "gdb/testsuite/gdb.fortran/allocated.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/allocated.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/allocated.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/allocated.exp?ref=c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
      "patch": "@@ -25,10 +25,16 @@ if {[prepare_for_testing ${testfile}.exp ${testfile} ${srcfile} \\\n     return -1\n }\n \n+# Avoid shared lib symbols.\n+gdb_test_no_output \"set auto-solib-add off\"\n+\n if ![fortran_runto_main] {\n     return -1\n }\n \n+# Avoid libc symbols, in particular the 'array' type.\n+gdb_test_no_output \"nosharedlibrary\"\n+\n # Set all the breakpoints.\n for { set i 1 } { $i < 6 } { incr i } {\n     gdb_breakpoint [gdb_get_line_number \"Breakpoint $i\"]"
    },
    {
      "sha": "c8bea995247e467eee712f92f37c8c4a290d5a70",
      "filename": "gdb/testsuite/gdb.fortran/array-slices-bad.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/array-slices-bad.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/array-slices-bad.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/array-slices-bad.exp?ref=c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
      "patch": "@@ -25,10 +25,16 @@ if {[prepare_for_testing ${testfile}.exp ${testfile} ${srcfile} \\\n     return -1\n }\n \n+# Avoid shared lib symbols.\n+gdb_test_no_output \"set auto-solib-add off\"\n+\n if ![fortran_runto_main] {\n     return -1\n }\n \n+# Avoid libc symbols, in particular the 'array' type.\n+gdb_test_no_output \"nosharedlibrary\"\n+\n # gdb_breakpoint [gdb_get_line_number \"Display Message Breakpoint\"]\n gdb_breakpoint [gdb_get_line_number \"First Breakpoint\"]\n gdb_breakpoint [gdb_get_line_number \"Second Breakpoint\"]"
    },
    {
      "sha": "c8e5232da4ea38ce1b361cce4a6f8f63c83aa777",
      "filename": "gdb/testsuite/gdb.fortran/array-slices-sub-slices.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/array-slices-sub-slices.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/array-slices-sub-slices.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/array-slices-sub-slices.exp?ref=c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
      "patch": "@@ -25,10 +25,16 @@ if {[prepare_for_testing ${testfile}.exp ${testfile} ${srcfile} \\\n     return -1\n }\n \n+# Avoid shared lib symbols.\n+gdb_test_no_output \"set auto-solib-add off\"\n+\n if ![fortran_runto_main] {\n     return -1\n }\n \n+# Avoid libc symbols, in particular the 'array' type.\n+gdb_test_no_output \"nosharedlibrary\"\n+\n # gdb_breakpoint [gdb_get_line_number \"Display Message Breakpoint\"]\n gdb_breakpoint [gdb_get_line_number \"Stop Here\"]\n gdb_breakpoint [gdb_get_line_number \"Final Breakpoint\"]"
    },
    {
      "sha": "2c92d606e56e2a3c3426ef42b9bd2b63bccd08d1",
      "filename": "gdb/testsuite/gdb.fortran/array-slices.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/array-slices.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/array-slices.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/array-slices.exp?ref=c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
      "patch": "@@ -55,10 +55,16 @@ proc run_test { repack } {\n \n     clean_restart ${binfile}\n \n+    # Avoid shared lib symbols.\n+    gdb_test_no_output \"set auto-solib-add off\"\n+\n     if ![fortran_runto_main] {\n \treturn -1\n     }\n \n+    # Avoid libc symbols, in particular the 'array' type.\n+    gdb_test_no_output \"nosharedlibrary\"\n+\n     gdb_test_no_output \"set fortran repack-array-slices $repack\"\n \n     # gdb_breakpoint [gdb_get_line_number \"Display Message Breakpoint\"]"
    },
    {
      "sha": "3a65f7fa8ca80f6996ffc9c7369c6112d89e61be",
      "filename": "gdb/testsuite/gdb.fortran/lbound-ubound.exp",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/lbound-ubound.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/lbound-ubound.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/lbound-ubound.exp?ref=c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
      "patch": "@@ -25,11 +25,16 @@ if {[prepare_for_testing ${testfile}.exp ${testfile} ${srcfile} \\\n     return -1\n }\n \n+# Avoid shared lib symbols.\n+gdb_test_no_output \"set auto-solib-add off\"\n \n if ![fortran_runto_main] {\n     return -1\n }\n \n+# Avoid libc symbols, in particular the 'array' type.\n+gdb_test_no_output \"nosharedlibrary\"\n+\n gdb_breakpoint [gdb_get_line_number \"Test Breakpoint\"]\n gdb_breakpoint [gdb_get_line_number \"Final Breakpoint\"]\n "
    },
    {
      "sha": "722ac52bdf30fa4df0e47f3c336858c07f9a5e7b",
      "filename": "gdb/testsuite/gdb.fortran/subarray.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/subarray.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.fortran/subarray.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/subarray.exp?ref=c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
      "patch": "@@ -27,11 +27,17 @@ if {[prepare_for_testing \"failed to prepare\" $testfile $srcfile {debug f90}]} {\n     return -1\n }\n \n+# Avoid shared lib symbols.\n+gdb_test_no_output \"set auto-solib-add off\"\n+\n if ![fortran_runto_main] then {\n     perror \"couldn't run to main\"\n     continue\n }\n \n+# Avoid libc symbols, in particular the 'array' type.\n+gdb_test_no_output \"nosharedlibrary\"\n+\n # Try to set breakpoint at the last write statement.\n \n set bp_location [gdb_get_line_number \"str(:)\"]"
    },
    {
      "sha": "a1aa1acb720a6499ff7e3d240edb91cf70773293",
      "filename": "gdb/testsuite/gdb.mi/mi-var-child-f.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.mi/mi-var-child-f.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c8ed8c8ac380813b3a5d47131ccad1f79305c16b/gdb/testsuite/gdb.mi/mi-var-child-f.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-var-child-f.exp?ref=c8ed8c8ac380813b3a5d47131ccad1f79305c16b",
      "patch": "@@ -36,8 +36,14 @@ if {[gdb_compile \"${srcdir}/${subdir}/${srcfile}\" \"${binfile}\" \\\n mi_gdb_reinitialize_dir $srcdir/$subdir\n mi_gdb_load ${binfile}\n \n+# Avoid shared lib symbols.\n+mi_gdb_test \"-gdb-set auto-solib-add off\" \"\\\\^done\"\n+\n mi_runto prog_array\n \n+# Avoid libc symbols, in particular the 'array' type.\n+mi_gdb_test \"nosharedlibrary\" \".*\\\\^done\"\n+\n mi_create_varobj \"array\" \"array\" \"create local variable array\"\n \n "
    }
  ]
}