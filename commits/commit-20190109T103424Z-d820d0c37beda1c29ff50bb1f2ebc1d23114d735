{
  "sha": "d820d0c37beda1c29ff50bb1f2ebc1d23114d735",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDgyMGQwYzM3YmVkYTFjMjlmZjUwYmIxZjJlYmMxZDIzMTE0ZDczNQ==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2019-01-03T21:13:52Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2019-01-09T10:34:24Z"
    },
    "message": "gdb/testsuite: Remove interactive prompt case from mi_gdb_test\n\nI noticed that when running this test:\n\n  make check-gdb RUNTESTFLAGS=\"--target_board=native-gdbserver gdb.mi/mi-break.exp\"\n\nI would occasionally see some UNRESOLVED test results like this:\n\n  (gdb)\n  PASS: gdb.mi/mi-break.exp: mi-mode=separate: breakpoint at main\n  Expecting: ^(kill[\n  ]+)?(.*[\n  ]+[(]gdb[)]\n  [ ]*)\n  kill\n  &\"kill\\n\"\n  ~\"Kill the program being debugged? (y or n) [answered Y; input not from terminal]\\n\"\n  =thread-group-exited,id=\"i1\"\n  ERROR: Got interactive prompt.\n  UNRESOLVED: gdb.mi/mi-break.exp: mi-mode=separate:\n\nThe problem appears to be that the expect buffer fills up to include\nthe '(y or n)' prompt without including the following lines.\n\nThe pattern supplied by the outer test script is looking for the\nfollowing lines.  As the following lines are not present then expect\nmatches on the interactive prompt case rather than the case for the\nuser supplied pattern.\n\nThe problem with this is that we are not really at an interactive\nprompt, GDB is providing an answer for us and then moving on.  When I\nexamine a successful run of the test the output from GDB is identical,\nthe only difference is where expect happens to buffer the output from\nGDB.\n\nThis patch remove all special handling of the interactive prompt\ncase.  This means that if we ever break GDB and start seeing an\nunexpected interactive prompt then tests will rely on a timeout to\nfail, instead of having dedicated interactive prompt detection, but\nthis solves the problem that an auto-answered prompt looks very\nsimilar to an interactive prompt.\n\nWith this patch in place I can now leave the following loop running\nindefinitely, where before it would fail usually after ~10\niterations.\n\n  while make check-gdb RUNTESTFLAGS=\"--target_board=native-gdbserver gdb.mi/mi-break.exp\"; \\\n  do /bin/true; \\\n  done\n\ngdb/testsuite/ChangeLog:\n\n\t* lib/mi-support.exp (mi_gdb_test): Remove interactive prompt\n\tcase.",
    "tree": {
      "sha": "d1c461d032a635b08dcfae7ecd26f0f847594b60",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d1c461d032a635b08dcfae7ecd26f0f847594b60"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d820d0c37beda1c29ff50bb1f2ebc1d23114d735",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d820d0c37beda1c29ff50bb1f2ebc1d23114d735",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d820d0c37beda1c29ff50bb1f2ebc1d23114d735",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d820d0c37beda1c29ff50bb1f2ebc1d23114d735/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "1055a3b422da11b252fc83e73a5e9f465233e73d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1055a3b422da11b252fc83e73a5e9f465233e73d",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/1055a3b422da11b252fc83e73a5e9f465233e73d"
    }
  ],
  "stats": {
    "total": 10,
    "additions": 5,
    "deletions": 5
  },
  "files": [
    {
      "sha": "309cfb59040d9fbce2e2349b50ce5485b08c3c65",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d820d0c37beda1c29ff50bb1f2ebc1d23114d735/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d820d0c37beda1c29ff50bb1f2ebc1d23114d735/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=d820d0c37beda1c29ff50bb1f2ebc1d23114d735",
      "patch": "@@ -1,3 +1,8 @@\n+2019-01-09  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* lib/mi-support.exp (mi_gdb_test): Remove interactive prompt\n+\tcase.\n+\n 2019-01-06  Tom Tromey  <tom@tromey.com>\n \n \tPR gdb/28155:"
    },
    {
      "sha": "a58c4f6e1191d6b601b763f0595a0aeaf248c8f5",
      "filename": "gdb/testsuite/lib/mi-support.exp",
      "status": "modified",
      "additions": 0,
      "deletions": 5,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d820d0c37beda1c29ff50bb1f2ebc1d23114d735/gdb/testsuite/lib/mi-support.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d820d0c37beda1c29ff50bb1f2ebc1d23114d735/gdb/testsuite/lib/mi-support.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/mi-support.exp?ref=d820d0c37beda1c29ff50bb1f2ebc1d23114d735",
      "patch": "@@ -832,11 +832,6 @@ proc mi_gdb_test { args } {\n \t    send_gdb \"\\n\"\n \t    perror \"Window too small.\"\n \t     fail \"$message\"\n-\t}\n-\t -re \"\\\\(y or n\\\\) \" {\n-\t    send_gdb \"n\\n\"\n-\t    perror \"Got interactive prompt.\"\n-\t     fail \"$message\"\n \t}\n \t eof {\n \t     perror \"Process no longer exists\""
    }
  ]
}