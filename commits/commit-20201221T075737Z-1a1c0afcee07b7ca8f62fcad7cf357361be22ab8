{
  "sha": "1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MWExYzBhZmNlZTA3YjdjYThmNjJmY2FkN2NmMzU3MzYxYmUyMmFiOA==",
  "commit": {
    "author": {
      "name": "Markus Metzger",
      "email": "markus.t.metzger@intel.com",
      "date": "2020-12-04T09:01:29Z"
    },
    "committer": {
      "name": "Markus Metzger",
      "email": "markus.t.metzger@intel.com",
      "date": "2020-12-21T07:57:37Z"
    },
    "message": "testsuite, gdb.btrace: make test names unique\n\ngdb/testsuite/ChangeLog:\n2020-12-04  Markus Metzger  <markus.t.metzger@intel.com>\n\n\t* gdb.btrace/data.exp: Make test names unique.\n\t* gdb.btrace/delta.exp: Likewise.\n\t* gdb.btrace/enable.exp: Likewise.\n\t* gdb.btrace/function_call_history.exp: Likewise.\n\t* gdb.btrace/nohist.exp: Likewise.\n\t* gdb.btrace/non-stop.exp: Likewise.\n\t* gdb.btrace/rn-dl-bind.exp: Likewise.\n\t* gdb.btrace/step.exp: Likewise.\n\t* gdb.btrace/stepi.exp: Likewise.\n\t* gdb.btrace/tailcall.exp: Likewise.",
    "tree": {
      "sha": "69f853fe615914b9957a2304cd3fb70f28029628",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/69f853fe615914b9957a2304cd3fb70f28029628"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/comments",
  "author": {
    "login": "markus-metzger",
    "id": 5424725,
    "node_id": "MDQ6VXNlcjU0MjQ3MjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5424725?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/markus-metzger",
    "html_url": "https://github.com/markus-metzger",
    "followers_url": "https://api.github.com/users/markus-metzger/followers",
    "following_url": "https://api.github.com/users/markus-metzger/following{/other_user}",
    "gists_url": "https://api.github.com/users/markus-metzger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/markus-metzger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/markus-metzger/subscriptions",
    "organizations_url": "https://api.github.com/users/markus-metzger/orgs",
    "repos_url": "https://api.github.com/users/markus-metzger/repos",
    "events_url": "https://api.github.com/users/markus-metzger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/markus-metzger/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "markus-metzger",
    "id": 5424725,
    "node_id": "MDQ6VXNlcjU0MjQ3MjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5424725?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/markus-metzger",
    "html_url": "https://github.com/markus-metzger",
    "followers_url": "https://api.github.com/users/markus-metzger/followers",
    "following_url": "https://api.github.com/users/markus-metzger/following{/other_user}",
    "gists_url": "https://api.github.com/users/markus-metzger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/markus-metzger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/markus-metzger/subscriptions",
    "organizations_url": "https://api.github.com/users/markus-metzger/orgs",
    "repos_url": "https://api.github.com/users/markus-metzger/repos",
    "events_url": "https://api.github.com/users/markus-metzger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/markus-metzger/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "98d837f0efa63cdd430d161e95ca713c4b67399a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/98d837f0efa63cdd430d161e95ca713c4b67399a",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/98d837f0efa63cdd430d161e95ca713c4b67399a"
    }
  ],
  "stats": {
    "total": 371,
    "additions": 231,
    "deletions": 140
  },
  "files": [
    {
      "sha": "0e99e035ac86bb25a55ba690888fed59949952a7",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -1,3 +1,16 @@\n+2020-12-21  Markus Metzger  <markus.t.metzger@intel.com>\n+\n+\t* gdb.btrace/data.exp: Make test names unique.\n+\t* gdb.btrace/delta.exp: Likewise.\n+\t* gdb.btrace/enable.exp: Likewise.\n+\t* gdb.btrace/function_call_history.exp: Likewise.\n+\t* gdb.btrace/nohist.exp: Likewise.\n+\t* gdb.btrace/non-stop.exp: Likewise.\n+\t* gdb.btrace/rn-dl-bind.exp: Likewise.\n+\t* gdb.btrace/step.exp: Likewise.\n+\t* gdb.btrace/stepi.exp: Likewise.\n+\t* gdb.btrace/tailcall.exp: Likewise.\n+\n 2020-12-21  Markus Metzger  <markus.t.metzger@intel.com>\n \n \t* gdb.btrace/enable.exp: Update error message."
    },
    {
      "sha": "28ac1ad46ade7dec880a6300a4ed26909aa5cc4d",
      "filename": "gdb/testsuite/gdb.btrace/data.exp",
      "status": "modified",
      "additions": 16,
      "deletions": 8,
      "changes": 24,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/data.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/data.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/data.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -40,16 +40,24 @@ gdb_test \"next\" \".*main\\.3.*\"\n gdb_test \"reverse-step\" \".*test\\.4.*\"\n \n # we can't read memory while we're replaying\n-gdb_test \"print glob\" \"unavailable\\[^\\\\\\r\\\\\\n\\]*\"\n-gdb_test \"print loc\" \"unavailable\\[^\\\\\\r\\\\\\n\\]*\"\n+with_test_prefix \"replay\" {\n+    with_test_prefix \"default\" {\n+\tgdb_test \"print glob\" \"unavailable\\[^\\\\\\r\\\\\\n\\]*\"\n+\tgdb_test \"print loc\" \"unavailable\\[^\\\\\\r\\\\\\n\\]*\"\n+    }\n \n-# we can read memory if we explicitly allow it.\n-gdb_test_no_output \"set record btrace replay-memory-access read-write\"\n-gdb_test \"print glob\" \"1\"\n+    # we can read memory if we explicitly allow it.\n+    with_test_prefix \"read-write\" {\n+\tgdb_test_no_output \"set record btrace replay-memory-access read-write\"\n+\tgdb_test \"print glob\" \"1\"\n+    }\n \n-# we can't if we don't explicitly allow it.\n-gdb_test_no_output \"set record btrace replay-memory-access read-only\"\n-gdb_test \"print glob\" \"unavailable\\[^\\\\\\r\\\\\\n\\]*\"\n+    # we can't if we don't explicitly allow it.\n+    with_test_prefix \"read-only\" {\n+\tgdb_test_no_output \"set record btrace replay-memory-access read-only\"\n+\tgdb_test \"print glob\" \"unavailable\\[^\\\\\\r\\\\\\n\\]*\"\n+    }\n+}\n \n # stop replaying and try again\n gdb_test \"record goto end\" \".*main\\.3.*\""
    },
    {
      "sha": "5489121465328be1b1035c9b3e73e8d1b1f63c02",
      "filename": "gdb/testsuite/gdb.btrace/delta.exp",
      "status": "modified",
      "additions": 17,
      "deletions": 13,
      "changes": 30,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/delta.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/delta.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/delta.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -73,18 +73,22 @@ with_test_prefix \"twice\" {\n }\n \n # check that we can reverse-stepi that instruction\n-gdb_test \"reverse-stepi\"\n-gdb_test \"info record\" [multi_line \\\n-  \"Active record target: record-btrace\" \\\n-  \"Recording format: .*\" \\\n-  \"Recorded 1 instructions in 1 functions \\\\\\(0 gaps\\\\\\) for .*\" \\\n-  \"Replay in progress\\.  At instruction 1\\.\" \\\n-  ] \"reverse-stepi\"\n+with_test_prefix \"reverse\" {\n+    gdb_test \"reverse-stepi\"\n+    gdb_test \"info record\" [multi_line \\\n+      \"Active record target: record-btrace\" \\\n+      \"Recording format: .*\" \\\n+      \"Recorded 1 instructions in 1 functions \\\\\\(0 gaps\\\\\\) for .*\" \\\n+      \"Replay in progress\\.  At instruction 1\\.\" \\\n+    ]\n+}\n \n # and back\n-gdb_test \"stepi\"\n-gdb_test \"info record\" [multi_line \\\n-  \"Active record target: record-btrace\" \\\n-  \"Recording format: .*\" \\\n-  \"Recorded 1 instructions in 1 functions \\\\\\(0 gaps\\\\\\) for .*\" \\\n-  ] \"and back\"\n+with_test_prefix \"forward\" {\n+    gdb_test \"stepi\"\n+    gdb_test \"info record\" [multi_line \\\n+      \"Active record target: record-btrace\" \\\n+      \"Recording format: .*\" \\\n+      \"Recorded 1 instructions in 1 functions \\\\\\(0 gaps\\\\\\) for .*\" \\\n+    ]\n+}"
    },
    {
      "sha": "d147e90874acdf977d743322a25186458f0c0004",
      "filename": "gdb/testsuite/gdb.btrace/enable.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/enable.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/enable.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/enable.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -100,7 +100,7 @@ if ![runto_main] {\n     untested \"failed to run to main\"\n     return -1\n }\n-gdb_test_no_output \"record btrace\"\n+gdb_test_no_output \"record btrace\" \"enable after restart\"\n if ![runto_main] {\n     untested \"failed to run to main\"\n     return -1"
    },
    {
      "sha": "51536ff60353b38f01bdf60ca256cb0c36526e78",
      "filename": "gdb/testsuite/gdb.btrace/function_call_history.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/function_call_history.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/function_call_history.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/function_call_history.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -240,7 +240,7 @@ gdb_continue_to_breakpoint \"cont to fib.3\"\n gdb_continue_to_breakpoint \"cont to fib.4\"\n \n # start tracing\n-gdb_test_no_output \"record btrace\"\n+gdb_test_no_output \"record btrace\" \"start recording after rerun\"\n \n # continue until line 30 above\n delete_breakpoints"
    },
    {
      "sha": "90883c069732fd7ce04f82edcc55545f6a20c400",
      "filename": "gdb/testsuite/gdb.btrace/nohist.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/nohist.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/nohist.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/nohist.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -42,8 +42,12 @@ proc check_not_replaying {} {\n \n gdb_test_no_output \"record btrace\"\n \n-check_not_replaying\n+with_test_prefix \"forward\" {\n+    check_not_replaying\n+}\n \n gdb_test \"reverse-continue\" \"No more reverse-execution history\\.\\r\\n.*\"\n \n-check_not_replaying\n+with_test_prefix \"backward\" {\n+    check_not_replaying\n+}"
    },
    {
      "sha": "0a9b753eca4cac60b960ada546bf047ce1e9f5db",
      "filename": "gdb/testsuite/gdb.btrace/non-stop.exp",
      "status": "modified",
      "additions": 42,
      "deletions": 34,
      "changes": 76,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/non-stop.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/non-stop.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/non-stop.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -60,17 +60,15 @@ proc gdb_cont_to { threads cmd line nthreads } {\n     # the prompt precedes any further output except some errors.\n     gdb_test_multiple \"$full_cmd &\" \"$full_cmd: prompt\" {\n         -re \"$gdb_prompt \" {\n-            pass \"$full_cmd: prompt\"\n+            pass $gdb_test_name\n         }\n     }\n \n     # now check for the expected line - one per thread.\n     for {set i 0} {$i < $nthreads} {incr i} {\n-        set test \"$full_cmd: thread $i\"\n-\n-        gdb_test_multiple \"\" $test {\n+        gdb_test_multiple \"\" \"$full_cmd: thread $i\" {\n             -re \"$line\\[^\\\\\\r\\\\\\n\\]*\\r\\n\" {\n-                pass $test\n+                pass $gdb_test_name\n             }\n         }\n     }\n@@ -96,9 +94,13 @@ proc gdb_cont_to_no_history { threads cmd nthreads } {\n }\n \n # trace the code between the two breakpoints\n-gdb_cont_to_bp_line \"$srcfile:$bp_1\" all 2\n-gdb_test_no_output \"record btrace\"\n-gdb_cont_to_bp_line \"$srcfile:$bp_2\" all 2\n+with_test_prefix \"prepare\" {\n+    gdb_cont_to_bp_line \"$srcfile:$bp_1\" all 2\n+}\n+with_test_prefix \"record\" {\n+    gdb_test_no_output \"record btrace\"\n+    gdb_cont_to_bp_line \"$srcfile:$bp_2\" all 2\n+}\n \n # we don't need those breakpoints any longer.\n # they will only disturb our stepping.\n@@ -112,15 +114,15 @@ with_test_prefix \"navigate\" {\n     gdb_test \"thread apply 1 record goto 2\" \"$loop_line\"\n     gdb_test \"thread apply 2 record goto 4\" \"$loop_line\"\n     gdb_test \"thread apply 1 info record\" \\\n-        \".*Replay in progress\\.  At instruction 2\\.\"\n+        \".*Replay in progress\\.  At instruction 2\\.\" \"thread 1 at insn 2\"\n     gdb_test \"thread apply 2 info record\" \\\n-        \".*Replay in progress\\.  At instruction 4\\.\"\n+        \".*Replay in progress\\.  At instruction 4\\.\" \"thread 2 at insn 4\"\n \n     gdb_test \"thread apply all record goto 5\" \"$loop_line\"\n     gdb_test \"thread apply 1 info record\" \\\n-        \".*Replay in progress\\.  At instruction 5\\.\"\n+        \".*Replay in progress\\.  At instruction 5\\.\" \"thread 1 at insn 5\"\n     gdb_test \"thread apply 2 info record\" \\\n-        \".*Replay in progress\\.  At instruction 5\\.\"\n+        \".*Replay in progress\\.  At instruction 5\\.\" \"thread 2 at insn 5\"\n }\n \n with_test_prefix \"step\" {\n@@ -177,31 +179,37 @@ with_test_prefix \"reverse-step\" {\n \n with_test_prefix \"continue\" {\n     with_test_prefix \"thread 1\" {\n-        gdb_cont_to_no_history 1 \"continue\" 1\n-        gdb_test \"thread apply 1 info record\" \\\n-            \".*Recorded \\[0-9\\]+ instructions \\[^\\\\\\r\\\\\\n\\]*\"\n-        gdb_test \"thread apply 2 info record\" \\\n-            \".*Replay in progress\\.  At instruction 5\\.\"\n-\n-        gdb_cont_to_no_history 1 \"reverse-continue\" 1\n-        gdb_test \"thread apply 1 info record\" \\\n-            \".*Replay in progress\\.  At instruction 1\\.\"\n-        gdb_test \"thread apply 2 info record\" \\\n-            \".*Replay in progress\\.  At instruction 5\\.\"\n+\twith_test_prefix \"continue\" {\n+\t    gdb_cont_to_no_history 1 \"continue\" 1\n+\t    gdb_test \"thread apply 1 info record\" \\\n+\t\t\".*Recorded \\[0-9\\]+ instructions \\[^\\\\\\r\\\\\\n\\]*\"\n+\t    gdb_test \"thread apply 2 info record\" \\\n+\t\t\".*Replay in progress\\.  At instruction 5\\.\"\n+\t}\n+\twith_test_prefix \"reverse-continue\" {\n+\t    gdb_cont_to_no_history 1 \"reverse-continue\" 1\n+\t    gdb_test \"thread apply 1 info record\" \\\n+\t\t\".*Replay in progress\\.  At instruction 1\\.\"\n+\t    gdb_test \"thread apply 2 info record\" \\\n+\t\t\".*Replay in progress\\.  At instruction 5\\.\"\n+\t}\n     }\n \n     with_test_prefix \"thread 2\" {\n-        gdb_cont_to_no_history 2 \"continue\" 1\n-        gdb_test \"thread apply 1 info record\" \\\n-            \".*Replay in progress\\.  At instruction 1\\.\"\n-        gdb_test \"thread apply 2 info record\" \\\n-            \".*Recorded \\[0-9\\]+ instructions \\[^\\\\\\r\\\\\\n\\]*\"\n-\n-        gdb_cont_to_no_history 2 \"reverse-continue\" 1\n-        gdb_test \"thread apply 1 info record\" \\\n-            \".*Replay in progress\\.  At instruction 1\\.\"\n-        gdb_test \"thread apply 2 info record\" \\\n-            \".*Replay in progress\\.  At instruction 1\\.\"\n+\twith_test_prefix \"continue\" {\n+\t    gdb_cont_to_no_history 2 \"continue\" 1\n+\t    gdb_test \"thread apply 1 info record\" \\\n+\t\t\".*Replay in progress\\.  At instruction 1\\.\"\n+\t    gdb_test \"thread apply 2 info record\" \\\n+\t\t\".*Recorded \\[0-9\\]+ instructions \\[^\\\\\\r\\\\\\n\\]*\"\n+\t}\n+\twith_test_prefix \"reverse-continue\" {\n+\t    gdb_cont_to_no_history 2 \"reverse-continue\" 1\n+\t    gdb_test \"thread apply 1 info record\" \\\n+\t\t\".*Replay in progress\\.  At instruction 1\\.\"\n+\t    gdb_test \"thread apply 2 info record\" \\\n+\t\t\".*Replay in progress\\.  At instruction 1\\.\"\n+\t}\n     }\n }\n "
    },
    {
      "sha": "46804864026e6443d80a37fa172a9a316b138de8",
      "filename": "gdb/testsuite/gdb.btrace/rn-dl-bind.exp",
      "status": "modified",
      "additions": 7,
      "deletions": 7,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/rn-dl-bind.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/rn-dl-bind.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/rn-dl-bind.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -38,18 +38,18 @@ if ![runto_main] {\n \n # trace the code for the call to test\n gdb_test_no_output \"record btrace\"\n-gdb_test \"next\" \".*main\\.2.*\"\n+gdb_test \"next\" \".*main\\.2.*\" \"next.1\"\n \n # just dump the function-call-history to help debugging\n gdb_test_no_output \"set record function-call-history-size 0\"\n gdb_test \"record function-call-history /cli 1\" \".*\"\n \n # check that we can reverse-next and next\n-gdb_test \"reverse-next\" \".*main\\.1.*\"\n-gdb_test \"next\" \".*main\\.2.*\"\n+gdb_test \"reverse-next\" \".*main\\.1.*\" \"reverse-next.1\"\n+gdb_test \"next\" \".*main\\.2.*\" \"next.2\"\n \n # now go into test and try to reverse-next and next over the library call\n-gdb_test \"reverse-step\" \".*test\\.3.*\"\n-gdb_test \"reverse-step\" \".*test\\.2.*\"\n-gdb_test \"reverse-next\" \".*test\\.1.*\"\n-gdb_test \"next\" \".*test\\.2.*\"\n+gdb_test \"reverse-step\" \".*test\\.3.*\" \"reverse-step.1\"\n+gdb_test \"reverse-step\" \".*test\\.2.*\" \"reverse-step.2\"\n+gdb_test \"reverse-next\" \".*test\\.1.*\" \"reverse-next.2\"\n+gdb_test \"next\" \".*test\\.2.*\" \"next.3\""
    },
    {
      "sha": "a71c46dde6bf08c9678ac83e247f897cc5725f5c",
      "filename": "gdb/testsuite/gdb.btrace/step.exp",
      "status": "modified",
      "additions": 15,
      "deletions": 11,
      "changes": 26,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/step.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/step.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/step.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -33,16 +33,20 @@ if ![runto_main] {\n }\n \n # trace the call to the test function\n-gdb_test_no_output \"record btrace\"\n-gdb_test \"next\"\n+with_test_prefix \"record\" {\n+    gdb_test_no_output \"record btrace\"\n+    gdb_test \"next\"\n+}\n \n # let's step around a bit\n-gdb_test \"reverse-next\" \".*main\\.2.*\"\n-gdb_test \"step\" \".*fun4\\.2.*\"\n-gdb_test \"next\" \".*fun4\\.3.*\"\n-gdb_test \"step\" \".*fun2\\.2.*\"\n-gdb_test \"finish\" \".*fun4\\.4.*\"\n-gdb_test \"reverse-step\" \".*fun2\\.3.*\"\n-gdb_test \"reverse-finish\" \".*fun4\\.3.*\"\n-gdb_test \"reverse-next\" \".*fun4\\.2.*\"\n-gdb_test \"reverse-finish\" \".*main\\.2.*\"\n+with_test_prefix \"replay\" {\n+    gdb_test \"reverse-next\" \".*main\\.2.*\" \"reverse-next.1\"\n+    gdb_test \"step\" \".*fun4\\.2.*\" \"step.1\"\n+    gdb_test \"next\" \".*fun4\\.3.*\" \"next.1\"\n+    gdb_test \"step\" \".*fun2\\.2.*\" \"step.2\"\n+    gdb_test \"finish\" \".*fun4\\.4.*\" \"finish.1\"\n+    gdb_test \"reverse-step\" \".*fun2\\.3.*\" \"reverse-step.1\"\n+    gdb_test \"reverse-finish\" \".*fun4\\.3.*\" \"reverse-finish.1\"\n+    gdb_test \"reverse-next\" \".*fun4\\.2.*\" \"reverse-next.2\"\n+    gdb_test \"reverse-finish\" \".*main\\.2.*\" \"reverse-finish.2\"\n+}"
    },
    {
      "sha": "4e2bf1a8e81884d96c68ff5d446bb0eb433680a5",
      "filename": "gdb/testsuite/gdb.btrace/stepi.exp",
      "status": "modified",
      "additions": 93,
      "deletions": 53,
      "changes": 146,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/stepi.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/stepi.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/stepi.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -61,82 +61,122 @@ proc check_replay_at { insn } {\n     \".*\" \\\n     \"Recorded 40 instructions in 16 functions \\\\\\(0 gaps\\\\\\) for .*\" \\\n     \"Replay in progress\\.  At instruction $insn\\.\" \\\n-    ]\n+    ] \"check replay at $insn\"\n }\n \n # trace the call to the test function\n-gdb_test_no_output \"record btrace\"\n-gdb_test \"next\"\n+with_test_prefix \"record\" {\n+    gdb_test_no_output \"record btrace\"\n+    gdb_test \"next\" \".*\" \"next.1\"\n+}\n \n # we start with stepping to make sure that the trace is fetched automatically\n-gdb_test \"reverse-stepi\" \".*fun4\\.5.*\"\n-gdb_test \"reverse-stepi\" \".*fun4\\.5.*\"\n+with_test_prefix \"fetch\" {\n+    gdb_test \"reverse-stepi\" \".*fun4\\.5.*\" \"reverse-stepi.1\"\n+    gdb_test \"reverse-stepi\" \".*fun4\\.5.*\" \"reverse-stepi.2\"\n \n-# let's check where we are in the trace\n-with_test_prefix \"reverse-stepi to 39\" { check_replay_at 39 }\n+    # let's check where we are in the trace\n+    check_replay_at 39\n+}\n \n # let's step forward and check again\n-gdb_test \"stepi\" \".*fun4\\.5.*\"\n-with_test_prefix \"stepi to 40\" { check_replay_at 40 }\n+with_test_prefix \"stepi\" {\n+    gdb_test \"stepi\" \".*fun4\\.5.*\"\n+    check_replay_at 40\n+}\n \n # with the next step, we stop replaying\n-gdb_test \"stepi\" \".*main\\.3.*\"\n-gdb_test \"info record\" [multi_line \\\n-  \"Active record target: record-btrace\" \\\n-  \".*\" \\\n-  \"Recorded 40 instructions in 16 functions \\\\\\(0 gaps\\\\\\) for \\[^\\\\\\r\\\\\\n\\]*\" \\\n-  ] \"stepi to live\"\n+with_test_prefix \"end\" {\n+    gdb_test \"stepi\" \".*main\\.3.*\"\n+    gdb_test \"info record\" [multi_line \\\n+      \"Active record target: record-btrace\" \\\n+      \".*\" \\\n+      \"Recorded 40 instructions in 16 functions \\\\\\(0 gaps\\\\\\) for \\[^\\\\\\r\\\\\\n\\]*\" \\\n+\t\t\t       ]\n+}\n \n # let's try nexti\n-gdb_test \"reverse-nexti\" \".*main\\.2.*\"\n-with_test_prefix \"reverse-nexti - 1\" { check_replay_at 1 }\n+with_test_prefix \"reverse-nexti.1\" {\n+    gdb_test \"reverse-nexti\" \".*main\\.2.*\"\n+    check_replay_at 1\n+}\n \n # we can't reverse-nexti any further\n-gdb_test \"reverse-nexti\" \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\"\n-with_test_prefix \"reverse-nexti - 1\" { check_replay_at 1 }\n+with_test_prefix \"reverse-nexti.2\" {\n+    gdb_test \"reverse-nexti\" \\\n+\t\"No more reverse-execution history\\.\\r\\n.*main\\.2.*\" \\\n+\t\"reverse-nexti.2\"\n+    check_replay_at 1\n+}\n \n # but we can step back again\n-gdb_test \"nexti\" \".*main\\.3.*\" \"next, 1.5\"\n-gdb_test \"info record\" [multi_line \\\n-  \"Active record target: record-btrace\" \\\n-  \".*\" \\\n-  \"Recorded 40 instructions in 16 functions \\\\\\(0 gaps\\\\\\) for \\[^\\\\\\r\\\\\\n\\]*\" \\\n-  ] \"nexti back\"\n+with_test_prefix \"nexti\" {\n+    gdb_test \"nexti\" \".*main\\.3.*\"\n+    gdb_test \"info record\" [multi_line \\\n+      \"Active record target: record-btrace\" \\\n+      \".*\" \\\n+      \"Recorded 40 instructions in 16 functions \\\\\\(0 gaps\\\\\\) for \\[^\\\\\\r\\\\\\n\\]*\" \\\n+\t\t\t       ]\n+}\n \n # let's step from a goto position somewhere in the middle\n-gdb_test \"record goto 22\" \".*fun3\\.2.*\"\n-with_test_prefix \"goto 22\" { check_replay_at 22 }\n+with_test_prefix \"goto\" {\n+    gdb_test \"record goto 22\" \".*fun3\\.2.*\"\n+    with_test_prefix \"goto 22\" { check_replay_at 22 }\n \n-gdb_test \"stepi\" \".*fun1\\.1.*\"\n-with_test_prefix \"stepi to 23\" { check_replay_at 23 }\n+    gdb_test \"stepi\" \".*fun1\\.1.*\" \"stepi.3\"\n+    with_test_prefix \"stepi to 23\" { check_replay_at 23 }\n \n-gdb_test \"reverse-stepi\" \".*fun3\\.2.*\"\n-with_test_prefix \"reverse-stepi to 22\" { check_replay_at 22 }\n+    gdb_test \"reverse-stepi\" \".*fun3\\.2.*\" \"reverse-stepi.3\"\n+    with_test_prefix \"reverse-stepi to 22\" { check_replay_at 22 }\n \n-gdb_test \"nexti\" \".*fun3\\.3.*\"\n-with_test_prefix \"nexti to 27\" { check_replay_at 27 }\n+    gdb_test \"nexti\" \".*fun3\\.3.*\"\n+    with_test_prefix \"nexti to 27\" { check_replay_at 27 }\n \n-gdb_test \"reverse-nexti\" \".*fun3\\.2.*\"\n-with_test_prefix \"reverse-nexti to 22\" { check_replay_at 22 }\n+    gdb_test \"reverse-nexti\" \".*fun3\\.2.*\" \"reverse-nexti.3\"\n+    with_test_prefix \"reverse-nexti to 22\" { check_replay_at 22 }\n+}\n \n # let's try to step off the left end\n-gdb_test \"record goto begin\" \".*main\\.2.*\"\n-with_test_prefix \"goto begin\" { check_replay_at 1 }\n-\n-gdb_test \"reverse-stepi\" \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\"\n-gdb_test \"reverse-stepi\" \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\"\n-with_test_prefix \"reverse-stepi at begin\" { check_replay_at 1 }\n-\n-gdb_test \"reverse-nexti\" \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\"\n-gdb_test \"reverse-nexti\" \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\"\n-with_test_prefix \"reverse-nexti at begin\" { check_replay_at 1 }\n-\n-# we can step forward, though\n-gdb_test \"stepi\" \".*fun4\\.1.*\"\n-with_test_prefix \"stepi to 2\" { check_replay_at 2 }\n+with_test_prefix \"goto begin\" {\n+    gdb_test \"record goto begin\" \".*main\\.2.*\"\n+    check_replay_at 1\n+\n+    with_test_prefix \"reverse-stepi\" {\n+\tgdb_test \"reverse-stepi\" \\\n+\t    \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\" \\\n+\t    \"reverse-stepi.1\"\n+\tgdb_test \"reverse-stepi\" \\\n+\t    \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\" \\\n+\t    \"reverse-stepi.2\"\n+\tcheck_replay_at 1\n+    }\n+\n+    with_test_prefix \"reverse-nexti\" {\n+\tgdb_test \"reverse-nexti\" \\\n+\t    \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\" \\\n+\t    \"reverse-nexti.1\"\n+\tgdb_test \"reverse-nexti\" \\\n+\t    \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\" \\\n+\t    \"reverse-nexti.2\"\n+\tcheck_replay_at 1\n+    }\n+\n+    # we can step forward, though\n+    with_test_prefix \"stepi\" {\n+\tgdb_test \"stepi\" \".*fun4\\.1.*\"\n+\tcheck_replay_at 2\n+    }\n+}\n \n # let's try to step off the left end again\n-gdb_test \"reverse-stepi\" \".*main\\.2.*\"\n-gdb_test \"reverse-stepi\" \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\"\n-gdb_test \"reverse-stepi\" \"No more reverse-execution history\\.\\r\\n.*main\\.2.*\"\n-with_test_prefix \"reverse-stepi at begin\" { check_replay_at 1 }\n+with_test_prefix \"reverse-stepi\" {\n+    gdb_test \"reverse-stepi\" \".*main\\.2.*\" \"reverse-stepi.1\"\n+    gdb_test \"reverse-stepi\" \\\n+\t\"No more reverse-execution history\\.\\r\\n.*main\\.2.*\" \\\n+\t\"reverse-stepi.2\"\n+    gdb_test \"reverse-stepi\" \\\n+\t\"No more reverse-execution history\\.\\r\\n.*main\\.2.*\" \\\n+\t\"reverse-stepi.3\"\n+    check_replay_at 1\n+}"
    },
    {
      "sha": "4f86a6f20889d8f4c14ff627786f556838f6a6b4",
      "filename": "gdb/testsuite/gdb.btrace/tailcall.exp",
      "status": "modified",
      "additions": 20,
      "deletions": 10,
      "changes": 30,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/tailcall.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1a1c0afcee07b7ca8f62fcad7cf357361be22ab8/gdb/testsuite/gdb.btrace/tailcall.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/tailcall.exp?ref=1a1c0afcee07b7ca8f62fcad7cf357361be22ab8",
      "patch": "@@ -93,13 +93,23 @@ gdb_test \"up\" \"#2\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:37\\r\\n.*\" \"up to main\"\n gdb_test \"down\" \"#1\\[^\\r\\n\\]*foo \\\\(\\\\) at tailcall.c:29\\r\\n.*\" \"down to foo\"\n \n # test stepping into and out of tailcalls.\n-gdb_test \"finish\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:38\\r\\n.*\"\n-gdb_test \"reverse-step\" \"\\[^\\r\\n\\]*bar \\\\(\\\\) at tailcall.c:24\\r\\n.*\"\n-gdb_test \"reverse-finish\" \"\\[^\\r\\n\\]*foo \\\\(\\\\) at tailcall.c:29\\r\\n.*\"\n-gdb_test \"reverse-step\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:37\\r\\n.*\"\n-gdb_test \"next\" \"\\[^\\r\\n\\]*38.*\"\n-gdb_test \"reverse-next\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:37\\r\\n.*\"\n-gdb_test \"step\" \"\\[^\\r\\n\\]*foo \\\\(\\\\) at tailcall.c:29\\r\\n.*\"\n-gdb_test \"finish\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:38\\r\\n.*\"\n-gdb_test \"reverse-step\" \"\\[^\\r\\n\\]*bar \\\\(\\\\) at tailcall.c:24\\r\\n.*\"\n-gdb_test \"finish\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:38\\r\\n.*\"\n+gdb_test \"finish\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:38\\r\\n.*\" \\\n+    \"finish.1\"\n+gdb_test \"reverse-step\" \"\\[^\\r\\n\\]*bar \\\\(\\\\) at tailcall.c:24\\r\\n.*\" \\\n+    \"reverse-step.1\"\n+gdb_test \"reverse-finish\" \"\\[^\\r\\n\\]*foo \\\\(\\\\) at tailcall.c:29\\r\\n.*\" \\\n+    \"reverse-finish.1\"\n+gdb_test \"reverse-step\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:37\\r\\n.*\" \\\n+    \"reverse-step.2\"\n+gdb_test \"next\" \"\\[^\\r\\n\\]*38.*\" \\\n+    \"next.1\"\n+gdb_test \"reverse-next\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:37\\r\\n.*\" \\\n+    \"reverse-next.1\"\n+gdb_test \"step\" \"\\[^\\r\\n\\]*foo \\\\(\\\\) at tailcall.c:29\\r\\n.*\" \\\n+    \"step.1\"\n+gdb_test \"finish\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:38\\r\\n.*\" \\\n+    \"finish.2\"\n+gdb_test \"reverse-step\" \"\\[^\\r\\n\\]*bar \\\\(\\\\) at tailcall.c:24\\r\\n.*\" \\\n+    \"reverse-step.3\"\n+gdb_test \"finish\" \"\\[^\\r\\n\\]*main \\\\(\\\\) at tailcall.c:38\\r\\n.*\" \\\n+    \"finish.3\""
    }
  ]
}