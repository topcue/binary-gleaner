{
  "sha": "b930964c425533f2344c6b26d4af17200bb42928",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YjkzMDk2NGM0MjU1MzNmMjM0NGM2YjI2ZDRhZjE3MjAwYmI0MjkyOA==",
  "commit": {
    "author": {
      "name": "Maciej W. Rozycki",
      "email": "macro@orcam.me.uk",
      "date": "2021-05-29T01:26:32Z"
    },
    "committer": {
      "name": "Maciej W. Rozycki",
      "email": "macro@orcam.me.uk",
      "date": "2021-05-29T01:26:32Z"
    },
    "message": "MIPS/opcodes: Disassemble the RFE instruction\n\nFix a commit b015e599c772 (\"[MIPS] Add new virtualization instructions\"),\n<https://sourceware.org/ml/binutils/2013-05/msg00118.html>, regression\nand bring the disassembly of the RFE instruction back for the relevant\nISA levels.\n\nIt is because the \"rfe\" opcode table entry was incorrectly moved behind\nthe catch-all generic \"c0\" entry for CP0 instructions, causing output\nlike:\n\n  00:\t42000010 \tc0\t0x10\n\nto be produced rather than:\n\n  00:\t42000010 \trfe\n\neven for ISA levels that do include the RFE instruction.\n\nMove the \"rfe\" entry ahead of \"c0\" then, correcting the problem.  Add a\nsuitable test case.\n\n\topcodes/\n\t* mips-opc.c (mips_builtin_opcodes): Move the \"rfe\" entry ahead\n\tof \"c0\".\n\n\tgas/\n\t* testsuite/gas/mips/rfe.d: New test.\n\t* testsuite/gas/mips/rfe.s: New test source.\n\t* testsuite/gas/mips/mips.exp: Run the new test.",
    "tree": {
      "sha": "949f69c94cfa475f597e0cd80128fb7fe13f3f6b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/949f69c94cfa475f597e0cd80128fb7fe13f3f6b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/b930964c425533f2344c6b26d4af17200bb42928",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b930964c425533f2344c6b26d4af17200bb42928",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/b930964c425533f2344c6b26d4af17200bb42928",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b930964c425533f2344c6b26d4af17200bb42928/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "21629cf8bc2b16d3c75dff0c3f1222b714bf90c2",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/21629cf8bc2b16d3c75dff0c3f1222b714bf90c2",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/21629cf8bc2b16d3c75dff0c3f1222b714bf90c2"
    }
  ],
  "stats": {
    "total": 36,
    "additions": 34,
    "deletions": 2
  },
  "files": [
    {
      "sha": "b4b6387d46fc45a21c4868e5e18c5a380ea4c864",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b930964c425533f2344c6b26d4af17200bb42928/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b930964c425533f2344c6b26d4af17200bb42928/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=b930964c425533f2344c6b26d4af17200bb42928",
      "patch": "@@ -1,3 +1,9 @@\n+2021-05-29  Maciej W. Rozycki  <macro@orcam.me.uk>\n+\n+\t* testsuite/gas/mips/rfe.d: New test.\n+\t* testsuite/gas/mips/rfe.s: New test source.\n+\t* testsuite/gas/mips/mips.exp: Run the new test.\n+\n 2021-05-29  Maciej W. Rozycki  <macro@orcam.me.uk>\n \n \t* testsuite/gas/mips/cp1-names-r3900.d: New test."
    },
    {
      "sha": "65a74dd9b67ee22e9c6ea6b0b6bbc368a8714c35",
      "filename": "gas/testsuite/gas/mips/mips.exp",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b930964c425533f2344c6b26d4af17200bb42928/gas/testsuite/gas/mips/mips.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b930964c425533f2344c6b26d4af17200bb42928/gas/testsuite/gas/mips/mips.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/mips/mips.exp?ref=b930964c425533f2344c6b26d4af17200bb42928",
      "patch": "@@ -1338,6 +1338,9 @@ if { [istarget mips*-*-vxworks*] } {\n     run_dump_test_arches \"cp0m\"\t\t[mips_arch_list_matching mips1 \\\n \t\t\t\t\t    !mips2 !micromips]\n \n+    run_dump_test_arches \"rfe\"\t\t[mips_arch_list_matching mips1 \\\n+\t\t\t\t\t    !mips3 !mips32 !micromips]\n+\n     run_dump_test \"cp1-names-numeric\"\n     run_dump_test \"cp1-names-r3000\"\n     run_dump_test \"cp1-names-r3900\""
    },
    {
      "sha": "c086e9db70281c309860ed26a181af4bfd873ed7",
      "filename": "gas/testsuite/gas/mips/rfe.d",
      "status": "added",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b930964c425533f2344c6b26d4af17200bb42928/gas/testsuite/gas/mips/rfe.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b930964c425533f2344c6b26d4af17200bb42928/gas/testsuite/gas/mips/rfe.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/mips/rfe.d?ref=b930964c425533f2344c6b26d4af17200bb42928",
      "patch": "@@ -0,0 +1,9 @@\n+#objdump: -d --prefix-addresses --show-raw-insn\n+#name: MIPS RFE instruction\n+#as: -32\n+\n+.*: +file format .*mips.*\n+\n+Disassembly of section \\.text:\n+[0-9a-f]+ <[^>]*> 42000010 \trfe\n+\t\\.\\.\\."
    },
    {
      "sha": "9094a571b93326fef993a3dba86e59e67b01d580",
      "filename": "gas/testsuite/gas/mips/rfe.s",
      "status": "added",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b930964c425533f2344c6b26d4af17200bb42928/gas/testsuite/gas/mips/rfe.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b930964c425533f2344c6b26d4af17200bb42928/gas/testsuite/gas/mips/rfe.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/mips/rfe.s?ref=b930964c425533f2344c6b26d4af17200bb42928",
      "patch": "@@ -0,0 +1,8 @@\n+\t.text\n+\t.set\tnoreorder\n+foo:\n+\trfe\n+\n+# Force some (non-delay-slot) zero bytes, to make 'objdump' print ...\n+\t.align\t4, 0\n+\t.space\t16"
    },
    {
      "sha": "2e93d56aa0c395d5ffab36122098983cd0e005c3",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b930964c425533f2344c6b26d4af17200bb42928/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b930964c425533f2344c6b26d4af17200bb42928/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=b930964c425533f2344c6b26d4af17200bb42928",
      "patch": "@@ -1,3 +1,8 @@\n+2021-05-29  Maciej W. Rozycki  <macro@orcam.me.uk>\n+\n+\t* mips-opc.c (mips_builtin_opcodes): Move the \"rfe\" entry ahead\n+\tof \"c0\".\n+\n 2021-05-29  Maciej W. Rozycki  <macro@orcam.me.uk>\n \n \t* mips-dis.c (mips_cp1_names_mips): New variable."
    },
    {
      "sha": "210d014992047cd74f3af82d58eb67599b0e71be",
      "filename": "opcodes/mips-opc.c",
      "status": "modified",
      "additions": 3,
      "deletions": 2,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b930964c425533f2344c6b26d4af17200bb42928/opcodes/mips-opc.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b930964c425533f2344c6b26d4af17200bb42928/opcodes/mips-opc.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/mips-opc.c?ref=b930964c425533f2344c6b26d4af17200bb42928",
      "patch": "@@ -3399,6 +3399,9 @@ const struct mips_opcode mips_builtin_opcodes[] =\n {\"ginvi\",\t\t\"s\",\t\t0x7c00003d, 0xfc1fffff, RD_1,\t\t\t0,\t\t0,\t\tGINV,\t0 },\n {\"ginvt\",\t\t\"s,+\\\\\",\t0x7c0000bd, 0xfc1ffcff, RD_1,\t\t\t0,\t\t0,\t\tGINV,\t0 },\n \n+/* RFE conflicts with the new Virt spec instruction tlbgp. */\n+{\"rfe\",\t\t\t\"\",\t\t0x42000010, 0xffffffff,\t0,\t\t\t0,\t\tI1|T3,\t\t0,\t0 },\n+\n /* No hazard protection on coprocessor instructions--they shouldn't\n    change the state of the processor and if they do it's up to the\n    user to put in nops as necessary.  These are at the end so that the\n@@ -3411,8 +3414,6 @@ const struct mips_opcode mips_builtin_opcodes[] =\n {\"cop1\",\t\t\"C\",\t\t0,    (int) M_COP1,\tINSN_MACRO,\t\tINSN2_M_FP_S,\tI1,\t\t0,\t0 },\n {\"cop2\",\t\t\"C\",\t\t0,    (int) M_COP2,\tINSN_MACRO,\t\t0,\t\tI1,\t\t0,\tIOCT|IOCTP|IOCT2 },\n {\"cop3\",\t\t\"C\",\t\t0,    (int) M_COP3,\tINSN_MACRO,\t\t0,\t\tI1,\t\t0,\tIOCT|IOCTP|IOCT2 },\n-/* RFE conflicts with the new Virt spec instruction tlbgp. */\n-{\"rfe\",\t\t\t\"\",\t\t0x42000010, 0xffffffff,\t0,\t\t\t0,\t\tI1|T3,\t\t0,\t0 },\n };\n \n #define MIPS_NUM_OPCODES \\"
    }
  ]
}