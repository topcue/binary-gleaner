{
  "sha": "e392bad3ec99458369723e14ded8c23b5b13073c",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZTM5MmJhZDNlYzk5NDU4MzY5NzIzZTE0ZGVkOGMyM2I1YjEzMDczYw==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-04-07T11:17:06Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-04-07T13:05:56Z"
    },
    "message": "print_insn_powerpc tidy\n\n\t* ppc-dis.c (print_insn_powerpc): Use a tiny state machine\n\top_separator to control printing of spaces, comma and parens\n\trather than need_comma, need_paren and spaces vars.",
    "tree": {
      "sha": "035857411b58a7180934f7d5ed0e85170fa3eb88",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/035857411b58a7180934f7d5ed0e85170fa3eb88"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e392bad3ec99458369723e14ded8c23b5b13073c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e392bad3ec99458369723e14ded8c23b5b13073c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e392bad3ec99458369723e14ded8c23b5b13073c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e392bad3ec99458369723e14ded8c23b5b13073c/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "dffaa15c481cea4081732d616334e24abc557fd1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/dffaa15c481cea4081732d616334e24abc557fd1",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/dffaa15c481cea4081732d616334e24abc557fd1"
    }
  ],
  "stats": {
    "total": 55,
    "additions": 29,
    "deletions": 26
  },
  "files": [
    {
      "sha": "bf775b5e3e7ad74355cd1d1f6f3c45f4c14981b2",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e392bad3ec99458369723e14ded8c23b5b13073c/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e392bad3ec99458369723e14ded8c23b5b13073c/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=e392bad3ec99458369723e14ded8c23b5b13073c",
      "patch": "@@ -1,3 +1,9 @@\n+2019-04-07  Alan Modra  <amodra@gmail.com>\n+\n+\t* ppc-dis.c (print_insn_powerpc): Use a tiny state machine\n+\top_separator to control printing of spaces, comma and parens\n+\trather than need_comma, need_paren and spaces vars.\n+\n 2019-04-07  Alan Modra  <amodra@gmail.com>\n \n \tPR 24421"
    },
    {
      "sha": "cb10b239c269ef79e1233600debe8fdcddd79129",
      "filename": "opcodes/ppc-dis.c",
      "status": "modified",
      "additions": 23,
      "deletions": 26,
      "changes": 49,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e392bad3ec99458369723e14ded8c23b5b13073c/opcodes/ppc-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e392bad3ec99458369723e14ded8c23b5b13073c/opcodes/ppc-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ppc-dis.c?ref=e392bad3ec99458369723e14ded8c23b5b13073c",
      "patch": "@@ -720,8 +720,17 @@ print_insn_powerpc (bfd_vma memaddr,\n     {\n       const unsigned char *opindex;\n       const struct powerpc_operand *operand;\n-      int need_comma;\n-      int need_paren;\n+      enum {\n+\tneed_comma = 0,\n+\tneed_1space = 1,\n+\tneed_2spaces = 2,\n+\tneed_3spaces = 3,\n+\tneed_4spaces = 4,\n+\tneed_5spaces = 5,\n+\tneed_6spaces = 6,\n+\tneed_7spaces = 7,\n+\tneed_paren\n+      } op_separator;\n       int skip_optional;\n       int spaces;\n \n@@ -732,8 +741,7 @@ print_insn_powerpc (bfd_vma memaddr,\n \tspaces = 1;\n \n       /* Now extract and print the operands.  */\n-      need_comma = 0;\n-      need_paren = 0;\n+      op_separator = spaces;\n       skip_optional = -1;\n       for (opindex = opcode->operands; *opindex != 0; opindex++)\n \t{\n@@ -754,16 +762,12 @@ print_insn_powerpc (bfd_vma memaddr,\n \n \t  value = operand_value_powerpc (operand, insn, dialect);\n \n-\t  if (spaces)\n-\t    {\n-\t      (*info->fprintf_func) (info->stream, \"%*s\", spaces, \" \");\n-\t      spaces = 0;\n-\t    }\n-\t  if (need_comma)\n-\t    {\n-\t      (*info->fprintf_func) (info->stream, \",\");\n-\t      need_comma = 0;\n-\t    }\n+\t  if (op_separator == need_comma)\n+\t    (*info->fprintf_func) (info->stream, \",\");\n+\t  else if (op_separator == need_paren)\n+\t    (*info->fprintf_func) (info->stream, \"(\");\n+\t  else\n+\t    (*info->fprintf_func) (info->stream, \"%*s\", op_separator, \" \");\n \n \t  /* Print the operand as directed by the flags.  */\n \t  if ((operand->flags & PPC_OPERAND_GPR) != 0\n@@ -808,19 +812,12 @@ print_insn_powerpc (bfd_vma memaddr,\n \t  else\n \t    (*info->fprintf_func) (info->stream, \"%\" PRId64, value);\n \n-\t  if (need_paren)\n-\t    {\n-\t      (*info->fprintf_func) (info->stream, \")\");\n-\t      need_paren = 0;\n-\t    }\n+\t  if (op_separator == need_paren)\n+\t    (*info->fprintf_func) (info->stream, \")\");\n \n-\t  if ((operand->flags & PPC_OPERAND_PARENS) == 0)\n-\t    need_comma = 1;\n-\t  else\n-\t    {\n-\t      (*info->fprintf_func) (info->stream, \"(\");\n-\t      need_paren = 1;\n-\t    }\n+\t  op_separator = need_comma;\n+\t  if ((operand->flags & PPC_OPERAND_PARENS) != 0)\n+\t    op_separator = need_paren;\n \t}\n \n       /* We have found and printed an instruction.  */"
    }
  ]
}