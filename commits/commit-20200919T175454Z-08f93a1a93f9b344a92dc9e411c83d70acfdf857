{
  "sha": "08f93a1a93f9b344a92dc9e411c83d70acfdf857",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDhmOTNhMWE5M2Y5YjM0NGE5MmRjOWU0MTFjODNkNzBhY2ZkZjg1Nw==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-09-19T17:54:49Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-09-19T17:54:54Z"
    },
    "message": "Use gdb_bfd_sections in elf_symfile_read\n\nThis changes elf_symfile_read to avoid bfd_map_over_sections, in favor\nof iteration.\n\ngdb/ChangeLog\n2020-09-19  Tom Tromey  <tom@tromey.com>\n\n\t* elfread.c (elf_locate_sections): Change parameters.\n\t(elf_symfile_read): Use foreach.",
    "tree": {
      "sha": "c63d527940947ccf43a34443f6e9e92f79c9e06b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c63d527940947ccf43a34443f6e9e92f79c9e06b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/08f93a1a93f9b344a92dc9e411c83d70acfdf857",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/08f93a1a93f9b344a92dc9e411c83d70acfdf857",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/08f93a1a93f9b344a92dc9e411c83d70acfdf857",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/08f93a1a93f9b344a92dc9e411c83d70acfdf857/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "03cd72b8107b34e7b572f9962ee589472ff1fa1e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/03cd72b8107b34e7b572f9962ee589472ff1fa1e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/03cd72b8107b34e7b572f9962ee589472ff1fa1e"
    }
  ],
  "stats": {
    "total": 15,
    "additions": 10,
    "deletions": 5
  },
  "files": [
    {
      "sha": "469b6c73f252e5309aa3552eab240cdff52fd950",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/08f93a1a93f9b344a92dc9e411c83d70acfdf857/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/08f93a1a93f9b344a92dc9e411c83d70acfdf857/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=08f93a1a93f9b344a92dc9e411c83d70acfdf857",
      "patch": "@@ -1,3 +1,8 @@\n+2020-09-19  Tom Tromey  <tom@tromey.com>\n+\n+\t* elfread.c (elf_locate_sections): Change parameters.\n+\t(elf_symfile_read): Use foreach.\n+\n 2020-09-19  Tom Tromey  <tom@tromey.com>\n \n \t* cli/cli-dump.c (struct callback_data): Remove."
    },
    {
      "sha": "5dad3ddd94041ab60d05d63d150467627df8a8f3",
      "filename": "gdb/elfread.c",
      "status": "modified",
      "additions": 5,
      "deletions": 5,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/08f93a1a93f9b344a92dc9e411c83d70acfdf857/gdb/elfread.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/08f93a1a93f9b344a92dc9e411c83d70acfdf857/gdb/elfread.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/elfread.c?ref=08f93a1a93f9b344a92dc9e411c83d70acfdf857",
      "patch": "@@ -176,11 +176,8 @@ elf_symfile_segments (bfd *abfd)\n    -kingdon).  */\n \n static void\n-elf_locate_sections (bfd *ignore_abfd, asection *sectp, void *eip)\n+elf_locate_sections (asection *sectp, struct elfinfo *ei)\n {\n-  struct elfinfo *ei;\n-\n-  ei = (struct elfinfo *) eip;\n   if (strcmp (sectp->name, \".stab\") == 0)\n     {\n       ei->stabsect = sectp;\n@@ -1211,7 +1208,10 @@ elf_symfile_read (struct objfile *objfile, symfile_add_flags symfile_flags)\n \n   memset ((char *) &ei, 0, sizeof (ei));\n   if (!(objfile->flags & OBJF_READNEVER))\n-    bfd_map_over_sections (abfd, elf_locate_sections, (void *) & ei);\n+    {\n+      for (asection *sect : gdb_bfd_sections (abfd))\n+\telf_locate_sections (sect, &ei);\n+    }\n \n   elf_read_minimal_symbols (objfile, symfile_flags, &ei);\n "
    }
  ]
}