{
  "sha": "7cb2893dfab189edce07144259db882a34e8c93b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6N2NiMjg5M2RmYWIxODllZGNlMDcxNDQyNTlkYjg4MmEzNGU4YzkzYg==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2020-11-18T19:58:43Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@efficios.com",
      "date": "2020-11-18T19:58:44Z"
    },
    "message": "gdb/testsuite: gdb.mi/mi-nonstop-exit.exp: enable non-stop using GDBFLAGS\n\nWhen running\n\n    make check TESTS=\"gdb.mi/mi-nonstop-exit.exp\" RUNTESTFLAGS=\"--target_board=native-extended-gdbserver\"\n\nWe get:\n\n    220^error,msg=\"Unexpected vCont reply in non-stop mode: T05swbreak:;06:60d5ffffff7f0000;07:d0d2ffffff7f0000;10:5b57fdf7ff7f0000;thread:p2a4eed.2a4eed;core    :4;\"^M\n    (gdb) ^M\n    UNRESOLVED: gdb.mi/mi-nonstop-exit.exp: first run: unable to start target\n\nThis is because non-stop is enabled using \"-gdb-set non-stop 1\".  This\ndoesn't work with the native-extended-gdbserver board, because with that\nboard GDB connects to GDBserver as soon as it's started.  Non-stop needs\nto be enabled before connecting.\n\nThe usual pattern to follow is to set non-stop on the command line, like\ngdb.mi/mi-nonstop.exp does.  Change the non-stop MI tests to use that\npattern.\n\nThe results diff when running gdb.mi/*.exp is:\n\n    -# of expected passes           2877\n    +# of expected passes           2938\n     # of unexpected failures       34\n     # of expected failures         8\n     # of known failures            13\n     # of unresolved testcases      4\n     # of unsupported tests         1\n    -# of duplicate test names      34\n    +# of duplicate test names      35\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.mi/mi-nonstop-exit.exp: Enable non-stop through GDBFLAGS.\n\t* gdb.mi/mi-ns-stale-regcache.exp: Likewise.\n\t* gdb.mi/mi-nsintrall.exp: Likewise.\n\t* gdb.mi/mi-nsmoribund.exp: Likewise.\n\t* gdb.mi/mi-nsthrexec.exp: Likewise.\n\t* gdb.mi/mi-watch-nonstop.exp: Likewise.\n\nChange-Id: Ic2736bedea8d448eee8c2b534d26b2427f6b4d27",
    "tree": {
      "sha": "9c6b50d053536c2242a0f66b0923913d6521aae1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/9c6b50d053536c2242a0f66b0923913d6521aae1"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/7cb2893dfab189edce07144259db882a34e8c93b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7cb2893dfab189edce07144259db882a34e8c93b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/7cb2893dfab189edce07144259db882a34e8c93b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7cb2893dfab189edce07144259db882a34e8c93b/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "cf144ec890cfdf6f0586a44ff9eee1ba73291def",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cf144ec890cfdf6f0586a44ff9eee1ba73291def",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/cf144ec890cfdf6f0586a44ff9eee1ba73291def"
    }
  ],
  "stats": {
    "total": 45,
    "additions": 33,
    "deletions": 12
  },
  "files": [
    {
      "sha": "1deb7a07ee40d1e9aafac78dad415b4cb93137c5",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=7cb2893dfab189edce07144259db882a34e8c93b",
      "patch": "@@ -1,3 +1,12 @@\n+2020-11-18  Simon Marchi  <simon.marchi@polymtl.ca>\n+\n+\t* gdb.mi/mi-nonstop-exit.exp: Enable non-stop through GDBFLAGS.\n+\t* gdb.mi/mi-ns-stale-regcache.exp: Likewise.\n+\t* gdb.mi/mi-nsintrall.exp: Likewise.\n+\t* gdb.mi/mi-nsmoribund.exp: Likewise.\n+\t* gdb.mi/mi-nsthrexec.exp: Likewise.\n+\t* gdb.mi/mi-watch-nonstop.exp: Likewise.\n+\n 2020-11-18  Simon Marchi  <simon.marchi@polymtl.ca>\n \n \t* lib/mi-support.exp (mi_run_cmd_full): Use unresovled instead"
    },
    {
      "sha": "566b11e3c1488a962020a07c91d34c9e54894d13",
      "filename": "gdb/testsuite/gdb.mi/mi-nonstop-exit.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-nonstop-exit.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-nonstop-exit.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-nonstop-exit.exp?ref=7cb2893dfab189edce07144259db882a34e8c93b",
      "patch": "@@ -31,9 +31,11 @@ if {[gdb_compile_pthreads \"$srcdir/$subdir/$srcfile\" $binfile executable $option\n     return -1\n }\n \n-mi_clean_restart $binfile\n+save_vars { GDBFLAGS } {\n+    append GDBFLAGS \" -ex \\\"set non-stop on\\\"\"\n+    mi_clean_restart $binfile\n+}\n \n-mi_gdb_test \"-gdb-set non-stop 1\" \".*\"\n mi_gdb_test \"-gdb-set mi-async 1\" \".*\"\n mi_detect_async\n "
    },
    {
      "sha": "fe0bd4850ecc5363376f0f53c322de90135a59f5",
      "filename": "gdb/testsuite/gdb.mi/mi-ns-stale-regcache.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-ns-stale-regcache.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-ns-stale-regcache.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-ns-stale-regcache.exp?ref=7cb2893dfab189edce07144259db882a34e8c93b",
      "patch": "@@ -44,9 +44,11 @@ if {[gdb_compile \"$srcdir/$subdir/$srcfile\" \\\n     return -1\n }\n \n-mi_clean_restart $binfile\n+save_vars { GDBFLAGS } {\n+    append GDBFLAGS \" -ex \\\"set non-stop on\\\"\"\n+    mi_clean_restart $binfile\n+}\n \n-mi_gdb_test \"-gdb-set non-stop 1\" \".*\"\n mi_gdb_test \"-gdb-set mi-async 1\" \".*\"\n mi_detect_async\n "
    },
    {
      "sha": "e76a9ac0abc31846f2c6c08dfbe06bdedd383d74",
      "filename": "gdb/testsuite/gdb.mi/mi-nsintrall.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-nsintrall.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-nsintrall.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-nsintrall.exp?ref=7cb2893dfab189edce07144259db882a34e8c93b",
      "patch": "@@ -31,9 +31,11 @@ if {[gdb_compile_pthreads \"$srcdir/$subdir/$srcfile\" $binfile executable $option\n     return -1\n }\n \n-mi_clean_restart $binfile\n+save_vars { GDBFLAGS } {\n+    append GDBFLAGS \" -ex \\\"set non-stop on\\\"\"\n+    mi_clean_restart $binfile\n+}\n \n-mi_gdb_test \"-gdb-set non-stop 1\" \".*\"\n mi_gdb_test \"-gdb-set mi-async 1\" \".*\"\n mi_detect_async\n "
    },
    {
      "sha": "73f1be5eea19eff141ba0a35e67dcd9229ef08a3",
      "filename": "gdb/testsuite/gdb.mi/mi-nsmoribund.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-nsmoribund.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-nsmoribund.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-nsmoribund.exp?ref=7cb2893dfab189edce07144259db882a34e8c93b",
      "patch": "@@ -31,9 +31,11 @@ if {[gdb_compile_pthreads \"$srcdir/$subdir/$srcfile\" $binfile executable $option\n     return -1\n }\n \n-mi_clean_restart $binfile\n+save_vars { GDBFLAGS } {\n+    append GDBFLAGS \" -ex \\\"set non-stop on\\\"\"\n+    mi_clean_restart $binfile\n+}\n \n-mi_gdb_test \"-gdb-set non-stop 1\" \".*\"\n mi_gdb_test \"-gdb-set mi-async 1\" \".*\"\n mi_detect_async\n "
    },
    {
      "sha": "da986394621d819ac1d7af7f3ef7bda33f7d8cd8",
      "filename": "gdb/testsuite/gdb.mi/mi-nsthrexec.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-nsthrexec.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-nsthrexec.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-nsthrexec.exp?ref=7cb2893dfab189edce07144259db882a34e8c93b",
      "patch": "@@ -36,9 +36,11 @@ if {[gdb_compile_pthreads \"$srcdir/$subdir/$srcfile\" $binfile executable $option\n     return -1\n }\n \n-mi_clean_restart $binfile\n+save_vars { GDBFLAGS } {\n+    append GDBFLAGS \" -ex \\\"set non-stop on\\\"\"\n+    mi_clean_restart $binfile\n+}\n \n-mi_gdb_test \"-gdb-set non-stop 1\" \".*\"\n mi_gdb_test \"-gdb-set mi-async 1\" \".*\"\n mi_detect_async\n "
    },
    {
      "sha": "d887fe515cb70e1dd5eab1435c2530206481fecf",
      "filename": "gdb/testsuite/gdb.mi/mi-watch-nonstop.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-watch-nonstop.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7cb2893dfab189edce07144259db882a34e8c93b/gdb/testsuite/gdb.mi/mi-watch-nonstop.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-watch-nonstop.exp?ref=7cb2893dfab189edce07144259db882a34e8c93b",
      "patch": "@@ -43,9 +43,11 @@ if {[gdb_compile \"$srcdir/$subdir/$srcfile\" $binfile executable {debug}] != \"\" }\n     return -1\n }\n \n-mi_clean_restart $binfile\n+save_vars { GDBFLAGS } {\n+    append GDBFLAGS \" -ex \\\"set non-stop on\\\"\"\n+    mi_clean_restart $binfile\n+}\n \n-mi_gdb_test \"-gdb-set non-stop 1\" \".*\"\n mi_gdb_test \"-gdb-set mi-async 1\" \".*\"\n mi_detect_async\n "
    }
  ]
}