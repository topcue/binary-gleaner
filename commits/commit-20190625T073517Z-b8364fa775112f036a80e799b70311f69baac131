{
  "sha": "b8364fa775112f036a80e799b70311f69baac131",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YjgzNjRmYTc3NTExMmYwMzZhODBlNzk5YjcwMzExZjY5YmFhYzEzMQ==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@novell.com",
      "date": "2019-06-25T07:23:48Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2019-06-25T07:35:17Z"
    },
    "message": "x86-64: also optimize ANDQ with immediate fitting in 7 bits\n\nThe same reasoning applies here as did/does for immediates fitting in\n31 bits.",
    "tree": {
      "sha": "d08fc20075de209c6f88d158e5d48cd13129a8b3",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d08fc20075de209c6f88d158e5d48cd13129a8b3"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/b8364fa775112f036a80e799b70311f69baac131",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b8364fa775112f036a80e799b70311f69baac131",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/b8364fa775112f036a80e799b70311f69baac131",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b8364fa775112f036a80e799b70311f69baac131/comments",
  "author": null,
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2a410bd1c373d377c221476ccda2156b595e6d6b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2a410bd1c373d377c221476ccda2156b595e6d6b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/2a410bd1c373d377c221476ccda2156b595e6d6b"
    }
  ],
  "stats": {
    "total": 35,
    "additions": 32,
    "deletions": 3
  },
  "files": [
    {
      "sha": "416c2be4ecb34315e212f9fe77066bcb82f6566d",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b8364fa775112f036a80e799b70311f69baac131/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b8364fa775112f036a80e799b70311f69baac131/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=b8364fa775112f036a80e799b70311f69baac131",
      "patch": "@@ -1,3 +1,11 @@\n+2019-06-25  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* config/tc-i386.c (optimize_encoding): Also handle ANDQ with\n+\timmediatie fitting in 7 bits.\n+\t* testsuite/gas/i386/x86-64-optimize-1.s: Add ANDQ cases with\n+\t7- and 8-bit immediates.\n+\t* testsuite/gas/i386/x86-64-optimize-1.d: Adjust expectations.\n+\n 2019-06-25  Jan Beulich  <jbeulich@suse.com>\n \n \t* testsuite/gas/i386/xmmword.s: Add cvtps2pi and cvttps2pi"
    },
    {
      "sha": "39857561bdee412c57558a663626b6e5c767267d",
      "filename": "gas/config/tc-i386.c",
      "status": "modified",
      "additions": 5,
      "deletions": 1,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b8364fa775112f036a80e799b70311f69baac131/gas/config/tc-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b8364fa775112f036a80e799b70311f69baac131/gas/config/tc-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.c?ref=b8364fa775112f036a80e799b70311f69baac131",
      "patch": "@@ -3948,7 +3948,10 @@ optimize_encoding (void)\n \t\t\t\t&& i.tm.extension_opcode == 0x4)\n \t\t\t    || ((i.tm.base_opcode == 0xf6\n \t\t\t\t || i.tm.base_opcode == 0xc6)\n-\t\t\t\t&& i.tm.extension_opcode == 0x0)))))\n+\t\t\t\t&& i.tm.extension_opcode == 0x0)))\n+\t\t    || (fits_in_imm7 (i.op[0].imms->X_add_number)\n+\t\t\t&& i.tm.base_opcode == 0x83\n+\t\t\t&& i.tm.extension_opcode == 0x4)))\n \t       || (i.types[0].bitfield.qword\n \t\t   && ((i.reg_operands == 2\n \t\t\t&& i.op[0].regs == i.op[1].regs\n@@ -3962,6 +3965,7 @@ optimize_encoding (void)\n     {\n       /* Optimize: -O:\n \t   andq $imm31, %r64   -> andl $imm31, %r32\n+\t   andq $imm7, %r64    -> andl $imm7, %r32\n \t   testq $imm31, %r64  -> testl $imm31, %r32\n \t   xorq %r64, %r64     -> xorl %r32, %r32\n \t   subq %r64, %r64     -> subl %r32, %r32"
    },
    {
      "sha": "aa612612fd386c667c140720a298aff178a7033f",
      "filename": "gas/testsuite/gas/i386/x86-64-optimize-1.d",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b8364fa775112f036a80e799b70311f69baac131/gas/testsuite/gas/i386/x86-64-optimize-1.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b8364fa775112f036a80e799b70311f69baac131/gas/testsuite/gas/i386/x86-64-optimize-1.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-optimize-1.d?ref=b8364fa775112f036a80e799b70311f69baac131",
      "patch": "@@ -15,6 +15,12 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t48 25 00 00 00 80    \tand    \\$0xffffffff80000000,%rax\n  +[a-f0-9]+:\t48 81 e3 00 00 00 80 \tand    \\$0xffffffff80000000,%rbx\n  +[a-f0-9]+:\t49 81 e6 00 00 00 80 \tand    \\$0xffffffff80000000,%r14\n+ +[a-f0-9]+:\t83 e0 7f             \tand    \\$0x7f,%eax\n+ +[a-f0-9]+:\t83 e3 7f             \tand    \\$0x7f,%ebx\n+ +[a-f0-9]+:\t41 83 e6 7f          \tand    \\$0x7f,%r14d\n+ +[a-f0-9]+:\t48 83 e0 80          \tand    \\$0xffffffffffffff80,%rax\n+ +[a-f0-9]+:\t48 83 e3 80          \tand    \\$0xffffffffffffff80,%rbx\n+ +[a-f0-9]+:\t49 83 e6 80          \tand    \\$0xffffffffffffff80,%r14\n  +[a-f0-9]+:\ta9 ff ff ff 7f       \ttest   \\$0x7fffffff,%eax\n  +[a-f0-9]+:\tf7 c3 ff ff ff 7f    \ttest   \\$0x7fffffff,%ebx\n  +[a-f0-9]+:\t41 f7 c6 ff ff ff 7f \ttest   \\$0x7fffffff,%r14d"
    },
    {
      "sha": "b83ecb02da0aa3b867a06ceb8e6cb1ddb2f00775",
      "filename": "gas/testsuite/gas/i386/x86-64-optimize-1.s",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b8364fa775112f036a80e799b70311f69baac131/gas/testsuite/gas/i386/x86-64-optimize-1.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b8364fa775112f036a80e799b70311f69baac131/gas/testsuite/gas/i386/x86-64-optimize-1.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-optimize-1.s?ref=b8364fa775112f036a80e799b70311f69baac131",
      "patch": "@@ -10,6 +10,12 @@ _start:\n \tandq\t$-((1<<31)), %rax\n \tandq\t$-((1<<31)), %rbx\n \tandq\t$-((1<<31)), %r14\n+\tandq\t$((1<<7) - 1), %rax\n+\tandq\t$((1<<7) - 1), %rbx\n+\tandq\t$((1<<7) - 1), %r14\n+\tandq\t$-((1<<7)), %rax\n+\tandq\t$-((1<<7)), %rbx\n+\tandq\t$-((1<<7)), %r14\n \ttestq\t$((1<<31) - 1), %rax\n \ttestq\t$((1<<31) - 1), %rbx\n \ttestq\t$((1<<31) - 1), %r14"
    },
    {
      "sha": "c4c3e9901d288c95847dbb14b28fea950170a811",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b8364fa775112f036a80e799b70311f69baac131/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b8364fa775112f036a80e799b70311f69baac131/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=b8364fa775112f036a80e799b70311f69baac131",
      "patch": "@@ -1,3 +1,8 @@\n+2019-06-25  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* i386-opc.tbl (and): Mark Imm8S form for optimization.\n+\t* i386-tbl.h: Re-generate.\n+\n 2019-06-21  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* i386-dis-evex.h: Break into ..."
    },
    {
      "sha": "b40fa8ee7fc508a1599237a258c1ec3086f78751",
      "filename": "opcodes/i386-opc.tbl",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b8364fa775112f036a80e799b70311f69baac131/opcodes/i386-opc.tbl",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b8364fa775112f036a80e799b70311f69baac131/opcodes/i386-opc.tbl",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-opc.tbl?ref=b8364fa775112f036a80e799b70311f69baac131",
      "patch": "@@ -209,7 +209,7 @@ test, 2, 0xa8, None, 1, 0, W|No_sSuf|No_ldSuf|Optimize, { Imm8|Imm16|Imm32|Imm32\n test, 2, 0xf6, 0x0, 1, 0, W|Modrm|No_sSuf|No_ldSuf|Optimize, { Imm8|Imm16|Imm32|Imm32S, Reg8|Reg16|Reg32|Reg64|Byte|Word|Dword|Qword|Unspecified|BaseIndex }\n \n and, 2, 0x20, None, 1, 0, D|W|CheckRegSize|Modrm|No_sSuf|No_ldSuf|IsLockable|HLEPrefixOk, { Reg8|Reg16|Reg32|Reg64, Reg8|Reg16|Reg32|Reg64|Byte|Word|Dword|Qword|Unspecified|BaseIndex }\n-and, 2, 0x83, 0x4, 1, 0, Modrm|No_bSuf|No_sSuf|No_ldSuf|IsLockable|HLEPrefixOk, { Imm8S, Reg16|Reg32|Reg64|Word|Dword|Qword|Unspecified|BaseIndex }\n+and, 2, 0x83, 0x4, 1, 0, Modrm|No_bSuf|No_sSuf|No_ldSuf|IsLockable|HLEPrefixOk|Optimize, { Imm8S, Reg16|Reg32|Reg64|Word|Dword|Qword|Unspecified|BaseIndex }\n and, 2, 0x24, None, 1, 0, W|No_sSuf|No_ldSuf|Optimize, { Imm8|Imm16|Imm32|Imm32S, Acc|Byte|Word|Dword|Qword }\n and, 2, 0x80, 0x4, 1, 0, W|Modrm|No_sSuf|No_ldSuf|IsLockable|HLEPrefixOk|Optimize, { Imm8|Imm16|Imm32|Imm32S, Reg8|Reg16|Reg32|Reg64|Byte|Word|Dword|Qword|Unspecified|BaseIndex }\n "
    },
    {
      "sha": "e0bd4932550ba766702ecd6d13033fc159514696",
      "filename": "opcodes/i386-tbl.h",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b8364fa775112f036a80e799b70311f69baac131/opcodes/i386-tbl.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b8364fa775112f036a80e799b70311f69baac131/opcodes/i386-tbl.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-tbl.h?ref=b8364fa775112f036a80e799b70311f69baac131",
      "patch": "@@ -1729,7 +1729,7 @@ const insn_template i386_optab[] =\n         0, 0, 0, 0, 0, 0, 0, 0, 0 } },\n     { 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0,\n       1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n-      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },\n+      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0 },\n     { { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,\n \t  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n \t  0, 0 } },"
    }
  ]
}