{
  "sha": "d1e304bc27b737e0e7daf0029dd5f1e91a4898ed",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDFlMzA0YmMyN2I3MzdlMGU3ZGFmMDAyOWRkNWYxZTkxYTQ4OThlZA==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-10-28T15:44:23Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-10-28T15:44:23Z"
    },
    "message": "Stop potential illegal memory access in the NS32K disassembler.\n\n\t* ns32k-dis.c (bit_extract): Add sanitiy check of parameters.\n\t(bit_extract_simple): Likewise.\n\t(bit_copy): Likewise.\n\t(pirnt_insn_ns32k): Ensure that uninitialised elements in the\n\tindex_offset array are not accessed.",
    "tree": {
      "sha": "6012ec739d51e5668f3249ffd9ab85c5f67630fd",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6012ec739d51e5668f3249ffd9ab85c5f67630fd"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d1e304bc27b737e0e7daf0029dd5f1e91a4898ed",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d1e304bc27b737e0e7daf0029dd5f1e91a4898ed",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d1e304bc27b737e0e7daf0029dd5f1e91a4898ed",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d1e304bc27b737e0e7daf0029dd5f1e91a4898ed/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "dee334510fe3940456bd282fc9da9ff9257d8483",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/dee334510fe3940456bd282fc9da9ff9257d8483",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/dee334510fe3940456bd282fc9da9ff9257d8483"
    }
  ],
  "stats": {
    "total": 18,
    "additions": 17,
    "deletions": 1
  },
  "files": [
    {
      "sha": "fe0f2402d7cf55186265a0c7f006c74654ee6718",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d1e304bc27b737e0e7daf0029dd5f1e91a4898ed/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d1e304bc27b737e0e7daf0029dd5f1e91a4898ed/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=d1e304bc27b737e0e7daf0029dd5f1e91a4898ed",
      "patch": "@@ -1,3 +1,11 @@\n+2019-10-28  Nick Clifton  <nickc@redhat.com>\n+\n+\t* ns32k-dis.c (bit_extract): Add sanitiy check of parameters.\n+\t(bit_extract_simple): Likewise.\n+\t(bit_copy): Likewise.\n+\t(pirnt_insn_ns32k): Ensure that uninitialised elements in the\n+\tindex_offset array are not accessed.\n+\n 2019-10-28  Nick Clifton  <nickc@redhat.com>\n \n \t* xgate-dis.c (print_insn): Fix decoding of the XGATE_OP_DYA"
    },
    {
      "sha": "22a9389ecff2dee701885b045e063c9c5b4fdb2a",
      "filename": "opcodes/ns32k-dis.c",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d1e304bc27b737e0e7daf0029dd5f1e91a4898ed/opcodes/ns32k-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d1e304bc27b737e0e7daf0029dd5f1e91a4898ed/opcodes/ns32k-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ns32k-dis.c?ref=d1e304bc27b737e0e7daf0029dd5f1e91a4898ed",
      "patch": "@@ -265,6 +265,8 @@ bit_extract (bfd_byte *buffer, int offset, int count)\n   int result;\n   int bit;\n \n+  if (offset < 0 || count < 0)\n+    return 0;\n   buffer += offset >> 3;\n   offset &= 7;\n   bit = 1;\n@@ -292,6 +294,8 @@ bit_extract_simple (bfd_byte *buffer, int offset, int count)\n   int result;\n   int bit;\n \n+  if (offset < 0 || count < 0)\n+    return 0;\n   buffer += offset >> 3;\n   offset &= 7;\n   bit = 1;\n@@ -313,6 +317,8 @@ bit_extract_simple (bfd_byte *buffer, int offset, int count)\n static void\n bit_copy (bfd_byte *buffer, int offset, int count, char *to)\n {\n+  if (offset < 0 || count < 0)\n+    return;\n   for (; count > 8; count -= 8, to++, offset += 8)\n     *to = bit_extract (buffer, offset, 8);\n   *to = bit_extract (buffer, offset, count);\n@@ -836,8 +842,10 @@ print_insn_ns32k (bfd_vma memaddr, disassemble_info *info)\n \t\t\t\t    memaddr, arg_bufs[argnum],\n \t\t\t\t    index_offset[whicharg]);\n \t  d++;\n-\t  whicharg++;\n+\t  if (whicharg++ >= 1)\n+\t    break;\n \t}\n+\n       for (argnum = 0; argnum <= maxarg; argnum++)\n \t{\n \t  bfd_vma addr;"
    }
  ]
}