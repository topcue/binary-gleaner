{
  "sha": "15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTVmMThkMTQ2N2FhMDhmZjdhNDc5M2YyMWUwMmZkNGMyZWJjMGEwYg==",
  "commit": {
    "author": {
      "name": "Ali Tamur",
      "email": "tamur@google.com",
      "date": "2019-04-25T20:35:53Z"
    },
    "committer": {
      "name": "Ali Tamur",
      "email": "tamur@google.com",
      "date": "2019-04-30T23:18:52Z"
    },
    "message": "Support DW_FORM_strx1, _strx2, _strx3, _strx4 forms.\n\nDwarf5 defines DW_FORM_strx1 and others, which are similar\nto DW_FORM_strx but uses 1-4 bytes unsigned integers. This is\na small step towards supporting dwarf5 in gdb.",
    "tree": {
      "sha": "7eecec663f0e4b5f15f095a552588393b1ffe7bb",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/7eecec663f0e4b5f15f095a552588393b1ffe7bb"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/comments",
  "author": {
    "login": "alitamur",
    "id": 59383390,
    "node_id": "MDQ6VXNlcjU5MzgzMzkw",
    "avatar_url": "https://avatars.githubusercontent.com/u/59383390?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alitamur",
    "html_url": "https://github.com/alitamur",
    "followers_url": "https://api.github.com/users/alitamur/followers",
    "following_url": "https://api.github.com/users/alitamur/following{/other_user}",
    "gists_url": "https://api.github.com/users/alitamur/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alitamur/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alitamur/subscriptions",
    "organizations_url": "https://api.github.com/users/alitamur/orgs",
    "repos_url": "https://api.github.com/users/alitamur/repos",
    "events_url": "https://api.github.com/users/alitamur/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alitamur/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "alitamur",
    "id": 59383390,
    "node_id": "MDQ6VXNlcjU5MzgzMzkw",
    "avatar_url": "https://avatars.githubusercontent.com/u/59383390?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alitamur",
    "html_url": "https://github.com/alitamur",
    "followers_url": "https://api.github.com/users/alitamur/followers",
    "following_url": "https://api.github.com/users/alitamur/following{/other_user}",
    "gists_url": "https://api.github.com/users/alitamur/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alitamur/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alitamur/subscriptions",
    "organizations_url": "https://api.github.com/users/alitamur/orgs",
    "repos_url": "https://api.github.com/users/alitamur/repos",
    "events_url": "https://api.github.com/users/alitamur/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alitamur/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ab4ee6147eb2e8fafd1fb96c945029c789182d3b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ab4ee6147eb2e8fafd1fb96c945029c789182d3b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/ab4ee6147eb2e8fafd1fb96c945029c789182d3b"
    }
  ],
  "stats": {
    "total": 63,
    "additions": 59,
    "deletions": 4
  },
  "files": [
    {
      "sha": "fdbcb67fe78c9a7cbc4d61544c07192465598e4f",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b",
      "patch": "@@ -1,3 +1,8 @@\n+2019-04-30  Ali Tamur  <tamur@google.com>\n+\t* gdb/dwarf2read.c (read_3_bytes): New declaration.\n+\t(read_attribute_value): Added DW_FORM_strx1-4 cases.\n+\t(read_3_bytes): New function.\n+\n 2019-04-30  Joel Brobecker  <brobecker@adacore.com>\n \n \t* windows-nat.c (main_thread_id): Delete."
    },
    {
      "sha": "b0bdecf96fc8cc289aaf8953f67d1610da39b266",
      "filename": "gdb/dwarf2read.c",
      "status": "modified",
      "additions": 46,
      "deletions": 4,
      "changes": 50,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/gdb/dwarf2read.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/gdb/dwarf2read.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/dwarf2read.c?ref=15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b",
      "patch": "@@ -1531,6 +1531,9 @@ static int read_1_signed_byte (bfd *, const gdb_byte *);\n \n static unsigned int read_2_bytes (bfd *, const gdb_byte *);\n \n+/* Read the next three bytes (little-endian order) as an unsigned integer.  */\n+static unsigned int read_3_bytes (bfd *, const gdb_byte *);\n+\n static unsigned int read_4_bytes (bfd *, const gdb_byte *);\n \n static ULONGEST read_8_bytes (bfd *, const gdb_byte *);\n@@ -19330,6 +19333,10 @@ read_attribute_value (const struct die_reader_specs *reader,\n       info_ptr += bytes_read;\n       break;\n     case DW_FORM_strx:\n+    case DW_FORM_strx1:\n+    case DW_FORM_strx2:\n+    case DW_FORM_strx3:\n+    case DW_FORM_strx4:\n     case DW_FORM_GNU_str_index:\n       if (reader->dwo_file == NULL)\n \t{\n@@ -19340,12 +19347,34 @@ read_attribute_value (const struct die_reader_specs *reader,\n \t\t bfd_get_filename (abfd));\n \t}\n       {\n-\tULONGEST str_index =\n-\t  read_unsigned_leb128 (abfd, info_ptr, &bytes_read);\n-\n+\tULONGEST str_index;\n+\tif (form == DW_FORM_strx1)\n+\t  {\n+\t    str_index = read_1_byte (abfd, info_ptr);\n+\t    info_ptr += 1;\n+\t  }\n+\telse if (form == DW_FORM_strx2)\n+\t  {\n+\t    str_index = read_2_bytes (abfd, info_ptr);\n+\t    info_ptr += 2;\n+\t  }\n+\telse if (form == DW_FORM_strx3)\n+\t  {\n+\t    str_index = read_3_bytes (abfd, info_ptr);\n+\t    info_ptr += 3;\n+\t  }\n+\telse if (form == DW_FORM_strx4)\n+\t  {\n+\t    str_index = read_4_bytes (abfd, info_ptr);\n+\t    info_ptr += 4;\n+\t  }\n+\telse\n+\t  {\n+\t    str_index = read_unsigned_leb128 (abfd, info_ptr, &bytes_read);\n+\t    info_ptr += bytes_read;\n+\t  }\n \tDW_STRING (attr) = read_str_index (reader, str_index);\n \tDW_STRING_IS_CANONICAL (attr) = 0;\n-\tinfo_ptr += bytes_read;\n       }\n       break;\n     default:\n@@ -19415,6 +19444,19 @@ read_2_signed_bytes (bfd *abfd, const gdb_byte *buf)\n   return bfd_get_signed_16 (abfd, buf);\n }\n \n+static unsigned int\n+read_3_bytes (bfd *abfd, const gdb_byte *buf)\n+{\n+  unsigned int result = 0;\n+  for (int i = 0; i < 3; ++i)\n+    {\n+      unsigned char byte = bfd_get_8 (abfd, buf);\n+      buf++;\n+      result |= ((unsigned int) byte << (i * 8));\n+    }\n+  return result;\n+}\n+\n static unsigned int\n read_4_bytes (bfd *abfd, const gdb_byte *buf)\n {"
    },
    {
      "sha": "fa1f567ad4ea3213946266abea1d5ddf09bcb0a6",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b",
      "patch": "@@ -1,3 +1,7 @@\n+2019-04-30  Ali Tamur  <tamur@google.com>\n+\n+\t* lib/dwarf.exp(): Added DW_FORM_strx1-4.\n+\n 2019-04-30  Tom Tromey  <tromey@adacore.com>\n \n \t* lib/ada.exp (find_ada_tool): New proc."
    },
    {
      "sha": "3cc592890cff88b58d341854f2e9a845b630b894",
      "filename": "gdb/testsuite/lib/dwarf.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/gdb/testsuite/lib/dwarf.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b/gdb/testsuite/lib/dwarf.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/dwarf.exp?ref=15f18d1467aa08ff7a4793f21e02fd4c2ebc0a0b",
      "patch": "@@ -528,6 +528,10 @@ namespace eval Dwarf {\n \t    DW_FORM_exprloc -\n \n \t    DW_FORM_strx -\n+\t    DW_FORM_strx1 -\n+\t    DW_FORM_strx2 -\n+\t    DW_FORM_strx3 -\n+\t    DW_FORM_strx4 -\n \n \t    DW_FORM_GNU_addr_index -\n \t    DW_FORM_GNU_str_index -"
    }
  ]
}