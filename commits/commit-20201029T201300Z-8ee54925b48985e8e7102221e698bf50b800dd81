{
  "sha": "8ee54925b48985e8e7102221e698bf50b800dd81",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OGVlNTQ5MjViNDg5ODVlOGU3MTAyMjIxZTY5OGJmNTBiODAwZGQ4MQ==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-10-29T20:13:00Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-10-29T20:13:00Z"
    },
    "message": "Fix an illegal memory access problem when processing secondary relocs for architectures which support both REL and RELA relocs.\n\n\tPR 26809\n\t* elf.c (_bfd_elf_slurp_secondary_reloc_section): Use the correct\n\tsized reloc reading function.\n\t(_bfd_elf_write_secondary_reloc_section): Use the correct sized\n\treloc writing function.",
    "tree": {
      "sha": "dad87ab9244a95bd369be61ec8a6f359837b49a7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/dad87ab9244a95bd369be61ec8a6f359837b49a7"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/8ee54925b48985e8e7102221e698bf50b800dd81",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8ee54925b48985e8e7102221e698bf50b800dd81",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/8ee54925b48985e8e7102221e698bf50b800dd81",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8ee54925b48985e8e7102221e698bf50b800dd81/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "59d5613e42589c6515a0bfe9baae522f164d20fa",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/59d5613e42589c6515a0bfe9baae522f164d20fa",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/59d5613e42589c6515a0bfe9baae522f164d20fa"
    }
  ],
  "stats": {
    "total": 38,
    "additions": 33,
    "deletions": 5
  },
  "files": [
    {
      "sha": "24a81c89ab29bec3898684a4e9a6e9cf8c69bf6d",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8ee54925b48985e8e7102221e698bf50b800dd81/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8ee54925b48985e8e7102221e698bf50b800dd81/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=8ee54925b48985e8e7102221e698bf50b800dd81",
      "patch": "@@ -1,3 +1,11 @@\n+2020-10-29  Nick Clifton  <nickc@redhat.com>\n+\n+\tPR 26809\n+\t* elf.c (_bfd_elf_slurp_secondary_reloc_section): Use the correct\n+\tsized reloc reading function.\n+\t(_bfd_elf_write_secondary_reloc_section): Use the correct sized\n+\treloc writing function.\n+\n 2020-10-28  Nick Clifton  <nickc@redhat.com>\n \n \tPR 26774"
    },
    {
      "sha": "549f661b9d83d3bc36b27e0ede98f58192f9b259",
      "filename": "bfd/elf.c",
      "status": "modified",
      "additions": 25,
      "deletions": 5,
      "changes": 30,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8ee54925b48985e8e7102221e698bf50b800dd81/bfd/elf.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8ee54925b48985e8e7102221e698bf50b800dd81/bfd/elf.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf.c?ref=8ee54925b48985e8e7102221e698bf50b800dd81",
      "patch": "@@ -12632,7 +12632,10 @@ _bfd_elf_slurp_secondary_reloc_section (bfd *      abfd,\n \t      bfd_boolean res;\n \t      Elf_Internal_Rela rela;\n \n-\t      ebd->s->swap_reloca_in (abfd, native_reloc, & rela);\n+\t      if (entsize == ebd->s->sizeof_rel)\n+\t\tebd->s->swap_reloc_in (abfd, native_reloc, & rela);\n+\t      else /* entsize == ebd->s->sizeof_rela */\n+\t\tebd->s->swap_reloca_in (abfd, native_reloc, & rela);\n \n \t      /* The address of an ELF reloc is section relative for an object\n \t\t file, and absolute for an executable file or shared library.\n@@ -12823,6 +12826,7 @@ _bfd_elf_write_secondary_reloc_section (bfd *abfd, asection *sec)\n \t  int          last_sym_idx;\n \t  unsigned int reloc_count;\n \t  unsigned int idx;\n+\t  unsigned int entsize;\n \t  arelent *    src_irel;\n \t  bfd_byte *   dst_rela;\n \n@@ -12837,7 +12841,8 @@ _bfd_elf_write_secondary_reloc_section (bfd *abfd, asection *sec)\n \t      continue;\n \t    }\n \n-\t  if (hdr->sh_entsize == 0)\n+\t  entsize = hdr->sh_entsize;\n+\t  if (entsize == 0)\n \t    {\n \t      _bfd_error_handler\n \t\t/* xgettext:c-format */\n@@ -12847,8 +12852,19 @@ _bfd_elf_write_secondary_reloc_section (bfd *abfd, asection *sec)\n \t      result = FALSE;\n \t      continue;\n \t    }\n+\t  else if (entsize != ebd->s->sizeof_rel\n+\t\t   && entsize != ebd->s->sizeof_rela)\n+\t    {\n+\t      _bfd_error_handler\n+\t\t/* xgettext:c-format */\n+\t\t(_(\"%pB(%pA): error: secondary reloc section has non-standard sized entries\"),\n+\t\t abfd, relsec);\n+\t      bfd_set_error (bfd_error_bad_value);\n+\t      result = FALSE;\n+\t      continue;\n+\t    }\n \n-\t  reloc_count = hdr->sh_size / hdr->sh_entsize;\n+\t  reloc_count = hdr->sh_size / entsize;\n \t  if (reloc_count <= 0)\n \t    {\n \t      _bfd_error_handler\n@@ -12883,7 +12899,7 @@ _bfd_elf_write_secondary_reloc_section (bfd *abfd, asection *sec)\n \t      continue;\n \t    }\n \n-\t  for (idx = 0; idx < reloc_count; idx++, dst_rela += hdr->sh_entsize)\n+\t  for (idx = 0; idx < reloc_count; idx++, dst_rela += entsize)\n \t    {\n \t      Elf_Internal_Rela src_rela;\n \t      arelent *ptr;\n@@ -12959,7 +12975,11 @@ _bfd_elf_write_secondary_reloc_section (bfd *abfd, asection *sec)\n \t      else\n \t\tsrc_rela.r_info = r_info (n, ptr->howto->type);\n \t      src_rela.r_addend = ptr->addend;\n-\t      ebd->s->swap_reloca_out (abfd, &src_rela, dst_rela);\n+\n+\t      if (entsize == ebd->s->sizeof_rel)\n+\t\tebd->s->swap_reloc_out (abfd, &src_rela, dst_rela);\n+\t      else /* entsize == ebd->s->sizeof_rela */\n+\t\tebd->s->swap_reloca_out (abfd, &src_rela, dst_rela);\n \t    }\n \t}\n     }"
    }
  ]
}