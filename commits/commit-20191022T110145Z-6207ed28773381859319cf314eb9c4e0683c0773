{
  "sha": "6207ed28773381859319cf314eb9c4e0683c0773",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NjIwN2VkMjg3NzMzODE4NTkzMTljZjMxNGViOWM0ZTA2ODNjMDc3Mw==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-10-22T11:01:45Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-10-22T11:01:45Z"
    },
    "message": "Prevent more potential illegal memory accesses in the RX disassembler.\n\n\t* rx-dis.c (get_size_name): New function.  Provides safe\n\taccess to name array.\n\t(get_opsize_name): Likewise.\n\t(print_insn_rx): Use the accessor functions.",
    "tree": {
      "sha": "537704b94393d233e4268de7bee4c42cf049491d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/537704b94393d233e4268de7bee4c42cf049491d"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/6207ed28773381859319cf314eb9c4e0683c0773",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6207ed28773381859319cf314eb9c4e0683c0773",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/6207ed28773381859319cf314eb9c4e0683c0773",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6207ed28773381859319cf314eb9c4e0683c0773/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ef0cc92e9cd7a589e441389167a8d4fb2fe46367",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ef0cc92e9cd7a589e441389167a8d4fb2fe46367",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/ef0cc92e9cd7a589e441389167a8d4fb2fe46367"
    }
  ],
  "stats": {
    "total": 57,
    "additions": 41,
    "deletions": 16
  },
  "files": [
    {
      "sha": "e53e95c652448a01d67199f90713d49f342ca83b",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6207ed28773381859319cf314eb9c4e0683c0773/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6207ed28773381859319cf314eb9c4e0683c0773/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=6207ed28773381859319cf314eb9c4e0683c0773",
      "patch": "@@ -1,3 +1,10 @@\n+2019-10-22  Nick Clifton  <nickc@redhat.com>\n+\n+\t* rx-dis.c (get_size_name): New function.  Provides safe\n+\taccess to name array.\n+\t(get_opsize_name): Likewise.\n+\t(print_insn_rx): Use the accessor functions.\n+\n 2019-10-16  Nick Clifton  <nickc@redhat.com>\n \n \t* rx-dis.c (get_register_name): New function.  Provides safe"
    },
    {
      "sha": "8d5ee87bb7fba1ba4dabd1529291a8286eb897cf",
      "filename": "opcodes/rx-dis.c",
      "status": "modified",
      "additions": 34,
      "deletions": 16,
      "changes": 50,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6207ed28773381859319cf314eb9c4e0683c0773/opcodes/rx-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6207ed28773381859319cf314eb9c4e0683c0773/opcodes/rx-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/rx-dis.c?ref=6207ed28773381859319cf314eb9c4e0683c0773",
      "patch": "@@ -195,6 +195,22 @@ get_double_condition_name (unsigned int cond)\n   return _(\"<inavlid condition code>\");\n }\n \n+static inline const char *\n+get_opsize_name (unsigned int opsize)\n+{\n+  if (opsize < ARRAY_SIZE (opsize_names))\n+    return opsize_names[opsize];\n+  return _(\"<inavlid opsize>\");\n+}\n+\n+static inline const char *\n+get_size_name (unsigned int size)\n+{\n+  if (size < ARRAY_SIZE (size_names))\n+    return size_names[size];\n+  return _(\"<inavlid size>\");\n+}\n+\n \n int\n print_insn_rx (bfd_vma addr, disassemble_info * dis)\n@@ -278,25 +294,27 @@ print_insn_rx (bfd_vma addr, disassemble_info * dis)\n \t      break;\n \n \t    case 's':\n-\t      PR (PS, \"%s\", opsize_names[opcode.size]);\n+\t      PR (PS, \"%s\", get_opsize_name (opcode.size));\n \t      break;\n \n \t    case 'b':\n \t      s ++;\n-\t      if (*s == 'f') {\n-\t\tint imm = opcode.op[2].addend;\n-\t\tint slsb, dlsb, width;\n-\t\tdlsb = (imm >> 5) & 0x1f;\n-\t\tslsb = (imm & 0x1f);\n-\t\tslsb = (slsb >= 0x10?(slsb ^ 0x1f) + 1:slsb);\n-\t\tslsb = dlsb - slsb;\n-\t\tslsb = (slsb < 0?-slsb:slsb);\n-\t\twidth = ((imm >> 10) & 0x1f) - dlsb;\n-\t\tPR (PS, \"#%d, #%d, #%d, %s, %s\",\n-\t\t    slsb, dlsb, width,\n-\t\t    register_names[opcode.op[1].reg],\n-\t\t    register_names[opcode.op[0].reg]);\n-\t      }\n+\t      if (*s == 'f')\n+\t\t{\n+\t\t  int imm = opcode.op[2].addend;\n+\t\t  int slsb, dlsb, width;\n+\n+\t\t  dlsb = (imm >> 5) & 0x1f;\n+\t\t  slsb = (imm & 0x1f);\n+\t\t  slsb = (slsb >= 0x10?(slsb ^ 0x1f) + 1:slsb);\n+\t\t  slsb = dlsb - slsb;\n+\t\t  slsb = (slsb < 0?-slsb:slsb);\n+\t\t  width = ((imm >> 10) & 0x1f) - dlsb;\n+\t\t  PR (PS, \"#%d, #%d, #%d, %s, %s\",\n+\t\t      slsb, dlsb, width,\n+\t\t      get_register_name (opcode.op[1].reg),\n+\t\t      get_register_name (opcode.op[0].reg));\n+\t\t}\n \t      break;\n \t    case '0':\n \t    case '1':\n@@ -305,7 +323,7 @@ print_insn_rx (bfd_vma addr, disassemble_info * dis)\n \t      if (do_size)\n \t\t{\n \t\t  if (oper->type == RX_Operand_Indirect || oper->type == RX_Operand_Zero_Indirect)\n-\t\t    PR (PS, \"%s\", size_names[oper->size]);\n+\t\t    PR (PS, \"%s\", get_size_name (oper->size));\n \t\t}\n \t      else\n \t\tswitch (oper->type)"
    }
  ]
}