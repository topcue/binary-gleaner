{
  "sha": "05a6b8c28baad097147eb06329ce3be940682aa9",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDVhNmI4YzI4YmFhZDA5NzE0N2ViMDYzMjljZTNiZTk0MDY4MmFhOQ==",
  "commit": {
    "author": {
      "name": "Eli Zaretskii",
      "email": "eliz@gnu.org",
      "date": "2020-07-26T16:35:48Z"
    },
    "committer": {
      "name": "Eli Zaretskii",
      "email": "eliz@gnu.org",
      "date": "2020-07-26T16:35:48Z"
    },
    "message": "Don't unnecessarily redefine 'socklen_t' type in MinGW builds.\n\nThe original configure-time tests in gdb/ and gdbserver/ failed to\ndetect that 'socklen_t' is defined in MinGW headers because the test\nprogram included only sys/socket.h, which is absent in MinGW system\nheaders.  However on MS-Windows this data type is declared in another\nheader, ws2tcpip.h.  The modified test programs try using ws2tcpip.h\nif sys/socket.h is unavailable.\n\nThanks to Joel Brobecker who helped me regenerate the configure\nscripts and the config.in files.\n\ngdb/ChangeLog:\n2020-07-26  Eli Zaretskii  <eliz@gnu.org>\n\n\t* configure.ac (AC_CHECK_HEADERS): Check for sys/socket.h and\n\tws2tcpip.h.  When checking whether socklen_t type is defined, use\n\tws2tcpip.h if it is available and sys/socket.h isn't.\n\t* configure: Regenerate.\n\t* config.in: Regenerate.\n\ngdbserver/ChangeLog:\n2020-07-26  Eli Zaretskii  <eliz@gnu.org>\n\n\t* configure.ac (AC_CHECK_HEADERS): Add ws2tcpip.h.\n\tWhen checking whether socklen_t type is defined, use ws2tcpip.h if\n\tit is available and sys/socket.h isn't.\n\t* configure: Regenerate.\n\t* config.in: Regenerate.",
    "tree": {
      "sha": "09c28fe9a94587458ab279827dd076028252ad1f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/09c28fe9a94587458ab279827dd076028252ad1f"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/05a6b8c28baad097147eb06329ce3be940682aa9",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/05a6b8c28baad097147eb06329ce3be940682aa9",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/05a6b8c28baad097147eb06329ce3be940682aa9",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/05a6b8c28baad097147eb06329ce3be940682aa9/comments",
  "author": {
    "login": "Eli-Zaretskii",
    "id": 20908835,
    "node_id": "MDQ6VXNlcjIwOTA4ODM1",
    "avatar_url": "https://avatars.githubusercontent.com/u/20908835?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Eli-Zaretskii",
    "html_url": "https://github.com/Eli-Zaretskii",
    "followers_url": "https://api.github.com/users/Eli-Zaretskii/followers",
    "following_url": "https://api.github.com/users/Eli-Zaretskii/following{/other_user}",
    "gists_url": "https://api.github.com/users/Eli-Zaretskii/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Eli-Zaretskii/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Eli-Zaretskii/subscriptions",
    "organizations_url": "https://api.github.com/users/Eli-Zaretskii/orgs",
    "repos_url": "https://api.github.com/users/Eli-Zaretskii/repos",
    "events_url": "https://api.github.com/users/Eli-Zaretskii/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Eli-Zaretskii/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "Eli-Zaretskii",
    "id": 20908835,
    "node_id": "MDQ6VXNlcjIwOTA4ODM1",
    "avatar_url": "https://avatars.githubusercontent.com/u/20908835?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Eli-Zaretskii",
    "html_url": "https://github.com/Eli-Zaretskii",
    "followers_url": "https://api.github.com/users/Eli-Zaretskii/followers",
    "following_url": "https://api.github.com/users/Eli-Zaretskii/following{/other_user}",
    "gists_url": "https://api.github.com/users/Eli-Zaretskii/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Eli-Zaretskii/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Eli-Zaretskii/subscriptions",
    "organizations_url": "https://api.github.com/users/Eli-Zaretskii/orgs",
    "repos_url": "https://api.github.com/users/Eli-Zaretskii/repos",
    "events_url": "https://api.github.com/users/Eli-Zaretskii/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Eli-Zaretskii/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "3abf97582679343f1708252712e9254d3e0f132c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3abf97582679343f1708252712e9254d3e0f132c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/3abf97582679343f1708252712e9254d3e0f132c"
    }
  ],
  "stats": {
    "total": 81,
    "additions": 75,
    "deletions": 6
  },
  "files": [
    {
      "sha": "c8af86bfcaa741820ff28760f7302cf0269098b4",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05a6b8c28baad097147eb06329ce3be940682aa9/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05a6b8c28baad097147eb06329ce3be940682aa9/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=05a6b8c28baad097147eb06329ce3be940682aa9",
      "patch": "@@ -1,3 +1,11 @@\n+2020-07-26  Eli Zaretskii  <eliz@gnu.org>\n+\n+\t* configure.ac (AC_CHECK_HEADERS): Check for sys/socket.h and\n+\tws2tcpip.h.  When checking whether socklen_t type is defined, use\n+\tws2tcpip.h if it is available and sys/socket.h isn't.\n+\t* configure: Regenerate.\n+\t* config.in: Regenerate.\n+\n 2020-07-25  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \tPR fortran/23051"
    },
    {
      "sha": "26053475db92729e48525d12497eea994bc86de5",
      "filename": "gdb/config.in",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05a6b8c28baad097147eb06329ce3be940682aa9/gdb/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05a6b8c28baad097147eb06329ce3be940682aa9/gdb/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/config.in?ref=05a6b8c28baad097147eb06329ce3be940682aa9",
      "patch": "@@ -505,6 +505,9 @@\n /* Define to 1 if you have the <sys/select.h> header file. */\n #undef HAVE_SYS_SELECT_H\n \n+/* Define to 1 if you have the <sys/sockets.h> header file. */\n+#undef HAVE_SYS_SOCKETS_H\n+\n /* Define to 1 if you have the <sys/socket.h> header file. */\n #undef HAVE_SYS_SOCKET_H\n \n@@ -568,6 +571,9 @@\n /* Define to 1 if you have the `wresize' function. */\n #undef HAVE_WRESIZE\n \n+/* Define to 1 if you have the <ws2tcpip.h> header file. */\n+#undef HAVE_WS2TCPIP_H\n+\n /* Define to 1 if you have the `XML_StopParser' function. */\n #undef HAVE_XML_STOPPARSER\n "
    },
    {
      "sha": "c9a4b42ea12c744043a22b521377e5b7cf871bbd",
      "filename": "gdb/configure",
      "status": "modified",
      "additions": 30,
      "deletions": 1,
      "changes": 31,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05a6b8c28baad097147eb06329ce3be940682aa9/gdb/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05a6b8c28baad097147eb06329ce3be940682aa9/gdb/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure?ref=05a6b8c28baad097147eb06329ce3be940682aa9",
      "patch": "@@ -11844,6 +11844,31 @@ fi\n done\n \n \n+for ac_header in sys/sockets.h\n+do :\n+  ac_fn_c_check_header_mongrel \"$LINENO\" \"sys/sockets.h\" \"ac_cv_header_sys_sockets_h\" \"$ac_includes_default\"\n+if test \"x$ac_cv_header_sys_sockets_h\" = xyes; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_SYS_SOCKETS_H 1\n+_ACEOF\n+\n+fi\n+\n+done\n+\n+for ac_header in ws2tcpip.h\n+do :\n+  ac_fn_c_check_header_mongrel \"$LINENO\" \"ws2tcpip.h\" \"ac_cv_header_ws2tcpip_h\" \"$ac_includes_default\"\n+if test \"x$ac_cv_header_ws2tcpip_h\" = xyes; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_WS2TCPIP_H 1\n+_ACEOF\n+\n+fi\n+\n+done\n+\n+\n # ------------------------- #\n # Checks for declarations.  #\n # ------------------------- #\n@@ -12059,7 +12084,11 @@ $as_echo \"#define HAVE_LC_MESSAGES 1\" >>confdefs.h\n # ------------------ #\n \n ac_fn_c_check_type \"$LINENO\" \"socklen_t\" \"ac_cv_type_socklen_t\" \"#include <sys/types.h>\n-#include <sys/socket.h>\n+#if HAVE_SYS_SOCKET_H\n+# include <sys/socket.h>\n+#elif HAVE_WS2TCPIP_H\n+# include <ws2tcpip.h>\n+#endif\n \n \"\n if test \"x$ac_cv_type_socklen_t\" = xyes; then :"
    },
    {
      "sha": "3bec21560e75e43d3106f035df0dfd3f191c8ec9",
      "filename": "gdb/configure.ac",
      "status": "modified",
      "additions": 8,
      "deletions": 1,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05a6b8c28baad097147eb06329ce3be940682aa9/gdb/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05a6b8c28baad097147eb06329ce3be940682aa9/gdb/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure.ac?ref=05a6b8c28baad097147eb06329ce3be940682aa9",
      "patch": "@@ -1248,6 +1248,9 @@ AC_CHECK_HEADERS(term.h, [], [],\n #endif\n ])\n \n+AC_CHECK_HEADERS([sys/sockets.h])\n+AC_CHECK_HEADERS([ws2tcpip.h])\n+\n # ------------------------- #\n # Checks for declarations.  #\n # ------------------------- #\n@@ -1263,7 +1266,11 @@ AM_LC_MESSAGES\n \n AC_CHECK_TYPES(socklen_t, [], [],\n [#include <sys/types.h>\n-#include <sys/socket.h>\n+#if HAVE_SYS_SOCKET_H\n+# include <sys/socket.h>\n+#elif HAVE_WS2TCPIP_H\n+# include <ws2tcpip.h>\n+#endif\n ])\n \n # ------------------------------------- #"
    },
    {
      "sha": "ee80fce4c1f486e5cc0c68934aff713550d47f5e",
      "filename": "gdbserver/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05a6b8c28baad097147eb06329ce3be940682aa9/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05a6b8c28baad097147eb06329ce3be940682aa9/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/ChangeLog?ref=05a6b8c28baad097147eb06329ce3be940682aa9",
      "patch": "@@ -1,3 +1,11 @@\n+2020-07-26  Eli Zaretskii  <eliz@gnu.org>\n+\n+\t* configure.ac (AC_CHECK_HEADERS): Add ws2tcpip.h.\n+\tWhen checking whether socklen_t type is defined, use ws2tcpip.h if\n+\tit is available and sys/socket.h isn't.\n+\t* configure: Regenerate.\n+\t* config.in: Regenerate.\n+\n 2020-07-22  Pedro Alves  <pedro@palves.net>\n \n \t* inferiors.cc (switch_to_process): New, moved here from"
    },
    {
      "sha": "c2ac4fea7e800ec01c351a5832a3f468a963c196",
      "filename": "gdbserver/config.in",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05a6b8c28baad097147eb06329ce3be940682aa9/gdbserver/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05a6b8c28baad097147eb06329ce3be940682aa9/gdbserver/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/config.in?ref=05a6b8c28baad097147eb06329ce3be940682aa9",
      "patch": "@@ -378,6 +378,9 @@\n /* Define to 1 if `vfork' works. */\n #undef HAVE_WORKING_VFORK\n \n+/* Define to 1 if you have the <ws2tcpip.h> header file. */\n+#undef HAVE_WS2TCPIP_H\n+\n /* Define to the address where bug reports for this package should be sent. */\n #undef PACKAGE_BUGREPORT\n "
    },
    {
      "sha": "1f9c3f8ef49e91d02504d4aa89d26660f0f59456",
      "filename": "gdbserver/configure",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05a6b8c28baad097147eb06329ce3be940682aa9/gdbserver/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05a6b8c28baad097147eb06329ce3be940682aa9/gdbserver/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure?ref=05a6b8c28baad097147eb06329ce3be940682aa9",
      "patch": "@@ -9148,7 +9148,7 @@ else CCDEPMODE=depmode=$am_cv_CC_dependencies_compiler_type\n fi\n \n \n-for ac_header in termios.h sys/reg.h string.h \t\t sys/procfs.h linux/elf.h \t\t fcntl.h signal.h sys/file.h \t\t sys/ioctl.h netinet/in.h sys/socket.h netdb.h \t\t netinet/tcp.h arpa/inet.h\n+for ac_header in termios.h sys/reg.h string.h \t\t sys/procfs.h linux/elf.h \t\t fcntl.h signal.h sys/file.h \t\t sys/ioctl.h netinet/in.h sys/socket.h netdb.h \t\t netinet/tcp.h arpa/inet.h ws2tcpip.h\n do :\n   as_ac_Header=`$as_echo \"ac_cv_header_$ac_header\" | $as_tr_sh`\n ac_fn_c_check_header_mongrel \"$LINENO\" \"$ac_header\" \"$as_ac_Header\" \"$ac_includes_default\"\n@@ -10044,7 +10044,11 @@ _ACEOF\n \n \n ac_fn_c_check_type \"$LINENO\" \"socklen_t\" \"ac_cv_type_socklen_t\" \"#include <sys/types.h>\n-#include <sys/socket.h>\n+#if HAVE_SYS_SOCKET_H\n+# include <sys/socket.h>\n+#elif HAVE_WS2TCPIP_H\n+# include <ws2tcpip.h>\n+#endif\n \n \"\n if test \"x$ac_cv_type_socklen_t\" = xyes; then :"
    },
    {
      "sha": "4c7e392bbcedfb0b8bb116725b0f438c3d681030",
      "filename": "gdbserver/configure.ac",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05a6b8c28baad097147eb06329ce3be940682aa9/gdbserver/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05a6b8c28baad097147eb06329ce3be940682aa9/gdbserver/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure.ac?ref=05a6b8c28baad097147eb06329ce3be940682aa9",
      "patch": "@@ -75,7 +75,7 @@ AC_CHECK_HEADERS(termios.h sys/reg.h string.h dnl\n \t\t sys/procfs.h linux/elf.h dnl\n \t\t fcntl.h signal.h sys/file.h dnl\n \t\t sys/ioctl.h netinet/in.h sys/socket.h netdb.h dnl\n-\t\t netinet/tcp.h arpa/inet.h)\n+\t\t netinet/tcp.h arpa/inet.h ws2tcpip.h)\n AC_FUNC_FORK\n AC_CHECK_FUNCS(pread pwrite pread64)\n \n@@ -147,7 +147,11 @@ AC_CHECK_DECLS([perror, vasprintf, vsnprintf])\n \n AC_CHECK_TYPES(socklen_t, [], [],\n [#include <sys/types.h>\n-#include <sys/socket.h>\n+#if HAVE_SYS_SOCKET_H\n+# include <sys/socket.h>\n+#elif HAVE_WS2TCPIP_H\n+# include <ws2tcpip.h>\n+#endif\n ])\n \n case \"${target}\" in"
    }
  ]
}