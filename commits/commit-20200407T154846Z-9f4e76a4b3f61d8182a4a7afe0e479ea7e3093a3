{
  "sha": "9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OWY0ZTc2YTRiM2Y2MWQ4MTgyYTRhN2FmZTBlNDc5ZWE3ZTMwOTNhMw==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2020-04-07T15:48:46Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2020-04-07T15:48:46Z"
    },
    "message": "gdb: small cleanups in dwarf2_psymtab constructors\n\nI noticed that only one of the two dwarf2_psymtab constructors are\nactually used.  The one that is used accepts an `addr` parameter (the\nbase text offset), but its sole caller passes a constant, 0.  We want to\nkeep calling the three-arguments standard_psymtab constructor form,\nhowever, since it differs from the two-arguments form in subtle ways.\n\nAlso, I believe the dwarf2_per_cu_data associated to the created\ndwarf2_psymtab should be passed as a constructor argument.  That will\nhelp me in a future patchset, to convince myself that the `per_cu_data`\nfield can't be NULL.\n\nSo this patch:\n\n- Removes the two-parameters constructor of dwarf2_psymtab, as it is\n  unused.\n- Removes the `addr` parameter of the remaining constructor, passing 0\n  directly to the base class' constructor.\n- Adds a `per_cu` parameter, to assign the `per_cu_data` field at\n  construction.\n\ngdb/ChangeLog:\n\n\t* dwarf2/read.h (struct dwarf2_psymtab): Remove two-parameters\n\tconstructor.  Remove `addr` parameter from other constructor and\n\tadd `per_cu` parameter.\n\t* dwarf2/read.c (create_partial_symtab): Update.",
    "tree": {
      "sha": "af42c644f2a3ef32fc160b14680dc9f133fa17f1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/af42c644f2a3ef32fc160b14680dc9f133fa17f1"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "25c11acac349bf6e77a233c7604bf8e04b8a1424",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/25c11acac349bf6e77a233c7604bf8e04b8a1424",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/25c11acac349bf6e77a233c7604bf8e04b8a1424"
    }
  ],
  "stats": {
    "total": 20,
    "additions": 11,
    "deletions": 9
  },
  "files": [
    {
      "sha": "af53206af4673fc6ac06eaef47ea02ebfd7b0818",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3",
      "patch": "@@ -1,3 +1,10 @@\n+2020-04-07  Simon Marchi  <simon.marchi@polymtl.ca>\n+\n+\t* dwarf2/read.h (struct dwarf2_psymtab): Remove two-parameters\n+\tconstructor.  Remove `addr` parameter from other constructor and\n+\tadd `per_cu` parameter.\n+\t* dwarf2/read.c (create_partial_symtab): Update.\n+\n 2020-04-07  Tom de Vries  <tdevries@suse.de>\n \n \tPR symtab/25796"
    },
    {
      "sha": "1e593b390652683be2f00b6c1d1f5ea47ce7fd4e",
      "filename": "gdb/dwarf2/read.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3/gdb/dwarf2/read.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3/gdb/dwarf2/read.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/dwarf2/read.c?ref=9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3",
      "patch": "@@ -7161,12 +7161,11 @@ create_partial_symtab (struct dwarf2_per_cu_data *per_cu, const char *name)\n   struct objfile *objfile = per_cu->dwarf2_per_objfile->objfile;\n   dwarf2_psymtab *pst;\n \n-  pst = new dwarf2_psymtab (name, objfile, 0);\n+  pst = new dwarf2_psymtab (name, objfile, per_cu);\n \n   pst->psymtabs_addrmap_supported = true;\n \n   /* This is the glue that links PST into GDB's symbol API.  */\n-  pst->per_cu_data = per_cu;\n   per_cu->v.psymtab = pst;\n \n   return pst;"
    },
    {
      "sha": "bd743acc7150583a110cafd7440433b5547f5401",
      "filename": "gdb/dwarf2/read.h",
      "status": "modified",
      "additions": 3,
      "deletions": 7,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3/gdb/dwarf2/read.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3/gdb/dwarf2/read.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/dwarf2/read.h?ref=9f4e76a4b3f61d8182a4a7afe0e479ea7e3093a3",
      "patch": "@@ -253,14 +253,10 @@ dwarf2_per_objfile *get_dwarf2_per_objfile (struct objfile *objfile);\n /* A partial symtab specialized for DWARF.  */\n struct dwarf2_psymtab : public standard_psymtab\n {\n-  dwarf2_psymtab (const char *filename, struct objfile *objfile)\n-    : standard_psymtab (filename, objfile)\n-  {\n-  }\n-\n   dwarf2_psymtab (const char *filename, struct objfile *objfile,\n-\t\t  CORE_ADDR addr)\n-    : standard_psymtab (filename, objfile, addr)\n+\t\t  dwarf2_per_cu_data *per_cu)\n+    : standard_psymtab (filename, objfile, 0),\n+      per_cu_data (per_cu)\n   {\n   }\n "
    }
  ]
}