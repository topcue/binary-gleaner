{
  "sha": "f3d25569f113248ae34ac35e950378a90d332e64",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZjNkMjU1NjlmMTEzMjQ4YWUzNGFjMzVlOTUwMzc4YTkwZDMzMmU2NA==",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-04-19T02:48:31Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-04-19T03:03:38Z"
    },
    "message": "sim: moxie: switch syscalls to common nltvals\n\nRather than hand duplicate the syscall constants, switch to the\ncommon nltvals framework.  I made sure the constants have the\nsame values before & after too :).",
    "tree": {
      "sha": "d405b6cb96cbc4e8824c3adbd88b9500c127d5b1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d405b6cb96cbc4e8824c3adbd88b9500c127d5b1"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/f3d25569f113248ae34ac35e950378a90d332e64",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f3d25569f113248ae34ac35e950378a90d332e64",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/f3d25569f113248ae34ac35e950378a90d332e64",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f3d25569f113248ae34ac35e950378a90d332e64/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "b7c5246bbfad67b60a820db5e548e665171645ec",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b7c5246bbfad67b60a820db5e548e665171645ec",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/b7c5246bbfad67b60a820db5e548e665171645ec"
    }
  ],
  "stats": {
    "total": 57,
    "additions": 52,
    "deletions": 5
  },
  "files": [
    {
      "sha": "d62a40d5db89bd35f4b0d34e6b3ea84429c9732d",
      "filename": "sim/common/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f3d25569f113248ae34ac35e950378a90d332e64/sim/common/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f3d25569f113248ae34ac35e950378a90d332e64/sim/common/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/ChangeLog?ref=f3d25569f113248ae34ac35e950378a90d332e64",
      "patch": "@@ -1,3 +1,8 @@\n+2021-04-18  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* gennltvals.py (TARGETS): Add moxie.\n+\t* nltvals.def: Regenerate.\n+\n 2021-04-18  Mike Frysinger  <vapier@gentoo.org>\n \n \t* gennltvals.py (TARGET_DIRS, TARGETS): Add sh."
    },
    {
      "sha": "cf23c3926994d20fa2d170dcc5506e8ad246f8bf",
      "filename": "sim/common/gennltvals.py",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f3d25569f113248ae34ac35e950378a90d332e64/sim/common/gennltvals.py",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f3d25569f113248ae34ac35e950378a90d332e64/sim/common/gennltvals.py",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/gennltvals.py?ref=f3d25569f113248ae34ac35e950378a90d332e64",
      "patch": "@@ -68,6 +68,7 @@\n     'mcore',\n     'mn10200',\n     'mn10300',\n+    'moxie',\n     'msp430',\n     'pru',\n     'riscv',"
    },
    {
      "sha": "27f1b0d43b26d711765ba7b67a4fcc14d403116a",
      "filename": "sim/common/nltvals.def",
      "status": "modified",
      "additions": 31,
      "deletions": 0,
      "changes": 31,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f3d25569f113248ae34ac35e950378a90d332e64/sim/common/nltvals.def",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f3d25569f113248ae34ac35e950378a90d332e64/sim/common/nltvals.def",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/nltvals.def?ref=f3d25569f113248ae34ac35e950378a90d332e64",
      "patch": "@@ -546,6 +546,37 @@\n /* end mn10300 sys target macros */\n #endif\n #endif\n+#ifdef NL_TARGET_moxie\n+#ifdef sys_defs\n+/* from syscall.h */\n+/* begin moxie sys target macros */\n+ { \"SYS_argc\", 22 },\n+ { \"SYS_argn\", 24 },\n+ { \"SYS_argnlen\", 23 },\n+ { \"SYS_argv\", 13 },\n+ { \"SYS_argvlen\", 12 },\n+ { \"SYS_chdir\", 14 },\n+ { \"SYS_chmod\", 16 },\n+ { \"SYS_close\", 3 },\n+ { \"SYS_exit\", 1 },\n+ { \"SYS_fstat\", 10 },\n+ { \"SYS_getpid\", 8 },\n+ { \"SYS_gettimeofday\", 19 },\n+ { \"SYS_kill\", 9 },\n+ { \"SYS_link\", 21 },\n+ { \"SYS_lseek\", 6 },\n+ { \"SYS_open\", 2 },\n+ { \"SYS_read\", 4 },\n+ { \"SYS_reconfig\", 25 },\n+ { \"SYS_stat\", 15 },\n+ { \"SYS_time\", 18 },\n+ { \"SYS_times\", 20 },\n+ { \"SYS_unlink\", 7 },\n+ { \"SYS_utime\", 17 },\n+ { \"SYS_write\", 5 },\n+/* end moxie sys target macros */\n+#endif\n+#endif\n #ifdef NL_TARGET_msp430\n #ifdef sys_defs\n /* from syscall.h */"
    },
    {
      "sha": "9621907dabb560d975fa1d6c35e3d424458b3d7d",
      "filename": "sim/moxie/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f3d25569f113248ae34ac35e950378a90d332e64/sim/moxie/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f3d25569f113248ae34ac35e950378a90d332e64/sim/moxie/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/moxie/ChangeLog?ref=f3d25569f113248ae34ac35e950378a90d332e64",
      "patch": "@@ -1,3 +1,9 @@\n+2021-04-18  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* Makefile.in (NL_TARGET): Define.\n+\t* interp.c: Include targ-vals.h.\n+\t(sim_engine_run): Change numeric literals to SYS_ constants.\n+\n 2021-04-18  Mike Frysinger  <vapier@gentoo.org>\n \n \t* configure: Regenerate."
    },
    {
      "sha": "3d9618846cc30eda81c27fca75148568d56bc3b8",
      "filename": "sim/moxie/Makefile.in",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f3d25569f113248ae34ac35e950378a90d332e64/sim/moxie/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f3d25569f113248ae34ac35e950378a90d332e64/sim/moxie/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/moxie/Makefile.in?ref=f3d25569f113248ae34ac35e950378a90d332e64",
      "patch": "@@ -15,6 +15,9 @@\n # You should have received a copy of the GNU General Public License\n # along with this program.  If not, see <http://www.gnu.org/licenses/>.\n \n+# This selects the newlib/libgloss syscall definitions.\n+NL_TARGET = -DNL_TARGET_moxie\n+\n ## COMMON_PRE_CONFIG_FRAG\n \n DTC = @DTC@"
    },
    {
      "sha": "417ff9ea55033716e04c4b91f5441f62a0b762e3",
      "filename": "sim/moxie/interp.c",
      "status": "modified",
      "additions": 6,
      "deletions": 5,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f3d25569f113248ae34ac35e950378a90d332e64/sim/moxie/interp.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f3d25569f113248ae34ac35e950378a90d332e64/sim/moxie/interp.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/moxie/interp.c?ref=f3d25569f113248ae34ac35e950378a90d332e64",
      "patch": "@@ -33,6 +33,7 @@ along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n #include \"sim-base.h\"\n #include \"sim-options.h\"\n #include \"sim-io.h\"\n+#include \"targ-vals.h\"\n \n typedef int word;\n typedef unsigned int uword;\n@@ -932,13 +933,13 @@ sim_engine_run (SIM_DESC sd,\n \t        cpu.asregs.sregs[3] = inum;\n \t\tswitch (inum)\n \t\t  {\n-\t\t  case 0x1: /* SYS_exit */\n+\t\t  case TARGET_SYS_exit:\n \t\t    {\n \t\t      sim_engine_halt (sd, scpu, NULL, pc, sim_exited,\n \t\t\t\t       cpu.asregs.regs[2]);\n \t\t      break;\n \t\t    }\n-\t\t  case 0x2: /* SYS_open */\n+\t\t  case TARGET_SYS_open:\n \t\t    {\n \t\t      char fname[1024];\n \t\t      int mode = (int) convert_target_flags ((unsigned) cpu.asregs.regs[3]);\n@@ -951,7 +952,7 @@ sim_engine_run (SIM_DESC sd,\n \t\t      cpu.asregs.regs[2] = fd;\n \t\t      break;\n \t\t    }\n-\t\t  case 0x4: /* SYS_read */\n+\t\t  case TARGET_SYS_read:\n \t\t    {\n \t\t      int fd = cpu.asregs.regs[2];\n \t\t      unsigned len = (unsigned) cpu.asregs.regs[4];\n@@ -962,7 +963,7 @@ sim_engine_run (SIM_DESC sd,\n \t\t      free (buf);\n \t\t      break;\n \t\t    }\n-\t\t  case 0x5: /* SYS_write */\n+\t\t  case TARGET_SYS_write:\n \t\t    {\n \t\t      char *str;\n \t\t      /* String length is at 0x12($fp) */\n@@ -975,7 +976,7 @@ sim_engine_run (SIM_DESC sd,\n \t\t      cpu.asregs.regs[2] = count;\n \t\t      break;\n \t\t    }\n-\t\t  case 0x7: /* SYS_unlink */\n+\t\t  case TARGET_SYS_unlink:\n \t\t    {\n \t\t      char fname[1024];\n \t\t      int fd;"
    }
  ]
}