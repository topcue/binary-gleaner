{
  "sha": "4c0e540e47e8ea26e20246c33c744306944b4cb8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NGMwZTU0MGU0N2U4ZWEyNmUyMDI0NmMzM2M3NDQzMDY5NDRiNGNiOA==",
  "commit": {
    "author": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2021-01-04T02:12:45Z"
    },
    "committer": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2021-01-04T03:17:33Z"
    },
    "message": "RISC-V: Fix the merged orders of Z* extension for linker.\n\nSimilar to the commit 6729e2c2af2bd94408430734316597843718a484,\nwe have to check the first char of the Z* extensions, to make\nsure that they follow the order of the standard extensions.\n\nbfd/\n    * elfxx-riscv.c (riscv_compare_subsets): Removed static.\n    * elfxx-riscv.h: Add declaration.\n    * elfnn-riscv.c (riscv_merge_multi_letter_ext): Use\n    riscv_compare_subsets to check the orders.\n    (riscv_skip_prefix): Removed.\n    (riscv_prefix_cmp): Removed.",
    "tree": {
      "sha": "b0c211f9ec492e90888cad664152051df6fe1cf1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/b0c211f9ec492e90888cad664152051df6fe1cf1"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4c0e540e47e8ea26e20246c33c744306944b4cb8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4c0e540e47e8ea26e20246c33c744306944b4cb8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4c0e540e47e8ea26e20246c33c744306944b4cb8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4c0e540e47e8ea26e20246c33c744306944b4cb8/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "e9cf3691bfa140469d52815a2307b00eecf7917c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e9cf3691bfa140469d52815a2307b00eecf7917c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e9cf3691bfa140469d52815a2307b00eecf7917c"
    }
  ],
  "stats": {
    "total": 49,
    "additions": 14,
    "deletions": 35
  },
  "files": [
    {
      "sha": "a7cc3c8af3e40d483ae3b8197eb89b0d1c320acd",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4c0e540e47e8ea26e20246c33c744306944b4cb8/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4c0e540e47e8ea26e20246c33c744306944b4cb8/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=4c0e540e47e8ea26e20246c33c744306944b4cb8",
      "patch": "@@ -1,3 +1,12 @@\n+2021-01-04  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* elfxx-riscv.c (riscv_compare_subsets): Removed static.\n+\t* elfxx-riscv.h: Add declaration.\n+\t* elfnn-riscv.c (riscv_merge_multi_letter_ext): Use\n+\triscv_compare_subsets to check the orders.\n+\t(riscv_skip_prefix): Removed.\n+\t(riscv_prefix_cmp): Removed.\n+\n 2021-01-04  Alan Modra  <amodra@gmail.com>\n \n \tPR 26741"
    },
    {
      "sha": "047f31b4eac4c9b3b95ec69d7ec2ad6b3e576747",
      "filename": "bfd/elfnn-riscv.c",
      "status": "modified",
      "additions": 1,
      "deletions": 34,
      "changes": 35,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4c0e540e47e8ea26e20246c33c744306944b4cb8/bfd/elfnn-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4c0e540e47e8ea26e20246c33c744306944b4cb8/bfd/elfnn-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfnn-riscv.c?ref=4c0e540e47e8ea26e20246c33c744306944b4cb8",
      "patch": "@@ -3410,39 +3410,6 @@ riscv_merge_std_ext (bfd *ibfd,\n   return TRUE;\n }\n \n-/* If C is a prefix class, then return the EXT string without the prefix.\n-   Otherwise return the entire EXT string.  */\n-\n-static const char *\n-riscv_skip_prefix (const char *ext, riscv_isa_ext_class_t c)\n-{\n-  switch (c)\n-    {\n-    case RV_ISA_CLASS_X: return &ext[1];\n-    case RV_ISA_CLASS_S: return &ext[1];\n-    case RV_ISA_CLASS_Z: return &ext[1];\n-    default: return ext;\n-    }\n-}\n-\n-/* Compare prefixed extension names canonically.  */\n-\n-static int\n-riscv_prefix_cmp (const char *a, const char *b)\n-{\n-  riscv_isa_ext_class_t ca = riscv_get_prefix_class (a);\n-  riscv_isa_ext_class_t cb = riscv_get_prefix_class (b);\n-\n-  /* Extension name without prefix  */\n-  const char *anp = riscv_skip_prefix (a, ca);\n-  const char *bnp = riscv_skip_prefix (b, cb);\n-\n-  if (ca == cb)\n-    return strcasecmp (anp, bnp);\n-\n-  return (int)ca - (int)cb;\n-}\n-\n /* Merge multi letter extensions.  PIN is a pointer to the head of the input\n    object subset list.  Likewise for POUT and the output object.  Return TRUE\n    on success and FALSE when a conflict is found.  */\n@@ -3460,7 +3427,7 @@ riscv_merge_multi_letter_ext (bfd *ibfd,\n \n   while (in && out)\n     {\n-      cmp = riscv_prefix_cmp (in->name, out->name);\n+      cmp = riscv_compare_subsets (in->name, out->name);\n \n       if (cmp < 0)\n \t{"
    },
    {
      "sha": "d3b64720a5dc314d61f644270c8d514e66044d0b",
      "filename": "bfd/elfxx-riscv.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4c0e540e47e8ea26e20246c33c744306944b4cb8/bfd/elfxx-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4c0e540e47e8ea26e20246c33c744306944b4cb8/bfd/elfxx-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-riscv.c?ref=4c0e540e47e8ea26e20246c33c744306944b4cb8",
      "patch": "@@ -1037,7 +1037,7 @@ static int riscv_ext_order[26] = {0};\n    or greater than zero if `subset2` is found, respectively, to be less\n    than, to match, or be greater than `subset1`.  */\n \n-static int\n+int\n riscv_compare_subsets (const char *subset1, const char *subset2)\n {\n   int order1 = riscv_ext_order[(*subset1 - 'a')];"
    },
    {
      "sha": "4d7a6dcf096b68e053c34dfd75e85abd384fe5f9",
      "filename": "bfd/elfxx-riscv.h",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4c0e540e47e8ea26e20246c33c744306944b4cb8/bfd/elfxx-riscv.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4c0e540e47e8ea26e20246c33c744306944b4cb8/bfd/elfxx-riscv.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-riscv.h?ref=4c0e540e47e8ea26e20246c33c744306944b4cb8",
      "patch": "@@ -116,3 +116,6 @@ riscv_get_priv_spec_class_from_numbers (unsigned int,\n \n extern const char *\n riscv_get_priv_spec_name (enum riscv_priv_spec_class);\n+\n+extern int\n+riscv_compare_subsets (const char *, const char *);"
    }
  ]
}