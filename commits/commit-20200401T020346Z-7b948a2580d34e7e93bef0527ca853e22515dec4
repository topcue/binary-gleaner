{
  "sha": "7b948a2580d34e7e93bef0527ca853e22515dec4",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6N2I5NDhhMjU4MGQzNGU3ZTkzYmVmMDUyN2NhODUzZTIyNTE1ZGVjNA==",
  "commit": {
    "author": {
      "name": "Hans-Peter Nilsson",
      "email": "hp@bitrange.com",
      "date": "2020-04-01T02:03:46Z"
    },
    "committer": {
      "name": "Hans-Peter Nilsson",
      "email": "hp@bitrange.com",
      "date": "2020-04-01T02:03:46Z"
    },
    "message": "mmo.c: Fix ld testsuite regression \"objcopy executable (pr25662)\".\n\n\t* mmo.c (mmo_scan): Create .text section only when needed, not\n\tfrom the start.\n\nFor the test-case at hand, the .data section is created and output\nfirst by the linker, but the mmo input-reader mmo_scan always creates\na .text section.  Since sections are output in the order in which\nthey're created, it's output first, breaking the assumption that\nobcopy without options (or with -p) creates output identical to its\ninput.  The point of creating it at the top of mmo_scan is a trivial\ndefault assignment for the current section variable \"sec\".  Instead we\nnow defer the default, creating it only when needed and sec is NULL.",
    "tree": {
      "sha": "7e880c1a825c9c4172eee617ebee9470796efcda",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/7e880c1a825c9c4172eee617ebee9470796efcda"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/7b948a2580d34e7e93bef0527ca853e22515dec4",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7b948a2580d34e7e93bef0527ca853e22515dec4",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/7b948a2580d34e7e93bef0527ca853e22515dec4",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7b948a2580d34e7e93bef0527ca853e22515dec4/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "283b7aa1343c29d9c0cdee6312da3d5a61a03f15",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/283b7aa1343c29d9c0cdee6312da3d5a61a03f15",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/283b7aa1343c29d9c0cdee6312da3d5a61a03f15"
    }
  ],
  "stats": {
    "total": 11,
    "additions": 10,
    "deletions": 1
  },
  "files": [
    {
      "sha": "d11421f6a2fcf7ff2fe6e350b91e4e2e98c3c229",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7b948a2580d34e7e93bef0527ca853e22515dec4/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7b948a2580d34e7e93bef0527ca853e22515dec4/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=7b948a2580d34e7e93bef0527ca853e22515dec4",
      "patch": "@@ -1,3 +1,8 @@\n+2020-04-01  Hans-Peter Nilsson  <hp@bitrange.com>\n+\n+\t* mmo.c (mmo_scan): Create .text section only when needed, not\n+\tfrom the start.\n+\n 2020-03-31  Alan Modra  <amodra@gmail.com>\n \n \t* coff-alpha.c (alpha_ecoff_get_elt_at_filepos): Correct bfd_bread"
    },
    {
      "sha": "ea7c4c66b549e519915442dbe853848af9c55dfc",
      "filename": "bfd/mmo.c",
      "status": "modified",
      "additions": 5,
      "deletions": 1,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7b948a2580d34e7e93bef0527ca853e22515dec4/bfd/mmo.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7b948a2580d34e7e93bef0527ca853e22515dec4/bfd/mmo.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/mmo.c?ref=7b948a2580d34e7e93bef0527ca853e22515dec4",
      "patch": "@@ -1588,7 +1588,7 @@ mmo_scan (bfd *abfd)\n   unsigned int lineno = 1;\n   bfd_boolean error = FALSE;\n   bfd_vma vma = 0;\n-  asection *sec = bfd_make_section_old_way (abfd, MMO_TEXT_SECTION_NAME);\n+  asection *sec = NULL;\n   asection *non_spec_sec = NULL;\n   bfd_vma non_spec_vma = 0;\n   bfd_size_type nbytes_read = 0;\n@@ -1646,6 +1646,8 @@ mmo_scan (bfd *abfd)\n \t\tgoto error_return;\n \n \t      vma &= ~3;\n+\t      if (sec == NULL)\n+\t\tsec = bfd_make_section_old_way (abfd, MMO_TEXT_SECTION_NAME);\n \t      mmo_xore_32 (sec, vma, bfd_get_32 (abfd, buf));\n \t      vma += 4;\n \t      lineno++;\n@@ -2038,6 +2040,8 @@ mmo_scan (bfd *abfd)\n       else\n \t{\n \t  /* This wasn't a lopcode, so store it in the current section.  */\n+\t  if (sec == NULL)\n+\t    sec = bfd_make_section_old_way (abfd, MMO_TEXT_SECTION_NAME);\n \t  mmo_xore_32 (sec, vma & ~3, bfd_get_32 (abfd, buf));\n \t  vma += 4;\n \t  vma &= ~3;"
    }
  ]
}