{
  "sha": "11061048d1fed4465b0e62eb3c14dabf0beab59b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTEwNjEwNDhkMWZlZDQ0NjViMGU2MmViM2MxNGRhYmYwYmVhYjU5Yg==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-09-10T23:25:35Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-09-18T21:03:29Z"
    },
    "message": "Give a name to the TUI SingleKey keymap\n\nReadline 8.0 has a feature that lets an application name a keymap.\nThis in turn makes it simpler for users to bind keys in keymaps in\ntheir .inputrc.\n\nThis patch gives a name to the TUI SingleKey keymap, so that\nadditional bindings can be made there.  For example:\n\n    $if gdb\n    set keymap SingleKey\n    \"X\": \"echo hello\\\\n\\n\"\n    $endif\n\nThe call to rl_initialize, in tui_initialize_readline, had to be\nremoved so that .inputrc was not read too early.  Note that Readline\nexplicitly documents that this call is not needed.\n\ngdb/ChangeLog\n2019-09-18  Tom Tromey  <tom@tromey.com>\n\n\t* NEWS: Add entry.\n\t* tui/tui.c (tui_initialize_readline): Set name of keymap.  Do not\n\tcall rl_initialize.\n\t(tui_enable): Do not call rl_initialize.\n\ngdb/doc/ChangeLog\n2019-09-18  Tom Tromey  <tom@tromey.com>\n\n\t* gdb.texinfo (Editing): Document readline application name.\n\t(TUI Single Key Mode): Document TUI SingleKey keymap name.",
    "tree": {
      "sha": "fda69cbe391d420c44ee650f6b2267d77efd71e4",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/fda69cbe391d420c44ee650f6b2267d77efd71e4"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/11061048d1fed4465b0e62eb3c14dabf0beab59b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/11061048d1fed4465b0e62eb3c14dabf0beab59b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/11061048d1fed4465b0e62eb3c14dabf0beab59b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/11061048d1fed4465b0e62eb3c14dabf0beab59b/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "7a27b85f6d9b5eea9bd1493f903158fbea4b2231",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7a27b85f6d9b5eea9bd1493f903158fbea4b2231",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/7a27b85f6d9b5eea9bd1493f903158fbea4b2231"
    }
  ],
  "stats": {
    "total": 33,
    "additions": 30,
    "deletions": 3
  },
  "files": [
    {
      "sha": "f8228b459ce661167c7540aaba6ba1a34aeb75f8",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=11061048d1fed4465b0e62eb3c14dabf0beab59b",
      "patch": "@@ -1,3 +1,10 @@\n+2019-09-18  Tom Tromey  <tom@tromey.com>\n+\n+\t* NEWS: Add entry.\n+\t* tui/tui.c (tui_initialize_readline): Set name of keymap.  Do not\n+\tcall rl_initialize.\n+\t(tui_enable): Do not call rl_initialize.\n+\n 2019-09-18  Christian Groessler  <chris@groessler.org>\n \n \t* alpha-linux-nat.c: Include gdbarch.h."
    },
    {
      "sha": "1fefd814095e75855b5f269d11cdd38458727101",
      "filename": "gdb/NEWS",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/NEWS",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/NEWS",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/NEWS?ref=11061048d1fed4465b0e62eb3c14dabf0beab59b",
      "patch": "@@ -323,6 +323,10 @@ maint show test-options-completion-result\n   GDB now bundles GNU readline 8.0, but if you choose to use\n   --with-system-readline, only readline >= 7.0 can be used.\n \n+* The TUI SingleKey keymap is now named \"SingleKey\".  This can be used\n+  from .inputrc to bind keys in this keymap.  This feature is only\n+  available when gdb is built against GNU readline 8.0 or later.\n+\n *** Changes in GDB 8.3\n \n * GDB and GDBserver now support access to additional registers on"
    },
    {
      "sha": "8eaaab3ae1f3564d862de7e7fad8adcb4ec0e198",
      "filename": "gdb/doc/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/doc/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/doc/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/doc/ChangeLog?ref=11061048d1fed4465b0e62eb3c14dabf0beab59b",
      "patch": "@@ -1,3 +1,8 @@\n+2019-09-18  Tom Tromey  <tom@tromey.com>\n+\n+\t* gdb.texinfo (Editing): Document readline application name.\n+\t(TUI Single Key Mode): Document TUI SingleKey keymap name.\n+\n 2019-09-17  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* gdb.texinfo (Source Path): Additional text to better describe"
    },
    {
      "sha": "a129ea0aa1b57ec73542790b95e7d9e7e184071d",
      "filename": "gdb/doc/gdb.texinfo",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/doc/gdb.texinfo",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/doc/gdb.texinfo",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/doc/gdb.texinfo?ref=11061048d1fed4465b0e62eb3c14dabf0beab59b",
      "patch": "@@ -25056,6 +25056,10 @@ for more details about the Readline\n interface.  Users unfamiliar with @sc{gnu} Emacs or @code{vi} are\n encouraged to read that chapter.\n \n+@cindex Readline application name\n+@value{GDBN} sets the Readline application name to @samp{gdb}.  This\n+is useful for conditions in @file{.inputrc}.\n+\n @node Command History\n @section Command History\n @cindex command history\n@@ -27658,6 +27662,10 @@ with the TUI SingleKey mode.  Once the command is entered the TUI\n SingleKey mode is restored.  The only way to permanently leave\n this mode is by typing @kbd{q} or @kbd{C-x s}.\n \n+@cindex SingleKey keymap name\n+If @value{GDBN} was built with Readline 8.0 or later, the TUI\n+SingleKey keymap will be named @samp{SingleKey}.  This can be used in\n+@file{.inputrc} to add additional bindings to this keymap.\n \n @node TUI Commands\n @section TUI-specific Commands"
    },
    {
      "sha": "5d6b9f320368f2d0e4e37f738622729f01657f34",
      "filename": "gdb/tui/tui.c",
      "status": "modified",
      "additions": 6,
      "deletions": 3,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/tui/tui.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/11061048d1fed4465b0e62eb3c14dabf0beab59b/gdb/tui/tui.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui.c?ref=11061048d1fed4465b0e62eb3c14dabf0beab59b",
      "patch": "@@ -329,13 +329,17 @@ tui_initialize_readline (void)\n   int i;\n   Keymap tui_ctlx_keymap;\n \n-  rl_initialize ();\n-\n   rl_add_defun (\"tui-switch-mode\", tui_rl_switch_mode, -1);\n   rl_add_defun (\"gdb-command\", tui_rl_command_key, -1);\n   rl_add_defun (\"next-keymap\", tui_rl_next_keymap, -1);\n \n   tui_keymap = rl_make_bare_keymap ();\n+\n+  /* The named keymap feature was added in Readline 8.0.  */\n+#if RL_READLINE_VERSION >= 0x800\n+  rl_set_keymap_name (\"SingleKey\", tui_keymap);\n+#endif\n+\n   tui_ctlx_keymap = rl_make_bare_keymap ();\n   tui_readline_standard_keymap = rl_get_keymap ();\n \n@@ -467,7 +471,6 @@ tui_enable (void)\n       nodelay(w, FALSE);\n       nl();\n       keypad (w, TRUE);\n-      rl_initialize ();\n       tui_set_term_height_to (LINES);\n       tui_set_term_width_to (COLS);\n       def_prog_mode ();"
    }
  ]
}