{
  "sha": "0fa7617d84da8b809b14e1e2ee67474526c62021",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MGZhNzYxN2Q4NGRhOGI4MDliMTRlMWUyZWU2NzQ3NDUyNmM2MjAyMQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-04-20T17:45:06Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-04-20T17:45:06Z"
    },
    "message": "Mark move constructors as \"noexcept\"\n\nI recently learned that move constructors generally should be marked\n\"noexcept\".  This ensures that standard containers will move objects\nwhen possible, rather than copy them.\n\nThis patch fixes the cases I could find.  Note that implicitly-defined\nor defaulted move constructors will automatically do what you'd\nexpect; that is, they are noexcept if all the members have noexcept\nmove constructors.\n\nWhile doing this, I noticed a couple of odd cases where the move\nconstructor seemed to assume that the object being constructed could\nhave state requiring destruction.  I've fixed these as well.  See\ncompletion_result and scoped_mmap.\n\ngdb/ChangeLog\n2020-04-20  Tom Tromey  <tromey@adacore.com>\n\n\t* python/python.c (struct gdbpy_event): Mark move constructor as\n\tnoexcept.\n\t* python/py-tui.c (class gdbpy_tui_window_maker): Mark move\n\tconstructor as noexcept.\n\t* completer.h (struct completion_result): Mark move constructor as\n\tnoexcept.\n\t* completer.c (completion_result::completion_result): Use\n\tinitialization style.  Don't call reset_match_list.\n\ngdbsupport/ChangeLog\n2020-04-20  Tom Tromey  <tromey@adacore.com>\n\n\t* scoped_mmap.h (scoped_mmap): Mark move constructor as noexcept.\n\tUse initialization style.  Don't call destroy.\n\t* scoped_fd.h (class scoped_fd): Mark move constructor as\n\tnoexcept.\n\t* gdb_ref_ptr.h (class ref_ptr): Mark move constructor as\n\tnoexcept.",
    "tree": {
      "sha": "c0df8e58cdc7411ed31337b87830614c9223b6a9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c0df8e58cdc7411ed31337b87830614c9223b6a9"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0fa7617d84da8b809b14e1e2ee67474526c62021",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0fa7617d84da8b809b14e1e2ee67474526c62021",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0fa7617d84da8b809b14e1e2ee67474526c62021",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0fa7617d84da8b809b14e1e2ee67474526c62021/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "9b2c992cfa4e9911d3b54c21ced179aa4928c422",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9b2c992cfa4e9911d3b54c21ced179aa4928c422",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/9b2c992cfa4e9911d3b54c21ced179aa4928c422"
    }
  ],
  "stats": {
    "total": 49,
    "additions": 31,
    "deletions": 18
  },
  "files": [
    {
      "sha": "aa99da0c4d93f65bda35073adfae2f23dd01227b",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -1,3 +1,14 @@\n+2020-04-20  Tom Tromey  <tromey@adacore.com>\n+\n+\t* python/python.c (struct gdbpy_event): Mark move constructor as\n+\tnoexcept.\n+\t* python/py-tui.c (class gdbpy_tui_window_maker): Mark move\n+\tconstructor as noexcept.\n+\t* completer.h (struct completion_result): Mark move constructor as\n+\tnoexcept.\n+\t* completer.c (completion_result::completion_result): Use\n+\tinitialization style.  Don't call reset_match_list.\n+\n 2020-04-20  Mihails Strasuns  <mihails.strasuns@intel.com>\n \n \t* MAINTAINERS (Write After Approval): Add myself."
    },
    {
      "sha": "f9631f43cf49222d4841efa467582679dc69a8d3",
      "filename": "gdb/completer.c",
      "status": "modified",
      "additions": 3,
      "deletions": 7,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/completer.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/completer.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/completer.c?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -2327,15 +2327,11 @@ completion_result::~completion_result ()\n \n /* See completer.h  */\n \n-completion_result::completion_result (completion_result &&rhs)\n+completion_result::completion_result (completion_result &&rhs) noexcept\n+  : match_list (rhs.match_list),\n+    number_matches (rhs.number_matches)\n {\n-  if (this == &rhs)\n-    return;\n-\n-  reset_match_list ();\n-  match_list = rhs.match_list;\n   rhs.match_list = NULL;\n-  number_matches = rhs.number_matches;\n   rhs.number_matches = 0;\n }\n "
    },
    {
      "sha": "d3afa5fe3ec872f62d993a3936ea2a17e5f56912",
      "filename": "gdb/completer.h",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/completer.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/completer.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/completer.h?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -242,7 +242,7 @@ struct completion_result\n   DISABLE_COPY_AND_ASSIGN (completion_result);\n \n   /* Move a result.  */\n-  completion_result (completion_result &&rhs);\n+  completion_result (completion_result &&rhs) noexcept;\n \n   /* Release ownership of the match list array.  */\n   char **release_match_list ();"
    },
    {
      "sha": "ca88f85eb9f9af4b38c2ed9276c9d7d9ab38dfc4",
      "filename": "gdb/python/py-tui.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/python/py-tui.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/python/py-tui.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/python/py-tui.c?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -233,7 +233,7 @@ class gdbpy_tui_window_maker\n \n   ~gdbpy_tui_window_maker ();\n \n-  gdbpy_tui_window_maker (gdbpy_tui_window_maker &&other)\n+  gdbpy_tui_window_maker (gdbpy_tui_window_maker &&other) noexcept\n     : m_constr (std::move (other.m_constr))\n   {\n   }"
    },
    {
      "sha": "4875ffd29355be675ae9602b4241c0b9c896666b",
      "filename": "gdb/python/python.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/python/python.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdb/python/python.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/python/python.c?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -975,7 +975,7 @@ struct gdbpy_event\n   {\n   }\n \n-  gdbpy_event (gdbpy_event &&other)\n+  gdbpy_event (gdbpy_event &&other) noexcept\n     : m_func (other.m_func)\n   {\n     other.m_func = nullptr;"
    },
    {
      "sha": "78fbbe65c70e1d655ba4c29ce53cfcb52c93317c",
      "filename": "gdbsupport/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdbsupport/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdbsupport/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbsupport/ChangeLog?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -1,3 +1,12 @@\n+2020-04-20  Tom Tromey  <tromey@adacore.com>\n+\n+\t* scoped_mmap.h (scoped_mmap): Mark move constructor as noexcept.\n+\tUse initialization style.  Don't call destroy.\n+\t* scoped_fd.h (class scoped_fd): Mark move constructor as\n+\tnoexcept.\n+\t* gdb_ref_ptr.h (class ref_ptr): Mark move constructor as\n+\tnoexcept.\n+\n 2020-04-13  Tom Tromey  <tom@tromey.com>\n \n \t* event-loop.c: Move comment.  Remove obsolete \tcomment."
    },
    {
      "sha": "de387f598dec7aee60f9966dccb44d7a3bd9226c",
      "filename": "gdbsupport/gdb_ref_ptr.h",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdbsupport/gdb_ref_ptr.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdbsupport/gdb_ref_ptr.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbsupport/gdb_ref_ptr.h?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -78,7 +78,7 @@ class ref_ptr\n   }\n \n   /* Transfer ownership from OTHER.  */\n-  ref_ptr (ref_ptr &&other)\n+  ref_ptr (ref_ptr &&other) noexcept\n     : m_obj (other.m_obj)\n   {\n     other.m_obj = NULL;"
    },
    {
      "sha": "ec654df5246b6e9ddfc4619c3cb940ab33696146",
      "filename": "gdbsupport/scoped_fd.h",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdbsupport/scoped_fd.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdbsupport/scoped_fd.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbsupport/scoped_fd.h?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -30,7 +30,7 @@ class scoped_fd\n public:\n   explicit scoped_fd (int fd = -1) noexcept : m_fd (fd) {}\n \n-  scoped_fd (scoped_fd &&other)\n+  scoped_fd (scoped_fd &&other) noexcept\n     : m_fd (other.m_fd)\n   {\n     other.m_fd = -1;"
    },
    {
      "sha": "9b74383fc5018d89337bb0982444d80660b1aa32",
      "filename": "gdbsupport/scoped_mmap.h",
      "status": "modified",
      "additions": 3,
      "deletions": 6,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0fa7617d84da8b809b14e1e2ee67474526c62021/gdbsupport/scoped_mmap.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0fa7617d84da8b809b14e1e2ee67474526c62021/gdbsupport/scoped_mmap.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbsupport/scoped_mmap.h?ref=0fa7617d84da8b809b14e1e2ee67474526c62021",
      "patch": "@@ -42,13 +42,10 @@ class scoped_mmap\n     destroy ();\n   }\n \n-  scoped_mmap (scoped_mmap &&rhs)\n+  scoped_mmap (scoped_mmap &&rhs) noexcept\n+    : m_mem (rhs.m_mem),\n+      m_length (rhs.m_length)\n   {\n-    destroy ();\n-\n-    m_mem = rhs.m_mem;\n-    m_length = rhs.m_length;\n-\n     rhs.m_mem = MAP_FAILED;\n     rhs.m_length = 0;\n   }"
    }
  ]
}