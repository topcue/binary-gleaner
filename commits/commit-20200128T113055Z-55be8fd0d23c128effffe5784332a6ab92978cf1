{
  "sha": "55be8fd0d23c128effffe5784332a6ab92978cf1",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NTViZThmZDBkMjNjMTI4ZWZmZmZlNTc4NDMzMmE2YWI5Mjk3OGNmMQ==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-01-28T11:30:55Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-01-28T11:30:55Z"
    },
    "message": "Improve warning message from debuginfod support in readelf.\n\n\t* readelf.c (get_build_id): Simplify warning message about corrupt\n\tnotes encountered whilst scanning for the build-id.",
    "tree": {
      "sha": "eeba1341adf41b78c63276d7e70a40fb88b42e8a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/eeba1341adf41b78c63276d7e70a40fb88b42e8a"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/55be8fd0d23c128effffe5784332a6ab92978cf1",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/55be8fd0d23c128effffe5784332a6ab92978cf1",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/55be8fd0d23c128effffe5784332a6ab92978cf1",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/55be8fd0d23c128effffe5784332a6ab92978cf1/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "738174e17e539937a6d773d7dfd501241a882b0b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/738174e17e539937a6d773d7dfd501241a882b0b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/738174e17e539937a6d773d7dfd501241a882b0b"
    }
  ],
  "stats": {
    "total": 42,
    "additions": 21,
    "deletions": 21
  },
  "files": [
    {
      "sha": "aff246530637bc874bcad217e16f22cacc72a1ef",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/55be8fd0d23c128effffe5784332a6ab92978cf1/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/55be8fd0d23c128effffe5784332a6ab92978cf1/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=55be8fd0d23c128effffe5784332a6ab92978cf1",
      "patch": "@@ -1,3 +1,8 @@\n+2020-01-28  Nick Clifton  <nickc@redhat.com>\n+\n+\t* readelf.c (get_build_id): Simplify warning message about corrupt\n+\tnotes encountered whilst scanning for the build-id.\n+\n 2020-01-27  Roland McGrath  <mcgrathr@google.com>\n \n \t* objcopy.c (compare_gnu_build_notes): Fix comparison results"
    },
    {
      "sha": "45cfe1cfcf68ea4e0cf78b3a8a8c2d95faab2b2b",
      "filename": "binutils/readelf.c",
      "status": "modified",
      "additions": 16,
      "deletions": 21,
      "changes": 37,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/55be8fd0d23c128effffe5784332a6ab92978cf1/binutils/readelf.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/55be8fd0d23c128effffe5784332a6ab92978cf1/binutils/readelf.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/readelf.c?ref=55be8fd0d23c128effffe5784332a6ab92978cf1",
      "patch": "@@ -14122,7 +14122,7 @@ load_specific_debug_section (enum dwarf_section_display_enum  debug,\n \t\t      ? sizeof (Elf32_External_Chdr)\n \t\t      : sizeof (Elf64_External_Chdr)))\n \t    {\n-\t      warn (_(\"compressed section %s is too small to contain a compression header\"),\n+\t      warn (_(\"compressed section %s is too small to contain a compression header\\n\"),\n \t\t    section->name);\n \t      return FALSE;\n \t    }\n@@ -14204,7 +14204,8 @@ get_build_id (void * data)\n   Elf_Internal_Shdr * shdr;\n   unsigned long i;\n \n-  /* Iterate through notes to find note.gnu.build-id.  */\n+  /* Iterate through notes to find note.gnu.build-id.\n+     FIXME: Only the first note in any note section is examined.  */\n   for (i = 0, shdr = filedata->section_headers;\n        i < filedata->file_header.e_shnum && shdr != NULL;\n        i++, shdr++)\n@@ -14240,13 +14241,10 @@ get_build_id (void * data)\n           min_notesz = offsetof (Elf_External_Note, name);\n           if (data_remaining < min_notesz)\n             {\n-              warn (ngettext (\"debuginfod: Corrupt note: only %ld byte remains, \"\n-                              \"not enough for a full note\\n\",\n-                              \"debuginfod: Corrupt note: only %ld bytes remain, \"\n-                              \"not enough for a full note\\n\",\n-                              data_remaining),\n-                    (long) data_remaining);\n-              break;\n+\t      warn (_(\"\\\n+malformed note encountered in section %s whilst scanning for build-id note\\n\"),\n+\t\t    printable_section_name (filedata, shdr));\n+              continue;\n             }\n           data_remaining -= min_notesz;\n \n@@ -14269,13 +14267,10 @@ get_build_id (void * data)\n           min_notesz = offsetof (Elf64_External_VMS_Note, name);\n           if (data_remaining < min_notesz)\n             {\n-              warn (ngettext (\"debuginfod: Corrupt note: only %ld byte remains, \"\n-                              \"not enough for a full note\\n\",\n-                              \"debuginfod: Corrupt note: only %ld bytes remain, \"\n-                              \"not enough for a full note\\n\",\n-                              data_remaining),\n-                    (long) data_remaining);\n-              break;\n+\t      warn (_(\"\\\n+malformed note encountered in section %s whilst scanning for build-id note\\n\"),\n+\t\t    printable_section_name (filedata, shdr));\n+              continue;\n             }\n           data_remaining -= min_notesz;\n \n@@ -14296,9 +14291,9 @@ get_build_id (void * data)\n           || ((size_t) (next - inote.descdata)\n               > data_remaining - (size_t) (inote.descdata - inote.namedata)))\n         {\n-          warn (_(\"debuginfod: note with invalid namesz and/or descsz found\\n\"));\n-          warn (_(\" type: 0x%lx, namesize: 0x%08lx, descsize: 0x%08lx, alignment: %u\\n\"),\n-                inote.type, inote.namesz, inote.descsz, (int) align);\n+\t  warn (_(\"\\\n+malformed note encountered in section %s whilst scanning for build-id note\\n\"),\n+\t\tprintable_section_name (filedata, shdr));\n           continue;\n         }\n \n@@ -14313,13 +14308,13 @@ get_build_id (void * data)\n \n           build_id = malloc (inote.descsz * 2 + 1);\n           if (build_id == NULL)\n-              return NULL;\n+\t    return NULL;\n \n           for (j = 0; j < inote.descsz; ++j)\n             sprintf (build_id + (j * 2), \"%02x\", inote.descdata[j] & 0xff);\n           build_id[inote.descsz * 2] = '\\0';\n \n-          return (unsigned char *)build_id;\n+          return (unsigned char *) build_id;\n         }\n     }\n "
    }
  ]
}