{
  "sha": "0e7e9601bed5600881225e22fd4306f11907858b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MGU3ZTk2MDFiZWQ1NjAwODgxMjI1ZTIyZmQ0MzA2ZjExOTA3ODU4Yg==",
  "commit": {
    "author": {
      "name": "Eric Botcazou",
      "email": "ebotcazou@gcc.gnu.org",
      "date": "2019-02-07T15:58:47Z"
    },
    "committer": {
      "name": "Eric Botcazou",
      "email": "ebotcazou@gcc.gnu.org",
      "date": "2019-02-07T15:58:47Z"
    },
    "message": "Visium: align branch absolute instruction for the GR6\n\nThis is done in order to avoid a pipeline hazard on the GR6.\n\ngas/\n\t* config/tc-visium.c (md_assemble) <mode_cad>: Align instruction\n\ton 64-bit boundaries for the GR6.\n\t* testsuite/gas/visium/allinsn_gr6.s: Tweak.\n\t* testsuite/gas/visium/allinsn_gr6.d: Likewise.\n\t* testsuite/gas/visium/bra-1.d: New test.\n\t* testsuite/gas/visium/bra-1.s: Likewise.\n\t* testsuite/gas/visium/visium.exp: Run bra-1 test.",
    "tree": {
      "sha": "5aeb7140567d210c02101235b50fa40d645e4f15",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/5aeb7140567d210c02101235b50fa40d645e4f15"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0e7e9601bed5600881225e22fd4306f11907858b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0e7e9601bed5600881225e22fd4306f11907858b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0e7e9601bed5600881225e22fd4306f11907858b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0e7e9601bed5600881225e22fd4306f11907858b/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "5d3db3e2970f543259103290d6890c0f1f289e13",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5d3db3e2970f543259103290d6890c0f1f289e13",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5d3db3e2970f543259103290d6890c0f1f289e13"
    }
  ],
  "stats": {
    "total": 51,
    "additions": 41,
    "deletions": 10
  },
  "files": [
    {
      "sha": "d5fc14b20b59345fa4b72531aac324df4d003f6a",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e7e9601bed5600881225e22fd4306f11907858b/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e7e9601bed5600881225e22fd4306f11907858b/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=0e7e9601bed5600881225e22fd4306f11907858b",
      "patch": "@@ -1,3 +1,13 @@\n+2019-02-07  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* config/tc-visium.c (md_assemble) <mode_cad>: Align instruction on\n+\t64-bit boundaries for the GR6.\n+\t* testsuite/gas/visium/allinsn_gr6.s: Tweak.\n+\t* testsuite/gas/visium/allinsn_gr6.d: Likewise.\n+\t* testsuite/gas/visium/bra-1.d: New test.\n+\t* testsuite/gas/visium/bra-1.s: Likewise.\n+\t* testsuite/gas/visium/visium.exp: Run bra-1 test.\n+\n 2019-01-31  John Darrington <john@darrington.wattle.id.au>\n \n         * config/tc-s12z.c (lex_imm): Add new argument exp_o."
    },
    {
      "sha": "bbd320e5edcd865ecb5e69e86dd2822f3e515ba4",
      "filename": "gas/config/tc-visium.c",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e7e9601bed5600881225e22fd4306f11907858b/gas/config/tc-visium.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e7e9601bed5600881225e22fd4306f11907858b/gas/config/tc-visium.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-visium.c?ref=0e7e9601bed5600881225e22fd4306f11907858b",
      "patch": "@@ -1368,6 +1368,10 @@ md_assemble (char *str0)\n       if (previous_mode == mode_cad || previous_mode == mode_ci)\n \tas_bad (\"branch instruction in delay slot\");\n \n+      /* For the GR6, BRA insns must be aligned on 64-bit boundaries.  */\n+      if (visium_arch == VISIUM_ARCH_GR6)\n+\tdo_align (3, NULL, 0, 0);\n+\n       this_dest = r3;\n       condition_code = cc;\n       break;"
    },
    {
      "sha": "c7f627bb34f12a9c94cf832afe105940fa68e491",
      "filename": "gas/testsuite/gas/visium/allinsn_gr6.d",
      "status": "modified",
      "additions": 6,
      "deletions": 6,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/allinsn_gr6.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/allinsn_gr6.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/visium/allinsn_gr6.d?ref=0e7e9601bed5600881225e22fd4306f11907858b",
      "patch": "@@ -86,10 +86,10 @@ Disassembly of section .text:\n  120:\t06 a5 1a 02 \tasr.w   r6,r5,0\n  124:\t86 a5 1a 12 \tasr.w   r6,r5,1\n  128:\t86 a7 23 f1 \tasr.b   r8,r7,31\n- 12c:\t0f 89 28 04 \tbra     eq,r9,r10\n- 130:\t07 a0 00 04 \trflag   r0\n- 134:\taf 87 04 04 \tbra     ne,r7,r1\n- 138:\t07 e0 ae 04 \treadmda r11\n+ 12c:\t07 a0 00 04 \trflag   r0\n+ 130:\t0f 89 28 04 \tbra     eq,r9,r10\n+ 134:\t07 e0 ae 04 \treadmda r11\n+ 138:\taf 87 04 04 \tbra     ne,r7,r1\n  13c:\t07 e0 b3 f4 \teamread r12,31\n  140:\t87 cd 30 04 \textb.l  r12,r13\n  144:\t87 cf 38 02 \textb.w  r14,r15\n@@ -130,8 +130,8 @@ Disassembly of section .text:\n  1d0:\t84 a7 7f ff \tmoviu   r7,0x7FFF\n  1d4:\t04 c6 00 01 \tmoviq   r6,1\n  1d8:\t84 47 ff ff \tsubi    r7,65535\n- 1dc:\tff 86 00 04 \tbra     tr,r6,r0\n- 1e0:\t86 00 00 04 \tadd.l   r0,r0,r0\n+ 1dc:\t86 00 00 04 \tadd.l   r0,r0,r0\n+ 1e0:\tff 86 00 04 \tbra     tr,r6,r0\n  1e4:\td3 e3 84 5c \tfpinst  10,f1,f3,f5\n  1e8:\tdb e4 88 6c \tfpinst  11,f2,f4,f6\n  1ec:\t7b ed ac fc \tfpinst  15,f11,f13,f15"
    },
    {
      "sha": "11006b836bcf99faba9046a2b6124919f4006ae1",
      "filename": "gas/testsuite/gas/visium/allinsn_gr6.s",
      "status": "modified",
      "additions": 3,
      "deletions": 4,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/allinsn_gr6.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/allinsn_gr6.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/visium/allinsn_gr6.s?ref=0e7e9601bed5600881225e22fd4306f11907858b",
      "patch": "@@ -93,11 +93,10 @@ sreg:\n \tasr.w\tr6,r5,1\n \tasr.b\tr8,r7,31\n \n-\tbra\teq,r9,r10\n \trflag\tr0\n-\tbra\tne,r7,r1\n-\n+\tbra\teq,r9,r10\n \teamread\tr11,0\n+\tbra\tne,r7,r1\n \teamread\tr12,31\n \n \textb.l\tr12,r13\n@@ -151,8 +150,8 @@ sreg:\n \tmoviq\tr6,1\n \tsubi\tr7,65535\n \n-\tbra\ttr,r6,r0\n \tadd.l\tr0,r0,r0\n+\tbra\ttr,r6,r0\n \n \n \tfpinst\t10,f1,f3,f5"
    },
    {
      "sha": "483b36bc8f44ba5c24dbf3c1cc1c24575281b072",
      "filename": "gas/testsuite/gas/visium/bra-1.d",
      "status": "added",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/bra-1.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/bra-1.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/visium/bra-1.d?ref=0e7e9601bed5600881225e22fd4306f11907858b",
      "patch": "@@ -0,0 +1,12 @@\n+#as: -mtune=gr6\n+#objdump: -d\n+#name: bra-1\n+\n+.*: +file format .*\n+\n+Disassembly of section .text:\n+\n+00000000 <foo>:\n+\t...\n+   8:\tff 95 54 04 \tbra     tr,r21,r21\n+   c:\t00 00 00 00 \tnop"
    },
    {
      "sha": "11544b887d2ff1f8e43a614d5e9ea412c39a78c0",
      "filename": "gas/testsuite/gas/visium/bra-1.s",
      "status": "added",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/bra-1.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/bra-1.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/visium/bra-1.s?ref=0e7e9601bed5600881225e22fd4306f11907858b",
      "patch": "@@ -0,0 +1,5 @@\n+        .text\n+foo:\n+\tnop\n+\tbra tr,r21,r21\n+\t nop"
    },
    {
      "sha": "4c1ac2c7e7a662da3fd0274ed19709a05cf7b693",
      "filename": "gas/testsuite/gas/visium/visium.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/visium.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e7e9601bed5600881225e22fd4306f11907858b/gas/testsuite/gas/visium/visium.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/visium/visium.exp?ref=0e7e9601bed5600881225e22fd4306f11907858b",
      "patch": "@@ -24,6 +24,7 @@ if [istarget visium-*-*] {\n     run_dump_test \"allinsn_def\"\n     run_dump_test \"allinsn_gr5\"\n     run_dump_test \"allinsn_gr6\"\n+    run_dump_test \"bra-1\"\n     run_dump_test \"brr-1\"\n     run_dump_test \"brr-2\"\n     run_dump_test \"high-1\""
    }
  ]
}