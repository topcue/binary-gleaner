{
  "sha": "a02a90c114cdee7951e7a623873b5025a1b7ab9f",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YTAyYTkwYzExNGNkZWU3OTUxZTdhNjIzODczYjUwMjVhMWI3YWI5Zg==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-09-12T09:30:06Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-09-12T09:30:06Z"
    },
    "message": "[gdb/testsuite] Set sysroot earlier in local-board.exp\n\nWhen running test-case gdb.base/batch-exit-status.exp for native, it passes.\nBut with target board cc-with-debug-names, we run into (added missing double\nquotes for clarity):\n...\nbuiltin_spawn $build/gdb/testsuite/../../gdb/gdb -nw -nx \\\n  -data-directory $build/gdb/testsuite/../data-directory \\\n  -iex \"set height 0\" -iex \"set width 0\" -ex \"set sysroot\" -batch \"\"^M\n: No such file or directory.^M\nPASS: gdb.base/batch-exit-status.exp: \\\n  : No such file or directory\\.: [lindex $result 2] == 0\nFAIL: gdb.base/batch-exit-status.exp: \\\n  : No such file or directory\\.: [lindex $result 3] == $expect_status\n...\n\nThe difference between the passing and failing case is that with native we\nhave (leaving out set height/width for brevity):\n...\n$ gdb -batch \"\"; echo $?\n: No such file or directory.\n1\n...\nand with target board cc-with-debug-names:\n...\n$ gdb -ex \"set sysroot\" -batch \"\"; echo $?\n: No such file or directory.\n0\n...\n\nThe difference is expected.  GDB returns the exit status of the last executed\ncommand.  In the former case that's 'file \"\"', which fails.  In the latter case,\nthat's 'set sysroot', which succeeds.\n\nFix this by setting sysroot using -iex instead of -ex in local-board.exp, such\nthat we have the expected:\n...\n$ gdb -iex \"set sysroot\" -batch \"\"; echo $?\n: No such file or directory.\n1\n...\n\nTested on x86_64-linux.",
    "tree": {
      "sha": "32b836f2d339611c4f41ff0122f6e4a02f1c078f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/32b836f2d339611c4f41ff0122f6e4a02f1c078f"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/a02a90c114cdee7951e7a623873b5025a1b7ab9f",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a02a90c114cdee7951e7a623873b5025a1b7ab9f",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/a02a90c114cdee7951e7a623873b5025a1b7ab9f",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a02a90c114cdee7951e7a623873b5025a1b7ab9f/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "58632d2856e9fed37fc8b249862b32b5cf48eec7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/58632d2856e9fed37fc8b249862b32b5cf48eec7",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/58632d2856e9fed37fc8b249862b32b5cf48eec7"
    }
  ],
  "stats": {
    "total": 2,
    "additions": 1,
    "deletions": 1
  },
  "files": [
    {
      "sha": "6523312b0cdb39eb1df89bc50999922a0450211b",
      "filename": "gdb/testsuite/boards/local-board.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a02a90c114cdee7951e7a623873b5025a1b7ab9f/gdb/testsuite/boards/local-board.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a02a90c114cdee7951e7a623873b5025a1b7ab9f/gdb/testsuite/boards/local-board.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/boards/local-board.exp?ref=a02a90c114cdee7951e7a623873b5025a1b7ab9f",
      "patch": "@@ -24,4 +24,4 @@ set baseboard [lindex [split $board \"/\"] 0]\n set board_info($baseboard,isremote) 0\n \n # Set sysroot to avoid sending files via the remote protocol.\n-set GDBFLAGS \"${GDBFLAGS} -ex \\\"set sysroot\\\"\"\n+set GDBFLAGS \"${GDBFLAGS} -iex \\\"set sysroot\\\"\""
    }
  ]
}