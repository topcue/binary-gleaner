{
  "sha": "f07afc65d018b3dc3f33e28223ba53ddf4682bbc",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZjA3YWZjNjVkMDE4YjNkYzNmMzNlMjgyMjNiYTUzZGRmNDY4MmJiYw==",
  "commit": {
    "author": {
      "name": "Rainer Orth",
      "email": "ro@CeBiTec.Uni-Bielefeld.DE",
      "date": "2021-07-07T11:51:55Z"
    },
    "committer": {
      "name": "Rainer Orth",
      "email": "ro@CeBiTec.Uni-Bielefeld.DE",
      "date": "2021-07-07T11:51:55Z"
    },
    "message": "Fix Solaris gprof build with --disable-nls\n\ngprof fails to compile on Solaris 10 and 11.3 with --disable-nls:\n\nIn file included from /vol/src/gnu/binutils/hg/binutils-2.37-branch/git/gprof/gprof.h:33,\n                 from /vol/src/gnu/binutils/hg/binutils-2.37-branch/git/gprof/basic_blocks.c:24:\n/usr/include/libintl.h:45:14: error: expected identifier or '(' before 'const'\n   45 | extern char *dcgettext(const char *, const char *, const int);\n      |              ^~~~~~~~~\n/usr/include/libintl.h:46:14: error: expected identifier or '(' before 'const'\n   46 | extern char *dgettext(const char *, const char *);\n      |              ^~~~~~~~\n/usr/include/libintl.h:47:14: error: expected identifier or '(' before 'const'\n   47 | extern char *gettext(const char *);\n      |              ^~~~~~~\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/gprof/../bfd/sysdep.h:165:33:\nerror: expected identifier or '(' before 'do'\n  165 | # define textdomain(Domainname) do {} while (0)\n      |                                 ^~\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/gprof/../bfd/sysdep.h:165:39:\nerror: expected identifier or '(' before 'while'\n  165 | # define textdomain(Domainname) do {} while (0)\n      |                                       ^~~~~\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/gprof/../bfd/sysdep.h:166:46:\nerror: expected identifier or '(' before 'do'\n  166 | # define bindtextdomain(Domainname, Dirname) do {} while (0)\n      |                                              ^~\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/gprof/../bfd/sysdep.h:166:52:\nerror: expected identifier or '(' before 'while'\n  166 | # define bindtextdomain(Domainname, Dirname) do {} while (0)\n      |                                                    ^~~~~\n/usr/include/libintl.h:55:14: error: expected identifier or '(' before 'unsigned'\n   55 | extern char *dcngettext(const char *, const char *,\n      |              ^~~~~~~~~~\n/usr/include/libintl.h:57:14: error: expected identifier or '(' before 'unsigned'\n   57 | extern char *dngettext(const char *, const char *,\n      |              ^~~~~~~~~\n/usr/include/libintl.h:59:14: error: expected identifier or '(' before 'unsigned'\n   59 | extern char *ngettext(const char *, const char *, unsigned long int);\n      |              ^~~~~~~~\n\nThis is a known issue already partially fixed in binutils/sysdep.h.  For\ngprof, the same fix needs to be applied in bfd/sysdep.h, as the\nfollowing patch does.  Tested on i386-pc-solaris2.10 and\ni386-pc-solaris2.11.\n\n2021-07-06  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n\n\tbfd:\n\t* sysdep.h [!ENABLE_NLS]: Prevent inclusion of <libintl.h> on\n\tSolaris.",
    "tree": {
      "sha": "0da8a08a250c77b28d6719236ad35325e7d8bbbe",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/0da8a08a250c77b28d6719236ad35325e7d8bbbe"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/f07afc65d018b3dc3f33e28223ba53ddf4682bbc",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f07afc65d018b3dc3f33e28223ba53ddf4682bbc",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/f07afc65d018b3dc3f33e28223ba53ddf4682bbc",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f07afc65d018b3dc3f33e28223ba53ddf4682bbc/comments",
  "author": {
    "login": "rorth",
    "id": 3930951,
    "node_id": "MDQ6VXNlcjM5MzA5NTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rorth",
    "html_url": "https://github.com/rorth",
    "followers_url": "https://api.github.com/users/rorth/followers",
    "following_url": "https://api.github.com/users/rorth/following{/other_user}",
    "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rorth/subscriptions",
    "organizations_url": "https://api.github.com/users/rorth/orgs",
    "repos_url": "https://api.github.com/users/rorth/repos",
    "events_url": "https://api.github.com/users/rorth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rorth/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "rorth",
    "id": 3930951,
    "node_id": "MDQ6VXNlcjM5MzA5NTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rorth",
    "html_url": "https://github.com/rorth",
    "followers_url": "https://api.github.com/users/rorth/followers",
    "following_url": "https://api.github.com/users/rorth/following{/other_user}",
    "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rorth/subscriptions",
    "organizations_url": "https://api.github.com/users/rorth/orgs",
    "repos_url": "https://api.github.com/users/rorth/repos",
    "events_url": "https://api.github.com/users/rorth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rorth/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0"
    }
  ],
  "stats": {
    "total": 16,
    "additions": 16,
    "deletions": 0
  },
  "files": [
    {
      "sha": "e0cb2bfd291e91672cb256b886d3c08f105f489b",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f07afc65d018b3dc3f33e28223ba53ddf4682bbc/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f07afc65d018b3dc3f33e28223ba53ddf4682bbc/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=f07afc65d018b3dc3f33e28223ba53ddf4682bbc",
      "patch": "@@ -1,3 +1,8 @@\n+2021-07-07  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* sysdep.h [!ENABLE_NLS]: Prevent inclusion of <libintl.h> on\n+\tSolaris.\n+\n 2021-07-07  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* configure.ac: Check for strnlen declaration."
    },
    {
      "sha": "8919e7689fd112985babceda2aba52327a0d3e25",
      "filename": "bfd/sysdep.h",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f07afc65d018b3dc3f33e28223ba53ddf4682bbc/bfd/sysdep.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f07afc65d018b3dc3f33e28223ba53ddf4682bbc/bfd/sysdep.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/sysdep.h?ref=f07afc65d018b3dc3f33e28223ba53ddf4682bbc",
      "patch": "@@ -126,6 +126,17 @@ extern int fseeko64 (FILE *stream, off64_t offset, int whence);\n #define offsetof(TYPE, MEMBER) ((size_t) &((TYPE *)0)->MEMBER)\n #endif\n \n+#ifndef ENABLE_NLS\n+  /* The Solaris version of locale.h always includes libintl.h.  If we have\n+     been configured with --disable-nls then ENABLE_NLS will not be defined\n+     and the dummy definitions of bindtextdomain (et al) below will conflict\n+     with the defintions in libintl.h.  So we define these values to prevent\n+     the bogus inclusion of libintl.h.  */\n+# define _LIBINTL_H\n+# define _LIBGETTEXT_H\n+#endif\n+#include <locale.h>\n+\n #ifdef ENABLE_NLS\n # include <libintl.h>\n /* Note the redefinition of gettext and ngettext here to use PACKAGE."
    }
  ]
}