{
  "sha": "569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NTY5ZDUwZjFjNjExNjkwZDlhYjRmYTI1ZWFkZjBlZDU2NWJmN2U3Ng==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2019-12-11T08:42:29Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2019-12-11T08:42:29Z"
    },
    "message": "x86: further refine SSE check (SSE4a, SHA, GFNI)\n\nIn  (\"x86: extend SSE check to PCLMULQDQ, AES, and GFNI insns\") I went\nboth a little too far and not quite far enough:\n- GFNI insns also have AVX512 variants, which also shouldn't get\n  diagnosed,\n- SSE4a insns should get diagnosed just like SSE4.x ones,\n- SHA insns should get diagnosed just like PCLMULQDQ or AES ones.",
    "tree": {
      "sha": "51704f4fb691317ad889281391cd9ccf5eda869d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/51704f4fb691317ad889281391cd9ccf5eda869d"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/comments",
  "author": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d8edc8b768f0f611088161161392e1075134d635",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d8edc8b768f0f611088161161392e1075134d635",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d8edc8b768f0f611088161161392e1075134d635"
    }
  ],
  "stats": {
    "total": 113,
    "additions": 88,
    "deletions": 25
  },
  "files": [
    {
      "sha": "4931c1a8115b5c6c384a06e1c115a16853d6a248",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
      "patch": "@@ -1,3 +1,13 @@\n+2018-12-11  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* config/tc-i386.c (md_assemble): Extend SSE check conditional.\n+\t* testsuite/gas/i386/sse-check.s: Add SSE4a and SHA tests.\n+\tExtend GFNI tests.\n+\t* testsuite/gas/i386/sse-check.d: Adjust expectations.\n+\t* testsuite/gas/i386/sse-check-error.l,\n+\ttestsuite/gas/i386/x86-64-sse-check-error.l: Likewise.\n+\t* testsuite/gas/i386/sse-check-warn.e: Likewise.\n+\n 2019-12-10  Vladimir Murzin  <vladimir.murzin@arm.com>\n \n \t* config/tc-arm.c (s_arm_arch): Set selected_ctx_ext_table."
    },
    {
      "sha": "accb6342038a5de8ea520fd19451fa96dce5bf77",
      "filename": "gas/config/tc-i386.c",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/config/tc-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/config/tc-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.c?ref=569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
      "patch": "@@ -4286,14 +4286,17 @@ md_assemble (char *line)\n   if (sse_check != check_none\n       && !i.tm.opcode_modifier.noavx\n       && !i.tm.cpu_flags.bitfield.cpuavx\n+      && !i.tm.cpu_flags.bitfield.cpuavx512f\n       && (i.tm.cpu_flags.bitfield.cpusse\n \t  || i.tm.cpu_flags.bitfield.cpusse2\n \t  || i.tm.cpu_flags.bitfield.cpusse3\n \t  || i.tm.cpu_flags.bitfield.cpussse3\n \t  || i.tm.cpu_flags.bitfield.cpusse4_1\n \t  || i.tm.cpu_flags.bitfield.cpusse4_2\n+\t  || i.tm.cpu_flags.bitfield.cpusse4a\n \t  || i.tm.cpu_flags.bitfield.cpupclmul\n \t  || i.tm.cpu_flags.bitfield.cpuaes\n+\t  || i.tm.cpu_flags.bitfield.cpusha\n \t  || i.tm.cpu_flags.bitfield.cpugfni))\n     {\n       (sse_check == check_warning"
    },
    {
      "sha": "30498b7e39ec079ec74d39972dc966e9a9c99b7e",
      "filename": "gas/testsuite/gas/i386/sse-check-error.l",
      "status": "modified",
      "additions": 29,
      "deletions": 11,
      "changes": 40,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/sse-check-error.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/sse-check-error.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/sse-check-error.l?ref=569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
      "patch": "@@ -8,6 +8,8 @@\n .*:23: Error: .*\n .*:26: Error: .*\n .*:29: Error: .*\n+.*:32: Error: .*\n+.*:35: Error: .*\n GAS LISTING .*\n \n \n@@ -42,17 +44,33 @@ GAS LISTING .*\n .*  Error: SSE instruction `pcmpgtq' is used\n [ \t]*20[ \t]+C1\n [ \t]*21[ \t]+\n-[ \t]*22[ \t]+\\# PCMUL instruction\n-[ \t]*23[ \t]+\\?\\?\\?\\? 660F3A44 \t\tpclmulqdq \\$-1,%xmm1,%xmm2\n-.*  Error: SSE instruction `pclmulqdq' is used\n-[ \t]*23[ \t]+D1FF\n+[ \t]*22[ \t]+\\# SSE4a instruction\n+[ \t]*23[ \t]+\\?\\?\\?\\? 660F78C0 \t\textrq \\$0, \\$0, %xmm0\n+.*  Error: SSE instruction `extrq' is used\n+[ \t]*23[ \t]+0000\n [ \t]*24[ \t]+\n-[ \t]*25[ \t]+\\# AES instructions\n-[ \t]*26[ \t]+\\?\\?\\?\\? 660F38DE \t\taesdec %xmm1,%xmm2\n-.*  Error: SSE instruction `aesdec' is used\n-[ \t]*26[ \t]+D1\n+[ \t]*25[ \t]+\\# PCMUL instruction\n+[ \t]*26[ \t]+\\?\\?\\?\\? 660F3A44 \t\tpclmulqdq \\$-1,%xmm1,%xmm2\n+.*  Error: SSE instruction `pclmulqdq' is used\n+[ \t]*26[ \t]+D1FF\n [ \t]*27[ \t]+\n-[ \t]*28[ \t]+\\# GFNI instructions\n-[ \t]*29[ \t]+\\?\\?\\?\\? 660F38CF \t\tgf2p8mulb %xmm1,%xmm2\n-.*  Error: SSE instruction `gf2p8mulb' is used\n+[ \t]*28[ \t]+\\# AES instructions\n+[ \t]*29[ \t]+\\?\\?\\?\\? 660F38DE \t\taesdec %xmm1,%xmm2\n+.*  Error: SSE instruction `aesdec' is used\n [ \t]*29[ \t]+D1\n+[ \t]*30[ \t]+\n+[ \t]*31[ \t]+\\# SHA instruction\n+[ \t]*32[ \t]+\\?\\?\\?\\? 0F38C8C0 \t\tsha1nexte %xmm0, %xmm0\n+.*  Error: SSE instruction `sha1nexte' is used\n+[ \t]*33[ \t]+\n+[ \t]*34[ \t]+\\# GFNI instructions\n+[ \t]*35[ \t]+\\?\\?\\?\\? 660F38CF \t\tgf2p8mulb %xmm1,%xmm2\n+.*  Error: SSE instruction `gf2p8mulb' is used\n+[ \t]*35[ \t]+D1\n+[ \t]*36[ \t]+\\?\\?\\?\\? 62F27D09 \t\tvgf2p8mulb %xmm0, %xmm0, %xmm0\\{%k1\\}\n+[ \t]*36[ \t]+CFC0\n+[ \t]*37[ \t]+\\?\\?\\?\\? 62F27D48 \t\tvgf2p8mulb %zmm0, %zmm0, %zmm0\n+\fGAS LISTING .*\n+\n+\n+[ \t]*37[ \t]+CFC0"
    },
    {
      "sha": "33f07b24ebaf83b220a667ad692df455960f1e95",
      "filename": "gas/testsuite/gas/i386/sse-check-warn.e",
      "status": "modified",
      "additions": 5,
      "deletions": 3,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/sse-check-warn.e",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/sse-check-warn.e",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/sse-check-warn.e?ref=569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
      "patch": "@@ -5,6 +5,8 @@\n .*:16: Warning: SSE instruction `phaddw' is used\n .*:19: Warning: SSE instruction `blendvpd' is used\n .*:20: Warning: SSE instruction `pcmpgtq' is used\n-.*:23: Warning: SSE instruction `pclmulqdq' is used\n-.*:26: Warning: SSE instruction `aesdec' is used\n-.*:29: Warning: SSE instruction `gf2p8mulb' is used\n+.*:23: Warning: SSE instruction `extrq' is used\n+.*:26: Warning: SSE instruction `pclmulqdq' is used\n+.*:29: Warning: SSE instruction `aesdec' is used\n+.*:32: Warning: SSE instruction `sha1nexte' is used\n+.*:35: Warning: SSE instruction `gf2p8mulb' is used"
    },
    {
      "sha": "dd4d21aa3889d12ec6cdd20df845730516b78ae1",
      "filename": "gas/testsuite/gas/i386/sse-check.d",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/sse-check.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/sse-check.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/sse-check.d?ref=569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
      "patch": "@@ -13,7 +13,11 @@ Disassembly of section .text:\n [ \t]*[a-f0-9]+:\t66 0f 38 01 ca       \tphaddw %xmm2,%xmm1\n [ \t]*[a-f0-9]+:\t66 0f 38 15 c1       \tblendvpd %xmm0,%xmm1,%xmm0\n [ \t]*[a-f0-9]+:\t66 0f 38 37 c1       \tpcmpgtq %xmm1,%xmm0\n+[ \t]*[a-f0-9]+:\t66 0f 78 c0 00 00    \textrq  \\$0x0,\\$0x0,%xmm0\n [ \t]*[a-f0-9]+:\t66 0f 3a 44 d1 ff    \tpclmulqdq \\$0xff,%xmm1,%xmm2\n [ \t]*[a-f0-9]+:\t66 0f 38 de d1       \taesdec %xmm1,%xmm2\n+[ \t]*[a-f0-9]+:\t0f 38 c8 c0          \tsha1nexte %xmm0,%xmm0\n [ \t]*[a-f0-9]+:\t66 0f 38 cf d1       \tgf2p8mulb %xmm1,%xmm2\n+[ \t]*[a-f0-9]+:\t62 f2 7d 09 cf c0    \tvgf2p8mulb %xmm0,%xmm0,%xmm0\\{%k1\\}\n+[ \t]*[a-f0-9]+:\t62 f2 7d 48 cf c0    \tvgf2p8mulb %zmm0,%zmm0,%zmm0\n #pass"
    },
    {
      "sha": "a76d1ef9bc4a2113f47dc6c702e02ad83e53c992",
      "filename": "gas/testsuite/gas/i386/sse-check.s",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/sse-check.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/sse-check.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/sse-check.s?ref=569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
      "patch": "@@ -19,11 +19,19 @@ _start:\n \tblendvpd %xmm0,%xmm1,%xmm0\n \tpcmpgtq %xmm1,%xmm0\n \n+# SSE4a instruction\n+\textrq $0, $0, %xmm0\n+\n # PCMUL instruction\n \tpclmulqdq $-1,%xmm1,%xmm2\n \n # AES instructions\n \taesdec %xmm1,%xmm2\n \n+# SHA instruction\n+\tsha1nexte %xmm0, %xmm0\n+\n # GFNI instructions\n \tgf2p8mulb %xmm1,%xmm2\n+\tvgf2p8mulb %xmm0, %xmm0, %xmm0{%k1}\n+\tvgf2p8mulb %zmm0, %zmm0, %zmm0"
    },
    {
      "sha": "30498b7e39ec079ec74d39972dc966e9a9c99b7e",
      "filename": "gas/testsuite/gas/i386/x86-64-sse-check-error.l",
      "status": "modified",
      "additions": 29,
      "deletions": 11,
      "changes": 40,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/x86-64-sse-check-error.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/569d50f1c611690d9ab4fa25eadf0ed565bf7e76/gas/testsuite/gas/i386/x86-64-sse-check-error.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-sse-check-error.l?ref=569d50f1c611690d9ab4fa25eadf0ed565bf7e76",
      "patch": "@@ -8,6 +8,8 @@\n .*:23: Error: .*\n .*:26: Error: .*\n .*:29: Error: .*\n+.*:32: Error: .*\n+.*:35: Error: .*\n GAS LISTING .*\n \n \n@@ -42,17 +44,33 @@ GAS LISTING .*\n .*  Error: SSE instruction `pcmpgtq' is used\n [ \t]*20[ \t]+C1\n [ \t]*21[ \t]+\n-[ \t]*22[ \t]+\\# PCMUL instruction\n-[ \t]*23[ \t]+\\?\\?\\?\\? 660F3A44 \t\tpclmulqdq \\$-1,%xmm1,%xmm2\n-.*  Error: SSE instruction `pclmulqdq' is used\n-[ \t]*23[ \t]+D1FF\n+[ \t]*22[ \t]+\\# SSE4a instruction\n+[ \t]*23[ \t]+\\?\\?\\?\\? 660F78C0 \t\textrq \\$0, \\$0, %xmm0\n+.*  Error: SSE instruction `extrq' is used\n+[ \t]*23[ \t]+0000\n [ \t]*24[ \t]+\n-[ \t]*25[ \t]+\\# AES instructions\n-[ \t]*26[ \t]+\\?\\?\\?\\? 660F38DE \t\taesdec %xmm1,%xmm2\n-.*  Error: SSE instruction `aesdec' is used\n-[ \t]*26[ \t]+D1\n+[ \t]*25[ \t]+\\# PCMUL instruction\n+[ \t]*26[ \t]+\\?\\?\\?\\? 660F3A44 \t\tpclmulqdq \\$-1,%xmm1,%xmm2\n+.*  Error: SSE instruction `pclmulqdq' is used\n+[ \t]*26[ \t]+D1FF\n [ \t]*27[ \t]+\n-[ \t]*28[ \t]+\\# GFNI instructions\n-[ \t]*29[ \t]+\\?\\?\\?\\? 660F38CF \t\tgf2p8mulb %xmm1,%xmm2\n-.*  Error: SSE instruction `gf2p8mulb' is used\n+[ \t]*28[ \t]+\\# AES instructions\n+[ \t]*29[ \t]+\\?\\?\\?\\? 660F38DE \t\taesdec %xmm1,%xmm2\n+.*  Error: SSE instruction `aesdec' is used\n [ \t]*29[ \t]+D1\n+[ \t]*30[ \t]+\n+[ \t]*31[ \t]+\\# SHA instruction\n+[ \t]*32[ \t]+\\?\\?\\?\\? 0F38C8C0 \t\tsha1nexte %xmm0, %xmm0\n+.*  Error: SSE instruction `sha1nexte' is used\n+[ \t]*33[ \t]+\n+[ \t]*34[ \t]+\\# GFNI instructions\n+[ \t]*35[ \t]+\\?\\?\\?\\? 660F38CF \t\tgf2p8mulb %xmm1,%xmm2\n+.*  Error: SSE instruction `gf2p8mulb' is used\n+[ \t]*35[ \t]+D1\n+[ \t]*36[ \t]+\\?\\?\\?\\? 62F27D09 \t\tvgf2p8mulb %xmm0, %xmm0, %xmm0\\{%k1\\}\n+[ \t]*36[ \t]+CFC0\n+[ \t]*37[ \t]+\\?\\?\\?\\? 62F27D48 \t\tvgf2p8mulb %zmm0, %zmm0, %zmm0\n+\fGAS LISTING .*\n+\n+\n+[ \t]*37[ \t]+CFC0"
    }
  ]
}