{
  "sha": "22ccb8495447fa2ea31b1f1dea7e94eecf97475d",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MjJjY2I4NDk1NDQ3ZmEyZWEzMWIxZjFkZWE3ZTk0ZWVjZjk3NDc1ZA==",
  "commit": {
    "author": {
      "name": "Nick Alcock",
      "email": "nick.alcock@oracle.com",
      "date": "2019-07-13T20:47:30Z"
    },
    "committer": {
      "name": "Nick Alcock",
      "email": "nick.alcock@oracle.com",
      "date": "2019-10-03T16:04:55Z"
    },
    "message": "bfd: new functions for getting strings out of a strtab\n\nThe CTF linking process wants to deduplicate the CTF strtab against the\nELF strtab, for which it needs to know the number of strings in the\nstrtab and it needs to be able to extract them one by one.\n\nThe BFD strtab functions only support returning the\nsize-or-section-length of the strtab (with _bfd_elf_strtab_size)\nand returning the offset (but not string!) and decrementing the refcount\nat the same time.\n\nSo add new functions _bfd_elf_strtab_len (that just returns the length\nin strings of the strtab, never the section size) and bfd_elf_strtab_str\n(which returns the string at a given strtab index, and its offset,\nwithout touching the refcount).\n\nIt is probably a mistake to use _bfd_elf_strtab_str in particular before\n_bfd_elf_strtab_finalize is called, and will not produce useful output\nif you do so.\n\nv5: fix tabdamage.\n\nbfd/\n\t* elf-strtab.c (_bfd_elf_strtab_len): New.\n\t(_bfd_elf_strtab_str): Likewise.\n\t* bfd-elf.h: Declare them.",
    "tree": {
      "sha": "06f9f4cb797543f75c479e20614634422e20d351",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/06f9f4cb797543f75c479e20614634422e20d351"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/22ccb8495447fa2ea31b1f1dea7e94eecf97475d",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/22ccb8495447fa2ea31b1f1dea7e94eecf97475d",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/22ccb8495447fa2ea31b1f1dea7e94eecf97475d",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/22ccb8495447fa2ea31b1f1dea7e94eecf97475d/comments",
  "author": {
    "login": "nickalcock",
    "id": 6503005,
    "node_id": "MDQ6VXNlcjY1MDMwMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6503005?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickalcock",
    "html_url": "https://github.com/nickalcock",
    "followers_url": "https://api.github.com/users/nickalcock/followers",
    "following_url": "https://api.github.com/users/nickalcock/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickalcock/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickalcock/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickalcock/subscriptions",
    "organizations_url": "https://api.github.com/users/nickalcock/orgs",
    "repos_url": "https://api.github.com/users/nickalcock/repos",
    "events_url": "https://api.github.com/users/nickalcock/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickalcock/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickalcock",
    "id": 6503005,
    "node_id": "MDQ6VXNlcjY1MDMwMDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6503005?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickalcock",
    "html_url": "https://github.com/nickalcock",
    "followers_url": "https://api.github.com/users/nickalcock/followers",
    "following_url": "https://api.github.com/users/nickalcock/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickalcock/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickalcock/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickalcock/subscriptions",
    "organizations_url": "https://api.github.com/users/nickalcock/orgs",
    "repos_url": "https://api.github.com/users/nickalcock/repos",
    "events_url": "https://api.github.com/users/nickalcock/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickalcock/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "f046147d59aab0c8b6f00cd182f34b42ac8915e8",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f046147d59aab0c8b6f00cd182f34b42ac8915e8",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/f046147d59aab0c8b6f00cd182f34b42ac8915e8"
    }
  ],
  "stats": {
    "total": 29,
    "additions": 29,
    "deletions": 0
  },
  "files": [
    {
      "sha": "420b13dd101baeb4fff31e59fe6b148d3d12b2b7",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/22ccb8495447fa2ea31b1f1dea7e94eecf97475d/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/22ccb8495447fa2ea31b1f1dea7e94eecf97475d/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=22ccb8495447fa2ea31b1f1dea7e94eecf97475d",
      "patch": "@@ -1,3 +1,9 @@\n+2019-07-13  Nick Alcock  <nick.alcock@oracle.com>\n+\n+\t* elf-strtab.c (_bfd_elf_strtab_len): New.\n+\t(_bfd_elf_strtab_str): Likewise.\n+\t* bfd-elf.h: Declare them.\n+\n 2019-07-13  Nick Alcock  <nick.alcock@oracle.com>\n \n \t* elf-bfd.h (bfd_elf_get_str_section): Add."
    },
    {
      "sha": "4240d97a429a9cec0ab08fd39410e75116835682",
      "filename": "bfd/elf-bfd.h",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/22ccb8495447fa2ea31b1f1dea7e94eecf97475d/bfd/elf-bfd.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/22ccb8495447fa2ea31b1f1dea7e94eecf97475d/bfd/elf-bfd.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf-bfd.h?ref=22ccb8495447fa2ea31b1f1dea7e94eecf97475d",
      "patch": "@@ -2252,8 +2252,12 @@ extern void _bfd_elf_strtab_restore\n   (struct elf_strtab_hash *, void *);\n extern bfd_size_type _bfd_elf_strtab_size\n   (struct elf_strtab_hash *);\n+extern bfd_size_type _bfd_elf_strtab_len\n+  (struct elf_strtab_hash *);\n extern bfd_size_type _bfd_elf_strtab_offset\n   (struct elf_strtab_hash *, size_t);\n+extern const char * _bfd_elf_strtab_str\n+  (struct elf_strtab_hash *, size_t idx, size_t *offset);\n extern bfd_boolean _bfd_elf_strtab_emit\n   (bfd *, struct elf_strtab_hash *);\n extern void _bfd_elf_strtab_finalize"
    },
    {
      "sha": "cc1dcb3f50a22c47095b981e6d84b943fc627dfc",
      "filename": "bfd/elf-strtab.c",
      "status": "modified",
      "additions": 19,
      "deletions": 0,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/22ccb8495447fa2ea31b1f1dea7e94eecf97475d/bfd/elf-strtab.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/22ccb8495447fa2ea31b1f1dea7e94eecf97475d/bfd/elf-strtab.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf-strtab.c?ref=22ccb8495447fa2ea31b1f1dea7e94eecf97475d",
      "patch": "@@ -270,6 +270,12 @@ _bfd_elf_strtab_size (struct elf_strtab_hash *tab)\n   return tab->sec_size ? tab->sec_size : tab->size;\n }\n \n+bfd_size_type\n+_bfd_elf_strtab_len (struct elf_strtab_hash *tab)\n+{\n+  return tab->size;\n+}\n+\n bfd_size_type\n _bfd_elf_strtab_offset (struct elf_strtab_hash *tab, size_t idx)\n {\n@@ -285,6 +291,19 @@ _bfd_elf_strtab_offset (struct elf_strtab_hash *tab, size_t idx)\n   return tab->array[idx]->u.index;\n }\n \n+const char *\n+_bfd_elf_strtab_str (struct elf_strtab_hash *tab, size_t idx,\n+\t\t     bfd_size_type *offset)\n+{\n+  if (idx == 0)\n+    return 0;\n+  BFD_ASSERT (idx < tab->size);\n+  BFD_ASSERT (tab->sec_size);\n+  if (offset)\n+    *offset = tab->array[idx]->u.index;\n+  return tab->array[idx]->root.string;\n+}\n+\n bfd_boolean\n _bfd_elf_strtab_emit (register bfd *abfd, struct elf_strtab_hash *tab)\n {"
    }
  ]
}