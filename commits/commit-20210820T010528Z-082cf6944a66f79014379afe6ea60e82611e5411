{
  "sha": "082cf6944a66f79014379afe6ea60e82611e5411",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDgyY2Y2OTQ0YTY2Zjc5MDE0Mzc5YWZlNmVhNjBlODI2MTFlNTQxMQ==",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-07-07T01:18:58Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-08-20T01:05:28Z"
    },
    "message": "sim: nltvals: switch output mode to a directory\n\nIn preparation for this script generating more files, change the output\nargument to specify a directory.  This drops the stdout behavior, but\nsince no one really runs this tool directly, it's not a big deal.",
    "tree": {
      "sha": "971da2e8dead61c3ad6038b06d516fb7c8a484bc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/971da2e8dead61c3ad6038b06d516fb7c8a484bc"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/082cf6944a66f79014379afe6ea60e82611e5411",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/082cf6944a66f79014379afe6ea60e82611e5411",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/082cf6944a66f79014379afe6ea60e82611e5411",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/082cf6944a66f79014379afe6ea60e82611e5411/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "f28b723787e28e6aa730f1987b054f46e606f2f5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f28b723787e28e6aa730f1987b054f46e606f2f5",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/f28b723787e28e6aa730f1987b054f46e606f2f5"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 10,
    "deletions": 9
  },
  "files": [
    {
      "sha": "8f53aa80da75b94f2cbb6b1e5639f638f8940a8f",
      "filename": "sim/Makefile.am",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/082cf6944a66f79014379afe6ea60e82611e5411/sim/Makefile.am",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/082cf6944a66f79014379afe6ea60e82611e5411/sim/Makefile.am",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/Makefile.am?ref=082cf6944a66f79014379afe6ea60e82611e5411",
      "patch": "@@ -55,8 +55,7 @@ SIM_ALL_RECURSIVE_DEPS =\n # An alternative is to slurp in the tables at runtime.\n .PHONY: nltvals\n nltvals:\n-\t$(abs_srcdir)/common/gennltvals.py --cpp \"$(CPP)\" --output nltvals.def --srcroot $(srcroot)\n-\t$(SHELL) $(srcroot)/move-if-change nltvals.def $(abs_srcdir)/common/nltvals.def\n+\t$(srcdir)/common/gennltvals.py --cpp \"$(CPP)\"\n \n pkginclude_HEADERS = \\\n \t$(srcroot)/include/sim/callback.h \\"
    },
    {
      "sha": "7644a43c0ac122032c746fcbefa344482e5f1406",
      "filename": "sim/Makefile.in",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/082cf6944a66f79014379afe6ea60e82611e5411/sim/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/082cf6944a66f79014379afe6ea60e82611e5411/sim/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/Makefile.in?ref=082cf6944a66f79014379afe6ea60e82611e5411",
      "patch": "@@ -1747,8 +1747,7 @@ uninstall-am: uninstall-pkgincludeHEADERS\n # An alternative is to slurp in the tables at runtime.\n .PHONY: nltvals\n nltvals:\n-\t$(abs_srcdir)/common/gennltvals.py --cpp \"$(CPP)\" --output nltvals.def --srcroot $(srcroot)\n-\t$(SHELL) $(srcroot)/move-if-change nltvals.def $(abs_srcdir)/common/nltvals.def\n+\t$(srcdir)/common/gennltvals.py --cpp \"$(CPP)\"\n \n common/version.c: common/version.c-stamp ; @true\n common/version.c-stamp: $(srcroot)/gdb/version.in $(srcroot)/bfd/version.h $(srcdir)/common/create-version.sh"
    },
    {
      "sha": "db3ff641d402419b1613fd481914d2bc41d17c99",
      "filename": "sim/common/gennltvals.py",
      "status": "modified",
      "additions": 8,
      "deletions": 5,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/082cf6944a66f79014379afe6ea60e82611e5411/sim/common/gennltvals.py",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/082cf6944a66f79014379afe6ea60e82611e5411/sim/common/gennltvals.py",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/gennltvals.py?ref=082cf6944a66f79014379afe6ea60e82611e5411",
      "patch": "@@ -160,7 +160,7 @@ def get_parser() -> argparse.ArgumentParser:\n         formatter_class=argparse.RawDescriptionHelpFormatter)\n     parser.add_argument(\n         '-o', '--output', type=Path,\n-        help='write to the specified file instead of stdout')\n+        help='write to the specified directory')\n     parser.add_argument(\n         '--cpp', type=str, default='cpp',\n         help='the preprocessor to use')\n@@ -178,8 +178,14 @@ def parse_args(argv: List[str]) -> argparse.Namespace:\n     parser = get_parser()\n     opts = parser.parse_args(argv)\n \n+    if opts.output is None:\n+        # Default to where the script lives.\n+        opts.output = Path(__file__).resolve().parent\n+\n     if opts.srcroot is None:\n         opts.srcroot = Path(__file__).resolve().parent.parent.parent\n+    else:\n+        opts.srcroot = opts.srcroot.resolve()\n \n     if opts.newlib is None:\n         # Try to find newlib relative to our source tree.\n@@ -202,10 +208,7 @@ def main(argv: List[str]) -> int:\n     \"\"\"The main entry point for scripts.\"\"\"\n     opts = parse_args(argv)\n \n-    if opts.output is not None:\n-        output = open(opts.output, 'w', encoding='utf-8')\n-    else:\n-        output = sys.stdout\n+    output = (opts.output / 'nltvals.def').open('w', encoding='utf-8')\n \n     gen(output, opts.newlib, opts.cpp)\n     return 0"
    }
  ]
}