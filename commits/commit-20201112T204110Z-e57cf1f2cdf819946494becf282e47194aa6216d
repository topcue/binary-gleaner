{
  "sha": "e57cf1f2cdf819946494becf282e47194aa6216d",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZTU3Y2YxZjJjZGY4MTk5NDY0OTRiZWNmMjgyZTQ3MTk0YWE2MjE2ZA==",
  "commit": {
    "author": {
      "name": "Dimitar Dimitrov",
      "email": "dimitar@dinux.eu",
      "date": "2020-11-12T20:23:26Z"
    },
    "committer": {
      "name": "Dimitar Dimitrov",
      "email": "dimitar@dinux.eu",
      "date": "2020-11-12T20:41:10Z"
    },
    "message": "sim: pru: Add support for LMBD instruction\n\nBinutils support for LMBD instruction was merged [1]. So add it also\nto simulator.\n\nLMBD instruction does left-most-bit-detection. It returns 32 if\nthe given bit value is not found in the provided word value.\n\n[1] https://sourceware.org/pipermail/binutils/2020-October/113901.html\n\nsim/pru/ChangeLog:\n\n\t* pru.h (RS1SEL): New macro.\n\t(RS1_WIDTH): New macro.\n\t* pru.isa: Describe the LMBD instruction.\n\nsim/testsuite/sim/pru/ChangeLog:\n\n\t* lmbd.s: New test.",
    "tree": {
      "sha": "b30063156b4d1d911a625aaf4b53c8155ab25dbf",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/b30063156b4d1d911a625aaf4b53c8155ab25dbf"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e57cf1f2cdf819946494becf282e47194aa6216d",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e57cf1f2cdf819946494becf282e47194aa6216d",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e57cf1f2cdf819946494becf282e47194aa6216d",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e57cf1f2cdf819946494becf282e47194aa6216d/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "1350c3b47a6fed106d1f6814376dd12dea8a14d0",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1350c3b47a6fed106d1f6814376dd12dea8a14d0",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/1350c3b47a6fed106d1f6814376dd12dea8a14d0"
    }
  ],
  "stats": {
    "total": 88,
    "additions": 88,
    "deletions": 0
  },
  "files": [
    {
      "sha": "ad9aff9408b1c0a20e2cb1d94760824fba512c8f",
      "filename": "sim/pru/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e57cf1f2cdf819946494becf282e47194aa6216d/sim/pru/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e57cf1f2cdf819946494becf282e47194aa6216d/sim/pru/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/pru/ChangeLog?ref=e57cf1f2cdf819946494becf282e47194aa6216d",
      "patch": "@@ -1,3 +1,9 @@\n+2020-11-12  Dimitar Dimitrov  <dimitar@dinux.eu>\n+\n+\t* pru.h (RS1SEL): New macro.\n+\t(RS1_WIDTH): New macro.\n+\t* pru.isa: Describe the LMBD instruction.\n+\n 2019-09-23  Dimitar Dimitrov  <dimitar@dinux.eu>\n \n \t* Makefile.in: New file."
    },
    {
      "sha": "cbcc3ef9d78c3bc8716e88531e426ce0f41e16fe",
      "filename": "sim/pru/pru.h",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e57cf1f2cdf819946494becf282e47194aa6216d/sim/pru/pru.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e57cf1f2cdf819946494becf282e47194aa6216d/sim/pru/pru.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/pru/pru.h?ref=e57cf1f2cdf819946494becf282e47194aa6216d",
      "patch": "@@ -58,6 +58,8 @@\n \n #define XBBO_BASEREG (CPU.regs[GET_INSN_FIELD (RS1, inst)])\n \n+#define RS1SEL GET_INSN_FIELD (RS1SEL, inst)\n+#define RS1_WIDTH regsel_width (RS1SEL)\n #define RDSEL GET_INSN_FIELD (RDSEL, inst)\n #define RD_WIDTH regsel_width (RDSEL)\n #define RD_REGN GET_INSN_FIELD (RD, inst)"
    },
    {
      "sha": "c7860d0191b9fc908294d4a3bb1a8c83c603f411",
      "filename": "sim/pru/pru.isa",
      "status": "modified",
      "additions": 15,
      "deletions": 0,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e57cf1f2cdf819946494becf282e47194aa6216d/sim/pru/pru.isa",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e57cf1f2cdf819946494becf282e47194aa6216d/sim/pru/pru.isa",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/pru/pru.isa?ref=e57cf1f2cdf819946494becf282e47194aa6216d",
      "patch": "@@ -247,3 +247,18 @@ INSTRUCTION (iloop,\n \t\tLOOP_IN_PROGRESS = 1;\n \t\tPC++;\n \t     })\n+\n+INSTRUCTION (lmbd,\n+\t     {\n+\t     int lmbd_i;\n+\n+\t     OP2 = (IO ? IMM8 : RS2);\n+\n+\t     for (lmbd_i = RS1_WIDTH - 1; lmbd_i >= 0; lmbd_i--)\n+\t       {\n+\t\t if (!(((RS1 >> lmbd_i) ^ OP2) & 1))\n+\t\t   break;\n+\t       }\n+\t     RD = (lmbd_i < 0) ? 32 : lmbd_i;\n+\t     PC++;\n+\t     })"
    },
    {
      "sha": "3d862d13da2ab1f484643d0bce91d1d955dbccbc",
      "filename": "sim/testsuite/sim/pru/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e57cf1f2cdf819946494becf282e47194aa6216d/sim/testsuite/sim/pru/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e57cf1f2cdf819946494becf282e47194aa6216d/sim/testsuite/sim/pru/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/testsuite/sim/pru/ChangeLog?ref=e57cf1f2cdf819946494becf282e47194aa6216d",
      "patch": "@@ -1,3 +1,7 @@\n+2020-11-12  Dimitar Dimitrov  <dimitar@dinux.eu>\n+\n+\t* lmbd.s: New test.\n+\n 2019-09-23  Dimitar Dimitrov  <dimitar@dinux.eu>\n \n \t* add.s: New test."
    },
    {
      "sha": "9a9e7827b211c26e784441e0faa491cd2cf1308e",
      "filename": "sim/testsuite/sim/pru/lmbd.s",
      "status": "added",
      "additions": 61,
      "deletions": 0,
      "changes": 61,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e57cf1f2cdf819946494becf282e47194aa6216d/sim/testsuite/sim/pru/lmbd.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e57cf1f2cdf819946494becf282e47194aa6216d/sim/testsuite/sim/pru/lmbd.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/testsuite/sim/pru/lmbd.s?ref=e57cf1f2cdf819946494becf282e47194aa6216d",
      "patch": "@@ -0,0 +1,61 @@\n+# Check that lmbd insn works.\n+# mach: pru\n+\n+# Copyright (C) 2020 Free Software Foundation, Inc.\n+# Contributed by Dimitar Dimitrov <dimitar@dinux.eu>\n+#\n+# This file is part of the GNU simulators.\n+#\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+.include \"testutils.inc\"\n+\n+\tstart\n+\n+\tldi32 r14, 0xffffffff\n+\tldi32 r15, 0x0\n+\tldi32 r16, 0x40000000\n+\tldi32 r17, 8\n+\n+\tlmbd r0, r14, 0\n+\tqbne 2f, r0, 32\n+\n+\tlmbd r0, r14, 1\n+\tqbne 2f, r0, 31\n+\n+\tlmbd r0, r15, 1\n+\tqbne 2f, r0, 32\n+\n+\tlmbd r0, r15, 0\n+\tqbne 2f, r0, 31\n+\n+\tlmbd r0, r16, r15\n+\tqbne 2f, r0, 31\n+\n+\tlmbd r0, r16, 1\n+\tqbne 2f, r0, 30\n+\n+\tlmbd r0, r14.w1, 1\n+\tqbne 2f, r0, 15\n+\n+\tlmbd r0, r17.b0, 1\n+\tqbne 2f, r0, 3\n+\n+\tlmbd r0, r17.b0, r15\n+\tqbne 2f, r0, 7\n+\n+\n+1:\n+\tpass\n+2:\tfail"
    }
  ]
}