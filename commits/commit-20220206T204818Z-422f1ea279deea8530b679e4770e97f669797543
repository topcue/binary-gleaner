{
  "sha": "422f1ea279deea8530b679e4770e97f669797543",
  "node_id": "C_kwDOANOeidoAKDQyMmYxZWEyNzlkZWVhODUzMGI2NzllNDc3MGU5N2Y2Njk3OTc1NDM",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@efficios.com",
      "date": "2021-11-20T02:49:53Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2022-02-06T20:48:18Z"
    },
    "message": "gdb: remove COMPUNIT_DEBUGFORMAT macro, add getter/setter\n\nAdd a getter and a setter for a compunit_symtab's debugformat.  Remove\nthe corresponding macro and adjust all callers.\n\nChange-Id: I1667b02d5322346f8e23abd9f8a584afbcd75975",
    "tree": {
      "sha": "24b4b77f180dbaef3ee816c2a17d60429478ae3e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/24b4b77f180dbaef3ee816c2a17d60429478ae3e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/422f1ea279deea8530b679e4770e97f669797543",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/422f1ea279deea8530b679e4770e97f669797543",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/422f1ea279deea8530b679e4770e97f669797543",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/422f1ea279deea8530b679e4770e97f669797543/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "510860f2787f354d1c294958e4cc5e81256ece58",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/510860f2787f354d1c294958e4cc5e81256ece58",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/510860f2787f354d1c294958e4cc5e81256ece58"
    }
  ],
  "stats": {
    "total": 27,
    "additions": 18,
    "deletions": 9
  },
  "files": [
    {
      "sha": "267b9462abd403ae1913b365161b737aa0107f63",
      "filename": "gdb/buildsym.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/422f1ea279deea8530b679e4770e97f669797543/gdb/buildsym.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/422f1ea279deea8530b679e4770e97f669797543/gdb/buildsym.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/buildsym.c?ref=422f1ea279deea8530b679e4770e97f669797543",
      "patch": "@@ -1010,7 +1010,7 @@ buildsym_compunit::end_symtab_with_blockvector (struct block *static_block,\n     }\n \n   /* Save the debug format string (if any) in the symtab.  */\n-  COMPUNIT_DEBUGFORMAT (cu) = m_debugformat;\n+  cu->set_debugformat (m_debugformat);\n \n   /* Similarly for the producer.  */\n   COMPUNIT_PRODUCER (cu) = m_producer;"
    },
    {
      "sha": "44c7bc306d073edf153148e4b867d40f8a39097e",
      "filename": "gdb/mdebugread.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/422f1ea279deea8530b679e4770e97f669797543/gdb/mdebugread.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/422f1ea279deea8530b679e4770e97f669797543/gdb/mdebugread.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/mdebugread.c?ref=422f1ea279deea8530b679e4770e97f669797543",
      "patch": "@@ -4634,7 +4634,7 @@ new_symtab (const char *name, int maxlines, struct objfile *objfile)\n     BLOCKVECTOR_BLOCK (bv, GLOBAL_BLOCK);\n   COMPUNIT_BLOCKVECTOR (cust) = bv;\n \n-  COMPUNIT_DEBUGFORMAT (cust) = \"ECOFF\";\n+  cust->set_debugformat (\"ECOFF\");\n   return cust;\n }\n "
    },
    {
      "sha": "5670a623024ff6c72d987b3c13f1d11068285f6d",
      "filename": "gdb/or1k-tdep.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/422f1ea279deea8530b679e4770e97f669797543/gdb/or1k-tdep.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/422f1ea279deea8530b679e4770e97f669797543/gdb/or1k-tdep.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/or1k-tdep.c?ref=422f1ea279deea8530b679e4770e97f669797543",
      "patch": "@@ -472,7 +472,7 @@ or1k_skip_prologue (struct gdbarch *gdbarch, CORE_ADDR pc)\n \t  struct symtab_and_line prologue_sal = find_pc_line (start_pc, 0);\n \t  struct compunit_symtab *compunit\n \t    = SYMTAB_COMPUNIT (prologue_sal.symtab);\n-\t  const char *debug_format = COMPUNIT_DEBUGFORMAT (compunit);\n+\t  const char *debug_format = compunit->debugformat ();\n \n \t  if ((NULL != debug_format)\n \t      && (strlen (\"dwarf\") <= strlen (debug_format))"
    },
    {
      "sha": "3f047467b2eb6e55c1f9f77f5261bcd969625db2",
      "filename": "gdb/source.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/422f1ea279deea8530b679e4770e97f669797543/gdb/source.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/422f1ea279deea8530b679e4770e97f669797543/gdb/source.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/source.c?ref=422f1ea279deea8530b679e4770e97f669797543",
      "patch": "@@ -727,7 +727,7 @@ info_source_command (const char *ignore, int from_tty)\n \t\t   COMPUNIT_PRODUCER (cust) != NULL\n \t\t   ? COMPUNIT_PRODUCER (cust) : _(\"unknown\"));\n   printf_filtered (_(\"Compiled with %s debugging format.\\n\"),\n-\t\t   COMPUNIT_DEBUGFORMAT (cust));\n+\t\t   cust->debugformat ());\n   printf_filtered (_(\"%s preprocessor macro info.\\n\"),\n \t\t   COMPUNIT_MACRO_TABLE (cust) != NULL\n \t\t   ? \"Includes\" : \"Does not include\");"
    },
    {
      "sha": "b20284cad988c724f009bfa070f4e1feff3bffe7",
      "filename": "gdb/symfile.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/422f1ea279deea8530b679e4770e97f669797543/gdb/symfile.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/422f1ea279deea8530b679e4770e97f669797543/gdb/symfile.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/symfile.c?ref=422f1ea279deea8530b679e4770e97f669797543",
      "patch": "@@ -2831,7 +2831,7 @@ allocate_compunit_symtab (struct objfile *objfile, const char *name)\n   saved_name = lbasename (name);\n   cu->name = obstack_strdup (&objfile->objfile_obstack, saved_name);\n \n-  COMPUNIT_DEBUGFORMAT (cu) = \"unknown\";\n+  cu->set_debugformat (\"unknown\");\n \n   if (symtab_create_debug)\n     {"
    },
    {
      "sha": "4220fd7f93954cd0250db4efd9c6cd19aab26bdd",
      "filename": "gdb/symmisc.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/422f1ea279deea8530b679e4770e97f669797543/gdb/symmisc.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/422f1ea279deea8530b679e4770e97f669797543/gdb/symmisc.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/symmisc.c?ref=422f1ea279deea8530b679e4770e97f669797543",
      "patch": "@@ -777,7 +777,7 @@ maintenance_info_symtabs (const char *regexp, int from_tty)\n \t\t\tprintf_filtered (\"  { ((struct compunit_symtab *) %s)\\n\",\n \t\t\t\t\t host_address_to_string (cust));\n \t\t\tprintf_filtered (\"    debugformat %s\\n\",\n-\t\t\t\t\t COMPUNIT_DEBUGFORMAT (cust));\n+\t\t\t\t\t cust->debugformat ());\n \t\t\tprintf_filtered (\"    producer %s\\n\",\n \t\t\t\t\t COMPUNIT_PRODUCER (cust) != NULL\n \t\t\t\t\t ? COMPUNIT_PRODUCER (cust)"
    },
    {
      "sha": "2500c8e4166de4a9034a18f4a0620dff59ff3caf",
      "filename": "gdb/symtab.h",
      "status": "modified",
      "additions": 11,
      "deletions": 2,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/422f1ea279deea8530b679e4770e97f669797543/gdb/symtab.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/422f1ea279deea8530b679e4770e97f669797543/gdb/symtab.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/symtab.h?ref=422f1ea279deea8530b679e4770e97f669797543",
      "patch": "@@ -1482,6 +1482,16 @@ struct compunit_symtab\n       }\n   }\n \n+  const char *debugformat () const\n+  {\n+    return m_debugformat;\n+  }\n+\n+  void set_debugformat (const char *debugformat)\n+  {\n+    m_debugformat = debugformat;\n+  }\n+\n   /* Make PRIMARY_FILETAB the primary filetab of this compunit symtab.\n \n      PRIMARY_FILETAB must already be a filetab of this compunit symtab.  */\n@@ -1525,7 +1535,7 @@ struct compunit_symtab\n      such as \"stabs\", \"dwarf 1\", \"dwarf 2\", \"coff\", etc.  This is mostly useful\n      for automated testing of gdb but may also be information that is\n      useful to the user.  */\n-  const char *debugformat;\n+  const char *m_debugformat;\n \n   /* String of producer version information, or NULL if we don't know.  */\n   const char *producer;\n@@ -1577,7 +1587,6 @@ struct compunit_symtab\n \n using compunit_symtab_range = next_range<compunit_symtab>;\n \n-#define COMPUNIT_DEBUGFORMAT(cust) ((cust)->debugformat)\n #define COMPUNIT_PRODUCER(cust) ((cust)->producer)\n #define COMPUNIT_DIRNAME(cust) ((cust)->dirname)\n #define COMPUNIT_BLOCKVECTOR(cust) ((cust)->blockvector)"
    },
    {
      "sha": "4a58fe5138ea009f11db16471a0f5f47b1b7acd4",
      "filename": "gdb/z80-tdep.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/422f1ea279deea8530b679e4770e97f669797543/gdb/z80-tdep.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/422f1ea279deea8530b679e4770e97f669797543/gdb/z80-tdep.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/z80-tdep.c?ref=422f1ea279deea8530b679e4770e97f669797543",
      "patch": "@@ -496,7 +496,7 @@ z80_skip_prologue (struct gdbarch *gdbarch, CORE_ADDR pc)\n     {\n       struct symtab_and_line prologue_sal = find_pc_line (func_addr, 0);\n       struct compunit_symtab *compunit = SYMTAB_COMPUNIT (prologue_sal.symtab);\n-      const char *debug_format = COMPUNIT_DEBUGFORMAT (compunit);\n+      const char *debug_format = compunit->debugformat ();\n \n       if (debug_format != NULL &&\n \t  !strncasecmp (\"dwarf\", debug_format, strlen(\"dwarf\")))"
    }
  ]
}