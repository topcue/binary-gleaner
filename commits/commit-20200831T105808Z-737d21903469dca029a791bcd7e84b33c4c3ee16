{
  "sha": "737d21903469dca029a791bcd7e84b33c4c3ee16",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NzM3ZDIxOTAzNDY5ZGNhMDI5YTc5MWJjZDdlODRiMzNjNGMzZWUxNg==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-08-30T14:13:54Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-08-31T10:58:08Z"
    },
    "message": "tic4x-coff: ubsan: various shift UB\n\n\t* config/tc-tic4x.c (tic4x_gen_to_words): Rewrite mantissa\n\toverflow test without UB.  Avoid other UB shifts by making them\n\tunsigned.",
    "tree": {
      "sha": "15682d141c8326475edc27f52dfa7da4ab6d5a1a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/15682d141c8326475edc27f52dfa7da4ab6d5a1a"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/737d21903469dca029a791bcd7e84b33c4c3ee16",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/737d21903469dca029a791bcd7e84b33c4c3ee16",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/737d21903469dca029a791bcd7e84b33c4c3ee16",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/737d21903469dca029a791bcd7e84b33c4c3ee16/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e840f2e3e2f5091b392994d47d1f9f31b5d57269",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e840f2e3e2f5091b392994d47d1f9f31b5d57269",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e840f2e3e2f5091b392994d47d1f9f31b5d57269"
    }
  ],
  "stats": {
    "total": 22,
    "additions": 12,
    "deletions": 10
  },
  "files": [
    {
      "sha": "757a3118c6e8e5692b40499a1c5074712fa5ef6a",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/737d21903469dca029a791bcd7e84b33c4c3ee16/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/737d21903469dca029a791bcd7e84b33c4c3ee16/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=737d21903469dca029a791bcd7e84b33c4c3ee16",
      "patch": "@@ -1,3 +1,9 @@\n+2020-08-30  Alan Modra  <amodra@gmail.com>\n+\n+\t* config/tc-tic4x.c (tic4x_gen_to_words): Rewrite mantissa\n+\toverflow test without UB.  Avoid other UB shifts by making them\n+\tunsigned.\n+\n 2020-08-31  Cooper Qu  <cooper.qu@linux.alibaba.com>\n \n \t* config/tc-csky.c (csky_error_state): New member 'arg_int'."
    },
    {
      "sha": "4efb9d4ae56e1614eea621e2eb779cbd41b3ea6b",
      "filename": "gas/config/tc-tic4x.c",
      "status": "modified",
      "additions": 6,
      "deletions": 10,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/737d21903469dca029a791bcd7e84b33c4c3ee16/gas/config/tc-tic4x.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/737d21903469dca029a791bcd7e84b33c4c3ee16/gas/config/tc-tic4x.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-tic4x.c?ref=737d21903469dca029a791bcd7e84b33c4c3ee16",
      "patch": "@@ -453,8 +453,8 @@ tic4x_gen_to_words (FLONUM_TYPE flonum, LITTLENUM_TYPE *words, int precision)\n   /* Store the mantissa data into smant and the roundbit into rbit */\n   for (p = flonum.leader; p >= flonum.low && shift > -16; p--)\n     {\n-      tmp = shift >= 0 ? *p << shift : *p >> -shift;\n-      rbit = shift < 0 ? ((*p >> (-shift-1)) & 0x1) : 0;\n+      tmp = shift >= 0 ? (unsigned) *p << shift : (unsigned) *p >> -shift;\n+      rbit = shift < 0 ? (((unsigned) *p >> (-shift-1)) & 0x1) : 0;\n       smant |= tmp;\n       shift -= 16;\n     }\n@@ -463,18 +463,14 @@ tic4x_gen_to_words (FLONUM_TYPE flonum, LITTLENUM_TYPE *words, int precision)\n   if(rbit)\n     {\n       /* If the mantissa is going to overflow when added, lets store\n-         the extra bit in mover. -- A special case exists when\n-         mantissa_bits is 31 (E_PRECISION). Then the first test cannot\n-         be trusted, as result is host-dependent, thus the second\n-         test. */\n-      if( smant == ((unsigned)(1<<(mantissa_bits+1))-1)\n-          || smant == (unsigned)-1 )  /* This is to catch E_PRECISION cases */\n+\t the extra bit in mover.  */\n+      if (smant == (1u << mantissa_bits << 1) - 1)\n         mover=1;\n       smant++;\n     }\n \n   /* Get the scaled one value */\n-  sone = (1 << (mantissa_bits));\n+  sone = 1u << mantissa_bits;\n \n   /* The number may be unnormalised so renormalise it...  */\n   if(mover)\n@@ -527,7 +523,7 @@ tic4x_gen_to_words (FLONUM_TYPE flonum, LITTLENUM_TYPE *words, int precision)\n   else\n     {\n       /* Insert the exponent data into the word */\n-      sfract |= exponent << (mantissa_bits+1);\n+      sfract |= (unsigned) exponent << (mantissa_bits + 1);\n \n       if (precision == S_PRECISION)\n         words[0] = sfract;"
    }
  ]
}