{
  "sha": "ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZGRmZTUyNWYyODc1ZTc2ZTBjMzJmZjM0OGZjMGQzZDZhYTVmYjRhMw==",
  "commit": {
    "author": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2021-04-14T02:00:05Z"
    },
    "committer": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2021-04-15T02:32:36Z"
    },
    "message": "RISC-V: PR27584, surpress local and empty name symbols for nm.\n\nThe local \".L0\" symbol are usually generated to mark where the\nauipc instruction is, and clang also uses \".LBB\" to do the same\nthing.  Besides, clang also uses the empty name symbols for label\ndifferences.  Arm surpress their mapping symbols by regarding them\nas special symbols, and MIPS surpress all local symbols.  Therefore,\nRISC-V probably need to surpress the local and empty name symbols\nfor nm and related tools.  User can use \"--special-syms\" to show\nthese surpressed symbols.\n\nbfd/\n    PR27584\n    * elfnn-riscv.c (riscv_elf_is_target_special_symbol): Added to\n    omit local and empty symbols since they usually generated to\n    mark the auipc instructions.",
    "tree": {
      "sha": "e4452f5c8dff39d9d510d56081143e757c507a88",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/e4452f5c8dff39d9d510d56081143e757c507a88"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "f6a1f9574955cd2678c66e658d770adda9331995",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f6a1f9574955cd2678c66e658d770adda9331995",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/f6a1f9574955cd2678c66e658d770adda9331995"
    }
  ],
  "stats": {
    "total": 18,
    "additions": 18,
    "deletions": 0
  },
  "files": [
    {
      "sha": "702d4026ee88af567d2cd8f2d446f7abb08991a1",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3",
      "patch": "@@ -1,3 +1,10 @@\n+2021-04-15  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\tPR27584\n+\t* elfnn-riscv.c (riscv_elf_is_target_special_symbol): Added to\n+\tomit local and empty symbols since they usually generated to\n+\tmark the auipc instructions.\n+\n 2021-04-15  Lifang Xia<lifang_xia@c-sky.com>\n \n \t* elf32-csky.c (csky_elf_howto_table)"
    },
    {
      "sha": "a944b3302274700791a303187ab8083745741a3f",
      "filename": "bfd/elfnn-riscv.c",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3/bfd/elfnn-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3/bfd/elfnn-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfnn-riscv.c?ref=ddfe525f2875e76e0c32ff348fc0d3d6aa5fb4a3",
      "patch": "@@ -5094,6 +5094,16 @@ riscv_elf_obj_attrs_arg_type (int tag)\n   return (tag & 1) != 0 ? ATTR_TYPE_FLAG_STR_VAL : ATTR_TYPE_FLAG_INT_VAL;\n }\n \n+/* PR27584, Omit local and empty symbols since they usually generated\n+   for pcrel relocations.  */\n+\n+static bool\n+riscv_elf_is_target_special_symbol (bfd *abfd, asymbol *sym)\n+{\n+  return (!strcmp (sym->name, \"\")\n+\t  || _bfd_elf_is_local_label_name (abfd, sym->name));\n+}\n+\n #define TARGET_LITTLE_SYM\t\t\triscv_elfNN_vec\n #define TARGET_LITTLE_NAME\t\t\t\"elfNN-littleriscv\"\n #define TARGET_BIG_SYM\t\t\t\triscv_elfNN_be_vec\n@@ -5106,6 +5116,7 @@ riscv_elf_obj_attrs_arg_type (int tag)\n #define bfd_elfNN_bfd_reloc_type_lookup\t\triscv_reloc_type_lookup\n #define bfd_elfNN_bfd_merge_private_bfd_data \\\n   _bfd_riscv_elf_merge_private_bfd_data\n+#define bfd_elfNN_bfd_is_target_special_symbol\triscv_elf_is_target_special_symbol\n \n #define elf_backend_copy_indirect_symbol\triscv_elf_copy_indirect_symbol\n #define elf_backend_create_dynamic_sections\triscv_elf_create_dynamic_sections"
    }
  ]
}