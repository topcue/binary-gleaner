{
  "sha": "d61df89700bcf1633ca9db0ea403c2108c3cac3e",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDYxZGY4OTcwMGJjZjE2MzNjYTlkYjBlYTQwM2MyMTA4YzNjYWMzZQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2019-12-10T18:19:23Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2019-12-12T19:36:57Z"
    },
    "message": "Remove some calls to malloc_failure\n\nI noticed a couple of spots that call malloc_failure, but that don't\nneed to.\n\n* In xml-support.c, \"concat\" uses xmalloc, so cannot return NULL.\n\n* In utils.c, \"buildargv\" also uses xmalloc, so can only return NULL\n  if the argument is empty.\n\nTested by the buildbot.\n\ngdb/ChangeLog\n2019-12-12  Tom Tromey  <tromey@adacore.com>\n\n\t* xml-support.c (xml_fetch_content_from_file): Don't call\n\tmalloc_failure.\n\t* utils.h (class gdb_argv): Remove malloc_failure comment.\n\t* utils.c (gdb_argv::reset): Don't call malloc_failure.\n\nChange-Id: I59483620deb6609ccf2f024d94a29113bb62d1a9",
    "tree": {
      "sha": "e9a230f46ba6995eb090ae026af1c6e46cf8ab97",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/e9a230f46ba6995eb090ae026af1c6e46cf8ab97"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d61df89700bcf1633ca9db0ea403c2108c3cac3e",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d61df89700bcf1633ca9db0ea403c2108c3cac3e",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d61df89700bcf1633ca9db0ea403c2108c3cac3e",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d61df89700bcf1633ca9db0ea403c2108c3cac3e/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "db3ad2f031d4da70db35977abbcede0399d81d6b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/db3ad2f031d4da70db35977abbcede0399d81d6b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/db3ad2f031d4da70db35977abbcede0399d81d6b"
    }
  ],
  "stats": {
    "total": 17,
    "additions": 8,
    "deletions": 9
  },
  "files": [
    {
      "sha": "2ffc3334feab9bf52c60629a2f45b9843fec9a03",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d61df89700bcf1633ca9db0ea403c2108c3cac3e/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d61df89700bcf1633ca9db0ea403c2108c3cac3e/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=d61df89700bcf1633ca9db0ea403c2108c3cac3e",
      "patch": "@@ -1,3 +1,10 @@\n+2019-12-12  Tom Tromey  <tromey@adacore.com>\n+\n+\t* xml-support.c (xml_fetch_content_from_file): Don't call\n+\tmalloc_failure.\n+\t* utils.h (class gdb_argv): Remove malloc_failure comment.\n+\t* utils.c (gdb_argv::reset): Don't call malloc_failure.\n+\n 2019-12-12  Tom Tromey  <tromey@adacore.com>\n \n \t* Makefile.in (ALL_TARGET_OBS): Add riscv-ravenscar-thread.o."
    },
    {
      "sha": "0b8ec02abe6668c2ed59604335311248ea240592",
      "filename": "gdb/utils.c",
      "status": "modified",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d61df89700bcf1633ca9db0ea403c2108c3cac3e/gdb/utils.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d61df89700bcf1633ca9db0ea403c2108c3cac3e/gdb/utils.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/utils.c?ref=d61df89700bcf1633ca9db0ea403c2108c3cac3e",
      "patch": "@@ -3033,9 +3033,6 @@ gdb_argv::reset (const char *s)\n {\n   char **argv = buildargv (s);\n \n-  if (s != NULL && argv == NULL)\n-    malloc_failure (0);\n-\n   freeargv (m_argv);\n   m_argv = argv;\n }"
    },
    {
      "sha": "71860191403508bbf706f4c2a6a0ab4e3269e1f7",
      "filename": "gdb/utils.h",
      "status": "modified",
      "additions": 1,
      "deletions": 4,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d61df89700bcf1633ca9db0ea403c2108c3cac3e/gdb/utils.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d61df89700bcf1633ca9db0ea403c2108c3cac3e/gdb/utils.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/utils.h?ref=d61df89700bcf1633ca9db0ea403c2108c3cac3e",
      "patch": "@@ -146,10 +146,7 @@ class gdb_argv\n   }\n \n   /* A constructor that calls buildargv on STR.  STR may be NULL, in\n-     which case this object is initialized with a NULL array.  If\n-     buildargv fails due to out-of-memory, call malloc_failure.\n-     Therefore, the value is guaranteed to be non-NULL, unless the\n-     parameter itself is NULL.  */\n+     which case this object is initialized with a NULL array.  */\n \n   explicit gdb_argv (const char *str)\n     : m_argv (NULL)"
    },
    {
      "sha": "f5a142754578e18572874406258cb2e2c0d0fcc0",
      "filename": "gdb/xml-support.c",
      "status": "modified",
      "additions": 0,
      "deletions": 2,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d61df89700bcf1633ca9db0ea403c2108c3cac3e/gdb/xml-support.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d61df89700bcf1633ca9db0ea403c2108c3cac3e/gdb/xml-support.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/xml-support.c?ref=d61df89700bcf1633ca9db0ea403c2108c3cac3e",
      "patch": "@@ -977,8 +977,6 @@ xml_fetch_content_from_file (const char *filename, void *baton)\n     {\n       char *fullname = concat (dirname, \"/\", filename, (char *) NULL);\n \n-      if (fullname == NULL)\n-\tmalloc_failure (0);\n       file = gdb_fopen_cloexec (fullname, FOPEN_RT);\n       xfree (fullname);\n     }"
    }
  ]
}