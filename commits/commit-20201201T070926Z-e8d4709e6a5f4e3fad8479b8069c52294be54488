{
  "sha": "e8d4709e6a5f4e3fad8479b8069c52294be54488",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZThkNDcwOWU2YTVmNGUzZmFkODQ3OWI4MDY5YzUyMjk0YmU1NDQ4OA==",
  "commit": {
    "author": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2020-11-21T03:19:58Z"
    },
    "committer": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2020-12-01T07:09:26Z"
    },
    "message": "RISC-V: Don't allow any uppercase letter in the arch string.\n\nAlthough I cannot find any RISC-V specs said that uppercases are not\nallowed in the arhc string, but seems like it is an established fact\nboth for GNU and LLVM.  Therefore, we shouldn't allow the uppercases\nfor the non-standard x extensions, too.\n\n\tbfd/\n\t* elfxx-riscv.c (riscv_parse_subset): ISA string cannot contain\n\tany uppercase letter.\n\n\tgas/\n\t* testsuite/gas/riscv/march-fail-uppercase-base.d: Updated.\n\t* testsuite/gas/riscv/march-fail-uppercase.l: Updated.\n\t* testsuite/gas/riscv/march-fail-uppercase-x.d: New testcase.",
    "tree": {
      "sha": "381e50836b9ebefc2c013651cdf8f68b69cbff7f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/381e50836b9ebefc2c013651cdf8f68b69cbff7f"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e8d4709e6a5f4e3fad8479b8069c52294be54488",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e8d4709e6a5f4e3fad8479b8069c52294be54488",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e8d4709e6a5f4e3fad8479b8069c52294be54488",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e8d4709e6a5f4e3fad8479b8069c52294be54488/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "d541518bec90502134ea6b348cb2d4f3363d1c70",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d541518bec90502134ea6b348cb2d4f3363d1c70",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d541518bec90502134ea6b348cb2d4f3363d1c70"
    }
  ],
  "stats": {
    "total": 32,
    "additions": 29,
    "deletions": 3
  },
  "files": [
    {
      "sha": "3ac27196bdc4e9a177975c04245782e9aaa91b9e",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e8d4709e6a5f4e3fad8479b8069c52294be54488/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e8d4709e6a5f4e3fad8479b8069c52294be54488/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=e8d4709e6a5f4e3fad8479b8069c52294be54488",
      "patch": "@@ -1,3 +1,8 @@\n+2020-12-01  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* elfxx-riscv.c (riscv_parse_subset): ISA string cannot contain\n+\tany uppercase letter.\n+\n 2020-12-01  Nelson Chu  <nelson.chu@sifive.com>\n \n \t* elfxx-riscv.c: Re-indent codes, unify and improve the error"
    },
    {
      "sha": "69f3a4353b9361596afe63a5ee92e999c82c6eea",
      "filename": "bfd/elfxx-riscv.c",
      "status": "modified",
      "additions": 13,
      "deletions": 1,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e8d4709e6a5f4e3fad8479b8069c52294be54488/bfd/elfxx-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e8d4709e6a5f4e3fad8479b8069c52294be54488/bfd/elfxx-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-riscv.c?ref=e8d4709e6a5f4e3fad8479b8069c52294be54488",
      "patch": "@@ -1510,9 +1510,21 @@ bfd_boolean\n riscv_parse_subset (riscv_parse_subset_t *rps,\n \t\t    const char *arch)\n {\n-  const char *p = arch;\n+  const char *p;\n   size_t i;\n \n+  for (p = arch; *p != '\\0'; p++)\n+    {\n+      if (ISUPPER (*p))\n+\t{\n+\t  rps->error_handler\n+\t    (_(\"-march=%s: ISA string cannot contain uppercase letters\"),\n+\t     arch);\n+\t  return FALSE;\n+\t}\n+    }\n+\n+  p = arch;\n   if (strncmp (p, \"rv32\", 4) == 0)\n     {\n       *rps->xlen = 32;"
    },
    {
      "sha": "2a2b593a13f7ba7cd0d496cc9dc2183538fe6fdf",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e8d4709e6a5f4e3fad8479b8069c52294be54488/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e8d4709e6a5f4e3fad8479b8069c52294be54488/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=e8d4709e6a5f4e3fad8479b8069c52294be54488",
      "patch": "@@ -1,3 +1,9 @@\n+2020-12-01  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* testsuite/gas/riscv/march-fail-uppercase-base.d: Updated.\n+\t* testsuite/gas/riscv/march-fail-uppercase.l: Updated.\n+\t* testsuite/gas/riscv/march-fail-uppercase-x.d: New testcase.\n+\n 2020-12-01  Nelson Chu  <nelson.chu@sifive.com>\n \n \t(These are new testcases that cover more cases)"
    },
    {
      "sha": "8b595856b4c4002f6df9c093fe7d3402050e8422",
      "filename": "gas/testsuite/gas/riscv/march-fail-uppercase-base.d",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e8d4709e6a5f4e3fad8479b8069c52294be54488/gas/testsuite/gas/riscv/march-fail-uppercase-base.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e8d4709e6a5f4e3fad8479b8069c52294be54488/gas/testsuite/gas/riscv/march-fail-uppercase-base.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/riscv/march-fail-uppercase-base.d?ref=e8d4709e6a5f4e3fad8479b8069c52294be54488",
      "patch": "@@ -1,3 +1,3 @@\n #as: -march=rv32I\n #source: empty.s\n-#error_output: march-fail-base-01.l\n+#error_output: march-fail-uppercase.l"
    },
    {
      "sha": "316351fce8fe1d9f9cfbf13da14a5eecef7b0ef5",
      "filename": "gas/testsuite/gas/riscv/march-fail-uppercase-x.d",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e8d4709e6a5f4e3fad8479b8069c52294be54488/gas/testsuite/gas/riscv/march-fail-uppercase-x.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e8d4709e6a5f4e3fad8479b8069c52294be54488/gas/testsuite/gas/riscv/march-fail-uppercase-x.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/riscv/march-fail-uppercase-x.d?ref=e8d4709e6a5f4e3fad8479b8069c52294be54488",
      "patch": "@@ -0,0 +1,3 @@\n+#as: -march=rv32ic_zicsr_xARGLE\n+#source: empty.s\n+#error_output: march-fail-uppercase.l"
    },
    {
      "sha": "292c18adcc6499e839e1e36d2c82fe20de6af218",
      "filename": "gas/testsuite/gas/riscv/march-fail-uppercase.l",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e8d4709e6a5f4e3fad8479b8069c52294be54488/gas/testsuite/gas/riscv/march-fail-uppercase.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e8d4709e6a5f4e3fad8479b8069c52294be54488/gas/testsuite/gas/riscv/march-fail-uppercase.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/riscv/march-fail-uppercase.l?ref=e8d4709e6a5f4e3fad8479b8069c52294be54488",
      "patch": "@@ -1,2 +1,2 @@\n .*Assembler messages:\n-.*Fatal error: .*unknown (standard|z) ISA extension.*\n+.*Fatal error: .*ISA string cannot contain uppercase letters"
    }
  ]
}