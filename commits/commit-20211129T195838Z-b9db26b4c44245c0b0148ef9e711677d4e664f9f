{
  "sha": "b9db26b4c44245c0b0148ef9e711677d4e664f9f",
  "node_id": "C_kwDOANOeidoAKGI5ZGIyNmI0YzQ0MjQ1YzBiMDE0OGVmOWU3MTE2NzdkNGU2NjRmOWY",
  "commit": {
    "author": {
      "name": "Aaron Merey",
      "email": "amerey@redhat.com",
      "date": "2021-11-29T19:58:38Z"
    },
    "committer": {
      "name": "Aaron Merey",
      "email": "amerey@redhat.com",
      "date": "2021-11-29T19:58:38Z"
    },
    "message": "[PR gdb/27026] CTRL-C is ignored when debug info is downloaded\n\nDuring debuginfod downloads, ctrl-c should result in the download\nbeing cancelled and skipped.  However in some cases, ctrl-c fails to\nget delivered to gdb during downloading.  This can result in downloads\nbeing unskippable.\n\nFix this by ensuring that target_terminal::ours is in effect for the\nduration of each download.\n\nCo-authored-by: Tom de Vries <tdevries@suse.de>\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=27026#c3",
    "tree": {
      "sha": "f44b27bc7358f0131dffd9d29bf25024c6ed2f6e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/f44b27bc7358f0131dffd9d29bf25024c6ed2f6e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/b9db26b4c44245c0b0148ef9e711677d4e664f9f",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b9db26b4c44245c0b0148ef9e711677d4e664f9f",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/b9db26b4c44245c0b0148ef9e711677d4e664f9f",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b9db26b4c44245c0b0148ef9e711677d4e664f9f/comments",
  "author": {
    "login": "aaronmerey",
    "id": 28735867,
    "node_id": "MDQ6VXNlcjI4NzM1ODY3",
    "avatar_url": "https://avatars.githubusercontent.com/u/28735867?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aaronmerey",
    "html_url": "https://github.com/aaronmerey",
    "followers_url": "https://api.github.com/users/aaronmerey/followers",
    "following_url": "https://api.github.com/users/aaronmerey/following{/other_user}",
    "gists_url": "https://api.github.com/users/aaronmerey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aaronmerey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aaronmerey/subscriptions",
    "organizations_url": "https://api.github.com/users/aaronmerey/orgs",
    "repos_url": "https://api.github.com/users/aaronmerey/repos",
    "events_url": "https://api.github.com/users/aaronmerey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aaronmerey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "aaronmerey",
    "id": 28735867,
    "node_id": "MDQ6VXNlcjI4NzM1ODY3",
    "avatar_url": "https://avatars.githubusercontent.com/u/28735867?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aaronmerey",
    "html_url": "https://github.com/aaronmerey",
    "followers_url": "https://api.github.com/users/aaronmerey/followers",
    "following_url": "https://api.github.com/users/aaronmerey/following{/other_user}",
    "gists_url": "https://api.github.com/users/aaronmerey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aaronmerey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aaronmerey/subscriptions",
    "organizations_url": "https://api.github.com/users/aaronmerey/orgs",
    "repos_url": "https://api.github.com/users/aaronmerey/repos",
    "events_url": "https://api.github.com/users/aaronmerey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aaronmerey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "584294c4066d0101161e4e04744a46cce7a7863e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/584294c4066d0101161e4e04744a46cce7a7863e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/584294c4066d0101161e4e04744a46cce7a7863e"
    }
  ],
  "stats": {
    "total": 15,
    "additions": 15,
    "deletions": 0
  },
  "files": [
    {
      "sha": "1f160e297147339b6138766fab8bc7e627f2bb17",
      "filename": "gdb/debuginfod-support.c",
      "status": "modified",
      "additions": 15,
      "deletions": 0,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b9db26b4c44245c0b0148ef9e711677d4e664f9f/gdb/debuginfod-support.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b9db26b4c44245c0b0148ef9e711677d4e664f9f/gdb/debuginfod-support.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/debuginfod-support.c?ref=b9db26b4c44245c0b0148ef9e711677d4e664f9f",
      "patch": "@@ -23,6 +23,7 @@\n #include \"gdbsupport/gdb_optional.h\"\n #include \"cli/cli-cmds.h\"\n #include \"cli/cli-style.h\"\n+#include \"target.h\"\n \n /* Set/show debuginfod commands.  */\n static cmd_list_element *set_debuginfod_prefix_list;\n@@ -204,6 +205,13 @@ debuginfod_source_query (const unsigned char *build_id,\n   user_data data (\"source file\", srcpath);\n \n   debuginfod_set_user_data (c, &data);\n+  gdb::optional<target_terminal::scoped_restore_terminal_state> term_state;\n+  if (target_supports_terminal_ours ())\n+    {\n+      term_state.emplace ();\n+      target_terminal::ours ();\n+    }\n+\n   scoped_fd fd (debuginfod_find_source (c,\n \t\t\t\t\tbuild_id,\n \t\t\t\t\tbuild_id_len,\n@@ -242,6 +250,13 @@ debuginfod_debuginfo_query (const unsigned char *build_id,\n   user_data data (\"separate debug info for\", filename);\n \n   debuginfod_set_user_data (c, &data);\n+  gdb::optional<target_terminal::scoped_restore_terminal_state> term_state;\n+  if (target_supports_terminal_ours ())\n+    {\n+      term_state.emplace ();\n+      target_terminal::ours ();\n+    }\n+\n   scoped_fd fd (debuginfod_find_debuginfo (c, build_id, build_id_len,\n \t\t\t\t\t   &dname));\n   debuginfod_set_user_data (c, nullptr);"
    }
  ]
}