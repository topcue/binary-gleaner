{
  "sha": "8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OGQxOGJmNzk2YmY3MGQ3MWViMjNmNDI0N2UyOWExZmFiNWYzYzVjNw==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-02-20T15:35:06Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-02-20T15:35:06Z"
    },
    "message": "Harden readelf's IA64 note display function so that it can handle corrupt notes.\n\n\tPR 24242\n\t* readelf.c (print_ia64_vms_note): Harden against corrupt notes.",
    "tree": {
      "sha": "50bea7121c2c6a840a405b07ca11bf8dcaabb190",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/50bea7121c2c6a840a405b07ca11bf8dcaabb190"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "c763b8943348582e651dda24f88bb9f8db24672b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c763b8943348582e651dda24f88bb9f8db24672b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c763b8943348582e651dda24f88bb9f8db24672b"
    }
  ],
  "stats": {
    "total": 87,
    "additions": 69,
    "deletions": 18
  },
  "files": [
    {
      "sha": "1ae5044fd3412bb9771eae17c7462e29c552dcdf",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7",
      "patch": "@@ -1,3 +1,8 @@\n+2019-02-20  Nick Clifton  <nickc@redhat.com>\n+\n+\tPR 24242\n+\t* readelf.c (print_ia64_vms_note): Harden against corrupt notes.\n+\n 2019-02-20  Alan Modra  <amodra@gmail.com>\n \n \tPR 24132"
    },
    {
      "sha": "54d165e60993c6b9bb6c431505e88d574a0430e1",
      "filename": "binutils/readelf.c",
      "status": "modified",
      "additions": 64,
      "deletions": 18,
      "changes": 82,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7/binutils/readelf.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7/binutils/readelf.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/readelf.c?ref=8d18bf796bf70d71eb23f4247e29a1fab5f3c5c7",
      "patch": "@@ -17940,42 +17940,77 @@ get_ia64_vms_note_type (unsigned e_type)\n static bfd_boolean\n print_ia64_vms_note (Elf_Internal_Note * pnote)\n {\n+  int maxlen = pnote->descsz;\n+\n+  if (maxlen < 2 || (unsigned long) maxlen != pnote->descsz)\n+    goto desc_size_fail;\n+\n   switch (pnote->type)\n     {\n     case NT_VMS_MHD:\n-      if (pnote->descsz > 36)\n-        {\n-          size_t l = strlen (pnote->descdata + 34);\n-          printf (_(\"    Creation date  : %.17s\\n\"), pnote->descdata);\n-          printf (_(\"    Last patch date: %.17s\\n\"), pnote->descdata + 17);\n-          printf (_(\"    Module name    : %s\\n\"), pnote->descdata + 34);\n-          printf (_(\"    Module version : %s\\n\"), pnote->descdata + 34 + l + 1);\n-        }\n+      if (maxlen <= 36)\n+\tgoto desc_size_fail;\n+\n+      int l = (int) strnlen (pnote->descdata + 34, maxlen - 34);\n+\n+      printf (_(\"    Creation date  : %.17s\\n\"), pnote->descdata);\n+      printf (_(\"    Last patch date: %.17s\\n\"), pnote->descdata + 17);\n+      if (l + 34 < maxlen)\n+\t{\n+\t  printf (_(\"    Module name    : %s\\n\"), pnote->descdata + 34);\n+\t  if (l + 35 < maxlen)\n+\t    printf (_(\"    Module version : %s\\n\"), pnote->descdata + 34 + l + 1);\n+\t  else\n+\t    printf (_(\"    Module version : <missing>\\n\"));\n+\t}\n       else\n-        printf (_(\"    Invalid size\\n\"));\n+\t{\n+\t  printf (_(\"    Module name    : <missing>\\n\"));\n+\t  printf (_(\"    Module version : <missing>\\n\"));\n+\t}\n       break;\n+\n     case NT_VMS_LNM:\n-      printf (_(\"   Language: %s\\n\"), pnote->descdata);\n+      printf (_(\"   Language: %.*s\\n\"), maxlen, pnote->descdata);\n       break;\n+\n #ifdef BFD64\n     case NT_VMS_FPMODE:\n       printf (_(\"   Floating Point mode: \"));\n+      if (maxlen < 8)\n+\tgoto desc_size_fail;\n+      /* FIXME: Generate an error if descsz > 8 ?  */\n+\n       printf (\"0x%016\" BFD_VMA_FMT \"x\\n\",\n-              (bfd_vma) byte_get ((unsigned char *)pnote->descdata, 8));\n+\t      (bfd_vma) byte_get ((unsigned char *)pnote->descdata, 8));\n       break;\n+\n     case NT_VMS_LINKTIME:\n       printf (_(\"   Link time: \"));\n+      if (maxlen < 8)\n+\tgoto desc_size_fail;\n+      /* FIXME: Generate an error if descsz > 8 ?  */\n+\n       print_vms_time\n-        ((bfd_int64_t) byte_get ((unsigned char *)pnote->descdata, 8));\n+\t((bfd_int64_t) byte_get ((unsigned char *)pnote->descdata, 8));\n       printf (\"\\n\");\n       break;\n+\n     case NT_VMS_PATCHTIME:\n       printf (_(\"   Patch time: \"));\n+      if (maxlen < 8)\n+\tgoto desc_size_fail;\n+      /* FIXME: Generate an error if descsz > 8 ?  */\n+\n       print_vms_time\n-        ((bfd_int64_t) byte_get ((unsigned char *)pnote->descdata, 8));\n+\t((bfd_int64_t) byte_get ((unsigned char *)pnote->descdata, 8));\n       printf (\"\\n\");\n       break;\n+\n     case NT_VMS_ORIG_DYN:\n+      if (maxlen < 34)\n+\tgoto desc_size_fail;\n+\n       printf (_(\"   Major id: %u,  minor id: %u\\n\"),\n               (unsigned) byte_get ((unsigned char *)pnote->descdata, 4),\n               (unsigned) byte_get ((unsigned char *)pnote->descdata + 4, 4));\n@@ -17987,25 +18022,36 @@ print_ia64_vms_note (Elf_Internal_Note * pnote)\n               (bfd_vma) byte_get ((unsigned char *)pnote->descdata + 16, 8));\n       printf (_(\"   Header flags: 0x%08x\\n\"),\n               (unsigned) byte_get ((unsigned char *)pnote->descdata + 24, 4));\n-      printf (_(\"   Image id    : %s\\n\"), pnote->descdata + 32);\n+      printf (_(\"   Image id    : %.*s\\n\"), maxlen - 32, pnote->descdata + 32);\n       break;\n #endif\n+\n     case NT_VMS_IMGNAM:\n-      printf (_(\"    Image name: %s\\n\"), pnote->descdata);\n+      printf (_(\"    Image name: %.*s\\n\"), maxlen, pnote->descdata);\n       break;\n+\n     case NT_VMS_GSTNAM:\n-      printf (_(\"    Global symbol table name: %s\\n\"), pnote->descdata);\n+      printf (_(\"    Global symbol table name: %.*s\\n\"), maxlen, pnote->descdata);\n       break;\n+\n     case NT_VMS_IMGID:\n-      printf (_(\"    Image id: %s\\n\"), pnote->descdata);\n+      printf (_(\"    Image id: %.*s\\n\"), maxlen, pnote->descdata);\n       break;\n+\n     case NT_VMS_LINKID:\n-      printf (_(\"    Linker id: %s\\n\"), pnote->descdata);\n+      printf (_(\"    Linker id: %.*s\\n\"), maxlen, pnote->descdata);\n       break;\n+\n     default:\n       return FALSE;\n     }\n+\n   return TRUE;\n+\n+ desc_size_fail:\n+  printf (_(\"  <corrupt - data size is too small>\\n\"));\n+  error (_(\"corrupt IA64 note: data size is too small\\n\"));\n+  return FALSE;\n }\n \n /* Find the symbol associated with a build attribute that is attached"
    }
  ]
}