{
  "sha": "2e3773ff548f068bddfc6d060524730fcf6823a1",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MmUzNzczZmY1NDhmMDY4YmRkZmM2ZDA2MDUyNDczMGZjZjY4MjNhMQ==",
  "commit": {
    "author": {
      "name": "Lancelot SIX",
      "email": "lsix@lancelotsix.com",
      "date": "2021-01-06T20:58:04Z"
    },
    "committer": {
      "name": "Lancelot SIX",
      "email": "lsix@lancelotsix.com",
      "date": "2021-02-02T22:37:39Z"
    },
    "message": "Inferior without argument prints detail of current inferior.\n\nThis patch makes the inferior command display information about the\ncurrent inferior when called with no argument.  This behavior is similar\nto the one of the thread command.\n\nBefore patch:\n\n    (gdb) info inferior\n      Num  Description       Connection           Executable\n    * 1    process 19221     1 (native)           /home/lsix/tmp/a.out\n      2    process 19239     1 (native)           /home/lsix/tmp/a.out\n    (gdb) inferior 2\n    [Switching to inferior 2 [process 19239] (/home/lsix/tmp/a.out)]\n    [Switching to thread 2.1 (process 19239)]\n    #0  0x0000000000401146 in main ()\n    (gdb) inferior\n    Argument required (expression to compute).\n\nAfter patch:\n\n    (gdb) info inferior\n      Num  Description       Connection           Executable\n    * 1    process 18699     1 (native)           /home/lsix/tmp/a.out\n      2    process 18705     1 (native)           /home/lsix/tmp/a.out\n    (gdb) inferior 2\n    [Switching to inferior 2 [process 18705] (/home/lsix/tmp/a.out)]\n    [Switching to thread 2.1 (process 18705)]\n    #0  0x0000000000401146 in main ()\n    (gdb) inferior\n    [Current inferior is 2 [process 18705] (/home/lsix/tmp/a.out)]\n\ngdb/doc/ChangeLog:\n\n\t* gdb.texinfo (Inferiors Connections and Programs): Document the\n\tinferior command when used without argument.\n\ngdb/ChangeLog:\n\n\t* NEWS: Add entry for the behavior change of the inferior command.\n\t* inferior.c (inferior_command): When no argument is given to the\n\tinferior command, display info about the currently selected\n\tinferior.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.base/inferior-noarg.c: New test.\n\t* gdb.base/inferior-noarg.exp: New test.",
    "tree": {
      "sha": "977640ce31c5cc8c14afb91955cecdb47ba4bc8f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/977640ce31c5cc8c14afb91955cecdb47ba4bc8f"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/2e3773ff548f068bddfc6d060524730fcf6823a1",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2e3773ff548f068bddfc6d060524730fcf6823a1",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/2e3773ff548f068bddfc6d060524730fcf6823a1",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2e3773ff548f068bddfc6d060524730fcf6823a1/comments",
  "author": {
    "login": "lsix",
    "id": 724339,
    "node_id": "MDQ6VXNlcjcyNDMzOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/724339?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lsix",
    "html_url": "https://github.com/lsix",
    "followers_url": "https://api.github.com/users/lsix/followers",
    "following_url": "https://api.github.com/users/lsix/following{/other_user}",
    "gists_url": "https://api.github.com/users/lsix/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lsix/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lsix/subscriptions",
    "organizations_url": "https://api.github.com/users/lsix/orgs",
    "repos_url": "https://api.github.com/users/lsix/repos",
    "events_url": "https://api.github.com/users/lsix/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lsix/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "lsix",
    "id": 724339,
    "node_id": "MDQ6VXNlcjcyNDMzOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/724339?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lsix",
    "html_url": "https://github.com/lsix",
    "followers_url": "https://api.github.com/users/lsix/followers",
    "following_url": "https://api.github.com/users/lsix/following{/other_user}",
    "gists_url": "https://api.github.com/users/lsix/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lsix/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lsix/subscriptions",
    "organizations_url": "https://api.github.com/users/lsix/orgs",
    "repos_url": "https://api.github.com/users/lsix/repos",
    "events_url": "https://api.github.com/users/lsix/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lsix/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e0bd9202fb13262101550d788db536ad5ca55c26",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e0bd9202fb13262101550d788db536ad5ca55c26",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e0bd9202fb13262101550d788db536ad5ca55c26"
    }
  ],
  "stats": {
    "total": 156,
    "additions": 135,
    "deletions": 21
  },
  "files": [
    {
      "sha": "209834a15fc4403b9560ce97081725b4420a07f3",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=2e3773ff548f068bddfc6d060524730fcf6823a1",
      "patch": "@@ -1,3 +1,11 @@\n+2021-02-02  Lancelot SIX  <lsix@lancelotsix.com>\n+\n+\t* NEWS (Changed commands): Add entry for the behavior change of\n+\tthe inferior command.\n+\t* inferior.c (inferior_command): When no argument is given to the\n+\tinferior command, display info about the currently selected\n+\tinferior.\n+\n 2021-02-02  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* dwarf2/read.c (read_loclist_index, read_rnglist_index): Return"
    },
    {
      "sha": "d4c76570331fe0181cb8cac291abb3f126c9d562",
      "filename": "gdb/NEWS",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/NEWS",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/NEWS",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/NEWS?ref=2e3773ff548f068bddfc6d060524730fcf6823a1",
      "patch": "@@ -80,6 +80,12 @@ set style version background COLOR\n set style version intensity VALUE\n   Control the styling of GDB's version number text.\n \n+inferior [ID]\n+  When the ID parameter is omitted, then this command prints information\n+  about the current inferior.  When the ID parameter is present, the\n+  behavior of the command is unchanged and have the inferior ID become\n+  the current inferior.\n+\n *** Changes in GDB 10\n \n * There are new feature names for ARC targets: \"org.gnu.gdb.arc.core\""
    },
    {
      "sha": "7b21966d3d49b010ec5903352ac3f56ce6f0d5a3",
      "filename": "gdb/doc/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/doc/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/doc/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/doc/ChangeLog?ref=2e3773ff548f068bddfc6d060524730fcf6823a1",
      "patch": "@@ -1,3 +1,8 @@\n+2021-02-02  Lancelot SIX  <lsix@lancelotsix.com>\n+\n+\t* gdb.texinfo (Inferiors Connections and Programs): Document the\n+\tinferior command when used without argument.\n+\n 2021-01-27  Tom Tromey  <tromey@adacore.com>\n \n \t* gdb.texinfo (Auto-loading extensions): Remove extraneous space."
    },
    {
      "sha": "174fd6d0ffc0f707e9e38aee5e65cb4c2732d240",
      "filename": "gdb/doc/gdb.texinfo",
      "status": "modified",
      "additions": 16,
      "deletions": 0,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/doc/gdb.texinfo",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/doc/gdb.texinfo",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/doc/gdb.texinfo?ref=2e3773ff548f068bddfc6d060524730fcf6823a1",
      "patch": "@@ -3118,6 +3118,22 @@ For example,\n   2    process 2307      2 (extended-remote host:10000)  hello\n @end smallexample\n \n+To get informations about the current inferior, use @code{inferior}:\n+\n+@table @code\n+@kindex inferior\n+@item inferior\n+Shows information about the current inferior.\n+\n+For example,\n+@end table\n+@c end table here to get a little more width for example\n+\n+@smallexample\n+(@value{GDBP}) inferior\n+[Current inferior is 1 [process 3401] (helloworld)]\n+@end smallexample\n+\n To find out what open target connections exist at any moment, use\n @w{@code{info connections}}:\n "
    },
    {
      "sha": "49f869a4c783a93472b2c2bec082c0a2316dae8b",
      "filename": "gdb/inferior.c",
      "status": "modified",
      "additions": 37,
      "deletions": 21,
      "changes": 58,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/inferior.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/inferior.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/inferior.c?ref=2e3773ff548f068bddfc6d060524730fcf6823a1",
      "patch": "@@ -635,34 +635,50 @@ inferior_command (const char *args, int from_tty)\n   struct inferior *inf;\n   int num;\n \n-  num = parse_and_eval_long (args);\n-\n-  inf = find_inferior_id (num);\n-  if (inf == NULL)\n-    error (_(\"Inferior ID %d not known.\"), num);\n-\n-  if (inf->pid != 0)\n+  if (args == nullptr)\n     {\n-      if (inf != current_inferior ())\n-\t{\n-\t  thread_info *tp = any_thread_of_inferior (inf);\n-\t  if (tp == NULL)\n-\t    error (_(\"Inferior has no threads.\"));\n+      inf = current_inferior ();\n+      gdb_assert (inf != nullptr);\n+      const char *filename = inf->pspace->exec_filename.get ();\n \n-\t  switch_to_thread (tp);\n-\t}\n+      if (filename == nullptr)\n+\tfilename = _(\"<noexec>\");\n \n-      gdb::observers::user_selected_context_changed.notify\n-\t(USER_SELECTED_INFERIOR\n-\t | USER_SELECTED_THREAD\n-\t | USER_SELECTED_FRAME);\n+      printf_filtered (_(\"[Current inferior is %d [%s] (%s)]\\n\"),\n+\t\t       inf->num, inferior_pid_to_str (inf->pid).c_str (),\n+\t\t       filename);\n     }\n   else\n     {\n-      switch_to_inferior_no_thread (inf);\n+      num = parse_and_eval_long (args);\n+\n+      inf = find_inferior_id (num);\n+      if (inf == NULL)\n+\terror (_(\"Inferior ID %d not known.\"), num);\n+\n+      if (inf->pid != 0)\n+\t{\n+\t  if (inf != current_inferior ())\n+\t    {\n+\t      thread_info *tp = any_thread_of_inferior (inf);\n+\t      if (tp == NULL)\n+\t\terror (_(\"Inferior has no threads.\"));\n \n-      gdb::observers::user_selected_context_changed.notify\n-\t(USER_SELECTED_INFERIOR);\n+\t      switch_to_thread (tp);\n+\t    }\n+\n+\t  gdb::observers::user_selected_context_changed.notify\n+\t    (USER_SELECTED_INFERIOR\n+\t     | USER_SELECTED_THREAD\n+\t     | USER_SELECTED_FRAME);\n+\t}\n+      else\n+\t{\n+\t  switch_to_inferior_no_thread (inf);\n+\n+\t  gdb::observers::user_selected_context_changed.notify\n+\t    (USER_SELECTED_INFERIOR);\n+\t}\n     }\n }\n "
    },
    {
      "sha": "5731d0e08b09cb4ad146d0862f6cc0fb93983c0d",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=2e3773ff548f068bddfc6d060524730fcf6823a1",
      "patch": "@@ -1,3 +1,8 @@\n+2021-02-02  Lancelot SIX  <lsix@lancelotsix.com>\n+\n+\t* gdb.base/inferior-noarg.c: New test.\n+\t* gdb.base/inferior-noarg.exp: New test.\n+\n 2021-02-02  Simon Marchi  <simon.marchi@polymtl.ca>\n \n \t* gdb.base/scope.exp: Use proc_with_prefix."
    },
    {
      "sha": "bfe52c018d47899c142e2c03b70c11a73db0eac6",
      "filename": "gdb/testsuite/gdb.base/inferior-noarg.c",
      "status": "added",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/testsuite/gdb.base/inferior-noarg.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/testsuite/gdb.base/inferior-noarg.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/inferior-noarg.c?ref=2e3773ff548f068bddfc6d060524730fcf6823a1",
      "patch": "@@ -0,0 +1,22 @@\n+/* This testcase is part of GDB, the GNU debugger.\n+\n+   Copyright 2021 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n+\n+int\n+main (void)\n+{\n+  return 0;\n+}"
    },
    {
      "sha": "65d23fe46e8f7026303ca24f52555d6b7012e8b5",
      "filename": "gdb/testsuite/gdb.base/inferior-noarg.exp",
      "status": "added",
      "additions": 36,
      "deletions": 0,
      "changes": 36,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/testsuite/gdb.base/inferior-noarg.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2e3773ff548f068bddfc6d060524730fcf6823a1/gdb/testsuite/gdb.base/inferior-noarg.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/inferior-noarg.exp?ref=2e3773ff548f068bddfc6d060524730fcf6823a1",
      "patch": "@@ -0,0 +1,36 @@\n+# Copyright 2021 Free Software Foundation, Inc.\n+\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+# This test case checks that the 'inferior' command, when given no\n+# argument, displays information about the inferior currently active.\n+\n+standard_testfile\n+\n+if { [prepare_for_testing \"failed to prepare\" \\\n+\t${testfile} ${srcfile}] } {\n+    return\n+}\n+\n+gdb_test \"inferior\" \"\\[Current inferior is 1 \\[<null>\\] (.*)\\]\" \"inferior not running\"\n+\n+if { ![runto_main] } {\n+    untested \"could not run to main\"\n+    return\n+}\n+\n+gdb_test \"inferior\" {\\[Current inferior is 1 \\[.*\\] (.*)\\]} \"inferior running\"\n+gdb_test \"clone-inferior\" \"Added inferior 2.*\" \"create new inferior\"\n+gdb_test \"inferior 2\" \"\\[Switching to inferior 2 \\[<null>\\] (.*)]\" \"change inferior\"\n+gdb_test \"inferior\" \"\\[Current inferior is 2 \\[<null>\\] (.*)\\]\" \"show new inferior\""
    }
  ]
}