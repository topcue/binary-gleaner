{
  "sha": "9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OWFiMDBiNjFhOWQ3ZDg0MzEzYjE3OTMyNTVhMWJjNjNiOTdmZDliNw==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2020-07-14T08:26:51Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2020-07-14T08:26:51Z"
    },
    "message": "x86: don't disassemble MOVBE with two suffixes\n\nMOVBE_Fixup() is entirely redundant with the S macro already used on the\nmnemonics, leading to double suffixes in suffix-always mode. Drop the\nfunction.",
    "tree": {
      "sha": "ae53c9173c9172dcf50282c39d1f20a7c1c8a9d6",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/ae53c9173c9172dcf50282c39d1f20a7c1c8a9d6"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/comments",
  "author": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2875b28aa871395dc17182f0bacfe40a68b1ad05",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2875b28aa871395dc17182f0bacfe40a68b1ad05",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/2875b28aa871395dc17182f0bacfe40a68b1ad05"
    }
  ],
  "stats": {
    "total": 112,
    "additions": 69,
    "deletions": 43
  },
  "files": [
    {
      "sha": "83f0d8cdfb99d022c77dfd56f31e63ffdf9f5b62",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
      "patch": "@@ -1,3 +1,9 @@\n+2020-07-14  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* testsuite/gas/i386/movbe-suffix.d,\n+\ttestsuite/gas/i386/x86-64-movbe-suffix.d: New.\n+\t* testsuite/gas/i386/i386.exp: Run new tests.\n+\n 2020-07-14  Jan Beulich  <jbeulich@suse.com>\n \n \t* testsuite/gas/i386/crc32-suffix.d,"
    },
    {
      "sha": "85441770818aac27627b0c8d2359e14d3b482d7d",
      "filename": "gas/testsuite/gas/i386/i386.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/gas/testsuite/gas/i386/i386.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/gas/testsuite/gas/i386/i386.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/i386.exp?ref=9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
      "patch": "@@ -270,6 +270,7 @@ if [expr ([istarget \"i*86-*-*\"] ||  [istarget \"x86_64-*-*\"]) && [gas_32_check]]\n     run_dump_test \"sse-noavx\"\n     run_dump_test \"movbe\"\n     run_dump_test \"movbe-intel\"\n+    run_dump_test \"movbe-suffix\"\n     run_list_test \"inval-movbe\" \"-al\"\n     run_dump_test \"ept\"\n     run_dump_test \"ept-intel\"\n@@ -876,6 +877,7 @@ if [expr ([istarget \"i*86-*-*\"] || [istarget \"x86_64-*-*\"]) && [gas_64_check]] t\n     run_dump_test \"x86-64-sse-noavx\"\n     run_dump_test \"x86-64-movbe\"\n     run_dump_test \"x86-64-movbe-intel\"\n+    run_dump_test \"x86-64-movbe-suffix\"\n     run_list_test \"x86-64-inval-movbe\" \"-al\"\n     run_dump_test \"x86-64-ept\"\n     run_dump_test \"x86-64-ept-intel\""
    },
    {
      "sha": "83de18e090508f94eff8e228f0cb635052f73213",
      "filename": "gas/testsuite/gas/i386/movbe-suffix.d",
      "status": "added",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/gas/testsuite/gas/i386/movbe-suffix.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/gas/testsuite/gas/i386/movbe-suffix.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/movbe-suffix.d?ref=9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
      "patch": "@@ -0,0 +1,22 @@\n+#objdump: -dwMsuffix\n+#name: i386 movbe w/ suffix\n+#source: movbe.s\n+\n+.*:     file format .*\n+\n+Disassembly of section .text:\n+\n+0+ <foo>:\n+[ \t]*[a-f0-9]+:\t66 0f 38 f0 19       \tmovbew \\(%ecx\\),%bx\n+[ \t]*[a-f0-9]+:\t0f 38 f0 19          \tmovbel \\(%ecx\\),%ebx\n+[ \t]*[a-f0-9]+:\t66 0f 38 f1 19       \tmovbew %bx,\\(%ecx\\)\n+[ \t]*[a-f0-9]+:\t0f 38 f1 19          \tmovbel %ebx,\\(%ecx\\)\n+[ \t]*[a-f0-9]+:\t66 0f 38 f0 19       \tmovbew \\(%ecx\\),%bx\n+[ \t]*[a-f0-9]+:\t0f 38 f0 19          \tmovbel \\(%ecx\\),%ebx\n+[ \t]*[a-f0-9]+:\t66 0f 38 f1 19       \tmovbew %bx,\\(%ecx\\)\n+[ \t]*[a-f0-9]+:\t0f 38 f1 19          \tmovbel %ebx,\\(%ecx\\)\n+[ \t]*[a-f0-9]+:\t66 0f 38 f0 19       \tmovbew \\(%ecx\\),%bx\n+[ \t]*[a-f0-9]+:\t0f 38 f0 19          \tmovbel \\(%ecx\\),%ebx\n+[ \t]*[a-f0-9]+:\t66 0f 38 f1 19       \tmovbew %bx,\\(%ecx\\)\n+[ \t]*[a-f0-9]+:\t0f 38 f1 19          \tmovbel %ebx,\\(%ecx\\)\n+#pass"
    },
    {
      "sha": "f6a98b129ec3c51e4268c4f6e3faf3d258c6a0dc",
      "filename": "gas/testsuite/gas/i386/x86-64-movbe-suffix.d",
      "status": "added",
      "additions": 28,
      "deletions": 0,
      "changes": 28,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/gas/testsuite/gas/i386/x86-64-movbe-suffix.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/gas/testsuite/gas/i386/x86-64-movbe-suffix.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-movbe-suffix.d?ref=9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
      "patch": "@@ -0,0 +1,28 @@\n+#objdump: -dwMsuffix\n+#name: x86-64 movbe w/ suffix\n+#source: x86-64-movbe.s\n+\n+.*:     file format .*\n+\n+Disassembly of section .text:\n+\n+0+ <foo>:\n+[ \t]*[a-f0-9]+:\t66 45 0f 38 f0 29    \tmovbew \\(%r9\\),%r13w\n+[ \t]*[a-f0-9]+:\t45 0f 38 f0 29       \tmovbel \\(%r9\\),%r13d\n+[ \t]*[a-f0-9]+:\t4d 0f 38 f0 29       \tmovbeq \\(%r9\\),%r13\n+[ \t]*[a-f0-9]+:\t66 45 0f 38 f1 29    \tmovbew %r13w,\\(%r9\\)\n+[ \t]*[a-f0-9]+:\t45 0f 38 f1 29       \tmovbel %r13d,\\(%r9\\)\n+[ \t]*[a-f0-9]+:\t4d 0f 38 f1 29       \tmovbeq %r13,\\(%r9\\)\n+[ \t]*[a-f0-9]+:\t66 45 0f 38 f0 29    \tmovbew \\(%r9\\),%r13w\n+[ \t]*[a-f0-9]+:\t45 0f 38 f0 29       \tmovbel \\(%r9\\),%r13d\n+[ \t]*[a-f0-9]+:\t4d 0f 38 f0 29       \tmovbeq \\(%r9\\),%r13\n+[ \t]*[a-f0-9]+:\t66 45 0f 38 f1 29    \tmovbew %r13w,\\(%r9\\)\n+[ \t]*[a-f0-9]+:\t45 0f 38 f1 29       \tmovbel %r13d,\\(%r9\\)\n+[ \t]*[a-f0-9]+:\t4d 0f 38 f1 29       \tmovbeq %r13,\\(%r9\\)\n+[ \t]*[a-f0-9]+:\t66 0f 38 f0 19       \tmovbew \\(%rcx\\),%bx\n+[ \t]*[a-f0-9]+:\t0f 38 f0 19          \tmovbel \\(%rcx\\),%ebx\n+[ \t]*[a-f0-9]+:\t48 0f 38 f0 19       \tmovbeq \\(%rcx\\),%rbx\n+[ \t]*[a-f0-9]+:\t66 0f 38 f1 19       \tmovbew %bx,\\(%rcx\\)\n+[ \t]*[a-f0-9]+:\t0f 38 f1 19          \tmovbel %ebx,\\(%rcx\\)\n+[ \t]*[a-f0-9]+:\t48 0f 38 f1 19       \tmovbeq %rbx,\\(%rcx\\)\n+#pass"
    },
    {
      "sha": "0e9e75bd48b964f54b98fbff52a923d8f55d58c5",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
      "patch": "@@ -1,3 +1,9 @@\n+2020-07-14  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* i386-dis.c (MOVBE_Fixup): Delete.\n+\t(Mv): Define.\n+\t(prefix_table): Use Mv for movbe entries.\n+\n 2020-07-14  Jan Beulich  <jbeulich@suse.com>\n \n \t* i386-dis.c (CRC32_Fixup): Delete."
    },
    {
      "sha": "aa36ef5c61ac0ce813cebdb6f725a65607e659eb",
      "filename": "opcodes/i386-dis.c",
      "status": "modified",
      "additions": 5,
      "deletions": 43,
      "changes": 48,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/opcodes/i386-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9ab00b61a9d7d84313b1793255a1bc63b97fd9b7/opcodes/i386-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-dis.c?ref=9ab00b61a9d7d84313b1793255a1bc63b97fd9b7",
      "patch": "@@ -118,7 +118,6 @@ static void XMM_Fixup (int, int);\n static void FXSAVE_Fixup (int, int);\n static void PCMPESTR_Fixup (int, int);\n \n-static void MOVBE_Fixup (int, int);\n static void MOVSXD_Fixup (int, int);\n \n static void OP_Mask (int, int);\n@@ -266,6 +265,7 @@ fetch_data (struct disassemble_info *info, bfd_byte *addr)\n #define Mo { OP_M, o_mode }\n #define Mp { OP_M, f_mode }\t\t/* 32 or 48 bit memory operand for LDS, LES etc */\n #define Mq { OP_M, q_mode }\n+#define Mv { OP_M, v_mode }\n #define Mv_bnd { OP_M, v_bndmk_mode }\n #define Mx { OP_M, x_mode }\n #define Mxmm { OP_M, xmm_mode }\n@@ -4422,17 +4422,17 @@ static const struct dis386 prefix_table[][4] = {\n \n   /* PREFIX_0F38F0 */\n   {\n-    { \"movbeS\",\t{ Gv, { MOVBE_Fixup, v_mode } }, PREFIX_OPCODE },\n+    { \"movbeS\",\t{ Gv, Mv }, PREFIX_OPCODE },\n     { Bad_Opcode },\n-    { \"movbeS\",\t{ Gv, { MOVBE_Fixup, v_mode } }, PREFIX_OPCODE },\n+    { \"movbeS\",\t{ Gv, Mv }, PREFIX_OPCODE },\n     { \"crc32A\",\t{ Gdq, Eb }, PREFIX_OPCODE },\n   },\n \n   /* PREFIX_0F38F1 */\n   {\n-    { \"movbeS\",\t{ { MOVBE_Fixup, v_mode }, Gv }, PREFIX_OPCODE },\n+    { \"movbeS\",\t{ Mv, Gv }, PREFIX_OPCODE },\n     { Bad_Opcode },\n-    { \"movbeS\",\t{ { MOVBE_Fixup, v_mode }, Gv }, PREFIX_OPCODE },\n+    { \"movbeS\",\t{ Mv, Gv }, PREFIX_OPCODE },\n     { \"crc32Q\",\t{ Gdq, Ev }, PREFIX_OPCODE },\n   },\n \n@@ -16807,44 +16807,6 @@ PCLMUL_Fixup (int bytemode ATTRIBUTE_UNUSED,\n     }\n }\n \n-static void\n-MOVBE_Fixup (int bytemode, int sizeflag)\n-{\n-  /* Add proper suffix to \"movbe\".  */\n-  char *p = mnemonicendp;\n-\n-  switch (bytemode)\n-    {\n-    case v_mode:\n-      if (intel_syntax)\n-\tgoto skip;\n-\n-      USED_REX (REX_W);\n-      if (sizeflag & SUFFIX_ALWAYS)\n-\t{\n-\t  if (rex & REX_W)\n-\t    *p++ = 'q';\n-\t  else\n-\t    {\n-\t      if (sizeflag & DFLAG)\n-\t\t*p++ = 'l';\n-\t      else\n-\t\t*p++ = 'w';\n-\t      used_prefixes |= (prefixes & PREFIX_DATA);\n-\t    }\n-\t}\n-      break;\n-    default:\n-      oappend (INTERNAL_DISASSEMBLER_ERROR);\n-      break;\n-    }\n-  mnemonicendp = p;\n-  *p = '\\0';\n-\n- skip:\n-  OP_M (bytemode, sizeflag);\n-}\n-\n static void\n MOVSXD_Fixup (int bytemode, int sizeflag)\n {"
    }
  ]
}