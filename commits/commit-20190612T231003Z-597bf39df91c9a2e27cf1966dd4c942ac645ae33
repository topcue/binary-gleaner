{
  "sha": "597bf39df91c9a2e27cf1966dd4c942ac645ae33",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NTk3YmYzOWRmOTFjOWEyZTI3Y2YxOTY2ZGQ0Yzk0MmFjNjQ1YWUzMw==",
  "commit": {
    "author": {
      "name": "Pedro Alves",
      "email": "palves@redhat.com",
      "date": "2019-06-12T23:06:52Z"
    },
    "committer": {
      "name": "Pedro Alves",
      "email": "palves@redhat.com",
      "date": "2019-06-12T23:10:03Z"
    },
    "message": "Remove \"show\" command completers, \"set\" command completers for string commands\n\nThe default command completer is symbol_completer, but it makes no\nsense for a \"show\" command to complete on symbols, or anything else,\nreally.\n\nI wonder whether we should instead make the default be no completer.\nThat seems like a much larger/complicated audit/change, so I'd like to\nmove forward with this version, as it'll be covered by tests.  I\nnoticed this because a following patch will add a new\ngdb.base/settings.exp testcase that exercises all sorts of details of\nsettings commands, including completing the show commands, using new\nrepresentative \"maint test-settings <type or settings command>\"\ncommands.\n\nAlso remove the completer for var_string and var_string_noescape\ncommands.  No point in completing symbols when GDB is expecting a\nstring.\n\ngdb/ChangeLog:\n2019-06-13  Pedro Alves  <palves@redhat.com>\n\n\t* cli/cli-decode.c (add_setshow_cmd_full): Remove \"show\"\n\tcompleter.\n\t(add_setshow_string_cmd, add_setshow_string_noescape_cmd): Remove\n\t\"set\" completers.",
    "tree": {
      "sha": "0096227f6cd886277d5149a9fb2d8076dccef48c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/0096227f6cd886277d5149a9fb2d8076dccef48c"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/597bf39df91c9a2e27cf1966dd4c942ac645ae33",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/597bf39df91c9a2e27cf1966dd4c942ac645ae33",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/597bf39df91c9a2e27cf1966dd4c942ac645ae33",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/597bf39df91c9a2e27cf1966dd4c942ac645ae33/comments",
  "author": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "48c410fb70fe09c036e27092880db687e5c2fb0b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/48c410fb70fe09c036e27092880db687e5c2fb0b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/48c410fb70fe09c036e27092880db687e5c2fb0b"
    }
  ],
  "stats": {
    "total": 21,
    "additions": 20,
    "deletions": 1
  },
  "files": [
    {
      "sha": "f1354dec9b1749c96cb5a3bdf254bcd7a87310d0",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/597bf39df91c9a2e27cf1966dd4c942ac645ae33/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/597bf39df91c9a2e27cf1966dd4c942ac645ae33/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=597bf39df91c9a2e27cf1966dd4c942ac645ae33",
      "patch": "@@ -1,3 +1,10 @@\n+2019-06-13  Pedro Alves  <palves@redhat.com>\n+\n+\t* cli/cli-decode.c (add_setshow_cmd_full): Remove \"show\"\n+\tcompleter.\n+\t(add_setshow_string_cmd, add_setshow_string_noescape_cmd): Remove\n+\t\"set\" completers.\n+\n 2019-06-13  Pedro Alves  <palves@redhat.com>\n \n \t* cli/cli-setshow.c (do_set_command) <var_enum>: Detect junk"
    },
    {
      "sha": "30f79b5259df5d15569eeb1d971970551d15ec0f",
      "filename": "gdb/cli/cli-decode.c",
      "status": "modified",
      "additions": 13,
      "deletions": 1,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/597bf39df91c9a2e27cf1966dd4c942ac645ae33/gdb/cli/cli-decode.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/597bf39df91c9a2e27cf1966dd4c942ac645ae33/gdb/cli/cli-decode.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/cli/cli-decode.c?ref=597bf39df91c9a2e27cf1966dd4c942ac645ae33",
      "patch": "@@ -509,6 +509,9 @@ add_setshow_cmd_full (const char *name,\n \t\t\t      full_show_doc, show_list);\n   show->doc_allocated = 1;\n   show->show_value_func = show_func;\n+  /* Disable the default symbol completer.  Doesn't make much sense\n+     for the \"show\" command to complete on anything.  */\n+  set_cmd_completer (show, nullptr);\n \n   if (set_result != NULL)\n     *set_result = set;\n@@ -633,11 +636,16 @@ add_setshow_string_cmd (const char *name, enum command_class theclass,\n \t\t\tstruct cmd_list_element **set_list,\n \t\t\tstruct cmd_list_element **show_list)\n {\n+  cmd_list_element *set_cmd;\n+\n   add_setshow_cmd_full (name, theclass, var_string, var,\n \t\t\tset_doc, show_doc, help_doc,\n \t\t\tset_func, show_func,\n \t\t\tset_list, show_list,\n-\t\t\tNULL, NULL);\n+\t\t\t&set_cmd, NULL);\n+\n+  /* Disable the default symbol completer.  */\n+  set_cmd_completer (set_cmd, nullptr);\n }\n \n /* Add element named NAME to both the set and show command LISTs (the\n@@ -659,6 +667,10 @@ add_setshow_string_noescape_cmd (const char *name, enum command_class theclass,\n \t\t\tset_func, show_func,\n \t\t\tset_list, show_list,\n \t\t\t&set_cmd, NULL);\n+\n+  /* Disable the default symbol completer.  */\n+  set_cmd_completer (set_cmd, nullptr);\n+\n   return set_cmd;\n }\n "
    }
  ]
}