{
  "sha": "bcb78b47614ed252226da1a688558a17d8a99ce8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YmNiNzhiNDc2MTRlZDI1MjIyNmRhMWE2ODg1NThhMTdkOGE5OWNlOA==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-11-12T11:43:20Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-11-12T11:43:20Z"
    },
    "message": "Stop Gas from generating line info or address ranges for sections that do not contain code or are not loaded.\n\n\tPR 26850\n\t* dwarf2dbg.c (dwarf2_gen_line_info_1): Do not record lines in\n\tsections that are not executable or not loadable.\n\t(out_debug_line): Move warning message into dwarf2_gen_line_info_1.\n\t* testsuite/gas/elf/dwarf2-20.s: New test.\n\t* testsuite/gas/elf/dwarf2-20.d: New test driver.\n\t* testsuite/gas/elf/elf.exp: Run the new test.\n\t* testsuite/gas/elf/warn-2.s: Use the .nop directive.",
    "tree": {
      "sha": "18d3480d3cb634ae6c431ef27e1b338ccecfbe84",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/18d3480d3cb634ae6c431ef27e1b338ccecfbe84"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/bcb78b47614ed252226da1a688558a17d8a99ce8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/bcb78b47614ed252226da1a688558a17d8a99ce8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/bcb78b47614ed252226da1a688558a17d8a99ce8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/bcb78b47614ed252226da1a688558a17d8a99ce8/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ab33b15255460ac45a001c8ebf69ef73f6f1fba4",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ab33b15255460ac45a001c8ebf69ef73f6f1fba4",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/ab33b15255460ac45a001c8ebf69ef73f6f1fba4"
    }
  ],
  "stats": {
    "total": 71,
    "additions": 54,
    "deletions": 17
  },
  "files": [
    {
      "sha": "36258e83ddd3a962202012d8fe2c6625f15c6e46",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=bcb78b47614ed252226da1a688558a17d8a99ce8",
      "patch": "@@ -1,3 +1,12 @@\n+2020-11-12  Nick Clifton  <nickc@redhat.com>\n+\n+\tPR 26850\n+\t* dwarf2dbg.c\n+\t* testsuite/gas/elf/dwarf2-20.s: New test.\n+\t* testsuite/gas/elf/dwarf2-20.d: New test driver.\n+\t* testsuite/gas/elf/elf.exp: Run the new test.\n+\t* testsuite/gas/elf/warn-2.s\n+\n 2020-11-11  Przemyslaw Wirkus  <przemyslaw.wirkus@arm.com>\n \n \t* testsuite/gas/aarch64/ls64.s: Update test."
    },
    {
      "sha": "25ebc94a8d2b4c51279290770f188bf0ae60be19",
      "filename": "gas/dwarf2dbg.c",
      "status": "modified",
      "additions": 14,
      "deletions": 4,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/dwarf2dbg.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/dwarf2dbg.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/dwarf2dbg.c?ref=bcb78b47614ed252226da1a688558a17d8a99ce8",
      "patch": "@@ -504,6 +504,18 @@ dwarf2_gen_line_info_1 (symbolS *label, struct dwarf2_line_info *loc)\n {\n   struct line_subseg *lss;\n   struct line_entry *e;\n+  flagword need_flags = SEC_ALLOC | SEC_LOAD | SEC_CODE;\n+\n+  /* PR 26850: Do not record LOCs in non-executable, non-allocated,\n+     or non-loaded sections.  */\n+  if ((now_seg->flags & need_flags) != need_flags)\n+    {\n+      if (! SEG_NORMAL (now_seg))\n+\t/* FIXME: Add code to suppress multiple warnings ?  */\n+\tas_warn (\"dwarf line number information for %s ignored\",\n+\t\t segment_name (now_seg));\n+      return;\n+    }\n \n   e = XNEW (struct line_entry);\n   e->next = NULL;\n@@ -2341,11 +2353,10 @@ out_debug_line (segT line_seg)\n \n   /* For each section, emit a statement program.  */\n   for (s = all_segs; s; s = s->next)\n+    /* Paranoia - this check should have already have\n+       been handled in dwarf2_gen_line_info_1().  */\n     if (SEG_NORMAL (s->seg))\n       process_entries (s->seg, s->head->head);\n-    else\n-      as_warn (\"dwarf line number information for %s ignored\",\n-\t       segment_name (s->seg));\n \n   if (flag_dwarf_sections)\n     /* We have to switch to the special .debug_line_end section\n@@ -2740,7 +2751,6 @@ dwarf2_init (void)\n     flag_dwarf_cie_version = 1;\n }\n \n-\n /* Finish the dwarf2 debug sections.  We emit .debug.line if there\n    were any .file/.loc directives, or --gdwarf2 was given, and if the\n    file has a non-empty .debug_info section and an empty .debug_line"
    },
    {
      "sha": "363510a9b091a4760b650fada40326e53f456d0e",
      "filename": "gas/testsuite/gas/elf/dwarf2-20.d",
      "status": "added",
      "additions": 18,
      "deletions": 0,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/testsuite/gas/elf/dwarf2-20.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/testsuite/gas/elf/dwarf2-20.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/elf/dwarf2-20.d?ref=bcb78b47614ed252226da1a688558a17d8a99ce8",
      "patch": "@@ -0,0 +1,18 @@\n+#as: -gdwarf-3\n+#readelf: -wr\n+#name: DWARF2_20: debug ranges ignore non-code sections\n+# The mn10200 target has a pointer size of 3, but it does not use segment selectors.  This confuses DWARF and readelf will complain.\n+#xfail: mn102*-*\n+\n+Contents of the .debug_aranges section:\n+\n+[ \t]+Length:[ \t]+(16|28|44)\n+[ \t]+Version:.*\n+[ \t]+Offset into .debug_info:[ \t]+0x0\n+[ \t]+Pointer Size:[ \t]+(2|4|8)\n+[ \t]+Segment Size:[ \t]+0\n+\n+[ \t]+Address[ \t]+Length\n+[ \t]+0+000 0+00. \n+[ \t]+0+000 0+000 \n+#pass"
    },
    {
      "sha": "0ad0cc3ff029b81f52206e2400d1f144830a4c92",
      "filename": "gas/testsuite/gas/elf/dwarf2-20.s",
      "status": "added",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/testsuite/gas/elf/dwarf2-20.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/testsuite/gas/elf/dwarf2-20.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/elf/dwarf2-20.s?ref=bcb78b47614ed252226da1a688558a17d8a99ce8",
      "patch": "@@ -0,0 +1,10 @@\n+\t.section .alloc0,\"a\"\n+\t.nop\n+\t.section .alloc1,\"a\"\n+\t.nop\n+\t.section .nonalloc,\"\"\n+\t.nop\n+\t.section .allocexec,\"ax\"\n+\t.nop\n+\t.section .nonallocexec,\"x\"\n+\t.nop"
    },
    {
      "sha": "edacf27d9d8d6796fc27278eef49b125d61f8ec0",
      "filename": "gas/testsuite/gas/elf/elf.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/testsuite/gas/elf/elf.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/testsuite/gas/elf/elf.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/elf/elf.exp?ref=bcb78b47614ed252226da1a688558a17d8a99ce8",
      "patch": "@@ -282,6 +282,7 @@ if { [is_elf_format] } then {\n     run_dump_test \"dwarf2-17\" $dump_opts\n     run_dump_test \"dwarf2-18\" $dump_opts\n     run_dump_test \"dwarf2-19\" $dump_opts\n+    run_dump_test \"dwarf2-20\" $dump_opts\n     run_dump_test \"dwarf-5-file0\" $dump_opts\n     run_dump_test \"dwarf-4-cu\" $dump_opts\n     run_dump_test \"dwarf-5-cu\" $dump_opts"
    },
    {
      "sha": "8a128a197e5a5ac078a24367ffc2b1bc2147dc3e",
      "filename": "gas/testsuite/gas/elf/warn-2.s",
      "status": "modified",
      "additions": 2,
      "deletions": 13,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/testsuite/gas/elf/warn-2.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/bcb78b47614ed252226da1a688558a17d8a99ce8/gas/testsuite/gas/elf/warn-2.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/elf/warn-2.s?ref=bcb78b47614ed252226da1a688558a17d8a99ce8",
      "patch": "@@ -1,18 +1,7 @@\n ;# { dg-do assemble }\n-;# { dg-options \"--gdwarf2 --defsym nop_type=0\" }\n-;# { dg-options \"--gdwarf2 --defsym nop_type=1\" { target ia64-*-* } }\n-;# { dg-options \"--gdwarf2 --defsym nop_type=2\" { target or1k*-*-* } }\n+;# { dg-options \"--gdwarf2\" }\n \n \t.offset 40\n-\t\n- .ifeq nop_type - 1\n-\tnop 0\n- .else\n- .ifeq nop_type - 2\n-\tl.nop 0\n- .else\n-\tnop\n- .endif\n- .endif\n+\t.nop\n \n ;# { dg-warning \"Warning: dwarf line number information for .* ignored\" \"\" { xfail v850*-*-* } 0 }"
    }
  ]
}