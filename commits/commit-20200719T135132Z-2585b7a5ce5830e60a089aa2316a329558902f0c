{
  "sha": "2585b7a5ce5830e60a089aa2316a329558902f0c",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MjU4NWI3YTVjZTU4MzBlNjBhMDg5YWEyMzE2YTMyOTU1ODkwMmYwYw==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-07-19T13:51:19Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-07-19T13:51:32Z"
    },
    "message": "x86: Change PLT32 reloc against section to PC32\n\nCommit 292676c1 resolved PLT32 reloc aganst local symbol to section.\nSince PLT32 relocation must be against symbols, turn such PLT32\nrelocation into PC32 relocation.\n\ngas/\n\n\tPR gas/26263\n\t* config/tc-i386.c (i386_validate_fix): Change PLT32 reloc\n\tagainst section to PC32 reloc.\n\t* testsuite/gas/i386/relax-5.d: Updated.\n\t* testsuite/gas/i386/x86-64-relax-4.d: Likewise.\n\nld/\n\n\tPR gas/26263\n\t* testsuite/ld-i386/i386.exp: Run PR gas/26263 test.\n\t* testsuite/ld-x86-64/x86-64.exp: Likewise.\n\t* testsuite/ld-i386/pr26263.d: New file.\n\t* testsuite/ld-x86-64/pr26263.d: Likewise.\n\t* testsuite/ld-x86-64/pr26263.s: Likewise.",
    "tree": {
      "sha": "6ff218fb5b0fe5ad80a2cdabd0aa909416e0a6a2",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6ff218fb5b0fe5ad80a2cdabd0aa909416e0a6a2"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/2585b7a5ce5830e60a089aa2316a329558902f0c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2585b7a5ce5830e60a089aa2316a329558902f0c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/2585b7a5ce5830e60a089aa2316a329558902f0c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2585b7a5ce5830e60a089aa2316a329558902f0c/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "4609ada49f559880e85aecc2f37f377e5bff8696",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4609ada49f559880e85aecc2f37f377e5bff8696",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/4609ada49f559880e85aecc2f37f377e5bff8696"
    }
  ],
  "stats": {
    "total": 87,
    "additions": 81,
    "deletions": 6
  },
  "files": [
    {
      "sha": "e07e4eea1d09a1f8f221bf7d721c9768192ec4e1",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -1,3 +1,11 @@\n+2020-07-19  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR gas/26263\n+\t* config/tc-i386.c (i386_validate_fix): Change PLT32 reloc\n+\tagainst section to PC32 reloc.\n+\t* testsuite/gas/i386/relax-5.d: Updated.\n+\t* testsuite/gas/i386/x86-64-relax-4.d: Likewise.\n+\n 2020-07-15  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR gas/26237"
    },
    {
      "sha": "a9c79f1550bed3beebcf8049dce46b928f29de8c",
      "filename": "gas/config/tc-i386.c",
      "status": "modified",
      "additions": 15,
      "deletions": 4,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/gas/config/tc-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/gas/config/tc-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.c?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -13849,11 +13849,22 @@ i386_validate_fix (fixS *fixp)\n \t}\n     }\n #if defined (OBJ_ELF) || defined (OBJ_MAYBE_ELF)\n-  else if (!object_64bit)\n+  else\n     {\n-      if (fixp->fx_r_type == BFD_RELOC_386_GOT32\n-\t  && fixp->fx_tcbit2)\n-\tfixp->fx_r_type = BFD_RELOC_386_GOT32X;\n+      /* NB: Commit 292676c1 resolved PLT32 reloc aganst local symbol\n+\t to section.  Since PLT32 relocation must be against symbols,\n+\t turn such PLT32 relocation into PC32 relocation.  */\n+      if (fixp->fx_addsy\n+\t  && (fixp->fx_r_type == BFD_RELOC_386_PLT32\n+\t      || fixp->fx_r_type == BFD_RELOC_X86_64_PLT32)\n+\t  && symbol_section_p (fixp->fx_addsy))\n+\tfixp->fx_r_type = BFD_RELOC_32_PCREL;\n+      if (!object_64bit)\n+\t{\n+\t  if (fixp->fx_r_type == BFD_RELOC_386_GOT32\n+\t      && fixp->fx_tcbit2)\n+\t    fixp->fx_r_type = BFD_RELOC_386_GOT32X;\n+\t}\n     }\n #endif\n }"
    },
    {
      "sha": "c3771330b28556e4159c719f5df1bdbf88c705ae",
      "filename": "gas/testsuite/gas/i386/relax-5.d",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/gas/testsuite/gas/i386/relax-5.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/gas/testsuite/gas/i386/relax-5.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/relax-5.d?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -10,6 +10,6 @@ Disassembly of section .text:\n Disassembly of section .init.text:\n \n 0+ <foo>:\n- +[a-f0-9]+:\te8 fb ff ff ff       \tcall   0 <foo>\t1: R_386_PLT32\t.text\n+ +[a-f0-9]+:\te8 fc ff ff ff       \tcall   1 <foo\\+0x1>\t1: R_386_PC32\t.text\n  +[a-f0-9]+:\te8 fc ff ff ff       \tcall   6 <foo\\+0x6>\t6: R_386_PC32\t.text\n #pass"
    },
    {
      "sha": "ca12c0383bed6d911cedaa56268f53d0aecb15b7",
      "filename": "gas/testsuite/gas/i386/x86-64-relax-4.d",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/gas/testsuite/gas/i386/x86-64-relax-4.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/gas/testsuite/gas/i386/x86-64-relax-4.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-relax-4.d?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -12,6 +12,6 @@ Disassembly of section .text:\n Disassembly of section .init.text:\n \n 0+ <foo>:\n- +[a-f0-9]+:\te8 00 00 00 00       \tcall   5 <foo\\+0x5>\t1: R_X86_64_PLT32\t.text-0x4\n+ +[a-f0-9]+:\te8 00 00 00 00       \tcall   5 <foo\\+0x5>\t1: R_X86_64_PC32\t.text-0x4\n  +[a-f0-9]+:\t48 8d 05 00 00 00 00 \tlea    0x0\\(%rip\\),%rax        # c <foo\\+0xc>\t8: R_X86_64_PC32\t.text-0x4\n #pass"
    },
    {
      "sha": "747856868ab5f3eedf416a67d02920f3e3cb1fb5",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -1,3 +1,12 @@\n+2020-07-19  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR gas/26263\n+\t* testsuite/ld-i386/i386.exp: Run PR gas/26263 test.\n+\t* testsuite/ld-x86-64/x86-64.exp: Likewise.\n+\t* testsuite/ld-i386/pr26263.d: New file.\n+\t* testsuite/ld-x86-64/pr26263.d: Likewise.\n+\t* testsuite/ld-x86-64/pr26263.s: Likewise.\n+\n 2020-07-19  Hans-Peter Nilsson  <hp@bitrange.com>\n \n \t* scripttempl/elf.sc (ETEXT_LAST_IN_RODATA_SEGMENT): New variable."
    },
    {
      "sha": "164c099cbbb90fb28c10c28a6213959ae14fabdb",
      "filename": "ld/testsuite/ld-i386/i386.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-i386/i386.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-i386/i386.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/i386.exp?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -469,6 +469,7 @@ run_dump_test \"pr24322a\"\n run_dump_test \"pr24322b\"\n run_dump_test \"align-branch-1\"\n run_dump_test \"pr26018\"\n+run_dump_test \"pr26263\"\n \n if { !([istarget \"i?86-*-linux*\"]\n        || [istarget \"i?86-*-gnu*\"]"
    },
    {
      "sha": "8cf7c15a66cbb55065bb47f2f8587f6980e11b2e",
      "filename": "ld/testsuite/ld-i386/pr26263.d",
      "status": "added",
      "additions": 19,
      "deletions": 0,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-i386/pr26263.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-i386/pr26263.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr26263.d?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -0,0 +1,19 @@\n+#source: ../ld-x86-64/pr26263.s\n+#as: --32\n+#ld: -shared -melf_i386\n+#objdump: -dw\n+\n+.*: +file format .*\n+\n+\n+Disassembly of section .text:\n+\n+0+1000 <printk>:\n+ +[a-f0-9]+:\tc3                   \tret    \n+\n+Disassembly of section .init.text:\n+\n+0+1001 <foo>:\n+ +[a-f0-9]+:\te8 fa ff ff ff       \tcall   1000 <printk>\n+ +[a-f0-9]+:\te8 f5 ff ff ff       \tcall   1000 <printk>\n+#pass"
    },
    {
      "sha": "375218c3e9a55db6f539b07d622f9cfef46255dd",
      "filename": "ld/testsuite/ld-x86-64/pr26263.d",
      "status": "added",
      "additions": 18,
      "deletions": 0,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-x86-64/pr26263.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-x86-64/pr26263.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr26263.d?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -0,0 +1,18 @@\n+#as: --64\n+#ld: -m elf_x86_64 -shared\n+#objdump: -dw\n+\n+.*: +file format .*\n+\n+\n+Disassembly of section .text:\n+\n+0+1000 <printk>:\n+ +[a-f0-9]+:\tc3                   \tret    \n+\n+Disassembly of section .init.text:\n+\n+0+1001 <foo>:\n+ +[a-f0-9]+:\te8 fa ff ff ff       \tcall   1000 <printk>\n+ +[a-f0-9]+:\te8 f5 ff ff ff       \tcall   1000 <printk>\n+#pass"
    },
    {
      "sha": "5a3332cd5e46095cc2929c3fc39243307f157210",
      "filename": "ld/testsuite/ld-x86-64/pr26263.s",
      "status": "added",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-x86-64/pr26263.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-x86-64/pr26263.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr26263.s?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -0,0 +1,8 @@\n+\t.section .init.text,\"ax\",@progbits\n+\t.global foo\n+foo:\n+\tcall\tprintk\n+\tcall\tprintk@PLT\n+\t.text\n+printk:\n+\tret"
    },
    {
      "sha": "21aa6a06effdb87a1a7208cac39b9b23d66c0b35",
      "filename": "ld/testsuite/ld-x86-64/x86-64.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-x86-64/x86-64.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2585b7a5ce5830e60a089aa2316a329558902f0c/ld/testsuite/ld-x86-64/x86-64.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/x86-64.exp?ref=2585b7a5ce5830e60a089aa2316a329558902f0c",
      "patch": "@@ -640,6 +640,7 @@ run_dump_test \"pr20253-5b\"\n run_dump_test \"tlsdesc2\"\n run_dump_test \"pr22048\"\n run_dump_test \"pr22929\"\n+run_dump_test \"pr26263\"\n \n proc undefined_weak {cflags ldflags} {\n     set testname \"Undefined weak symbol\""
    }
  ]
}