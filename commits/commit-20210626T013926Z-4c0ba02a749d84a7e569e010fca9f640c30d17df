{
  "sha": "4c0ba02a749d84a7e569e010fca9f640c30d17df",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NGMwYmEwMmE3NDlkODRhN2U1NjllMDEwZmNhOWY2NDBjMzBkMTdkZg==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2021-06-26T01:38:25Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2021-06-26T01:39:26Z"
    },
    "message": "gdb: remove context parameter from add_setshow_enum_cmd\n\nI propose removing the context parameter from add_setshow_enum_cmd.  It\nwas useful before add_setshow_enum_cmd returned both created commands,\nas the caller couldn't easily set the context itself.  But now, I think\nit's fine to just let the caller do it.\n\ngdb/ChangeLog:\n\n\t* command.h (add_setshow_enum_cmd): Remove context parameter.\n\t* cli/cli-decode.c (add_setshow_enum_cmd): Likewise, and don't\n\tset context.\n\t* cli/cli-style.c (cli_style_option::add_setshow_commands): Set\n\tcontext here.\n\nChange-Id: I377c4e6820ec9d5069492ed28f4cba342ce1336e",
    "tree": {
      "sha": "db5935ef09b75752a45b41f724d63e0c1c7d6c69",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/db5935ef09b75752a45b41f724d63e0c1c7d6c69"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4c0ba02a749d84a7e569e010fca9f640c30d17df",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4c0ba02a749d84a7e569e010fca9f640c30d17df",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4c0ba02a749d84a7e569e010fca9f640c30d17df",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4c0ba02a749d84a7e569e010fca9f640c30d17df/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d6ff04a343f97026f7d23bb036e0f858b21f3bfd",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d6ff04a343f97026f7d23bb036e0f858b21f3bfd",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d6ff04a343f97026f7d23bb036e0f858b21f3bfd"
    }
  ],
  "stats": {
    "total": 79,
    "additions": 48,
    "deletions": 31
  },
  "files": [
    {
      "sha": "9acde122a2a8aa8edaab4d0fc00b716e0ec7bd6e",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4c0ba02a749d84a7e569e010fca9f640c30d17df/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4c0ba02a749d84a7e569e010fca9f640c30d17df/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=4c0ba02a749d84a7e569e010fca9f640c30d17df",
      "patch": "@@ -1,3 +1,11 @@\n+2021-06-25  Simon Marchi  <simon.marchi@polymtl.ca>\n+\n+\t* command.h (add_setshow_enum_cmd): Remove context parameter.\n+\t* cli/cli-decode.c (add_setshow_enum_cmd): Likewise, and don't\n+\tset context.\n+\t* cli/cli-style.c (cli_style_option::add_setshow_commands): Set\n+\tcontext here.\n+\n 2021-06-25  Simon Marchi  <simon.marchi@polymtl.ca>\n \n \t* cli/cli-decode.h (struct cmd_list_element) <set_context>: Add"
    },
    {
      "sha": "633a3ad930950aaf1e8ed05c23fdc2ee116de34b",
      "filename": "gdb/cli/cli-decode.c",
      "status": "modified",
      "additions": 1,
      "deletions": 6,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4c0ba02a749d84a7e569e010fca9f640c30d17df/gdb/cli/cli-decode.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4c0ba02a749d84a7e569e010fca9f640c30d17df/gdb/cli/cli-decode.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/cli/cli-decode.c?ref=4c0ba02a749d84a7e569e010fca9f640c30d17df",
      "patch": "@@ -571,19 +571,14 @@ add_setshow_enum_cmd (const char *name,\n \t\t      cmd_const_sfunc_ftype *set_func,\n \t\t      show_value_ftype *show_func,\n \t\t      struct cmd_list_element **set_list,\n-\t\t      struct cmd_list_element **show_list,\n-\t\t      void *context)\n+\t\t      struct cmd_list_element **show_list)\n {\n   set_show_commands commands\n     =  add_setshow_cmd_full (name, theclass, var_enum, var,\n \t\t\t     set_doc, show_doc, help_doc,\n \t\t\t     set_func, show_func,\n \t\t\t     set_list, show_list);\n   commands.set->enums = enumlist;\n-\n-  commands.set->set_context (context);\n-  commands.show->set_context (context);\n-\n   return commands;\n }\n "
    },
    {
      "sha": "aca19c51b848a2ec094ba8a0a9cd43059d11b7b9",
      "filename": "gdb/cli/cli-style.c",
      "status": "modified",
      "additions": 38,
      "deletions": 24,
      "changes": 62,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4c0ba02a749d84a7e569e010fca9f640c30d17df/gdb/cli/cli-style.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4c0ba02a749d84a7e569e010fca9f640c30d17df/gdb/cli/cli-style.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/cli/cli-style.c?ref=4c0ba02a749d84a7e569e010fca9f640c30d17df",
      "patch": "@@ -230,32 +230,46 @@ cli_style_option::add_setshow_commands (enum command_class theclass,\n \t\t\t0, set_list);\n   add_show_prefix_cmd (m_name, no_class, prefix_doc, &m_show_list,\n \t\t       0, show_list);\n+  set_show_commands commands;\n+\n+  commands = add_setshow_enum_cmd\n+    (\"foreground\", theclass, cli_colors,\n+     &m_foreground,\n+     _(\"Set the foreground color for this property.\"),\n+     _(\"Show the foreground color for this property.\"),\n+     nullptr,\n+     do_set_value,\n+     do_show_foreground,\n+     &m_set_list, &m_show_list);\n+  commands.set->set_context (this);\n+  commands.show->set_context (this);\n+\n+  commands = add_setshow_enum_cmd\n+    (\"background\", theclass, cli_colors,\n+     &m_background,\n+     _(\"Set the background color for this property.\"),\n+     _(\"Show the background color for this property.\"),\n+     nullptr,\n+     do_set_value,\n+     do_show_background,\n+     &m_set_list, &m_show_list);\n+  commands.set->set_context (this);\n+  commands.show->set_context (this);\n \n-  add_setshow_enum_cmd (\"foreground\", theclass, cli_colors,\n-\t\t\t&m_foreground,\n-\t\t\t_(\"Set the foreground color for this property.\"),\n-\t\t\t_(\"Show the foreground color for this property.\"),\n-\t\t\tnullptr,\n-\t\t\tdo_set_value,\n-\t\t\tdo_show_foreground,\n-\t\t\t&m_set_list, &m_show_list, (void *) this);\n-  add_setshow_enum_cmd (\"background\", theclass, cli_colors,\n-\t\t\t&m_background,\n-\t\t\t_(\"Set the background color for this property.\"),\n-\t\t\t_(\"Show the background color for this property.\"),\n-\t\t\tnullptr,\n-\t\t\tdo_set_value,\n-\t\t\tdo_show_background,\n-\t\t\t&m_set_list, &m_show_list, (void *) this);\n   if (!skip_intensity)\n-    add_setshow_enum_cmd (\"intensity\", theclass, cli_intensities,\n-\t\t\t  &m_intensity,\n-\t\t\t  _(\"Set the display intensity for this property.\"),\n-\t\t\t  _(\"Show the display intensity for this property.\"),\n-\t\t\t  nullptr,\n-\t\t\t  do_set_value,\n-\t\t\t  do_show_intensity,\n-\t\t\t  &m_set_list, &m_show_list, (void *) this);\n+    {\n+      commands = add_setshow_enum_cmd\n+\t(\"intensity\", theclass, cli_intensities,\n+\t &m_intensity,\n+\t _(\"Set the display intensity for this property.\"),\n+\t _(\"Show the display intensity for this property.\"),\n+\t nullptr,\n+\t do_set_value,\n+\t do_show_intensity,\n+\t &m_set_list, &m_show_list);\n+      commands.set->set_context (this);\n+      commands.show->set_context (this);\n+    }\n }\n \n static cmd_list_element *style_set_list;"
    },
    {
      "sha": "711cbdcf43e10044746ba2281fd25edbb7a10483",
      "filename": "gdb/command.h",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4c0ba02a749d84a7e569e010fca9f640c30d17df/gdb/command.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4c0ba02a749d84a7e569e010fca9f640c30d17df/gdb/command.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/command.h?ref=4c0ba02a749d84a7e569e010fca9f640c30d17df",
      "patch": "@@ -403,7 +403,7 @@ extern set_show_commands add_setshow_enum_cmd\n    const char **var, const char *set_doc, const char *show_doc,\n    const char *help_doc, cmd_const_sfunc_ftype *set_func,\n    show_value_ftype *show_func, cmd_list_element **set_list,\n-   cmd_list_element **show_list, void *context = nullptr);\n+   cmd_list_element **show_list);\n \n extern set_show_commands add_setshow_auto_boolean_cmd\n   (const char *name, command_class theclass, auto_boolean *var,"
    }
  ]
}