{
  "sha": "7131d475da0062b2991eecfde76cbff96de289ab",
  "node_id": "C_kwDOANOeidoAKDcxMzFkNDc1ZGEwMDYyYjI5OTFlZWNmZGU3NmNiZmY5NmRlMjg5YWI",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2022-01-04T19:07:50Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2022-01-04T19:12:01Z"
    },
    "message": "ld/x86: Update -z report-relative-reloc\n\nUse 0x%v, instead of bfd_sprintf_vma, to report relative relocations.\nChange linker relative relocations report from\n\ntmpdir/dump: R_X86_64_IRELATIVE (offset: 0x0000000000002000, info: 0x0000000000000025, addend: 0x0000000000001007) against 'ifunc' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o\n\nto\n\ntmpdir/dump: R_X86_64_IRELATIVE (offset: 0x2000, info: 0x25, addend: 0x1007) against 'ifunc' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o\n\nbfd/\n\n\t* elfxx-x86.c (_bfd_x86_elf_link_report_relative_reloc): Use\n\t0x%v instead of bfd_sprintf_vma.\n\nld/\n\n\t* testsuite/ld-i386/report-reloc-1.l: Updated.\n\t* testsuite/ld-x86-64/report-reloc-1.l: Likewise.",
    "tree": {
      "sha": "437dceee8fd5c34de2e7a1b9de98e1e9797cbb60",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/437dceee8fd5c34de2e7a1b9de98e1e9797cbb60"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/7131d475da0062b2991eecfde76cbff96de289ab",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7131d475da0062b2991eecfde76cbff96de289ab",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/7131d475da0062b2991eecfde76cbff96de289ab",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7131d475da0062b2991eecfde76cbff96de289ab/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "6395a1021020671dd205d332b2879e3e733e8024",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6395a1021020671dd205d332b2879e3e733e8024",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/6395a1021020671dd205d332b2879e3e733e8024"
    }
  ],
  "stats": {
    "total": 32,
    "additions": 11,
    "deletions": 21
  },
  "files": [
    {
      "sha": "ca4b90e22cc3da41e17c53d946dc5f4adebe28b1",
      "filename": "bfd/elfxx-x86.c",
      "status": "modified",
      "additions": 7,
      "deletions": 17,
      "changes": 24,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7131d475da0062b2991eecfde76cbff96de289ab/bfd/elfxx-x86.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7131d475da0062b2991eecfde76cbff96de289ab/bfd/elfxx-x86.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-x86.c?ref=7131d475da0062b2991eecfde76cbff96de289ab",
      "patch": "@@ -1754,7 +1754,6 @@ _bfd_x86_elf_link_report_relative_reloc\n   const char *name;\n   bfd *abfd;\n   const Elf_Internal_Rela *rel = (const Elf_Internal_Rela *) reloc;\n-  char r_offset[30], r_info[30];\n \n   /* Use the output BFD for linker created sections.  */\n   if ((asect->flags & SEC_LINKER_CREATED) != 0)\n@@ -1767,26 +1766,17 @@ _bfd_x86_elf_link_report_relative_reloc\n   else\n     name = bfd_elf_sym_name (abfd, &elf_symtab_hdr (abfd), sym, NULL);\n \n-  bfd_sprintf_vma (abfd, r_offset, rel->r_offset);\n-  bfd_sprintf_vma (abfd, r_info, rel->r_info);\n-\n   if (asect->use_rela_p)\n-    {\n-      char r_addend[30];\n-\n-      bfd_sprintf_vma (abfd, r_addend, rel->r_addend);\n-\n-      info->callbacks->einfo\n-\t(_(\"%pB: %s (offset: 0x%s, info: 0x%s, addend: 0x%s) against \"\n-\t   \"'%s' \" \"for section '%pA' in %pB\\n\"),\n-\t info->output_bfd, reloc_name, r_offset, r_info, r_addend,\n-\t name, asect, abfd);\n-    }\n+    info->callbacks->einfo\n+      (_(\"%pB: %s (offset: 0x%v, info: 0x%v, addend: 0x%v) against \"\n+\t \"'%s' \" \"for section '%pA' in %pB\\n\"),\n+       info->output_bfd, reloc_name, rel->r_offset, rel->r_info,\n+       rel->r_addend, name, asect, abfd);\n   else\n     info->callbacks->einfo\n-      (_(\"%pB: %s (offset: 0x%s, info: 0x%s) against '%s' for section \"\n+      (_(\"%pB: %s (offset: 0x%v, info: 0x%v) against '%s' for section \"\n \t \"'%pA' in %pB\\n\"),\n-       info->output_bfd, reloc_name, r_offset, r_info, name,\n+       info->output_bfd, reloc_name, rel->r_offset, rel->r_info, name,\n        asect, abfd);\n }\n "
    },
    {
      "sha": "75e7330708b9647059c11f21caee60f5983aa05b",
      "filename": "ld/testsuite/ld-i386/report-reloc-1.l",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7131d475da0062b2991eecfde76cbff96de289ab/ld/testsuite/ld-i386/report-reloc-1.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7131d475da0062b2991eecfde76cbff96de289ab/ld/testsuite/ld-i386/report-reloc-1.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/report-reloc-1.l?ref=7131d475da0062b2991eecfde76cbff96de289ab",
      "patch": "@@ -1,2 +1,2 @@\n-tmpdir/dump: R_386_IRELATIVE \\(offset: 0x[0-9a-f]+, info: 0x0+2a\\) against 'ifunc' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o\n-tmpdir/dump: R_386_RELATIVE \\(offset: 0x[0-9a-f]+, info: 0x0+8\\) against '_start' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o\n+tmpdir/dump: R_386_IRELATIVE \\(offset: 0x[0-9a-f]+, info: 0x2a\\) against 'ifunc' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o\n+tmpdir/dump: R_386_RELATIVE \\(offset: 0x[0-9a-f]+, info: 0x8\\) against '_start' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o"
    },
    {
      "sha": "35653794e328b0f03cd4490e0553826837b2fc9e",
      "filename": "ld/testsuite/ld-x86-64/report-reloc-1.l",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7131d475da0062b2991eecfde76cbff96de289ab/ld/testsuite/ld-x86-64/report-reloc-1.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7131d475da0062b2991eecfde76cbff96de289ab/ld/testsuite/ld-x86-64/report-reloc-1.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/report-reloc-1.l?ref=7131d475da0062b2991eecfde76cbff96de289ab",
      "patch": "@@ -1,2 +1,2 @@\n-tmpdir/dump: R_X86_64_IRELATIVE \\(offset: 0x[0-9a-f]+, info: 0x0+25, addend: 0x[0-9a-f]+\\) against 'ifunc' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o\n-tmpdir/dump: R_X86_64_RELATIVE \\(offset: 0x[0-9a-f]+, info: 0x0+8, addend: 0x[0-9a-f]+\\) against '_start' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o\n+tmpdir/dump: R_X86_64_IRELATIVE \\(offset: 0x[0-9a-f]+, info: 0x25, addend: 0x[0-9a-f]+\\) against 'ifunc' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o\n+tmpdir/dump: R_X86_64_RELATIVE \\(offset: 0x[0-9a-f]+, info: 0x8, addend: 0x[0-9a-f]+\\) against '_start' for section '.data.rel.ro.local' in tmpdir/report-reloc-1.o"
    }
  ]
}