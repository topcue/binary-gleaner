{
  "sha": "65f82b1972cca3476b3ef6abf1d9923d34f5d4f5",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NjVmODJiMTk3MmNjYTM0NzZiM2VmNmFiZjFkOTkyM2QzNGY1ZDRmNQ==",
  "commit": {
    "author": {
      "name": "Carl Love",
      "email": "cel@us.ibm.com",
      "date": "2021-07-22T18:33:59Z"
    },
    "committer": {
      "name": "Carl Love",
      "email": "cel@us.ibm.com",
      "date": "2021-08-12T18:03:19Z"
    },
    "message": "Improve forward progress test in python.exp\n\nThe test steps into func2 and than does an up to get back to the previous\nframe. The test checks that the line number you are at after the up command\nis greater than the line where the function was called from. The\nassembly/codegen for the powerpc target includes a NOP after the\nbranch-link.\n\nfunc2 (); /* Break at func2 call site. /\n10000694: 59 00 00 48 bl 100006ec\n10000698: 00 00 00 60 nop\nreturn 0; / Break to end. */\n1000069c: 00 00 20 39 li r9,0\n\nThe PC at the instruction following the branch-link is 0x10000698 which\nGDB.find_pc_line() maps to the same line number as the bl instruction.\nGDB did move past the branch-link location thus making forward progress.\n\nThe following proposed fix adds an additional PC check to see if forward\nprogress was made.  The line test is changed from greater than to greater\nthan or equal.",
    "tree": {
      "sha": "c46e5d5196cbd3703058f238b8fb11fbf4d51453",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c46e5d5196cbd3703058f238b8fb11fbf4d51453"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/65f82b1972cca3476b3ef6abf1d9923d34f5d4f5",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/65f82b1972cca3476b3ef6abf1d9923d34f5d4f5",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/65f82b1972cca3476b3ef6abf1d9923d34f5d4f5",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/65f82b1972cca3476b3ef6abf1d9923d34f5d4f5/comments",
  "author": {
    "login": "carlelove",
    "id": 86435705,
    "node_id": "MDQ6VXNlcjg2NDM1NzA1",
    "avatar_url": "https://avatars.githubusercontent.com/u/86435705?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/carlelove",
    "html_url": "https://github.com/carlelove",
    "followers_url": "https://api.github.com/users/carlelove/followers",
    "following_url": "https://api.github.com/users/carlelove/following{/other_user}",
    "gists_url": "https://api.github.com/users/carlelove/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/carlelove/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/carlelove/subscriptions",
    "organizations_url": "https://api.github.com/users/carlelove/orgs",
    "repos_url": "https://api.github.com/users/carlelove/repos",
    "events_url": "https://api.github.com/users/carlelove/events{/privacy}",
    "received_events_url": "https://api.github.com/users/carlelove/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "carlelove",
    "id": 86435705,
    "node_id": "MDQ6VXNlcjg2NDM1NzA1",
    "avatar_url": "https://avatars.githubusercontent.com/u/86435705?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/carlelove",
    "html_url": "https://github.com/carlelove",
    "followers_url": "https://api.github.com/users/carlelove/followers",
    "following_url": "https://api.github.com/users/carlelove/following{/other_user}",
    "gists_url": "https://api.github.com/users/carlelove/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/carlelove/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/carlelove/subscriptions",
    "organizations_url": "https://api.github.com/users/carlelove/orgs",
    "repos_url": "https://api.github.com/users/carlelove/repos",
    "events_url": "https://api.github.com/users/carlelove/events{/privacy}",
    "received_events_url": "https://api.github.com/users/carlelove/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "b2ee4824b177a359c2db590a9978418211435011",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b2ee4824b177a359c2db590a9978418211435011",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/b2ee4824b177a359c2db590a9978418211435011"
    }
  ],
  "stats": {
    "total": 17,
    "additions": 16,
    "deletions": 1
  },
  "files": [
    {
      "sha": "bc670ce25c113566feddd63dc65fa88bbbbf017f",
      "filename": "gdb/testsuite/gdb.python/python.exp",
      "status": "modified",
      "additions": 16,
      "deletions": 1,
      "changes": 17,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/65f82b1972cca3476b3ef6abf1d9923d34f5d4f5/gdb/testsuite/gdb.python/python.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/65f82b1972cca3476b3ef6abf1d9923d34f5d4f5/gdb/testsuite/gdb.python/python.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.python/python.exp?ref=65f82b1972cca3476b3ef6abf1d9923d34f5d4f5",
      "patch": "@@ -496,12 +496,27 @@ if ![runto_main] then {\n runto [gdb_get_line_number \"Break at func2 call site.\"]\n \n gdb_py_test_silent_cmd \"python line = gdb.selected_frame().find_sal().line\" \"Get line number of func2 call site\" 1\n+\n+gdb_py_test_silent_cmd \"python pc_call = gdb.selected_frame().pc()\" \\\n+    \"Get pc of func2 call site\" 1\n+\n gdb_test \"python print (gdb.find_pc_line(gdb.selected_frame().pc()).line == line)\" \"True\" \"test find_pc_line at func2 call site\"\n \n gdb_py_test_silent_cmd \"step\" \"Step into func2\" 1\n gdb_py_test_silent_cmd \"up\" \"Step out of func2\" 1\n \n-gdb_test \"python print (gdb.find_pc_line(gdb.selected_frame().pc()).line > line)\" \"True\" \"test find_pc_line with resume address\"\n+# The point of the following test is to see if gdb has advanced past the\n+# location where the branch to a function was made.\n+set test_name \"test find_pc_line with resume address\"\n+\n+gdb_py_test_silent_cmd \"python pc_rtn = gdb.selected_frame().pc()\" \\\n+    \"Get pc at func2 return site\" 1\n+\n+gdb_test \"python print (pc_rtn > pc_call)\" \"True\" \\\n+    \"test resume address greater then call address\"\n+\n+gdb_test \"python print (gdb.find_pc_line(pc_rtn).line >= line)\" \"True\" \\\n+    \"test find_pc_line with resume address\"\n \n gdb_test_no_output \"set variable \\$cvar1 = 23\" \"set convenience variable\"\n gdb_test \"python print(gdb.convenience_variable('cvar1'))\" \"23\""
    }
  ]
}