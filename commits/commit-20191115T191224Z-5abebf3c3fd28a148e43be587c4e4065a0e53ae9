{
  "sha": "5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NWFiZWJmM2MzZmQyOGExNDhlNDNiZTU4N2M0ZTQwNjVhMGU1M2FlOQ==",
  "commit": {
    "author": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-11-06T18:49:52Z"
    },
    "committer": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-11-15T19:12:24Z"
    },
    "message": "Import the strerror_r-posix module and use it in GDB.\n\nMakes sure to assign the return value of strerror_r to an int,\nso that we get a compile error if we accidentally get the\nwrong version.\n\ngdb/ChangeLog:\n\n2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n\n\t* config.in: Regenerate.\n\t* configure: Regenerate.\n\t* gdbsupport/common.m4: No longer check for strerror_r.\n\t* gdbsupport/posix-strerror.c (safe_strerror): Always call the\n\tPOSIX version of strerror_r, now that gnulib provides it if\n\tnecessary.\n\ngdb/gdbserver/ChangeLog:\n\n2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n\n\t* config.in: Regenerate.\n\t* configure: Regenerate.\n\ngnulib/ChangeLog:\n\n2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n\n\t* Makefile.in: Regenerate.\n\t* aclocal.m4: Regenerate.\n\t* config.in: Regenerate.\n\t* configure: Regenerate.\n\t* import/Makefile.am: Update.\n\t* import/Makefile.in: Regenerate.\n\t* import/extra/config.rpath: New file.\n\t* import/glthread/lock.c: New file.\n\t* import/glthread/lock.h: New file.\n\t* import/glthread/threadlib.c: New file.\n\t* import/m4/gnulib-cache.m4: Update.\n\t* import/m4/gnulib-comp.m4: Update.\n\t* import/m4/lib-ld.m4: New file.\n\t* import/m4/lib-link.m4: New file.\n\t* import/m4/lib-prefix.m4: New file.\n\t* import/m4/lock.m4: New file.\n\t* import/m4/strerror_r.m4: New file.\n\t* import/m4/threadlib.m4: New file.\n\t* import/strerror_r.c: New file.\n\t* update-gnulib.sh: Import strerror_r-posix.\n\nChange-Id: I5cfeb12a5203a4cd94a78581541e6085a68685c3",
    "tree": {
      "sha": "4a8def2e81bc2676d63f9a0247700f82a097eb92",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/4a8def2e81bc2676d63f9a0247700f82a097eb92"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/comments",
  "author": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "33bd0102c190c1331804c12774e578e33c367552",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/33bd0102c190c1331804c12774e578e33c367552",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/33bd0102c190c1331804c12774e578e33c367552"
    }
  ],
  "stats": {
    "total": 6882,
    "additions": 6691,
    "deletions": 191
  },
  "files": [
    {
      "sha": "0f92504269d4265252faf09a0a03675b7bab634a",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -1,3 +1,12 @@\n+2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n+\n+\t* config.in: Regenerate.\n+\t* configure: Regenerate.\n+\t* gdbsupport/common.m4: No longer check for strerror_r.\n+\t* gdbsupport/posix-strerror.c (safe_strerror): Always call the\n+\tPOSIX version of strerror_r, now that gnulib provides it if\n+\tnecessary.\n+\n 2019-11-14  Christian Biesinger  <cbiesinger@google.com>\n \n \t* README (`configure' options): Update."
    },
    {
      "sha": "fc05f154b7263e8a5027cbf7e7fb33a13a9055fd",
      "filename": "gdb/config.in",
      "status": "modified",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/config.in?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -423,9 +423,6 @@\n /* Define to 1 if you have the <stdlib.h> header file. */\n #undef HAVE_STDLIB_H\n \n-/* Define to 1 if you have the `strerror_r' function. */\n-#undef HAVE_STRERROR_R\n-\n /* Define to 1 if you have the <strings.h> header file. */\n #undef HAVE_STRINGS_H\n "
    },
    {
      "sha": "e8059039bd50011fda23ca60f1e467766a336fb5",
      "filename": "gdb/configure",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -13480,7 +13480,7 @@ done\n \n \n   for ac_func in fdwalk getrlimit pipe pipe2 socketpair sigaction \\\n-\t\t  sigprocmask strerror_r\n+\t\t  sigprocmask\n do :\n   as_ac_var=`$as_echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n ac_fn_c_check_func \"$LINENO\" \"$ac_func\" \"$as_ac_var\""
    },
    {
      "sha": "0f0fc0384dda17f49b20cce9585f9981297ce0a6",
      "filename": "gdb/gdbserver/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbserver/ChangeLog?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -1,3 +1,8 @@\n+2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n+\n+\t* config.in: Regenerate.\n+\t* configure: Regenerate.\n+\n 2019-11-12  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* ax.c (ax_printf): Handle size_t_arg."
    },
    {
      "sha": "0bce18d2a0e181b9e8d6fd7ef0b1cfe501ac9c8e",
      "filename": "gdb/gdbserver/config.in",
      "status": "modified",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbserver/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbserver/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbserver/config.in?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -229,9 +229,6 @@\n /* Define to 1 if you have the <stdlib.h> header file. */\n #undef HAVE_STDLIB_H\n \n-/* Define to 1 if you have the `strerror_r' function. */\n-#undef HAVE_STRERROR_R\n-\n /* Define to 1 if you have the <strings.h> header file. */\n #undef HAVE_STRINGS_H\n "
    },
    {
      "sha": "e513fc5eb10a2eef0eb139dbfb0b090ed4badf54",
      "filename": "gdb/gdbserver/configure",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbserver/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbserver/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbserver/configure?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -6822,7 +6822,7 @@ done\n \n \n   for ac_func in fdwalk getrlimit pipe pipe2 socketpair sigaction \\\n-\t\t  sigprocmask strerror_r\n+\t\t  sigprocmask\n do :\n   as_ac_var=`$as_echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n ac_fn_c_check_func \"$LINENO\" \"$ac_func\" \"$as_ac_var\""
    },
    {
      "sha": "471d7056f74fb003c70366df612cb4be279bba6f",
      "filename": "gdb/gdbsupport/common.m4",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbsupport/common.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbsupport/common.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbsupport/common.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -33,7 +33,7 @@ AC_DEFUN([GDB_AC_COMMON], [\n \t\t   dlfcn.h)\n \n   AC_CHECK_FUNCS([fdwalk getrlimit pipe pipe2 socketpair sigaction \\\n-\t\t  sigprocmask strerror_r])\n+\t\t  sigprocmask])\n \n   AC_CHECK_DECLS([strerror, strstr])\n "
    },
    {
      "sha": "107813fa3fdd05464864df48ce3b4334405b913a",
      "filename": "gdb/gdbsupport/posix-strerror.c",
      "status": "modified",
      "additions": 9,
      "deletions": 19,
      "changes": 28,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbsupport/posix-strerror.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gdb/gdbsupport/posix-strerror.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbsupport/posix-strerror.c?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -18,6 +18,7 @@\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n \n #include \"common-defs.h\"\n+#include <string.h>\n \n /* Implementation of safe_strerror as defined in common-utils.h.  */\n \n@@ -26,23 +27,12 @@ safe_strerror (int errnum)\n {\n   static thread_local char buf[1024];\n \n-  char *msg = nullptr;\n-#ifdef HAVE_STRERROR_R\n-#  if !__GLIBC__ || ((_POSIX_C_SOURCE >= 200112L) && !  _GNU_SOURCE)\n-  /* Glibc has two different, incompatible versions of strerror_r.  */\n-  if (strerror_r (errnum, buf, sizeof (buf)) == 0)\n-    msg = buf;\n-#  else\n-  msg = strerror_r (errnum, buf, sizeof (buf));\n-#  endif\n-#else\n-  msg = strerror (errnum);\n-#endif\n-  if (msg == nullptr)\n-    {\n-\n-      xsnprintf (buf, sizeof buf, \"(undocumented errno %d)\", errnum);\n-      msg = buf;\n-    }\n-  return (msg);\n+  /* Assign the return value to an int, so we get an error if we accidentally\n+     get the wrong version of this function (glibc has two of them...).  */\n+  int ret = strerror_r (errnum, buf, sizeof (buf));\n+  if (ret == 0)\n+    return buf;\n+\n+  xsnprintf (buf, sizeof buf, \"(undocumented errno %d)\", errnum);\n+  return buf;\n }"
    },
    {
      "sha": "b1acb4c1158fe81766c85220c8d2c859b67a6750",
      "filename": "gnulib/ChangeLog",
      "status": "modified",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/ChangeLog?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -1,3 +1,26 @@\n+2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n+\n+\t* Makefile.in: Regenerate.\n+\t* aclocal.m4: Regenerate.\n+\t* config.in: Regenerate.\n+\t* configure: Regenerate.\n+\t* import/Makefile.am: Update.\n+\t* import/Makefile.in: Regenerate.\n+\t* import/extra/config.rpath: New file.\n+\t* import/glthread/lock.c: New file.\n+\t* import/glthread/lock.h: New file.\n+\t* import/glthread/threadlib.c: New file.\n+\t* import/m4/gnulib-cache.m4: Update.\n+\t* import/m4/gnulib-comp.m4: Update.\n+\t* import/m4/lib-ld.m4: New file.\n+\t* import/m4/lib-link.m4: New file.\n+\t* import/m4/lib-prefix.m4: New file.\n+\t* import/m4/lock.m4: New file.\n+\t* import/m4/strerror_r.m4: New file.\n+\t* import/m4/threadlib.m4: New file.\n+\t* import/strerror_r.c: New file.\n+\t* update-gnulib.sh: Import strerror_r-posix.\n+\n 2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n \n \t* Makefile.am: New file."
    },
    {
      "sha": "037997261e2807856af1e45c42b75612a8d83bb2",
      "filename": "gnulib/Makefile.in",
      "status": "modified",
      "additions": 20,
      "deletions": 7,
      "changes": 27,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/Makefile.in?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -169,11 +169,15 @@ am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \\\n \t$(top_srcdir)/import/m4/isnand.m4 \\\n \t$(top_srcdir)/import/m4/isnanl.m4 \\\n \t$(top_srcdir)/import/m4/largefile.m4 \\\n+\t$(top_srcdir)/import/m4/lib-ld.m4 \\\n+\t$(top_srcdir)/import/m4/lib-link.m4 \\\n+\t$(top_srcdir)/import/m4/lib-prefix.m4 \\\n \t$(top_srcdir)/import/m4/limits-h.m4 \\\n \t$(top_srcdir)/import/m4/localcharset.m4 \\\n \t$(top_srcdir)/import/m4/locale-fr.m4 \\\n \t$(top_srcdir)/import/m4/locale-ja.m4 \\\n \t$(top_srcdir)/import/m4/locale-zh.m4 \\\n+\t$(top_srcdir)/import/m4/lock.m4 \\\n \t$(top_srcdir)/import/m4/longlong.m4 \\\n \t$(top_srcdir)/import/m4/lstat.m4 \\\n \t$(top_srcdir)/import/m4/malloc.m4 \\\n@@ -227,6 +231,7 @@ am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \\\n \t$(top_srcdir)/import/m4/strchrnul.m4 \\\n \t$(top_srcdir)/import/m4/strdup.m4 \\\n \t$(top_srcdir)/import/m4/strerror.m4 \\\n+\t$(top_srcdir)/import/m4/strerror_r.m4 \\\n \t$(top_srcdir)/import/m4/string_h.m4 \\\n \t$(top_srcdir)/import/m4/strstr.m4 \\\n \t$(top_srcdir)/import/m4/strtok_r.m4 \\\n@@ -236,6 +241,7 @@ am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \\\n \t$(top_srcdir)/import/m4/sys_types_h.m4 \\\n \t$(top_srcdir)/import/m4/sys_uio_h.m4 \\\n \t$(top_srcdir)/import/m4/tempname.m4 \\\n+\t$(top_srcdir)/import/m4/threadlib.m4 \\\n \t$(top_srcdir)/import/m4/time_h.m4 \\\n \t$(top_srcdir)/import/m4/unistd-safer.m4 \\\n \t$(top_srcdir)/import/m4/unistd_h.m4 \\\n@@ -313,13 +319,13 @@ CSCOPE = cscope\n DIST_SUBDIRS = $(SUBDIRS)\n am__DIST_COMMON = $(srcdir)/Makefile.in $(srcdir)/config.in \\\n \t$(top_srcdir)/../ar-lib $(top_srcdir)/../compile \\\n-\t$(top_srcdir)/../config.guess $(top_srcdir)/../config.sub \\\n-\t$(top_srcdir)/../install-sh $(top_srcdir)/../missing \\\n-\t$(top_srcdir)/../mkinstalldirs ../COPYING ../COPYING.LIB \\\n-\t../ChangeLog ../README ../ar-lib ../compile ../config.guess \\\n-\t../config.rpath ../config.sub ../depcomp ../install-sh \\\n-\t../ltmain.sh ../missing ../mkinstalldirs ../ylwrap ChangeLog \\\n-\tREADME\n+\t$(top_srcdir)/../config.guess $(top_srcdir)/../config.rpath \\\n+\t$(top_srcdir)/../config.sub $(top_srcdir)/../install-sh \\\n+\t$(top_srcdir)/../missing $(top_srcdir)/../mkinstalldirs \\\n+\t../COPYING ../COPYING.LIB ../ChangeLog ../README ../ar-lib \\\n+\t../compile ../config.guess ../config.rpath ../config.sub \\\n+\t../depcomp ../install-sh ../ltmain.sh ../missing \\\n+\t../mkinstalldirs ../ylwrap ChangeLog README\n DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)\n distdir = $(PACKAGE)-$(VERSION)\n top_distdir = $(distdir)\n@@ -1115,8 +1121,12 @@ LDFLAGS = @LDFLAGS@\n LIBGNU_LIBDEPS = @LIBGNU_LIBDEPS@\n LIBGNU_LTLIBDEPS = @LIBGNU_LTLIBDEPS@\n LIBINTL = @LIBINTL@\n+LIBMULTITHREAD = @LIBMULTITHREAD@\n LIBOBJS = @LIBOBJS@\n+LIBPTH = @LIBPTH@\n+LIBPTH_PREFIX = @LIBPTH_PREFIX@\n LIBS = @LIBS@\n+LIBTHREAD = @LIBTHREAD@\n LIMITS_H = @LIMITS_H@\n LN_S = @LN_S@\n LOCALCHARSET_TESTS_ENVIRONMENT = @LOCALCHARSET_TESTS_ENVIRONMENT@\n@@ -1125,7 +1135,10 @@ LOCALE_FR_UTF8 = @LOCALE_FR_UTF8@\n LOCALE_JA = @LOCALE_JA@\n LOCALE_ZH_CN = @LOCALE_ZH_CN@\n LTLIBINTL = @LTLIBINTL@\n+LTLIBMULTITHREAD = @LTLIBMULTITHREAD@\n LTLIBOBJS = @LTLIBOBJS@\n+LTLIBPTH = @LTLIBPTH@\n+LTLIBTHREAD = @LTLIBTHREAD@\n MAINT = @MAINT@\n MAKEINFO = @MAKEINFO@\n MKDIR_P = @MKDIR_P@"
    },
    {
      "sha": "34580d8e6c4d0c524334bc0f0a9f14aacaada3e1",
      "filename": "gnulib/aclocal.m4",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/aclocal.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/aclocal.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/aclocal.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -1774,11 +1774,15 @@ m4_include([import/m4/inttypes.m4])\n m4_include([import/m4/isnand.m4])\n m4_include([import/m4/isnanl.m4])\n m4_include([import/m4/largefile.m4])\n+m4_include([import/m4/lib-ld.m4])\n+m4_include([import/m4/lib-link.m4])\n+m4_include([import/m4/lib-prefix.m4])\n m4_include([import/m4/limits-h.m4])\n m4_include([import/m4/localcharset.m4])\n m4_include([import/m4/locale-fr.m4])\n m4_include([import/m4/locale-ja.m4])\n m4_include([import/m4/locale-zh.m4])\n+m4_include([import/m4/lock.m4])\n m4_include([import/m4/longlong.m4])\n m4_include([import/m4/lstat.m4])\n m4_include([import/m4/malloc.m4])\n@@ -1832,6 +1836,7 @@ m4_include([import/m4/stdlib_h.m4])\n m4_include([import/m4/strchrnul.m4])\n m4_include([import/m4/strdup.m4])\n m4_include([import/m4/strerror.m4])\n+m4_include([import/m4/strerror_r.m4])\n m4_include([import/m4/string_h.m4])\n m4_include([import/m4/strstr.m4])\n m4_include([import/m4/strtok_r.m4])\n@@ -1841,6 +1846,7 @@ m4_include([import/m4/sys_time_h.m4])\n m4_include([import/m4/sys_types_h.m4])\n m4_include([import/m4/sys_uio_h.m4])\n m4_include([import/m4/tempname.m4])\n+m4_include([import/m4/threadlib.m4])\n m4_include([import/m4/time_h.m4])\n m4_include([import/m4/unistd-safer.m4])\n m4_include([import/m4/unistd_h.m4])"
    },
    {
      "sha": "727fb4f867bfe598207d4e9f5671feb4b3905854",
      "filename": "gnulib/config.in",
      "status": "modified",
      "additions": 56,
      "deletions": 4,
      "changes": 60,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/config.in?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -95,6 +95,10 @@\n    whether the gnulib module getcwd shall be considered present. */\n #undef GNULIB_GETCWD\n \n+/* Define to a C preprocessor expression that evaluates to 1 or 0, depending\n+   whether the gnulib module lock shall be considered present. */\n+#undef GNULIB_LOCK\n+\n /* Define to a C preprocessor expression that evaluates to 1 or 0, depending\n    whether the gnulib module mkostemp shall be considered present. */\n #undef GNULIB_MKOSTEMP\n@@ -260,6 +264,9 @@\n /* Define to 1 when the gnulib module strerror should be tested. */\n #undef GNULIB_TEST_STRERROR\n \n+/* Define to 1 when the gnulib module strerror_r should be tested. */\n+#undef GNULIB_TEST_STRERROR_R\n+\n /* Define to 1 when the gnulib module strstr should be tested. */\n #undef GNULIB_TEST_STRSTR\n \n@@ -289,6 +296,9 @@\n /* Define to 1 if you have the 'canonicalize_file_name' function. */\n #undef HAVE_CANONICALIZE_FILE_NAME\n \n+/* Define to 1 if you have the 'catgets' function. */\n+#undef HAVE_CATGETS\n+\n /* Define to 1 if you have the `closedir' function. */\n #undef HAVE_CLOSEDIR\n \n@@ -372,10 +382,13 @@\n    */\n #undef HAVE_DECL_STRDUP\n \n-/* Define to 1 if you have the declaration of `strerror_r', and to 0 if you\n-   don't. */\n+/* Define to 1, since you should have the declaration of strerror_r. */\n #undef HAVE_DECL_STRERROR_R\n \n+/* Define to 1 if you have the declaration of 'strerror_r' in the system\n+   include files, or to 0 otherwise. */\n+#undef HAVE_DECL_STRERROR_R_ORIG\n+\n /* Define to 1 if you have the declaration of `strtok_r', and to 0 if you\n    don't. */\n #undef HAVE_DECL_STRTOK_R\n@@ -586,6 +599,12 @@\n /* Define to 1 if you have the 'pipe' function. */\n #undef HAVE_PIPE\n \n+/* Define if the <pthread.h> defines PTHREAD_MUTEX_RECURSIVE. */\n+#undef HAVE_PTHREAD_MUTEX_RECURSIVE\n+\n+/* Define if the POSIX multithreading library has read/write locks. */\n+#undef HAVE_PTHREAD_RWLOCK\n+\n /* Define to 1 if you have the `rawmemchr' function. */\n #undef HAVE_RAWMEMCHR\n \n@@ -1511,6 +1530,9 @@\n /* Define to 1 if the system has the type `sigset_t'. */\n #undef HAVE_SIGSET_T\n \n+/* Define to 1 if you have the 'snprintf' function. */\n+#undef HAVE_SNPRINTF\n+\n /* Define to 1 if you have the <stdint.h> header file. */\n #undef HAVE_STDINT_H\n \n@@ -1523,7 +1545,7 @@\n /* Define to 1 if you have the 'strdup' function. */\n #undef HAVE_STRDUP\n \n-/* Define to 1 if you have the `strerror_r' function. */\n+/* Define to 1, since you should have the function strerror_r. */\n #undef HAVE_STRERROR_R\n \n /* Define to 1 if you have the <strings.h> header file. */\n@@ -1651,6 +1673,9 @@\n /* Define to 1 if you have the `__secure_getenv' function. */\n #undef HAVE___SECURE_GETENV\n \n+/* Define to 1 if you have the '__xpg_strerror_r' function. */\n+#undef HAVE___XPG_STRERROR_R\n+\n /* Define as the bit index in the word where to find bit 0 of the exponent of\n    'long double'. */\n #undef LDBL_EXPBIT0_BIT\n@@ -1718,6 +1743,9 @@\n    type mode_t. */\n #undef PROMOTED_MODE_T\n \n+/* Define if the pthread_in_use() detection is hard. */\n+#undef PTHREAD_IN_USE_DETECTION_HARD\n+\n /* Define to l, ll, u, ul, ull, etc., as suitable for constants of type\n    'ptrdiff_t'. */\n #undef PTRDIFF_T_SUFFIX\n@@ -1784,9 +1812,30 @@\n /* Define to 1 if you have the ANSI C header files. */\n #undef STDC_HEADERS\n \n-/* Define to 1 if strerror_r returns char *. */\n+/* Define to 0, since strerror_r should not return char *. */\n #undef STRERROR_R_CHAR_P\n \n+/* Define if the POSIX multithreading library can be used. */\n+#undef USE_POSIX_THREADS\n+\n+/* Define if references to the POSIX multithreading library should be made\n+   weak. */\n+#undef USE_POSIX_THREADS_WEAK\n+\n+/* Define if the GNU Pth multithreading library can be used. */\n+#undef USE_PTH_THREADS\n+\n+/* Define if references to the GNU Pth multithreading library should be made\n+   weak. */\n+#undef USE_PTH_THREADS_WEAK\n+\n+/* Define if the old Solaris multithreading library can be used. */\n+#undef USE_SOLARIS_THREADS\n+\n+/* Define if references to the old Solaris multithreading library should be\n+   made weak. */\n+#undef USE_SOLARIS_THREADS_WEAK\n+\n /* Enable extensions on AIX 3, Interix.  */\n #ifndef _ALL_SOURCE\n # undef _ALL_SOURCE\n@@ -1847,6 +1896,9 @@\n #endif\n \n \n+/* Define if the native Windows multithreading API can be used. */\n+#undef USE_WINDOWS_THREADS\n+\n /* Define to 1 if unsetenv returns void instead of int. */\n #undef VOID_UNSETENV\n "
    },
    {
      "sha": "9749a498546dc2102de9035ab2cb7391b6a061d9",
      "filename": "gnulib/configure",
      "status": "modified",
      "additions": 1607,
      "deletions": 112,
      "changes": 1719,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/configure?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -619,6 +619,7 @@ ac_includes_default=\"\\\n # include <unistd.h>\n #endif\"\n \n+gl_use_threads_default=\n gl_header_list=\n gl_func_list=\n gl_fnmatch_required=POSIX\n@@ -1035,6 +1036,13 @@ GNULIB_WCTOB\n GNULIB_BTOWC\n NEXT_AS_FIRST_DIRECTIVE_MATH_H\n NEXT_MATH_H\n+LTLIBMULTITHREAD\n+LIBMULTITHREAD\n+LTLIBTHREAD\n+LIBTHREAD\n+LIBPTH_PREFIX\n+LTLIBPTH\n+LIBPTH\n LOCALCHARSET_TESTS_ENVIRONMENT\n GLIBC21\n NEXT_AS_FIRST_DIRECTIVE_INTTYPES_H\n@@ -1775,7 +1783,11 @@ ac_user_opts='\n enable_option_checking\n enable_maintainer_mode\n enable_largefile\n+enable_threads\n enable_plugins\n+with_gnu_ld\n+enable_rpath\n+with_libpth_prefix\n enable_dependency_tracking\n enable_silent_rules\n '\n@@ -2411,14 +2423,25 @@ Optional Features:\n                           enable make rules and dependencies not useful (and\n                           sometimes confusing) to the casual installer\n   --disable-largefile     omit support for large files\n+  --enable-threads={posix|solaris|pth|windows}\n+                          specify multithreading API\n+  --disable-threads       build without multithread safety\n   --enable-plugins        Enable support for plugins\n+  --disable-rpath         do not hardcode runtime library paths\n   --enable-dependency-tracking\n                           do not reject slow dependency extractors\n   --disable-dependency-tracking\n                           speeds up one-time build\n   --enable-silent-rules   less verbose build output (undo: \"make V=1\")\n   --disable-silent-rules  verbose build output (undo: \"make V=0\")\n \n+Optional Packages:\n+  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]\n+  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)\n+  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]\n+  --with-libpth-prefix[=DIR]  search for libpth in DIR/include and DIR/lib\n+  --without-libpth-prefix     don't search for libpth in includedir and libdir\n+\n Some influential environment variables:\n   CC          C compiler command\n   CFLAGS      C compiler flags\n@@ -3537,6 +3560,9 @@ gl_func_list=\"$gl_func_list getgid\"\n gl_func_list=\"$gl_func_list getegid\"\n gl_func_list=\"$gl_func_list setenv\"\n gl_func_list=\"$gl_func_list strdup\"\n+gl_func_list=\"$gl_func_list __xpg_strerror_r\"\n+gl_func_list=\"$gl_func_list catgets\"\n+gl_func_list=\"$gl_func_list snprintf\"\n gl_header_list=\"$gl_header_list sys/uio.h\"\n gl_func_list=\"$gl_func_list pipe\"\n gl_func_list=\"$gl_func_list iswcntrl\"\n@@ -3615,6 +3641,8 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu\n ac_config_headers=\"$ac_config_headers config.h:config.in\"\n \n \n+\n+\n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n $as_echo_n \"checking whether to enable maintainer-specific portions of Makefiles... \" >&6; }\n     # Check whether --enable-maintainer-mode was given.\n@@ -5459,6 +5487,7 @@ fi\n   fi\n \n \n+\n # Make sure we can run config.sub.\n $SHELL \"$ac_aux_dir/config.sub\" sun4 >/dev/null 2>&1 ||\n   as_fn_error $? \"cannot run $SHELL $ac_aux_dir/config.sub\" \"$LINENO\" 5\n@@ -5763,10 +5792,59 @@ fi\n \n \n \n+\n+\n+\n+  # Check whether --enable-threads was given.\n+if test \"${enable_threads+set}\" = set; then :\n+  enableval=$enable_threads; gl_use_threads=$enableval\n+else\n+  if test -n \"$gl_use_threads_default\"; then\n+       gl_use_threads=\"$gl_use_threads_default\"\n+     else\n+       case \"$host_os\" in\n+                                                               osf*) gl_use_threads=no ;;\n+         cygwin*)\n+               case `uname -r` in\n+                 1.[0-5].*) gl_use_threads=no ;;\n+                 *)         gl_use_threads=yes ;;\n+               esac\n+               ;;\n+         *)    gl_use_threads=yes ;;\n+       esac\n+     fi\n+\n+fi\n+\n+  if test \"$gl_use_threads\" = yes || test \"$gl_use_threads\" = posix; then\n+    # For using <pthread.h>:\n+    case \"$host_os\" in\n+      osf*)\n+        # On OSF/1, the compiler needs the flag -D_REENTRANT so that it\n+        # groks <pthread.h>. cc also understands the flag -pthread, but\n+        # we don't use it because 1. gcc-2.95 doesn't understand -pthread,\n+        # 2. putting a flag into CPPFLAGS that has an effect on the linker\n+        # causes the AC_LINK_IFELSE test below to succeed unexpectedly,\n+        # leading to wrong values of LIBTHREAD and LTLIBTHREAD.\n+        CPPFLAGS=\"$CPPFLAGS -D_REENTRANT\"\n+        ;;\n+    esac\n+    # Some systems optimize for single-threaded programs by default, and\n+    # need special flags to disable these optimizations. For example, the\n+    # definition of 'errno' in <errno.h>.\n+    case \"$host_os\" in\n+      aix* | freebsd*) CPPFLAGS=\"$CPPFLAGS -D_THREAD_SAFE\" ;;\n+      solaris*) CPPFLAGS=\"$CPPFLAGS -D_REENTRANT\" ;;\n+    esac\n+  fi\n+\n+\n+\n   # Pre-early section.\n \n \n \n+\n   # Code from module absolute-header:\n   # Code from module alloca:\n   # Code from module alloca-opt:\n@@ -5822,6 +5900,7 @@ fi\n   # Code from module gettimeofday:\n   # Code from module glob:\n   # Code from module hard-locale:\n+  # Code from module havelib:\n   # Code from module include_next:\n   # Code from module inet_ntop:\n   # Code from module intprops:\n@@ -5833,6 +5912,7 @@ fi\n \n   # Code from module limits-h:\n   # Code from module localcharset:\n+  # Code from module lock:\n   # Code from module lstat:\n   # Code from module malloc-posix:\n   # Code from module malloca:\n@@ -5889,6 +5969,7 @@ fi\n   # Code from module streq:\n   # Code from module strerror:\n   # Code from module strerror-override:\n+  # Code from module strerror_r-posix:\n   # Code from module string:\n   # Code from module strnlen1:\n   # Code from module strstr:\n@@ -5900,6 +5981,10 @@ fi\n   # Code from module sys_types:\n   # Code from module sys_uio:\n   # Code from module tempname:\n+  # Code from module threadlib:\n+\n+\n+\n   # Code from module time:\n   # Code from module unistd:\n   # Code from module unistd-safer:\n@@ -8351,97 +8436,16 @@ $as_echo \"$gl_cv_header_errno_h_EOVERFLOW\" >&6; }\n   fi\n \n \n-ac_fn_c_check_decl \"$LINENO\" \"strerror_r\" \"ac_cv_have_decl_strerror_r\" \"$ac_includes_default\"\n-if test \"x$ac_cv_have_decl_strerror_r\" = xyes; then :\n-  ac_have_decl=1\n-else\n-  ac_have_decl=0\n-fi\n-\n-cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_STRERROR_R $ac_have_decl\n-_ACEOF\n-\n-for ac_func in strerror_r\n-do :\n-  ac_fn_c_check_func \"$LINENO\" \"strerror_r\" \"ac_cv_func_strerror_r\"\n-if test \"x$ac_cv_func_strerror_r\" = xyes; then :\n-  cat >>confdefs.h <<_ACEOF\n-#define HAVE_STRERROR_R 1\n-_ACEOF\n-\n-fi\n-done\n-\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether strerror_r returns char *\" >&5\n-$as_echo_n \"checking whether strerror_r returns char *... \" >&6; }\n-if ${ac_cv_func_strerror_r_char_p+:} false; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n \n-    ac_cv_func_strerror_r_char_p=no\n-    if test $ac_cv_have_decl_strerror_r = yes; then\n-      cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-$ac_includes_default\n-int\n-main ()\n-{\n \n-\t  char buf[100];\n-\t  char x = *strerror_r (0, buf, sizeof buf);\n-\t  char *p = strerror_r (0, buf, sizeof buf);\n-\t  return !p || x;\n+$as_echo \"#define HAVE_DECL_STRERROR_R 1\" >>confdefs.h\n \n-  ;\n-  return 0;\n-}\n-_ACEOF\n-if ac_fn_c_try_compile \"$LINENO\"; then :\n-  ac_cv_func_strerror_r_char_p=yes\n-fi\n-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n-    else\n-      # strerror_r is not declared.  Choose between\n-      # systems that have relatively inaccessible declarations for the\n-      # function.  BeOS and DEC UNIX 4.0 fall in this category, but the\n-      # former has a strerror_r that returns char*, while the latter\n-      # has a strerror_r that returns `int'.\n-      # This test should segfault on the DEC system.\n-      if test \"$cross_compiling\" = yes; then :\n-  :\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-$ac_includes_default\n-\textern char *strerror_r ();\n-int\n-main ()\n-{\n-char buf[100];\n-\t  char x = *strerror_r (0, buf, sizeof buf);\n-\t  return ! isalpha (x);\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-if ac_fn_c_try_run \"$LINENO\"; then :\n-  ac_cv_func_strerror_r_char_p=yes\n-fi\n-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n-  conftest.$ac_objext conftest.beam conftest.$ac_ext\n-fi\n \n-    fi\n+$as_echo \"#define HAVE_STRERROR_R 1\" >>confdefs.h\n \n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_strerror_r_char_p\" >&5\n-$as_echo \"$ac_cv_func_strerror_r_char_p\" >&6; }\n-if test $ac_cv_func_strerror_r_char_p = yes; then\n \n-$as_echo \"#define STRERROR_R_CHAR_P 1\" >>confdefs.h\n+$as_echo \"#define STRERROR_R_CHAR_P 0\" >>confdefs.h\n \n-fi\n \n \n   XGETTEXT_EXTRA_OPTIONS=\n@@ -12467,40 +12471,1193 @@ _ACEOF\n \n \n \n-    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C Library >= 2.1 or uClibc\" >&5\n-$as_echo_n \"checking whether we are using the GNU C Library >= 2.1 or uClibc... \" >&6; }\n-if ${ac_cv_gnu_library_2_1+:} false; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C Library >= 2.1 or uClibc\" >&5\n+$as_echo_n \"checking whether we are using the GNU C Library >= 2.1 or uClibc... \" >&6; }\n+if ${ac_cv_gnu_library_2_1+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#include <features.h>\n+#ifdef __GNU_LIBRARY__\n+ #if (__GLIBC__ == 2 && __GLIBC_MINOR__ >= 1) || (__GLIBC__ > 2)\n+  Lucky GNU user\n+ #endif\n+#endif\n+#ifdef __UCLIBC__\n+ Lucky user\n+#endif\n+\n+_ACEOF\n+if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n+  $EGREP \"Lucky\" >/dev/null 2>&1; then :\n+  ac_cv_gnu_library_2_1=yes\n+else\n+  ac_cv_gnu_library_2_1=no\n+fi\n+rm -f conftest*\n+\n+\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_gnu_library_2_1\" >&5\n+$as_echo \"$ac_cv_gnu_library_2_1\" >&6; }\n+\n+    GLIBC21=\"$ac_cv_gnu_library_2_1\"\n+\n+\n+\n+      if test \"X$prefix\" = \"XNONE\"; then\n+    acl_final_prefix=\"$ac_default_prefix\"\n+  else\n+    acl_final_prefix=\"$prefix\"\n+  fi\n+  if test \"X$exec_prefix\" = \"XNONE\"; then\n+    acl_final_exec_prefix='${prefix}'\n+  else\n+    acl_final_exec_prefix=\"$exec_prefix\"\n+  fi\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  eval acl_final_exec_prefix=\\\"$acl_final_exec_prefix\\\"\n+  prefix=\"$acl_save_prefix\"\n+\n+\n+\n+# Check whether --with-gnu-ld was given.\n+if test \"${with_gnu_ld+set}\" = set; then :\n+  withval=$with_gnu_ld; test \"$withval\" = no || with_gnu_ld=yes\n+else\n+  with_gnu_ld=no\n+fi\n+\n+# Prepare PATH_SEPARATOR.\n+# The user is always right.\n+if test \"${PATH_SEPARATOR+set}\" != set; then\n+  # Determine PATH_SEPARATOR by trying to find /bin/sh in a PATH which\n+  # contains only /bin. Note that ksh looks also at the FPATH variable,\n+  # so we have to set that as well for the test.\n+  PATH_SEPARATOR=:\n+  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 \\\n+    && { (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 \\\n+           || PATH_SEPARATOR=';'\n+       }\n+fi\n+\n+ac_prog=ld\n+if test \"$GCC\" = yes; then\n+  # Check if gcc -print-prog-name=ld gives a path.\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for ld used by $CC\" >&5\n+$as_echo_n \"checking for ld used by $CC... \" >&6; }\n+  case $host in\n+  *-*-mingw*)\n+    # gcc leaves a trailing carriage return which upsets mingw\n+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\\015'` ;;\n+  *)\n+    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;\n+  esac\n+  case $ac_prog in\n+    # Accept absolute paths.\n+    [\\\\/]* | ?:[\\\\/]*)\n+      re_direlt='/[^/][^/]*/\\.\\./'\n+      # Canonicalize the pathname of ld\n+      ac_prog=`echo \"$ac_prog\"| sed 's%\\\\\\\\%/%g'`\n+      while echo \"$ac_prog\" | grep \"$re_direlt\" > /dev/null 2>&1; do\n+        ac_prog=`echo $ac_prog| sed \"s%$re_direlt%/%\"`\n+      done\n+      test -z \"$LD\" && LD=\"$ac_prog\"\n+      ;;\n+  \"\")\n+    # If it fails, then pretend we aren't using GCC.\n+    ac_prog=ld\n+    ;;\n+  *)\n+    # If it is relative, then search for the first ld in PATH.\n+    with_gnu_ld=unknown\n+    ;;\n+  esac\n+elif test \"$with_gnu_ld\" = yes; then\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for GNU ld\" >&5\n+$as_echo_n \"checking for GNU ld... \" >&6; }\n+else\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for non-GNU ld\" >&5\n+$as_echo_n \"checking for non-GNU ld... \" >&6; }\n+fi\n+if ${acl_cv_path_LD+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  if test -z \"$LD\"; then\n+  acl_save_ifs=\"$IFS\"; IFS=$PATH_SEPARATOR\n+  for ac_dir in $PATH; do\n+    IFS=\"$acl_save_ifs\"\n+    test -z \"$ac_dir\" && ac_dir=.\n+    if test -f \"$ac_dir/$ac_prog\" || test -f \"$ac_dir/$ac_prog$ac_exeext\"; then\n+      acl_cv_path_LD=\"$ac_dir/$ac_prog\"\n+      # Check to see if the program is GNU ld.  I'd rather use --version,\n+      # but apparently some variants of GNU ld only accept -v.\n+      # Break only if it was the GNU/non-GNU ld that we prefer.\n+      case `\"$acl_cv_path_LD\" -v 2>&1 </dev/null` in\n+      *GNU* | *'with BFD'*)\n+        test \"$with_gnu_ld\" != no && break\n+        ;;\n+      *)\n+        test \"$with_gnu_ld\" != yes && break\n+        ;;\n+      esac\n+    fi\n+  done\n+  IFS=\"$acl_save_ifs\"\n+else\n+  acl_cv_path_LD=\"$LD\" # Let the user override the test with a path.\n+fi\n+fi\n+\n+LD=\"$acl_cv_path_LD\"\n+if test -n \"$LD\"; then\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $LD\" >&5\n+$as_echo \"$LD\" >&6; }\n+else\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: result: no\" >&5\n+$as_echo \"no\" >&6; }\n+fi\n+test -z \"$LD\" && as_fn_error $? \"no acceptable ld found in \\$PATH\" \"$LINENO\" 5\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking if the linker ($LD) is GNU ld\" >&5\n+$as_echo_n \"checking if the linker ($LD) is GNU ld... \" >&6; }\n+if ${acl_cv_prog_gnu_ld+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  # I'd rather use --version here, but apparently some GNU lds only accept -v.\n+case `$LD -v 2>&1 </dev/null` in\n+*GNU* | *'with BFD'*)\n+  acl_cv_prog_gnu_ld=yes\n+  ;;\n+*)\n+  acl_cv_prog_gnu_ld=no\n+  ;;\n+esac\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $acl_cv_prog_gnu_ld\" >&5\n+$as_echo \"$acl_cv_prog_gnu_ld\" >&6; }\n+with_gnu_ld=$acl_cv_prog_gnu_ld\n+\n+\n+\n+\n+                                                { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for shared library run path origin\" >&5\n+$as_echo_n \"checking for shared library run path origin... \" >&6; }\n+if ${acl_cv_rpath+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+\n+    CC=\"$CC\" GCC=\"$GCC\" LDFLAGS=\"$LDFLAGS\" LD=\"$LD\" with_gnu_ld=\"$with_gnu_ld\" \\\n+    ${CONFIG_SHELL-/bin/sh} \"$ac_aux_dir/config.rpath\" \"$host\" > conftest.sh\n+    . ./conftest.sh\n+    rm -f ./conftest.sh\n+    acl_cv_rpath=done\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $acl_cv_rpath\" >&5\n+$as_echo \"$acl_cv_rpath\" >&6; }\n+  wl=\"$acl_cv_wl\"\n+  acl_libext=\"$acl_cv_libext\"\n+  acl_shlibext=\"$acl_cv_shlibext\"\n+  acl_libname_spec=\"$acl_cv_libname_spec\"\n+  acl_library_names_spec=\"$acl_cv_library_names_spec\"\n+  acl_hardcode_libdir_flag_spec=\"$acl_cv_hardcode_libdir_flag_spec\"\n+  acl_hardcode_libdir_separator=\"$acl_cv_hardcode_libdir_separator\"\n+  acl_hardcode_direct=\"$acl_cv_hardcode_direct\"\n+  acl_hardcode_minus_L=\"$acl_cv_hardcode_minus_L\"\n+    # Check whether --enable-rpath was given.\n+if test \"${enable_rpath+set}\" = set; then :\n+  enableval=$enable_rpath; :\n+else\n+  enable_rpath=yes\n+fi\n+\n+\n+\n+\n+  acl_libdirstem=lib\n+  acl_libdirstem2=\n+  case \"$host_os\" in\n+    solaris*)\n+                                    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for 64-bit host\" >&5\n+$as_echo_n \"checking for 64-bit host... \" >&6; }\n+if ${gl_cv_solaris_64bit+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#ifdef _LP64\n+sixtyfour bits\n+#endif\n+\n+_ACEOF\n+if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n+  $EGREP \"sixtyfour bits\" >/dev/null 2>&1; then :\n+  gl_cv_solaris_64bit=yes\n+else\n+  gl_cv_solaris_64bit=no\n+fi\n+rm -f conftest*\n+\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_cv_solaris_64bit\" >&5\n+$as_echo \"$gl_cv_solaris_64bit\" >&6; }\n+      if test $gl_cv_solaris_64bit = yes; then\n+        acl_libdirstem=lib/64\n+        case \"$host_cpu\" in\n+          sparc*)        acl_libdirstem2=lib/sparcv9 ;;\n+          i*86 | x86_64) acl_libdirstem2=lib/amd64 ;;\n+        esac\n+      fi\n+      ;;\n+    *)\n+      searchpath=`(LC_ALL=C $CC -print-search-dirs) 2>/dev/null | sed -n -e 's,^libraries: ,,p' | sed -e 's,^=,,'`\n+      if test -n \"$searchpath\"; then\n+        acl_save_IFS=\"${IFS= \t}\"; IFS=\":\"\n+        for searchdir in $searchpath; do\n+          if test -d \"$searchdir\"; then\n+            case \"$searchdir\" in\n+              */lib64/ | */lib64 ) acl_libdirstem=lib64 ;;\n+              */../ | */.. )\n+                # Better ignore directories of this form. They are misleading.\n+                ;;\n+              *) searchdir=`cd \"$searchdir\" && pwd`\n+                 case \"$searchdir\" in\n+                   */lib64 ) acl_libdirstem=lib64 ;;\n+                 esac ;;\n+            esac\n+          fi\n+        done\n+        IFS=\"$acl_save_IFS\"\n+      fi\n+      ;;\n+  esac\n+  test -n \"$acl_libdirstem2\" || acl_libdirstem2=\"$acl_libdirstem\"\n+\n+\n+\n+  gl_threads_api=none\n+  LIBTHREAD=\n+  LTLIBTHREAD=\n+  LIBMULTITHREAD=\n+  LTLIBMULTITHREAD=\n+  if test \"$gl_use_threads\" != no; then\n+        { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether imported symbols can be declared weak\" >&5\n+$as_echo_n \"checking whether imported symbols can be declared weak... \" >&6; }\n+if ${gl_cv_have_weak+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  gl_cv_have_weak=no\n+              cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+extern void xyzzy ();\n+#pragma weak xyzzy\n+int\n+main ()\n+{\n+xyzzy();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  gl_cv_have_weak=maybe\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+       if test $gl_cv_have_weak = maybe; then\n+                           if test \"$cross_compiling\" = yes; then :\n+                          cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#ifdef __ELF__\n+               Extensible Linking Format\n+               #endif\n+\n+_ACEOF\n+if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n+  $EGREP \"Extensible Linking Format\" >/dev/null 2>&1; then :\n+  gl_cv_have_weak=\"guessing yes\"\n+else\n+  gl_cv_have_weak=\"guessing no\"\n+fi\n+rm -f conftest*\n+\n+\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#include <stdio.h>\n+#pragma weak fputs\n+int main ()\n+{\n+  return (fputs == NULL);\n+}\n+_ACEOF\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  gl_cv_have_weak=yes\n+else\n+  gl_cv_have_weak=no\n+fi\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n+fi\n+\n+       fi\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_cv_have_weak\" >&5\n+$as_echo \"$gl_cv_have_weak\" >&6; }\n+    if test \"$gl_use_threads\" = yes || test \"$gl_use_threads\" = posix; then\n+      # On OSF/1, the compiler needs the flag -pthread or -D_REENTRANT so that\n+      # it groks <pthread.h>. It's added above, in gl_THREADLIB_EARLY_BODY.\n+      ac_fn_c_check_header_mongrel \"$LINENO\" \"pthread.h\" \"ac_cv_header_pthread_h\" \"$ac_includes_default\"\n+if test \"x$ac_cv_header_pthread_h\" = xyes; then :\n+  gl_have_pthread_h=yes\n+else\n+  gl_have_pthread_h=no\n+fi\n+\n+\n+      if test \"$gl_have_pthread_h\" = yes; then\n+        # Other possible tests:\n+        #   -lpthreads (FSU threads, PCthreads)\n+        #   -lgthreads\n+        gl_have_pthread=\n+        # Test whether both pthread_mutex_lock and pthread_mutexattr_init exist\n+        # in libc. IRIX 6.5 has the first one in both libc and libpthread, but\n+        # the second one only in libpthread, and lock.c needs it.\n+        #\n+        # If -pthread works, prefer it to -lpthread, since Ubuntu 14.04\n+        # needs -pthread for some reason.  See:\n+        # http://lists.gnu.org/archive/html/bug-gnulib/2014-09/msg00023.html\n+        save_LIBS=$LIBS\n+        for gl_pthread in '' '-pthread'; do\n+          LIBS=\"$LIBS $gl_pthread\"\n+          cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <pthread.h>\n+                 pthread_mutex_t m;\n+                 pthread_mutexattr_t ma;\n+\n+int\n+main ()\n+{\n+pthread_mutex_lock (&m);\n+                 pthread_mutexattr_init (&ma);\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  gl_have_pthread=yes\n+             LIBTHREAD=$gl_pthread LTLIBTHREAD=$gl_pthread\n+             LIBMULTITHREAD=$gl_pthread LTLIBMULTITHREAD=$gl_pthread\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+          LIBS=$save_LIBS\n+          test -n \"$gl_have_pthread\" && break\n+        done\n+\n+        # Test for libpthread by looking for pthread_kill. (Not pthread_self,\n+        # since it is defined as a macro on OSF/1.)\n+        if test -n \"$gl_have_pthread\" && test -z \"$LIBTHREAD\"; then\n+          # The program links fine without libpthread. But it may actually\n+          # need to link with libpthread in order to create multiple threads.\n+          { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for pthread_kill in -lpthread\" >&5\n+$as_echo_n \"checking for pthread_kill in -lpthread... \" >&6; }\n+if ${ac_cv_lib_pthread_pthread_kill+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  ac_check_lib_save_LIBS=$LIBS\n+LIBS=\"-lpthread  $LIBS\"\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+/* Override any GCC internal prototype to avoid an error.\n+   Use char because int might match the return type of a GCC\n+   builtin and then its argument prototype would still apply.  */\n+#ifdef __cplusplus\n+extern \"C\"\n+#endif\n+char pthread_kill ();\n+int\n+main ()\n+{\n+return pthread_kill ();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_lib_pthread_pthread_kill=yes\n+else\n+  ac_cv_lib_pthread_pthread_kill=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+LIBS=$ac_check_lib_save_LIBS\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pthread_pthread_kill\" >&5\n+$as_echo \"$ac_cv_lib_pthread_pthread_kill\" >&6; }\n+if test \"x$ac_cv_lib_pthread_pthread_kill\" = xyes; then :\n+  LIBMULTITHREAD=-lpthread LTLIBMULTITHREAD=-lpthread\n+             # On Solaris and HP-UX, most pthread functions exist also in libc.\n+             # Therefore pthread_in_use() needs to actually try to create a\n+             # thread: pthread_create from libc will fail, whereas\n+             # pthread_create will actually create a thread.\n+             case \"$host_os\" in\n+               solaris* | hpux*)\n+\n+$as_echo \"#define PTHREAD_IN_USE_DETECTION_HARD 1\" >>confdefs.h\n+\n+             esac\n+\n+fi\n+\n+        elif test -z \"$gl_have_pthread\"; then\n+          # Some library is needed. Try libpthread and libc_r.\n+          { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for pthread_kill in -lpthread\" >&5\n+$as_echo_n \"checking for pthread_kill in -lpthread... \" >&6; }\n+if ${ac_cv_lib_pthread_pthread_kill+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  ac_check_lib_save_LIBS=$LIBS\n+LIBS=\"-lpthread  $LIBS\"\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+/* Override any GCC internal prototype to avoid an error.\n+   Use char because int might match the return type of a GCC\n+   builtin and then its argument prototype would still apply.  */\n+#ifdef __cplusplus\n+extern \"C\"\n+#endif\n+char pthread_kill ();\n+int\n+main ()\n+{\n+return pthread_kill ();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_lib_pthread_pthread_kill=yes\n+else\n+  ac_cv_lib_pthread_pthread_kill=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+LIBS=$ac_check_lib_save_LIBS\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pthread_pthread_kill\" >&5\n+$as_echo \"$ac_cv_lib_pthread_pthread_kill\" >&6; }\n+if test \"x$ac_cv_lib_pthread_pthread_kill\" = xyes; then :\n+  gl_have_pthread=yes\n+             LIBTHREAD=-lpthread LTLIBTHREAD=-lpthread\n+             LIBMULTITHREAD=-lpthread LTLIBMULTITHREAD=-lpthread\n+fi\n+\n+          if test -z \"$gl_have_pthread\"; then\n+            # For FreeBSD 4.\n+            { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for pthread_kill in -lc_r\" >&5\n+$as_echo_n \"checking for pthread_kill in -lc_r... \" >&6; }\n+if ${ac_cv_lib_c_r_pthread_kill+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  ac_check_lib_save_LIBS=$LIBS\n+LIBS=\"-lc_r  $LIBS\"\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+/* Override any GCC internal prototype to avoid an error.\n+   Use char because int might match the return type of a GCC\n+   builtin and then its argument prototype would still apply.  */\n+#ifdef __cplusplus\n+extern \"C\"\n+#endif\n+char pthread_kill ();\n+int\n+main ()\n+{\n+return pthread_kill ();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_lib_c_r_pthread_kill=yes\n+else\n+  ac_cv_lib_c_r_pthread_kill=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+LIBS=$ac_check_lib_save_LIBS\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_c_r_pthread_kill\" >&5\n+$as_echo \"$ac_cv_lib_c_r_pthread_kill\" >&6; }\n+if test \"x$ac_cv_lib_c_r_pthread_kill\" = xyes; then :\n+  gl_have_pthread=yes\n+               LIBTHREAD=-lc_r LTLIBTHREAD=-lc_r\n+               LIBMULTITHREAD=-lc_r LTLIBMULTITHREAD=-lc_r\n+fi\n+\n+          fi\n+        fi\n+        if test -n \"$gl_have_pthread\"; then\n+          gl_threads_api=posix\n+\n+$as_echo \"#define USE_POSIX_THREADS 1\" >>confdefs.h\n+\n+          if test -n \"$LIBMULTITHREAD\" || test -n \"$LTLIBMULTITHREAD\"; then\n+            if case \"$gl_cv_have_weak\" in *yes) true;; *) false;; esac; then\n+\n+$as_echo \"#define USE_POSIX_THREADS_WEAK 1\" >>confdefs.h\n+\n+              LIBTHREAD=\n+              LTLIBTHREAD=\n+            fi\n+          fi\n+        fi\n+      fi\n+    fi\n+    if test -z \"$gl_have_pthread\"; then\n+      if test \"$gl_use_threads\" = yes || test \"$gl_use_threads\" = solaris; then\n+        gl_have_solaristhread=\n+        gl_save_LIBS=\"$LIBS\"\n+        LIBS=\"$LIBS -lthread\"\n+        cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#include <thread.h>\n+#include <synch.h>\n+\n+int\n+main ()\n+{\n+thr_self();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  gl_have_solaristhread=yes\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+        LIBS=\"$gl_save_LIBS\"\n+        if test -n \"$gl_have_solaristhread\"; then\n+          gl_threads_api=solaris\n+          LIBTHREAD=-lthread\n+          LTLIBTHREAD=-lthread\n+          LIBMULTITHREAD=\"$LIBTHREAD\"\n+          LTLIBMULTITHREAD=\"$LTLIBTHREAD\"\n+\n+$as_echo \"#define USE_SOLARIS_THREADS 1\" >>confdefs.h\n+\n+          if case \"$gl_cv_have_weak\" in *yes) true;; *) false;; esac; then\n+\n+$as_echo \"#define USE_SOLARIS_THREADS_WEAK 1\" >>confdefs.h\n+\n+            LIBTHREAD=\n+            LTLIBTHREAD=\n+          fi\n+        fi\n+      fi\n+    fi\n+    if test \"$gl_use_threads\" = pth; then\n+      gl_save_CPPFLAGS=\"$CPPFLAGS\"\n+\n+\n+\n+\n+\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking how to link with libpth\" >&5\n+$as_echo_n \"checking how to link with libpth... \" >&6; }\n+if ${ac_cv_libpth_libs+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+\n+\n+\n+\n+\n+\n+\n+\n+    use_additional=yes\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+\n+    eval additional_includedir=\\\"$includedir\\\"\n+    eval additional_libdir=\\\"$libdir\\\"\n+\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+\n+# Check whether --with-libpth-prefix was given.\n+if test \"${with_libpth_prefix+set}\" = set; then :\n+  withval=$with_libpth_prefix;\n+    if test \"X$withval\" = \"Xno\"; then\n+      use_additional=no\n+    else\n+      if test \"X$withval\" = \"X\"; then\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+\n+          eval additional_includedir=\\\"$includedir\\\"\n+          eval additional_libdir=\\\"$libdir\\\"\n+\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+      else\n+        additional_includedir=\"$withval/include\"\n+        additional_libdir=\"$withval/$acl_libdirstem\"\n+        if test \"$acl_libdirstem2\" != \"$acl_libdirstem\" \\\n+           && ! test -d \"$withval/$acl_libdirstem\"; then\n+          additional_libdir=\"$withval/$acl_libdirstem2\"\n+        fi\n+      fi\n+    fi\n+\n+fi\n+\n+      LIBPTH=\n+  LTLIBPTH=\n+  INCPTH=\n+  LIBPTH_PREFIX=\n+      HAVE_LIBPTH=\n+  rpathdirs=\n+  ltrpathdirs=\n+  names_already_handled=\n+  names_next_round='pth '\n+  while test -n \"$names_next_round\"; do\n+    names_this_round=\"$names_next_round\"\n+    names_next_round=\n+    for name in $names_this_round; do\n+      already_handled=\n+      for n in $names_already_handled; do\n+        if test \"$n\" = \"$name\"; then\n+          already_handled=yes\n+          break\n+        fi\n+      done\n+      if test -z \"$already_handled\"; then\n+        names_already_handled=\"$names_already_handled $name\"\n+                        uppername=`echo \"$name\" | sed -e 'y|abcdefghijklmnopqrstuvwxyz./+-|ABCDEFGHIJKLMNOPQRSTUVWXYZ____|'`\n+        eval value=\\\"\\$HAVE_LIB$uppername\\\"\n+        if test -n \"$value\"; then\n+          if test \"$value\" = yes; then\n+            eval value=\\\"\\$LIB$uppername\\\"\n+            test -z \"$value\" || LIBPTH=\"${LIBPTH}${LIBPTH:+ }$value\"\n+            eval value=\\\"\\$LTLIB$uppername\\\"\n+            test -z \"$value\" || LTLIBPTH=\"${LTLIBPTH}${LTLIBPTH:+ }$value\"\n+          else\n+                                    :\n+          fi\n+        else\n+                              found_dir=\n+          found_la=\n+          found_so=\n+          found_a=\n+          eval libname=\\\"$acl_libname_spec\\\"    # typically: libname=lib$name\n+          if test -n \"$acl_shlibext\"; then\n+            shrext=\".$acl_shlibext\"             # typically: shrext=.so\n+          else\n+            shrext=\n+          fi\n+          if test $use_additional = yes; then\n+            dir=\"$additional_libdir\"\n+                                    if test -n \"$acl_shlibext\"; then\n+              if test -f \"$dir/$libname$shrext\"; then\n+                found_dir=\"$dir\"\n+                found_so=\"$dir/$libname$shrext\"\n+              else\n+                if test \"$acl_library_names_spec\" = '$libname$shrext$versuffix'; then\n+                  ver=`(cd \"$dir\" && \\\n+                        for f in \"$libname$shrext\".*; do echo \"$f\"; done \\\n+                        | sed -e \"s,^$libname$shrext\\\\\\\\.,,\" \\\n+                        | sort -t '.' -n -r -k1,1 -k2,2 -k3,3 -k4,4 -k5,5 \\\n+                        | sed 1q ) 2>/dev/null`\n+                  if test -n \"$ver\" && test -f \"$dir/$libname$shrext.$ver\"; then\n+                    found_dir=\"$dir\"\n+                    found_so=\"$dir/$libname$shrext.$ver\"\n+                  fi\n+                else\n+                  eval library_names=\\\"$acl_library_names_spec\\\"\n+                  for f in $library_names; do\n+                    if test -f \"$dir/$f\"; then\n+                      found_dir=\"$dir\"\n+                      found_so=\"$dir/$f\"\n+                      break\n+                    fi\n+                  done\n+                fi\n+              fi\n+            fi\n+                        if test \"X$found_dir\" = \"X\"; then\n+              if test -f \"$dir/$libname.$acl_libext\"; then\n+                found_dir=\"$dir\"\n+                found_a=\"$dir/$libname.$acl_libext\"\n+              fi\n+            fi\n+            if test \"X$found_dir\" != \"X\"; then\n+              if test -f \"$dir/$libname.la\"; then\n+                found_la=\"$dir/$libname.la\"\n+              fi\n+            fi\n+          fi\n+          if test \"X$found_dir\" = \"X\"; then\n+            for x in $LDFLAGS $LTLIBPTH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+              case \"$x\" in\n+                -L*)\n+                  dir=`echo \"X$x\" | sed -e 's/^X-L//'`\n+                                    if test -n \"$acl_shlibext\"; then\n+                    if test -f \"$dir/$libname$shrext\"; then\n+                      found_dir=\"$dir\"\n+                      found_so=\"$dir/$libname$shrext\"\n+                    else\n+                      if test \"$acl_library_names_spec\" = '$libname$shrext$versuffix'; then\n+                        ver=`(cd \"$dir\" && \\\n+                              for f in \"$libname$shrext\".*; do echo \"$f\"; done \\\n+                              | sed -e \"s,^$libname$shrext\\\\\\\\.,,\" \\\n+                              | sort -t '.' -n -r -k1,1 -k2,2 -k3,3 -k4,4 -k5,5 \\\n+                              | sed 1q ) 2>/dev/null`\n+                        if test -n \"$ver\" && test -f \"$dir/$libname$shrext.$ver\"; then\n+                          found_dir=\"$dir\"\n+                          found_so=\"$dir/$libname$shrext.$ver\"\n+                        fi\n+                      else\n+                        eval library_names=\\\"$acl_library_names_spec\\\"\n+                        for f in $library_names; do\n+                          if test -f \"$dir/$f\"; then\n+                            found_dir=\"$dir\"\n+                            found_so=\"$dir/$f\"\n+                            break\n+                          fi\n+                        done\n+                      fi\n+                    fi\n+                  fi\n+                                    if test \"X$found_dir\" = \"X\"; then\n+                    if test -f \"$dir/$libname.$acl_libext\"; then\n+                      found_dir=\"$dir\"\n+                      found_a=\"$dir/$libname.$acl_libext\"\n+                    fi\n+                  fi\n+                  if test \"X$found_dir\" != \"X\"; then\n+                    if test -f \"$dir/$libname.la\"; then\n+                      found_la=\"$dir/$libname.la\"\n+                    fi\n+                  fi\n+                  ;;\n+              esac\n+              if test \"X$found_dir\" != \"X\"; then\n+                break\n+              fi\n+            done\n+          fi\n+          if test \"X$found_dir\" != \"X\"; then\n+                        LTLIBPTH=\"${LTLIBPTH}${LTLIBPTH:+ }-L$found_dir -l$name\"\n+            if test \"X$found_so\" != \"X\"; then\n+                                                        if test \"$enable_rpath\" = no \\\n+                 || test \"X$found_dir\" = \"X/usr/$acl_libdirstem\" \\\n+                 || test \"X$found_dir\" = \"X/usr/$acl_libdirstem2\"; then\n+                                LIBPTH=\"${LIBPTH}${LIBPTH:+ }$found_so\"\n+              else\n+                                                                                haveit=\n+                for x in $ltrpathdirs; do\n+                  if test \"X$x\" = \"X$found_dir\"; then\n+                    haveit=yes\n+                    break\n+                  fi\n+                done\n+                if test -z \"$haveit\"; then\n+                  ltrpathdirs=\"$ltrpathdirs $found_dir\"\n+                fi\n+                                if test \"$acl_hardcode_direct\" = yes; then\n+                                                      LIBPTH=\"${LIBPTH}${LIBPTH:+ }$found_so\"\n+                else\n+                  if test -n \"$acl_hardcode_libdir_flag_spec\" && test \"$acl_hardcode_minus_L\" = no; then\n+                                                            LIBPTH=\"${LIBPTH}${LIBPTH:+ }$found_so\"\n+                                                            haveit=\n+                    for x in $rpathdirs; do\n+                      if test \"X$x\" = \"X$found_dir\"; then\n+                        haveit=yes\n+                        break\n+                      fi\n+                    done\n+                    if test -z \"$haveit\"; then\n+                      rpathdirs=\"$rpathdirs $found_dir\"\n+                    fi\n+                  else\n+                                                                                haveit=\n+                    for x in $LDFLAGS $LIBPTH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                      if test \"X$x\" = \"X-L$found_dir\"; then\n+                        haveit=yes\n+                        break\n+                      fi\n+                    done\n+                    if test -z \"$haveit\"; then\n+                      LIBPTH=\"${LIBPTH}${LIBPTH:+ }-L$found_dir\"\n+                    fi\n+                    if test \"$acl_hardcode_minus_L\" != no; then\n+                                                                                        LIBPTH=\"${LIBPTH}${LIBPTH:+ }$found_so\"\n+                    else\n+                                                                                                                                                                                LIBPTH=\"${LIBPTH}${LIBPTH:+ }-l$name\"\n+                    fi\n+                  fi\n+                fi\n+              fi\n+            else\n+              if test \"X$found_a\" != \"X\"; then\n+                                LIBPTH=\"${LIBPTH}${LIBPTH:+ }$found_a\"\n+              else\n+                                                LIBPTH=\"${LIBPTH}${LIBPTH:+ }-L$found_dir -l$name\"\n+              fi\n+            fi\n+                        additional_includedir=\n+            case \"$found_dir\" in\n+              */$acl_libdirstem | */$acl_libdirstem/)\n+                basedir=`echo \"X$found_dir\" | sed -e 's,^X,,' -e \"s,/$acl_libdirstem/\"'*$,,'`\n+                if test \"$name\" = 'pth'; then\n+                  LIBPTH_PREFIX=\"$basedir\"\n+                fi\n+                additional_includedir=\"$basedir/include\"\n+                ;;\n+              */$acl_libdirstem2 | */$acl_libdirstem2/)\n+                basedir=`echo \"X$found_dir\" | sed -e 's,^X,,' -e \"s,/$acl_libdirstem2/\"'*$,,'`\n+                if test \"$name\" = 'pth'; then\n+                  LIBPTH_PREFIX=\"$basedir\"\n+                fi\n+                additional_includedir=\"$basedir/include\"\n+                ;;\n+            esac\n+            if test \"X$additional_includedir\" != \"X\"; then\n+                                                                                                                if test \"X$additional_includedir\" != \"X/usr/include\"; then\n+                haveit=\n+                if test \"X$additional_includedir\" = \"X/usr/local/include\"; then\n+                  if test -n \"$GCC\"; then\n+                    case $host_os in\n+                      linux* | gnu* | k*bsd*-gnu) haveit=yes;;\n+                    esac\n+                  fi\n+                fi\n+                if test -z \"$haveit\"; then\n+                  for x in $CPPFLAGS $INCPTH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                    if test \"X$x\" = \"X-I$additional_includedir\"; then\n+                      haveit=yes\n+                      break\n+                    fi\n+                  done\n+                  if test -z \"$haveit\"; then\n+                    if test -d \"$additional_includedir\"; then\n+                                            INCPTH=\"${INCPTH}${INCPTH:+ }-I$additional_includedir\"\n+                    fi\n+                  fi\n+                fi\n+              fi\n+            fi\n+                        if test -n \"$found_la\"; then\n+                                                        save_libdir=\"$libdir\"\n+              case \"$found_la\" in\n+                */* | *\\\\*) . \"$found_la\" ;;\n+                *) . \"./$found_la\" ;;\n+              esac\n+              libdir=\"$save_libdir\"\n+                            for dep in $dependency_libs; do\n+                case \"$dep\" in\n+                  -L*)\n+                    additional_libdir=`echo \"X$dep\" | sed -e 's/^X-L//'`\n+                                                                                                                                                                if test \"X$additional_libdir\" != \"X/usr/$acl_libdirstem\" \\\n+                       && test \"X$additional_libdir\" != \"X/usr/$acl_libdirstem2\"; then\n+                      haveit=\n+                      if test \"X$additional_libdir\" = \"X/usr/local/$acl_libdirstem\" \\\n+                         || test \"X$additional_libdir\" = \"X/usr/local/$acl_libdirstem2\"; then\n+                        if test -n \"$GCC\"; then\n+                          case $host_os in\n+                            linux* | gnu* | k*bsd*-gnu) haveit=yes;;\n+                          esac\n+                        fi\n+                      fi\n+                      if test -z \"$haveit\"; then\n+                        haveit=\n+                        for x in $LDFLAGS $LIBPTH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n+                            haveit=yes\n+                            break\n+                          fi\n+                        done\n+                        if test -z \"$haveit\"; then\n+                          if test -d \"$additional_libdir\"; then\n+                                                        LIBPTH=\"${LIBPTH}${LIBPTH:+ }-L$additional_libdir\"\n+                          fi\n+                        fi\n+                        haveit=\n+                        for x in $LDFLAGS $LTLIBPTH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n+                            haveit=yes\n+                            break\n+                          fi\n+                        done\n+                        if test -z \"$haveit\"; then\n+                          if test -d \"$additional_libdir\"; then\n+                                                        LTLIBPTH=\"${LTLIBPTH}${LTLIBPTH:+ }-L$additional_libdir\"\n+                          fi\n+                        fi\n+                      fi\n+                    fi\n+                    ;;\n+                  -R*)\n+                    dir=`echo \"X$dep\" | sed -e 's/^X-R//'`\n+                    if test \"$enable_rpath\" != no; then\n+                                                                  haveit=\n+                      for x in $rpathdirs; do\n+                        if test \"X$x\" = \"X$dir\"; then\n+                          haveit=yes\n+                          break\n+                        fi\n+                      done\n+                      if test -z \"$haveit\"; then\n+                        rpathdirs=\"$rpathdirs $dir\"\n+                      fi\n+                                                                  haveit=\n+                      for x in $ltrpathdirs; do\n+                        if test \"X$x\" = \"X$dir\"; then\n+                          haveit=yes\n+                          break\n+                        fi\n+                      done\n+                      if test -z \"$haveit\"; then\n+                        ltrpathdirs=\"$ltrpathdirs $dir\"\n+                      fi\n+                    fi\n+                    ;;\n+                  -l*)\n+                                        names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's/^X-l//'`\n+                    ;;\n+                  *.la)\n+                                                                                names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's,^X.*/,,' -e 's,^lib,,' -e 's,\\.la$,,'`\n+                    ;;\n+                  *)\n+                                        LIBPTH=\"${LIBPTH}${LIBPTH:+ }$dep\"\n+                    LTLIBPTH=\"${LTLIBPTH}${LTLIBPTH:+ }$dep\"\n+                    ;;\n+                esac\n+              done\n+            fi\n+          else\n+                                                            LIBPTH=\"${LIBPTH}${LIBPTH:+ }-l$name\"\n+            LTLIBPTH=\"${LTLIBPTH}${LTLIBPTH:+ }-l$name\"\n+          fi\n+        fi\n+      fi\n+    done\n+  done\n+  if test \"X$rpathdirs\" != \"X\"; then\n+    if test -n \"$acl_hardcode_libdir_separator\"; then\n+                        alldirs=\n+      for found_dir in $rpathdirs; do\n+        alldirs=\"${alldirs}${alldirs:+$acl_hardcode_libdir_separator}$found_dir\"\n+      done\n+            acl_save_libdir=\"$libdir\"\n+      libdir=\"$alldirs\"\n+      eval flag=\\\"$acl_hardcode_libdir_flag_spec\\\"\n+      libdir=\"$acl_save_libdir\"\n+      LIBPTH=\"${LIBPTH}${LIBPTH:+ }$flag\"\n+    else\n+            for found_dir in $rpathdirs; do\n+        acl_save_libdir=\"$libdir\"\n+        libdir=\"$found_dir\"\n+        eval flag=\\\"$acl_hardcode_libdir_flag_spec\\\"\n+        libdir=\"$acl_save_libdir\"\n+        LIBPTH=\"${LIBPTH}${LIBPTH:+ }$flag\"\n+      done\n+    fi\n+  fi\n+  if test \"X$ltrpathdirs\" != \"X\"; then\n+            for found_dir in $ltrpathdirs; do\n+      LTLIBPTH=\"${LTLIBPTH}${LTLIBPTH:+ }-R$found_dir\"\n+    done\n+  fi\n+\n+\n+\n+\n+\n+\n+    ac_cv_libpth_libs=\"$LIBPTH\"\n+    ac_cv_libpth_ltlibs=\"$LTLIBPTH\"\n+    ac_cv_libpth_cppflags=\"$INCPTH\"\n+    ac_cv_libpth_prefix=\"$LIBPTH_PREFIX\"\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_libpth_libs\" >&5\n+$as_echo \"$ac_cv_libpth_libs\" >&6; }\n+  LIBPTH=\"$ac_cv_libpth_libs\"\n+  LTLIBPTH=\"$ac_cv_libpth_ltlibs\"\n+  INCPTH=\"$ac_cv_libpth_cppflags\"\n+  LIBPTH_PREFIX=\"$ac_cv_libpth_prefix\"\n+\n+  for element in $INCPTH; do\n+    haveit=\n+    for x in $CPPFLAGS; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+      if test \"X$x\" = \"X$element\"; then\n+        haveit=yes\n+        break\n+      fi\n+    done\n+    if test -z \"$haveit\"; then\n+      CPPFLAGS=\"${CPPFLAGS}${CPPFLAGS:+ }$element\"\n+    fi\n+  done\n+\n+\n+\n+\n+      HAVE_LIBPTH=yes\n+\n+\n+\n+      gl_have_pth=\n+      gl_save_LIBS=\"$LIBS\"\n+      LIBS=\"$LIBS $LIBPTH\"\n+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <pth.h>\n+int\n+main ()\n+{\n+pth_self();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  gl_have_pth=yes\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+      LIBS=\"$gl_save_LIBS\"\n+      if test -n \"$gl_have_pth\"; then\n+        gl_threads_api=pth\n+        LIBTHREAD=\"$LIBPTH\"\n+        LTLIBTHREAD=\"$LTLIBPTH\"\n+        LIBMULTITHREAD=\"$LIBTHREAD\"\n+        LTLIBMULTITHREAD=\"$LTLIBTHREAD\"\n+\n+$as_echo \"#define USE_PTH_THREADS 1\" >>confdefs.h\n+\n+        if test -n \"$LIBMULTITHREAD\" || test -n \"$LTLIBMULTITHREAD\"; then\n+          if case \"$gl_cv_have_weak\" in *yes) true;; *) false;; esac; then\n+\n+$as_echo \"#define USE_PTH_THREADS_WEAK 1\" >>confdefs.h\n+\n+            LIBTHREAD=\n+            LTLIBTHREAD=\n+          fi\n+        fi\n+      else\n+        CPPFLAGS=\"$gl_save_CPPFLAGS\"\n+      fi\n+    fi\n+    if test -z \"$gl_have_pthread\"; then\n+      case \"$gl_use_threads\" in\n+        yes | windows | win32) # The 'win32' is for backward compatibility.\n+          if { case \"$host_os\" in\n+                 mingw*) true;;\n+                 *) false;;\n+               esac\n+             }; then\n+            gl_threads_api=windows\n+\n+$as_echo \"#define USE_WINDOWS_THREADS 1\" >>confdefs.h\n+\n+          fi\n+          ;;\n+      esac\n+    fi\n+  fi\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for multithread API to use\" >&5\n+$as_echo_n \"checking for multithread API to use... \" >&6; }\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_threads_api\" >&5\n+$as_echo \"$gl_threads_api\" >&6; }\n+\n \n-#include <features.h>\n-#ifdef __GNU_LIBRARY__\n- #if (__GLIBC__ == 2 && __GLIBC_MINOR__ >= 1) || (__GLIBC__ > 2)\n-  Lucky GNU user\n- #endif\n-#endif\n-#ifdef __UCLIBC__\n- Lucky user\n-#endif\n \n-_ACEOF\n-if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n-  $EGREP \"Lucky\" >/dev/null 2>&1; then :\n-  ac_cv_gnu_library_2_1=yes\n-else\n-  ac_cv_gnu_library_2_1=no\n-fi\n-rm -f conftest*\n \n \n \n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_gnu_library_2_1\" >&5\n-$as_echo \"$ac_cv_gnu_library_2_1\" >&6; }\n \n-    GLIBC21=\"$ac_cv_gnu_library_2_1\"\n \n \n \n@@ -14199,6 +15356,196 @@ $as_echo \"#define REPLACE_STRERROR_0 1\" >>confdefs.h\n \n \n \n+  ac_fn_c_check_func \"$LINENO\" \"strerror_r\" \"ac_cv_func_strerror_r\"\n+if test \"x$ac_cv_func_strerror_r\" = xyes; then :\n+\n+fi\n+\n+  if test $ac_cv_func_strerror_r = yes; then\n+    if test \"$ERRNO_H:$REPLACE_STRERROR_0\" = :0; then\n+                        { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for strerror_r with POSIX signature\" >&5\n+$as_echo_n \"checking for strerror_r with POSIX signature... \" >&6; }\n+if ${gl_cv_func_strerror_r_posix_signature+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <string.h>\n+                int strerror_r (int, char *, size_t);\n+\n+int\n+main ()\n+{\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_compile \"$LINENO\"; then :\n+  gl_cv_func_strerror_r_posix_signature=yes\n+else\n+  gl_cv_func_strerror_r_posix_signature=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_cv_func_strerror_r_posix_signature\" >&5\n+$as_echo \"$gl_cv_func_strerror_r_posix_signature\" >&6; }\n+      if test $gl_cv_func_strerror_r_posix_signature = yes; then\n+                                                        { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether strerror_r works\" >&5\n+$as_echo_n \"checking whether strerror_r works... \" >&6; }\n+if ${gl_cv_func_strerror_r_works+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  if test \"$cross_compiling\" = yes; then :\n+\n+              case \"$host_os\" in\n+                       # Guess no on AIX.\n+                aix*)  gl_cv_func_strerror_r_works=\"guessing no\";;\n+                       # Guess no on HP-UX.\n+                hpux*) gl_cv_func_strerror_r_works=\"guessing no\";;\n+                       # Guess no on BSD variants.\n+                *bsd*)  gl_cv_func_strerror_r_works=\"guessing no\";;\n+                       # Guess yes otherwise.\n+                *)     gl_cv_func_strerror_r_works=\"guessing yes\";;\n+              esac\n+\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <errno.h>\n+                  #include <string.h>\n+\n+int\n+main ()\n+{\n+int result = 0;\n+                  char buf[79];\n+                  if (strerror_r (EACCES, buf, 0) < 0)\n+                    result |= 1;\n+                  errno = 0;\n+                  if (strerror_r (EACCES, buf, sizeof buf) != 0)\n+                    result |= 2;\n+                  strcpy (buf, \"Unknown\");\n+                  if (strerror_r (0, buf, sizeof buf) != 0)\n+                    result |= 4;\n+                  if (errno)\n+                    result |= 8;\n+                  if (strstr (buf, \"nknown\") || strstr (buf, \"ndefined\"))\n+                    result |= 0x10;\n+                  errno = 0;\n+                  *buf = 0;\n+                  if (strerror_r (-3, buf, sizeof buf) < 0)\n+                    result |= 0x20;\n+                  if (errno)\n+                    result |= 0x40;\n+                  if (!*buf)\n+                    result |= 0x80;\n+                  return result;\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  gl_cv_func_strerror_r_works=yes\n+else\n+  gl_cv_func_strerror_r_works=no\n+fi\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n+fi\n+\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_cv_func_strerror_r_works\" >&5\n+$as_echo \"$gl_cv_func_strerror_r_works\" >&6; }\n+      else\n+\n+  :\n+\n+\n+\n+\n+\n+                        if test $ac_cv_func___xpg_strerror_r = yes; then\n+          { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether __xpg_strerror_r works\" >&5\n+$as_echo_n \"checking whether __xpg_strerror_r works... \" >&6; }\n+if ${gl_cv_func_strerror_r_works+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  if test \"$cross_compiling\" = yes; then :\n+                                  gl_cv_func_strerror_r_works=\"guessing no\"\n+\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <errno.h>\n+                    #include <string.h>\n+                    extern\n+                    #ifdef __cplusplus\n+                    \"C\"\n+                    #endif\n+                    int __xpg_strerror_r(int, char *, size_t);\n+\n+int\n+main ()\n+{\n+int result = 0;\n+                    char buf[256] = \"^\";\n+                    char copy[256];\n+                    char *str = strerror (-1);\n+                    strcpy (copy, str);\n+                    if (__xpg_strerror_r (-2, buf, 1) == 0)\n+                      result |= 1;\n+                    if (*buf)\n+                      result |= 2;\n+                    __xpg_strerror_r (-2, buf, 256);\n+                    if (strcmp (str, copy))\n+                      result |= 4;\n+                    return result;\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  gl_cv_func_strerror_r_works=yes\n+else\n+  gl_cv_func_strerror_r_works=no\n+fi\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n+fi\n+\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_cv_func_strerror_r_works\" >&5\n+$as_echo \"$gl_cv_func_strerror_r_works\" >&6; }\n+        fi\n+      fi\n+    fi\n+  fi\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n \n \n      if test $gl_cv_have_include_next = yes; then\n@@ -20101,6 +21448,58 @@ _ACEOF\n \n \n \n+  if test \"$gl_threads_api\" = posix; then\n+    # OSF/1 4.0 and Mac OS X 10.1 lack the pthread_rwlock_t type and the\n+    # pthread_rwlock_* functions.\n+    ac_fn_c_check_type \"$LINENO\" \"pthread_rwlock_t\" \"ac_cv_type_pthread_rwlock_t\" \"#include <pthread.h>\n+\"\n+if test \"x$ac_cv_type_pthread_rwlock_t\" = xyes; then :\n+\n+$as_echo \"#define HAVE_PTHREAD_RWLOCK 1\" >>confdefs.h\n+\n+fi\n+\n+    # glibc defines PTHREAD_MUTEX_RECURSIVE as enum, not as a macro.\n+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+      #include <pthread.h>\n+int\n+main ()\n+{\n+\n+#if __FreeBSD__ == 4\n+error \"No, in FreeBSD 4.0 recursive mutexes actually don't work.\"\n+#elif (defined __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ \\\n+       && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ < 1070)\n+error \"No, in Mac OS X < 10.7 recursive mutexes actually don't work.\"\n+#else\n+int x = (int)PTHREAD_MUTEX_RECURSIVE;\n+return !x;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_compile \"$LINENO\"; then :\n+\n+$as_echo \"#define HAVE_PTHREAD_MUTEX_RECURSIVE 1\" >>confdefs.h\n+\n+fi\n+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+  fi\n+  :\n+\n+\n+\n+cat >>confdefs.h <<_ACEOF\n+#define GNULIB_LOCK 1\n+_ACEOF\n+\n+\n+\n+\n \n   :\n \n@@ -24775,6 +26174,8 @@ $as_echo \"#define GNULIB_TEST_STRDUP 1\" >>confdefs.h\n \n \n \n+\n+\n   if test \"$ERRNO_H:$REPLACE_STRERROR_0\" = :0; then\n     { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for working strerror function\" >&5\n $as_echo_n \"checking for working strerror function... \" >&6; }\n@@ -24822,6 +26223,10 @@ $as_echo \"$gl_cv_func_working_strerror\" >&6; }\n         ;;\n     esac\n \n+                  case \"$gl_cv_func_strerror_r_works\" in\n+        *no) REPLACE_STRERROR=1 ;;\n+      esac\n+\n   else\n             REPLACE_STRERROR=1\n   fi\n@@ -24912,6 +26317,92 @@ done\n \n \n \n+\n+      ac_fn_c_check_decl \"$LINENO\" \"strerror_r\" \"ac_cv_have_decl_strerror_r\" \"$ac_includes_default\"\n+if test \"x$ac_cv_have_decl_strerror_r\" = xyes; then :\n+  HAVE_DECL_STRERROR_R=1\n+else\n+  HAVE_DECL_STRERROR_R=0\n+fi\n+\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_STRERROR_R_ORIG $HAVE_DECL_STRERROR_R\n+_ACEOF\n+\n+\n+  if test $ac_cv_func_strerror_r = yes; then\n+    if test \"$ERRNO_H:$REPLACE_STRERROR_0\" = :0; then\n+      if test $gl_cv_func_strerror_r_posix_signature = yes; then\n+        case \"$gl_cv_func_strerror_r_works\" in\n+                    *no) REPLACE_STRERROR_R=1 ;;\n+        esac\n+      else\n+                REPLACE_STRERROR_R=1\n+      fi\n+    else\n+                  REPLACE_STRERROR_R=1\n+    fi\n+  fi\n+\n+  # Overwrite the findings of AC_FUNC_STRERROR_R (for code that uses that).\n+\n+\n+  if test $HAVE_DECL_STRERROR_R = 0 || test $REPLACE_STRERROR_R = 1; then\n+\n+\n+\n+\n+\n+\n+\n+\n+  gl_LIBOBJS=\"$gl_LIBOBJS strerror_r.$ac_objext\"\n+\n+\n+\n+  :\n+\n+\n+\n+\n+\n+\n+  :\n+\n+\n+\n+\n+\n+\n+  :\n+\n+\n+\n+\n+\n+\n+  fi\n+\n+\n+\n+\n+\n+          GNULIB_STRERROR_R=1\n+\n+\n+\n+\n+\n+$as_echo \"#define GNULIB_TEST_STRERROR_R 1\" >>confdefs.h\n+\n+\n+\n+\n+\n+\n+\n+\n   if test $REPLACE_STRSTR = 0; then\n     { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether strstr works in linear time\" >&5\n $as_echo_n \"checking whether strstr works in linear time... \" >&6; }\n@@ -25526,6 +27017,10 @@ $as_echo \"$gl_cv_next_sys_uio_h\" >&6; }\n \n \n \n+\n+\n+\n+\n   :\n \n "
    },
    {
      "sha": "dd376ce4f36abc9dcc6c8be53ca7a41e687c50ee",
      "filename": "gnulib/import/Makefile.am",
      "status": "modified",
      "additions": 32,
      "deletions": 2,
      "changes": 34,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/Makefile.am",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/Makefile.am",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/Makefile.am?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -21,9 +21,9 @@\n # the same distribution terms as the rest of that program.\n #\n # Generated by gnulib-tool.\n-# Reproduce by: gnulib-tool --import --lib=libgnu --source-base=import --m4-base=import/m4 --doc-base=doc --tests-base=tests --aux-dir=import/extra --no-conditional-dependencies --no-libtool --macro-prefix=gl --no-vc-files alloca canonicalize-lgpl dirent dirfd errno fnmatch-gnu frexpl getcwd glob inet_ntop inttypes limits-h lstat memchr memmem mkdir mkdtemp mkostemp pathmax rawmemchr readlink rename setenv signal-h strchrnul strstr strtok_r sys_stat unistd unsetenv update-copyright wchar wctype-h\n+# Reproduce by: gnulib-tool --import --lib=libgnu --source-base=import --m4-base=import/m4 --doc-base=doc --tests-base=tests --aux-dir=import/extra --no-conditional-dependencies --no-libtool --macro-prefix=gl --no-vc-files alloca canonicalize-lgpl dirent dirfd errno fnmatch-gnu frexpl getcwd glob inet_ntop inttypes limits-h lstat memchr memmem mkdir mkdtemp mkostemp pathmax rawmemchr readlink rename setenv signal-h strchrnul strerror_r-posix strstr strtok_r sys_stat unistd unsetenv update-copyright wchar wctype-h\n \n-AUTOMAKE_OPTIONS = 1.9.6 gnits\n+AUTOMAKE_OPTIONS = 1.9.6 gnits subdir-objects\n \n SUBDIRS =\n noinst_HEADERS =\n@@ -660,6 +660,13 @@ EXTRA_DIST += hard-locale.h\n \n ## end   gnulib module hard-locale\n \n+## begin gnulib module havelib\n+\n+\n+EXTRA_DIST += $(top_srcdir)/import/extra/config.rpath\n+\n+## end   gnulib module havelib\n+\n ## begin gnulib module inet_ntop\n \n \n@@ -841,6 +848,12 @@ EXTRA_DIST += config.charset ref-add.sin ref-del.sin\n \n ## end   gnulib module localcharset\n \n+## begin gnulib module lock\n+\n+libgnu_a_SOURCES += glthread/lock.h glthread/lock.c\n+\n+## end   gnulib module lock\n+\n ## begin gnulib module lstat\n \n \n@@ -1970,6 +1983,15 @@ EXTRA_libgnu_a_SOURCES += strerror-override.c\n \n ## end   gnulib module strerror-override\n \n+## begin gnulib module strerror_r-posix\n+\n+\n+EXTRA_DIST += strerror_r.c\n+\n+EXTRA_libgnu_a_SOURCES += strerror_r.c\n+\n+## end   gnulib module strerror_r-posix\n+\n ## begin gnulib module string\n \n BUILT_SOURCES += string.h\n@@ -2301,6 +2323,14 @@ EXTRA_DIST += tempname.h\n \n ## end   gnulib module tempname\n \n+## begin gnulib module threadlib\n+\n+libgnu_a_SOURCES += glthread/threadlib.c\n+\n+EXTRA_DIST += $(top_srcdir)/import/extra/config.rpath\n+\n+## end   gnulib module threadlib\n+\n ## begin gnulib module time\n \n BUILT_SOURCES += time.h"
    },
    {
      "sha": "a97703066a44b9cd2b83f8a1846cd90de1410bae",
      "filename": "gnulib/import/Makefile.in",
      "status": "modified",
      "additions": 75,
      "deletions": 37,
      "changes": 112,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/Makefile.in?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -35,7 +35,7 @@\n # the same distribution terms as the rest of that program.\n #\n # Generated by gnulib-tool.\n-# Reproduce by: gnulib-tool --import --lib=libgnu --source-base=import --m4-base=import/m4 --doc-base=doc --tests-base=tests --aux-dir=import/extra --no-conditional-dependencies --no-libtool --macro-prefix=gl --no-vc-files alloca canonicalize-lgpl dirent dirfd errno fnmatch-gnu frexpl getcwd glob inet_ntop inttypes limits-h lstat memchr memmem mkdir mkdtemp mkostemp pathmax rawmemchr readlink rename setenv signal-h strchrnul strstr strtok_r sys_stat unistd unsetenv update-copyright wchar wctype-h\n+# Reproduce by: gnulib-tool --import --lib=libgnu --source-base=import --m4-base=import/m4 --doc-base=doc --tests-base=tests --aux-dir=import/extra --no-conditional-dependencies --no-libtool --macro-prefix=gl --no-vc-files alloca canonicalize-lgpl dirent dirfd errno fnmatch-gnu frexpl getcwd glob inet_ntop inttypes limits-h lstat memchr memmem mkdir mkdtemp mkostemp pathmax rawmemchr readlink rename setenv signal-h strchrnul strerror_r-posix strstr strtok_r sys_stat unistd unsetenv update-copyright wchar wctype-h\n \n \n \n@@ -178,11 +178,15 @@ am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \\\n \t$(top_srcdir)/import/m4/isnand.m4 \\\n \t$(top_srcdir)/import/m4/isnanl.m4 \\\n \t$(top_srcdir)/import/m4/largefile.m4 \\\n+\t$(top_srcdir)/import/m4/lib-ld.m4 \\\n+\t$(top_srcdir)/import/m4/lib-link.m4 \\\n+\t$(top_srcdir)/import/m4/lib-prefix.m4 \\\n \t$(top_srcdir)/import/m4/limits-h.m4 \\\n \t$(top_srcdir)/import/m4/localcharset.m4 \\\n \t$(top_srcdir)/import/m4/locale-fr.m4 \\\n \t$(top_srcdir)/import/m4/locale-ja.m4 \\\n \t$(top_srcdir)/import/m4/locale-zh.m4 \\\n+\t$(top_srcdir)/import/m4/lock.m4 \\\n \t$(top_srcdir)/import/m4/longlong.m4 \\\n \t$(top_srcdir)/import/m4/lstat.m4 \\\n \t$(top_srcdir)/import/m4/malloc.m4 \\\n@@ -236,6 +240,7 @@ am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \\\n \t$(top_srcdir)/import/m4/strchrnul.m4 \\\n \t$(top_srcdir)/import/m4/strdup.m4 \\\n \t$(top_srcdir)/import/m4/strerror.m4 \\\n+\t$(top_srcdir)/import/m4/strerror_r.m4 \\\n \t$(top_srcdir)/import/m4/string_h.m4 \\\n \t$(top_srcdir)/import/m4/strstr.m4 \\\n \t$(top_srcdir)/import/m4/strtok_r.m4 \\\n@@ -245,6 +250,7 @@ am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \\\n \t$(top_srcdir)/import/m4/sys_types_h.m4 \\\n \t$(top_srcdir)/import/m4/sys_uio_h.m4 \\\n \t$(top_srcdir)/import/m4/tempname.m4 \\\n+\t$(top_srcdir)/import/m4/threadlib.m4 \\\n \t$(top_srcdir)/import/m4/time_h.m4 \\\n \t$(top_srcdir)/import/m4/unistd-safer.m4 \\\n \t$(top_srcdir)/import/m4/unistd_h.m4 \\\n@@ -268,15 +274,18 @@ am__v_AR_0 = @echo \"  AR      \" $@;\n am__v_AR_1 = \n libgnu_a_AR = $(AR) $(ARFLAGS)\n am__DEPENDENCIES_1 =\n+am__dirstamp = $(am__leading_dot)dirstamp\n am_libgnu_a_OBJECTS = cloexec.$(OBJEXT) dirname-lgpl.$(OBJEXT) \\\n \tbasename-lgpl.$(OBJEXT) stripslash.$(OBJEXT) \\\n \texitfail.$(OBJEXT) fd-hook.$(OBJEXT) \\\n \tfilenamecat-lgpl.$(OBJEXT) getprogname.$(OBJEXT) \\\n-\thard-locale.$(OBJEXT) localcharset.$(OBJEXT) malloca.$(OBJEXT) \\\n-\tmath.$(OBJEXT) openat-die.$(OBJEXT) save-cwd.$(OBJEXT) \\\n-\tstrnlen1.$(OBJEXT) sys_socket.$(OBJEXT) tempname.$(OBJEXT) \\\n-\tunistd.$(OBJEXT) dup-safer.$(OBJEXT) fd-safer.$(OBJEXT) \\\n-\tpipe-safer.$(OBJEXT) wctype-h.$(OBJEXT)\n+\thard-locale.$(OBJEXT) localcharset.$(OBJEXT) \\\n+\tglthread/lock.$(OBJEXT) malloca.$(OBJEXT) math.$(OBJEXT) \\\n+\topenat-die.$(OBJEXT) save-cwd.$(OBJEXT) strnlen1.$(OBJEXT) \\\n+\tsys_socket.$(OBJEXT) tempname.$(OBJEXT) \\\n+\tglthread/threadlib.$(OBJEXT) unistd.$(OBJEXT) \\\n+\tdup-safer.$(OBJEXT) fd-safer.$(OBJEXT) pipe-safer.$(OBJEXT) \\\n+\twctype-h.$(OBJEXT)\n libgnu_a_OBJECTS = $(am_libgnu_a_OBJECTS)\n LTLIBRARIES = $(noinst_LTLIBRARIES)\n AM_V_P = $(am__v_P_@AM_V@)\n@@ -1132,8 +1141,12 @@ LDFLAGS = @LDFLAGS@\n LIBGNU_LIBDEPS = @LIBGNU_LIBDEPS@\n LIBGNU_LTLIBDEPS = @LIBGNU_LTLIBDEPS@\n LIBINTL = @LIBINTL@\n+LIBMULTITHREAD = @LIBMULTITHREAD@\n LIBOBJS = @LIBOBJS@\n+LIBPTH = @LIBPTH@\n+LIBPTH_PREFIX = @LIBPTH_PREFIX@\n LIBS = @LIBS@\n+LIBTHREAD = @LIBTHREAD@\n LIMITS_H = @LIMITS_H@\n LN_S = @LN_S@\n LOCALCHARSET_TESTS_ENVIRONMENT = @LOCALCHARSET_TESTS_ENVIRONMENT@\n@@ -1142,7 +1155,10 @@ LOCALE_FR_UTF8 = @LOCALE_FR_UTF8@\n LOCALE_JA = @LOCALE_JA@\n LOCALE_ZH_CN = @LOCALE_ZH_CN@\n LTLIBINTL = @LTLIBINTL@\n+LTLIBMULTITHREAD = @LTLIBMULTITHREAD@\n LTLIBOBJS = @LTLIBOBJS@\n+LTLIBPTH = @LTLIBPTH@\n+LTLIBTHREAD = @LTLIBTHREAD@\n MAINT = @MAINT@\n MAKEINFO = @MAKEINFO@\n MKDIR_P = @MKDIR_P@\n@@ -1499,7 +1515,7 @@ target_vendor = @target_vendor@\n top_build_prefix = @top_build_prefix@\n top_builddir = @top_builddir@\n top_srcdir = @top_srcdir@\n-AUTOMAKE_OPTIONS = 1.9.6 gnits\n+AUTOMAKE_OPTIONS = 1.9.6 gnits subdir-objects\n SUBDIRS = \n noinst_HEADERS = \n noinst_LIBRARIES = libgnu.a\n@@ -1514,31 +1530,33 @@ EXTRA_DIST = m4/gnulib-cache.m4 alloca.c alloca.in.h arpa_inet.in.h \\\n \tfnmatch_loop.c fpucw.h frexp.c frexp.c frexpl.c fstat.c \\\n \tat-func.c fstatat.c getcwd.c getcwd-lgpl.c getdtablesize.c \\\n \tgetlogin_r.c gettimeofday.c glob-libc.h glob.c glob.in.h \\\n-\thard-locale.h inet_ntop.c intprops.h inttypes.in.h float+.h \\\n-\tisnan.c isnand-nolibm.h isnand.c float+.h isnan.c \\\n-\tisnanl-nolibm.h isnanl.c limits.in.h config.charset \\\n-\tref-add.sin ref-del.sin lstat.c malloc.c malloca.h \\\n-\tmalloca.valgrind math.in.h mbrtowc.c mbsinit.c \\\n-\tmbsrtowcs-impl.h mbsrtowcs-state.c mbsrtowcs.c memchr.c \\\n-\tmemchr.valgrind memmem.c str-two-way.h mempcpy.c memrchr.c \\\n-\tmkdir.c mkdtemp.c mkostemp.c msvc-inval.c msvc-inval.h \\\n-\tmsvc-nothrow.c msvc-nothrow.h netinet_in.in.h open.c openat.c \\\n-\topenat.h dirent-private.h opendir.c pathmax.h rawmemchr.c \\\n-\trawmemchr.valgrind dirent-private.h readdir.c readlink.c \\\n-\trealloc.c rename.c dirent-private.h rewinddir.c rmdir.c \\\n-\tsame-inode.h save-cwd.h secure_getenv.c setenv.c signal.in.h \\\n-\t$(top_srcdir)/import/extra/snippet/_Noreturn.h \\\n+\thard-locale.h $(top_srcdir)/import/extra/config.rpath \\\n+\tinet_ntop.c intprops.h inttypes.in.h float+.h isnan.c \\\n+\tisnand-nolibm.h isnand.c float+.h isnan.c isnanl-nolibm.h \\\n+\tisnanl.c limits.in.h config.charset ref-add.sin ref-del.sin \\\n+\tlstat.c malloc.c malloca.h malloca.valgrind math.in.h \\\n+\tmbrtowc.c mbsinit.c mbsrtowcs-impl.h mbsrtowcs-state.c \\\n+\tmbsrtowcs.c memchr.c memchr.valgrind memmem.c str-two-way.h \\\n+\tmempcpy.c memrchr.c mkdir.c mkdtemp.c mkostemp.c msvc-inval.c \\\n+\tmsvc-inval.h msvc-nothrow.c msvc-nothrow.h netinet_in.in.h \\\n+\topen.c openat.c openat.h dirent-private.h opendir.c pathmax.h \\\n+\trawmemchr.c rawmemchr.valgrind dirent-private.h readdir.c \\\n+\treadlink.c realloc.c rename.c dirent-private.h rewinddir.c \\\n+\trmdir.c same-inode.h save-cwd.h secure_getenv.c setenv.c \\\n+\tsignal.in.h $(top_srcdir)/import/extra/snippet/_Noreturn.h \\\n \t$(top_srcdir)/import/extra/snippet/arg-nonnull.h \\\n \t$(top_srcdir)/import/extra/snippet/c++defs.h \\\n \t$(top_srcdir)/import/extra/snippet/warn-on-use.h stat.c \\\n \tstdalign.in.h stdbool.in.h stddef.in.h stdint.in.h stdio.in.h \\\n \tstdlib.in.h strchrnul.c strchrnul.valgrind strdup.c streq.h \\\n-\tstrerror.c strerror-override.c strerror-override.h string.in.h \\\n-\tstr-two-way.h strstr.c strtok_r.c sys_socket.in.h \\\n-\tsys_stat.in.h sys_time.in.h sys_types.in.h sys_uio.in.h \\\n-\ttempname.h time.in.h unistd.in.h unistd--.h unistd-safer.h \\\n-\tunsetenv.c $(top_srcdir)/import/extra/update-copyright \\\n-\tverify.h wchar.in.h wctype.in.h\n+\tstrerror.c strerror-override.c strerror-override.h \\\n+\tstrerror_r.c string.in.h str-two-way.h strstr.c strtok_r.c \\\n+\tsys_socket.in.h sys_stat.in.h sys_time.in.h sys_types.in.h \\\n+\tsys_uio.in.h tempname.h \\\n+\t$(top_srcdir)/import/extra/config.rpath time.in.h unistd.in.h \\\n+\tunistd--.h unistd-safer.h unsetenv.c \\\n+\t$(top_srcdir)/import/extra/update-copyright verify.h \\\n+\twchar.in.h wctype.in.h\n \n # The BUILT_SOURCES created by this Makefile snippet are not used via #include\n # statements but through direct file reference. Therefore this snippet must be\n@@ -1580,9 +1598,10 @@ AM_CFLAGS =\n libgnu_a_SOURCES = cloexec.c dirname-lgpl.c basename-lgpl.c \\\n \tstripslash.c exitfail.c fd-hook.c filenamecat-lgpl.c \\\n \tgetprogname.h getprogname.c gettext.h hard-locale.c \\\n-\tlocalcharset.h localcharset.c malloca.c math.c openat-die.c \\\n-\tsave-cwd.c strnlen1.h strnlen1.c sys_socket.c tempname.c \\\n-\tunistd.c dup-safer.c fd-safer.c pipe-safer.c wctype-h.c\n+\tlocalcharset.h localcharset.c glthread/lock.h glthread/lock.c \\\n+\tmalloca.c math.c openat-die.c save-cwd.c strnlen1.h strnlen1.c \\\n+\tsys_socket.c tempname.c glthread/threadlib.c unistd.c \\\n+\tdup-safer.c fd-safer.c pipe-safer.c wctype-h.c\n libgnu_a_LIBADD = $(gl_LIBOBJS) @ALLOCA@\n libgnu_a_DEPENDENCIES = $(gl_LIBOBJS) @ALLOCA@\n EXTRA_libgnu_a_SOURCES = alloca.c openat-proc.c canonicalize-lgpl.c \\\n@@ -1597,7 +1616,8 @@ EXTRA_libgnu_a_SOURCES = alloca.c openat-proc.c canonicalize-lgpl.c \\\n \tmsvc-nothrow.c open.c openat.c opendir.c rawmemchr.c readdir.c \\\n \treadlink.c realloc.c rename.c rewinddir.c rmdir.c \\\n \tsecure_getenv.c setenv.c stat.c strchrnul.c strdup.c \\\n-\tstrerror.c strerror-override.c strstr.c strtok_r.c unsetenv.c\n+\tstrerror.c strerror-override.c strerror_r.c strstr.c \\\n+\tstrtok_r.c unsetenv.c\n \n # Use this preprocessor expression to decide whether #include_next works.\n # Do not rely on a 'configure'-time test for this, since the expression\n@@ -1650,6 +1670,16 @@ $(am__aclocal_m4_deps):\n \n clean-noinstLIBRARIES:\n \t-test -z \"$(noinst_LIBRARIES)\" || rm -f $(noinst_LIBRARIES)\n+glthread/$(am__dirstamp):\n+\t@$(MKDIR_P) glthread\n+\t@: > glthread/$(am__dirstamp)\n+glthread/$(DEPDIR)/$(am__dirstamp):\n+\t@$(MKDIR_P) glthread/$(DEPDIR)\n+\t@: > glthread/$(DEPDIR)/$(am__dirstamp)\n+glthread/lock.$(OBJEXT): glthread/$(am__dirstamp) \\\n+\tglthread/$(DEPDIR)/$(am__dirstamp)\n+glthread/threadlib.$(OBJEXT): glthread/$(am__dirstamp) \\\n+\tglthread/$(DEPDIR)/$(am__dirstamp)\n \n libgnu.a: $(libgnu_a_OBJECTS) $(libgnu_a_DEPENDENCIES) $(EXTRA_libgnu_a_DEPENDENCIES) \n \t$(AM_V_at)-rm -f libgnu.a\n@@ -1669,6 +1699,7 @@ clean-noinstLTLIBRARIES:\n \n mostlyclean-compile:\n \t-rm -f *.$(OBJEXT)\n+\t-rm -f glthread/*.$(OBJEXT)\n \n distclean-compile:\n \t-rm -f *.tab.c\n@@ -1753,6 +1784,7 @@ distclean-compile:\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strdup.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strerror-override.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strerror.Po@am__quote@\n+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strerror_r.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/stripslash.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strnlen1.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/strstr.Po@am__quote@\n@@ -1762,17 +1794,21 @@ distclean-compile:\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/unistd.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/unsetenv.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/wctype-h.Po@am__quote@\n+@AMDEP_TRUE@@am__include@ @am__quote@glthread/$(DEPDIR)/lock.Po@am__quote@\n+@AMDEP_TRUE@@am__include@ @am__quote@glthread/$(DEPDIR)/threadlib.Po@am__quote@\n \n .c.o:\n-@am__fastdepCC_TRUE@\t$(AM_V_CC)$(COMPILE) -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ $<\n-@am__fastdepCC_TRUE@\t$(AM_V_at)$(am__mv) $(DEPDIR)/$*.Tpo $(DEPDIR)/$*.Po\n+@am__fastdepCC_TRUE@\t$(AM_V_CC)depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\\.o$$||'`;\\\n+@am__fastdepCC_TRUE@\t$(COMPILE) -MT $@ -MD -MP -MF $$depbase.Tpo -c -o $@ $< &&\\\n+@am__fastdepCC_TRUE@\t$(am__mv) $$depbase.Tpo $$depbase.Po\n @AMDEP_TRUE@@am__fastdepCC_FALSE@\t$(AM_V_CC)source='$<' object='$@' libtool=no @AMDEPBACKSLASH@\n @AMDEP_TRUE@@am__fastdepCC_FALSE@\tDEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@\n @am__fastdepCC_FALSE@\t$(AM_V_CC@am__nodep@)$(COMPILE) -c -o $@ $<\n \n .c.obj:\n-@am__fastdepCC_TRUE@\t$(AM_V_CC)$(COMPILE) -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ `$(CYGPATH_W) '$<'`\n-@am__fastdepCC_TRUE@\t$(AM_V_at)$(am__mv) $(DEPDIR)/$*.Tpo $(DEPDIR)/$*.Po\n+@am__fastdepCC_TRUE@\t$(AM_V_CC)depbase=`echo $@ | sed 's|[^/]*$$|$(DEPDIR)/&|;s|\\.obj$$||'`;\\\n+@am__fastdepCC_TRUE@\t$(COMPILE) -MT $@ -MD -MP -MF $$depbase.Tpo -c -o $@ `$(CYGPATH_W) '$<'` &&\\\n+@am__fastdepCC_TRUE@\t$(am__mv) $$depbase.Tpo $$depbase.Po\n @AMDEP_TRUE@@am__fastdepCC_FALSE@\t$(AM_V_CC)source='$<' object='$@' libtool=no @AMDEPBACKSLASH@\n @AMDEP_TRUE@@am__fastdepCC_FALSE@\tDEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@\n @am__fastdepCC_FALSE@\t$(AM_V_CC@am__nodep@)$(COMPILE) -c -o $@ `$(CYGPATH_W) '$<'`\n@@ -1966,6 +2002,8 @@ clean-generic:\n distclean-generic:\n \t-test -z \"$(CONFIG_CLEAN_FILES)\" || rm -f $(CONFIG_CLEAN_FILES)\n \t-test . = \"$(srcdir)\" || test -z \"$(CONFIG_CLEAN_VPATH_FILES)\" || rm -f $(CONFIG_CLEAN_VPATH_FILES)\n+\t-rm -f glthread/$(DEPDIR)/$(am__dirstamp)\n+\t-rm -f glthread/$(am__dirstamp)\n \t-test -z \"$(DISTCLEANFILES)\" || rm -f $(DISTCLEANFILES)\n \n maintainer-clean-generic:\n@@ -1979,7 +2017,7 @@ clean-am: clean-generic clean-noinstLIBRARIES clean-noinstLTLIBRARIES \\\n \tmostlyclean-am\n \n distclean: distclean-recursive\n-\t-rm -rf ./$(DEPDIR)\n+\t-rm -rf ./$(DEPDIR) glthread/$(DEPDIR)\n \t-rm -f Makefile\n distclean-am: clean-am distclean-compile distclean-generic \\\n \tdistclean-tags\n@@ -2025,7 +2063,7 @@ install-ps-am:\n installcheck-am:\n \n maintainer-clean: maintainer-clean-recursive\n-\t-rm -rf ./$(DEPDIR)\n+\t-rm -rf ./$(DEPDIR) glthread/$(DEPDIR)\n \t-rm -f Makefile\n maintainer-clean-am: distclean-am maintainer-clean-generic\n "
    },
    {
      "sha": "98183ff2f2e37b97232cb93759d4a0023bab9e24",
      "filename": "gnulib/import/extra/config.rpath",
      "status": "added",
      "additions": 684,
      "deletions": 0,
      "changes": 684,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/extra/config.rpath",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/extra/config.rpath",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/extra/config.rpath?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,684 @@\n+#! /bin/sh\n+# Output a system dependent set of variables, describing how to set the\n+# run time search path of shared libraries in an executable.\n+#\n+#   Copyright 1996-2016 Free Software Foundation, Inc.\n+#   Taken from GNU libtool, 2001\n+#   Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996\n+#\n+#   This file is free software; the Free Software Foundation gives\n+#   unlimited permission to copy and/or distribute it, with or without\n+#   modifications, as long as this notice is preserved.\n+#\n+# The first argument passed to this file is the canonical host specification,\n+#    CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM\n+# or\n+#    CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM\n+# The environment variables CC, GCC, LDFLAGS, LD, with_gnu_ld\n+# should be set by the caller.\n+#\n+# The set of defined variables is at the end of this script.\n+\n+# Known limitations:\n+# - On IRIX 6.5 with CC=\"cc\", the run time search patch must not be longer\n+#   than 256 bytes, otherwise the compiler driver will dump core. The only\n+#   known workaround is to choose shorter directory names for the build\n+#   directory and/or the installation directory.\n+\n+# All known linkers require a '.a' archive for static linking (except MSVC,\n+# which needs '.lib').\n+libext=a\n+shrext=.so\n+\n+host=\"$1\"\n+host_cpu=`echo \"$host\" | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\1/'`\n+host_vendor=`echo \"$host\" | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\2/'`\n+host_os=`echo \"$host\" | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\3/'`\n+\n+# Code taken from libtool.m4's _LT_CC_BASENAME.\n+\n+for cc_temp in $CC\"\"; do\n+  case $cc_temp in\n+    compile | *[\\\\/]compile | ccache | *[\\\\/]ccache ) ;;\n+    distcc | *[\\\\/]distcc | purify | *[\\\\/]purify ) ;;\n+    \\-*) ;;\n+    *) break;;\n+  esac\n+done\n+cc_basename=`echo \"$cc_temp\" | sed -e 's%^.*/%%'`\n+\n+# Code taken from libtool.m4's _LT_COMPILER_PIC.\n+\n+wl=\n+if test \"$GCC\" = yes; then\n+  wl='-Wl,'\n+else\n+  case \"$host_os\" in\n+    aix*)\n+      wl='-Wl,'\n+      ;;\n+    mingw* | cygwin* | pw32* | os2* | cegcc*)\n+      ;;\n+    hpux9* | hpux10* | hpux11*)\n+      wl='-Wl,'\n+      ;;\n+    irix5* | irix6* | nonstopux*)\n+      wl='-Wl,'\n+      ;;\n+    linux* | k*bsd*-gnu | kopensolaris*-gnu)\n+      case $cc_basename in\n+        ecc*)\n+          wl='-Wl,'\n+          ;;\n+        icc* | ifort*)\n+          wl='-Wl,'\n+          ;;\n+        lf95*)\n+          wl='-Wl,'\n+          ;;\n+        nagfor*)\n+          wl='-Wl,-Wl,,'\n+          ;;\n+        pgcc* | pgf77* | pgf90* | pgf95* | pgfortran*)\n+          wl='-Wl,'\n+          ;;\n+        ccc*)\n+          wl='-Wl,'\n+          ;;\n+        xl* | bgxl* | bgf* | mpixl*)\n+          wl='-Wl,'\n+          ;;\n+        como)\n+          wl='-lopt='\n+          ;;\n+        *)\n+          case `$CC -V 2>&1 | sed 5q` in\n+            *Sun\\ F* | *Sun*Fortran*)\n+              wl=\n+              ;;\n+            *Sun\\ C*)\n+              wl='-Wl,'\n+              ;;\n+          esac\n+          ;;\n+      esac\n+      ;;\n+    newsos6)\n+      ;;\n+    *nto* | *qnx*)\n+      ;;\n+    osf3* | osf4* | osf5*)\n+      wl='-Wl,'\n+      ;;\n+    rdos*)\n+      ;;\n+    solaris*)\n+      case $cc_basename in\n+        f77* | f90* | f95* | sunf77* | sunf90* | sunf95*)\n+          wl='-Qoption ld '\n+          ;;\n+        *)\n+          wl='-Wl,'\n+          ;;\n+      esac\n+      ;;\n+    sunos4*)\n+      wl='-Qoption ld '\n+      ;;\n+    sysv4 | sysv4.2uw2* | sysv4.3*)\n+      wl='-Wl,'\n+      ;;\n+    sysv4*MP*)\n+      ;;\n+    sysv5* | unixware* | sco3.2v5* | sco5v6* | OpenUNIX*)\n+      wl='-Wl,'\n+      ;;\n+    unicos*)\n+      wl='-Wl,'\n+      ;;\n+    uts4*)\n+      ;;\n+  esac\n+fi\n+\n+# Code taken from libtool.m4's _LT_LINKER_SHLIBS.\n+\n+hardcode_libdir_flag_spec=\n+hardcode_libdir_separator=\n+hardcode_direct=no\n+hardcode_minus_L=no\n+\n+case \"$host_os\" in\n+  cygwin* | mingw* | pw32* | cegcc*)\n+    # FIXME: the MSVC++ port hasn't been tested in a loooong time\n+    # When not using gcc, we currently assume that we are using\n+    # Microsoft Visual C++.\n+    if test \"$GCC\" != yes; then\n+      with_gnu_ld=no\n+    fi\n+    ;;\n+  interix*)\n+    # we just hope/assume this is gcc and not c89 (= MSVC++)\n+    with_gnu_ld=yes\n+    ;;\n+  openbsd*)\n+    with_gnu_ld=no\n+    ;;\n+esac\n+\n+ld_shlibs=yes\n+if test \"$with_gnu_ld\" = yes; then\n+  # Set some defaults for GNU ld with shared library support. These\n+  # are reset later if shared libraries are not supported. Putting them\n+  # here allows them to be overridden if necessary.\n+  # Unlike libtool, we use -rpath here, not --rpath, since the documented\n+  # option of GNU ld is called -rpath, not --rpath.\n+  hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n+  case \"$host_os\" in\n+    aix[3-9]*)\n+      # On AIX/PPC, the GNU linker is very broken\n+      if test \"$host_cpu\" != ia64; then\n+        ld_shlibs=no\n+      fi\n+      ;;\n+    amigaos*)\n+      case \"$host_cpu\" in\n+        powerpc)\n+          ;;\n+        m68k)\n+          hardcode_libdir_flag_spec='-L$libdir'\n+          hardcode_minus_L=yes\n+          ;;\n+      esac\n+      ;;\n+    beos*)\n+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then\n+        :\n+      else\n+        ld_shlibs=no\n+      fi\n+      ;;\n+    cygwin* | mingw* | pw32* | cegcc*)\n+      # hardcode_libdir_flag_spec is actually meaningless, as there is\n+      # no search path for DLLs.\n+      hardcode_libdir_flag_spec='-L$libdir'\n+      if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then\n+        :\n+      else\n+        ld_shlibs=no\n+      fi\n+      ;;\n+    haiku*)\n+      ;;\n+    interix[3-9]*)\n+      hardcode_direct=no\n+      hardcode_libdir_flag_spec='${wl}-rpath,$libdir'\n+      ;;\n+    gnu* | linux* | tpf* | k*bsd*-gnu | kopensolaris*-gnu)\n+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then\n+        :\n+      else\n+        ld_shlibs=no\n+      fi\n+      ;;\n+    netbsd*)\n+      ;;\n+    solaris*)\n+      if $LD -v 2>&1 | grep 'BFD 2\\.8' > /dev/null; then\n+        ld_shlibs=no\n+      elif $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then\n+        :\n+      else\n+        ld_shlibs=no\n+      fi\n+      ;;\n+    sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX*)\n+      case `$LD -v 2>&1` in\n+        *\\ [01].* | *\\ 2.[0-9].* | *\\ 2.1[0-5].*)\n+          ld_shlibs=no\n+          ;;\n+        *)\n+          if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then\n+            hardcode_libdir_flag_spec='`test -z \"$SCOABSPATH\" && echo ${wl}-rpath,$libdir`'\n+          else\n+            ld_shlibs=no\n+          fi\n+          ;;\n+      esac\n+      ;;\n+    sunos4*)\n+      hardcode_direct=yes\n+      ;;\n+    *)\n+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then\n+        :\n+      else\n+        ld_shlibs=no\n+      fi\n+      ;;\n+  esac\n+  if test \"$ld_shlibs\" = no; then\n+    hardcode_libdir_flag_spec=\n+  fi\n+else\n+  case \"$host_os\" in\n+    aix3*)\n+      # Note: this linker hardcodes the directories in LIBPATH if there\n+      # are no directories specified by -L.\n+      hardcode_minus_L=yes\n+      if test \"$GCC\" = yes; then\n+        # Neither direct hardcoding nor static linking is supported with a\n+        # broken collect2.\n+        hardcode_direct=unsupported\n+      fi\n+      ;;\n+    aix[4-9]*)\n+      if test \"$host_cpu\" = ia64; then\n+        # On IA64, the linker does run time linking by default, so we don't\n+        # have to do anything special.\n+        aix_use_runtimelinking=no\n+      else\n+        aix_use_runtimelinking=no\n+        # Test if we are trying to use run time linking or normal\n+        # AIX style linking. If -brtl is somewhere in LDFLAGS, we\n+        # need to do runtime linking.\n+        case $host_os in aix4.[23]|aix4.[23].*|aix[5-9]*)\n+          for ld_flag in $LDFLAGS; do\n+            if (test $ld_flag = \"-brtl\" || test $ld_flag = \"-Wl,-brtl\"); then\n+              aix_use_runtimelinking=yes\n+              break\n+            fi\n+          done\n+          ;;\n+        esac\n+      fi\n+      hardcode_direct=yes\n+      hardcode_libdir_separator=':'\n+      if test \"$GCC\" = yes; then\n+        case $host_os in aix4.[012]|aix4.[012].*)\n+          collect2name=`${CC} -print-prog-name=collect2`\n+          if test -f \"$collect2name\" && \\\n+            strings \"$collect2name\" | grep resolve_lib_name >/dev/null\n+          then\n+            # We have reworked collect2\n+            :\n+          else\n+            # We have old collect2\n+            hardcode_direct=unsupported\n+            hardcode_minus_L=yes\n+            hardcode_libdir_flag_spec='-L$libdir'\n+            hardcode_libdir_separator=\n+          fi\n+          ;;\n+        esac\n+      fi\n+      # Begin _LT_AC_SYS_LIBPATH_AIX.\n+      echo 'int main () { return 0; }' > conftest.c\n+      ${CC} ${LDFLAGS} conftest.c -o conftest\n+      aix_libpath=`dump -H conftest 2>/dev/null | sed -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\\(.*\\)$/\\1/; p; }\n+}'`\n+      if test -z \"$aix_libpath\"; then\n+        aix_libpath=`dump -HX64 conftest 2>/dev/null | sed -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\\(.*\\)$/\\1/; p; }\n+}'`\n+      fi\n+      if test -z \"$aix_libpath\"; then\n+        aix_libpath=\"/usr/lib:/lib\"\n+      fi\n+      rm -f conftest.c conftest\n+      # End _LT_AC_SYS_LIBPATH_AIX.\n+      if test \"$aix_use_runtimelinking\" = yes; then\n+        hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:'\"$aix_libpath\"\n+      else\n+        if test \"$host_cpu\" = ia64; then\n+          hardcode_libdir_flag_spec='${wl}-R $libdir:/usr/lib:/lib'\n+        else\n+          hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:'\"$aix_libpath\"\n+        fi\n+      fi\n+      ;;\n+    amigaos*)\n+      case \"$host_cpu\" in\n+        powerpc)\n+          ;;\n+        m68k)\n+          hardcode_libdir_flag_spec='-L$libdir'\n+          hardcode_minus_L=yes\n+          ;;\n+      esac\n+      ;;\n+    bsdi[45]*)\n+      ;;\n+    cygwin* | mingw* | pw32* | cegcc*)\n+      # When not using gcc, we currently assume that we are using\n+      # Microsoft Visual C++.\n+      # hardcode_libdir_flag_spec is actually meaningless, as there is\n+      # no search path for DLLs.\n+      hardcode_libdir_flag_spec=' '\n+      libext=lib\n+      ;;\n+    darwin* | rhapsody*)\n+      hardcode_direct=no\n+      if { case $cc_basename in ifort*) true;; *) test \"$GCC\" = yes;; esac; }; then\n+        :\n+      else\n+        ld_shlibs=no\n+      fi\n+      ;;\n+    dgux*)\n+      hardcode_libdir_flag_spec='-L$libdir'\n+      ;;\n+    freebsd2.[01]*)\n+      hardcode_direct=yes\n+      hardcode_minus_L=yes\n+      ;;\n+    freebsd* | dragonfly*)\n+      hardcode_libdir_flag_spec='-R$libdir'\n+      hardcode_direct=yes\n+      ;;\n+    hpux9*)\n+      hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'\n+      hardcode_libdir_separator=:\n+      hardcode_direct=yes\n+      # hardcode_minus_L: Not really in the search PATH,\n+      # but as the default location of the library.\n+      hardcode_minus_L=yes\n+      ;;\n+    hpux10*)\n+      if test \"$with_gnu_ld\" = no; then\n+        hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'\n+        hardcode_libdir_separator=:\n+        hardcode_direct=yes\n+        # hardcode_minus_L: Not really in the search PATH,\n+        # but as the default location of the library.\n+        hardcode_minus_L=yes\n+      fi\n+      ;;\n+    hpux11*)\n+      if test \"$with_gnu_ld\" = no; then\n+        hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'\n+        hardcode_libdir_separator=:\n+        case $host_cpu in\n+          hppa*64*|ia64*)\n+            hardcode_direct=no\n+            ;;\n+          *)\n+            hardcode_direct=yes\n+            # hardcode_minus_L: Not really in the search PATH,\n+            # but as the default location of the library.\n+            hardcode_minus_L=yes\n+            ;;\n+        esac\n+      fi\n+      ;;\n+    irix5* | irix6* | nonstopux*)\n+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n+      hardcode_libdir_separator=:\n+      ;;\n+    netbsd*)\n+      hardcode_libdir_flag_spec='-R$libdir'\n+      hardcode_direct=yes\n+      ;;\n+    newsos6)\n+      hardcode_direct=yes\n+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n+      hardcode_libdir_separator=:\n+      ;;\n+    *nto* | *qnx*)\n+      ;;\n+    openbsd*)\n+      if test -f /usr/libexec/ld.so; then\n+        hardcode_direct=yes\n+        if test -z \"`echo __ELF__ | $CC -E - | grep __ELF__`\" || test \"$host_os-$host_cpu\" = \"openbsd2.8-powerpc\"; then\n+          hardcode_libdir_flag_spec='${wl}-rpath,$libdir'\n+        else\n+          case \"$host_os\" in\n+            openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)\n+              hardcode_libdir_flag_spec='-R$libdir'\n+              ;;\n+            *)\n+              hardcode_libdir_flag_spec='${wl}-rpath,$libdir'\n+              ;;\n+          esac\n+        fi\n+      else\n+        ld_shlibs=no\n+      fi\n+      ;;\n+    os2*)\n+      hardcode_libdir_flag_spec='-L$libdir'\n+      hardcode_minus_L=yes\n+      ;;\n+    osf3*)\n+      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n+      hardcode_libdir_separator=:\n+      ;;\n+    osf4* | osf5*)\n+      if test \"$GCC\" = yes; then\n+        hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n+      else\n+        # Both cc and cxx compiler support -rpath directly\n+        hardcode_libdir_flag_spec='-rpath $libdir'\n+      fi\n+      hardcode_libdir_separator=:\n+      ;;\n+    solaris*)\n+      hardcode_libdir_flag_spec='-R$libdir'\n+      ;;\n+    sunos4*)\n+      hardcode_libdir_flag_spec='-L$libdir'\n+      hardcode_direct=yes\n+      hardcode_minus_L=yes\n+      ;;\n+    sysv4)\n+      case $host_vendor in\n+        sni)\n+          hardcode_direct=yes # is this really true???\n+          ;;\n+        siemens)\n+          hardcode_direct=no\n+          ;;\n+        motorola)\n+          hardcode_direct=no #Motorola manual says yes, but my tests say they lie\n+          ;;\n+      esac\n+      ;;\n+    sysv4.3*)\n+      ;;\n+    sysv4*MP*)\n+      if test -d /usr/nec; then\n+        ld_shlibs=yes\n+      fi\n+      ;;\n+    sysv4*uw2* | sysv5OpenUNIX* | sysv5UnixWare7.[01].[10]* | unixware7* | sco3.2v5.0.[024]*)\n+      ;;\n+    sysv5* | sco3.2v5* | sco5v6*)\n+      hardcode_libdir_flag_spec='`test -z \"$SCOABSPATH\" && echo ${wl}-R,$libdir`'\n+      hardcode_libdir_separator=':'\n+      ;;\n+    uts4*)\n+      hardcode_libdir_flag_spec='-L$libdir'\n+      ;;\n+    *)\n+      ld_shlibs=no\n+      ;;\n+  esac\n+fi\n+\n+# Check dynamic linker characteristics\n+# Code taken from libtool.m4's _LT_SYS_DYNAMIC_LINKER.\n+# Unlike libtool.m4, here we don't care about _all_ names of the library, but\n+# only about the one the linker finds when passed -lNAME. This is the last\n+# element of library_names_spec in libtool.m4, or possibly two of them if the\n+# linker has special search rules.\n+library_names_spec=      # the last element of library_names_spec in libtool.m4\n+libname_spec='lib$name'\n+case \"$host_os\" in\n+  aix3*)\n+    library_names_spec='$libname.a'\n+    ;;\n+  aix[4-9]*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  amigaos*)\n+    case \"$host_cpu\" in\n+      powerpc*)\n+        library_names_spec='$libname$shrext' ;;\n+      m68k)\n+        library_names_spec='$libname.a' ;;\n+    esac\n+    ;;\n+  beos*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  bsdi[45]*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  cygwin* | mingw* | pw32* | cegcc*)\n+    shrext=.dll\n+    library_names_spec='$libname.dll.a $libname.lib'\n+    ;;\n+  darwin* | rhapsody*)\n+    shrext=.dylib\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  dgux*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  freebsd[23].*)\n+    library_names_spec='$libname$shrext$versuffix'\n+    ;;\n+  freebsd* | dragonfly*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  gnu*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  haiku*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  hpux9* | hpux10* | hpux11*)\n+    case $host_cpu in\n+      ia64*)\n+        shrext=.so\n+        ;;\n+      hppa*64*)\n+        shrext=.sl\n+        ;;\n+      *)\n+        shrext=.sl\n+        ;;\n+    esac\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  interix[3-9]*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  irix5* | irix6* | nonstopux*)\n+    library_names_spec='$libname$shrext'\n+    case \"$host_os\" in\n+      irix5* | nonstopux*)\n+        libsuff= shlibsuff=\n+        ;;\n+      *)\n+        case $LD in\n+          *-32|*\"-32 \"|*-melf32bsmip|*\"-melf32bsmip \") libsuff= shlibsuff= ;;\n+          *-n32|*\"-n32 \"|*-melf32bmipn32|*\"-melf32bmipn32 \") libsuff=32 shlibsuff=N32 ;;\n+          *-64|*\"-64 \"|*-melf64bmip|*\"-melf64bmip \") libsuff=64 shlibsuff=64 ;;\n+          *) libsuff= shlibsuff= ;;\n+        esac\n+        ;;\n+    esac\n+    ;;\n+  linux*oldld* | linux*aout* | linux*coff*)\n+    ;;\n+  linux* | k*bsd*-gnu | kopensolaris*-gnu)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  knetbsd*-gnu)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  netbsd*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  newsos6)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  *nto* | *qnx*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  openbsd*)\n+    library_names_spec='$libname$shrext$versuffix'\n+    ;;\n+  os2*)\n+    libname_spec='$name'\n+    shrext=.dll\n+    library_names_spec='$libname.a'\n+    ;;\n+  osf3* | osf4* | osf5*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  rdos*)\n+    ;;\n+  solaris*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  sunos4*)\n+    library_names_spec='$libname$shrext$versuffix'\n+    ;;\n+  sysv4 | sysv4.3*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  sysv4*MP*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  sysv5* | sco3.2v5* | sco5v6* | unixware* | OpenUNIX* | sysv4*uw2*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  tpf*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+  uts4*)\n+    library_names_spec='$libname$shrext'\n+    ;;\n+esac\n+\n+sed_quote_subst='s/\\([\"`$\\\\]\\)/\\\\\\1/g'\n+escaped_wl=`echo \"X$wl\" | sed -e 's/^X//' -e \"$sed_quote_subst\"`\n+shlibext=`echo \"$shrext\" | sed -e 's,^\\.,,'`\n+escaped_libname_spec=`echo \"X$libname_spec\" | sed -e 's/^X//' -e \"$sed_quote_subst\"`\n+escaped_library_names_spec=`echo \"X$library_names_spec\" | sed -e 's/^X//' -e \"$sed_quote_subst\"`\n+escaped_hardcode_libdir_flag_spec=`echo \"X$hardcode_libdir_flag_spec\" | sed -e 's/^X//' -e \"$sed_quote_subst\"`\n+\n+LC_ALL=C sed -e 's/^\\([a-zA-Z0-9_]*\\)=/acl_cv_\\1=/' <<EOF\n+\n+# How to pass a linker flag through the compiler.\n+wl=\"$escaped_wl\"\n+\n+# Static library suffix (normally \"a\").\n+libext=\"$libext\"\n+\n+# Shared library suffix (normally \"so\").\n+shlibext=\"$shlibext\"\n+\n+# Format of library name prefix.\n+libname_spec=\"$escaped_libname_spec\"\n+\n+# Library names that the linker finds when passed -lNAME.\n+library_names_spec=\"$escaped_library_names_spec\"\n+\n+# Flag to hardcode \\$libdir into a binary during linking.\n+# This must work even if \\$libdir does not exist.\n+hardcode_libdir_flag_spec=\"$escaped_hardcode_libdir_flag_spec\"\n+\n+# Whether we need a single -rpath flag with a separated argument.\n+hardcode_libdir_separator=\"$hardcode_libdir_separator\"\n+\n+# Set to yes if using DIR/libNAME.so during linking hardcodes DIR into the\n+# resulting binary.\n+hardcode_direct=\"$hardcode_direct\"\n+\n+# Set to yes if using the -LDIR flag during linking hardcodes DIR into the\n+# resulting binary.\n+hardcode_minus_L=\"$hardcode_minus_L\"\n+\n+EOF"
    },
    {
      "sha": "935043b1a2eca58ee927c8fb78c875ac8b7be277",
      "filename": "gnulib/import/glthread/lock.c",
      "status": "added",
      "additions": 1057,
      "deletions": 0,
      "changes": 1057,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/glthread/lock.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/glthread/lock.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/glthread/lock.c?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,1057 @@\n+/* Locking in multithreaded situations.\n+   Copyright (C) 2005-2016 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program; if not, see <http://www.gnu.org/licenses/>.  */\n+\n+/* Written by Bruno Haible <bruno@clisp.org>, 2005.\n+   Based on GCC's gthr-posix.h, gthr-posix95.h, gthr-solaris.h,\n+   gthr-win32.h.  */\n+\n+#include <config.h>\n+\n+#include \"glthread/lock.h\"\n+\n+/* ========================================================================= */\n+\n+#if USE_POSIX_THREADS\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+# if HAVE_PTHREAD_RWLOCK\n+\n+#  if !defined PTHREAD_RWLOCK_INITIALIZER\n+\n+int\n+glthread_rwlock_init_multithreaded (gl_rwlock_t *lock)\n+{\n+  int err;\n+\n+  err = pthread_rwlock_init (&lock->rwlock, NULL);\n+  if (err != 0)\n+    return err;\n+  lock->initialized = 1;\n+  return 0;\n+}\n+\n+int\n+glthread_rwlock_rdlock_multithreaded (gl_rwlock_t *lock)\n+{\n+  if (!lock->initialized)\n+    {\n+      int err;\n+\n+      err = pthread_mutex_lock (&lock->guard);\n+      if (err != 0)\n+        return err;\n+      if (!lock->initialized)\n+        {\n+          err = glthread_rwlock_init_multithreaded (lock);\n+          if (err != 0)\n+            {\n+              pthread_mutex_unlock (&lock->guard);\n+              return err;\n+            }\n+        }\n+      err = pthread_mutex_unlock (&lock->guard);\n+      if (err != 0)\n+        return err;\n+    }\n+  return pthread_rwlock_rdlock (&lock->rwlock);\n+}\n+\n+int\n+glthread_rwlock_wrlock_multithreaded (gl_rwlock_t *lock)\n+{\n+  if (!lock->initialized)\n+    {\n+      int err;\n+\n+      err = pthread_mutex_lock (&lock->guard);\n+      if (err != 0)\n+        return err;\n+      if (!lock->initialized)\n+        {\n+          err = glthread_rwlock_init_multithreaded (lock);\n+          if (err != 0)\n+            {\n+              pthread_mutex_unlock (&lock->guard);\n+              return err;\n+            }\n+        }\n+      err = pthread_mutex_unlock (&lock->guard);\n+      if (err != 0)\n+        return err;\n+    }\n+  return pthread_rwlock_wrlock (&lock->rwlock);\n+}\n+\n+int\n+glthread_rwlock_unlock_multithreaded (gl_rwlock_t *lock)\n+{\n+  if (!lock->initialized)\n+    return EINVAL;\n+  return pthread_rwlock_unlock (&lock->rwlock);\n+}\n+\n+int\n+glthread_rwlock_destroy_multithreaded (gl_rwlock_t *lock)\n+{\n+  int err;\n+\n+  if (!lock->initialized)\n+    return EINVAL;\n+  err = pthread_rwlock_destroy (&lock->rwlock);\n+  if (err != 0)\n+    return err;\n+  lock->initialized = 0;\n+  return 0;\n+}\n+\n+#  endif\n+\n+# else\n+\n+int\n+glthread_rwlock_init_multithreaded (gl_rwlock_t *lock)\n+{\n+  int err;\n+\n+  err = pthread_mutex_init (&lock->lock, NULL);\n+  if (err != 0)\n+    return err;\n+  err = pthread_cond_init (&lock->waiting_readers, NULL);\n+  if (err != 0)\n+    return err;\n+  err = pthread_cond_init (&lock->waiting_writers, NULL);\n+  if (err != 0)\n+    return err;\n+  lock->waiting_writers_count = 0;\n+  lock->runcount = 0;\n+  return 0;\n+}\n+\n+int\n+glthread_rwlock_rdlock_multithreaded (gl_rwlock_t *lock)\n+{\n+  int err;\n+\n+  err = pthread_mutex_lock (&lock->lock);\n+  if (err != 0)\n+    return err;\n+  /* Test whether only readers are currently running, and whether the runcount\n+     field will not overflow.  */\n+  /* POSIX says: \"It is implementation-defined whether the calling thread\n+     acquires the lock when a writer does not hold the lock and there are\n+     writers blocked on the lock.\"  Let's say, no: give the writers a higher\n+     priority.  */\n+  while (!(lock->runcount + 1 > 0 && lock->waiting_writers_count == 0))\n+    {\n+      /* This thread has to wait for a while.  Enqueue it among the\n+         waiting_readers.  */\n+      err = pthread_cond_wait (&lock->waiting_readers, &lock->lock);\n+      if (err != 0)\n+        {\n+          pthread_mutex_unlock (&lock->lock);\n+          return err;\n+        }\n+    }\n+  lock->runcount++;\n+  return pthread_mutex_unlock (&lock->lock);\n+}\n+\n+int\n+glthread_rwlock_wrlock_multithreaded (gl_rwlock_t *lock)\n+{\n+  int err;\n+\n+  err = pthread_mutex_lock (&lock->lock);\n+  if (err != 0)\n+    return err;\n+  /* Test whether no readers or writers are currently running.  */\n+  while (!(lock->runcount == 0))\n+    {\n+      /* This thread has to wait for a while.  Enqueue it among the\n+         waiting_writers.  */\n+      lock->waiting_writers_count++;\n+      err = pthread_cond_wait (&lock->waiting_writers, &lock->lock);\n+      if (err != 0)\n+        {\n+          lock->waiting_writers_count--;\n+          pthread_mutex_unlock (&lock->lock);\n+          return err;\n+        }\n+      lock->waiting_writers_count--;\n+    }\n+  lock->runcount--; /* runcount becomes -1 */\n+  return pthread_mutex_unlock (&lock->lock);\n+}\n+\n+int\n+glthread_rwlock_unlock_multithreaded (gl_rwlock_t *lock)\n+{\n+  int err;\n+\n+  err = pthread_mutex_lock (&lock->lock);\n+  if (err != 0)\n+    return err;\n+  if (lock->runcount < 0)\n+    {\n+      /* Drop a writer lock.  */\n+      if (!(lock->runcount == -1))\n+        {\n+          pthread_mutex_unlock (&lock->lock);\n+          return EINVAL;\n+        }\n+      lock->runcount = 0;\n+    }\n+  else\n+    {\n+      /* Drop a reader lock.  */\n+      if (!(lock->runcount > 0))\n+        {\n+          pthread_mutex_unlock (&lock->lock);\n+          return EINVAL;\n+        }\n+      lock->runcount--;\n+    }\n+  if (lock->runcount == 0)\n+    {\n+      /* POSIX recommends that \"write locks shall take precedence over read\n+         locks\", to avoid \"writer starvation\".  */\n+      if (lock->waiting_writers_count > 0)\n+        {\n+          /* Wake up one of the waiting writers.  */\n+          err = pthread_cond_signal (&lock->waiting_writers);\n+          if (err != 0)\n+            {\n+              pthread_mutex_unlock (&lock->lock);\n+              return err;\n+            }\n+        }\n+      else\n+        {\n+          /* Wake up all waiting readers.  */\n+          err = pthread_cond_broadcast (&lock->waiting_readers);\n+          if (err != 0)\n+            {\n+              pthread_mutex_unlock (&lock->lock);\n+              return err;\n+            }\n+        }\n+    }\n+  return pthread_mutex_unlock (&lock->lock);\n+}\n+\n+int\n+glthread_rwlock_destroy_multithreaded (gl_rwlock_t *lock)\n+{\n+  int err;\n+\n+  err = pthread_mutex_destroy (&lock->lock);\n+  if (err != 0)\n+    return err;\n+  err = pthread_cond_destroy (&lock->waiting_readers);\n+  if (err != 0)\n+    return err;\n+  err = pthread_cond_destroy (&lock->waiting_writers);\n+  if (err != 0)\n+    return err;\n+  return 0;\n+}\n+\n+# endif\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+# if HAVE_PTHREAD_MUTEX_RECURSIVE\n+\n+#  if defined PTHREAD_RECURSIVE_MUTEX_INITIALIZER || defined PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP\n+\n+int\n+glthread_recursive_lock_init_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  pthread_mutexattr_t attributes;\n+  int err;\n+\n+  err = pthread_mutexattr_init (&attributes);\n+  if (err != 0)\n+    return err;\n+  err = pthread_mutexattr_settype (&attributes, PTHREAD_MUTEX_RECURSIVE);\n+  if (err != 0)\n+    {\n+      pthread_mutexattr_destroy (&attributes);\n+      return err;\n+    }\n+  err = pthread_mutex_init (lock, &attributes);\n+  if (err != 0)\n+    {\n+      pthread_mutexattr_destroy (&attributes);\n+      return err;\n+    }\n+  err = pthread_mutexattr_destroy (&attributes);\n+  if (err != 0)\n+    return err;\n+  return 0;\n+}\n+\n+#  else\n+\n+int\n+glthread_recursive_lock_init_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  pthread_mutexattr_t attributes;\n+  int err;\n+\n+  err = pthread_mutexattr_init (&attributes);\n+  if (err != 0)\n+    return err;\n+  err = pthread_mutexattr_settype (&attributes, PTHREAD_MUTEX_RECURSIVE);\n+  if (err != 0)\n+    {\n+      pthread_mutexattr_destroy (&attributes);\n+      return err;\n+    }\n+  err = pthread_mutex_init (&lock->recmutex, &attributes);\n+  if (err != 0)\n+    {\n+      pthread_mutexattr_destroy (&attributes);\n+      return err;\n+    }\n+  err = pthread_mutexattr_destroy (&attributes);\n+  if (err != 0)\n+    return err;\n+  lock->initialized = 1;\n+  return 0;\n+}\n+\n+int\n+glthread_recursive_lock_lock_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  if (!lock->initialized)\n+    {\n+      int err;\n+\n+      err = pthread_mutex_lock (&lock->guard);\n+      if (err != 0)\n+        return err;\n+      if (!lock->initialized)\n+        {\n+          err = glthread_recursive_lock_init_multithreaded (lock);\n+          if (err != 0)\n+            {\n+              pthread_mutex_unlock (&lock->guard);\n+              return err;\n+            }\n+        }\n+      err = pthread_mutex_unlock (&lock->guard);\n+      if (err != 0)\n+        return err;\n+    }\n+  return pthread_mutex_lock (&lock->recmutex);\n+}\n+\n+int\n+glthread_recursive_lock_unlock_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  if (!lock->initialized)\n+    return EINVAL;\n+  return pthread_mutex_unlock (&lock->recmutex);\n+}\n+\n+int\n+glthread_recursive_lock_destroy_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  int err;\n+\n+  if (!lock->initialized)\n+    return EINVAL;\n+  err = pthread_mutex_destroy (&lock->recmutex);\n+  if (err != 0)\n+    return err;\n+  lock->initialized = 0;\n+  return 0;\n+}\n+\n+#  endif\n+\n+# else\n+\n+int\n+glthread_recursive_lock_init_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  int err;\n+\n+  err = pthread_mutex_init (&lock->mutex, NULL);\n+  if (err != 0)\n+    return err;\n+  lock->owner = (pthread_t) 0;\n+  lock->depth = 0;\n+  return 0;\n+}\n+\n+int\n+glthread_recursive_lock_lock_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  pthread_t self = pthread_self ();\n+  if (lock->owner != self)\n+    {\n+      int err;\n+\n+      err = pthread_mutex_lock (&lock->mutex);\n+      if (err != 0)\n+        return err;\n+      lock->owner = self;\n+    }\n+  if (++(lock->depth) == 0) /* wraparound? */\n+    {\n+      lock->depth--;\n+      return EAGAIN;\n+    }\n+  return 0;\n+}\n+\n+int\n+glthread_recursive_lock_unlock_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  if (lock->owner != pthread_self ())\n+    return EPERM;\n+  if (lock->depth == 0)\n+    return EINVAL;\n+  if (--(lock->depth) == 0)\n+    {\n+      lock->owner = (pthread_t) 0;\n+      return pthread_mutex_unlock (&lock->mutex);\n+    }\n+  else\n+    return 0;\n+}\n+\n+int\n+glthread_recursive_lock_destroy_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  if (lock->owner != (pthread_t) 0)\n+    return EBUSY;\n+  return pthread_mutex_destroy (&lock->mutex);\n+}\n+\n+# endif\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+static const pthread_once_t fresh_once = PTHREAD_ONCE_INIT;\n+\n+int\n+glthread_once_singlethreaded (pthread_once_t *once_control)\n+{\n+  /* We don't know whether pthread_once_t is an integer type, a floating-point\n+     type, a pointer type, or a structure type.  */\n+  char *firstbyte = (char *)once_control;\n+  if (*firstbyte == *(const char *)&fresh_once)\n+    {\n+      /* First time use of once_control.  Invert the first byte.  */\n+      *firstbyte = ~ *(const char *)&fresh_once;\n+      return 1;\n+    }\n+  else\n+    return 0;\n+}\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+#if USE_PTH_THREADS\n+\n+/* Use the GNU Pth threads library.  */\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+static void\n+glthread_once_call (void *arg)\n+{\n+  void (**gl_once_temp_addr) (void) = (void (**) (void)) arg;\n+  void (*initfunction) (void) = *gl_once_temp_addr;\n+  initfunction ();\n+}\n+\n+int\n+glthread_once_multithreaded (pth_once_t *once_control, void (*initfunction) (void))\n+{\n+  void (*temp) (void) = initfunction;\n+  return (!pth_once (once_control, glthread_once_call, &temp) ? errno : 0);\n+}\n+\n+int\n+glthread_once_singlethreaded (pth_once_t *once_control)\n+{\n+  /* We know that pth_once_t is an integer type.  */\n+  if (*once_control == PTH_ONCE_INIT)\n+    {\n+      /* First time use of once_control.  Invert the marker.  */\n+      *once_control = ~ PTH_ONCE_INIT;\n+      return 1;\n+    }\n+  else\n+    return 0;\n+}\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+#if USE_SOLARIS_THREADS\n+\n+/* Use the old Solaris threads library.  */\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+int\n+glthread_recursive_lock_init_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  int err;\n+\n+  err = mutex_init (&lock->mutex, USYNC_THREAD, NULL);\n+  if (err != 0)\n+    return err;\n+  lock->owner = (thread_t) 0;\n+  lock->depth = 0;\n+  return 0;\n+}\n+\n+int\n+glthread_recursive_lock_lock_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  thread_t self = thr_self ();\n+  if (lock->owner != self)\n+    {\n+      int err;\n+\n+      err = mutex_lock (&lock->mutex);\n+      if (err != 0)\n+        return err;\n+      lock->owner = self;\n+    }\n+  if (++(lock->depth) == 0) /* wraparound? */\n+    {\n+      lock->depth--;\n+      return EAGAIN;\n+    }\n+  return 0;\n+}\n+\n+int\n+glthread_recursive_lock_unlock_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  if (lock->owner != thr_self ())\n+    return EPERM;\n+  if (lock->depth == 0)\n+    return EINVAL;\n+  if (--(lock->depth) == 0)\n+    {\n+      lock->owner = (thread_t) 0;\n+      return mutex_unlock (&lock->mutex);\n+    }\n+  else\n+    return 0;\n+}\n+\n+int\n+glthread_recursive_lock_destroy_multithreaded (gl_recursive_lock_t *lock)\n+{\n+  if (lock->owner != (thread_t) 0)\n+    return EBUSY;\n+  return mutex_destroy (&lock->mutex);\n+}\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+int\n+glthread_once_multithreaded (gl_once_t *once_control, void (*initfunction) (void))\n+{\n+  if (!once_control->inited)\n+    {\n+      int err;\n+\n+      /* Use the mutex to guarantee that if another thread is already calling\n+         the initfunction, this thread waits until it's finished.  */\n+      err = mutex_lock (&once_control->mutex);\n+      if (err != 0)\n+        return err;\n+      if (!once_control->inited)\n+        {\n+          once_control->inited = 1;\n+          initfunction ();\n+        }\n+      return mutex_unlock (&once_control->mutex);\n+    }\n+  else\n+    return 0;\n+}\n+\n+int\n+glthread_once_singlethreaded (gl_once_t *once_control)\n+{\n+  /* We know that gl_once_t contains an integer type.  */\n+  if (!once_control->inited)\n+    {\n+      /* First time use of once_control.  Invert the marker.  */\n+      once_control->inited = ~ 0;\n+      return 1;\n+    }\n+  else\n+    return 0;\n+}\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+#if USE_WINDOWS_THREADS\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+void\n+glthread_lock_init_func (gl_lock_t *lock)\n+{\n+  InitializeCriticalSection (&lock->lock);\n+  lock->guard.done = 1;\n+}\n+\n+int\n+glthread_lock_lock_func (gl_lock_t *lock)\n+{\n+  if (!lock->guard.done)\n+    {\n+      if (InterlockedIncrement (&lock->guard.started) == 0)\n+        /* This thread is the first one to need this lock.  Initialize it.  */\n+        glthread_lock_init (lock);\n+      else\n+        /* Yield the CPU while waiting for another thread to finish\n+           initializing this lock.  */\n+        while (!lock->guard.done)\n+          Sleep (0);\n+    }\n+  EnterCriticalSection (&lock->lock);\n+  return 0;\n+}\n+\n+int\n+glthread_lock_unlock_func (gl_lock_t *lock)\n+{\n+  if (!lock->guard.done)\n+    return EINVAL;\n+  LeaveCriticalSection (&lock->lock);\n+  return 0;\n+}\n+\n+int\n+glthread_lock_destroy_func (gl_lock_t *lock)\n+{\n+  if (!lock->guard.done)\n+    return EINVAL;\n+  DeleteCriticalSection (&lock->lock);\n+  lock->guard.done = 0;\n+  return 0;\n+}\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+/* In this file, the waitqueues are implemented as circular arrays.  */\n+#define gl_waitqueue_t gl_carray_waitqueue_t\n+\n+static void\n+gl_waitqueue_init (gl_waitqueue_t *wq)\n+{\n+  wq->array = NULL;\n+  wq->count = 0;\n+  wq->alloc = 0;\n+  wq->offset = 0;\n+}\n+\n+/* Enqueues the current thread, represented by an event, in a wait queue.\n+   Returns INVALID_HANDLE_VALUE if an allocation failure occurs.  */\n+static HANDLE\n+gl_waitqueue_add (gl_waitqueue_t *wq)\n+{\n+  HANDLE event;\n+  unsigned int index;\n+\n+  if (wq->count == wq->alloc)\n+    {\n+      unsigned int new_alloc = 2 * wq->alloc + 1;\n+      HANDLE *new_array =\n+        (HANDLE *) realloc (wq->array, new_alloc * sizeof (HANDLE));\n+      if (new_array == NULL)\n+        /* No more memory.  */\n+        return INVALID_HANDLE_VALUE;\n+      /* Now is a good opportunity to rotate the array so that its contents\n+         starts at offset 0.  */\n+      if (wq->offset > 0)\n+        {\n+          unsigned int old_count = wq->count;\n+          unsigned int old_alloc = wq->alloc;\n+          unsigned int old_offset = wq->offset;\n+          unsigned int i;\n+          if (old_offset + old_count > old_alloc)\n+            {\n+              unsigned int limit = old_offset + old_count - old_alloc;\n+              for (i = 0; i < limit; i++)\n+                new_array[old_alloc + i] = new_array[i];\n+            }\n+          for (i = 0; i < old_count; i++)\n+            new_array[i] = new_array[old_offset + i];\n+          wq->offset = 0;\n+        }\n+      wq->array = new_array;\n+      wq->alloc = new_alloc;\n+    }\n+  /* Whether the created event is a manual-reset one or an auto-reset one,\n+     does not matter, since we will wait on it only once.  */\n+  event = CreateEvent (NULL, TRUE, FALSE, NULL);\n+  if (event == INVALID_HANDLE_VALUE)\n+    /* No way to allocate an event.  */\n+    return INVALID_HANDLE_VALUE;\n+  index = wq->offset + wq->count;\n+  if (index >= wq->alloc)\n+    index -= wq->alloc;\n+  wq->array[index] = event;\n+  wq->count++;\n+  return event;\n+}\n+\n+/* Notifies the first thread from a wait queue and dequeues it.  */\n+static void\n+gl_waitqueue_notify_first (gl_waitqueue_t *wq)\n+{\n+  SetEvent (wq->array[wq->offset + 0]);\n+  wq->offset++;\n+  wq->count--;\n+  if (wq->count == 0 || wq->offset == wq->alloc)\n+    wq->offset = 0;\n+}\n+\n+/* Notifies all threads from a wait queue and dequeues them all.  */\n+static void\n+gl_waitqueue_notify_all (gl_waitqueue_t *wq)\n+{\n+  unsigned int i;\n+\n+  for (i = 0; i < wq->count; i++)\n+    {\n+      unsigned int index = wq->offset + i;\n+      if (index >= wq->alloc)\n+        index -= wq->alloc;\n+      SetEvent (wq->array[index]);\n+    }\n+  wq->count = 0;\n+  wq->offset = 0;\n+}\n+\n+void\n+glthread_rwlock_init_func (gl_rwlock_t *lock)\n+{\n+  InitializeCriticalSection (&lock->lock);\n+  gl_waitqueue_init (&lock->waiting_readers);\n+  gl_waitqueue_init (&lock->waiting_writers);\n+  lock->runcount = 0;\n+  lock->guard.done = 1;\n+}\n+\n+int\n+glthread_rwlock_rdlock_func (gl_rwlock_t *lock)\n+{\n+  if (!lock->guard.done)\n+    {\n+      if (InterlockedIncrement (&lock->guard.started) == 0)\n+        /* This thread is the first one to need this lock.  Initialize it.  */\n+        glthread_rwlock_init (lock);\n+      else\n+        /* Yield the CPU while waiting for another thread to finish\n+           initializing this lock.  */\n+        while (!lock->guard.done)\n+          Sleep (0);\n+    }\n+  EnterCriticalSection (&lock->lock);\n+  /* Test whether only readers are currently running, and whether the runcount\n+     field will not overflow.  */\n+  if (!(lock->runcount + 1 > 0))\n+    {\n+      /* This thread has to wait for a while.  Enqueue it among the\n+         waiting_readers.  */\n+      HANDLE event = gl_waitqueue_add (&lock->waiting_readers);\n+      if (event != INVALID_HANDLE_VALUE)\n+        {\n+          DWORD result;\n+          LeaveCriticalSection (&lock->lock);\n+          /* Wait until another thread signals this event.  */\n+          result = WaitForSingleObject (event, INFINITE);\n+          if (result == WAIT_FAILED || result == WAIT_TIMEOUT)\n+            abort ();\n+          CloseHandle (event);\n+          /* The thread which signalled the event already did the bookkeeping:\n+             removed us from the waiting_readers, incremented lock->runcount.  */\n+          if (!(lock->runcount > 0))\n+            abort ();\n+          return 0;\n+        }\n+      else\n+        {\n+          /* Allocation failure.  Weird.  */\n+          do\n+            {\n+              LeaveCriticalSection (&lock->lock);\n+              Sleep (1);\n+              EnterCriticalSection (&lock->lock);\n+            }\n+          while (!(lock->runcount + 1 > 0));\n+        }\n+    }\n+  lock->runcount++;\n+  LeaveCriticalSection (&lock->lock);\n+  return 0;\n+}\n+\n+int\n+glthread_rwlock_wrlock_func (gl_rwlock_t *lock)\n+{\n+  if (!lock->guard.done)\n+    {\n+      if (InterlockedIncrement (&lock->guard.started) == 0)\n+        /* This thread is the first one to need this lock.  Initialize it.  */\n+        glthread_rwlock_init (lock);\n+      else\n+        /* Yield the CPU while waiting for another thread to finish\n+           initializing this lock.  */\n+        while (!lock->guard.done)\n+          Sleep (0);\n+    }\n+  EnterCriticalSection (&lock->lock);\n+  /* Test whether no readers or writers are currently running.  */\n+  if (!(lock->runcount == 0))\n+    {\n+      /* This thread has to wait for a while.  Enqueue it among the\n+         waiting_writers.  */\n+      HANDLE event = gl_waitqueue_add (&lock->waiting_writers);\n+      if (event != INVALID_HANDLE_VALUE)\n+        {\n+          DWORD result;\n+          LeaveCriticalSection (&lock->lock);\n+          /* Wait until another thread signals this event.  */\n+          result = WaitForSingleObject (event, INFINITE);\n+          if (result == WAIT_FAILED || result == WAIT_TIMEOUT)\n+            abort ();\n+          CloseHandle (event);\n+          /* The thread which signalled the event already did the bookkeeping:\n+             removed us from the waiting_writers, set lock->runcount = -1.  */\n+          if (!(lock->runcount == -1))\n+            abort ();\n+          return 0;\n+        }\n+      else\n+        {\n+          /* Allocation failure.  Weird.  */\n+          do\n+            {\n+              LeaveCriticalSection (&lock->lock);\n+              Sleep (1);\n+              EnterCriticalSection (&lock->lock);\n+            }\n+          while (!(lock->runcount == 0));\n+        }\n+    }\n+  lock->runcount--; /* runcount becomes -1 */\n+  LeaveCriticalSection (&lock->lock);\n+  return 0;\n+}\n+\n+int\n+glthread_rwlock_unlock_func (gl_rwlock_t *lock)\n+{\n+  if (!lock->guard.done)\n+    return EINVAL;\n+  EnterCriticalSection (&lock->lock);\n+  if (lock->runcount < 0)\n+    {\n+      /* Drop a writer lock.  */\n+      if (!(lock->runcount == -1))\n+        abort ();\n+      lock->runcount = 0;\n+    }\n+  else\n+    {\n+      /* Drop a reader lock.  */\n+      if (!(lock->runcount > 0))\n+        {\n+          LeaveCriticalSection (&lock->lock);\n+          return EPERM;\n+        }\n+      lock->runcount--;\n+    }\n+  if (lock->runcount == 0)\n+    {\n+      /* POSIX recommends that \"write locks shall take precedence over read\n+         locks\", to avoid \"writer starvation\".  */\n+      if (lock->waiting_writers.count > 0)\n+        {\n+          /* Wake up one of the waiting writers.  */\n+          lock->runcount--;\n+          gl_waitqueue_notify_first (&lock->waiting_writers);\n+        }\n+      else\n+        {\n+          /* Wake up all waiting readers.  */\n+          lock->runcount += lock->waiting_readers.count;\n+          gl_waitqueue_notify_all (&lock->waiting_readers);\n+        }\n+    }\n+  LeaveCriticalSection (&lock->lock);\n+  return 0;\n+}\n+\n+int\n+glthread_rwlock_destroy_func (gl_rwlock_t *lock)\n+{\n+  if (!lock->guard.done)\n+    return EINVAL;\n+  if (lock->runcount != 0)\n+    return EBUSY;\n+  DeleteCriticalSection (&lock->lock);\n+  if (lock->waiting_readers.array != NULL)\n+    free (lock->waiting_readers.array);\n+  if (lock->waiting_writers.array != NULL)\n+    free (lock->waiting_writers.array);\n+  lock->guard.done = 0;\n+  return 0;\n+}\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+void\n+glthread_recursive_lock_init_func (gl_recursive_lock_t *lock)\n+{\n+  lock->owner = 0;\n+  lock->depth = 0;\n+  InitializeCriticalSection (&lock->lock);\n+  lock->guard.done = 1;\n+}\n+\n+int\n+glthread_recursive_lock_lock_func (gl_recursive_lock_t *lock)\n+{\n+  if (!lock->guard.done)\n+    {\n+      if (InterlockedIncrement (&lock->guard.started) == 0)\n+        /* This thread is the first one to need this lock.  Initialize it.  */\n+        glthread_recursive_lock_init (lock);\n+      else\n+        /* Yield the CPU while waiting for another thread to finish\n+           initializing this lock.  */\n+        while (!lock->guard.done)\n+          Sleep (0);\n+    }\n+  {\n+    DWORD self = GetCurrentThreadId ();\n+    if (lock->owner != self)\n+      {\n+        EnterCriticalSection (&lock->lock);\n+        lock->owner = self;\n+      }\n+    if (++(lock->depth) == 0) /* wraparound? */\n+      {\n+        lock->depth--;\n+        return EAGAIN;\n+      }\n+  }\n+  return 0;\n+}\n+\n+int\n+glthread_recursive_lock_unlock_func (gl_recursive_lock_t *lock)\n+{\n+  if (lock->owner != GetCurrentThreadId ())\n+    return EPERM;\n+  if (lock->depth == 0)\n+    return EINVAL;\n+  if (--(lock->depth) == 0)\n+    {\n+      lock->owner = 0;\n+      LeaveCriticalSection (&lock->lock);\n+    }\n+  return 0;\n+}\n+\n+int\n+glthread_recursive_lock_destroy_func (gl_recursive_lock_t *lock)\n+{\n+  if (lock->owner != 0)\n+    return EBUSY;\n+  DeleteCriticalSection (&lock->lock);\n+  lock->guard.done = 0;\n+  return 0;\n+}\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+void\n+glthread_once_func (gl_once_t *once_control, void (*initfunction) (void))\n+{\n+  if (once_control->inited <= 0)\n+    {\n+      if (InterlockedIncrement (&once_control->started) == 0)\n+        {\n+          /* This thread is the first one to come to this once_control.  */\n+          InitializeCriticalSection (&once_control->lock);\n+          EnterCriticalSection (&once_control->lock);\n+          once_control->inited = 0;\n+          initfunction ();\n+          once_control->inited = 1;\n+          LeaveCriticalSection (&once_control->lock);\n+        }\n+      else\n+        {\n+          /* Undo last operation.  */\n+          InterlockedDecrement (&once_control->started);\n+          /* Some other thread has already started the initialization.\n+             Yield the CPU while waiting for the other thread to finish\n+             initializing and taking the lock.  */\n+          while (once_control->inited < 0)\n+            Sleep (0);\n+          if (once_control->inited <= 0)\n+            {\n+              /* Take the lock.  This blocks until the other thread has\n+                 finished calling the initfunction.  */\n+              EnterCriticalSection (&once_control->lock);\n+              LeaveCriticalSection (&once_control->lock);\n+              if (!(once_control->inited > 0))\n+                abort ();\n+            }\n+        }\n+    }\n+}\n+\n+#endif\n+\n+/* ========================================================================= */"
    },
    {
      "sha": "e64506b3d0f4fdb0eb33adb2eefe7a7ac3edaa09",
      "filename": "gnulib/import/glthread/lock.h",
      "status": "added",
      "additions": 927,
      "deletions": 0,
      "changes": 927,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/glthread/lock.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/glthread/lock.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/glthread/lock.h?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,927 @@\n+/* Locking in multithreaded situations.\n+   Copyright (C) 2005-2016 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program; if not, see <http://www.gnu.org/licenses/>.  */\n+\n+/* Written by Bruno Haible <bruno@clisp.org>, 2005.\n+   Based on GCC's gthr-posix.h, gthr-posix95.h, gthr-solaris.h,\n+   gthr-win32.h.  */\n+\n+/* This file contains locking primitives for use with a given thread library.\n+   It does not contain primitives for creating threads or for other\n+   synchronization primitives.\n+\n+   Normal (non-recursive) locks:\n+     Type:                gl_lock_t\n+     Declaration:         gl_lock_define(extern, name)\n+     Initializer:         gl_lock_define_initialized(, name)\n+     Initialization:      gl_lock_init (name);\n+     Taking the lock:     gl_lock_lock (name);\n+     Releasing the lock:  gl_lock_unlock (name);\n+     De-initialization:   gl_lock_destroy (name);\n+   Equivalent functions with control of error handling:\n+     Initialization:      err = glthread_lock_init (&name);\n+     Taking the lock:     err = glthread_lock_lock (&name);\n+     Releasing the lock:  err = glthread_lock_unlock (&name);\n+     De-initialization:   err = glthread_lock_destroy (&name);\n+\n+   Read-Write (non-recursive) locks:\n+     Type:                gl_rwlock_t\n+     Declaration:         gl_rwlock_define(extern, name)\n+     Initializer:         gl_rwlock_define_initialized(, name)\n+     Initialization:      gl_rwlock_init (name);\n+     Taking the lock:     gl_rwlock_rdlock (name);\n+                          gl_rwlock_wrlock (name);\n+     Releasing the lock:  gl_rwlock_unlock (name);\n+     De-initialization:   gl_rwlock_destroy (name);\n+   Equivalent functions with control of error handling:\n+     Initialization:      err = glthread_rwlock_init (&name);\n+     Taking the lock:     err = glthread_rwlock_rdlock (&name);\n+                          err = glthread_rwlock_wrlock (&name);\n+     Releasing the lock:  err = glthread_rwlock_unlock (&name);\n+     De-initialization:   err = glthread_rwlock_destroy (&name);\n+\n+   Recursive locks:\n+     Type:                gl_recursive_lock_t\n+     Declaration:         gl_recursive_lock_define(extern, name)\n+     Initializer:         gl_recursive_lock_define_initialized(, name)\n+     Initialization:      gl_recursive_lock_init (name);\n+     Taking the lock:     gl_recursive_lock_lock (name);\n+     Releasing the lock:  gl_recursive_lock_unlock (name);\n+     De-initialization:   gl_recursive_lock_destroy (name);\n+   Equivalent functions with control of error handling:\n+     Initialization:      err = glthread_recursive_lock_init (&name);\n+     Taking the lock:     err = glthread_recursive_lock_lock (&name);\n+     Releasing the lock:  err = glthread_recursive_lock_unlock (&name);\n+     De-initialization:   err = glthread_recursive_lock_destroy (&name);\n+\n+  Once-only execution:\n+     Type:                gl_once_t\n+     Initializer:         gl_once_define(extern, name)\n+     Execution:           gl_once (name, initfunction);\n+   Equivalent functions with control of error handling:\n+     Execution:           err = glthread_once (&name, initfunction);\n+*/\n+\n+\n+#ifndef _LOCK_H\n+#define _LOCK_H\n+\n+#include <errno.h>\n+#include <stdlib.h>\n+\n+/* ========================================================================= */\n+\n+#if USE_POSIX_THREADS\n+\n+/* Use the POSIX threads library.  */\n+\n+# include <pthread.h>\n+\n+# ifdef __cplusplus\n+extern \"C\" {\n+# endif\n+\n+# if PTHREAD_IN_USE_DETECTION_HARD\n+\n+/* The pthread_in_use() detection needs to be done at runtime.  */\n+#  define pthread_in_use() \\\n+     glthread_in_use ()\n+extern int glthread_in_use (void);\n+\n+# endif\n+\n+# if USE_POSIX_THREADS_WEAK\n+\n+/* Use weak references to the POSIX threads library.  */\n+\n+/* Weak references avoid dragging in external libraries if the other parts\n+   of the program don't use them.  Here we use them, because we don't want\n+   every program that uses libintl to depend on libpthread.  This assumes\n+   that libpthread would not be loaded after libintl; i.e. if libintl is\n+   loaded first, by an executable that does not depend on libpthread, and\n+   then a module is dynamically loaded that depends on libpthread, libintl\n+   will not be multithread-safe.  */\n+\n+/* The way to test at runtime whether libpthread is present is to test\n+   whether a function pointer's value, such as &pthread_mutex_init, is\n+   non-NULL.  However, some versions of GCC have a bug through which, in\n+   PIC mode, &foo != NULL always evaluates to true if there is a direct\n+   call to foo(...) in the same function.  To avoid this, we test the\n+   address of a function in libpthread that we don't use.  */\n+\n+#  pragma weak pthread_mutex_init\n+#  pragma weak pthread_mutex_lock\n+#  pragma weak pthread_mutex_unlock\n+#  pragma weak pthread_mutex_destroy\n+#  pragma weak pthread_rwlock_init\n+#  pragma weak pthread_rwlock_rdlock\n+#  pragma weak pthread_rwlock_wrlock\n+#  pragma weak pthread_rwlock_unlock\n+#  pragma weak pthread_rwlock_destroy\n+#  pragma weak pthread_once\n+#  pragma weak pthread_cond_init\n+#  pragma weak pthread_cond_wait\n+#  pragma weak pthread_cond_signal\n+#  pragma weak pthread_cond_broadcast\n+#  pragma weak pthread_cond_destroy\n+#  pragma weak pthread_mutexattr_init\n+#  pragma weak pthread_mutexattr_settype\n+#  pragma weak pthread_mutexattr_destroy\n+#  ifndef pthread_self\n+#   pragma weak pthread_self\n+#  endif\n+\n+#  if !PTHREAD_IN_USE_DETECTION_HARD\n+#   pragma weak pthread_cancel\n+#   define pthread_in_use() (pthread_cancel != NULL)\n+#  endif\n+\n+# else\n+\n+#  if !PTHREAD_IN_USE_DETECTION_HARD\n+#   define pthread_in_use() 1\n+#  endif\n+\n+# endif\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+typedef pthread_mutex_t gl_lock_t;\n+# define gl_lock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS pthread_mutex_t NAME;\n+# define gl_lock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS pthread_mutex_t NAME = gl_lock_initializer;\n+# define gl_lock_initializer \\\n+    PTHREAD_MUTEX_INITIALIZER\n+# define glthread_lock_init(LOCK) \\\n+    (pthread_in_use () ? pthread_mutex_init (LOCK, NULL) : 0)\n+# define glthread_lock_lock(LOCK) \\\n+    (pthread_in_use () ? pthread_mutex_lock (LOCK) : 0)\n+# define glthread_lock_unlock(LOCK) \\\n+    (pthread_in_use () ? pthread_mutex_unlock (LOCK) : 0)\n+# define glthread_lock_destroy(LOCK) \\\n+    (pthread_in_use () ? pthread_mutex_destroy (LOCK) : 0)\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+# if HAVE_PTHREAD_RWLOCK\n+\n+#  ifdef PTHREAD_RWLOCK_INITIALIZER\n+\n+typedef pthread_rwlock_t gl_rwlock_t;\n+#   define gl_rwlock_define(STORAGECLASS, NAME) \\\n+      STORAGECLASS pthread_rwlock_t NAME;\n+#   define gl_rwlock_define_initialized(STORAGECLASS, NAME) \\\n+      STORAGECLASS pthread_rwlock_t NAME = gl_rwlock_initializer;\n+#   define gl_rwlock_initializer \\\n+      PTHREAD_RWLOCK_INITIALIZER\n+#   define glthread_rwlock_init(LOCK) \\\n+      (pthread_in_use () ? pthread_rwlock_init (LOCK, NULL) : 0)\n+#   define glthread_rwlock_rdlock(LOCK) \\\n+      (pthread_in_use () ? pthread_rwlock_rdlock (LOCK) : 0)\n+#   define glthread_rwlock_wrlock(LOCK) \\\n+      (pthread_in_use () ? pthread_rwlock_wrlock (LOCK) : 0)\n+#   define glthread_rwlock_unlock(LOCK) \\\n+      (pthread_in_use () ? pthread_rwlock_unlock (LOCK) : 0)\n+#   define glthread_rwlock_destroy(LOCK) \\\n+      (pthread_in_use () ? pthread_rwlock_destroy (LOCK) : 0)\n+\n+#  else\n+\n+typedef struct\n+        {\n+          int initialized;\n+          pthread_mutex_t guard;   /* protects the initialization */\n+          pthread_rwlock_t rwlock; /* read-write lock */\n+        }\n+        gl_rwlock_t;\n+#   define gl_rwlock_define(STORAGECLASS, NAME) \\\n+      STORAGECLASS gl_rwlock_t NAME;\n+#   define gl_rwlock_define_initialized(STORAGECLASS, NAME) \\\n+      STORAGECLASS gl_rwlock_t NAME = gl_rwlock_initializer;\n+#   define gl_rwlock_initializer \\\n+      { 0, PTHREAD_MUTEX_INITIALIZER }\n+#   define glthread_rwlock_init(LOCK) \\\n+      (pthread_in_use () ? glthread_rwlock_init_multithreaded (LOCK) : 0)\n+#   define glthread_rwlock_rdlock(LOCK) \\\n+      (pthread_in_use () ? glthread_rwlock_rdlock_multithreaded (LOCK) : 0)\n+#   define glthread_rwlock_wrlock(LOCK) \\\n+      (pthread_in_use () ? glthread_rwlock_wrlock_multithreaded (LOCK) : 0)\n+#   define glthread_rwlock_unlock(LOCK) \\\n+      (pthread_in_use () ? glthread_rwlock_unlock_multithreaded (LOCK) : 0)\n+#   define glthread_rwlock_destroy(LOCK) \\\n+      (pthread_in_use () ? glthread_rwlock_destroy_multithreaded (LOCK) : 0)\n+extern int glthread_rwlock_init_multithreaded (gl_rwlock_t *lock);\n+extern int glthread_rwlock_rdlock_multithreaded (gl_rwlock_t *lock);\n+extern int glthread_rwlock_wrlock_multithreaded (gl_rwlock_t *lock);\n+extern int glthread_rwlock_unlock_multithreaded (gl_rwlock_t *lock);\n+extern int glthread_rwlock_destroy_multithreaded (gl_rwlock_t *lock);\n+\n+#  endif\n+\n+# else\n+\n+typedef struct\n+        {\n+          pthread_mutex_t lock; /* protects the remaining fields */\n+          pthread_cond_t waiting_readers; /* waiting readers */\n+          pthread_cond_t waiting_writers; /* waiting writers */\n+          unsigned int waiting_writers_count; /* number of waiting writers */\n+          int runcount; /* number of readers running, or -1 when a writer runs */\n+        }\n+        gl_rwlock_t;\n+# define gl_rwlock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_rwlock_t NAME;\n+# define gl_rwlock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_rwlock_t NAME = gl_rwlock_initializer;\n+# define gl_rwlock_initializer \\\n+    { PTHREAD_MUTEX_INITIALIZER, PTHREAD_COND_INITIALIZER, PTHREAD_COND_INITIALIZER, 0, 0 }\n+# define glthread_rwlock_init(LOCK) \\\n+    (pthread_in_use () ? glthread_rwlock_init_multithreaded (LOCK) : 0)\n+# define glthread_rwlock_rdlock(LOCK) \\\n+    (pthread_in_use () ? glthread_rwlock_rdlock_multithreaded (LOCK) : 0)\n+# define glthread_rwlock_wrlock(LOCK) \\\n+    (pthread_in_use () ? glthread_rwlock_wrlock_multithreaded (LOCK) : 0)\n+# define glthread_rwlock_unlock(LOCK) \\\n+    (pthread_in_use () ? glthread_rwlock_unlock_multithreaded (LOCK) : 0)\n+# define glthread_rwlock_destroy(LOCK) \\\n+    (pthread_in_use () ? glthread_rwlock_destroy_multithreaded (LOCK) : 0)\n+extern int glthread_rwlock_init_multithreaded (gl_rwlock_t *lock);\n+extern int glthread_rwlock_rdlock_multithreaded (gl_rwlock_t *lock);\n+extern int glthread_rwlock_wrlock_multithreaded (gl_rwlock_t *lock);\n+extern int glthread_rwlock_unlock_multithreaded (gl_rwlock_t *lock);\n+extern int glthread_rwlock_destroy_multithreaded (gl_rwlock_t *lock);\n+\n+# endif\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+# if HAVE_PTHREAD_MUTEX_RECURSIVE\n+\n+#  if defined PTHREAD_RECURSIVE_MUTEX_INITIALIZER || defined PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP\n+\n+typedef pthread_mutex_t gl_recursive_lock_t;\n+#   define gl_recursive_lock_define(STORAGECLASS, NAME) \\\n+      STORAGECLASS pthread_mutex_t NAME;\n+#   define gl_recursive_lock_define_initialized(STORAGECLASS, NAME) \\\n+      STORAGECLASS pthread_mutex_t NAME = gl_recursive_lock_initializer;\n+#   ifdef PTHREAD_RECURSIVE_MUTEX_INITIALIZER\n+#    define gl_recursive_lock_initializer \\\n+       PTHREAD_RECURSIVE_MUTEX_INITIALIZER\n+#   else\n+#    define gl_recursive_lock_initializer \\\n+       PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP\n+#   endif\n+#   define glthread_recursive_lock_init(LOCK) \\\n+      (pthread_in_use () ? glthread_recursive_lock_init_multithreaded (LOCK) : 0)\n+#   define glthread_recursive_lock_lock(LOCK) \\\n+      (pthread_in_use () ? pthread_mutex_lock (LOCK) : 0)\n+#   define glthread_recursive_lock_unlock(LOCK) \\\n+      (pthread_in_use () ? pthread_mutex_unlock (LOCK) : 0)\n+#   define glthread_recursive_lock_destroy(LOCK) \\\n+      (pthread_in_use () ? pthread_mutex_destroy (LOCK) : 0)\n+extern int glthread_recursive_lock_init_multithreaded (gl_recursive_lock_t *lock);\n+\n+#  else\n+\n+typedef struct\n+        {\n+          pthread_mutex_t recmutex; /* recursive mutex */\n+          pthread_mutex_t guard;    /* protects the initialization */\n+          int initialized;\n+        }\n+        gl_recursive_lock_t;\n+#   define gl_recursive_lock_define(STORAGECLASS, NAME) \\\n+      STORAGECLASS gl_recursive_lock_t NAME;\n+#   define gl_recursive_lock_define_initialized(STORAGECLASS, NAME) \\\n+      STORAGECLASS gl_recursive_lock_t NAME = gl_recursive_lock_initializer;\n+#   define gl_recursive_lock_initializer \\\n+      { PTHREAD_MUTEX_INITIALIZER, PTHREAD_MUTEX_INITIALIZER, 0 }\n+#   define glthread_recursive_lock_init(LOCK) \\\n+      (pthread_in_use () ? glthread_recursive_lock_init_multithreaded (LOCK) : 0)\n+#   define glthread_recursive_lock_lock(LOCK) \\\n+      (pthread_in_use () ? glthread_recursive_lock_lock_multithreaded (LOCK) : 0)\n+#   define glthread_recursive_lock_unlock(LOCK) \\\n+      (pthread_in_use () ? glthread_recursive_lock_unlock_multithreaded (LOCK) : 0)\n+#   define glthread_recursive_lock_destroy(LOCK) \\\n+      (pthread_in_use () ? glthread_recursive_lock_destroy_multithreaded (LOCK) : 0)\n+extern int glthread_recursive_lock_init_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_lock_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_unlock_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_destroy_multithreaded (gl_recursive_lock_t *lock);\n+\n+#  endif\n+\n+# else\n+\n+/* Old versions of POSIX threads on Solaris did not have recursive locks.\n+   We have to implement them ourselves.  */\n+\n+typedef struct\n+        {\n+          pthread_mutex_t mutex;\n+          pthread_t owner;\n+          unsigned long depth;\n+        }\n+        gl_recursive_lock_t;\n+#  define gl_recursive_lock_define(STORAGECLASS, NAME) \\\n+     STORAGECLASS gl_recursive_lock_t NAME;\n+#  define gl_recursive_lock_define_initialized(STORAGECLASS, NAME) \\\n+     STORAGECLASS gl_recursive_lock_t NAME = gl_recursive_lock_initializer;\n+#  define gl_recursive_lock_initializer \\\n+     { PTHREAD_MUTEX_INITIALIZER, (pthread_t) 0, 0 }\n+#  define glthread_recursive_lock_init(LOCK) \\\n+     (pthread_in_use () ? glthread_recursive_lock_init_multithreaded (LOCK) : 0)\n+#  define glthread_recursive_lock_lock(LOCK) \\\n+     (pthread_in_use () ? glthread_recursive_lock_lock_multithreaded (LOCK) : 0)\n+#  define glthread_recursive_lock_unlock(LOCK) \\\n+     (pthread_in_use () ? glthread_recursive_lock_unlock_multithreaded (LOCK) : 0)\n+#  define glthread_recursive_lock_destroy(LOCK) \\\n+     (pthread_in_use () ? glthread_recursive_lock_destroy_multithreaded (LOCK) : 0)\n+extern int glthread_recursive_lock_init_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_lock_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_unlock_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_destroy_multithreaded (gl_recursive_lock_t *lock);\n+\n+# endif\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+typedef pthread_once_t gl_once_t;\n+# define gl_once_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS pthread_once_t NAME = PTHREAD_ONCE_INIT;\n+# define glthread_once(ONCE_CONTROL, INITFUNCTION) \\\n+    (pthread_in_use ()                                                         \\\n+     ? pthread_once (ONCE_CONTROL, INITFUNCTION)                               \\\n+     : (glthread_once_singlethreaded (ONCE_CONTROL) ? (INITFUNCTION (), 0) : 0))\n+extern int glthread_once_singlethreaded (pthread_once_t *once_control);\n+\n+# ifdef __cplusplus\n+}\n+# endif\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+#if USE_PTH_THREADS\n+\n+/* Use the GNU Pth threads library.  */\n+\n+# include <pth.h>\n+\n+# ifdef __cplusplus\n+extern \"C\" {\n+# endif\n+\n+# if USE_PTH_THREADS_WEAK\n+\n+/* Use weak references to the GNU Pth threads library.  */\n+\n+#  pragma weak pth_mutex_init\n+#  pragma weak pth_mutex_acquire\n+#  pragma weak pth_mutex_release\n+#  pragma weak pth_rwlock_init\n+#  pragma weak pth_rwlock_acquire\n+#  pragma weak pth_rwlock_release\n+#  pragma weak pth_once\n+\n+#  pragma weak pth_cancel\n+#  define pth_in_use() (pth_cancel != NULL)\n+\n+# else\n+\n+#  define pth_in_use() 1\n+\n+# endif\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+typedef pth_mutex_t gl_lock_t;\n+# define gl_lock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS pth_mutex_t NAME;\n+# define gl_lock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS pth_mutex_t NAME = gl_lock_initializer;\n+# define gl_lock_initializer \\\n+    PTH_MUTEX_INIT\n+# define glthread_lock_init(LOCK) \\\n+    (pth_in_use () && !pth_mutex_init (LOCK) ? errno : 0)\n+# define glthread_lock_lock(LOCK) \\\n+    (pth_in_use () && !pth_mutex_acquire (LOCK, 0, NULL) ? errno : 0)\n+# define glthread_lock_unlock(LOCK) \\\n+    (pth_in_use () && !pth_mutex_release (LOCK) ? errno : 0)\n+# define glthread_lock_destroy(LOCK) \\\n+    ((void)(LOCK), 0)\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+typedef pth_rwlock_t gl_rwlock_t;\n+#  define gl_rwlock_define(STORAGECLASS, NAME) \\\n+     STORAGECLASS pth_rwlock_t NAME;\n+#  define gl_rwlock_define_initialized(STORAGECLASS, NAME) \\\n+     STORAGECLASS pth_rwlock_t NAME = gl_rwlock_initializer;\n+#  define gl_rwlock_initializer \\\n+     PTH_RWLOCK_INIT\n+#  define glthread_rwlock_init(LOCK) \\\n+     (pth_in_use () && !pth_rwlock_init (LOCK) ? errno : 0)\n+#  define glthread_rwlock_rdlock(LOCK) \\\n+     (pth_in_use () && !pth_rwlock_acquire (LOCK, PTH_RWLOCK_RD, 0, NULL) ? errno : 0)\n+#  define glthread_rwlock_wrlock(LOCK) \\\n+     (pth_in_use () && !pth_rwlock_acquire (LOCK, PTH_RWLOCK_RW, 0, NULL) ? errno : 0)\n+#  define glthread_rwlock_unlock(LOCK) \\\n+     (pth_in_use () && !pth_rwlock_release (LOCK) ? errno : 0)\n+#  define glthread_rwlock_destroy(LOCK) \\\n+     ((void)(LOCK), 0)\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+/* In Pth, mutexes are recursive by default.  */\n+typedef pth_mutex_t gl_recursive_lock_t;\n+#  define gl_recursive_lock_define(STORAGECLASS, NAME) \\\n+     STORAGECLASS pth_mutex_t NAME;\n+#  define gl_recursive_lock_define_initialized(STORAGECLASS, NAME) \\\n+     STORAGECLASS pth_mutex_t NAME = gl_recursive_lock_initializer;\n+#  define gl_recursive_lock_initializer \\\n+     PTH_MUTEX_INIT\n+#  define glthread_recursive_lock_init(LOCK) \\\n+     (pth_in_use () && !pth_mutex_init (LOCK) ? errno : 0)\n+#  define glthread_recursive_lock_lock(LOCK) \\\n+     (pth_in_use () && !pth_mutex_acquire (LOCK, 0, NULL) ? errno : 0)\n+#  define glthread_recursive_lock_unlock(LOCK) \\\n+     (pth_in_use () && !pth_mutex_release (LOCK) ? errno : 0)\n+#  define glthread_recursive_lock_destroy(LOCK) \\\n+     ((void)(LOCK), 0)\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+typedef pth_once_t gl_once_t;\n+# define gl_once_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS pth_once_t NAME = PTH_ONCE_INIT;\n+# define glthread_once(ONCE_CONTROL, INITFUNCTION) \\\n+    (pth_in_use ()                                                             \\\n+     ? glthread_once_multithreaded (ONCE_CONTROL, INITFUNCTION)                \\\n+     : (glthread_once_singlethreaded (ONCE_CONTROL) ? (INITFUNCTION (), 0) : 0))\n+extern int glthread_once_multithreaded (pth_once_t *once_control, void (*initfunction) (void));\n+extern int glthread_once_singlethreaded (pth_once_t *once_control);\n+\n+# ifdef __cplusplus\n+}\n+# endif\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+#if USE_SOLARIS_THREADS\n+\n+/* Use the old Solaris threads library.  */\n+\n+# include <thread.h>\n+# include <synch.h>\n+\n+# ifdef __cplusplus\n+extern \"C\" {\n+# endif\n+\n+# if USE_SOLARIS_THREADS_WEAK\n+\n+/* Use weak references to the old Solaris threads library.  */\n+\n+#  pragma weak mutex_init\n+#  pragma weak mutex_lock\n+#  pragma weak mutex_unlock\n+#  pragma weak mutex_destroy\n+#  pragma weak rwlock_init\n+#  pragma weak rw_rdlock\n+#  pragma weak rw_wrlock\n+#  pragma weak rw_unlock\n+#  pragma weak rwlock_destroy\n+#  pragma weak thr_self\n+\n+#  pragma weak thr_suspend\n+#  define thread_in_use() (thr_suspend != NULL)\n+\n+# else\n+\n+#  define thread_in_use() 1\n+\n+# endif\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+typedef mutex_t gl_lock_t;\n+# define gl_lock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS mutex_t NAME;\n+# define gl_lock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS mutex_t NAME = gl_lock_initializer;\n+# define gl_lock_initializer \\\n+    DEFAULTMUTEX\n+# define glthread_lock_init(LOCK) \\\n+    (thread_in_use () ? mutex_init (LOCK, USYNC_THREAD, NULL) : 0)\n+# define glthread_lock_lock(LOCK) \\\n+    (thread_in_use () ? mutex_lock (LOCK) : 0)\n+# define glthread_lock_unlock(LOCK) \\\n+    (thread_in_use () ? mutex_unlock (LOCK) : 0)\n+# define glthread_lock_destroy(LOCK) \\\n+    (thread_in_use () ? mutex_destroy (LOCK) : 0)\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+typedef rwlock_t gl_rwlock_t;\n+# define gl_rwlock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS rwlock_t NAME;\n+# define gl_rwlock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS rwlock_t NAME = gl_rwlock_initializer;\n+# define gl_rwlock_initializer \\\n+    DEFAULTRWLOCK\n+# define glthread_rwlock_init(LOCK) \\\n+    (thread_in_use () ? rwlock_init (LOCK, USYNC_THREAD, NULL) : 0)\n+# define glthread_rwlock_rdlock(LOCK) \\\n+    (thread_in_use () ? rw_rdlock (LOCK) : 0)\n+# define glthread_rwlock_wrlock(LOCK) \\\n+    (thread_in_use () ? rw_wrlock (LOCK) : 0)\n+# define glthread_rwlock_unlock(LOCK) \\\n+    (thread_in_use () ? rw_unlock (LOCK) : 0)\n+# define glthread_rwlock_destroy(LOCK) \\\n+    (thread_in_use () ? rwlock_destroy (LOCK) : 0)\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+/* Old Solaris threads did not have recursive locks.\n+   We have to implement them ourselves.  */\n+\n+typedef struct\n+        {\n+          mutex_t mutex;\n+          thread_t owner;\n+          unsigned long depth;\n+        }\n+        gl_recursive_lock_t;\n+# define gl_recursive_lock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_recursive_lock_t NAME;\n+# define gl_recursive_lock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_recursive_lock_t NAME = gl_recursive_lock_initializer;\n+# define gl_recursive_lock_initializer \\\n+    { DEFAULTMUTEX, (thread_t) 0, 0 }\n+# define glthread_recursive_lock_init(LOCK) \\\n+    (thread_in_use () ? glthread_recursive_lock_init_multithreaded (LOCK) : 0)\n+# define glthread_recursive_lock_lock(LOCK) \\\n+    (thread_in_use () ? glthread_recursive_lock_lock_multithreaded (LOCK) : 0)\n+# define glthread_recursive_lock_unlock(LOCK) \\\n+    (thread_in_use () ? glthread_recursive_lock_unlock_multithreaded (LOCK) : 0)\n+# define glthread_recursive_lock_destroy(LOCK) \\\n+    (thread_in_use () ? glthread_recursive_lock_destroy_multithreaded (LOCK) : 0)\n+extern int glthread_recursive_lock_init_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_lock_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_unlock_multithreaded (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_destroy_multithreaded (gl_recursive_lock_t *lock);\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+typedef struct\n+        {\n+          volatile int inited;\n+          mutex_t mutex;\n+        }\n+        gl_once_t;\n+# define gl_once_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_once_t NAME = { 0, DEFAULTMUTEX };\n+# define glthread_once(ONCE_CONTROL, INITFUNCTION) \\\n+    (thread_in_use ()                                                          \\\n+     ? glthread_once_multithreaded (ONCE_CONTROL, INITFUNCTION)                \\\n+     : (glthread_once_singlethreaded (ONCE_CONTROL) ? (INITFUNCTION (), 0) : 0))\n+extern int glthread_once_multithreaded (gl_once_t *once_control, void (*initfunction) (void));\n+extern int glthread_once_singlethreaded (gl_once_t *once_control);\n+\n+# ifdef __cplusplus\n+}\n+# endif\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+#if USE_WINDOWS_THREADS\n+\n+# define WIN32_LEAN_AND_MEAN  /* avoid including junk */\n+# include <windows.h>\n+\n+# ifdef __cplusplus\n+extern \"C\" {\n+# endif\n+\n+/* We can use CRITICAL_SECTION directly, rather than the native Windows Event,\n+   Mutex, Semaphore types, because\n+     - we need only to synchronize inside a single process (address space),\n+       not inter-process locking,\n+     - we don't need to support trylock operations.  (TryEnterCriticalSection\n+       does not work on Windows 95/98/ME.  Packages that need trylock usually\n+       define their own mutex type.)  */\n+\n+/* There is no way to statically initialize a CRITICAL_SECTION.  It needs\n+   to be done lazily, once only.  For this we need spinlocks.  */\n+\n+typedef struct { volatile int done; volatile long started; } gl_spinlock_t;\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+typedef struct\n+        {\n+          gl_spinlock_t guard; /* protects the initialization */\n+          CRITICAL_SECTION lock;\n+        }\n+        gl_lock_t;\n+# define gl_lock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_lock_t NAME;\n+# define gl_lock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_lock_t NAME = gl_lock_initializer;\n+# define gl_lock_initializer \\\n+    { { 0, -1 } }\n+# define glthread_lock_init(LOCK) \\\n+    (glthread_lock_init_func (LOCK), 0)\n+# define glthread_lock_lock(LOCK) \\\n+    glthread_lock_lock_func (LOCK)\n+# define glthread_lock_unlock(LOCK) \\\n+    glthread_lock_unlock_func (LOCK)\n+# define glthread_lock_destroy(LOCK) \\\n+    glthread_lock_destroy_func (LOCK)\n+extern void glthread_lock_init_func (gl_lock_t *lock);\n+extern int glthread_lock_lock_func (gl_lock_t *lock);\n+extern int glthread_lock_unlock_func (gl_lock_t *lock);\n+extern int glthread_lock_destroy_func (gl_lock_t *lock);\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+/* It is impossible to implement read-write locks using plain locks, without\n+   introducing an extra thread dedicated to managing read-write locks.\n+   Therefore here we need to use the low-level Event type.  */\n+\n+typedef struct\n+        {\n+          HANDLE *array; /* array of waiting threads, each represented by an event */\n+          unsigned int count; /* number of waiting threads */\n+          unsigned int alloc; /* length of allocated array */\n+          unsigned int offset; /* index of first waiting thread in array */\n+        }\n+        gl_carray_waitqueue_t;\n+typedef struct\n+        {\n+          gl_spinlock_t guard; /* protects the initialization */\n+          CRITICAL_SECTION lock; /* protects the remaining fields */\n+          gl_carray_waitqueue_t waiting_readers; /* waiting readers */\n+          gl_carray_waitqueue_t waiting_writers; /* waiting writers */\n+          int runcount; /* number of readers running, or -1 when a writer runs */\n+        }\n+        gl_rwlock_t;\n+# define gl_rwlock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_rwlock_t NAME;\n+# define gl_rwlock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_rwlock_t NAME = gl_rwlock_initializer;\n+# define gl_rwlock_initializer \\\n+    { { 0, -1 } }\n+# define glthread_rwlock_init(LOCK) \\\n+    (glthread_rwlock_init_func (LOCK), 0)\n+# define glthread_rwlock_rdlock(LOCK) \\\n+    glthread_rwlock_rdlock_func (LOCK)\n+# define glthread_rwlock_wrlock(LOCK) \\\n+    glthread_rwlock_wrlock_func (LOCK)\n+# define glthread_rwlock_unlock(LOCK) \\\n+    glthread_rwlock_unlock_func (LOCK)\n+# define glthread_rwlock_destroy(LOCK) \\\n+    glthread_rwlock_destroy_func (LOCK)\n+extern void glthread_rwlock_init_func (gl_rwlock_t *lock);\n+extern int glthread_rwlock_rdlock_func (gl_rwlock_t *lock);\n+extern int glthread_rwlock_wrlock_func (gl_rwlock_t *lock);\n+extern int glthread_rwlock_unlock_func (gl_rwlock_t *lock);\n+extern int glthread_rwlock_destroy_func (gl_rwlock_t *lock);\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+/* The native Windows documentation says that CRITICAL_SECTION already\n+   implements a recursive lock.  But we need not rely on it: It's easy to\n+   implement a recursive lock without this assumption.  */\n+\n+typedef struct\n+        {\n+          gl_spinlock_t guard; /* protects the initialization */\n+          DWORD owner;\n+          unsigned long depth;\n+          CRITICAL_SECTION lock;\n+        }\n+        gl_recursive_lock_t;\n+# define gl_recursive_lock_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_recursive_lock_t NAME;\n+# define gl_recursive_lock_define_initialized(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_recursive_lock_t NAME = gl_recursive_lock_initializer;\n+# define gl_recursive_lock_initializer \\\n+    { { 0, -1 }, 0, 0 }\n+# define glthread_recursive_lock_init(LOCK) \\\n+    (glthread_recursive_lock_init_func (LOCK), 0)\n+# define glthread_recursive_lock_lock(LOCK) \\\n+    glthread_recursive_lock_lock_func (LOCK)\n+# define glthread_recursive_lock_unlock(LOCK) \\\n+    glthread_recursive_lock_unlock_func (LOCK)\n+# define glthread_recursive_lock_destroy(LOCK) \\\n+    glthread_recursive_lock_destroy_func (LOCK)\n+extern void glthread_recursive_lock_init_func (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_lock_func (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_unlock_func (gl_recursive_lock_t *lock);\n+extern int glthread_recursive_lock_destroy_func (gl_recursive_lock_t *lock);\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+typedef struct\n+        {\n+          volatile int inited;\n+          volatile long started;\n+          CRITICAL_SECTION lock;\n+        }\n+        gl_once_t;\n+# define gl_once_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_once_t NAME = { -1, -1 };\n+# define glthread_once(ONCE_CONTROL, INITFUNCTION) \\\n+    (glthread_once_func (ONCE_CONTROL, INITFUNCTION), 0)\n+extern void glthread_once_func (gl_once_t *once_control, void (*initfunction) (void));\n+\n+# ifdef __cplusplus\n+}\n+# endif\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+#if !(USE_POSIX_THREADS || USE_PTH_THREADS || USE_SOLARIS_THREADS || USE_WINDOWS_THREADS)\n+\n+/* Provide dummy implementation if threads are not supported.  */\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+typedef int gl_lock_t;\n+# define gl_lock_define(STORAGECLASS, NAME)\n+# define gl_lock_define_initialized(STORAGECLASS, NAME)\n+# define glthread_lock_init(NAME) 0\n+# define glthread_lock_lock(NAME) 0\n+# define glthread_lock_unlock(NAME) 0\n+# define glthread_lock_destroy(NAME) 0\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+typedef int gl_rwlock_t;\n+# define gl_rwlock_define(STORAGECLASS, NAME)\n+# define gl_rwlock_define_initialized(STORAGECLASS, NAME)\n+# define glthread_rwlock_init(NAME) 0\n+# define glthread_rwlock_rdlock(NAME) 0\n+# define glthread_rwlock_wrlock(NAME) 0\n+# define glthread_rwlock_unlock(NAME) 0\n+# define glthread_rwlock_destroy(NAME) 0\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+typedef int gl_recursive_lock_t;\n+# define gl_recursive_lock_define(STORAGECLASS, NAME)\n+# define gl_recursive_lock_define_initialized(STORAGECLASS, NAME)\n+# define glthread_recursive_lock_init(NAME) 0\n+# define glthread_recursive_lock_lock(NAME) 0\n+# define glthread_recursive_lock_unlock(NAME) 0\n+# define glthread_recursive_lock_destroy(NAME) 0\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+typedef int gl_once_t;\n+# define gl_once_define(STORAGECLASS, NAME) \\\n+    STORAGECLASS gl_once_t NAME = 0;\n+# define glthread_once(ONCE_CONTROL, INITFUNCTION) \\\n+    (*(ONCE_CONTROL) == 0 ? (*(ONCE_CONTROL) = ~ 0, INITFUNCTION (), 0) : 0)\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+/* Macros with built-in error handling.  */\n+\n+/* -------------------------- gl_lock_t datatype -------------------------- */\n+\n+#define gl_lock_init(NAME) \\\n+   do                                  \\\n+     {                                 \\\n+       if (glthread_lock_init (&NAME)) \\\n+         abort ();                     \\\n+     }                                 \\\n+   while (0)\n+#define gl_lock_lock(NAME) \\\n+   do                                  \\\n+     {                                 \\\n+       if (glthread_lock_lock (&NAME)) \\\n+         abort ();                     \\\n+     }                                 \\\n+   while (0)\n+#define gl_lock_unlock(NAME) \\\n+   do                                    \\\n+     {                                   \\\n+       if (glthread_lock_unlock (&NAME)) \\\n+         abort ();                       \\\n+     }                                   \\\n+   while (0)\n+#define gl_lock_destroy(NAME) \\\n+   do                                     \\\n+     {                                    \\\n+       if (glthread_lock_destroy (&NAME)) \\\n+         abort ();                        \\\n+     }                                    \\\n+   while (0)\n+\n+/* ------------------------- gl_rwlock_t datatype ------------------------- */\n+\n+#define gl_rwlock_init(NAME) \\\n+   do                                    \\\n+     {                                   \\\n+       if (glthread_rwlock_init (&NAME)) \\\n+         abort ();                       \\\n+     }                                   \\\n+   while (0)\n+#define gl_rwlock_rdlock(NAME) \\\n+   do                                      \\\n+     {                                     \\\n+       if (glthread_rwlock_rdlock (&NAME)) \\\n+         abort ();                         \\\n+     }                                     \\\n+   while (0)\n+#define gl_rwlock_wrlock(NAME) \\\n+   do                                      \\\n+     {                                     \\\n+       if (glthread_rwlock_wrlock (&NAME)) \\\n+         abort ();                         \\\n+     }                                     \\\n+   while (0)\n+#define gl_rwlock_unlock(NAME) \\\n+   do                                      \\\n+     {                                     \\\n+       if (glthread_rwlock_unlock (&NAME)) \\\n+         abort ();                         \\\n+     }                                     \\\n+   while (0)\n+#define gl_rwlock_destroy(NAME) \\\n+   do                                       \\\n+     {                                      \\\n+       if (glthread_rwlock_destroy (&NAME)) \\\n+         abort ();                          \\\n+     }                                      \\\n+   while (0)\n+\n+/* --------------------- gl_recursive_lock_t datatype --------------------- */\n+\n+#define gl_recursive_lock_init(NAME) \\\n+   do                                            \\\n+     {                                           \\\n+       if (glthread_recursive_lock_init (&NAME)) \\\n+         abort ();                               \\\n+     }                                           \\\n+   while (0)\n+#define gl_recursive_lock_lock(NAME) \\\n+   do                                            \\\n+     {                                           \\\n+       if (glthread_recursive_lock_lock (&NAME)) \\\n+         abort ();                               \\\n+     }                                           \\\n+   while (0)\n+#define gl_recursive_lock_unlock(NAME) \\\n+   do                                              \\\n+     {                                             \\\n+       if (glthread_recursive_lock_unlock (&NAME)) \\\n+         abort ();                                 \\\n+     }                                             \\\n+   while (0)\n+#define gl_recursive_lock_destroy(NAME) \\\n+   do                                               \\\n+     {                                              \\\n+       if (glthread_recursive_lock_destroy (&NAME)) \\\n+         abort ();                                  \\\n+     }                                              \\\n+   while (0)\n+\n+/* -------------------------- gl_once_t datatype -------------------------- */\n+\n+#define gl_once(NAME, INITFUNCTION) \\\n+   do                                           \\\n+     {                                          \\\n+       if (glthread_once (&NAME, INITFUNCTION)) \\\n+         abort ();                              \\\n+     }                                          \\\n+   while (0)\n+\n+/* ========================================================================= */\n+\n+#endif /* _LOCK_H */"
    },
    {
      "sha": "be6371306d611ccffd9fb23bde30db026724b81f",
      "filename": "gnulib/import/glthread/threadlib.c",
      "status": "added",
      "additions": 73,
      "deletions": 0,
      "changes": 73,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/glthread/threadlib.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/glthread/threadlib.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/glthread/threadlib.c?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,73 @@\n+/* Multithreading primitives.\n+   Copyright (C) 2005-2016 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3, or (at your option)\n+   any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program; if not, see <http://www.gnu.org/licenses/>.  */\n+\n+/* Written by Bruno Haible <bruno@clisp.org>, 2005.  */\n+\n+#include <config.h>\n+\n+/* ========================================================================= */\n+\n+#if USE_POSIX_THREADS\n+\n+/* Use the POSIX threads library.  */\n+\n+# include <pthread.h>\n+# include <stdlib.h>\n+\n+# if PTHREAD_IN_USE_DETECTION_HARD\n+\n+/* The function to be executed by a dummy thread.  */\n+static void *\n+dummy_thread_func (void *arg)\n+{\n+  return arg;\n+}\n+\n+int\n+glthread_in_use (void)\n+{\n+  static int tested;\n+  static int result; /* 1: linked with -lpthread, 0: only with libc */\n+\n+  if (!tested)\n+    {\n+      pthread_t thread;\n+\n+      if (pthread_create (&thread, NULL, dummy_thread_func, NULL) != 0)\n+        /* Thread creation failed.  */\n+        result = 0;\n+      else\n+        {\n+          /* Thread creation works.  */\n+          void *retval;\n+          if (pthread_join (thread, &retval) != 0)\n+            abort ();\n+          result = 1;\n+        }\n+      tested = 1;\n+    }\n+  return result;\n+}\n+\n+# endif\n+\n+#endif\n+\n+/* ========================================================================= */\n+\n+/* This declaration is solely to ensure that after preprocessing\n+   this file is never empty.  */\n+typedef int dummy;"
    },
    {
      "sha": "6dbb6b8b003b539a3a4221930652960c24ed895a",
      "filename": "gnulib/import/m4/gnulib-cache.m4",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/gnulib-cache.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/gnulib-cache.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/gnulib-cache.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -27,7 +27,7 @@\n \n \n # Specification in the form of a command-line invocation:\n-#   gnulib-tool --import --lib=libgnu --source-base=import --m4-base=import/m4 --doc-base=doc --tests-base=tests --aux-dir=import/extra --no-conditional-dependencies --no-libtool --macro-prefix=gl --no-vc-files alloca canonicalize-lgpl dirent dirfd errno fnmatch-gnu frexpl getcwd glob inet_ntop inttypes limits-h lstat memchr memmem mkdir mkdtemp mkostemp pathmax rawmemchr readlink rename setenv signal-h strchrnul strstr strtok_r sys_stat unistd unsetenv update-copyright wchar wctype-h\n+#   gnulib-tool --import --lib=libgnu --source-base=import --m4-base=import/m4 --doc-base=doc --tests-base=tests --aux-dir=import/extra --no-conditional-dependencies --no-libtool --macro-prefix=gl --no-vc-files alloca canonicalize-lgpl dirent dirfd errno fnmatch-gnu frexpl getcwd glob inet_ntop inttypes limits-h lstat memchr memmem mkdir mkdtemp mkostemp pathmax rawmemchr readlink rename setenv signal-h strchrnul strerror_r-posix strstr strtok_r sys_stat unistd unsetenv update-copyright wchar wctype-h\n \n # Specification in the form of a few gnulib-tool.m4 macro invocations:\n gl_LOCAL_DIR([])\n@@ -57,6 +57,7 @@ gl_MODULES([\n   setenv\n   signal-h\n   strchrnul\n+  strerror_r-posix\n   strstr\n   strtok_r\n   sys_stat"
    },
    {
      "sha": "fdfc206fcf3a05c3b46f4fd382254d64e42a5e38",
      "filename": "gnulib/import/m4/gnulib-comp.m4",
      "status": "modified",
      "additions": 26,
      "deletions": 0,
      "changes": 26,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/gnulib-comp.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/gnulib-comp.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/gnulib-comp.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -42,6 +42,7 @@ AC_DEFUN([gl_EARLY],\n   AC_REQUIRE([gl_USE_SYSTEM_EXTENSIONS])\n   AC_REQUIRE([gl_PROG_AR_RANLIB])\n \n+  AC_REQUIRE([AM_PROG_CC_C_O])\n   # Code from module absolute-header:\n   # Code from module alloca:\n   # Code from module alloca-opt:\n@@ -97,6 +98,7 @@ AC_DEFUN([gl_EARLY],\n   # Code from module gettimeofday:\n   # Code from module glob:\n   # Code from module hard-locale:\n+  # Code from module havelib:\n   # Code from module include_next:\n   # Code from module inet_ntop:\n   # Code from module intprops:\n@@ -108,6 +110,7 @@ AC_DEFUN([gl_EARLY],\n   AC_REQUIRE([AC_SYS_LARGEFILE])\n   # Code from module limits-h:\n   # Code from module localcharset:\n+  # Code from module lock:\n   # Code from module lstat:\n   # Code from module malloc-posix:\n   # Code from module malloca:\n@@ -164,6 +167,7 @@ AC_DEFUN([gl_EARLY],\n   # Code from module streq:\n   # Code from module strerror:\n   # Code from module strerror-override:\n+  # Code from module strerror_r-posix:\n   # Code from module string:\n   # Code from module strnlen1:\n   # Code from module strstr:\n@@ -175,6 +179,8 @@ AC_DEFUN([gl_EARLY],\n   # Code from module sys_types:\n   # Code from module sys_uio:\n   # Code from module tempname:\n+  # Code from module threadlib:\n+  gl_THREADLIB_EARLY\n   # Code from module time:\n   # Code from module unistd:\n   # Code from module unistd-safer:\n@@ -382,6 +388,8 @@ AC_DEFUN([gl_INIT],\n   gl_LOCALCHARSET\n   LOCALCHARSET_TESTS_ENVIRONMENT=\"CHARSETALIASDIR=\\\"\\$(abs_top_builddir)/$gl_source_base\\\"\"\n   AC_SUBST([LOCALCHARSET_TESTS_ENVIRONMENT])\n+  gl_LOCK\n+  gl_MODULE_INDICATOR([lock])\n   gl_FUNC_LSTAT\n   if test $REPLACE_LSTAT = 1; then\n     AC_LIBOBJ([lstat])\n@@ -576,6 +584,12 @@ AC_DEFUN([gl_INIT],\n     AC_LIBOBJ([strerror-override])\n     gl_PREREQ_SYS_H_WINSOCK2\n   fi\n+  gl_FUNC_STRERROR_R\n+  if test $HAVE_DECL_STRERROR_R = 0 || test $REPLACE_STRERROR_R = 1; then\n+    AC_LIBOBJ([strerror_r])\n+    gl_PREREQ_STRERROR_R\n+  fi\n+  gl_STRING_MODULE_INDICATOR([strerror_r])\n   gl_HEADER_STRING_H\n   gl_FUNC_STRSTR\n   if test $REPLACE_STRSTR = 1; then\n@@ -603,6 +617,7 @@ AC_DEFUN([gl_INIT],\n   gl_HEADER_SYS_UIO\n   AC_PROG_MKDIR_P\n   gl_FUNC_GEN_TEMPNAME\n+  gl_THREADLIB\n   gl_HEADER_TIME_H\n   gl_UNISTD_H\n   gl_UNISTD_SAFER\n@@ -754,6 +769,7 @@ AC_DEFUN([gltests_LIBSOURCES], [\n # This macro records the list of files which have been installed by\n # gnulib-tool and may be removed by future gnulib-tool invocations.\n AC_DEFUN([gl_FILE_LIST], [\n+  build-aux/config.rpath\n   build-aux/snippet/_Noreturn.h\n   build-aux/snippet/arg-nonnull.h\n   build-aux/snippet/c++defs.h\n@@ -820,6 +836,9 @@ AC_DEFUN([gl_FILE_LIST], [\n   lib/glob-libc.h\n   lib/glob.c\n   lib/glob.in.h\n+  lib/glthread/lock.c\n+  lib/glthread/lock.h\n+  lib/glthread/threadlib.c\n   lib/hard-locale.c\n   lib/hard-locale.h\n   lib/inet_ntop.c\n@@ -899,6 +918,7 @@ AC_DEFUN([gl_FILE_LIST], [\n   lib/strerror-override.c\n   lib/strerror-override.h\n   lib/strerror.c\n+  lib/strerror_r.c\n   lib/string.in.h\n   lib/stripslash.c\n   lib/strnlen1.c\n@@ -981,11 +1001,15 @@ AC_DEFUN([gl_FILE_LIST], [\n   m4/isnand.m4\n   m4/isnanl.m4\n   m4/largefile.m4\n+  m4/lib-ld.m4\n+  m4/lib-link.m4\n+  m4/lib-prefix.m4\n   m4/limits-h.m4\n   m4/localcharset.m4\n   m4/locale-fr.m4\n   m4/locale-ja.m4\n   m4/locale-zh.m4\n+  m4/lock.m4\n   m4/longlong.m4\n   m4/lstat.m4\n   m4/malloc.m4\n@@ -1039,6 +1063,7 @@ AC_DEFUN([gl_FILE_LIST], [\n   m4/strchrnul.m4\n   m4/strdup.m4\n   m4/strerror.m4\n+  m4/strerror_r.m4\n   m4/string_h.m4\n   m4/strstr.m4\n   m4/strtok_r.m4\n@@ -1048,6 +1073,7 @@ AC_DEFUN([gl_FILE_LIST], [\n   m4/sys_types_h.m4\n   m4/sys_uio_h.m4\n   m4/tempname.m4\n+  m4/threadlib.m4\n   m4/time_h.m4\n   m4/unistd-safer.m4\n   m4/unistd_h.m4"
    },
    {
      "sha": "6209de65d964341ed03575212bedb6807a227729",
      "filename": "gnulib/import/m4/lib-ld.m4",
      "status": "added",
      "additions": 119,
      "deletions": 0,
      "changes": 119,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/lib-ld.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/lib-ld.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/lib-ld.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,119 @@\n+# lib-ld.m4 serial 6\n+dnl Copyright (C) 1996-2003, 2009-2016 Free Software Foundation, Inc.\n+dnl This file is free software; the Free Software Foundation\n+dnl gives unlimited permission to copy and/or distribute it,\n+dnl with or without modifications, as long as this notice is preserved.\n+\n+dnl Subroutines of libtool.m4,\n+dnl with replacements s/_*LT_PATH/AC_LIB_PROG/ and s/lt_/acl_/ to avoid\n+dnl collision with libtool.m4.\n+\n+dnl From libtool-2.4. Sets the variable with_gnu_ld to yes or no.\n+AC_DEFUN([AC_LIB_PROG_LD_GNU],\n+[AC_CACHE_CHECK([if the linker ($LD) is GNU ld], [acl_cv_prog_gnu_ld],\n+[# I'd rather use --version here, but apparently some GNU lds only accept -v.\n+case `$LD -v 2>&1 </dev/null` in\n+*GNU* | *'with BFD'*)\n+  acl_cv_prog_gnu_ld=yes\n+  ;;\n+*)\n+  acl_cv_prog_gnu_ld=no\n+  ;;\n+esac])\n+with_gnu_ld=$acl_cv_prog_gnu_ld\n+])\n+\n+dnl From libtool-2.4. Sets the variable LD.\n+AC_DEFUN([AC_LIB_PROG_LD],\n+[AC_REQUIRE([AC_PROG_CC])dnl\n+AC_REQUIRE([AC_CANONICAL_HOST])dnl\n+\n+AC_ARG_WITH([gnu-ld],\n+    [AS_HELP_STRING([--with-gnu-ld],\n+        [assume the C compiler uses GNU ld [default=no]])],\n+    [test \"$withval\" = no || with_gnu_ld=yes],\n+    [with_gnu_ld=no])dnl\n+\n+# Prepare PATH_SEPARATOR.\n+# The user is always right.\n+if test \"${PATH_SEPARATOR+set}\" != set; then\n+  # Determine PATH_SEPARATOR by trying to find /bin/sh in a PATH which\n+  # contains only /bin. Note that ksh looks also at the FPATH variable,\n+  # so we have to set that as well for the test.\n+  PATH_SEPARATOR=:\n+  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 \\\n+    && { (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 \\\n+           || PATH_SEPARATOR=';'\n+       }\n+fi\n+\n+ac_prog=ld\n+if test \"$GCC\" = yes; then\n+  # Check if gcc -print-prog-name=ld gives a path.\n+  AC_MSG_CHECKING([for ld used by $CC])\n+  case $host in\n+  *-*-mingw*)\n+    # gcc leaves a trailing carriage return which upsets mingw\n+    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\\015'` ;;\n+  *)\n+    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;\n+  esac\n+  case $ac_prog in\n+    # Accept absolute paths.\n+    [[\\\\/]]* | ?:[[\\\\/]]*)\n+      re_direlt='/[[^/]][[^/]]*/\\.\\./'\n+      # Canonicalize the pathname of ld\n+      ac_prog=`echo \"$ac_prog\"| sed 's%\\\\\\\\%/%g'`\n+      while echo \"$ac_prog\" | grep \"$re_direlt\" > /dev/null 2>&1; do\n+        ac_prog=`echo $ac_prog| sed \"s%$re_direlt%/%\"`\n+      done\n+      test -z \"$LD\" && LD=\"$ac_prog\"\n+      ;;\n+  \"\")\n+    # If it fails, then pretend we aren't using GCC.\n+    ac_prog=ld\n+    ;;\n+  *)\n+    # If it is relative, then search for the first ld in PATH.\n+    with_gnu_ld=unknown\n+    ;;\n+  esac\n+elif test \"$with_gnu_ld\" = yes; then\n+  AC_MSG_CHECKING([for GNU ld])\n+else\n+  AC_MSG_CHECKING([for non-GNU ld])\n+fi\n+AC_CACHE_VAL([acl_cv_path_LD],\n+[if test -z \"$LD\"; then\n+  acl_save_ifs=\"$IFS\"; IFS=$PATH_SEPARATOR\n+  for ac_dir in $PATH; do\n+    IFS=\"$acl_save_ifs\"\n+    test -z \"$ac_dir\" && ac_dir=.\n+    if test -f \"$ac_dir/$ac_prog\" || test -f \"$ac_dir/$ac_prog$ac_exeext\"; then\n+      acl_cv_path_LD=\"$ac_dir/$ac_prog\"\n+      # Check to see if the program is GNU ld.  I'd rather use --version,\n+      # but apparently some variants of GNU ld only accept -v.\n+      # Break only if it was the GNU/non-GNU ld that we prefer.\n+      case `\"$acl_cv_path_LD\" -v 2>&1 </dev/null` in\n+      *GNU* | *'with BFD'*)\n+        test \"$with_gnu_ld\" != no && break\n+        ;;\n+      *)\n+        test \"$with_gnu_ld\" != yes && break\n+        ;;\n+      esac\n+    fi\n+  done\n+  IFS=\"$acl_save_ifs\"\n+else\n+  acl_cv_path_LD=\"$LD\" # Let the user override the test with a path.\n+fi])\n+LD=\"$acl_cv_path_LD\"\n+if test -n \"$LD\"; then\n+  AC_MSG_RESULT([$LD])\n+else\n+  AC_MSG_RESULT([no])\n+fi\n+test -z \"$LD\" && AC_MSG_ERROR([no acceptable ld found in \\$PATH])\n+AC_LIB_PROG_LD_GNU\n+])"
    },
    {
      "sha": "2f518553bc4a30a04c468216f427d45ce46caf8e",
      "filename": "gnulib/import/m4/lib-link.m4",
      "status": "added",
      "additions": 777,
      "deletions": 0,
      "changes": 777,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/lib-link.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/lib-link.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/lib-link.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,777 @@\n+# lib-link.m4 serial 26 (gettext-0.18.2)\n+dnl Copyright (C) 2001-2016 Free Software Foundation, Inc.\n+dnl This file is free software; the Free Software Foundation\n+dnl gives unlimited permission to copy and/or distribute it,\n+dnl with or without modifications, as long as this notice is preserved.\n+\n+dnl From Bruno Haible.\n+\n+AC_PREREQ([2.54])\n+\n+dnl AC_LIB_LINKFLAGS(name [, dependencies]) searches for libname and\n+dnl the libraries corresponding to explicit and implicit dependencies.\n+dnl Sets and AC_SUBSTs the LIB${NAME} and LTLIB${NAME} variables and\n+dnl augments the CPPFLAGS variable.\n+dnl Sets and AC_SUBSTs the LIB${NAME}_PREFIX variable to nonempty if libname\n+dnl was found in ${LIB${NAME}_PREFIX}/$acl_libdirstem.\n+AC_DEFUN([AC_LIB_LINKFLAGS],\n+[\n+  AC_REQUIRE([AC_LIB_PREPARE_PREFIX])\n+  AC_REQUIRE([AC_LIB_RPATH])\n+  pushdef([Name],[m4_translit([$1],[./+-], [____])])\n+  pushdef([NAME],[m4_translit([$1],[abcdefghijklmnopqrstuvwxyz./+-],\n+                                   [ABCDEFGHIJKLMNOPQRSTUVWXYZ____])])\n+  AC_CACHE_CHECK([how to link with lib[]$1], [ac_cv_lib[]Name[]_libs], [\n+    AC_LIB_LINKFLAGS_BODY([$1], [$2])\n+    ac_cv_lib[]Name[]_libs=\"$LIB[]NAME\"\n+    ac_cv_lib[]Name[]_ltlibs=\"$LTLIB[]NAME\"\n+    ac_cv_lib[]Name[]_cppflags=\"$INC[]NAME\"\n+    ac_cv_lib[]Name[]_prefix=\"$LIB[]NAME[]_PREFIX\"\n+  ])\n+  LIB[]NAME=\"$ac_cv_lib[]Name[]_libs\"\n+  LTLIB[]NAME=\"$ac_cv_lib[]Name[]_ltlibs\"\n+  INC[]NAME=\"$ac_cv_lib[]Name[]_cppflags\"\n+  LIB[]NAME[]_PREFIX=\"$ac_cv_lib[]Name[]_prefix\"\n+  AC_LIB_APPENDTOVAR([CPPFLAGS], [$INC]NAME)\n+  AC_SUBST([LIB]NAME)\n+  AC_SUBST([LTLIB]NAME)\n+  AC_SUBST([LIB]NAME[_PREFIX])\n+  dnl Also set HAVE_LIB[]NAME so that AC_LIB_HAVE_LINKFLAGS can reuse the\n+  dnl results of this search when this library appears as a dependency.\n+  HAVE_LIB[]NAME=yes\n+  popdef([NAME])\n+  popdef([Name])\n+])\n+\n+dnl AC_LIB_HAVE_LINKFLAGS(name, dependencies, includes, testcode, [missing-message])\n+dnl searches for libname and the libraries corresponding to explicit and\n+dnl implicit dependencies, together with the specified include files and\n+dnl the ability to compile and link the specified testcode. The missing-message\n+dnl defaults to 'no' and may contain additional hints for the user.\n+dnl If found, it sets and AC_SUBSTs HAVE_LIB${NAME}=yes and the LIB${NAME}\n+dnl and LTLIB${NAME} variables and augments the CPPFLAGS variable, and\n+dnl #defines HAVE_LIB${NAME} to 1. Otherwise, it sets and AC_SUBSTs\n+dnl HAVE_LIB${NAME}=no and LIB${NAME} and LTLIB${NAME} to empty.\n+dnl Sets and AC_SUBSTs the LIB${NAME}_PREFIX variable to nonempty if libname\n+dnl was found in ${LIB${NAME}_PREFIX}/$acl_libdirstem.\n+AC_DEFUN([AC_LIB_HAVE_LINKFLAGS],\n+[\n+  AC_REQUIRE([AC_LIB_PREPARE_PREFIX])\n+  AC_REQUIRE([AC_LIB_RPATH])\n+  pushdef([Name],[m4_translit([$1],[./+-], [____])])\n+  pushdef([NAME],[m4_translit([$1],[abcdefghijklmnopqrstuvwxyz./+-],\n+                                   [ABCDEFGHIJKLMNOPQRSTUVWXYZ____])])\n+\n+  dnl Search for lib[]Name and define LIB[]NAME, LTLIB[]NAME and INC[]NAME\n+  dnl accordingly.\n+  AC_LIB_LINKFLAGS_BODY([$1], [$2])\n+\n+  dnl Add $INC[]NAME to CPPFLAGS before performing the following checks,\n+  dnl because if the user has installed lib[]Name and not disabled its use\n+  dnl via --without-lib[]Name-prefix, he wants to use it.\n+  ac_save_CPPFLAGS=\"$CPPFLAGS\"\n+  AC_LIB_APPENDTOVAR([CPPFLAGS], [$INC]NAME)\n+\n+  AC_CACHE_CHECK([for lib[]$1], [ac_cv_lib[]Name], [\n+    ac_save_LIBS=\"$LIBS\"\n+    dnl If $LIB[]NAME contains some -l options, add it to the end of LIBS,\n+    dnl because these -l options might require -L options that are present in\n+    dnl LIBS. -l options benefit only from the -L options listed before it.\n+    dnl Otherwise, add it to the front of LIBS, because it may be a static\n+    dnl library that depends on another static library that is present in LIBS.\n+    dnl Static libraries benefit only from the static libraries listed after\n+    dnl it.\n+    case \" $LIB[]NAME\" in\n+      *\" -l\"*) LIBS=\"$LIBS $LIB[]NAME\" ;;\n+      *)       LIBS=\"$LIB[]NAME $LIBS\" ;;\n+    esac\n+    AC_LINK_IFELSE(\n+      [AC_LANG_PROGRAM([[$3]], [[$4]])],\n+      [ac_cv_lib[]Name=yes],\n+      [ac_cv_lib[]Name='m4_if([$5], [], [no], [[$5]])'])\n+    LIBS=\"$ac_save_LIBS\"\n+  ])\n+  if test \"$ac_cv_lib[]Name\" = yes; then\n+    HAVE_LIB[]NAME=yes\n+    AC_DEFINE([HAVE_LIB]NAME, 1, [Define if you have the lib][$1 library.])\n+    AC_MSG_CHECKING([how to link with lib[]$1])\n+    AC_MSG_RESULT([$LIB[]NAME])\n+  else\n+    HAVE_LIB[]NAME=no\n+    dnl If $LIB[]NAME didn't lead to a usable library, we don't need\n+    dnl $INC[]NAME either.\n+    CPPFLAGS=\"$ac_save_CPPFLAGS\"\n+    LIB[]NAME=\n+    LTLIB[]NAME=\n+    LIB[]NAME[]_PREFIX=\n+  fi\n+  AC_SUBST([HAVE_LIB]NAME)\n+  AC_SUBST([LIB]NAME)\n+  AC_SUBST([LTLIB]NAME)\n+  AC_SUBST([LIB]NAME[_PREFIX])\n+  popdef([NAME])\n+  popdef([Name])\n+])\n+\n+dnl Determine the platform dependent parameters needed to use rpath:\n+dnl   acl_libext,\n+dnl   acl_shlibext,\n+dnl   acl_libname_spec,\n+dnl   acl_library_names_spec,\n+dnl   acl_hardcode_libdir_flag_spec,\n+dnl   acl_hardcode_libdir_separator,\n+dnl   acl_hardcode_direct,\n+dnl   acl_hardcode_minus_L.\n+AC_DEFUN([AC_LIB_RPATH],\n+[\n+  dnl Tell automake >= 1.10 to complain if config.rpath is missing.\n+  m4_ifdef([AC_REQUIRE_AUX_FILE], [AC_REQUIRE_AUX_FILE([config.rpath])])\n+  AC_REQUIRE([AC_PROG_CC])                dnl we use $CC, $GCC, $LDFLAGS\n+  AC_REQUIRE([AC_LIB_PROG_LD])            dnl we use $LD, $with_gnu_ld\n+  AC_REQUIRE([AC_CANONICAL_HOST])         dnl we use $host\n+  AC_REQUIRE([AC_CONFIG_AUX_DIR_DEFAULT]) dnl we use $ac_aux_dir\n+  AC_CACHE_CHECK([for shared library run path origin], [acl_cv_rpath], [\n+    CC=\"$CC\" GCC=\"$GCC\" LDFLAGS=\"$LDFLAGS\" LD=\"$LD\" with_gnu_ld=\"$with_gnu_ld\" \\\n+    ${CONFIG_SHELL-/bin/sh} \"$ac_aux_dir/config.rpath\" \"$host\" > conftest.sh\n+    . ./conftest.sh\n+    rm -f ./conftest.sh\n+    acl_cv_rpath=done\n+  ])\n+  wl=\"$acl_cv_wl\"\n+  acl_libext=\"$acl_cv_libext\"\n+  acl_shlibext=\"$acl_cv_shlibext\"\n+  acl_libname_spec=\"$acl_cv_libname_spec\"\n+  acl_library_names_spec=\"$acl_cv_library_names_spec\"\n+  acl_hardcode_libdir_flag_spec=\"$acl_cv_hardcode_libdir_flag_spec\"\n+  acl_hardcode_libdir_separator=\"$acl_cv_hardcode_libdir_separator\"\n+  acl_hardcode_direct=\"$acl_cv_hardcode_direct\"\n+  acl_hardcode_minus_L=\"$acl_cv_hardcode_minus_L\"\n+  dnl Determine whether the user wants rpath handling at all.\n+  AC_ARG_ENABLE([rpath],\n+    [  --disable-rpath         do not hardcode runtime library paths],\n+    :, enable_rpath=yes)\n+])\n+\n+dnl AC_LIB_FROMPACKAGE(name, package)\n+dnl declares that libname comes from the given package. The configure file\n+dnl will then not have a --with-libname-prefix option but a\n+dnl --with-package-prefix option. Several libraries can come from the same\n+dnl package. This declaration must occur before an AC_LIB_LINKFLAGS or similar\n+dnl macro call that searches for libname.\n+AC_DEFUN([AC_LIB_FROMPACKAGE],\n+[\n+  pushdef([NAME],[m4_translit([$1],[abcdefghijklmnopqrstuvwxyz./+-],\n+                                   [ABCDEFGHIJKLMNOPQRSTUVWXYZ____])])\n+  define([acl_frompackage_]NAME, [$2])\n+  popdef([NAME])\n+  pushdef([PACK],[$2])\n+  pushdef([PACKUP],[m4_translit(PACK,[abcdefghijklmnopqrstuvwxyz./+-],\n+                                     [ABCDEFGHIJKLMNOPQRSTUVWXYZ____])])\n+  define([acl_libsinpackage_]PACKUP,\n+    m4_ifdef([acl_libsinpackage_]PACKUP, [m4_defn([acl_libsinpackage_]PACKUP)[, ]],)[lib$1])\n+  popdef([PACKUP])\n+  popdef([PACK])\n+])\n+\n+dnl AC_LIB_LINKFLAGS_BODY(name [, dependencies]) searches for libname and\n+dnl the libraries corresponding to explicit and implicit dependencies.\n+dnl Sets the LIB${NAME}, LTLIB${NAME} and INC${NAME} variables.\n+dnl Also, sets the LIB${NAME}_PREFIX variable to nonempty if libname was found\n+dnl in ${LIB${NAME}_PREFIX}/$acl_libdirstem.\n+AC_DEFUN([AC_LIB_LINKFLAGS_BODY],\n+[\n+  AC_REQUIRE([AC_LIB_PREPARE_MULTILIB])\n+  pushdef([NAME],[m4_translit([$1],[abcdefghijklmnopqrstuvwxyz./+-],\n+                                   [ABCDEFGHIJKLMNOPQRSTUVWXYZ____])])\n+  pushdef([PACK],[m4_ifdef([acl_frompackage_]NAME, [acl_frompackage_]NAME, lib[$1])])\n+  pushdef([PACKUP],[m4_translit(PACK,[abcdefghijklmnopqrstuvwxyz./+-],\n+                                     [ABCDEFGHIJKLMNOPQRSTUVWXYZ____])])\n+  pushdef([PACKLIBS],[m4_ifdef([acl_frompackage_]NAME, [acl_libsinpackage_]PACKUP, lib[$1])])\n+  dnl Autoconf >= 2.61 supports dots in --with options.\n+  pushdef([P_A_C_K],[m4_if(m4_version_compare(m4_defn([m4_PACKAGE_VERSION]),[2.61]),[-1],[m4_translit(PACK,[.],[_])],PACK)])\n+  dnl By default, look in $includedir and $libdir.\n+  use_additional=yes\n+  AC_LIB_WITH_FINAL_PREFIX([\n+    eval additional_includedir=\\\"$includedir\\\"\n+    eval additional_libdir=\\\"$libdir\\\"\n+  ])\n+  AC_ARG_WITH(P_A_C_K[-prefix],\n+[[  --with-]]P_A_C_K[[-prefix[=DIR]  search for ]PACKLIBS[ in DIR/include and DIR/lib\n+  --without-]]P_A_C_K[[-prefix     don't search for ]PACKLIBS[ in includedir and libdir]],\n+[\n+    if test \"X$withval\" = \"Xno\"; then\n+      use_additional=no\n+    else\n+      if test \"X$withval\" = \"X\"; then\n+        AC_LIB_WITH_FINAL_PREFIX([\n+          eval additional_includedir=\\\"$includedir\\\"\n+          eval additional_libdir=\\\"$libdir\\\"\n+        ])\n+      else\n+        additional_includedir=\"$withval/include\"\n+        additional_libdir=\"$withval/$acl_libdirstem\"\n+        if test \"$acl_libdirstem2\" != \"$acl_libdirstem\" \\\n+           && ! test -d \"$withval/$acl_libdirstem\"; then\n+          additional_libdir=\"$withval/$acl_libdirstem2\"\n+        fi\n+      fi\n+    fi\n+])\n+  dnl Search the library and its dependencies in $additional_libdir and\n+  dnl $LDFLAGS. Using breadth-first-seach.\n+  LIB[]NAME=\n+  LTLIB[]NAME=\n+  INC[]NAME=\n+  LIB[]NAME[]_PREFIX=\n+  dnl HAVE_LIB${NAME} is an indicator that LIB${NAME}, LTLIB${NAME} have been\n+  dnl computed. So it has to be reset here.\n+  HAVE_LIB[]NAME=\n+  rpathdirs=\n+  ltrpathdirs=\n+  names_already_handled=\n+  names_next_round='$1 $2'\n+  while test -n \"$names_next_round\"; do\n+    names_this_round=\"$names_next_round\"\n+    names_next_round=\n+    for name in $names_this_round; do\n+      already_handled=\n+      for n in $names_already_handled; do\n+        if test \"$n\" = \"$name\"; then\n+          already_handled=yes\n+          break\n+        fi\n+      done\n+      if test -z \"$already_handled\"; then\n+        names_already_handled=\"$names_already_handled $name\"\n+        dnl See if it was already located by an earlier AC_LIB_LINKFLAGS\n+        dnl or AC_LIB_HAVE_LINKFLAGS call.\n+        uppername=`echo \"$name\" | sed -e 'y|abcdefghijklmnopqrstuvwxyz./+-|ABCDEFGHIJKLMNOPQRSTUVWXYZ____|'`\n+        eval value=\\\"\\$HAVE_LIB$uppername\\\"\n+        if test -n \"$value\"; then\n+          if test \"$value\" = yes; then\n+            eval value=\\\"\\$LIB$uppername\\\"\n+            test -z \"$value\" || LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$value\"\n+            eval value=\\\"\\$LTLIB$uppername\\\"\n+            test -z \"$value\" || LTLIB[]NAME=\"${LTLIB[]NAME}${LTLIB[]NAME:+ }$value\"\n+          else\n+            dnl An earlier call to AC_LIB_HAVE_LINKFLAGS has determined\n+            dnl that this library doesn't exist. So just drop it.\n+            :\n+          fi\n+        else\n+          dnl Search the library lib$name in $additional_libdir and $LDFLAGS\n+          dnl and the already constructed $LIBNAME/$LTLIBNAME.\n+          found_dir=\n+          found_la=\n+          found_so=\n+          found_a=\n+          eval libname=\\\"$acl_libname_spec\\\"    # typically: libname=lib$name\n+          if test -n \"$acl_shlibext\"; then\n+            shrext=\".$acl_shlibext\"             # typically: shrext=.so\n+          else\n+            shrext=\n+          fi\n+          if test $use_additional = yes; then\n+            dir=\"$additional_libdir\"\n+            dnl The same code as in the loop below:\n+            dnl First look for a shared library.\n+            if test -n \"$acl_shlibext\"; then\n+              if test -f \"$dir/$libname$shrext\"; then\n+                found_dir=\"$dir\"\n+                found_so=\"$dir/$libname$shrext\"\n+              else\n+                if test \"$acl_library_names_spec\" = '$libname$shrext$versuffix'; then\n+                  ver=`(cd \"$dir\" && \\\n+                        for f in \"$libname$shrext\".*; do echo \"$f\"; done \\\n+                        | sed -e \"s,^$libname$shrext\\\\\\\\.,,\" \\\n+                        | sort -t '.' -n -r -k1,1 -k2,2 -k3,3 -k4,4 -k5,5 \\\n+                        | sed 1q ) 2>/dev/null`\n+                  if test -n \"$ver\" && test -f \"$dir/$libname$shrext.$ver\"; then\n+                    found_dir=\"$dir\"\n+                    found_so=\"$dir/$libname$shrext.$ver\"\n+                  fi\n+                else\n+                  eval library_names=\\\"$acl_library_names_spec\\\"\n+                  for f in $library_names; do\n+                    if test -f \"$dir/$f\"; then\n+                      found_dir=\"$dir\"\n+                      found_so=\"$dir/$f\"\n+                      break\n+                    fi\n+                  done\n+                fi\n+              fi\n+            fi\n+            dnl Then look for a static library.\n+            if test \"X$found_dir\" = \"X\"; then\n+              if test -f \"$dir/$libname.$acl_libext\"; then\n+                found_dir=\"$dir\"\n+                found_a=\"$dir/$libname.$acl_libext\"\n+              fi\n+            fi\n+            if test \"X$found_dir\" != \"X\"; then\n+              if test -f \"$dir/$libname.la\"; then\n+                found_la=\"$dir/$libname.la\"\n+              fi\n+            fi\n+          fi\n+          if test \"X$found_dir\" = \"X\"; then\n+            for x in $LDFLAGS $LTLIB[]NAME; do\n+              AC_LIB_WITH_FINAL_PREFIX([eval x=\\\"$x\\\"])\n+              case \"$x\" in\n+                -L*)\n+                  dir=`echo \"X$x\" | sed -e 's/^X-L//'`\n+                  dnl First look for a shared library.\n+                  if test -n \"$acl_shlibext\"; then\n+                    if test -f \"$dir/$libname$shrext\"; then\n+                      found_dir=\"$dir\"\n+                      found_so=\"$dir/$libname$shrext\"\n+                    else\n+                      if test \"$acl_library_names_spec\" = '$libname$shrext$versuffix'; then\n+                        ver=`(cd \"$dir\" && \\\n+                              for f in \"$libname$shrext\".*; do echo \"$f\"; done \\\n+                              | sed -e \"s,^$libname$shrext\\\\\\\\.,,\" \\\n+                              | sort -t '.' -n -r -k1,1 -k2,2 -k3,3 -k4,4 -k5,5 \\\n+                              | sed 1q ) 2>/dev/null`\n+                        if test -n \"$ver\" && test -f \"$dir/$libname$shrext.$ver\"; then\n+                          found_dir=\"$dir\"\n+                          found_so=\"$dir/$libname$shrext.$ver\"\n+                        fi\n+                      else\n+                        eval library_names=\\\"$acl_library_names_spec\\\"\n+                        for f in $library_names; do\n+                          if test -f \"$dir/$f\"; then\n+                            found_dir=\"$dir\"\n+                            found_so=\"$dir/$f\"\n+                            break\n+                          fi\n+                        done\n+                      fi\n+                    fi\n+                  fi\n+                  dnl Then look for a static library.\n+                  if test \"X$found_dir\" = \"X\"; then\n+                    if test -f \"$dir/$libname.$acl_libext\"; then\n+                      found_dir=\"$dir\"\n+                      found_a=\"$dir/$libname.$acl_libext\"\n+                    fi\n+                  fi\n+                  if test \"X$found_dir\" != \"X\"; then\n+                    if test -f \"$dir/$libname.la\"; then\n+                      found_la=\"$dir/$libname.la\"\n+                    fi\n+                  fi\n+                  ;;\n+              esac\n+              if test \"X$found_dir\" != \"X\"; then\n+                break\n+              fi\n+            done\n+          fi\n+          if test \"X$found_dir\" != \"X\"; then\n+            dnl Found the library.\n+            LTLIB[]NAME=\"${LTLIB[]NAME}${LTLIB[]NAME:+ }-L$found_dir -l$name\"\n+            if test \"X$found_so\" != \"X\"; then\n+              dnl Linking with a shared library. We attempt to hardcode its\n+              dnl directory into the executable's runpath, unless it's the\n+              dnl standard /usr/lib.\n+              if test \"$enable_rpath\" = no \\\n+                 || test \"X$found_dir\" = \"X/usr/$acl_libdirstem\" \\\n+                 || test \"X$found_dir\" = \"X/usr/$acl_libdirstem2\"; then\n+                dnl No hardcoding is needed.\n+                LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$found_so\"\n+              else\n+                dnl Use an explicit option to hardcode DIR into the resulting\n+                dnl binary.\n+                dnl Potentially add DIR to ltrpathdirs.\n+                dnl The ltrpathdirs will be appended to $LTLIBNAME at the end.\n+                haveit=\n+                for x in $ltrpathdirs; do\n+                  if test \"X$x\" = \"X$found_dir\"; then\n+                    haveit=yes\n+                    break\n+                  fi\n+                done\n+                if test -z \"$haveit\"; then\n+                  ltrpathdirs=\"$ltrpathdirs $found_dir\"\n+                fi\n+                dnl The hardcoding into $LIBNAME is system dependent.\n+                if test \"$acl_hardcode_direct\" = yes; then\n+                  dnl Using DIR/libNAME.so during linking hardcodes DIR into the\n+                  dnl resulting binary.\n+                  LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$found_so\"\n+                else\n+                  if test -n \"$acl_hardcode_libdir_flag_spec\" && test \"$acl_hardcode_minus_L\" = no; then\n+                    dnl Use an explicit option to hardcode DIR into the resulting\n+                    dnl binary.\n+                    LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$found_so\"\n+                    dnl Potentially add DIR to rpathdirs.\n+                    dnl The rpathdirs will be appended to $LIBNAME at the end.\n+                    haveit=\n+                    for x in $rpathdirs; do\n+                      if test \"X$x\" = \"X$found_dir\"; then\n+                        haveit=yes\n+                        break\n+                      fi\n+                    done\n+                    if test -z \"$haveit\"; then\n+                      rpathdirs=\"$rpathdirs $found_dir\"\n+                    fi\n+                  else\n+                    dnl Rely on \"-L$found_dir\".\n+                    dnl But don't add it if it's already contained in the LDFLAGS\n+                    dnl or the already constructed $LIBNAME\n+                    haveit=\n+                    for x in $LDFLAGS $LIB[]NAME; do\n+                      AC_LIB_WITH_FINAL_PREFIX([eval x=\\\"$x\\\"])\n+                      if test \"X$x\" = \"X-L$found_dir\"; then\n+                        haveit=yes\n+                        break\n+                      fi\n+                    done\n+                    if test -z \"$haveit\"; then\n+                      LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }-L$found_dir\"\n+                    fi\n+                    if test \"$acl_hardcode_minus_L\" != no; then\n+                      dnl FIXME: Not sure whether we should use\n+                      dnl \"-L$found_dir -l$name\" or \"-L$found_dir $found_so\"\n+                      dnl here.\n+                      LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$found_so\"\n+                    else\n+                      dnl We cannot use $acl_hardcode_runpath_var and LD_RUN_PATH\n+                      dnl here, because this doesn't fit in flags passed to the\n+                      dnl compiler. So give up. No hardcoding. This affects only\n+                      dnl very old systems.\n+                      dnl FIXME: Not sure whether we should use\n+                      dnl \"-L$found_dir -l$name\" or \"-L$found_dir $found_so\"\n+                      dnl here.\n+                      LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }-l$name\"\n+                    fi\n+                  fi\n+                fi\n+              fi\n+            else\n+              if test \"X$found_a\" != \"X\"; then\n+                dnl Linking with a static library.\n+                LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$found_a\"\n+              else\n+                dnl We shouldn't come here, but anyway it's good to have a\n+                dnl fallback.\n+                LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }-L$found_dir -l$name\"\n+              fi\n+            fi\n+            dnl Assume the include files are nearby.\n+            additional_includedir=\n+            case \"$found_dir\" in\n+              */$acl_libdirstem | */$acl_libdirstem/)\n+                basedir=`echo \"X$found_dir\" | sed -e 's,^X,,' -e \"s,/$acl_libdirstem/\"'*$,,'`\n+                if test \"$name\" = '$1'; then\n+                  LIB[]NAME[]_PREFIX=\"$basedir\"\n+                fi\n+                additional_includedir=\"$basedir/include\"\n+                ;;\n+              */$acl_libdirstem2 | */$acl_libdirstem2/)\n+                basedir=`echo \"X$found_dir\" | sed -e 's,^X,,' -e \"s,/$acl_libdirstem2/\"'*$,,'`\n+                if test \"$name\" = '$1'; then\n+                  LIB[]NAME[]_PREFIX=\"$basedir\"\n+                fi\n+                additional_includedir=\"$basedir/include\"\n+                ;;\n+            esac\n+            if test \"X$additional_includedir\" != \"X\"; then\n+              dnl Potentially add $additional_includedir to $INCNAME.\n+              dnl But don't add it\n+              dnl   1. if it's the standard /usr/include,\n+              dnl   2. if it's /usr/local/include and we are using GCC on Linux,\n+              dnl   3. if it's already present in $CPPFLAGS or the already\n+              dnl      constructed $INCNAME,\n+              dnl   4. if it doesn't exist as a directory.\n+              if test \"X$additional_includedir\" != \"X/usr/include\"; then\n+                haveit=\n+                if test \"X$additional_includedir\" = \"X/usr/local/include\"; then\n+                  if test -n \"$GCC\"; then\n+                    case $host_os in\n+                      linux* | gnu* | k*bsd*-gnu) haveit=yes;;\n+                    esac\n+                  fi\n+                fi\n+                if test -z \"$haveit\"; then\n+                  for x in $CPPFLAGS $INC[]NAME; do\n+                    AC_LIB_WITH_FINAL_PREFIX([eval x=\\\"$x\\\"])\n+                    if test \"X$x\" = \"X-I$additional_includedir\"; then\n+                      haveit=yes\n+                      break\n+                    fi\n+                  done\n+                  if test -z \"$haveit\"; then\n+                    if test -d \"$additional_includedir\"; then\n+                      dnl Really add $additional_includedir to $INCNAME.\n+                      INC[]NAME=\"${INC[]NAME}${INC[]NAME:+ }-I$additional_includedir\"\n+                    fi\n+                  fi\n+                fi\n+              fi\n+            fi\n+            dnl Look for dependencies.\n+            if test -n \"$found_la\"; then\n+              dnl Read the .la file. It defines the variables\n+              dnl dlname, library_names, old_library, dependency_libs, current,\n+              dnl age, revision, installed, dlopen, dlpreopen, libdir.\n+              save_libdir=\"$libdir\"\n+              case \"$found_la\" in\n+                */* | *\\\\*) . \"$found_la\" ;;\n+                *) . \"./$found_la\" ;;\n+              esac\n+              libdir=\"$save_libdir\"\n+              dnl We use only dependency_libs.\n+              for dep in $dependency_libs; do\n+                case \"$dep\" in\n+                  -L*)\n+                    additional_libdir=`echo \"X$dep\" | sed -e 's/^X-L//'`\n+                    dnl Potentially add $additional_libdir to $LIBNAME and $LTLIBNAME.\n+                    dnl But don't add it\n+                    dnl   1. if it's the standard /usr/lib,\n+                    dnl   2. if it's /usr/local/lib and we are using GCC on Linux,\n+                    dnl   3. if it's already present in $LDFLAGS or the already\n+                    dnl      constructed $LIBNAME,\n+                    dnl   4. if it doesn't exist as a directory.\n+                    if test \"X$additional_libdir\" != \"X/usr/$acl_libdirstem\" \\\n+                       && test \"X$additional_libdir\" != \"X/usr/$acl_libdirstem2\"; then\n+                      haveit=\n+                      if test \"X$additional_libdir\" = \"X/usr/local/$acl_libdirstem\" \\\n+                         || test \"X$additional_libdir\" = \"X/usr/local/$acl_libdirstem2\"; then\n+                        if test -n \"$GCC\"; then\n+                          case $host_os in\n+                            linux* | gnu* | k*bsd*-gnu) haveit=yes;;\n+                          esac\n+                        fi\n+                      fi\n+                      if test -z \"$haveit\"; then\n+                        haveit=\n+                        for x in $LDFLAGS $LIB[]NAME; do\n+                          AC_LIB_WITH_FINAL_PREFIX([eval x=\\\"$x\\\"])\n+                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n+                            haveit=yes\n+                            break\n+                          fi\n+                        done\n+                        if test -z \"$haveit\"; then\n+                          if test -d \"$additional_libdir\"; then\n+                            dnl Really add $additional_libdir to $LIBNAME.\n+                            LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }-L$additional_libdir\"\n+                          fi\n+                        fi\n+                        haveit=\n+                        for x in $LDFLAGS $LTLIB[]NAME; do\n+                          AC_LIB_WITH_FINAL_PREFIX([eval x=\\\"$x\\\"])\n+                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n+                            haveit=yes\n+                            break\n+                          fi\n+                        done\n+                        if test -z \"$haveit\"; then\n+                          if test -d \"$additional_libdir\"; then\n+                            dnl Really add $additional_libdir to $LTLIBNAME.\n+                            LTLIB[]NAME=\"${LTLIB[]NAME}${LTLIB[]NAME:+ }-L$additional_libdir\"\n+                          fi\n+                        fi\n+                      fi\n+                    fi\n+                    ;;\n+                  -R*)\n+                    dir=`echo \"X$dep\" | sed -e 's/^X-R//'`\n+                    if test \"$enable_rpath\" != no; then\n+                      dnl Potentially add DIR to rpathdirs.\n+                      dnl The rpathdirs will be appended to $LIBNAME at the end.\n+                      haveit=\n+                      for x in $rpathdirs; do\n+                        if test \"X$x\" = \"X$dir\"; then\n+                          haveit=yes\n+                          break\n+                        fi\n+                      done\n+                      if test -z \"$haveit\"; then\n+                        rpathdirs=\"$rpathdirs $dir\"\n+                      fi\n+                      dnl Potentially add DIR to ltrpathdirs.\n+                      dnl The ltrpathdirs will be appended to $LTLIBNAME at the end.\n+                      haveit=\n+                      for x in $ltrpathdirs; do\n+                        if test \"X$x\" = \"X$dir\"; then\n+                          haveit=yes\n+                          break\n+                        fi\n+                      done\n+                      if test -z \"$haveit\"; then\n+                        ltrpathdirs=\"$ltrpathdirs $dir\"\n+                      fi\n+                    fi\n+                    ;;\n+                  -l*)\n+                    dnl Handle this in the next round.\n+                    names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's/^X-l//'`\n+                    ;;\n+                  *.la)\n+                    dnl Handle this in the next round. Throw away the .la's\n+                    dnl directory; it is already contained in a preceding -L\n+                    dnl option.\n+                    names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's,^X.*/,,' -e 's,^lib,,' -e 's,\\.la$,,'`\n+                    ;;\n+                  *)\n+                    dnl Most likely an immediate library name.\n+                    LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$dep\"\n+                    LTLIB[]NAME=\"${LTLIB[]NAME}${LTLIB[]NAME:+ }$dep\"\n+                    ;;\n+                esac\n+              done\n+            fi\n+          else\n+            dnl Didn't find the library; assume it is in the system directories\n+            dnl known to the linker and runtime loader. (All the system\n+            dnl directories known to the linker should also be known to the\n+            dnl runtime loader, otherwise the system is severely misconfigured.)\n+            LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }-l$name\"\n+            LTLIB[]NAME=\"${LTLIB[]NAME}${LTLIB[]NAME:+ }-l$name\"\n+          fi\n+        fi\n+      fi\n+    done\n+  done\n+  if test \"X$rpathdirs\" != \"X\"; then\n+    if test -n \"$acl_hardcode_libdir_separator\"; then\n+      dnl Weird platform: only the last -rpath option counts, the user must\n+      dnl pass all path elements in one option. We can arrange that for a\n+      dnl single library, but not when more than one $LIBNAMEs are used.\n+      alldirs=\n+      for found_dir in $rpathdirs; do\n+        alldirs=\"${alldirs}${alldirs:+$acl_hardcode_libdir_separator}$found_dir\"\n+      done\n+      dnl Note: acl_hardcode_libdir_flag_spec uses $libdir and $wl.\n+      acl_save_libdir=\"$libdir\"\n+      libdir=\"$alldirs\"\n+      eval flag=\\\"$acl_hardcode_libdir_flag_spec\\\"\n+      libdir=\"$acl_save_libdir\"\n+      LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$flag\"\n+    else\n+      dnl The -rpath options are cumulative.\n+      for found_dir in $rpathdirs; do\n+        acl_save_libdir=\"$libdir\"\n+        libdir=\"$found_dir\"\n+        eval flag=\\\"$acl_hardcode_libdir_flag_spec\\\"\n+        libdir=\"$acl_save_libdir\"\n+        LIB[]NAME=\"${LIB[]NAME}${LIB[]NAME:+ }$flag\"\n+      done\n+    fi\n+  fi\n+  if test \"X$ltrpathdirs\" != \"X\"; then\n+    dnl When using libtool, the option that works for both libraries and\n+    dnl executables is -R. The -R options are cumulative.\n+    for found_dir in $ltrpathdirs; do\n+      LTLIB[]NAME=\"${LTLIB[]NAME}${LTLIB[]NAME:+ }-R$found_dir\"\n+    done\n+  fi\n+  popdef([P_A_C_K])\n+  popdef([PACKLIBS])\n+  popdef([PACKUP])\n+  popdef([PACK])\n+  popdef([NAME])\n+])\n+\n+dnl AC_LIB_APPENDTOVAR(VAR, CONTENTS) appends the elements of CONTENTS to VAR,\n+dnl unless already present in VAR.\n+dnl Works only for CPPFLAGS, not for LIB* variables because that sometimes\n+dnl contains two or three consecutive elements that belong together.\n+AC_DEFUN([AC_LIB_APPENDTOVAR],\n+[\n+  for element in [$2]; do\n+    haveit=\n+    for x in $[$1]; do\n+      AC_LIB_WITH_FINAL_PREFIX([eval x=\\\"$x\\\"])\n+      if test \"X$x\" = \"X$element\"; then\n+        haveit=yes\n+        break\n+      fi\n+    done\n+    if test -z \"$haveit\"; then\n+      [$1]=\"${[$1]}${[$1]:+ }$element\"\n+    fi\n+  done\n+])\n+\n+dnl For those cases where a variable contains several -L and -l options\n+dnl referring to unknown libraries and directories, this macro determines the\n+dnl necessary additional linker options for the runtime path.\n+dnl AC_LIB_LINKFLAGS_FROM_LIBS([LDADDVAR], [LIBSVALUE], [USE-LIBTOOL])\n+dnl sets LDADDVAR to linker options needed together with LIBSVALUE.\n+dnl If USE-LIBTOOL evaluates to non-empty, linking with libtool is assumed,\n+dnl otherwise linking without libtool is assumed.\n+AC_DEFUN([AC_LIB_LINKFLAGS_FROM_LIBS],\n+[\n+  AC_REQUIRE([AC_LIB_RPATH])\n+  AC_REQUIRE([AC_LIB_PREPARE_MULTILIB])\n+  $1=\n+  if test \"$enable_rpath\" != no; then\n+    if test -n \"$acl_hardcode_libdir_flag_spec\" && test \"$acl_hardcode_minus_L\" = no; then\n+      dnl Use an explicit option to hardcode directories into the resulting\n+      dnl binary.\n+      rpathdirs=\n+      next=\n+      for opt in $2; do\n+        if test -n \"$next\"; then\n+          dir=\"$next\"\n+          dnl No need to hardcode the standard /usr/lib.\n+          if test \"X$dir\" != \"X/usr/$acl_libdirstem\" \\\n+             && test \"X$dir\" != \"X/usr/$acl_libdirstem2\"; then\n+            rpathdirs=\"$rpathdirs $dir\"\n+          fi\n+          next=\n+        else\n+          case $opt in\n+            -L) next=yes ;;\n+            -L*) dir=`echo \"X$opt\" | sed -e 's,^X-L,,'`\n+                 dnl No need to hardcode the standard /usr/lib.\n+                 if test \"X$dir\" != \"X/usr/$acl_libdirstem\" \\\n+                    && test \"X$dir\" != \"X/usr/$acl_libdirstem2\"; then\n+                   rpathdirs=\"$rpathdirs $dir\"\n+                 fi\n+                 next= ;;\n+            *) next= ;;\n+          esac\n+        fi\n+      done\n+      if test \"X$rpathdirs\" != \"X\"; then\n+        if test -n \"\"$3\"\"; then\n+          dnl libtool is used for linking. Use -R options.\n+          for dir in $rpathdirs; do\n+            $1=\"${$1}${$1:+ }-R$dir\"\n+          done\n+        else\n+          dnl The linker is used for linking directly.\n+          if test -n \"$acl_hardcode_libdir_separator\"; then\n+            dnl Weird platform: only the last -rpath option counts, the user\n+            dnl must pass all path elements in one option.\n+            alldirs=\n+            for dir in $rpathdirs; do\n+              alldirs=\"${alldirs}${alldirs:+$acl_hardcode_libdir_separator}$dir\"\n+            done\n+            acl_save_libdir=\"$libdir\"\n+            libdir=\"$alldirs\"\n+            eval flag=\\\"$acl_hardcode_libdir_flag_spec\\\"\n+            libdir=\"$acl_save_libdir\"\n+            $1=\"$flag\"\n+          else\n+            dnl The -rpath options are cumulative.\n+            for dir in $rpathdirs; do\n+              acl_save_libdir=\"$libdir\"\n+              libdir=\"$dir\"\n+              eval flag=\\\"$acl_hardcode_libdir_flag_spec\\\"\n+              libdir=\"$acl_save_libdir\"\n+              $1=\"${$1}${$1:+ }$flag\"\n+            done\n+          fi\n+        fi\n+      fi\n+    fi\n+  fi\n+  AC_SUBST([$1])\n+])"
    },
    {
      "sha": "6851031d3913feb62dda2184793969a01bb09b51",
      "filename": "gnulib/import/m4/lib-prefix.m4",
      "status": "added",
      "additions": 224,
      "deletions": 0,
      "changes": 224,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/lib-prefix.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/lib-prefix.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/lib-prefix.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,224 @@\n+# lib-prefix.m4 serial 7 (gettext-0.18)\n+dnl Copyright (C) 2001-2005, 2008-2016 Free Software Foundation, Inc.\n+dnl This file is free software; the Free Software Foundation\n+dnl gives unlimited permission to copy and/or distribute it,\n+dnl with or without modifications, as long as this notice is preserved.\n+\n+dnl From Bruno Haible.\n+\n+dnl AC_LIB_ARG_WITH is synonymous to AC_ARG_WITH in autoconf-2.13, and\n+dnl similar to AC_ARG_WITH in autoconf 2.52...2.57 except that is doesn't\n+dnl require excessive bracketing.\n+ifdef([AC_HELP_STRING],\n+[AC_DEFUN([AC_LIB_ARG_WITH], [AC_ARG_WITH([$1],[[$2]],[$3],[$4])])],\n+[AC_DEFUN([AC_][LIB_ARG_WITH], [AC_ARG_WITH([$1],[$2],[$3],[$4])])])\n+\n+dnl AC_LIB_PREFIX adds to the CPPFLAGS and LDFLAGS the flags that are needed\n+dnl to access previously installed libraries. The basic assumption is that\n+dnl a user will want packages to use other packages he previously installed\n+dnl with the same --prefix option.\n+dnl This macro is not needed if only AC_LIB_LINKFLAGS is used to locate\n+dnl libraries, but is otherwise very convenient.\n+AC_DEFUN([AC_LIB_PREFIX],\n+[\n+  AC_BEFORE([$0], [AC_LIB_LINKFLAGS])\n+  AC_REQUIRE([AC_PROG_CC])\n+  AC_REQUIRE([AC_CANONICAL_HOST])\n+  AC_REQUIRE([AC_LIB_PREPARE_MULTILIB])\n+  AC_REQUIRE([AC_LIB_PREPARE_PREFIX])\n+  dnl By default, look in $includedir and $libdir.\n+  use_additional=yes\n+  AC_LIB_WITH_FINAL_PREFIX([\n+    eval additional_includedir=\\\"$includedir\\\"\n+    eval additional_libdir=\\\"$libdir\\\"\n+  ])\n+  AC_LIB_ARG_WITH([lib-prefix],\n+[  --with-lib-prefix[=DIR] search for libraries in DIR/include and DIR/lib\n+  --without-lib-prefix    don't search for libraries in includedir and libdir],\n+[\n+    if test \"X$withval\" = \"Xno\"; then\n+      use_additional=no\n+    else\n+      if test \"X$withval\" = \"X\"; then\n+        AC_LIB_WITH_FINAL_PREFIX([\n+          eval additional_includedir=\\\"$includedir\\\"\n+          eval additional_libdir=\\\"$libdir\\\"\n+        ])\n+      else\n+        additional_includedir=\"$withval/include\"\n+        additional_libdir=\"$withval/$acl_libdirstem\"\n+      fi\n+    fi\n+])\n+  if test $use_additional = yes; then\n+    dnl Potentially add $additional_includedir to $CPPFLAGS.\n+    dnl But don't add it\n+    dnl   1. if it's the standard /usr/include,\n+    dnl   2. if it's already present in $CPPFLAGS,\n+    dnl   3. if it's /usr/local/include and we are using GCC on Linux,\n+    dnl   4. if it doesn't exist as a directory.\n+    if test \"X$additional_includedir\" != \"X/usr/include\"; then\n+      haveit=\n+      for x in $CPPFLAGS; do\n+        AC_LIB_WITH_FINAL_PREFIX([eval x=\\\"$x\\\"])\n+        if test \"X$x\" = \"X-I$additional_includedir\"; then\n+          haveit=yes\n+          break\n+        fi\n+      done\n+      if test -z \"$haveit\"; then\n+        if test \"X$additional_includedir\" = \"X/usr/local/include\"; then\n+          if test -n \"$GCC\"; then\n+            case $host_os in\n+              linux* | gnu* | k*bsd*-gnu) haveit=yes;;\n+            esac\n+          fi\n+        fi\n+        if test -z \"$haveit\"; then\n+          if test -d \"$additional_includedir\"; then\n+            dnl Really add $additional_includedir to $CPPFLAGS.\n+            CPPFLAGS=\"${CPPFLAGS}${CPPFLAGS:+ }-I$additional_includedir\"\n+          fi\n+        fi\n+      fi\n+    fi\n+    dnl Potentially add $additional_libdir to $LDFLAGS.\n+    dnl But don't add it\n+    dnl   1. if it's the standard /usr/lib,\n+    dnl   2. if it's already present in $LDFLAGS,\n+    dnl   3. if it's /usr/local/lib and we are using GCC on Linux,\n+    dnl   4. if it doesn't exist as a directory.\n+    if test \"X$additional_libdir\" != \"X/usr/$acl_libdirstem\"; then\n+      haveit=\n+      for x in $LDFLAGS; do\n+        AC_LIB_WITH_FINAL_PREFIX([eval x=\\\"$x\\\"])\n+        if test \"X$x\" = \"X-L$additional_libdir\"; then\n+          haveit=yes\n+          break\n+        fi\n+      done\n+      if test -z \"$haveit\"; then\n+        if test \"X$additional_libdir\" = \"X/usr/local/$acl_libdirstem\"; then\n+          if test -n \"$GCC\"; then\n+            case $host_os in\n+              linux*) haveit=yes;;\n+            esac\n+          fi\n+        fi\n+        if test -z \"$haveit\"; then\n+          if test -d \"$additional_libdir\"; then\n+            dnl Really add $additional_libdir to $LDFLAGS.\n+            LDFLAGS=\"${LDFLAGS}${LDFLAGS:+ }-L$additional_libdir\"\n+          fi\n+        fi\n+      fi\n+    fi\n+  fi\n+])\n+\n+dnl AC_LIB_PREPARE_PREFIX creates variables acl_final_prefix,\n+dnl acl_final_exec_prefix, containing the values to which $prefix and\n+dnl $exec_prefix will expand at the end of the configure script.\n+AC_DEFUN([AC_LIB_PREPARE_PREFIX],\n+[\n+  dnl Unfortunately, prefix and exec_prefix get only finally determined\n+  dnl at the end of configure.\n+  if test \"X$prefix\" = \"XNONE\"; then\n+    acl_final_prefix=\"$ac_default_prefix\"\n+  else\n+    acl_final_prefix=\"$prefix\"\n+  fi\n+  if test \"X$exec_prefix\" = \"XNONE\"; then\n+    acl_final_exec_prefix='${prefix}'\n+  else\n+    acl_final_exec_prefix=\"$exec_prefix\"\n+  fi\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  eval acl_final_exec_prefix=\\\"$acl_final_exec_prefix\\\"\n+  prefix=\"$acl_save_prefix\"\n+])\n+\n+dnl AC_LIB_WITH_FINAL_PREFIX([statement]) evaluates statement, with the\n+dnl variables prefix and exec_prefix bound to the values they will have\n+dnl at the end of the configure script.\n+AC_DEFUN([AC_LIB_WITH_FINAL_PREFIX],\n+[\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  $1\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+])\n+\n+dnl AC_LIB_PREPARE_MULTILIB creates\n+dnl - a variable acl_libdirstem, containing the basename of the libdir, either\n+dnl   \"lib\" or \"lib64\" or \"lib/64\",\n+dnl - a variable acl_libdirstem2, as a secondary possible value for\n+dnl   acl_libdirstem, either the same as acl_libdirstem or \"lib/sparcv9\" or\n+dnl   \"lib/amd64\".\n+AC_DEFUN([AC_LIB_PREPARE_MULTILIB],\n+[\n+  dnl There is no formal standard regarding lib and lib64.\n+  dnl On glibc systems, the current practice is that on a system supporting\n+  dnl 32-bit and 64-bit instruction sets or ABIs, 64-bit libraries go under\n+  dnl $prefix/lib64 and 32-bit libraries go under $prefix/lib. We determine\n+  dnl the compiler's default mode by looking at the compiler's library search\n+  dnl path. If at least one of its elements ends in /lib64 or points to a\n+  dnl directory whose absolute pathname ends in /lib64, we assume a 64-bit ABI.\n+  dnl Otherwise we use the default, namely \"lib\".\n+  dnl On Solaris systems, the current practice is that on a system supporting\n+  dnl 32-bit and 64-bit instruction sets or ABIs, 64-bit libraries go under\n+  dnl $prefix/lib/64 (which is a symlink to either $prefix/lib/sparcv9 or\n+  dnl $prefix/lib/amd64) and 32-bit libraries go under $prefix/lib.\n+  AC_REQUIRE([AC_CANONICAL_HOST])\n+  acl_libdirstem=lib\n+  acl_libdirstem2=\n+  case \"$host_os\" in\n+    solaris*)\n+      dnl See Solaris 10 Software Developer Collection > Solaris 64-bit Developer's Guide > The Development Environment\n+      dnl <http://docs.sun.com/app/docs/doc/816-5138/dev-env?l=en&a=view>.\n+      dnl \"Portable Makefiles should refer to any library directories using the 64 symbolic link.\"\n+      dnl But we want to recognize the sparcv9 or amd64 subdirectory also if the\n+      dnl symlink is missing, so we set acl_libdirstem2 too.\n+      AC_CACHE_CHECK([for 64-bit host], [gl_cv_solaris_64bit],\n+        [AC_EGREP_CPP([sixtyfour bits], [\n+#ifdef _LP64\n+sixtyfour bits\n+#endif\n+           ], [gl_cv_solaris_64bit=yes], [gl_cv_solaris_64bit=no])\n+        ])\n+      if test $gl_cv_solaris_64bit = yes; then\n+        acl_libdirstem=lib/64\n+        case \"$host_cpu\" in\n+          sparc*)        acl_libdirstem2=lib/sparcv9 ;;\n+          i*86 | x86_64) acl_libdirstem2=lib/amd64 ;;\n+        esac\n+      fi\n+      ;;\n+    *)\n+      searchpath=`(LC_ALL=C $CC -print-search-dirs) 2>/dev/null | sed -n -e 's,^libraries: ,,p' | sed -e 's,^=,,'`\n+      if test -n \"$searchpath\"; then\n+        acl_save_IFS=\"${IFS= \t}\"; IFS=\":\"\n+        for searchdir in $searchpath; do\n+          if test -d \"$searchdir\"; then\n+            case \"$searchdir\" in\n+              */lib64/ | */lib64 ) acl_libdirstem=lib64 ;;\n+              */../ | */.. )\n+                # Better ignore directories of this form. They are misleading.\n+                ;;\n+              *) searchdir=`cd \"$searchdir\" && pwd`\n+                 case \"$searchdir\" in\n+                   */lib64 ) acl_libdirstem=lib64 ;;\n+                 esac ;;\n+            esac\n+          fi\n+        done\n+        IFS=\"$acl_save_IFS\"\n+      fi\n+      ;;\n+  esac\n+  test -n \"$acl_libdirstem2\" || acl_libdirstem2=\"$acl_libdirstem\"\n+])"
    },
    {
      "sha": "1e83e23651f8d877cb8ea2fc49971cd5c489842e",
      "filename": "gnulib/import/m4/lock.m4",
      "status": "added",
      "additions": 42,
      "deletions": 0,
      "changes": 42,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/lock.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/lock.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/lock.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,42 @@\n+# lock.m4 serial 13 (gettext-0.18.2)\n+dnl Copyright (C) 2005-2016 Free Software Foundation, Inc.\n+dnl This file is free software; the Free Software Foundation\n+dnl gives unlimited permission to copy and/or distribute it,\n+dnl with or without modifications, as long as this notice is preserved.\n+\n+dnl From Bruno Haible.\n+\n+AC_DEFUN([gl_LOCK],\n+[\n+  AC_REQUIRE([gl_THREADLIB])\n+  if test \"$gl_threads_api\" = posix; then\n+    # OSF/1 4.0 and Mac OS X 10.1 lack the pthread_rwlock_t type and the\n+    # pthread_rwlock_* functions.\n+    AC_CHECK_TYPE([pthread_rwlock_t],\n+      [AC_DEFINE([HAVE_PTHREAD_RWLOCK], [1],\n+         [Define if the POSIX multithreading library has read/write locks.])],\n+      [],\n+      [#include <pthread.h>])\n+    # glibc defines PTHREAD_MUTEX_RECURSIVE as enum, not as a macro.\n+    AC_COMPILE_IFELSE([\n+      AC_LANG_PROGRAM(\n+        [[#include <pthread.h>]],\n+        [[\n+#if __FreeBSD__ == 4\n+error \"No, in FreeBSD 4.0 recursive mutexes actually don't work.\"\n+#elif (defined __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ \\\n+       && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ < 1070)\n+error \"No, in Mac OS X < 10.7 recursive mutexes actually don't work.\"\n+#else\n+int x = (int)PTHREAD_MUTEX_RECURSIVE;\n+return !x;\n+#endif\n+        ]])],\n+      [AC_DEFINE([HAVE_PTHREAD_MUTEX_RECURSIVE], [1],\n+         [Define if the <pthread.h> defines PTHREAD_MUTEX_RECURSIVE.])])\n+  fi\n+  gl_PREREQ_LOCK\n+])\n+\n+# Prerequisites of lib/glthread/lock.c.\n+AC_DEFUN([gl_PREREQ_LOCK], [:])"
    },
    {
      "sha": "aa0ea44bd6ff42e30d119b403852c5ba640be432",
      "filename": "gnulib/import/m4/strerror_r.m4",
      "status": "added",
      "additions": 187,
      "deletions": 0,
      "changes": 187,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/strerror_r.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/strerror_r.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/strerror_r.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,187 @@\n+# strerror_r.m4 serial 18\n+dnl Copyright (C) 2002, 2007-2016 Free Software Foundation, Inc.\n+dnl This file is free software; the Free Software Foundation\n+dnl gives unlimited permission to copy and/or distribute it,\n+dnl with or without modifications, as long as this notice is preserved.\n+\n+AC_DEFUN([gl_FUNC_STRERROR_R],\n+[\n+  AC_REQUIRE([gl_HEADER_STRING_H_DEFAULTS])\n+  AC_REQUIRE([gl_FUNC_STRERROR_R_WORKS])\n+\n+  dnl Persuade Solaris <string.h> to declare strerror_r().\n+  AC_REQUIRE([gl_USE_SYSTEM_EXTENSIONS])\n+\n+  dnl Some systems don't declare strerror_r() if _THREAD_SAFE and _REENTRANT\n+  dnl are not defined.\n+  AC_CHECK_DECL([strerror_r],\n+    [HAVE_DECL_STRERROR_R=1], [HAVE_DECL_STRERROR_R=0])\n+  AC_DEFINE_UNQUOTED([HAVE_DECL_STRERROR_R_ORIG], [$HAVE_DECL_STRERROR_R],\n+    [Define to 1 if you have the declaration of 'strerror_r' in the system include files, or to 0 otherwise.])\n+\n+  if test $ac_cv_func_strerror_r = yes; then\n+    if test \"$ERRNO_H:$REPLACE_STRERROR_0\" = :0; then\n+      if test $gl_cv_func_strerror_r_posix_signature = yes; then\n+        case \"$gl_cv_func_strerror_r_works\" in\n+          dnl The system's strerror_r has bugs.  Replace it.\n+          *no) REPLACE_STRERROR_R=1 ;;\n+        esac\n+      else\n+        dnl The system's strerror_r() has a wrong signature. Replace it.\n+        REPLACE_STRERROR_R=1\n+      fi\n+    else\n+      dnl The system's strerror_r() cannot know about the new errno values we\n+      dnl add to <errno.h>, or any fix for strerror(0). Replace it.\n+      REPLACE_STRERROR_R=1\n+    fi\n+  fi\n+\n+  # Overwrite the findings of AC_FUNC_STRERROR_R (for code that uses that).\n+  AC_REQUIRE([AC_FUNC_STRERROR_R])\n+])\n+\n+# If this module is in use, we unconditionally want POSIX semantics; so\n+# replace autoconf's macro with a version that does not probe\n+AC_DEFUN([AC_FUNC_STRERROR_R], [\n+  AC_DEFINE([HAVE_DECL_STRERROR_R], [1],\n+    [Define to 1, since you should have the declaration of strerror_r.])\n+  AC_DEFINE([HAVE_STRERROR_R], [1],\n+    [Define to 1, since you should have the function strerror_r.])\n+  AC_DEFINE([STRERROR_R_CHAR_P], [0],\n+    [Define to 0, since strerror_r should not return char *.])\n+])\n+\n+# Prerequisites of lib/strerror_r.c.\n+AC_DEFUN([gl_PREREQ_STRERROR_R], [\n+  dnl glibc >= 2.3.4 and cygwin 1.7.9 have a function __xpg_strerror_r.\n+  AC_CHECK_FUNCS_ONCE([__xpg_strerror_r])\n+  AC_CHECK_FUNCS_ONCE([catgets])\n+  AC_CHECK_FUNCS_ONCE([snprintf])\n+])\n+\n+# Detect if strerror_r works, but without affecting whether a replacement\n+# strerror_r will be used.\n+AC_DEFUN([gl_FUNC_STRERROR_R_WORKS],\n+[\n+  AC_REQUIRE([gl_HEADER_ERRNO_H])\n+  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n+  AC_REQUIRE([gl_FUNC_STRERROR_0])\n+\n+  AC_CHECK_FUNC([strerror_r])\n+  if test $ac_cv_func_strerror_r = yes; then\n+    if test \"$ERRNO_H:$REPLACE_STRERROR_0\" = :0; then\n+      dnl The POSIX prototype is:  int strerror_r (int, char *, size_t);\n+      dnl glibc, Cygwin:           char *strerror_r (int, char *, size_t);\n+      dnl AIX 5.1, OSF/1 5.1:      int strerror_r (int, char *, int);\n+      AC_CACHE_CHECK([for strerror_r with POSIX signature],\n+        [gl_cv_func_strerror_r_posix_signature],\n+        [AC_COMPILE_IFELSE(\n+           [AC_LANG_PROGRAM(\n+              [[#include <string.h>\n+                int strerror_r (int, char *, size_t);\n+              ]],\n+              [])],\n+           [gl_cv_func_strerror_r_posix_signature=yes],\n+           [gl_cv_func_strerror_r_posix_signature=no])\n+        ])\n+      if test $gl_cv_func_strerror_r_posix_signature = yes; then\n+        dnl AIX 6.1 strerror_r fails by returning -1, not an error number.\n+        dnl HP-UX 11.31 strerror_r always fails when the buffer length argument\n+        dnl is less than 80.\n+        dnl FreeBSD 8.s strerror_r claims failure on 0\n+        dnl Mac OS X 10.5 strerror_r treats 0 like -1\n+        dnl Solaris 10 strerror_r corrupts errno on failure\n+        AC_CACHE_CHECK([whether strerror_r works],\n+          [gl_cv_func_strerror_r_works],\n+          [AC_RUN_IFELSE(\n+             [AC_LANG_PROGRAM(\n+                [[#include <errno.h>\n+                  #include <string.h>\n+                ]],\n+                [[int result = 0;\n+                  char buf[79];\n+                  if (strerror_r (EACCES, buf, 0) < 0)\n+                    result |= 1;\n+                  errno = 0;\n+                  if (strerror_r (EACCES, buf, sizeof buf) != 0)\n+                    result |= 2;\n+                  strcpy (buf, \"Unknown\");\n+                  if (strerror_r (0, buf, sizeof buf) != 0)\n+                    result |= 4;\n+                  if (errno)\n+                    result |= 8;\n+                  if (strstr (buf, \"nknown\") || strstr (buf, \"ndefined\"))\n+                    result |= 0x10;\n+                  errno = 0;\n+                  *buf = 0;\n+                  if (strerror_r (-3, buf, sizeof buf) < 0)\n+                    result |= 0x20;\n+                  if (errno)\n+                    result |= 0x40;\n+                  if (!*buf)\n+                    result |= 0x80;\n+                  return result;\n+                ]])],\n+             [gl_cv_func_strerror_r_works=yes],\n+             [gl_cv_func_strerror_r_works=no],\n+             [\n+changequote(,)dnl\n+              case \"$host_os\" in\n+                       # Guess no on AIX.\n+                aix*)  gl_cv_func_strerror_r_works=\"guessing no\";;\n+                       # Guess no on HP-UX.\n+                hpux*) gl_cv_func_strerror_r_works=\"guessing no\";;\n+                       # Guess no on BSD variants.\n+                *bsd*)  gl_cv_func_strerror_r_works=\"guessing no\";;\n+                       # Guess yes otherwise.\n+                *)     gl_cv_func_strerror_r_works=\"guessing yes\";;\n+              esac\n+changequote([,])dnl\n+             ])\n+          ])\n+      else\n+        dnl The system's strerror() has a wrong signature.\n+        dnl glibc >= 2.3.4 and cygwin 1.7.9 have a function __xpg_strerror_r.\n+        AC_CHECK_FUNCS_ONCE([__xpg_strerror_r])\n+        dnl In glibc < 2.14, __xpg_strerror_r does not populate buf on failure.\n+        dnl In cygwin < 1.7.10, __xpg_strerror_r clobbers strerror's buffer.\n+        if test $ac_cv_func___xpg_strerror_r = yes; then\n+          AC_CACHE_CHECK([whether __xpg_strerror_r works],\n+            [gl_cv_func_strerror_r_works],\n+            [AC_RUN_IFELSE(\n+               [AC_LANG_PROGRAM(\n+                  [[#include <errno.h>\n+                    #include <string.h>\n+                    extern\n+                    #ifdef __cplusplus\n+                    \"C\"\n+                    #endif\n+                    int __xpg_strerror_r(int, char *, size_t);\n+                  ]],\n+                  [[int result = 0;\n+                    char buf[256] = \"^\";\n+                    char copy[256];\n+                    char *str = strerror (-1);\n+                    strcpy (copy, str);\n+                    if (__xpg_strerror_r (-2, buf, 1) == 0)\n+                      result |= 1;\n+                    if (*buf)\n+                      result |= 2;\n+                    __xpg_strerror_r (-2, buf, 256);\n+                    if (strcmp (str, copy))\n+                      result |= 4;\n+                    return result;\n+                  ]])],\n+               [gl_cv_func_strerror_r_works=yes],\n+               [gl_cv_func_strerror_r_works=no],\n+               [dnl Guess no on all platforms that have __xpg_strerror_r,\n+                dnl at least until fixed glibc and cygwin are more common.\n+                gl_cv_func_strerror_r_works=\"guessing no\"\n+               ])\n+            ])\n+        fi\n+      fi\n+    fi\n+  fi\n+])"
    },
    {
      "sha": "b43534ea278493cb78eb75d716fc44ff5a206834",
      "filename": "gnulib/import/m4/threadlib.m4",
      "status": "added",
      "additions": 389,
      "deletions": 0,
      "changes": 389,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/threadlib.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/m4/threadlib.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/threadlib.m4?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,389 @@\n+# threadlib.m4 serial 11 (gettext-0.18.2)\n+dnl Copyright (C) 2005-2016 Free Software Foundation, Inc.\n+dnl This file is free software; the Free Software Foundation\n+dnl gives unlimited permission to copy and/or distribute it,\n+dnl with or without modifications, as long as this notice is preserved.\n+\n+dnl From Bruno Haible.\n+\n+dnl gl_THREADLIB\n+dnl ------------\n+dnl Tests for a multithreading library to be used.\n+dnl If the configure.ac contains a definition of the gl_THREADLIB_DEFAULT_NO\n+dnl (it must be placed before the invocation of gl_THREADLIB_EARLY!), then the\n+dnl default is 'no', otherwise it is system dependent. In both cases, the user\n+dnl can change the choice through the options --enable-threads=choice or\n+dnl --disable-threads.\n+dnl Defines at most one of the macros USE_POSIX_THREADS, USE_SOLARIS_THREADS,\n+dnl USE_PTH_THREADS, USE_WINDOWS_THREADS\n+dnl Sets the variables LIBTHREAD and LTLIBTHREAD to the linker options for use\n+dnl in a Makefile (LIBTHREAD for use without libtool, LTLIBTHREAD for use with\n+dnl libtool).\n+dnl Sets the variables LIBMULTITHREAD and LTLIBMULTITHREAD similarly, for\n+dnl programs that really need multithread functionality. The difference\n+dnl between LIBTHREAD and LIBMULTITHREAD is that on platforms supporting weak\n+dnl symbols, typically LIBTHREAD is empty whereas LIBMULTITHREAD is not.\n+dnl Adds to CPPFLAGS the flag -D_REENTRANT or -D_THREAD_SAFE if needed for\n+dnl multithread-safe programs.\n+\n+AC_DEFUN([gl_THREADLIB_EARLY],\n+[\n+  AC_REQUIRE([gl_THREADLIB_EARLY_BODY])\n+])\n+\n+dnl The guts of gl_THREADLIB_EARLY. Needs to be expanded only once.\n+\n+AC_DEFUN([gl_THREADLIB_EARLY_BODY],\n+[\n+  dnl Ordering constraints: This macro modifies CPPFLAGS in a way that\n+  dnl influences the result of the autoconf tests that test for *_unlocked\n+  dnl declarations, on AIX 5 at least. Therefore it must come early.\n+  AC_BEFORE([$0], [gl_FUNC_GLIBC_UNLOCKED_IO])dnl\n+  AC_BEFORE([$0], [gl_ARGP])dnl\n+\n+  AC_REQUIRE([AC_CANONICAL_HOST])\n+  dnl _GNU_SOURCE is needed for pthread_rwlock_t on glibc systems.\n+  dnl AC_USE_SYSTEM_EXTENSIONS was introduced in autoconf 2.60 and obsoletes\n+  dnl AC_GNU_SOURCE.\n+  m4_ifdef([AC_USE_SYSTEM_EXTENSIONS],\n+    [AC_REQUIRE([AC_USE_SYSTEM_EXTENSIONS])],\n+    [AC_REQUIRE([AC_GNU_SOURCE])])\n+  dnl Check for multithreading.\n+  m4_ifdef([gl_THREADLIB_DEFAULT_NO],\n+    [m4_divert_text([DEFAULTS], [gl_use_threads_default=no])],\n+    [m4_divert_text([DEFAULTS], [gl_use_threads_default=])])\n+  AC_ARG_ENABLE([threads],\n+AC_HELP_STRING([--enable-threads={posix|solaris|pth|windows}], [specify multithreading API])m4_ifdef([gl_THREADLIB_DEFAULT_NO], [], [\n+AC_HELP_STRING([--disable-threads], [build without multithread safety])]),\n+    [gl_use_threads=$enableval],\n+    [if test -n \"$gl_use_threads_default\"; then\n+       gl_use_threads=\"$gl_use_threads_default\"\n+     else\n+changequote(,)dnl\n+       case \"$host_os\" in\n+         dnl Disable multithreading by default on OSF/1, because it interferes\n+         dnl with fork()/exec(): When msgexec is linked with -lpthread, its\n+         dnl child process gets an endless segmentation fault inside execvp().\n+         dnl Disable multithreading by default on Cygwin 1.5.x, because it has\n+         dnl bugs that lead to endless loops or crashes. See\n+         dnl <http://cygwin.com/ml/cygwin/2009-08/msg00283.html>.\n+         osf*) gl_use_threads=no ;;\n+         cygwin*)\n+               case `uname -r` in\n+                 1.[0-5].*) gl_use_threads=no ;;\n+                 *)         gl_use_threads=yes ;;\n+               esac\n+               ;;\n+         *)    gl_use_threads=yes ;;\n+       esac\n+changequote([,])dnl\n+     fi\n+    ])\n+  if test \"$gl_use_threads\" = yes || test \"$gl_use_threads\" = posix; then\n+    # For using <pthread.h>:\n+    case \"$host_os\" in\n+      osf*)\n+        # On OSF/1, the compiler needs the flag -D_REENTRANT so that it\n+        # groks <pthread.h>. cc also understands the flag -pthread, but\n+        # we don't use it because 1. gcc-2.95 doesn't understand -pthread,\n+        # 2. putting a flag into CPPFLAGS that has an effect on the linker\n+        # causes the AC_LINK_IFELSE test below to succeed unexpectedly,\n+        # leading to wrong values of LIBTHREAD and LTLIBTHREAD.\n+        CPPFLAGS=\"$CPPFLAGS -D_REENTRANT\"\n+        ;;\n+    esac\n+    # Some systems optimize for single-threaded programs by default, and\n+    # need special flags to disable these optimizations. For example, the\n+    # definition of 'errno' in <errno.h>.\n+    case \"$host_os\" in\n+      aix* | freebsd*) CPPFLAGS=\"$CPPFLAGS -D_THREAD_SAFE\" ;;\n+      solaris*) CPPFLAGS=\"$CPPFLAGS -D_REENTRANT\" ;;\n+    esac\n+  fi\n+])\n+\n+dnl The guts of gl_THREADLIB. Needs to be expanded only once.\n+\n+AC_DEFUN([gl_THREADLIB_BODY],\n+[\n+  AC_REQUIRE([gl_THREADLIB_EARLY_BODY])\n+  gl_threads_api=none\n+  LIBTHREAD=\n+  LTLIBTHREAD=\n+  LIBMULTITHREAD=\n+  LTLIBMULTITHREAD=\n+  if test \"$gl_use_threads\" != no; then\n+    dnl Check whether the compiler and linker support weak declarations.\n+    AC_CACHE_CHECK([whether imported symbols can be declared weak],\n+      [gl_cv_have_weak],\n+      [gl_cv_have_weak=no\n+       dnl First, test whether the compiler accepts it syntactically.\n+       AC_LINK_IFELSE(\n+         [AC_LANG_PROGRAM(\n+            [[extern void xyzzy ();\n+#pragma weak xyzzy]],\n+            [[xyzzy();]])],\n+         [gl_cv_have_weak=maybe])\n+       if test $gl_cv_have_weak = maybe; then\n+         dnl Second, test whether it actually works. On Cygwin 1.7.2, with\n+         dnl gcc 4.3, symbols declared weak always evaluate to the address 0.\n+         AC_RUN_IFELSE(\n+           [AC_LANG_SOURCE([[\n+#include <stdio.h>\n+#pragma weak fputs\n+int main ()\n+{\n+  return (fputs == NULL);\n+}]])],\n+           [gl_cv_have_weak=yes],\n+           [gl_cv_have_weak=no],\n+           [dnl When cross-compiling, assume that only ELF platforms support\n+            dnl weak symbols.\n+            AC_EGREP_CPP([Extensible Linking Format],\n+              [#ifdef __ELF__\n+               Extensible Linking Format\n+               #endif\n+              ],\n+              [gl_cv_have_weak=\"guessing yes\"],\n+              [gl_cv_have_weak=\"guessing no\"])\n+           ])\n+       fi\n+      ])\n+    if test \"$gl_use_threads\" = yes || test \"$gl_use_threads\" = posix; then\n+      # On OSF/1, the compiler needs the flag -pthread or -D_REENTRANT so that\n+      # it groks <pthread.h>. It's added above, in gl_THREADLIB_EARLY_BODY.\n+      AC_CHECK_HEADER([pthread.h],\n+        [gl_have_pthread_h=yes], [gl_have_pthread_h=no])\n+      if test \"$gl_have_pthread_h\" = yes; then\n+        # Other possible tests:\n+        #   -lpthreads (FSU threads, PCthreads)\n+        #   -lgthreads\n+        gl_have_pthread=\n+        # Test whether both pthread_mutex_lock and pthread_mutexattr_init exist\n+        # in libc. IRIX 6.5 has the first one in both libc and libpthread, but\n+        # the second one only in libpthread, and lock.c needs it.\n+        #\n+        # If -pthread works, prefer it to -lpthread, since Ubuntu 14.04\n+        # needs -pthread for some reason.  See:\n+        # http://lists.gnu.org/archive/html/bug-gnulib/2014-09/msg00023.html\n+        save_LIBS=$LIBS\n+        for gl_pthread in '' '-pthread'; do\n+          LIBS=\"$LIBS $gl_pthread\"\n+          AC_LINK_IFELSE(\n+            [AC_LANG_PROGRAM(\n+               [[#include <pthread.h>\n+                 pthread_mutex_t m;\n+                 pthread_mutexattr_t ma;\n+               ]],\n+               [[pthread_mutex_lock (&m);\n+                 pthread_mutexattr_init (&ma);]])],\n+            [gl_have_pthread=yes\n+             LIBTHREAD=$gl_pthread LTLIBTHREAD=$gl_pthread\n+             LIBMULTITHREAD=$gl_pthread LTLIBMULTITHREAD=$gl_pthread])\n+          LIBS=$save_LIBS\n+          test -n \"$gl_have_pthread\" && break\n+        done\n+\n+        # Test for libpthread by looking for pthread_kill. (Not pthread_self,\n+        # since it is defined as a macro on OSF/1.)\n+        if test -n \"$gl_have_pthread\" && test -z \"$LIBTHREAD\"; then\n+          # The program links fine without libpthread. But it may actually\n+          # need to link with libpthread in order to create multiple threads.\n+          AC_CHECK_LIB([pthread], [pthread_kill],\n+            [LIBMULTITHREAD=-lpthread LTLIBMULTITHREAD=-lpthread\n+             # On Solaris and HP-UX, most pthread functions exist also in libc.\n+             # Therefore pthread_in_use() needs to actually try to create a\n+             # thread: pthread_create from libc will fail, whereas\n+             # pthread_create will actually create a thread.\n+             case \"$host_os\" in\n+               solaris* | hpux*)\n+                 AC_DEFINE([PTHREAD_IN_USE_DETECTION_HARD], [1],\n+                   [Define if the pthread_in_use() detection is hard.])\n+             esac\n+            ])\n+        elif test -z \"$gl_have_pthread\"; then\n+          # Some library is needed. Try libpthread and libc_r.\n+          AC_CHECK_LIB([pthread], [pthread_kill],\n+            [gl_have_pthread=yes\n+             LIBTHREAD=-lpthread LTLIBTHREAD=-lpthread\n+             LIBMULTITHREAD=-lpthread LTLIBMULTITHREAD=-lpthread])\n+          if test -z \"$gl_have_pthread\"; then\n+            # For FreeBSD 4.\n+            AC_CHECK_LIB([c_r], [pthread_kill],\n+              [gl_have_pthread=yes\n+               LIBTHREAD=-lc_r LTLIBTHREAD=-lc_r\n+               LIBMULTITHREAD=-lc_r LTLIBMULTITHREAD=-lc_r])\n+          fi\n+        fi\n+        if test -n \"$gl_have_pthread\"; then\n+          gl_threads_api=posix\n+          AC_DEFINE([USE_POSIX_THREADS], [1],\n+            [Define if the POSIX multithreading library can be used.])\n+          if test -n \"$LIBMULTITHREAD\" || test -n \"$LTLIBMULTITHREAD\"; then\n+            if case \"$gl_cv_have_weak\" in *yes) true;; *) false;; esac; then\n+              AC_DEFINE([USE_POSIX_THREADS_WEAK], [1],\n+                [Define if references to the POSIX multithreading library should be made weak.])\n+              LIBTHREAD=\n+              LTLIBTHREAD=\n+            fi\n+          fi\n+        fi\n+      fi\n+    fi\n+    if test -z \"$gl_have_pthread\"; then\n+      if test \"$gl_use_threads\" = yes || test \"$gl_use_threads\" = solaris; then\n+        gl_have_solaristhread=\n+        gl_save_LIBS=\"$LIBS\"\n+        LIBS=\"$LIBS -lthread\"\n+        AC_LINK_IFELSE(\n+          [AC_LANG_PROGRAM(\n+             [[\n+#include <thread.h>\n+#include <synch.h>\n+             ]],\n+             [[thr_self();]])],\n+          [gl_have_solaristhread=yes])\n+        LIBS=\"$gl_save_LIBS\"\n+        if test -n \"$gl_have_solaristhread\"; then\n+          gl_threads_api=solaris\n+          LIBTHREAD=-lthread\n+          LTLIBTHREAD=-lthread\n+          LIBMULTITHREAD=\"$LIBTHREAD\"\n+          LTLIBMULTITHREAD=\"$LTLIBTHREAD\"\n+          AC_DEFINE([USE_SOLARIS_THREADS], [1],\n+            [Define if the old Solaris multithreading library can be used.])\n+          if case \"$gl_cv_have_weak\" in *yes) true;; *) false;; esac; then\n+            AC_DEFINE([USE_SOLARIS_THREADS_WEAK], [1],\n+              [Define if references to the old Solaris multithreading library should be made weak.])\n+            LIBTHREAD=\n+            LTLIBTHREAD=\n+          fi\n+        fi\n+      fi\n+    fi\n+    if test \"$gl_use_threads\" = pth; then\n+      gl_save_CPPFLAGS=\"$CPPFLAGS\"\n+      AC_LIB_LINKFLAGS([pth])\n+      gl_have_pth=\n+      gl_save_LIBS=\"$LIBS\"\n+      LIBS=\"$LIBS $LIBPTH\"\n+      AC_LINK_IFELSE(\n+        [AC_LANG_PROGRAM([[#include <pth.h>]], [[pth_self();]])],\n+        [gl_have_pth=yes])\n+      LIBS=\"$gl_save_LIBS\"\n+      if test -n \"$gl_have_pth\"; then\n+        gl_threads_api=pth\n+        LIBTHREAD=\"$LIBPTH\"\n+        LTLIBTHREAD=\"$LTLIBPTH\"\n+        LIBMULTITHREAD=\"$LIBTHREAD\"\n+        LTLIBMULTITHREAD=\"$LTLIBTHREAD\"\n+        AC_DEFINE([USE_PTH_THREADS], [1],\n+          [Define if the GNU Pth multithreading library can be used.])\n+        if test -n \"$LIBMULTITHREAD\" || test -n \"$LTLIBMULTITHREAD\"; then\n+          if case \"$gl_cv_have_weak\" in *yes) true;; *) false;; esac; then\n+            AC_DEFINE([USE_PTH_THREADS_WEAK], [1],\n+              [Define if references to the GNU Pth multithreading library should be made weak.])\n+            LIBTHREAD=\n+            LTLIBTHREAD=\n+          fi\n+        fi\n+      else\n+        CPPFLAGS=\"$gl_save_CPPFLAGS\"\n+      fi\n+    fi\n+    if test -z \"$gl_have_pthread\"; then\n+      case \"$gl_use_threads\" in\n+        yes | windows | win32) # The 'win32' is for backward compatibility.\n+          if { case \"$host_os\" in\n+                 mingw*) true;;\n+                 *) false;;\n+               esac\n+             }; then\n+            gl_threads_api=windows\n+            AC_DEFINE([USE_WINDOWS_THREADS], [1],\n+              [Define if the native Windows multithreading API can be used.])\n+          fi\n+          ;;\n+      esac\n+    fi\n+  fi\n+  AC_MSG_CHECKING([for multithread API to use])\n+  AC_MSG_RESULT([$gl_threads_api])\n+  AC_SUBST([LIBTHREAD])\n+  AC_SUBST([LTLIBTHREAD])\n+  AC_SUBST([LIBMULTITHREAD])\n+  AC_SUBST([LTLIBMULTITHREAD])\n+])\n+\n+AC_DEFUN([gl_THREADLIB],\n+[\n+  AC_REQUIRE([gl_THREADLIB_EARLY])\n+  AC_REQUIRE([gl_THREADLIB_BODY])\n+])\n+\n+\n+dnl gl_DISABLE_THREADS\n+dnl ------------------\n+dnl Sets the gl_THREADLIB default so that threads are not used by default.\n+dnl The user can still override it at installation time, by using the\n+dnl configure option '--enable-threads'.\n+\n+AC_DEFUN([gl_DISABLE_THREADS], [\n+  m4_divert_text([INIT_PREPARE], [gl_use_threads_default=no])\n+])\n+\n+\n+dnl Survey of platforms:\n+dnl\n+dnl Platform           Available  Compiler    Supports   test-lock\n+dnl                    flavours   option      weak       result\n+dnl ---------------    ---------  ---------   --------   ---------\n+dnl Linux 2.4/glibc    posix      -lpthread       Y      OK\n+dnl\n+dnl GNU Hurd/glibc     posix\n+dnl\n+dnl Ubuntu 14.04       posix      -pthread        Y      OK\n+dnl\n+dnl FreeBSD 5.3        posix      -lc_r           Y\n+dnl                    posix      -lkse ?         Y\n+dnl                    posix      -lpthread ?     Y\n+dnl                    posix      -lthr           Y\n+dnl\n+dnl FreeBSD 5.2        posix      -lc_r           Y\n+dnl                    posix      -lkse           Y\n+dnl                    posix      -lthr           Y\n+dnl\n+dnl FreeBSD 4.0,4.10   posix      -lc_r           Y      OK\n+dnl\n+dnl NetBSD 1.6         --\n+dnl\n+dnl OpenBSD 3.4        posix      -lpthread       Y      OK\n+dnl\n+dnl Mac OS X 10.[123]  posix      -lpthread       Y      OK\n+dnl\n+dnl Solaris 7,8,9      posix      -lpthread       Y      Sol 7,8: 0.0; Sol 9: OK\n+dnl                    solaris    -lthread        Y      Sol 7,8: 0.0; Sol 9: OK\n+dnl\n+dnl HP-UX 11           posix      -lpthread       N (cc) OK\n+dnl                                               Y (gcc)\n+dnl\n+dnl IRIX 6.5           posix      -lpthread       Y      0.5\n+dnl\n+dnl AIX 4.3,5.1        posix      -lpthread       N      AIX 4: 0.5; AIX 5: OK\n+dnl\n+dnl OSF/1 4.0,5.1      posix      -pthread (cc)   N      OK\n+dnl                               -lpthread (gcc) Y\n+dnl\n+dnl Cygwin             posix      -lpthread       Y      OK\n+dnl\n+dnl Any of the above   pth        -lpth                  0.0\n+dnl\n+dnl Mingw              windows                    N      OK\n+dnl\n+dnl BeOS 5             --\n+dnl\n+dnl The test-lock result shows what happens if in test-lock.c EXPLICIT_YIELD is\n+dnl turned off:\n+dnl   OK if all three tests terminate OK,\n+dnl   0.5 if the first test terminates OK but the second one loops endlessly,\n+dnl   0.0 if the first test already loops endlessly."
    },
    {
      "sha": "b1d4cf590938851a6e44e429e8e7895b6932589d",
      "filename": "gnulib/import/strerror_r.c",
      "status": "added",
      "additions": 338,
      "deletions": 0,
      "changes": 338,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/strerror_r.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/import/strerror_r.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/strerror_r.c?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -0,0 +1,338 @@\n+/* strerror_r.c --- POSIX compatible system error routine\n+\n+   Copyright (C) 2010-2016 Free Software Foundation, Inc.\n+\n+   This program is free software: you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n+\n+/* Written by Bruno Haible <bruno@clisp.org>, 2010.  */\n+\n+#include <config.h>\n+\n+/* Enable declaration of sys_nerr and sys_errlist in <errno.h> on NetBSD.  */\n+#define _NETBSD_SOURCE 1\n+\n+/* Specification.  */\n+#include <string.h>\n+\n+#include <errno.h>\n+#include <stdio.h>\n+#include <stdlib.h>\n+\n+#include \"strerror-override.h\"\n+\n+#if (__GLIBC__ >= 2 || defined __UCLIBC__ || defined __CYGWIN__) && HAVE___XPG_STRERROR_R /* glibc >= 2.3.4, cygwin >= 1.7.9 */\n+\n+# define USE_XPG_STRERROR_R 1\n+extern\n+#ifdef __cplusplus\n+\"C\"\n+#endif\n+int __xpg_strerror_r (int errnum, char *buf, size_t buflen);\n+\n+#elif HAVE_DECL_STRERROR_R_ORIG && !(__GLIBC__ >= 2 || defined __UCLIBC__ || defined __CYGWIN__)\n+\n+/* The system's strerror_r function is OK, except that its third argument\n+   is 'int', not 'size_t', or its return type is wrong.  */\n+\n+# include <limits.h>\n+\n+# define USE_SYSTEM_STRERROR_R 1\n+\n+#else /* (__GLIBC__ >= 2 || defined __UCLIBC__ || defined __CYGWIN__ ? !HAVE___XPG_STRERROR_R : !HAVE_DECL_STRERROR_R) */\n+\n+/* Use the system's strerror().  Exclude glibc and cygwin because the\n+   system strerror_r has the wrong return type, and cygwin 1.7.9\n+   strerror_r clobbers strerror.  */\n+# undef strerror\n+\n+# define USE_SYSTEM_STRERROR 1\n+\n+# if defined __NetBSD__ || defined __hpux || ((defined _WIN32 || defined __WIN32__) && !defined __CYGWIN__) || defined __sgi || (defined __sun && !defined _LP64) || defined __CYGWIN__\n+\n+/* No locking needed.  */\n+\n+/* Get catgets internationalization functions.  */\n+#  if HAVE_CATGETS\n+#   include <nl_types.h>\n+#  endif\n+\n+#ifdef __cplusplus\n+extern \"C\" {\n+#endif\n+\n+/* Get sys_nerr, sys_errlist on HP-UX (otherwise only declared in C++ mode).\n+   Get sys_nerr, sys_errlist on IRIX (otherwise only declared with _SGIAPI).  */\n+#  if defined __hpux || defined __sgi\n+extern int sys_nerr;\n+extern char *sys_errlist[];\n+#  endif\n+\n+/* Get sys_nerr on Solaris.  */\n+#  if defined __sun && !defined _LP64\n+extern int sys_nerr;\n+#  endif\n+\n+#ifdef __cplusplus\n+}\n+#endif\n+\n+# else\n+\n+#  include \"glthread/lock.h\"\n+\n+/* This lock protects the buffer returned by strerror().  We assume that\n+   no other uses of strerror() exist in the program.  */\n+gl_lock_define_initialized(static, strerror_lock)\n+\n+# endif\n+\n+#endif\n+\n+/* On MSVC, there is no snprintf() function, just a _snprintf().\n+   It is of lower quality, but sufficient for the simple use here.\n+   We only have to make sure to NUL terminate the result (_snprintf\n+   does not NUL terminate, like strncpy).  */\n+#if !HAVE_SNPRINTF\n+static int\n+local_snprintf (char *buf, size_t buflen, const char *format, ...)\n+{\n+  va_list args;\n+  int result;\n+\n+  va_start (args, format);\n+  result = _vsnprintf (buf, buflen, format, args);\n+  va_end (args);\n+  if (buflen > 0 && (result < 0 || result >= buflen))\n+    buf[buflen - 1] = '\\0';\n+  return result;\n+}\n+# define snprintf local_snprintf\n+#endif\n+\n+/* Copy as much of MSG into BUF as possible, without corrupting errno.\n+   Return 0 if MSG fit in BUFLEN, otherwise return ERANGE.  */\n+static int\n+safe_copy (char *buf, size_t buflen, const char *msg)\n+{\n+  size_t len = strlen (msg);\n+  int ret;\n+\n+  if (len < buflen)\n+    {\n+      /* Although POSIX allows memcpy() to corrupt errno, we don't\n+         know of any implementation where this is a real problem.  */\n+      memcpy (buf, msg, len + 1);\n+      ret = 0;\n+    }\n+  else\n+    {\n+      memcpy (buf, msg, buflen - 1);\n+      buf[buflen - 1] = '\\0';\n+      ret = ERANGE;\n+    }\n+  return ret;\n+}\n+\n+\n+int\n+strerror_r (int errnum, char *buf, size_t buflen)\n+#undef strerror_r\n+{\n+  /* Filter this out now, so that rest of this replacement knows that\n+     there is room for a non-empty message and trailing NUL.  */\n+  if (buflen <= 1)\n+    {\n+      if (buflen)\n+        *buf = '\\0';\n+      return ERANGE;\n+    }\n+  *buf = '\\0';\n+\n+  /* Check for gnulib overrides.  */\n+  {\n+    char const *msg = strerror_override (errnum);\n+\n+    if (msg)\n+      return safe_copy (buf, buflen, msg);\n+  }\n+\n+  {\n+    int ret;\n+    int saved_errno = errno;\n+\n+#if USE_XPG_STRERROR_R\n+\n+    {\n+      ret = __xpg_strerror_r (errnum, buf, buflen);\n+      if (ret < 0)\n+        ret = errno;\n+      if (!*buf)\n+        {\n+          /* glibc 2.13 would not touch buf on err, so we have to fall\n+             back to GNU strerror_r which always returns a thread-safe\n+             untruncated string to (partially) copy into our buf.  */\n+          safe_copy (buf, buflen, strerror_r (errnum, buf, buflen));\n+        }\n+    }\n+\n+#elif USE_SYSTEM_STRERROR_R\n+\n+    if (buflen > INT_MAX)\n+      buflen = INT_MAX;\n+\n+# ifdef __hpux\n+    /* On HP-UX 11.31, strerror_r always fails when buflen < 80; it\n+       also fails to change buf on EINVAL.  */\n+    {\n+      char stackbuf[80];\n+\n+      if (buflen < sizeof stackbuf)\n+        {\n+          ret = strerror_r (errnum, stackbuf, sizeof stackbuf);\n+          if (ret == 0)\n+            ret = safe_copy (buf, buflen, stackbuf);\n+        }\n+      else\n+        ret = strerror_r (errnum, buf, buflen);\n+    }\n+# else\n+    ret = strerror_r (errnum, buf, buflen);\n+\n+    /* Some old implementations may return (-1, EINVAL) instead of EINVAL.  */\n+    if (ret < 0)\n+      ret = errno;\n+# endif\n+\n+# ifdef _AIX\n+    /* AIX returns 0 rather than ERANGE when truncating strings; try\n+       again until we are sure we got the entire string.  */\n+    if (!ret && strlen (buf) == buflen - 1)\n+      {\n+        char stackbuf[STACKBUF_LEN];\n+        size_t len;\n+        strerror_r (errnum, stackbuf, sizeof stackbuf);\n+        len = strlen (stackbuf);\n+        /* STACKBUF_LEN should have been large enough.  */\n+        if (len + 1 == sizeof stackbuf)\n+          abort ();\n+        if (buflen <= len)\n+          ret = ERANGE;\n+      }\n+# else\n+    /* Solaris 10 does not populate buf on ERANGE.  OpenBSD 4.7\n+       truncates early on ERANGE rather than return a partial integer.\n+       We prefer the maximal string.  We set buf[0] earlier, and we\n+       know of no implementation that modifies buf to be an\n+       unterminated string, so this strlen should be portable in\n+       practice (rather than pulling in a safer strnlen).  */\n+    if (ret == ERANGE && strlen (buf) < buflen - 1)\n+      {\n+        char stackbuf[STACKBUF_LEN];\n+\n+        /* STACKBUF_LEN should have been large enough.  */\n+        if (strerror_r (errnum, stackbuf, sizeof stackbuf) == ERANGE)\n+          abort ();\n+        safe_copy (buf, buflen, stackbuf);\n+      }\n+# endif\n+\n+#else /* USE_SYSTEM_STRERROR */\n+\n+    /* Try to do what strerror (errnum) does, but without clobbering the\n+       buffer used by strerror().  */\n+\n+# if defined __NetBSD__ || defined __hpux || ((defined _WIN32 || defined __WIN32__) && !defined __CYGWIN__) || defined __CYGWIN__ /* NetBSD, HP-UX, native Windows, Cygwin */\n+\n+    /* NetBSD:         sys_nerr, sys_errlist are declared through _NETBSD_SOURCE\n+                       and <errno.h> above.\n+       HP-UX:          sys_nerr, sys_errlist are declared explicitly above.\n+       native Windows: sys_nerr, sys_errlist are declared in <stdlib.h>.\n+       Cygwin:         sys_nerr, sys_errlist are declared in <errno.h>.  */\n+    if (errnum >= 0 && errnum < sys_nerr)\n+      {\n+#  if HAVE_CATGETS && (defined __NetBSD__ || defined __hpux)\n+#   if defined __NetBSD__\n+        nl_catd catd = catopen (\"libc\", NL_CAT_LOCALE);\n+        const char *errmsg =\n+          (catd != (nl_catd)-1\n+           ? catgets (catd, 1, errnum, sys_errlist[errnum])\n+           : sys_errlist[errnum]);\n+#   endif\n+#   if defined __hpux\n+        nl_catd catd = catopen (\"perror\", NL_CAT_LOCALE);\n+        const char *errmsg =\n+          (catd != (nl_catd)-1\n+           ? catgets (catd, 1, 1 + errnum, sys_errlist[errnum])\n+           : sys_errlist[errnum]);\n+#   endif\n+#  else\n+        const char *errmsg = sys_errlist[errnum];\n+#  endif\n+        if (errmsg == NULL || *errmsg == '\\0')\n+          ret = EINVAL;\n+        else\n+          ret = safe_copy (buf, buflen, errmsg);\n+#  if HAVE_CATGETS && (defined __NetBSD__ || defined __hpux)\n+        if (catd != (nl_catd)-1)\n+          catclose (catd);\n+#  endif\n+      }\n+    else\n+      ret = EINVAL;\n+\n+# elif defined __sgi || (defined __sun && !defined _LP64) /* IRIX, Solaris <= 9 32-bit */\n+\n+    /* For a valid error number, the system's strerror() function returns\n+       a pointer to a not copied string, not to a buffer.  */\n+    if (errnum >= 0 && errnum < sys_nerr)\n+      {\n+        char *errmsg = strerror (errnum);\n+\n+        if (errmsg == NULL || *errmsg == '\\0')\n+          ret = EINVAL;\n+        else\n+          ret = safe_copy (buf, buflen, errmsg);\n+      }\n+    else\n+      ret = EINVAL;\n+\n+# else\n+\n+    gl_lock_lock (strerror_lock);\n+\n+    {\n+      char *errmsg = strerror (errnum);\n+\n+      /* For invalid error numbers, strerror() on\n+           - IRIX 6.5 returns NULL,\n+           - HP-UX 11 returns an empty string.  */\n+      if (errmsg == NULL || *errmsg == '\\0')\n+        ret = EINVAL;\n+      else\n+        ret = safe_copy (buf, buflen, errmsg);\n+    }\n+\n+    gl_lock_unlock (strerror_lock);\n+\n+# endif\n+\n+#endif\n+\n+    if (ret == EINVAL && !*buf)\n+      snprintf (buf, buflen, \"Unknown error %d\", errnum);\n+\n+    errno = saved_errno;\n+    return ret;\n+  }\n+}"
    },
    {
      "sha": "db6a115628dfa53d4e6fd7c2b594b21900ed981d",
      "filename": "gnulib/update-gnulib.sh",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/update-gnulib.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5abebf3c3fd28a148e43be587c4e4065a0e53ae9/gnulib/update-gnulib.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/update-gnulib.sh?ref=5abebf3c3fd28a148e43be587c4e4065a0e53ae9",
      "patch": "@@ -55,6 +55,7 @@ IMPORTED_GNULIB_MODULES=\"\\\n     setenv \\\n     signal-h \\\n     strchrnul \\\n+    strerror_r-posix \\\n     strstr \\\n     strtok_r \\\n     sys_stat \\"
    }
  ]
}