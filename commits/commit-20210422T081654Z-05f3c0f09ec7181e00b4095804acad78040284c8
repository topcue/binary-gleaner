{
  "sha": "05f3c0f09ec7181e00b4095804acad78040284c8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDVmM2MwZjA5ZWM3MTgxZTAwYjQwOTU4MDRhY2FkNzgwNDAyODRjOA==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2021-04-21T09:59:38Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2021-04-22T08:16:54Z"
    },
    "message": "gdb: allow default_addressable_memory_unit_size to handle more cases\n\nCurrently default_addressable_memory_unit_size always returns 1,\nindicating 1 byte is 1 octet.  If a target has something other than\nthis (common) setup then the target should override the\ndefault_addressable_memory_unit_size.\n\nHowever, the bfd library already knows about each targets octets per\nbyte, so it seems redundant making targets override this method to\ntell GDB something it already knows (through bfd).\n\nIn this commit I propose to make default_addressable_memory_unit_size\nreturn a value based on bfd's bits per byte.  I checked, and for every\ntarget that GDB currently supports the bits per byte in bfd is 8, so\nthe current behaviour will not change.\n\nIn fact, the only targets in bfd that have bits per byte set to\nsomething other than 8 can be found in cpu-tic4x.c and cpu-tic54x.c, I\ndon't believe these are supported by GDB right now.\n\nI don't propose to remove the ability to override\ndefault_addressable_memory_unit_size, this allows targets additional\nflexibility for how to handle weird combinations of byte sizes.\n\nThis change was motivated by an out of tree target I was working on,\nbut it seemed like it was a good change that others might benefit\nfrom.\n\nThere should be no user visible changes after this commit.\n\ngdb/ChangeLog:\n\n\t* arch-utils.c (default_addressable_memory_unit_size): Return a\n\tvalue based on bfd's bits per byte.",
    "tree": {
      "sha": "f05d37d9a386a4e6c67698ab5cc803bcb7edd914",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/f05d37d9a386a4e6c67698ab5cc803bcb7edd914"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/05f3c0f09ec7181e00b4095804acad78040284c8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/05f3c0f09ec7181e00b4095804acad78040284c8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/05f3c0f09ec7181e00b4095804acad78040284c8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/05f3c0f09ec7181e00b4095804acad78040284c8/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2662c237a9219b0863535b8b99be383add2cf0b9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2662c237a9219b0863535b8b99be383add2cf0b9",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/2662c237a9219b0863535b8b99be383add2cf0b9"
    }
  ],
  "stats": {
    "total": 13,
    "additions": 10,
    "deletions": 3
  },
  "files": [
    {
      "sha": "6187229a37d3ad64e1392ce5dd5170afad7893b8",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05f3c0f09ec7181e00b4095804acad78040284c8/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05f3c0f09ec7181e00b4095804acad78040284c8/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=05f3c0f09ec7181e00b4095804acad78040284c8",
      "patch": "@@ -1,3 +1,8 @@\n+2021-04-22  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* arch-utils.c (default_addressable_memory_unit_size): Return a\n+\tvalue based on bfd's bits per byte.\n+\n 2021-04-21  Tom Tromey  <tom@tromey.com>\n \n \t* dwarf2/read.h (struct dwarf2_per_cu_data) <dwarf_version>: Now"
    },
    {
      "sha": "5bb9c75844935c605c65eccc465d269ad46a6ff9",
      "filename": "gdb/arch-utils.c",
      "status": "modified",
      "additions": 5,
      "deletions": 3,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/05f3c0f09ec7181e00b4095804acad78040284c8/gdb/arch-utils.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/05f3c0f09ec7181e00b4095804acad78040284c8/gdb/arch-utils.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/arch-utils.c?ref=05f3c0f09ec7181e00b4095804acad78040284c8",
      "patch": "@@ -1005,13 +1005,15 @@ default_gnu_triplet_regexp (struct gdbarch *gdbarch)\n   return gdbarch_bfd_arch_info (gdbarch)->arch_name;\n }\n \n-/* Default method for gdbarch_addressable_memory_unit_size.  By default, a memory byte has\n-   a size of 1 octet.  */\n+/* Default method for gdbarch_addressable_memory_unit_size.  The default is\n+   based on the bits_per_byte defined in the bfd library for the current\n+   architecture, this is usually 8-bits, and so this function will usually\n+   return 1 indicating 1 byte is 1 octet.  */\n \n int\n default_addressable_memory_unit_size (struct gdbarch *gdbarch)\n {\n-  return 1;\n+  return gdbarch_bfd_arch_info (gdbarch)->bits_per_byte / 8;\n }\n \n void"
    }
  ]
}