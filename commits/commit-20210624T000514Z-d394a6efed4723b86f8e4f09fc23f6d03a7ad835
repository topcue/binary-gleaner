{
  "sha": "d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDM5NGE2ZWZlZDQ3MjNiODZmOGU0ZjA5ZmMyM2Y2ZDAzYTdhZDgzNQ==",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-06-21T03:06:10Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-06-24T00:05:14Z"
    },
    "message": "sim: callback: add a kill interface\n\nThis will make it easier to emulate the syscall.  If the kill target\nis the sim itself, don't do anything.  This forces the higher layers\nto make a decision as to how to handle this event: like halting the\noverall engine process.",
    "tree": {
      "sha": "6fd21636c50bf4f62d608cfb975da8707158d360",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6fd21636c50bf4f62d608cfb975da8707158d360"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "02ddf7223daa1dac8ba532dfd31d5d4d1870e6f4",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/02ddf7223daa1dac8ba532dfd31d5d4d1870e6f4",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/02ddf7223daa1dac8ba532dfd31d5d4d1870e6f4"
    }
  ],
  "stats": {
    "total": 40,
    "additions": 40,
    "deletions": 0
  },
  "files": [
    {
      "sha": "3faea5828942ca5a2573ecebe7245337adfd9b17",
      "filename": "include/sim/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/include/sim/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/include/sim/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/sim/ChangeLog?ref=d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
      "patch": "@@ -1,3 +1,7 @@\n+2021-06-23  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* sim/callback.h (struct host_callback_struct): Add kill.\n+\n 2021-06-22  Mike Frysinger  <vapier@gentoo.org>\n \n \t* sim/callback.h (struct host_callback_struct): Add getpid."
    },
    {
      "sha": "8d61ebb879e8c5a204b7667ff7ac12398ee11f0e",
      "filename": "include/sim/callback.h",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/include/sim/callback.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/include/sim/callback.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/sim/callback.h?ref=d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
      "patch": "@@ -92,6 +92,7 @@ struct host_callback_struct\n   int (*ftruncate) (host_callback *, int, int64_t);\n   int (*truncate) (host_callback *, const char *, int64_t);\n   int (*getpid) (host_callback *);\n+  int (*kill) (host_callback *, int, int);\n   int (*pipe) (host_callback *, int *);\n \n   /* Called by the framework when a read call has emptied a pipe buffer.  */"
    },
    {
      "sha": "c32e7475a80c64f4bfedbbbd26cd449b8b4d2eb4",
      "filename": "sim/common/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/sim/common/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/sim/common/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/ChangeLog?ref=d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
      "patch": "@@ -1,3 +1,9 @@\n+2021-06-23  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* callback.c (os_kill): New function.\n+\t(default_callback): Add os_kill.\n+\t* syscall.c (cb_syscall): Handle CB_SYS_kill.\n+\n 2021-06-23  Mike Frysinger  <vapier@gentoo.org>\n \n \t* Make-common.in (srcdir): Change to abs_srcdir."
    },
    {
      "sha": "c0ace6e4c8e58753af83df10bb1a1645c75071a8",
      "filename": "sim/common/callback.c",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/sim/common/callback.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/sim/common/callback.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/callback.c?ref=d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
      "patch": "@@ -569,6 +569,16 @@ os_getpid (host_callback *p)\n   return result;\n }\n \n+static int\n+os_kill (host_callback *p, int pid, int signum)\n+{\n+  int result;\n+\n+  result = kill (pid, signum);\n+  p->last_errno = errno;\n+  return result;\n+}\n+\n static int\n os_pipe (host_callback *p, int *filedes)\n {\n@@ -752,6 +762,7 @@ host_callback default_callback =\n   os_truncate,\n \n   os_getpid,\n+  os_kill,\n \n   os_pipe,\n   os_pipe_empty,"
    },
    {
      "sha": "6efddcfecde80abc0da203b153e8090e71f06713",
      "filename": "sim/common/syscall.c",
      "status": "modified",
      "additions": 18,
      "deletions": 0,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/sim/common/syscall.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d394a6efed4723b86f8e4f09fc23f6d03a7ad835/sim/common/syscall.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/syscall.c?ref=d394a6efed4723b86f8e4f09fc23f6d03a7ad835",
      "patch": "@@ -583,6 +583,24 @@ cb_syscall (host_callback *cb, CB_SYSCALL *sc)\n       result = (*cb->getpid) (cb);\n       break;\n \n+    case CB_SYS_kill:\n+      /* If killing self, leave it to the caller to process so it can send the\n+\t signal to the engine.  */\n+      if (sc->arg1 == (*cb->getpid) (cb))\n+\t{\n+\t  result = -1;\n+\t  errcode = ENOSYS;\n+\t}\n+      else\n+\t{\n+\t  int signum = cb_target_to_host_signal (cb, sc->arg2);\n+\n+\t  result = (*cb->kill) (cb, sc->arg1, signum);\n+\t  cb->last_errno = errno;\n+\t  goto ErrorFinish;\n+\t}\n+      break;\n+\n     case CB_SYS_time :\n       {\n \t/* FIXME: May wish to change CB_SYS_time to something else."
    }
  ]
}