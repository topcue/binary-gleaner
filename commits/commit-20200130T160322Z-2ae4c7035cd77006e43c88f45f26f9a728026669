{
  "sha": "2ae4c7035cd77006e43c88f45f26f9a728026669",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MmFlNGM3MDM1Y2Q3NzAwNmU0M2M4OGY0NWYyNmY5YTcyODAyNjY2OQ==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2020-01-30T16:03:22Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2020-01-30T16:03:22Z"
    },
    "message": "x86: prevent undue use of GOT32X and alike relocations\n\nComparison of i.tm.base_opcode against particular but not sufficiently\nspecific values needs to be accompanied by other qualification. Exclude\nVEX and alike encodings here, and also exclude all forms of prefixes\nexplicitly specified in the opcodes table. While using @GOT with such\ninsns may not be very useful, it also isn't with e.g. ADC and SBB, yet\nthese get explicitly listed in comments as supported.",
    "tree": {
      "sha": "b9b8cf2201ac3a96faf5c6b2ac1cd24502a44831",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/b9b8cf2201ac3a96faf5c6b2ac1cd24502a44831"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/2ae4c7035cd77006e43c88f45f26f9a728026669",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2ae4c7035cd77006e43c88f45f26f9a728026669",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/2ae4c7035cd77006e43c88f45f26f9a728026669",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2ae4c7035cd77006e43c88f45f26f9a728026669/comments",
  "author": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5cebc931d70eedf5f355efe179f4d601cca36243",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5cebc931d70eedf5f355efe179f4d601cca36243",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5cebc931d70eedf5f355efe179f4d601cca36243"
    }
  ],
  "stats": {
    "total": 97,
    "additions": 68,
    "deletions": 29
  },
  "files": [
    {
      "sha": "8bad416a307dec3bcdcb98db614d730d4869f6b8",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=2ae4c7035cd77006e43c88f45f26f9a728026669",
      "patch": "@@ -1,3 +1,10 @@\n+2020-01-30  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* config/tc-i386.c (output_disp): Tighten base_opcode check.\n+\t* testsuite/gas/i386/got.s: Add LSL, MOVLPS, and BNDCN cases.\n+\t* testsuite/gas/i386/got-no-relax.d, testsuite/gas/i386/got.d:\n+\tAdjust expectations.\n+\n 2020-01-30  Jose E. Marchesi  <jose.marchesi@oracle.com>\n \n \t* testsuite/gas/bpf/alu.d: Update expected opcode for `neg'."
    },
    {
      "sha": "945ceb28d69a9e34aa80a58a4c44bb4194dfc74f",
      "filename": "gas/config/tc-i386.c",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/config/tc-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/config/tc-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.c?ref=2ae4c7035cd77006e43c88f45f26f9a728026669",
      "patch": "@@ -9061,13 +9061,14 @@ output_disp (fragS *insn_start_frag, offsetT insn_start_off)\n \t\t\t  && i.rm.regmem == 5))\n \t\t  && (i.rm.mode == 2\n \t\t      || (i.rm.mode == 0 && i.rm.regmem == 5))\n+\t\t  && !is_any_vex_encoding(&i.tm)\n \t\t  && ((i.operands == 1\n \t\t       && i.tm.base_opcode == 0xff\n \t\t       && (i.rm.reg == 2 || i.rm.reg == 4))\n \t\t      || (i.operands == 2\n \t\t\t  && (i.tm.base_opcode == 0x8b\n \t\t\t      || i.tm.base_opcode == 0x85\n-\t\t\t      || (i.tm.base_opcode & 0xc7) == 0x03))))\n+\t\t\t      || (i.tm.base_opcode & ~0x38) == 0x03))))\n \t\t{\n \t\t  if (object_64bit)\n \t\t    {"
    },
    {
      "sha": "41b4adfc4317f32f45f6bedd967a287f1b50517b",
      "filename": "gas/testsuite/gas/i386/got-no-relax.d",
      "status": "modified",
      "additions": 23,
      "deletions": 14,
      "changes": 37,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/testsuite/gas/i386/got-no-relax.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/testsuite/gas/i386/got-no-relax.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/got-no-relax.d?ref=2ae4c7035cd77006e43c88f45f26f9a728026669",
      "patch": "@@ -14,18 +14,27 @@ Disassembly of section .text:\n [ \t]*[a-f0-9]+:\t05 00 00 00 00       \tadd    \\$0x0,%eax\t12: R_386_GOT32\tfoo\n [ \t]*[a-f0-9]+:\t03 05 00 00 00 00    \tadd    0x0,%eax\t18: R_386_GOT32X\tfoo\n [ \t]*[a-f0-9]+:\t03 80 00 00 00 00    \tadd    0x0\\(%eax\\),%eax\t1e: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\tff 15 00 00 00 00    \tcall   \\*0x0\t24: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff 90 00 00 00 00    \tcall   \\*0x0\\(%eax\\)\t2a: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\tff 25 00 00 00 00    \tjmp    \\*0x0\t30: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff a0 00 00 00 00    \tjmp    \\*0x0\\(%eax\\)\t36: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\tb8 00 00 00 00       \tmov    \\$0x0,%eax\t3b: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\t8b 05 00 00 00 00    \tmov    0x0,%eax\t41: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\t8b 80 00 00 00 00    \tmov    0x0\\(%eax\\),%eax\t47: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\t05 00 00 00 00       \tadd    \\$0x0,%eax\t4c: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\t03 05 00 00 00 00    \tadd    0x0,%eax\t52: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\t03 80 00 00 00 00    \tadd    0x0\\(%eax\\),%eax\t58: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\tff 90 00 00 00 00    \tcall   \\*0x0\\(%eax\\)\t5e: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\tff 15 00 00 00 00    \tcall   \\*0x0\t64: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff a0 00 00 00 00    \tjmp    \\*0x0\\(%eax\\)\t6a: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\tff 25 00 00 00 00    \tjmp    \\*0x0\t70: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\ta9 00 00 00 00       \ttest   \\$0x0,%eax\t23: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t85 05 00 00 00 00    \ttest   %eax,0x0\t29: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\t85 80 00 00 00 00    \ttest   %eax,0x0\\(%eax\\)\t2f: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tff 15 00 00 00 00    \tcall   \\*0x0\t35: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff 90 00 00 00 00    \tcall   \\*0x0\\(%eax\\)\t3b: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tff 25 00 00 00 00    \tjmp    \\*0x0\t41: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff a0 00 00 00 00    \tjmp    \\*0x0\\(%eax\\)\t47: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t0f 03 05 00 00 00 00 \tlsl    0x0,%eax\t4e: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t0f 03 80 00 00 00 00 \tlsl    0x0\\(%eax\\),%eax\t55: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tf2 0f 1b 05 00 00 00 00 \tbndcn  0x0,%bnd0\t5d: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tf2 0f 1b 80 00 00 00 00 \tbndcn  0x0\\(%eax\\),%bnd0\t65: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t0f 13 05 00 00 00 00 \tmovlps %xmm0,0x0\t6c: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t0f 13 80 00 00 00 00 \tmovlps %xmm0,0x0\\(%eax\\)\t73: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tb8 00 00 00 00       \tmov    \\$0x0,%eax\t78: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t8b 05 00 00 00 00    \tmov    0x0,%eax\t7e: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\t8b 80 00 00 00 00    \tmov    0x0\\(%eax\\),%eax\t84: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t05 00 00 00 00       \tadd    \\$0x0,%eax\t89: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t03 05 00 00 00 00    \tadd    0x0,%eax\t8f: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\t03 80 00 00 00 00    \tadd    0x0\\(%eax\\),%eax\t95: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tff 90 00 00 00 00    \tcall   \\*0x0\\(%eax\\)\t9b: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tff 15 00 00 00 00    \tcall   \\*0x0\ta1: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff a0 00 00 00 00    \tjmp    \\*0x0\\(%eax\\)\ta7: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tff 25 00 00 00 00    \tjmp    \\*0x0\tad: R_386_GOT32X\tfoo\n #pass"
    },
    {
      "sha": "351da27e046825ced95f6cde8470779529638621",
      "filename": "gas/testsuite/gas/i386/got.d",
      "status": "modified",
      "additions": 23,
      "deletions": 14,
      "changes": 37,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/testsuite/gas/i386/got.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/testsuite/gas/i386/got.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/got.d?ref=2ae4c7035cd77006e43c88f45f26f9a728026669",
      "patch": "@@ -13,18 +13,27 @@ Disassembly of section .text:\n [ \t]*[a-f0-9]+:\t05 00 00 00 00       \tadd    \\$0x0,%eax\t12: R_386_GOT32\tfoo\n [ \t]*[a-f0-9]+:\t03 05 00 00 00 00    \tadd    0x0,%eax\t18: R_386_GOT32X\tfoo\n [ \t]*[a-f0-9]+:\t03 80 00 00 00 00    \tadd    0x0\\(%eax\\),%eax\t1e: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff 15 00 00 00 00    \tcall   \\*0x0\t24: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff 90 00 00 00 00    \tcall   \\*0x0\\(%eax\\)\t2a: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff 25 00 00 00 00    \tjmp    \\*0x0\t30: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff a0 00 00 00 00    \tjmp    \\*0x0\\(%eax\\)\t36: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tb8 00 00 00 00       \tmov    \\$0x0,%eax\t3b: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\t8b 05 00 00 00 00    \tmov    0x0,%eax\t41: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\t8b 80 00 00 00 00    \tmov    0x0\\(%eax\\),%eax\t47: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\t05 00 00 00 00       \tadd    \\$0x0,%eax\t4c: R_386_GOT32\tfoo\n-[ \t]*[a-f0-9]+:\t03 05 00 00 00 00    \tadd    0x0,%eax\t52: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\t03 80 00 00 00 00    \tadd    0x0\\(%eax\\),%eax\t58: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff 90 00 00 00 00    \tcall   \\*0x0\\(%eax\\)\t5e: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff 15 00 00 00 00    \tcall   \\*0x0\t64: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff a0 00 00 00 00    \tjmp    \\*0x0\\(%eax\\)\t6a: R_386_GOT32X\tfoo\n-[ \t]*[a-f0-9]+:\tff 25 00 00 00 00    \tjmp    \\*0x0\t70: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\ta9 00 00 00 00       \ttest   \\$0x0,%eax\t23: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t85 05 00 00 00 00    \ttest   %eax,0x0\t29: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\t85 80 00 00 00 00    \ttest   %eax,0x0\\(%eax\\)\t2f: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff 15 00 00 00 00    \tcall   \\*0x0\t35: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff 90 00 00 00 00    \tcall   \\*0x0\\(%eax\\)\t3b: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff 25 00 00 00 00    \tjmp    \\*0x0\t41: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff a0 00 00 00 00    \tjmp    \\*0x0\\(%eax\\)\t47: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\t0f 03 05 00 00 00 00 \tlsl    0x0,%eax\t4e: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t0f 03 80 00 00 00 00 \tlsl    0x0\\(%eax\\),%eax\t55: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tf2 0f 1b 05 00 00 00 00 \tbndcn  0x0,%bnd0\t5d: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tf2 0f 1b 80 00 00 00 00 \tbndcn  0x0\\(%eax\\),%bnd0\t65: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t0f 13 05 00 00 00 00 \tmovlps %xmm0,0x0\t6c: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t0f 13 80 00 00 00 00 \tmovlps %xmm0,0x0\\(%eax\\)\t73: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\tb8 00 00 00 00       \tmov    \\$0x0,%eax\t78: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t8b 05 00 00 00 00    \tmov    0x0,%eax\t7e: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\t8b 80 00 00 00 00    \tmov    0x0\\(%eax\\),%eax\t84: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\t05 00 00 00 00       \tadd    \\$0x0,%eax\t89: R_386_GOT32\tfoo\n+[ \t]*[a-f0-9]+:\t03 05 00 00 00 00    \tadd    0x0,%eax\t8f: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\t03 80 00 00 00 00    \tadd    0x0\\(%eax\\),%eax\t95: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff 90 00 00 00 00    \tcall   \\*0x0\\(%eax\\)\t9b: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff 15 00 00 00 00    \tcall   \\*0x0\ta1: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff a0 00 00 00 00    \tjmp    \\*0x0\\(%eax\\)\ta7: R_386_GOT32X\tfoo\n+[ \t]*[a-f0-9]+:\tff 25 00 00 00 00    \tjmp    \\*0x0\tad: R_386_GOT32X\tfoo\n #pass"
    },
    {
      "sha": "47194115bc88e084dadc3ed69a244877016d1a3d",
      "filename": "gas/testsuite/gas/i386/got.s",
      "status": "modified",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/testsuite/gas/i386/got.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2ae4c7035cd77006e43c88f45f26f9a728026669/gas/testsuite/gas/i386/got.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/got.s?ref=2ae4c7035cd77006e43c88f45f26f9a728026669",
      "patch": "@@ -8,11 +8,24 @@ _start:\n \taddl\tfoo@GOT, %eax\n \taddl\tfoo@GOT(%eax), %eax\n \n+\ttestl\t$foo@GOT, %eax\n+\ttestl\tfoo@GOT, %eax\n+\ttestl\tfoo@GOT(%eax), %eax\n+\n \tcall\t*foo@GOT\n \tcall\t*foo@GOT(%eax)\n \tjmp\t*foo@GOT\n \tjmp\t*foo@GOT(%eax)\n \n+\tlsll\tfoo@GOT, %eax\n+\tlsll\tfoo@GOT(%eax), %eax\n+\n+\tbndcn\tfoo@GOT, %bnd0\n+\tbndcn\tfoo@GOT(%eax), %bnd0\n+\n+\tmovlps\t%xmm0, foo@GOT\n+\tmovlps\t%xmm0, foo@GOT(%eax)\n+\n \t.intel_syntax noprefix\n \n \tmov\teax, offset foo@got"
    }
  ]
}