{
  "sha": "0a6041ce9383338fa62acb207683780faaa8b42c",
  "node_id": "C_kwDOANOeidoAKDBhNjA0MWNlOTM4MzMzOGZhNjJhY2IyMDc2ODM3ODBmYWFhOGI0MmM",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-10-05T23:47:29Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-10-06T00:54:29Z"
    },
    "message": "PR28403, null pointer dereference in disassemble_bytes\n\nIndexing of symbol and howto arrays wasn't checked in aout targets.\n\n\tPR 28403\n\t* aout-ns32k.c (MY (reloc_howto)): Sanity check howto_table index.\n\tMake r_index unsigned.\n\t(MY_swap_std_reloc_in): Make r_index unsigned.\n\t* aoutx.h (MOVE_ADDRESS): Sanity check symbol r_index.\n\t(aout_link_input_section_std): Make r_index unsigned.\n\t(aout_link_input_section_ext): Likewise.\n\t* i386lynx.c (MOVE_ADDRESS): Sanity check symbol r_index.\n\t(swap_ext_reloc_in, swap_std_reloc_in): Make r_index unsigned.\n\t* pdp11.c (MOVE_ADDRESS): Sanity check symbol r_index.",
    "tree": {
      "sha": "1996d2e58fac46ae1ed3ea5366571d7c9223f88e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/1996d2e58fac46ae1ed3ea5366571d7c9223f88e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0a6041ce9383338fa62acb207683780faaa8b42c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0a6041ce9383338fa62acb207683780faaa8b42c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0a6041ce9383338fa62acb207683780faaa8b42c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0a6041ce9383338fa62acb207683780faaa8b42c/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "55e3926e79937da55da3eaad3b15b4c099071976",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/55e3926e79937da55da3eaad3b15b4c099071976",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/55e3926e79937da55da3eaad3b15b4c099071976"
    }
  ],
  "stats": {
    "total": 84,
    "additions": 45,
    "deletions": 39
  },
  "files": [
    {
      "sha": "eb721b256d1bc72439bbb87bba5c857cea219deb",
      "filename": "bfd/aout-ns32k.c",
      "status": "modified",
      "additions": 5,
      "deletions": 3,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a6041ce9383338fa62acb207683780faaa8b42c/bfd/aout-ns32k.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a6041ce9383338fa62acb207683780faaa8b42c/bfd/aout-ns32k.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/aout-ns32k.c?ref=0a6041ce9383338fa62acb207683780faaa8b42c",
      "patch": "@@ -143,12 +143,12 @@ reloc_howto_type MY (howto_table)[] =\n static reloc_howto_type *\n MY (reloc_howto) (bfd *abfd ATTRIBUTE_UNUSED,\n \t\t  struct reloc_std_external *rel,\n-\t\t  int *r_index,\n+\t\t  unsigned int *r_index,\n \t\t  int *r_extern,\n \t\t  int *r_pcrel)\n {\n   unsigned int r_length;\n-  int r_ns32k_type;\n+  unsigned int r_ns32k_type;\n \n   *r_index =  ((rel->r_index[2] << 16)\n \t       | (rel->r_index[1] << 8)\n@@ -159,6 +159,8 @@ MY (reloc_howto) (bfd *abfd ATTRIBUTE_UNUSED,\n \t\t>> RELOC_STD_BITS_LENGTH_SH_LITTLE);\n   r_ns32k_type  =  ((rel->r_type[0] & RELOC_STD_BITS_NS32K_TYPE_LITTLE)\n \t\t    >> RELOC_STD_BITS_NS32K_TYPE_SH_LITTLE);\n+  if (r_length > 2 || r_ns32k_type > 2)\n+    return NULL;\n   return (MY (howto_table) + r_length + 3 * (*r_pcrel) + 6 * r_ns32k_type);\n }\n \n@@ -271,7 +273,7 @@ MY_swap_std_reloc_in (bfd *abfd,\n \t\t      asymbol **symbols,\n \t\t      bfd_size_type symcount ATTRIBUTE_UNUSED)\n {\n-  int r_index;\n+  unsigned int r_index;\n   int r_extern;\n   int r_pcrel;\n   struct aoutdata  *su = &(abfd->tdata.aout_data->a);"
    },
    {
      "sha": "ea09646f2b37e91e29e8cc418e29b1e404e72e1f",
      "filename": "bfd/aoutx.h",
      "status": "modified",
      "additions": 6,
      "deletions": 5,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a6041ce9383338fa62acb207683780faaa8b42c/bfd/aoutx.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a6041ce9383338fa62acb207683780faaa8b42c/bfd/aoutx.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/aoutx.h?ref=0a6041ce9383338fa62acb207683780faaa8b42c",
      "patch": "@@ -2130,7 +2130,8 @@ NAME (aout, swap_ext_reloc_out) (bfd *abfd,\n   if (r_extern)\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       /* Undefined symbol.  */\t\t\t\t\t\t\\\n-      cache_ptr->sym_ptr_ptr = symbols + r_index;\t\t\t\\\n+      if (r_index < bfd_get_symcount (abfd))\t\t\t\t\\\n+\tcache_ptr->sym_ptr_ptr = symbols + r_index;\t\t\t\\\n       cache_ptr->addend = ad;\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n    else\t\t\t\t\t\t\t\t\t\\\n@@ -4021,7 +4022,7 @@ aout_link_input_section_std (struct aout_final_link_info *flaginfo,\n   for (; rel < rel_end; rel++)\n     {\n       bfd_vma r_addr;\n-      int r_index;\n+      unsigned int r_index;\n       int r_extern;\n       int r_pcrel;\n       int r_baserel = 0;\n@@ -4133,7 +4134,7 @@ aout_link_input_section_std (struct aout_final_link_info *flaginfo,\n \t\t     map.  */\n \t\t  r_index = symbol_map[r_index];\n \n-\t\t  if (r_index == -1)\n+\t\t  if (r_index == -1u)\n \t\t    {\n \t\t      if (h != NULL)\n \t\t\t{\n@@ -4369,7 +4370,7 @@ aout_link_input_section_ext (struct aout_final_link_info *flaginfo,\n   for (; rel < rel_end; rel++)\n     {\n       bfd_vma r_addr;\n-      int r_index;\n+      unsigned int r_index;\n       int r_extern;\n       unsigned int r_type;\n       bfd_vma r_addend;\n@@ -4469,7 +4470,7 @@ aout_link_input_section_ext (struct aout_final_link_info *flaginfo,\n \t\t     map.  */\n \t\t  r_index = symbol_map[r_index];\n \n-\t\t  if (r_index == -1)\n+\t\t  if (r_index == -1u)\n \t\t    {\n \t\t      if (h != NULL)\n \t\t\t{"
    },
    {
      "sha": "932ce1741e2f745b47ab11e5559ad1f5d5ed81da",
      "filename": "bfd/i386lynx.c",
      "status": "modified",
      "additions": 32,
      "deletions": 30,
      "changes": 62,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a6041ce9383338fa62acb207683780faaa8b42c/bfd/i386lynx.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a6041ce9383338fa62acb207683780faaa8b42c/bfd/i386lynx.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/i386lynx.c?ref=0a6041ce9383338fa62acb207683780faaa8b42c",
      "patch": "@@ -282,38 +282,40 @@ NAME(lynx,swap_ext_reloc_out) (bfd *abfd,\n #define MOVE_ADDRESS(ad)\t\t\t\t\t\t\\\n   if (r_extern)\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n-   /* undefined symbol */\t\t\t\t\t\t\\\n-     cache_ptr->sym_ptr_ptr = symbols + r_index;\t\t\t\\\n-     cache_ptr->addend = ad;\t\t\t\t\t\t\\\n+      /* undefined symbol */\t\t\t\t\t\t\\\n+      if (r_index < bfd_get_symcount (abfd))\t\t\t\t\\\n+\tcache_ptr->sym_ptr_ptr = symbols + r_index;\t\t\t\\\n+      cache_ptr->addend = ad;\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   else\t\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n-    /* defined, section relative. replace symbol with pointer to\t\\\n-       symbol which points to section  */\t\t\t\t\\\n-    switch (r_index) {\t\t\t\t\t\t\t\\\n-    case N_TEXT:\t\t\t\t\t\t\t\\\n-    case N_TEXT | N_EXT:\t\t\t\t\t\t\\\n-      cache_ptr->sym_ptr_ptr  = obj_textsec(abfd)->symbol_ptr_ptr;\t\\\n-      cache_ptr->addend = ad  - su->textsec->vma;\t\t\t\\\n-      break;\t\t\t\t\t\t\t\t\\\n-    case N_DATA:\t\t\t\t\t\t\t\\\n-    case N_DATA | N_EXT:\t\t\t\t\t\t\\\n-      cache_ptr->sym_ptr_ptr  = obj_datasec(abfd)->symbol_ptr_ptr;\t\\\n-      cache_ptr->addend = ad - su->datasec->vma;\t\t\t\\\n-      break;\t\t\t\t\t\t\t\t\\\n-    case N_BSS:\t\t\t\t\t\t\t\t\\\n-    case N_BSS | N_EXT:\t\t\t\t\t\t\t\\\n-      cache_ptr->sym_ptr_ptr  = obj_bsssec(abfd)->symbol_ptr_ptr;\t\\\n-      cache_ptr->addend = ad - su->bsssec->vma;\t\t\t\t\\\n-      break;\t\t\t\t\t\t\t\t\\\n-    default:\t\t\t\t\t\t\t\t\\\n-    case N_ABS:\t\t\t\t\t\t\t\t\\\n-    case N_ABS | N_EXT:\t\t\t\t\t\t\t\\\n-     cache_ptr->sym_ptr_ptr = bfd_abs_section_ptr->symbol_ptr_ptr;\t\\\n-      cache_ptr->addend = ad;\t\t\t\t\t\t\\\n-      break;\t\t\t\t\t\t\t\t\\\n+      /* defined, section relative. replace symbol with pointer to\t\\\n+\t symbol which points to section  */\t\t\t\t\\\n+      switch (r_index)\t\t\t\t\t\t\t\\\n+\t{\t\t\t\t\t\t\t\t\\\n+\tcase N_TEXT:\t\t\t\t\t\t\t\\\n+\tcase N_TEXT | N_EXT:\t\t\t\t\t\t\\\n+\t  cache_ptr->sym_ptr_ptr  = obj_textsec(abfd)->symbol_ptr_ptr;\t\\\n+\t  cache_ptr->addend = ad  - su->textsec->vma;\t\t\t\\\n+\t  break;\t\t\t\t\t\t\t\\\n+\tcase N_DATA:\t\t\t\t\t\t\t\\\n+\tcase N_DATA | N_EXT:\t\t\t\t\t\t\\\n+\t  cache_ptr->sym_ptr_ptr  = obj_datasec(abfd)->symbol_ptr_ptr;\t\\\n+\t  cache_ptr->addend = ad - su->datasec->vma;\t\t\t\\\n+\t  break;\t\t\t\t\t\t\t\\\n+\tcase N_BSS:\t\t\t\t\t\t\t\\\n+\tcase N_BSS | N_EXT:\t\t\t\t\t\t\\\n+\t  cache_ptr->sym_ptr_ptr  = obj_bsssec(abfd)->symbol_ptr_ptr;\t\\\n+\t  cache_ptr->addend = ad - su->bsssec->vma;\t\t\t\\\n+\t  break;\t\t\t\t\t\t\t\\\n+\tdefault:\t\t\t\t\t\t\t\\\n+\tcase N_ABS:\t\t\t\t\t\t\t\\\n+\tcase N_ABS | N_EXT:\t\t\t\t\t\t\\\n+\t  cache_ptr->sym_ptr_ptr = bfd_abs_section_ptr->symbol_ptr_ptr;\t\\\n+\t  cache_ptr->addend = ad;\t\t\t\t\t\\\n+\t  break;\t\t\t\t\t\t\t\\\n+\t}\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n-  }\t\t\t\t\t\t\t\t\t\\\n \n static void\n NAME(lynx,swap_ext_reloc_in) (bfd *abfd,\n@@ -322,7 +324,7 @@ NAME(lynx,swap_ext_reloc_in) (bfd *abfd,\n \t\t\t      asymbol **symbols,\n \t\t\t      bfd_size_type symcount ATTRIBUTE_UNUSED)\n {\n-  int r_index;\n+  unsigned int r_index;\n   int r_extern;\n   unsigned int r_type;\n   struct aoutdata *su = &(abfd->tdata.aout_data->a);\n@@ -345,7 +347,7 @@ NAME(lynx,swap_std_reloc_in) (bfd *abfd,\n \t\t\t      asymbol **symbols,\n \t\t\t      bfd_size_type symcount ATTRIBUTE_UNUSED)\n {\n-  int r_index;\n+  unsigned int r_index;\n   int r_extern;\n   unsigned int r_length;\n   int r_pcrel;"
    },
    {
      "sha": "6429b43be1980b60d7edaa6737606504c77d24e4",
      "filename": "bfd/pdp11.c",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0a6041ce9383338fa62acb207683780faaa8b42c/bfd/pdp11.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0a6041ce9383338fa62acb207683780faaa8b42c/bfd/pdp11.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/pdp11.c?ref=0a6041ce9383338fa62acb207683780faaa8b42c",
      "patch": "@@ -1862,7 +1862,8 @@ pdp11_aout_swap_reloc_out (bfd *abfd, arelent *g, bfd_byte *natptr)\n   if (r_extern)\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       /* Undefined symbol.  */\t\t\t\t\t\t\\\n-      cache_ptr->sym_ptr_ptr = symbols + r_index;\t\t\t\\\n+      if (r_index < bfd_get_symcount (abfd))\t\t\t\t\\\n+\tcache_ptr->sym_ptr_ptr = symbols + r_index;\t\t\t\\\n       cache_ptr->addend = ad;\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   else\t\t\t\t\t\t\t\t\t\\"
    }
  ]
}