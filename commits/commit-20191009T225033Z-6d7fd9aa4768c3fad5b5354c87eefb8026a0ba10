{
  "sha": "6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NmQ3ZmQ5YWE0NzY4YzNmYWQ1YjUzNTRjODdlZWZiODAyNmEwYmExMA==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-10-01T23:03:54Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-10-09T22:50:33Z"
    },
    "message": "Remove tui_default_win_viewport_height\n\ntui_default_win_viewport_height was only called from a single spot,\nfor a single type of window.  This patch removes the function and\nmoves the logic into the sole caller.\n\ngdb/ChangeLog\n2019-10-09  Tom Tromey  <tom@tromey.com>\n\n\t* tui/tui-disasm.c (tui_get_low_disassembly_address): Compute\n\twindow height directly.\n\t* tui/tui-layout.h (tui_default_win_viewport_height): Don't\n\tdeclare.\n\t* tui/tui-layout.c (tui_default_win_height): Remove.\n\t(tui_default_win_viewport_height): Remove.",
    "tree": {
      "sha": "f5bf4062127409a843119d1983703d26a792ea72",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/f5bf4062127409a843119d1983703d26a792ea72"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d2dd1084c10839efb916a0bfe57ca7a056d08b47",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d2dd1084c10839efb916a0bfe57ca7a056d08b47",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d2dd1084c10839efb916a0bfe57ca7a056d08b47"
    }
  ],
  "stats": {
    "total": 81,
    "additions": 18,
    "deletions": 63
  },
  "files": [
    {
      "sha": "7fb3394c0c6baac6270db7d9d436ec5e6f383727",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10",
      "patch": "@@ -1,3 +1,12 @@\n+2019-10-09  Tom Tromey  <tom@tromey.com>\n+\n+\t* tui/tui-disasm.c (tui_get_low_disassembly_address): Compute\n+\twindow height directly.\n+\t* tui/tui-layout.h (tui_default_win_viewport_height): Don't\n+\tdeclare.\n+\t* tui/tui-layout.c (tui_default_win_height): Remove.\n+\t(tui_default_win_viewport_height): Remove.\n+\n 2019-10-09  Tom Tromey  <tom@tromey.com>\n \n \t* tui/tui.h: Remove comments."
    },
    {
      "sha": "33a3ba12d470e83c055ac957168236a5080a174d",
      "filename": "gdb/tui/tui-disasm.c",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/gdb/tui/tui-disasm.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/gdb/tui/tui-disasm.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-disasm.c?ref=6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10",
      "patch": "@@ -28,6 +28,7 @@\n #include \"source.h\"\n #include \"disasm.h\"\n #include \"tui/tui.h\"\n+#include \"tui/tui-command.h\"\n #include \"tui/tui-data.h\"\n #include \"tui/tui-win.h\"\n #include \"tui/tui-layout.h\"\n@@ -325,7 +326,14 @@ tui_get_low_disassembly_address (struct gdbarch *gdbarch,\n \n   /* Determine where to start the disassembly so that the pc is about\n      in the middle of the viewport.  */\n-  pos = tui_default_win_viewport_height (DISASSEM_WIN, DISASSEM_COMMAND) / 2;\n+  if (tui_win_list[DISASSEM_WIN] != NULL)\n+    pos = tui_win_list[DISASSEM_WIN]->height;\n+  else if (TUI_CMD_WIN == NULL)\n+    pos = tui_term_height () / 2 - 2;\n+  else\n+    pos = tui_term_height () - TUI_CMD_WIN->height - 2;\n+  pos = (pos - 2) / 2;\n+\n   pc = tui_find_disassembly_address (gdbarch, pc, -pos);\n \n   if (pc < low)"
    },
    {
      "sha": "ccc750e1db47aa7c6c762cd81adde60f4e8e79d3",
      "filename": "gdb/tui/tui-layout.c",
      "status": "modified",
      "additions": 0,
      "deletions": 60,
      "changes": 60,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/gdb/tui/tui-layout.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/gdb/tui/tui-layout.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-layout.c?ref=6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10",
      "patch": "@@ -233,66 +233,6 @@ tui_add_win_to_layout (enum tui_win_type type)\n     }\n }\n \n-\n-/* Answer the height of a window.  If it hasn't been created yet,\n-   answer what the height of a window would be based upon its type and\n-   the layout.  */\n-static int\n-tui_default_win_height (enum tui_win_type type, \n-\t\t\tenum tui_layout_type layout)\n-{\n-  int h;\n-\n-  if (tui_win_list[type] != NULL)\n-    h = tui_win_list[type]->height;\n-  else\n-    {\n-      switch (layout)\n-\t{\n-\tcase SRC_COMMAND:\n-\tcase DISASSEM_COMMAND:\n-\t  if (TUI_CMD_WIN == NULL)\n-\t    h = tui_term_height () / 2;\n-\t  else\n-\t    h = tui_term_height () - TUI_CMD_WIN->height;\n-\t  break;\n-\tcase SRC_DISASSEM_COMMAND:\n-\tcase SRC_DATA_COMMAND:\n-\tcase DISASSEM_DATA_COMMAND:\n-\t  if (TUI_CMD_WIN == NULL)\n-\t    h = tui_term_height () / 3;\n-\t  else\n-\t    h = (tui_term_height () - TUI_CMD_WIN->height) / 2;\n-\t  break;\n-\tdefault:\n-\t  h = 0;\n-\t  break;\n-\t}\n-    }\n-\n-  return h;\n-}\n-\n-\n-/* Answer the height of a window.  If it hasn't been created yet,\n-   answer what the height of a window would be based upon its type and\n-   the layout.  */\n-int\n-tui_default_win_viewport_height (enum tui_win_type type,\n-\t\t\t\t enum tui_layout_type layout)\n-{\n-  int h;\n-\n-  h = tui_default_win_height (type, layout);\n-\n-  if (type == CMD_WIN)\n-    h -= 1;\n-  else\n-    h -= 2;\n-\n-  return h;\n-}\n-\n /* Complete possible layout names.  TEXT is the complete text entered so\n    far, WORD is the word currently being completed.  */\n "
    },
    {
      "sha": "23f05f34aa29e4a7bffbcb37547f23c4423e52ce",
      "filename": "gdb/tui/tui-layout.h",
      "status": "modified",
      "additions": 0,
      "deletions": 2,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/gdb/tui/tui-layout.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10/gdb/tui/tui-layout.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-layout.h?ref=6d7fd9aa4768c3fad5b5354c87eefb8026a0ba10",
      "patch": "@@ -26,8 +26,6 @@\n #include \"tui/tui-data.h\"\n \n extern void tui_add_win_to_layout (enum tui_win_type);\n-extern int tui_default_win_viewport_height (enum tui_win_type,\n-\t\t\t\t\t    enum tui_layout_type);\n extern void tui_set_layout (enum tui_layout_type);\n \n #endif /* TUI_TUI_LAYOUT_H */"
    }
  ]
}