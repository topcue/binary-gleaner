{
  "sha": "113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTEzYmI3NjE4YTRiNTJjNWZjOGZkYzBlODJiMmNkOWY3MjQ3MWY3Mg==",
  "commit": {
    "author": {
      "name": "Job Noorman",
      "email": "mtvec@pm.me",
      "date": "2021-05-18T00:41:11Z"
    },
    "committer": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2021-05-18T01:26:39Z"
    },
    "message": "RISC-V: PR27814, Objdump crashes when disassembling a non-ELF RISC-V binary.\n\n2021-05-18  Job Noorman  <mtvec@pm.me>\n\nopcodes/\n    PR 27814\n    * riscv-dis.c (riscv_get_disassembler): Get elf attributes only for\n    the elf objects.",
    "tree": {
      "sha": "f1df2713e905248346f2e64a711feb8635f58877",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/f1df2713e905248346f2e64a711feb8635f58877"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "549f123c687def1194243cd8ff3bebd14ba67635",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/549f123c687def1194243cd8ff3bebd14ba67635",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/549f123c687def1194243cd8ff3bebd14ba67635"
    }
  ],
  "stats": {
    "total": 30,
    "additions": 20,
    "deletions": 10
  },
  "files": [
    {
      "sha": "11896df782ac20447c44703cc83ffad4d692ac5c",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72",
      "patch": "@@ -1,3 +1,9 @@\n+2021-05-18  Job Noorman  <mtvec@pm.me>\n+\n+\tPR 27814\n+\t* riscv-dis.c (riscv_get_disassembler): Get elf attributes only for\n+\tthe elf objects.\n+\n 2021-05-17  Alex Coplan  <alex.coplan@arm.com>\n \n \t* arm-dis.c (mve_opcodes): Fix disassembly of"
    },
    {
      "sha": "fe8dfb88d903a2aa494763b8ca504344d9818b61",
      "filename": "opcodes/riscv-dis.c",
      "status": "modified",
      "additions": 14,
      "deletions": 10,
      "changes": 24,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72/opcodes/riscv-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72/opcodes/riscv-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/riscv-dis.c?ref=113bb7618a4b52c5fc8fdc0e82b2cd9f72471f72",
      "patch": "@@ -597,17 +597,21 @@ riscv_get_disassembler (bfd *abfd)\n {\n   if (abfd)\n     {\n-      const char *sec_name = get_elf_backend_data (abfd)->obj_attrs_section;\n-      if (bfd_get_section_by_name (abfd, sec_name) != NULL)\n+      const struct elf_backend_data *ebd = get_elf_backend_data (abfd);\n+      if (ebd)\n         {\n-\t  obj_attribute *attr = elf_known_obj_attributes_proc (abfd);\n-\t  unsigned int Tag_a = Tag_RISCV_priv_spec;\n-\t  unsigned int Tag_b = Tag_RISCV_priv_spec_minor;\n-\t  unsigned int Tag_c = Tag_RISCV_priv_spec_revision;\n-\t  riscv_get_priv_spec_class_from_numbers (attr[Tag_a].i,\n-\t\t\t\t\t\t  attr[Tag_b].i,\n-\t\t\t\t\t\t  attr[Tag_c].i,\n-\t\t\t\t\t\t  &default_priv_spec);\n+\t  const char *sec_name = ebd->obj_attrs_section;\n+\t  if (bfd_get_section_by_name (abfd, sec_name) != NULL)\n+\t    {\n+\t      obj_attribute *attr = elf_known_obj_attributes_proc (abfd);\n+\t      unsigned int Tag_a = Tag_RISCV_priv_spec;\n+\t      unsigned int Tag_b = Tag_RISCV_priv_spec_minor;\n+\t      unsigned int Tag_c = Tag_RISCV_priv_spec_revision;\n+\t      riscv_get_priv_spec_class_from_numbers (attr[Tag_a].i,\n+\t\t\t\t\t\t      attr[Tag_b].i,\n+\t\t\t\t\t\t      attr[Tag_c].i,\n+\t\t\t\t\t\t      &default_priv_spec);\n+\t    }\n         }\n     }\n    return print_insn_riscv;"
    }
  ]
}