{
  "sha": "e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZTMwZDFmYTFiZmIxZmYyZTIyNWNmYWM5MjI2YzM1N2YyY2YwN2EyNg==",
  "commit": {
    "author": {
      "name": "Szabolcs Nagy",
      "email": "szabolcs.nagy@arm.com",
      "date": "2018-11-28T19:35:04Z"
    },
    "committer": {
      "name": "Szabolcs Nagy",
      "email": "szabolcs.nagy@arm.com",
      "date": "2019-06-14T11:02:19Z"
    },
    "message": "Add R_AARCH64_P32_MOVW_PREL_* ELF32 relocs\n\nThese ilp32 relocations were missing for some reason.\n\nbfd/ChangeLog:\n\n\t* elfnn-aarch64.c: Enable MOVW_PREL relocs for ELF32.\n\ninclude/ChangeLog:\n\n\t* elf/aarch64.h (R_AARCH64_P32_MOVW_PREL_G0): Define.\n\t(R_AARCH64_P32_MOVW_PREL_G0_NC): Define.\n\t(R_AARCH64_P32_MOVW_PREL_G1): Define.\n\nld/ChangeLog:\n\n\t* testsuite/ld-aarch64/aarch64-elf.exp: Add emit-relocs-22 and -23.\n\t* testsuite/ld-aarch64/emit-relocs-22.d: New test.\n\t* testsuite/ld-aarch64/emit-relocs-22.s: New test.\n\t* testsuite/ld-aarch64/emit-relocs-23.d: New test.\n\t* testsuite/ld-aarch64/emit-relocs-23.s: New test.",
    "tree": {
      "sha": "01c3ad124c43de1bed93213c591243c950fe5571",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/01c3ad124c43de1bed93213c591243c950fe5571"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/comments",
  "author": {
    "login": "nsz-arm",
    "id": 30925343,
    "node_id": "MDQ6VXNlcjMwOTI1MzQz",
    "avatar_url": "https://avatars.githubusercontent.com/u/30925343?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nsz-arm",
    "html_url": "https://github.com/nsz-arm",
    "followers_url": "https://api.github.com/users/nsz-arm/followers",
    "following_url": "https://api.github.com/users/nsz-arm/following{/other_user}",
    "gists_url": "https://api.github.com/users/nsz-arm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nsz-arm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nsz-arm/subscriptions",
    "organizations_url": "https://api.github.com/users/nsz-arm/orgs",
    "repos_url": "https://api.github.com/users/nsz-arm/repos",
    "events_url": "https://api.github.com/users/nsz-arm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nsz-arm/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nsz-arm",
    "id": 30925343,
    "node_id": "MDQ6VXNlcjMwOTI1MzQz",
    "avatar_url": "https://avatars.githubusercontent.com/u/30925343?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nsz-arm",
    "html_url": "https://github.com/nsz-arm",
    "followers_url": "https://api.github.com/users/nsz-arm/followers",
    "following_url": "https://api.github.com/users/nsz-arm/following{/other_user}",
    "gists_url": "https://api.github.com/users/nsz-arm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nsz-arm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nsz-arm/subscriptions",
    "organizations_url": "https://api.github.com/users/nsz-arm/orgs",
    "repos_url": "https://api.github.com/users/nsz-arm/repos",
    "events_url": "https://api.github.com/users/nsz-arm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nsz-arm/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "bcc5a6eb668e560a0020114b6dc261ef494981ba",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/bcc5a6eb668e560a0020114b6dc261ef494981ba",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/bcc5a6eb668e560a0020114b6dc261ef494981ba"
    }
  ],
  "stats": {
    "total": 66,
    "additions": 63,
    "deletions": 3
  },
  "files": [
    {
      "sha": "fa07d3e11c6d834541a6bcf4dab588e52ae2b827",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -1,3 +1,7 @@\n+2019-06-14  Szabolcs Nagy  <szabolcs.nagy@arm.com>\n+\n+\t* elfnn-aarch64.c: Enable MOVW_PREL relocs for ELF32.\n+\n 2019-06-14  Alan Modra  <amodra@gmail.com>\n \n \t* Makefile.in: Regenerate."
    },
    {
      "sha": "ed64e8256c7442e5973e221afe57f9b08c91f44f",
      "filename": "bfd/elfnn-aarch64.c",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/bfd/elfnn-aarch64.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/bfd/elfnn-aarch64.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfnn-aarch64.c?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -717,7 +717,7 @@ static reloc_howto_type elfNN_aarch64_howto_table[] =\n      PC relative address inline.  */\n \n   /* MOV[NZ]:   ((S+A-P) >>  0) & 0xffff */\n-  HOWTO64 (AARCH64_R (MOVW_PREL_G0),\t/* type */\n+  HOWTO (AARCH64_R (MOVW_PREL_G0),\t/* type */\n \t 0,\t\t\t/* rightshift */\n \t 2,\t\t\t/* size (0 = byte, 1 = short, 2 = long) */\n \t 17,\t\t\t/* bitsize */\n@@ -732,7 +732,7 @@ static reloc_howto_type elfNN_aarch64_howto_table[] =\n \t TRUE),\t\t/* pcrel_offset */\n \n   /* MOVK:   ((S+A-P) >>  0) & 0xffff [no overflow check] */\n-  HOWTO64 (AARCH64_R (MOVW_PREL_G0_NC),\t/* type */\n+  HOWTO (AARCH64_R (MOVW_PREL_G0_NC),\t/* type */\n \t 0,\t\t\t/* rightshift */\n \t 2,\t\t\t/* size (0 = byte, 1 = short, 2 = long) */\n \t 16,\t\t\t/* bitsize */\n@@ -747,7 +747,7 @@ static reloc_howto_type elfNN_aarch64_howto_table[] =\n \t TRUE),\t\t/* pcrel_offset */\n \n   /* MOV[NZ]:   ((S+A-P) >> 16) & 0xffff */\n-  HOWTO64 (AARCH64_R (MOVW_PREL_G1),\t/* type */\n+  HOWTO (AARCH64_R (MOVW_PREL_G1),\t/* type */\n \t 16,\t\t\t/* rightshift */\n \t 2,\t\t\t/* size (0 = byte, 1 = short, 2 = long) */\n \t 17,\t\t\t/* bitsize */"
    },
    {
      "sha": "8169b6aae34243aae30988d27235b884e2ebf493",
      "filename": "include/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/include/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/include/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ChangeLog?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -1,3 +1,9 @@\n+2019-06-14  Szabolcs Nagy  <szabolcs.nagy@arm.com>\n+\n+\t* elf/aarch64.h (R_AARCH64_P32_MOVW_PREL_G0): Define.\n+\t(R_AARCH64_P32_MOVW_PREL_G0_NC): Define.\n+\t(R_AARCH64_P32_MOVW_PREL_G1): Define.\n+\n 2019-06-03  Nick Alcock  <nick.alcock@oracle.com>\n \n \t* ctf.h (ctf_enum.cte_value): Fix type to int32_t."
    },
    {
      "sha": "16abd864231313cd5ac8cceaaa07a65e9ea19c3a",
      "filename": "include/elf/aarch64.h",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/include/elf/aarch64.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/include/elf/aarch64.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/elf/aarch64.h?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -128,6 +128,10 @@ RELOC_NUMBER (R_AARCH64_P32_JUMP26, 20)\n /* BL:     ((S+A-P) >> 2) & 0x3ffffff.  */\n RELOC_NUMBER (R_AARCH64_P32_CALL26, 21)\n \n+/* Group relocations to create a 16 or 32 bit PC-relative offset inline.  */\n+RELOC_NUMBER (R_AARCH64_P32_MOVW_PREL_G0, 22)\n+RELOC_NUMBER (R_AARCH64_P32_MOVW_PREL_G0_NC, 23)\n+RELOC_NUMBER (R_AARCH64_P32_MOVW_PREL_G1, 24)\n \n RELOC_NUMBER (R_AARCH64_P32_GOT_LD_PREL19, 25)\n RELOC_NUMBER (R_AARCH64_P32_ADR_GOT_PAGE, 26)"
    },
    {
      "sha": "e5c85e101e5e3e322366d2e9ccca86d0b52beb85",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -1,3 +1,11 @@\n+2019-06-14  Szabolcs Nagy  <szabolcs.nagy@arm.com>\n+\n+\t* testsuite/ld-aarch64/aarch64-elf.exp: Add emit-relocs-22 and -23.\n+\t* testsuite/ld-aarch64/emit-relocs-22.d: New test.\n+\t* testsuite/ld-aarch64/emit-relocs-22.s: New test.\n+\t* testsuite/ld-aarch64/emit-relocs-23.d: New test.\n+\t* testsuite/ld-aarch64/emit-relocs-23.s: New test.\n+\n 2019-06-14  Alan Modra  <amodra@gmail.com>\n \n \t* Makefile.in: Regenerate."
    },
    {
      "sha": "ab8d15271c9a767782ec0145c1a036399ea791bf",
      "filename": "ld/testsuite/ld-aarch64/aarch64-elf.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/aarch64-elf.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/aarch64-elf.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/aarch64-elf.exp?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -96,6 +96,8 @@ run_dump_test \"erratum843419-no-args\"\n \n # Relocation Tests\n run_dump_test_lp64 \"weak-undefined\"\n+run_dump_test \"emit-relocs-22\"\n+run_dump_test \"emit-relocs-23\"\n run_dump_test \"emit-relocs-28\"\n run_dump_test \"emit-relocs-86\"\n run_dump_test \"emit-relocs-86-overflow\""
    },
    {
      "sha": "b1e69e06d7630e1a21d08d4fdf225ab1d21ac4ae",
      "filename": "ld/testsuite/ld-aarch64/emit-relocs-22.d",
      "status": "added",
      "additions": 15,
      "deletions": 0,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/emit-relocs-22.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/emit-relocs-22.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/emit-relocs-22.d?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -0,0 +1,15 @@\n+#source: emit-relocs-22.s\n+#as: -mabi=ilp32\n+#ld: -m [aarch64_choose_ilp32_emul] -T relocs-ilp32.ld --defsym foo1=0x12345 --defsym foo2=0x1234 -e0 --emit-relocs\n+#objdump: -dr\n+\n+.*: +file format .*\n+\n+\n+Disassembly of section \\.text:\n+\n+.* <\\.text>:\n+ +10000:\t528468ad \tmov\tw13, #0x2345                \t// #9029\n+\t+10000: R_AARCH64_P32_MOVW_PREL_G0\tfoo1\n+ +10004:\t129db9f1 \tmov\tw17, #0xffff1230            \t// #-60880\n+\t+10004: R_AARCH64_P32_MOVW_PREL_G0\tfoo2"
    },
    {
      "sha": "1b7870bd5c3f4aae011cf17a04fed8b2eaebd0b0",
      "filename": "ld/testsuite/ld-aarch64/emit-relocs-22.s",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/emit-relocs-22.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/emit-relocs-22.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/emit-relocs-22.s?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -0,0 +1,3 @@\n+.text\n+\tmovz w13, :prel_g0:foo1\n+\tmovz w17, :prel_g0:foo2"
    },
    {
      "sha": "abb939d48b6af51c5896267c426038d087e9757e",
      "filename": "ld/testsuite/ld-aarch64/emit-relocs-23.d",
      "status": "added",
      "additions": 15,
      "deletions": 0,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/emit-relocs-23.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/emit-relocs-23.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/emit-relocs-23.d?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -0,0 +1,15 @@\n+#source: emit-relocs-23.s\n+#as: -mabi=ilp32\n+#ld: -m [aarch64_choose_ilp32_emul] -T relocs-ilp32.ld --defsym foo=0x12345678 -e0 --emit-relocs\n+#objdump: -dr\n+\n+.*: +file format .*\n+\n+\n+Disassembly of section \\.text:\n+\n+.* <\\.text>:\n+ +10000:\t728acf0d \tmovk\tw13, #0x5678\n+\t+10000: R_AARCH64_P32_MOVW_PREL_G0_NC\tfoo\n+ +10004:\t52a24671 \tmov\tw17, #0x12330000            \t// #305332224\n+\t+10004: R_AARCH64_P32_MOVW_PREL_G1\tfoo"
    },
    {
      "sha": "f9c58693378290df91f42931b2f746058f3a16eb",
      "filename": "ld/testsuite/ld-aarch64/emit-relocs-23.s",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/emit-relocs-23.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26/ld/testsuite/ld-aarch64/emit-relocs-23.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-aarch64/emit-relocs-23.s?ref=e30d1fa1bfb1ff2e225cfac9226c357f2cf07a26",
      "patch": "@@ -0,0 +1,3 @@\n+.text\n+\tmovk w13, :prel_g0_nc:foo\n+\tmovz w17, :prel_g1:foo"
    }
  ]
}