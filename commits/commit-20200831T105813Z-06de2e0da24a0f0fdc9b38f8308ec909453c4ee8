{
  "sha": "06de2e0da24a0f0fdc9b38f8308ec909453c4ee8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDZkZTJlMGRhMjRhMGYwZmRjOWIzOGY4MzA4ZWM5MDk0NTNjNGVlOA==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-08-31T08:04:39Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-08-31T10:58:13Z"
    },
    "message": "PR26510 UBSAN: tc-z8k.c left shift of negative value\n\nThis also fixes the packing of the nibble buffer, which contains\nrubbish in the top 4 bits of each element.\n\n\tPR 26510\n\t* config/tc-z8k.c (buffer): Use unsigned char.\n\t(apply_fix): Use unsigned char* pointers.\n\t(build_bytes): Likewise and mask nibbles when packing.",
    "tree": {
      "sha": "d9ba56c1a32ce040a7790a49b36bf42f6cb13f97",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d9ba56c1a32ce040a7790a49b36bf42f6cb13f97"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/06de2e0da24a0f0fdc9b38f8308ec909453c4ee8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/06de2e0da24a0f0fdc9b38f8308ec909453c4ee8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/06de2e0da24a0f0fdc9b38f8308ec909453c4ee8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/06de2e0da24a0f0fdc9b38f8308ec909453c4ee8/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "8e8220177712bff17240687e60b41073bf5d85bb",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8e8220177712bff17240687e60b41073bf5d85bb",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/8e8220177712bff17240687e60b41073bf5d85bb"
    }
  ],
  "stats": {
    "total": 23,
    "additions": 15,
    "deletions": 8
  },
  "files": [
    {
      "sha": "80df2b32ca412bf8e287614374d84d755bb350e2",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/06de2e0da24a0f0fdc9b38f8308ec909453c4ee8/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/06de2e0da24a0f0fdc9b38f8308ec909453c4ee8/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=06de2e0da24a0f0fdc9b38f8308ec909453c4ee8",
      "patch": "@@ -1,3 +1,10 @@\n+2020-08-31  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 26510\n+\t* config/tc-z8k.c (buffer): Use unsigned char.\n+\t(apply_fix): Use unsigned char* pointers.\n+\t(build_bytes): Likewise and mask nibbles when packing.\n+\n 2020-08-31  Alan Modra  <amodra@gmail.com>\n \n \tPR 26503"
    },
    {
      "sha": "58a69f63e5b718a40e27203bfc964fcd59802f13",
      "filename": "gas/config/tc-z8k.c",
      "status": "modified",
      "additions": 8,
      "deletions": 8,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/06de2e0da24a0f0fdc9b38f8308ec909453c4ee8/gas/config/tc-z8k.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/06de2e0da24a0f0fdc9b38f8308ec909453c4ee8/gas/config/tc-z8k.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-z8k.c?ref=06de2e0da24a0f0fdc9b38f8308ec909453c4ee8",
      "patch": "@@ -953,7 +953,7 @@ get_specific (opcode_entry_type *opcode, op_type *operands)\n     return 0;\n }\n \n-static char buffer[20];\n+static unsigned char buffer[20];\n \n static void\n newfix (int ptr, bfd_reloc_code_real_type type, int size, expressionS *operand)\n@@ -984,9 +984,9 @@ newfix (int ptr, bfd_reloc_code_real_type type, int size, expressionS *operand)\n     }\n }\n \n-static char *\n-apply_fix (char *ptr, bfd_reloc_code_real_type type, expressionS *operand,\n-\t   int size)\n+static unsigned char *\n+apply_fix (unsigned char *ptr, bfd_reloc_code_real_type type,\n+\t   expressionS *operand, int size)\n {\n   long n = operand->X_add_number;\n \n@@ -1020,7 +1020,7 @@ apply_fix (char *ptr, bfd_reloc_code_real_type type, expressionS *operand,\n static void\n build_bytes (opcode_entry_type *this_try, struct z8k_op *operand ATTRIBUTE_UNUSED)\n {\n-  char *output_ptr = buffer;\n+  unsigned char *output_ptr = buffer;\n   int c;\n   int nibble;\n   unsigned int *class_ptr;\n@@ -1183,12 +1183,12 @@ build_bytes (opcode_entry_type *this_try, struct z8k_op *operand ATTRIBUTE_UNUSE\n   /* Copy from the nibble buffer into the frag.  */\n   {\n     int length = (output_ptr - buffer) / 2;\n-    char *src = buffer;\n-    char *fragp = frag_more (length);\n+    unsigned char *src = buffer;\n+    unsigned char *fragp = (unsigned char *) frag_more (length);\n \n     while (src < output_ptr)\n       {\n-\t*fragp = (src[0] << 4) | src[1];\n+\t*fragp = ((src[0] & 0xf) << 4) | (src[1] & 0xf);\n \tsrc += 2;\n \tfragp++;\n       }"
    }
  ]
}