{
  "sha": "c568ac5ff708eebf6ef424e5863d3dbd874a3f62",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YzU2OGFjNWZmNzA4ZWViZjZlZjQyNGU1ODYzZDNkYmQ4NzRhM2Y2Mg==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2020-09-16T09:12:39Z"
    },
    "committer": {
      "name": "Lifang Xia",
      "email": "xlf194833_xia@alibaba-inc.com",
      "date": "2020-09-17T06:52:05Z"
    },
    "message": "opcodes/csky: return the default disassembler when there is no bfd\n\nThe disassembler function should return a valid disassembler function\neven when there is no BFD present.  This is implied (I believe) by the\ncomment in dis-asm.h which says the BFD may be NULL.  Further, it\nmakes sense when considering that the disassembler is used in GDB, and\nGDB may connect to a target and perform debugging even without a BFD\nbeing supplied.\n\nThis commit makes the csky_get_disassembler function return the\ndefault disassembler configuration when no bfd is supplied, this is\nthe same default configuration as is used when a BFD is supplied, but\nthe BFD has no attributes section.\n\nBefore the change configuring GDB with --enable-targets=all and\nrunning the tests gdb.base/all-architectures-2.exp results in many\nerrors, but after this change there are no failures.\n\nopcodes/ChangeLog:\n\n\t* csky-dis.c (csky_get_disassembler): Don't return NULL when there\n\tis no BFD.",
    "tree": {
      "sha": "160bb166250bfb409f8a9481e5d55cedbd92490f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/160bb166250bfb409f8a9481e5d55cedbd92490f"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/c568ac5ff708eebf6ef424e5863d3dbd874a3f62",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c568ac5ff708eebf6ef424e5863d3dbd874a3f62",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/c568ac5ff708eebf6ef424e5863d3dbd874a3f62",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c568ac5ff708eebf6ef424e5863d3dbd874a3f62/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": null,
  "parents": [
    {
      "sha": "c2f876e11e5c9cc818a852bd79452ffdc80bc161",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c2f876e11e5c9cc818a852bd79452ffdc80bc161",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c2f876e11e5c9cc818a852bd79452ffdc80bc161"
    }
  ],
  "stats": {
    "total": 37,
    "additions": 22,
    "deletions": 15
  },
  "files": [
    {
      "sha": "624351131a8b35b4a591c86a4edc8a9892e110ef",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c568ac5ff708eebf6ef424e5863d3dbd874a3f62/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c568ac5ff708eebf6ef424e5863d3dbd874a3f62/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=c568ac5ff708eebf6ef424e5863d3dbd874a3f62",
      "patch": "@@ -1,3 +1,8 @@\n+2020-09-16  Andrew Burgess <andrew.burgess@embecosm.com>\n+\n+\t* csky-dis.c (csky_get_disassembler): Don't return NULL when there\n+\tis no BFD.\n+\n 2020-09-16  Alan Modra  <amodra@gmail.com>\n \n \t* ppc-dis.c (ppc_symbol_is_valid): Adjust elf_symbol_from invocation."
    },
    {
      "sha": "a28160b984e5c191066d12dde8abbd8e32752399",
      "filename": "opcodes/csky-dis.c",
      "status": "modified",
      "additions": 17,
      "deletions": 15,
      "changes": 32,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c568ac5ff708eebf6ef424e5863d3dbd874a3f62/opcodes/csky-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c568ac5ff708eebf6ef424e5863d3dbd874a3f62/opcodes/csky-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/csky-dis.c?ref=c568ac5ff708eebf6ef424e5863d3dbd874a3f62",
      "patch": "@@ -239,23 +239,25 @@ csky_get_disassembler (bfd *abfd)\n   obj_attribute *attr;\n   const char *sec_name = NULL;\n   if (!abfd)\n-    return NULL;\n-\n-  mach_flag = elf_elfheader (abfd)->e_flags;\n-\n-  sec_name = get_elf_backend_data (abfd)->obj_attrs_section;\n-  /* Skip any input that hasn't attribute section.\n-     This enables to link object files without attribute section with\n-     any others.  */\n-  if (bfd_get_section_by_name (abfd, sec_name) != NULL)\n+    dis_info.isa = CSKY_DEFAULT_ISA;\n+  else\n     {\n-      attr = elf_known_obj_attributes_proc (abfd);\n-      dis_info.isa = attr[Tag_CSKY_ISA_EXT_FLAGS].i;\n-      dis_info.isa <<= 32;\n-      dis_info.isa |= attr[Tag_CSKY_ISA_FLAGS].i;\n+      mach_flag = elf_elfheader (abfd)->e_flags;\n+\n+      sec_name = get_elf_backend_data (abfd)->obj_attrs_section;\n+      /* Skip any input that hasn't attribute section.\n+         This enables to link object files without attribute section with\n+         any others.  */\n+      if (bfd_get_section_by_name (abfd, sec_name) != NULL)\n+        {\n+          attr = elf_known_obj_attributes_proc (abfd);\n+          dis_info.isa = attr[Tag_CSKY_ISA_EXT_FLAGS].i;\n+          dis_info.isa <<= 32;\n+          dis_info.isa |= attr[Tag_CSKY_ISA_FLAGS].i;\n+        }\n+      else\n+        dis_info.isa = CSKY_DEFAULT_ISA;\n     }\n-  else\n-    dis_info.isa = CSKY_DEFAULT_ISA;\n \n    return print_insn_csky;\n }"
    }
  ]
}