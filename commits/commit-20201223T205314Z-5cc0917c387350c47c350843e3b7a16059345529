{
  "sha": "5cc0917c387350c47c350843e3b7a16059345529",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NWNjMDkxN2MzODczNTBjNDdjMzUwODQzZTNiN2ExNjA1OTM0NTUyOQ==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2020-11-19T17:52:00Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2020-12-23T20:53:14Z"
    },
    "message": "gdb: remove some uses of LA_PRINT_STRING\n\nThis commit removes some, but not all, uses of LA_PRINT_STRING.  In\nthis commit I've removed those uses where there is an obvious language\nobject on which I can instead call the printstr method.\n\nIn the remaining 3 uses it is harder to know if the correct thing is\nto call printstr on the current language, or on a specific language.\nCurrently obviously, we always call on the current language (as that's\nwhat LA_PRINT_STRING does), and clearly this behaviour is good enough\nright now, but is it \"right\"?  I've left them for now and will give\nthem more thought in the future.\n\ngdb/ChangeLog:\n\n\t* expprint.c (print_subexp_standard): Replace uses of\n\tLA_PRINT_STRING.\n\t* f-valprint.c (f_language::value_print_inner): Likewise.\n\t* guile/scm-pretty-print.c (ppscm_print_string_repr): Likewise.\n\t* p-valprint.c (pascal_language::value_print_inner): Likewise.\n\t* python/py-prettyprint.c (print_string_repr): Likewise.",
    "tree": {
      "sha": "f1216a2bfd0c513658b3b1b460513267d6eb8655",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/f1216a2bfd0c513658b3b1b460513267d6eb8655"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/5cc0917c387350c47c350843e3b7a16059345529",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5cc0917c387350c47c350843e3b7a16059345529",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/5cc0917c387350c47c350843e3b7a16059345529",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5cc0917c387350c47c350843e3b7a16059345529/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "1c4852651c26d88494b6c2988f9bee164f1f3d34",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1c4852651c26d88494b6c2988f9bee164f1f3d34",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/1c4852651c26d88494b6c2988f9bee164f1f3d34"
    }
  ],
  "stats": {
    "total": 54,
    "additions": 33,
    "deletions": 21
  },
  "files": [
    {
      "sha": "26d7f5837ccadb50afc37c7ab5c8b32f7e485450",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5cc0917c387350c47c350843e3b7a16059345529/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5cc0917c387350c47c350843e3b7a16059345529/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=5cc0917c387350c47c350843e3b7a16059345529",
      "patch": "@@ -1,3 +1,12 @@\n+2020-12-23  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* expprint.c (print_subexp_standard): Replace uses of\n+\tLA_PRINT_STRING.\n+\t* f-valprint.c (f_language::value_print_inner): Likewise.\n+\t* guile/scm-pretty-print.c (ppscm_print_string_repr): Likewise.\n+\t* p-valprint.c (pascal_language::value_print_inner): Likewise.\n+\t* python/py-prettyprint.c (print_string_repr): Likewise.\n+\n 2020-12-23  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* rust-exp.y (rust_parse): Rename to..."
    },
    {
      "sha": "51dbc567a90a9eff71c8d13af89afab5fb19665a",
      "filename": "gdb/expprint.c",
      "status": "modified",
      "additions": 11,
      "deletions": 8,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5cc0917c387350c47c350843e3b7a16059345529/gdb/expprint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5cc0917c387350c47c350843e3b7a16059345529/gdb/expprint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/expprint.c?ref=5cc0917c387350c47c350843e3b7a16059345529",
      "patch": "@@ -226,9 +226,10 @@ print_subexp_standard (struct expression *exp, int *pos,\n \t   If necessary, we can temporarily set it to zero, or pass it as an\n \t   additional parameter to LA_PRINT_STRING.  -fnf */\n \tget_user_print_options (&opts);\n-\tLA_PRINT_STRING (stream, builtin_type (exp->gdbarch)->builtin_char,\n-\t\t\t (gdb_byte *) &exp->elts[pc + 2].string, nargs,\n-\t\t\t NULL, 0, &opts);\n+\texp->language_defn\n+\t  ->printstr (stream, builtin_type (exp->gdbarch)->builtin_char,\n+\t\t      (gdb_byte *) &exp->elts[pc + 2].string, nargs,\n+\t\t      NULL, 0, &opts);\n       }\n       return;\n \n@@ -241,9 +242,10 @@ print_subexp_standard (struct expression *exp, int *pos,\n \t(*pos) += 3 + BYTES_TO_EXP_ELEM (nargs + 1);\n \tfputs_filtered (\"@\\\"\", stream);\n \tget_user_print_options (&opts);\n-\tLA_PRINT_STRING (stream, builtin_type (exp->gdbarch)->builtin_char,\n-\t\t\t (gdb_byte *) &exp->elts[pc + 2].string, nargs,\n-\t\t\t NULL, 0, &opts);\n+\texp->language_defn\n+\t  ->printstr (stream, builtin_type (exp->gdbarch)->builtin_char,\n+\t\t      (gdb_byte *) &exp->elts[pc + 2].string, nargs,\n+\t\t      NULL, 0, &opts);\n \tfputs_filtered (\"\\\"\", stream);\n       }\n       return;\n@@ -325,8 +327,9 @@ print_subexp_standard (struct expression *exp, int *pos,\n \t  struct value_print_options opts;\n \n \t  get_user_print_options (&opts);\n-\t  LA_PRINT_STRING (stream, builtin_type (exp->gdbarch)->builtin_char,\n-\t\t\t   (gdb_byte *) tempstr, nargs - 1, NULL, 0, &opts);\n+\t  exp->language_defn\n+\t    ->printstr (stream, builtin_type (exp->gdbarch)->builtin_char,\n+\t\t\t(gdb_byte *) tempstr, nargs - 1, NULL, 0, &opts);\n \t  (*pos) = pc;\n \t}\n       else"
    },
    {
      "sha": "63cd9b3bd6b0227f00a4eb8b42dc86235c7c68ee",
      "filename": "gdb/f-valprint.c",
      "status": "modified",
      "additions": 5,
      "deletions": 5,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5cc0917c387350c47c350843e3b7a16059345529/gdb/f-valprint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5cc0917c387350c47c350843e3b7a16059345529/gdb/f-valprint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/f-valprint.c?ref=5cc0917c387350c47c350843e3b7a16059345529",
      "patch": "@@ -235,8 +235,8 @@ f_language::value_print_inner (struct value *val, struct ui_file *stream,\n     {\n     case TYPE_CODE_STRING:\n       f77_get_dynamic_length_of_aggregate (type);\n-      LA_PRINT_STRING (stream, builtin_type (gdbarch)->builtin_char,\n-\t\t       valaddr, TYPE_LENGTH (type), NULL, 0, options);\n+      printstr (stream, builtin_type (gdbarch)->builtin_char, valaddr,\n+\t\tTYPE_LENGTH (type), NULL, 0, options);\n       break;\n \n     case TYPE_CODE_ARRAY:\n@@ -247,9 +247,9 @@ f_language::value_print_inner (struct value *val, struct ui_file *stream,\n \t  struct type *ch_type = TYPE_TARGET_TYPE (type);\n \n \t  f77_get_dynamic_length_of_aggregate (type);\n-\t  LA_PRINT_STRING (stream, ch_type, valaddr,\n-\t\t\t   TYPE_LENGTH (type) / TYPE_LENGTH (ch_type),\n-\t\t\t   NULL, 0, options);\n+\t  printstr (stream, ch_type, valaddr,\n+\t\t    TYPE_LENGTH (type) / TYPE_LENGTH (ch_type), NULL, 0,\n+\t\t    options);\n \t}\n       break;\n "
    },
    {
      "sha": "e08202cbb58a7c5edfea22c4daaf20087273bcb2",
      "filename": "gdb/guile/scm-pretty-print.c",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5cc0917c387350c47c350843e3b7a16059345529/gdb/guile/scm-pretty-print.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5cc0917c387350c47c350843e3b7a16059345529/gdb/guile/scm-pretty-print.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/guile/scm-pretty-print.c?ref=5cc0917c387350c47c350843e3b7a16059345529",
      "patch": "@@ -675,8 +675,8 @@ ppscm_print_string_repr (SCM printer, enum display_hint hint,\n \t{\n \t  struct type *type = builtin_type (gdbarch)->builtin_char;\n \t  \n-\t  LA_PRINT_STRING (stream, type, (gdb_byte *) string.get (),\n-\t\t\t   length, NULL, 0, options);\n+\t  language->printstr (stream, type, (gdb_byte *) string.get (),\n+\t\t\t      length, NULL, 0, options);\n \t}\n       else\n \t{"
    },
    {
      "sha": "323b7c3aa26767d2a285437fb0b6228def04bb89",
      "filename": "gdb/p-valprint.c",
      "status": "modified",
      "additions": 4,
      "deletions": 4,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5cc0917c387350c47c350843e3b7a16059345529/gdb/p-valprint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5cc0917c387350c47c350843e3b7a16059345529/gdb/p-valprint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/p-valprint.c?ref=5cc0917c387350c47c350843e3b7a16059345529",
      "patch": "@@ -116,8 +116,8 @@ pascal_language::value_print_inner (struct value *val,\n \t\t    len = temp_len;\n \t\t  }\n \n-\t\tLA_PRINT_STRING (stream, TYPE_TARGET_TYPE (type),\n-\t\t\t\t valaddr, len, NULL, 0, options);\n+\t\tprintstr (stream, TYPE_TARGET_TYPE (type), valaddr, len,\n+\t\t\t  NULL, 0, options);\n \t\ti = len;\n \t      }\n \t    else\n@@ -318,8 +318,8 @@ pascal_language::value_print_inner (struct value *val,\n \t    {\n \t      len = extract_unsigned_integer (valaddr + length_pos,\n \t\t\t\t\t      length_size, byte_order);\n-\t      LA_PRINT_STRING (stream, char_type, valaddr + string_pos,\n-\t\t\t       len, NULL, 0, options);\n+\t      printstr (stream, char_type, valaddr + string_pos, len,\n+\t\t\tNULL, 0, options);\n \t    }\n \t  else\n \t    pascal_object_print_value_fields (val, stream, recurse,"
    },
    {
      "sha": "6300cb0bc5732b1cc09afb661bbe4724bafa62ee",
      "filename": "gdb/python/py-prettyprint.c",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5cc0917c387350c47c350843e3b7a16059345529/gdb/python/py-prettyprint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5cc0917c387350c47c350843e3b7a16059345529/gdb/python/py-prettyprint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/python/py-prettyprint.c?ref=5cc0917c387350c47c350843e3b7a16059345529",
      "patch": "@@ -318,8 +318,8 @@ print_string_repr (PyObject *printer, const char *hint,\n \t      type = builtin_type (gdbarch)->builtin_char;\n \n \t      if (hint && !strcmp (hint, \"string\"))\n-\t\tLA_PRINT_STRING (stream, type, (gdb_byte *) output,\n-\t\t\t\t length, NULL, 0, options);\n+\t\tlanguage->printstr (stream, type, (gdb_byte *) output,\n+\t\t\t\t    length, NULL, 0, options);\n \t      else\n \t\tfputs_filtered (output, stream);\n \t    }"
    }
  ]
}