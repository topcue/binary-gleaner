{
  "sha": "f5c4b229c67d9ef2e79ba86432a409a8f506b3f6",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZjVjNGIyMjljNjdkOWVmMmU3OWJhODY0MzJhNDA5YThmNTA2YjNmNg==",
  "commit": {
    "author": {
      "name": "Jan Vrany",
      "email": "jan.vrany@labware.com",
      "date": "2020-10-09T05:47:30Z"
    },
    "committer": {
      "name": "Jan Vrany",
      "email": "jan.vrany@labware.com",
      "date": "2020-10-09T05:49:33Z"
    },
    "message": "Notify observers that directories have changed when using \"directory\" CLI command\n\ngdb/ChangeLog\n\n\t* source.c (directory_command): Notify observers that \"directories\"\n\tparameter has changed.\n\ngdb/testsuite/ChangeLog\n\n\t* gdb.mi/mi-cmd-param-changed.exp: Check that notification is\n\tis emmited for both 'set directories' and 'directory' commands.",
    "tree": {
      "sha": "fe70465e3822b6015053b3ef2c34660ed44585f9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/fe70465e3822b6015053b3ef2c34660ed44585f9"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/comments",
  "author": {
    "login": "janvrany",
    "id": 82951,
    "node_id": "MDQ6VXNlcjgyOTUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/82951?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/janvrany",
    "html_url": "https://github.com/janvrany",
    "followers_url": "https://api.github.com/users/janvrany/followers",
    "following_url": "https://api.github.com/users/janvrany/following{/other_user}",
    "gists_url": "https://api.github.com/users/janvrany/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/janvrany/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/janvrany/subscriptions",
    "organizations_url": "https://api.github.com/users/janvrany/orgs",
    "repos_url": "https://api.github.com/users/janvrany/repos",
    "events_url": "https://api.github.com/users/janvrany/events{/privacy}",
    "received_events_url": "https://api.github.com/users/janvrany/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "janvrany",
    "id": 82951,
    "node_id": "MDQ6VXNlcjgyOTUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/82951?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/janvrany",
    "html_url": "https://github.com/janvrany",
    "followers_url": "https://api.github.com/users/janvrany/followers",
    "following_url": "https://api.github.com/users/janvrany/following{/other_user}",
    "gists_url": "https://api.github.com/users/janvrany/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/janvrany/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/janvrany/subscriptions",
    "organizations_url": "https://api.github.com/users/janvrany/orgs",
    "repos_url": "https://api.github.com/users/janvrany/repos",
    "events_url": "https://api.github.com/users/janvrany/events{/privacy}",
    "received_events_url": "https://api.github.com/users/janvrany/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "b270168504d91292ec7089056ce32c68ad6c28a7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b270168504d91292ec7089056ce32c68ad6c28a7",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/b270168504d91292ec7089056ce32c68ad6c28a7"
    }
  ],
  "stats": {
    "total": 32,
    "additions": 30,
    "deletions": 2
  },
  "files": [
    {
      "sha": "4927c895fa017245d76d62cb5eba1b0052674f21",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=f5c4b229c67d9ef2e79ba86432a409a8f506b3f6",
      "patch": "@@ -1,3 +1,8 @@\n+2020-10-09  Jan Vrany  <jan.vrany@labware.com>\n+\n+\t* source.c (directory_command): Notify observers that \"directories\"\n+\tparameter has changed.\n+\n 2020-10-08  Tom Tromey  <tom@tromey.com>\n \n \t* cli/cli-cmds.c (print_disassembly): Style function name and"
    },
    {
      "sha": "a73a31f644cc0d70082ca5a6dd75d96e31a72b3b",
      "filename": "gdb/source.c",
      "status": "modified",
      "additions": 9,
      "deletions": 2,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/gdb/source.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/gdb/source.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/source.c?ref=f5c4b229c67d9ef2e79ba86432a409a8f506b3f6",
      "patch": "@@ -446,6 +446,7 @@ init_source_path (void)\n static void\n directory_command (const char *dirname, int from_tty)\n {\n+  bool value_changed = false;\n   dont_repeat ();\n   /* FIXME, this goes to \"delete dir\"...  */\n   if (dirname == 0)\n@@ -454,15 +455,21 @@ directory_command (const char *dirname, int from_tty)\n \t{\n \t  xfree (source_path);\n \t  init_source_path ();\n+\t  value_changed = true;\n \t}\n     }\n   else\n     {\n       mod_path (dirname, &source_path);\n       forget_cached_source_info ();\n+      value_changed = true;\n+    }\n+  if (value_changed)\n+    {\n+      gdb::observers::command_param_changed.notify (\"directories\", source_path);\n+      if (from_tty)\n+\tshow_directories_1 ((char *) 0, from_tty);\n     }\n-  if (from_tty)\n-    show_directories_1 ((char *) 0, from_tty);\n }\n \n /* Add a path given with the -d command line switch."
    },
    {
      "sha": "3d88199c63c5e123856c21cb0f37f995527f7fbd",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=f5c4b229c67d9ef2e79ba86432a409a8f506b3f6",
      "patch": "@@ -1,3 +1,8 @@\n+2020-10-09  Jan Vrany  <jan.vrany@labware.com>\n+\n+\t* gdb.mi/mi-cmd-param-changed.exp: Check that notification is\n+\tis emmited for both 'set directories' and 'directory' commands.\n+\n 2020-10-08  Tom Tromey  <tom@tromey.com>\n \n \t* gdb.base/style.exp: Check that \"main\"'s name is styled."
    },
    {
      "sha": "2d653c0e801af630b0e67e02ec5e26fbf88ecd40",
      "filename": "gdb/testsuite/gdb.mi/mi-cmd-param-changed.exp",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/gdb/testsuite/gdb.mi/mi-cmd-param-changed.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f5c4b229c67d9ef2e79ba86432a409a8f506b3f6/gdb/testsuite/gdb.mi/mi-cmd-param-changed.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-cmd-param-changed.exp?ref=f5c4b229c67d9ef2e79ba86432a409a8f506b3f6",
      "patch": "@@ -102,6 +102,17 @@ proc test_command_param_changed { } {\n \t    \".*=cmd-param-changed,param=\\\"check type\\\",value=\\\"on\\\".*\\\\^done\" \\\n \t    \"\\\"set ch type on\\\"\"\n \n+\t# Notification is emitted for both 'set directories' and 'directory'.\n+\tmi_gdb_test \"set directories \\$cdir:\\$cwd:/tmp\" \\\n+\t    \".*=cmd-param-changed,param=\\\"directories\\\",value=\\\".*\\\".*\\\\^done\" \\\n+\t    \"\\\"set directories \\$cdir:\\$cwd:/tmp\\\"\"\n+\tmi_gdb_test \"directory /usr/src/gdb\" \\\n+\t    \".*=cmd-param-changed,param=\\\"directories\\\",value=\\\".*\\\".*\\\\^done\" \\\n+\t    \"\\\"directory /usr/src/gdb\\\"\"\n+\tmi_gdb_test \"directory\" \\\n+\t    \".*=cmd-param-changed,param=\\\"directories\\\",value=\\\".*\\\".*\\\\^done\" \\\n+\t    \"\\\"directory\\\"\"\n+\n \tmi_gdb_exit\n     }\n }"
    }
  ]
}