{
  "sha": "4cc2e60671b926ad7e5ed3928c4e54e456c7c344",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NGNjMmU2MDY3MWI5MjZhZDdlNWVkMzkyOGM0ZTU0ZTQ1NmM3YzM0NA==",
  "commit": {
    "author": {
      "name": "Kevin Buettner",
      "email": "kevinb@redhat.com",
      "date": "2021-06-10T01:56:23Z"
    },
    "committer": {
      "name": "Kevin Buettner",
      "email": "kevinb@redhat.com",
      "date": "2021-06-11T21:55:01Z"
    },
    "message": "testsuite/glib-2.34: Match/consume optional libthread_db related output\n\nWhen using glibc-2.34, we now see messages related to the loading of\nthe thread library for non-thread programs.  E.g.  for the test case,\ngdb.base/execl-update-breakpoints.exp, we will see the following when\nstarting the program:\n\n(gdb) break -qualified main\nBreakpoint 1 at 0x100118c: file /ironwood1/sourceware-git/f34-2-glibc244_fix/bld/../../worktree-glibc244_fix/gdb/testsuite/gdb.base/execl-update-breakpoints.c, line 34.\n(gdb) run\nStarting program: [...]/execl-update-breakpoints1\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\n\nThe two lines of output related to libthread_db are new; we didn't see\nthese in the past.  This is a side effect of libc now containing the\npthread API - we can no longer tell whether the program is\nmulti-threaded by simply looking for libpthread.so.  That said, I\nthink that we now want to load libthread_db anyway since it's used to\nresolve TLS variables; i.e. we need it for correctly determining the\nvalue of errno.\n\nThis commit adds the necessary regular expressions to match this\n(optional) additional output in the two tests which were failing\nwithout it.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.base/execl-update-breakpoints.exp: Add regular\n\texpression for optionally matching output related to\n\tlibthread_db.\n\t* gdb.base/fork-print-inferior-events.exp: Likewise.",
    "tree": {
      "sha": "20832d76eb7b85969b9e6699597ff22dae71018d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/20832d76eb7b85969b9e6699597ff22dae71018d"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4cc2e60671b926ad7e5ed3928c4e54e456c7c344",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4cc2e60671b926ad7e5ed3928c4e54e456c7c344",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4cc2e60671b926ad7e5ed3928c4e54e456c7c344",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4cc2e60671b926ad7e5ed3928c4e54e456c7c344/comments",
  "author": {
    "login": "KevinBuettner",
    "id": 65747518,
    "node_id": "MDQ6VXNlcjY1NzQ3NTE4",
    "avatar_url": "https://avatars.githubusercontent.com/u/65747518?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KevinBuettner",
    "html_url": "https://github.com/KevinBuettner",
    "followers_url": "https://api.github.com/users/KevinBuettner/followers",
    "following_url": "https://api.github.com/users/KevinBuettner/following{/other_user}",
    "gists_url": "https://api.github.com/users/KevinBuettner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KevinBuettner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KevinBuettner/subscriptions",
    "organizations_url": "https://api.github.com/users/KevinBuettner/orgs",
    "repos_url": "https://api.github.com/users/KevinBuettner/repos",
    "events_url": "https://api.github.com/users/KevinBuettner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KevinBuettner/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "KevinBuettner",
    "id": 65747518,
    "node_id": "MDQ6VXNlcjY1NzQ3NTE4",
    "avatar_url": "https://avatars.githubusercontent.com/u/65747518?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KevinBuettner",
    "html_url": "https://github.com/KevinBuettner",
    "followers_url": "https://api.github.com/users/KevinBuettner/followers",
    "following_url": "https://api.github.com/users/KevinBuettner/following{/other_user}",
    "gists_url": "https://api.github.com/users/KevinBuettner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KevinBuettner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KevinBuettner/subscriptions",
    "organizations_url": "https://api.github.com/users/KevinBuettner/orgs",
    "repos_url": "https://api.github.com/users/KevinBuettner/repos",
    "events_url": "https://api.github.com/users/KevinBuettner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KevinBuettner/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e2b9ea4bbbf16962da55062b3aef6f5238a50f3d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e2b9ea4bbbf16962da55062b3aef6f5238a50f3d",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e2b9ea4bbbf16962da55062b3aef6f5238a50f3d"
    }
  ],
  "stats": {
    "total": 11,
    "additions": 10,
    "deletions": 1
  },
  "files": [
    {
      "sha": "fa22fc3bae9b43716502c900d7f9700ea790f962",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4cc2e60671b926ad7e5ed3928c4e54e456c7c344/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4cc2e60671b926ad7e5ed3928c4e54e456c7c344/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=4cc2e60671b926ad7e5ed3928c4e54e456c7c344",
      "patch": "@@ -1,3 +1,10 @@\n+2021-06-11  Kevin Buettner  <kevinb@redhat.com>\n+\n+\t* gdb.base/execl-update-breakpoints.exp: Add regular\n+\texpression for optionally matching output related to\n+\tlibthread_db.\n+\t* gdb.base/fork-print-inferior-events.exp: Likewise.\n+\n 2021-06-11  Felix Willgerodt  <felix.willgerodt@intel.com>\n \n \t* gdb.mi/array.f: Convert into..."
    },
    {
      "sha": "f9cd7e861c4c2a7d594fd324dfa826fa2cc8ade4",
      "filename": "gdb/testsuite/gdb.base/execl-update-breakpoints.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4cc2e60671b926ad7e5ed3928c4e54e456c7c344/gdb/testsuite/gdb.base/execl-update-breakpoints.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4cc2e60671b926ad7e5ed3928c4e54e456c7c344/gdb/testsuite/gdb.base/execl-update-breakpoints.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/execl-update-breakpoints.exp?ref=4cc2e60671b926ad7e5ed3928c4e54e456c7c344",
      "patch": "@@ -132,6 +132,7 @@ proc test { always_inserted } {\n \t\"Continuing\\\\.\\r\\n\" \\\n \t\"${not_nl} is executing new program: ${not_nl}\\r\\n\" \\\n \t\"(Reading ${not_nl} from remote target\\\\.\\\\.\\\\.\\r\\n)*\" \\\n+\t\"(?:.Thread debugging using .*? enabled.\\r\\nUsing .*? library .*?\\\\.\\r\\n)?\" \\\n \t\"\\r\\n\" \\\n \t\"Breakpoint 1, main.*$gdb_prompt $\"\n     set message \"continue across exec\""
    },
    {
      "sha": "eda0f50ca7b14f796e7d0f0721b1500340bc637e",
      "filename": "gdb/testsuite/gdb.base/fork-print-inferior-events.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4cc2e60671b926ad7e5ed3928c4e54e456c7c344/gdb/testsuite/gdb.base/fork-print-inferior-events.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4cc2e60671b926ad7e5ed3928c4e54e456c7c344/gdb/testsuite/gdb.base/fork-print-inferior-events.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/fork-print-inferior-events.exp?ref=4cc2e60671b926ad7e5ed3928c4e54e456c7c344",
      "patch": "@@ -59,6 +59,7 @@ set detach_child_re \"${reading_re}\\\\\\[Detaching after fork from child .*\\\\\\]\\r\\n\n set detach_parent_re \"${reading_re}\\\\\\[Detaching after fork from parent .*\\\\\\]\\r\\n\"\n set new_inf_re \"${reading_re}\\\\\\[New inferior $decimal \\\\(.*\\\\)\\\\\\]\\r\\n\"\n set inf_detached_re \"${reading_re}\\\\\\[Inferior $decimal \\\\(.*\\\\) detached\\\\\\]\\r\\n\"\n+set thread_db_re \"(?:\\\\\\[Thread debugging using .*? enabled\\\\\\]\\r\\nUsing .*? library .*?\\\\.\\r\\n)?\"\n \n set expected_output [list \\\n \t\t\t \"${attach_child_re}${new_inf_re}${detach_parent_re}${inf_detached_re}\" \\\n@@ -84,7 +85,7 @@ foreach_with_prefix print_inferior_events { \"on\" \"off\" } {\n \t    set output [lindex $expected_output $i]\n \t    # Always add the \"Starting program...\" string so that we\n \t    # match exactly the lines we want.\n-\t    set output \"Starting program: $binfile\\\\s*\\r\\n${output}${exited_normally_re}\"\n+\t    set output \"Starting program: $binfile\\\\s*\\r\\n${thread_db_re}${output}${thread_db_re}${exited_normally_re}\"\n \t    set i [expr $i + 1]\n \t    gdb_test \"run\" $output\n \t}"
    }
  ]
}