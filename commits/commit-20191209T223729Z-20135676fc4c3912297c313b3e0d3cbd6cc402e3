{
  "sha": "20135676fc4c3912297c313b3e0d3cbd6cc402e3",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MjAxMzU2NzZmYzRjMzkxMjI5N2MzMTNiM2UwZDNjYmQ2Y2M0MDJlMw==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-12-09T10:04:49Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-12-09T22:37:29Z"
    },
    "message": "PR24960, Memory leak from disassembler\n\n\tPR 24960\ninclude/\n\t* dis-asm.h (disassemble_free_target): Declare.\nopcodes/\n\t* disassemble.c (disassemble_free_target): New function.\nbinutils/\n\t* objdump.c (disassemble_data): Call disassemble_free_target.",
    "tree": {
      "sha": "5073836e171a6fa7adbe05c60c23580e14defe79",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/5073836e171a6fa7adbe05c60c23580e14defe79"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/20135676fc4c3912297c313b3e0d3cbd6cc402e3",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/20135676fc4c3912297c313b3e0d3cbd6cc402e3",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/20135676fc4c3912297c313b3e0d3cbd6cc402e3",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/20135676fc4c3912297c313b3e0d3cbd6cc402e3/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "103ebbc35cc1975442e1e6233207d8d7b2016556",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/103ebbc35cc1975442e1e6233207d8d7b2016556",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/103ebbc35cc1975442e1e6233207d8d7b2016556"
    }
  ],
  "stats": {
    "total": 80,
    "additions": 79,
    "deletions": 1
  },
  "files": [
    {
      "sha": "a19480535205738a248a4ebb4b875f9c024f3dc2",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/20135676fc4c3912297c313b3e0d3cbd6cc402e3/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/20135676fc4c3912297c313b3e0d3cbd6cc402e3/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=20135676fc4c3912297c313b3e0d3cbd6cc402e3",
      "patch": "@@ -1,3 +1,8 @@\n+2019-12-10  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 24960\n+\t* objdump.c (disassemble_data): Call disassemble_free_target.\n+\n 2019-12-10  Alan Modra  <amodra@gmail.com>\n \n \t* objdump.c (struct objdump_disasm_info): Delete \"sec\"."
    },
    {
      "sha": "c10136edc3141ab40079dc58445fcb7c21e6bb08",
      "filename": "binutils/objdump.c",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/20135676fc4c3912297c313b3e0d3cbd6cc402e3/binutils/objdump.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/20135676fc4c3912297c313b3e0d3cbd6cc402e3/binutils/objdump.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/objdump.c?ref=20135676fc4c3912297c313b3e0d3cbd6cc402e3",
      "patch": "@@ -2730,6 +2730,7 @@ disassemble_data (bfd *abfd)\n   if (aux.dynrelbuf != NULL)\n     free (aux.dynrelbuf);\n   free (sorted_syms);\n+  disassemble_free_target (&disasm_info);\n }\n \f\n static bfd_boolean"
    },
    {
      "sha": "681cbfa837e017b05135fb9d34f4b528034b13ed",
      "filename": "include/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/20135676fc4c3912297c313b3e0d3cbd6cc402e3/include/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/20135676fc4c3912297c313b3e0d3cbd6cc402e3/include/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ChangeLog?ref=20135676fc4c3912297c313b3e0d3cbd6cc402e3",
      "patch": "@@ -1,3 +1,8 @@\n+2019-12-10  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 24960\n+\t* dis-asm.h (disassemble_free_target): Declare.\n+\n 2019-12-10  Alan Modra  <amodra@gmail.com>\n \n \t* dis-asm.h (struct disassemble_info): Delete insn_sets."
    },
    {
      "sha": "82bf4dc942bc1a034fea13113a5a993db48dbdea",
      "filename": "include/dis-asm.h",
      "status": "modified",
      "additions": 4,
      "deletions": 1,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/20135676fc4c3912297c313b3e0d3cbd6cc402e3/include/dis-asm.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/20135676fc4c3912297c313b3e0d3cbd6cc402e3/include/dis-asm.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/dis-asm.h?ref=20135676fc4c3912297c313b3e0d3cbd6cc402e3",
      "patch": "@@ -325,7 +325,10 @@ extern disassembler_ftype disassembler (enum bfd_architecture arc,\n \n /* Amend the disassemble_info structure as necessary for the target architecture.\n    Should only be called after initialising the info->arch field.  */\n-extern void disassemble_init_for_target (struct disassemble_info * dinfo);\n+extern void disassemble_init_for_target (struct disassemble_info *);\n+\n+/* Tidy any memory allocated by targets, such as info->private_data.  */\n+extern void disassemble_free_target (struct disassemble_info *);\n \n /* Document any target specific options available from the disassembler.  */\n extern void disassembler_usage (FILE *);"
    },
    {
      "sha": "4d22d51178626706f3d7c01701bc9fb932b15986",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/20135676fc4c3912297c313b3e0d3cbd6cc402e3/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/20135676fc4c3912297c313b3e0d3cbd6cc402e3/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=20135676fc4c3912297c313b3e0d3cbd6cc402e3",
      "patch": "@@ -1,3 +1,8 @@\n+2019-12-10  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 24960\n+\t* disassemble.c (disassemble_free_target): New function.\n+\n 2019-12-10  Alan Modra  <amodra@gmail.com>\n \n \t* cgen-dis.in (print_insn_@arch@): Replace insn_sets with private_data."
    },
    {
      "sha": "7c919972ee250a553532062de024ffd2556c85e1",
      "filename": "opcodes/disassemble.c",
      "status": "modified",
      "additions": 59,
      "deletions": 0,
      "changes": 59,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/20135676fc4c3912297c313b3e0d3cbd6cc402e3/opcodes/disassemble.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/20135676fc4c3912297c313b3e0d3cbd6cc402e3/opcodes/disassemble.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/disassemble.c?ref=20135676fc4c3912297c313b3e0d3cbd6cc402e3",
      "patch": "@@ -716,6 +716,65 @@ disassemble_init_for_target (struct disassemble_info * info)\n     }\n }\n \n+void\n+disassemble_free_target (struct disassemble_info *info)\n+{\n+  if (info == NULL)\n+    return;\n+\n+  switch (info->arch)\n+    {\n+    default:\n+      return;\n+\n+#ifdef ARCH_bpf\n+    case bfd_arch_bpf:\n+#endif\n+#ifdef ARCH_m32c\n+    case bfd_arch_m32c:\n+#endif\n+#if defined ARCH_bpf || defined ARCH_m32c\n+      if (info->private_data)\n+\t{\n+\t  CGEN_BITSET *mask = info->private_data;\n+\t  free (mask->bits);\n+\t}\n+      break;\n+#endif\n+\n+#ifdef ARCH_arc\n+    case bfd_arch_arc:\n+      break;\n+#endif\n+#ifdef ARCH_cris\n+    case bfd_arch_cris:\n+      break;\n+#endif\n+#ifdef ARCH_mmix\n+    case bfd_arch_mmix:\n+      break;\n+#endif\n+#ifdef ARCH_nfp\n+    case bfd_arch_nfp:\n+      break;\n+#endif\n+#ifdef ARCH_powerpc\n+    case bfd_arch_powerpc:\n+      break;\n+#endif\n+#ifdef ARCH_riscv\n+    case bfd_arch_riscv:\n+      break;\n+#endif\n+#ifdef ARCH_rs6000\n+    case bfd_arch_rs6000:\n+      break;\n+#endif\n+    }\n+\n+  free (info->private_data);\n+}\n+\n /* Remove whitespace and consecutive commas from OPTIONS.  */\n \n char *"
    }
  ]
}