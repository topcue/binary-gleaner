{
  "sha": "39f34d7b64ee76e07b82a3e57800905d249d8005",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MzlmMzRkN2I2NGVlNzZlMDdiODJhM2U1NzgwMDkwNWQyNDlkODAwNQ==",
  "commit": {
    "author": {
      "name": "Luis Machado",
      "email": "luis.machado@linaro.org",
      "date": "2019-12-11T14:55:49Z"
    },
    "committer": {
      "name": "Luis Machado",
      "email": "luis.machado@linaro.org",
      "date": "2019-12-12T12:12:02Z"
    },
    "message": "Fix unused function error\n\nAttempting to build GDB in Ubuntu 16.04.6 LTS on x86_64, I ran into warnings\nthat caused the build to fail:\n\nbinutils-gdb/gdb/gdbsupport/safe-strerror.c:44:1: error: \u2018char* select_strerror_r(char*, char*)\u2019 defined but not used [-Werror=unused-function]  select_strerror_r (char *res, char *)\n\nThe diagnostic macro DIAGNOSTIC_IGNORE_UNUSED_FUNCTION seems to expand\ncorrectly to its respective pragma, but this doesn't seem to have an effect on\nthe warning. I tried to use the pragma explicitly and got the same result.\n\nATTRIBUTE_UNUSED works fine in this case if you put it in both functions,\nwhich should fix warnings for both gdb and gdbserver builds.\n\nThe compiler version is gcc (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609.\n\nThis is likely the result of PR64079 in GCC, which was fixed by commit\n9e96f1e1b9731c4e1ef4fbbbf0997319973f0537.\n\nTo prevent other developers from attempting to use this macro, only to get\nconfused by it not working as expected, it seems better to not define this\nparticular macro.\n\ngdb/ChangeLog:\n\n2019-12-12  Luis Machado  <luis.machado@linaro.org>\n\n\t* gdbsupport/safe-strerror.c: Don't include diagnostics.h.\n\t(select_strerror_r): Use ATTRIBUTE_UNUSED instead of the diagnostics\n\tmacros.\n\ninclude/ChangeLog:\n\n2019-12-12  Luis Machado  <luis.machado@linaro.org>\n\n\t* diagnostics.h (DIAGNOSTIC_IGNORE_UNUSED_FUNCTION). Remove\n\tdefinitions.\n\nChange-Id: Iad6123d61d76d111e3ef8d24aa8c60112304c749",
    "tree": {
      "sha": "7024bd3b394bce0cad5383372c60dca59e938c22",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/7024bd3b394bce0cad5383372c60dca59e938c22"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/39f34d7b64ee76e07b82a3e57800905d249d8005",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/39f34d7b64ee76e07b82a3e57800905d249d8005",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/39f34d7b64ee76e07b82a3e57800905d249d8005",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/39f34d7b64ee76e07b82a3e57800905d249d8005/comments",
  "author": {
    "login": "luislinaro",
    "id": 53092780,
    "node_id": "MDQ6VXNlcjUzMDkyNzgw",
    "avatar_url": "https://avatars.githubusercontent.com/u/53092780?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/luislinaro",
    "html_url": "https://github.com/luislinaro",
    "followers_url": "https://api.github.com/users/luislinaro/followers",
    "following_url": "https://api.github.com/users/luislinaro/following{/other_user}",
    "gists_url": "https://api.github.com/users/luislinaro/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/luislinaro/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/luislinaro/subscriptions",
    "organizations_url": "https://api.github.com/users/luislinaro/orgs",
    "repos_url": "https://api.github.com/users/luislinaro/repos",
    "events_url": "https://api.github.com/users/luislinaro/events{/privacy}",
    "received_events_url": "https://api.github.com/users/luislinaro/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "luislinaro",
    "id": 53092780,
    "node_id": "MDQ6VXNlcjUzMDkyNzgw",
    "avatar_url": "https://avatars.githubusercontent.com/u/53092780?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/luislinaro",
    "html_url": "https://github.com/luislinaro",
    "followers_url": "https://api.github.com/users/luislinaro/followers",
    "following_url": "https://api.github.com/users/luislinaro/following{/other_user}",
    "gists_url": "https://api.github.com/users/luislinaro/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/luislinaro/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/luislinaro/subscriptions",
    "organizations_url": "https://api.github.com/users/luislinaro/orgs",
    "repos_url": "https://api.github.com/users/luislinaro/repos",
    "events_url": "https://api.github.com/users/luislinaro/events{/privacy}",
    "received_events_url": "https://api.github.com/users/luislinaro/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "4f7cc14110d67a180f5408a91ac53a91f88f776e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4f7cc14110d67a180f5408a91ac53a91f88f776e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/4f7cc14110d67a180f5408a91ac53a91f88f776e"
    }
  ],
  "stats": {
    "total": 32,
    "additions": 13,
    "deletions": 19
  },
  "files": [
    {
      "sha": "5ac4f9cb95e774702432523f926d397e61aeca3f",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39f34d7b64ee76e07b82a3e57800905d249d8005/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39f34d7b64ee76e07b82a3e57800905d249d8005/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=39f34d7b64ee76e07b82a3e57800905d249d8005",
      "patch": "@@ -1,3 +1,9 @@\n+2019-12-12  Luis Machado  <luis.machado@linaro.org>\n+\n+\t* gdbsupport/safe-strerror.c: Don't include diagnostics.h.\n+\t(select_strerror_r): Use ATTRIBUTE_UNUSED instead of the diagnostics\n+\tmacros.\n+\n 2019-12-11  Tom Tromey  <tom@tromey.com>\n \n \t* tui/tui-win.c (tui_set_win_height_command): Call"
    },
    {
      "sha": "a5ddf74835336cd35b685e751bcede02a64b6a46",
      "filename": "gdb/gdbsupport/safe-strerror.c",
      "status": "modified",
      "additions": 2,
      "deletions": 10,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39f34d7b64ee76e07b82a3e57800905d249d8005/gdb/gdbsupport/safe-strerror.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39f34d7b64ee76e07b82a3e57800905d249d8005/gdb/gdbsupport/safe-strerror.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbsupport/safe-strerror.c?ref=39f34d7b64ee76e07b82a3e57800905d249d8005",
      "patch": "@@ -18,7 +18,6 @@\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n \n #include \"common-defs.h\"\n-#include \"diagnostics.h\"\n #include <string.h>\n \n /* There are two different versions of strerror_r; one is GNU-specific, the\n@@ -27,27 +26,20 @@\n    to solve this for us because IPA does not use Gnulib but uses this\n    function.  */\n \n-/* We only ever use one of the two overloads, so suppress the warning for\n-   an unused function.  */\n-DIAGNOSTIC_PUSH\n-DIAGNOSTIC_IGNORE_UNUSED_FUNCTION\n-\n /* Called if we have a XSI-compliant strerror_r.  */\n-static char *\n+ATTRIBUTE_UNUSED static char *\n select_strerror_r (int res, char *buf)\n {\n   return res == 0 ? buf : nullptr;\n }\n \n /* Called if we have a GNU strerror_r.  */\n-static char *\n+ATTRIBUTE_UNUSED static char *\n select_strerror_r (char *res, char *)\n {\n   return res;\n }\n \n-DIAGNOSTIC_POP\n-\n /* Implementation of safe_strerror as defined in common-utils.h.  */\n \n const char *"
    },
    {
      "sha": "1444cc91461ce20be1094cf1c168f40a6415afc5",
      "filename": "include/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39f34d7b64ee76e07b82a3e57800905d249d8005/include/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39f34d7b64ee76e07b82a3e57800905d249d8005/include/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ChangeLog?ref=39f34d7b64ee76e07b82a3e57800905d249d8005",
      "patch": "@@ -1,3 +1,8 @@\n+2019-12-12  Luis Machado  <luis.machado@linaro.org>\n+\n+\t* diagnostics.h (DIAGNOSTIC_IGNORE_UNUSED_FUNCTION). Remove\n+\tdefinitions.\n+\n 2019-12-11  Alan Modra  <amodra@gmail.com>\n \n \t* opcode/mmix.h (PUSHGO_INSN_BYTE): Make unsigned."
    },
    {
      "sha": "019ade2567e6e63a0e294264262762662c922d61",
      "filename": "include/diagnostics.h",
      "status": "modified",
      "additions": 0,
      "deletions": 9,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39f34d7b64ee76e07b82a3e57800905d249d8005/include/diagnostics.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39f34d7b64ee76e07b82a3e57800905d249d8005/include/diagnostics.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/diagnostics.h?ref=39f34d7b64ee76e07b82a3e57800905d249d8005",
      "patch": "@@ -53,8 +53,6 @@\n   DIAGNOSTIC_IGNORE (\"-Wdeprecated-declarations\")\n # define DIAGNOSTIC_IGNORE_DEPRECATED_REGISTER \\\n   DIAGNOSTIC_IGNORE (\"-Wdeprecated-register\")\n-# define DIAGNOSTIC_IGNORE_UNUSED_FUNCTION \\\n-  DIAGNOSTIC_IGNORE (\"-Wunused-function\")\n # if __has_warning (\"-Wenum-compare-switch\")\n #  define DIAGNOSTIC_IGNORE_SWITCH_DIFFERENT_ENUM_TYPES \\\n    DIAGNOSTIC_IGNORE (\"-Wenum-compare-switch\")\n@@ -65,9 +63,6 @@\n \n #elif defined (__GNUC__) /* GCC */\n \n-# define DIAGNOSTIC_IGNORE_UNUSED_FUNCTION \\\n-  DIAGNOSTIC_IGNORE (\"-Wunused-function\")\n-\n # define DIAGNOSTIC_IGNORE_STRINGOP_TRUNCATION \\\n   DIAGNOSTIC_IGNORE (\"-Wstringop-truncation\")\n \n@@ -88,10 +83,6 @@\n # define DIAGNOSTIC_IGNORE_DEPRECATED_REGISTER\n #endif\n \n-#ifndef DIAGNOSTIC_IGNORE_UNUSED_FUNCTION\n-# define DIAGNOSTIC_IGNORE_UNUSED_FUNCTION\n-#endif\n-\n #ifndef DIAGNOSTIC_IGNORE_SWITCH_DIFFERENT_ENUM_TYPES\n # define DIAGNOSTIC_IGNORE_SWITCH_DIFFERENT_ENUM_TYPES\n #endif"
    }
  ]
}