{
  "sha": "efc3a950394676d0781f0397655d1e8be56450bf",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZWZjM2E5NTAzOTQ2NzZkMDc4MWYwMzk3NjU1ZDFlOGJlNTY0NTBiZg==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-04-01T12:40:45Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-04-01T12:41:06Z"
    },
    "message": "x86: Force relocation against local absolute symbol\n\nDefine TC_FORCE_RELOCATION_ABS to force relocation against local\nabsolute symbol.\n\n\tPR gas/25756\n\t* config/tc-i386.h (TC_FORCE_RELOCATION_ABS): New.\n\t* testsuite/gas/i386/localpic.s: Add a test for relocation\n\tagainst local absolute symbol.\n\t* testsuite/gas/i386/x86-64-localpic.s: Likewise.\n\t* testsuite/gas/i386/localpic.d: Updated.\n\t* testsuite/gas/i386/x86-64-localpic.d: Likewise.\n\t* testsuite/gas/i386/ilp32/x86-64-localpic.d: Likewise.",
    "tree": {
      "sha": "1052e935c34a5ebe3f01be8cd9b22e66c60ab257",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/1052e935c34a5ebe3f01be8cd9b22e66c60ab257"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/efc3a950394676d0781f0397655d1e8be56450bf",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/efc3a950394676d0781f0397655d1e8be56450bf",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/efc3a950394676d0781f0397655d1e8be56450bf",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/efc3a950394676d0781f0397655d1e8be56450bf/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "15d47c3a70526cce7bb6a9dcdbd1c19c40247e32",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/15d47c3a70526cce7bb6a9dcdbd1c19c40247e32",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/15d47c3a70526cce7bb6a9dcdbd1c19c40247e32"
    }
  ],
  "stats": {
    "total": 35,
    "additions": 32,
    "deletions": 3
  },
  "files": [
    {
      "sha": "ef0217e5d70aa1a83da637d91428ff686311b6f2",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/efc3a950394676d0781f0397655d1e8be56450bf/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/efc3a950394676d0781f0397655d1e8be56450bf/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=efc3a950394676d0781f0397655d1e8be56450bf",
      "patch": "@@ -1,3 +1,14 @@\n+2020-04-01  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR gas/25756\n+\t* config/tc-i386.h (TC_FORCE_RELOCATION_ABS): New.\n+\t* testsuite/gas/i386/localpic.s: Add a test for relocation\n+\tagainst local absolute symbol.\n+\t* testsuite/gas/i386/x86-64-localpic.s: Likewise.\n+\t* testsuite/gas/i386/localpic.d: Updated.\n+\t* testsuite/gas/i386/x86-64-localpic.d: Likewise.\n+\t* testsuite/gas/i386/ilp32/x86-64-localpic.d: Likewise.\n+\n 2020-04-01  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \tPR gas/25732"
    },
    {
      "sha": "cb426b5b911de13dafd8fb8445353c03f0591176",
      "filename": "gas/config/tc-i386.h",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/efc3a950394676d0781f0397655d1e8be56450bf/gas/config/tc-i386.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/efc3a950394676d0781f0397655d1e8be56450bf/gas/config/tc-i386.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.h?ref=efc3a950394676d0781f0397655d1e8be56450bf",
      "patch": "@@ -180,6 +180,14 @@ extern int tc_i386_fix_adjustable (struct fix *);\n    || (FIX)->fx_r_type == BFD_RELOC_X86_64_GOTPCRELX\t\t\\\n    || (FIX)->fx_r_type == BFD_RELOC_X86_64_REX_GOTPCRELX)\n \n+#define TC_FORCE_RELOCATION_ABS(FIX)\t\t\t\t\\\n+  (TC_FORCE_RELOCATION (FIX)\t\t\t\t\t\\\n+   || (FIX)->fx_r_type == BFD_RELOC_386_GOT32\t\t\t\\\n+   || (FIX)->fx_r_type == BFD_RELOC_386_GOT32X\t\t\t\\\n+   || (FIX)->fx_r_type == BFD_RELOC_X86_64_GOTPCREL\t\t\\\n+   || (FIX)->fx_r_type == BFD_RELOC_X86_64_GOTPCRELX\t\t\\\n+   || (FIX)->fx_r_type == BFD_RELOC_X86_64_REX_GOTPCRELX)\n+\n extern int i386_parse_name (char *, expressionS *, char *);\n #define md_parse_name(s, e, m, c) i386_parse_name (s, e, c)\n "
    },
    {
      "sha": "d0cc4e8efc9ca79844887141e100262a59eecdc6",
      "filename": "gas/testsuite/gas/i386/ilp32/x86-64-localpic.d",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/ilp32/x86-64-localpic.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/ilp32/x86-64-localpic.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/ilp32/x86-64-localpic.d?ref=efc3a950394676d0781f0397655d1e8be56450bf",
      "patch": "@@ -3,9 +3,11 @@\n #readelf: -rsW\n #name: x86-64 (ILP32) local PIC\n \n-Relocation section '.rela.text' at offset 0x[0-9a-f]+ contains 1 entry:\n+Relocation section '.rela.text' at offset 0x[0-9a-f]+ contains 2 entries:\n  +Offset +Info +Type +Sym. Value +Symbol's Name \\+ Addend\n [0-9a-f]+ +[0-9a-f]+ R_X86_64_REX_GOTPCRELX +[0-9a-f]+ +foo - 4\n+[0-9a-f]+ +[0-9a-f]+ R_X86_64_REX_GOTPCRELX +[0-9a-f]+ +bar - 4\n #...\n  +[0-9]+: +[0-9a-f]+ +[0-9a-f]+ +NOTYPE +LOCAL +DEFAULT +[0-9]+ +foo\n+ +[0-9]+: +fffffff0 +[0-9a-f]+ +NOTYPE +LOCAL +DEFAULT +ABS +bar\n #pass"
    },
    {
      "sha": "b06137f437fe1947d2ac72958293fd828ed2f739",
      "filename": "gas/testsuite/gas/i386/localpic.d",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/localpic.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/localpic.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/localpic.d?ref=efc3a950394676d0781f0397655d1e8be56450bf",
      "patch": "@@ -2,9 +2,11 @@\n #readelf: -rs\n #name: i386 local PIC\n \n-Relocation section '.rel.text' at offset 0x[0-9a-f]+ contains 1 entry:\n+Relocation section '.rel.text' at offset 0x[0-9a-f]+ contains 2 entries:\n  Offset     Info    Type            Sym.Value  Sym. Name\n [0-9a-f]+ +[0-9a-f]+ R_386_GOT32X +[0-9a-f]+ +foo\n+[0-9a-f]+ +[0-9a-f]+ R_386_GOT32X +[0-9a-f]+ +bar\n #...\n  +[0-9]+: +[0-9a-f]+ +[0-9a-f]+ +NOTYPE +LOCAL +DEFAULT +[0-9]+ +foo\n+ +[0-9]+: +fffffff0 +[0-9a-f]+ +NOTYPE +LOCAL +DEFAULT +ABS +bar\n #pass"
    },
    {
      "sha": "f57fb18638a48b966d46aa194da3b803571d5ffc",
      "filename": "gas/testsuite/gas/i386/localpic.s",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/localpic.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/localpic.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/localpic.s?ref=efc3a950394676d0781f0397655d1e8be56450bf",
      "patch": "@@ -3,3 +3,5 @@ foo:\n \t.long 0\n \t.text\n movl\tfoo@GOT(%ecx), %eax\n+movl\tbar@GOT(%ecx), %eax\n+\tbar = 0xfffffff0"
    },
    {
      "sha": "62030d410ad90268a4edc1b136407fc31212ef21",
      "filename": "gas/testsuite/gas/i386/x86-64-localpic.d",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/x86-64-localpic.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/x86-64-localpic.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-localpic.d?ref=efc3a950394676d0781f0397655d1e8be56450bf",
      "patch": "@@ -2,9 +2,11 @@\n #readelf: -rsW\n #name: x86-64 local PIC\n \n-Relocation section '.rela.text' at offset 0x[0-9a-f]+ contains 1 entry:\n+Relocation section '.rela.text' at offset 0x[0-9a-f]+ contains 2 entries:\n  +Offset +Info +Type +Symbol's Value +Symbol's Name \\+ Addend\n [0-9a-f]+ +[0-9a-f]+ R_X86_64_REX_GOTPCRELX +[0-9a-f]+ +foo - 4\n+[0-9a-f]+ +[0-9a-f]+ R_X86_64_REX_GOTPCRELX +[0-9a-f]+ +bar - 4\n #...\n  +[0-9]+: +[0-9a-f]+ +[0-9a-f]+ +NOTYPE +LOCAL +DEFAULT +[0-9]+ +foo\n+ +[0-9]+: +0+fffffff0 +[0-9a-f]+ +NOTYPE +LOCAL +DEFAULT +ABS +bar\n #pass"
    },
    {
      "sha": "beda94dc2f3e397ed1253ed4c426559d27c93703",
      "filename": "gas/testsuite/gas/i386/x86-64-localpic.s",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/x86-64-localpic.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/efc3a950394676d0781f0397655d1e8be56450bf/gas/testsuite/gas/i386/x86-64-localpic.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-localpic.s?ref=efc3a950394676d0781f0397655d1e8be56450bf",
      "patch": "@@ -2,3 +2,5 @@\n foo:\n \t.quad 0\n \tmovq\tfoo@GOTPCREL(%rip), %rax\n+\tmovq\tbar@GOTPCREL(%rip), %rax\n+\tbar = 0xfffffff0"
    }
  ]
}