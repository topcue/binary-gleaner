{
  "sha": "ccb1ba62299edce72053dd567b9d384814e11885",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6Y2NiMWJhNjIyOTllZGNlNzIwNTNkZDU2N2I5ZDM4NDgxNGUxMTg4NQ==",
  "commit": {
    "author": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-09-27T18:32:07Z"
    },
    "committer": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-10-22T16:47:24Z"
    },
    "message": "Use libxxhash for hashing, if present\n\nXXHash is faster than htab_hash_string:\n------------------------------------------------------------\nBenchmark                     Time           CPU Iterations\n------------------------------------------------------------\nBM_xxh3                      11 ns         11 ns   65887249\nBM_xxh32                     19 ns         19 ns   36511877\nBM_xxh64                     16 ns         16 ns   42964585\nBM_hash_string              182 ns        182 ns    3853125\nBM_iterative_hash            77 ns         77 ns    9087638\n\nUnfortunately, XXH3 is still experimental (see\nhttps://github.com/Cyan4973/xxHash#user-content-new-experimental-hash-algorithm)\n\nHowever, regular XXH64 is still a lot faster than\nhtab_hash_string per my benchmark above. I used the\nfollowing string for the benchmark:\nstatic constexpr char str[] = \"_ZZZL13make_gdb_typeP7gdbarchP10tdesc_typeEN16gdb_type_creator19make_gdb_type_flagsEPK22tdesc_type_with_fieldsE19__PRETTY_FUNCTION__\";\n\nhtab_hash_string is currently 4.35% + 7.98% (rehashing) of gdb\nstartup when attaching to Chrome's content_shell.\n\nAn additional 5.21% is spent in msymbol_hash, which does not use\nthis hash function. Unfortunately, since it has to lowercase the\nstring, it can't use this hash function.\nBM_msymbol_hash                52 ns         52 ns   13281495\n\nIt may be worth investigating if strlen+XXHash is still faster than\nhtab_hash_string, which would make it easier to use in more places.\n\nDebian ships xxhash as libxxhash{0,-dev}. Fedora ships it as xxhash-devel.\n\ngdb/ChangeLog:\n\n2019-10-22  Christian Biesinger  <cbiesinger@google.com>\n\n\t* Makefile.in: Link with libxxhash.\n\t* config.in: Regenerate.\n\t* configure: Regenerate.\n\t* configure.ac: Search for libxxhash.\n\t* utils.c (fast_hash): Use xxhash if present.\n\nChange-Id: Icab218388b9f829522ed3977f04301ae6d4fc4ca",
    "tree": {
      "sha": "2bea3a6796df3af2f866e854bef525d7a4d18b79",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/2bea3a6796df3af2f866e854bef525d7a4d18b79"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ccb1ba62299edce72053dd567b9d384814e11885",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ccb1ba62299edce72053dd567b9d384814e11885",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ccb1ba62299edce72053dd567b9d384814e11885",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ccb1ba62299edce72053dd567b9d384814e11885/comments",
  "author": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "1a6ff1a96b302283d517b3cdeae7310adecbe859",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1a6ff1a96b302283d517b3cdeae7310adecbe859",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/1a6ff1a96b302283d517b3cdeae7310adecbe859"
    }
  ],
  "stats": {
    "total": 547,
    "additions": 545,
    "deletions": 2
  },
  "files": [
    {
      "sha": "3fac7952add87a349d1b68226d9b2aea0c07dcea",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ccb1ba62299edce72053dd567b9d384814e11885/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ccb1ba62299edce72053dd567b9d384814e11885/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=ccb1ba62299edce72053dd567b9d384814e11885",
      "patch": "@@ -1,3 +1,11 @@\n+2019-10-22  Christian Biesinger  <cbiesinger@google.com>\n+\n+\t* Makefile.in: Link with libxxhash.\n+\t* config.in: Regenerate.\n+\t* configure: Regenerate.\n+\t* configure.ac: Search for libxxhash.\n+\t* utils.c (fast_hash): Use xxhash if present.\n+\n 2019-10-22  Christian Biesinger  <cbiesinger@google.com>\n \n \t* utils.h (fast_hash): New function."
    },
    {
      "sha": "553b3ffdc4cf92799ef05ce6177ce835c2dfd885",
      "filename": "gdb/Makefile.in",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ccb1ba62299edce72053dd567b9d384814e11885/gdb/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ccb1ba62299edce72053dd567b9d384814e11885/gdb/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/Makefile.in?ref=ccb1ba62299edce72053dd567b9d384814e11885",
      "patch": "@@ -187,10 +187,14 @@ LIBEXPAT = @LIBEXPAT@\n # Where is lzma?  This will be empty if lzma was not available.\n LIBLZMA = @LIBLZMA@\n \n-# Where is libbabeltrace? This will be empty if lbabeltrace was not\n+# Where is libbabeltrace? This will be empty if libbabeltrace was not\n # available.\n LIBBABELTRACE = @LIBBABELTRACE@\n \n+# Where is libxxhash? This will be empty if libxxhash was not\n+# available.\n+LIBXXHASH = @LIBXXHASH@\n+\n # Where is libipt?  This will be empty if libipt was not available.\n LIBIPT = @LIBIPT@\n \n@@ -597,7 +601,7 @@ CLIBS = $(SIM) $(READLINE) $(OPCODES) $(BFD) $(LIBCTF) $(ZLIB) \\\n \t@LIBS@ @GUILE_LIBS@ @PYTHON_LIBS@ \\\n \t$(LIBEXPAT) $(LIBLZMA) $(LIBBABELTRACE) $(LIBIPT) \\\n \t$(LIBIBERTY) $(WIN32LIBS) $(LIBGNU) $(LIBICONV) $(LIBMPFR) \\\n-\t$(SRCHIGH_LIBS)\n+\t$(SRCHIGH_LIBS) $(LIBXXHASH)\n CDEPS = $(NAT_CDEPS) $(SIM) $(BFD) $(READLINE_DEPS) $(LIBCTF) \\\n \t$(OPCODES) $(INTL_DEPS) $(LIBIBERTY) $(CONFIG_DEPS) $(LIBGNU)\n "
    },
    {
      "sha": "da365a7fc8255be71a5e7a9736df2347a6458838",
      "filename": "gdb/config.in",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ccb1ba62299edce72053dd567b9d384814e11885/gdb/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ccb1ba62299edce72053dd567b9d384814e11885/gdb/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/config.in?ref=ccb1ba62299edce72053dd567b9d384814e11885",
      "patch": "@@ -255,6 +255,9 @@\n /* Define to 1 if you have the <libunwind-ia64.h> header file. */\n #undef HAVE_LIBUNWIND_IA64_H\n \n+/* Define if you have the xxhash library. */\n+#undef HAVE_LIBXXHASH\n+\n /* Define to 1 if you have the <linux/elf.h> header file. */\n #undef HAVE_LINUX_ELF_H\n "
    },
    {
      "sha": "ae8e451e7601adc969edccf4aaf49dfb90effca3",
      "filename": "gdb/configure",
      "status": "modified",
      "additions": 497,
      "deletions": 0,
      "changes": 497,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ccb1ba62299edce72053dd567b9d384814e11885/gdb/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ccb1ba62299edce72053dd567b9d384814e11885/gdb/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure?ref=ccb1ba62299edce72053dd567b9d384814e11885",
      "patch": "@@ -628,6 +628,9 @@ GDB_TRANSFORM_NAME\n XSLTPROC\n NM_H\n GDB_NM_FILE\n+LTLIBXXHASH\n+LIBXXHASH\n+HAVE_LIBXXHASH\n LTLIBBABELTRACE\n LIBBABELTRACE\n HAVE_LIBBABELTRACE\n@@ -898,6 +901,8 @@ enable_sim\n enable_gdbserver\n with_babeltrace\n with_libbabeltrace_prefix\n+with_xxhash\n+with_libxxhash_prefix\n enable_unit_tests\n '\n       ac_precious_vars='build_alias\n@@ -1628,6 +1633,9 @@ Optional Packages:\n   --with-babeltrace       include babeltrace support (auto/yes/no)\n   --with-libbabeltrace-prefix[=DIR]  search for libbabeltrace in DIR/include and DIR/lib\n   --without-libbabeltrace-prefix     don't search for libbabeltrace in includedir and libdir\n+  --with-xxhash           use libxxhash for hashing (faster) (auto/yes/no)\n+  --with-libxxhash-prefix[=DIR]  search for libxxhash in DIR/include and DIR/lib\n+  --without-libxxhash-prefix     don't search for libxxhash in includedir and libdir\n \n Some influential environment variables:\n   CC          C compiler command\n@@ -17557,6 +17565,495 @@ $as_echo \"$as_me: WARNING: babeltrace is missing or unusable; GDB is unable to r\n   fi\n fi\n \n+# Check for xxhash\n+\n+# Check whether --with-xxhash was given.\n+if test \"${with_xxhash+set}\" = set; then :\n+  withval=$with_xxhash;\n+else\n+  with_xxhash=auto\n+fi\n+\n+\n+if test \"x$with_xxhash\" != \"xno\"; then\n+\n+\n+\n+\n+\n+\n+\n+\n+    use_additional=yes\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+\n+    eval additional_includedir=\\\"$includedir\\\"\n+    eval additional_libdir=\\\"$libdir\\\"\n+\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+\n+# Check whether --with-libxxhash-prefix was given.\n+if test \"${with_libxxhash_prefix+set}\" = set; then :\n+  withval=$with_libxxhash_prefix;\n+    if test \"X$withval\" = \"Xno\"; then\n+      use_additional=no\n+    else\n+      if test \"X$withval\" = \"X\"; then\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+\n+          eval additional_includedir=\\\"$includedir\\\"\n+          eval additional_libdir=\\\"$libdir\\\"\n+\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+      else\n+        additional_includedir=\"$withval/include\"\n+        additional_libdir=\"$withval/lib\"\n+      fi\n+    fi\n+\n+fi\n+\n+      LIBXXHASH=\n+  LTLIBXXHASH=\n+  INCXXHASH=\n+  rpathdirs=\n+  ltrpathdirs=\n+  names_already_handled=\n+  names_next_round='xxhash '\n+  while test -n \"$names_next_round\"; do\n+    names_this_round=\"$names_next_round\"\n+    names_next_round=\n+    for name in $names_this_round; do\n+      already_handled=\n+      for n in $names_already_handled; do\n+        if test \"$n\" = \"$name\"; then\n+          already_handled=yes\n+          break\n+        fi\n+      done\n+      if test -z \"$already_handled\"; then\n+        names_already_handled=\"$names_already_handled $name\"\n+                        uppername=`echo \"$name\" | sed -e 'y|abcdefghijklmnopqrstuvwxyz./-|ABCDEFGHIJKLMNOPQRSTUVWXYZ___|'`\n+        eval value=\\\"\\$HAVE_LIB$uppername\\\"\n+        if test -n \"$value\"; then\n+          if test \"$value\" = yes; then\n+            eval value=\\\"\\$LIB$uppername\\\"\n+            test -z \"$value\" || LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$value\"\n+            eval value=\\\"\\$LTLIB$uppername\\\"\n+            test -z \"$value\" || LTLIBXXHASH=\"${LTLIBXXHASH}${LTLIBXXHASH:+ }$value\"\n+          else\n+                                    :\n+          fi\n+        else\n+                              found_dir=\n+          found_la=\n+          found_so=\n+          found_a=\n+          if test $use_additional = yes; then\n+            if test -n \"$shlibext\" && test -f \"$additional_libdir/lib$name.$shlibext\"; then\n+              found_dir=\"$additional_libdir\"\n+              found_so=\"$additional_libdir/lib$name.$shlibext\"\n+              if test -f \"$additional_libdir/lib$name.la\"; then\n+                found_la=\"$additional_libdir/lib$name.la\"\n+              fi\n+            else\n+              if test -f \"$additional_libdir/lib$name.$libext\"; then\n+                found_dir=\"$additional_libdir\"\n+                found_a=\"$additional_libdir/lib$name.$libext\"\n+                if test -f \"$additional_libdir/lib$name.la\"; then\n+                  found_la=\"$additional_libdir/lib$name.la\"\n+                fi\n+              fi\n+            fi\n+          fi\n+          if test \"X$found_dir\" = \"X\"; then\n+            for x in $LDFLAGS $LTLIBXXHASH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+              case \"$x\" in\n+                -L*)\n+                  dir=`echo \"X$x\" | sed -e 's/^X-L//'`\n+                  if test -n \"$shlibext\" && test -f \"$dir/lib$name.$shlibext\"; then\n+                    found_dir=\"$dir\"\n+                    found_so=\"$dir/lib$name.$shlibext\"\n+                    if test -f \"$dir/lib$name.la\"; then\n+                      found_la=\"$dir/lib$name.la\"\n+                    fi\n+                  else\n+                    if test -f \"$dir/lib$name.$libext\"; then\n+                      found_dir=\"$dir\"\n+                      found_a=\"$dir/lib$name.$libext\"\n+                      if test -f \"$dir/lib$name.la\"; then\n+                        found_la=\"$dir/lib$name.la\"\n+                      fi\n+                    fi\n+                  fi\n+                  ;;\n+              esac\n+              if test \"X$found_dir\" != \"X\"; then\n+                break\n+              fi\n+            done\n+          fi\n+          if test \"X$found_dir\" != \"X\"; then\n+                        LTLIBXXHASH=\"${LTLIBXXHASH}${LTLIBXXHASH:+ }-L$found_dir -l$name\"\n+            if test \"X$found_so\" != \"X\"; then\n+                                                        if test \"$enable_rpath\" = no || test \"X$found_dir\" = \"X/usr/lib\"; then\n+                                LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$found_so\"\n+              else\n+                                                                                haveit=\n+                for x in $ltrpathdirs; do\n+                  if test \"X$x\" = \"X$found_dir\"; then\n+                    haveit=yes\n+                    break\n+                  fi\n+                done\n+                if test -z \"$haveit\"; then\n+                  ltrpathdirs=\"$ltrpathdirs $found_dir\"\n+                fi\n+                                if test \"$hardcode_direct\" = yes; then\n+                                                      LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$found_so\"\n+                else\n+                  if test -n \"$hardcode_libdir_flag_spec\" && test \"$hardcode_minus_L\" = no; then\n+                                                            LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$found_so\"\n+                                                            haveit=\n+                    for x in $rpathdirs; do\n+                      if test \"X$x\" = \"X$found_dir\"; then\n+                        haveit=yes\n+                        break\n+                      fi\n+                    done\n+                    if test -z \"$haveit\"; then\n+                      rpathdirs=\"$rpathdirs $found_dir\"\n+                    fi\n+                  else\n+                                                                                haveit=\n+                    for x in $LDFLAGS $LIBXXHASH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                      if test \"X$x\" = \"X-L$found_dir\"; then\n+                        haveit=yes\n+                        break\n+                      fi\n+                    done\n+                    if test -z \"$haveit\"; then\n+                      LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }-L$found_dir\"\n+                    fi\n+                    if test \"$hardcode_minus_L\" != no; then\n+                                                                                        LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$found_so\"\n+                    else\n+                                                                                                                                                                                LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }-l$name\"\n+                    fi\n+                  fi\n+                fi\n+              fi\n+            else\n+              if test \"X$found_a\" != \"X\"; then\n+                                LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$found_a\"\n+              else\n+                                                LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }-L$found_dir -l$name\"\n+              fi\n+            fi\n+                        additional_includedir=\n+            case \"$found_dir\" in\n+              */lib | */lib/)\n+                basedir=`echo \"X$found_dir\" | sed -e 's,^X,,' -e 's,/lib/*$,,'`\n+                additional_includedir=\"$basedir/include\"\n+                ;;\n+            esac\n+            if test \"X$additional_includedir\" != \"X\"; then\n+                                                                                                                if test \"X$additional_includedir\" != \"X/usr/include\"; then\n+                haveit=\n+                if test \"X$additional_includedir\" = \"X/usr/local/include\"; then\n+                  if test -n \"$GCC\"; then\n+                    case $host_os in\n+                      linux*) haveit=yes;;\n+                    esac\n+                  fi\n+                fi\n+                if test -z \"$haveit\"; then\n+                  for x in $CPPFLAGS $INCXXHASH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                    if test \"X$x\" = \"X-I$additional_includedir\"; then\n+                      haveit=yes\n+                      break\n+                    fi\n+                  done\n+                  if test -z \"$haveit\"; then\n+                    if test -d \"$additional_includedir\"; then\n+                                            INCXXHASH=\"${INCXXHASH}${INCXXHASH:+ }-I$additional_includedir\"\n+                    fi\n+                  fi\n+                fi\n+              fi\n+            fi\n+                        if test -n \"$found_la\"; then\n+                                                        save_libdir=\"$libdir\"\n+              case \"$found_la\" in\n+                */* | *\\\\*) . \"$found_la\" ;;\n+                *) . \"./$found_la\" ;;\n+              esac\n+              libdir=\"$save_libdir\"\n+                            for dep in $dependency_libs; do\n+                case \"$dep\" in\n+                  -L*)\n+                    additional_libdir=`echo \"X$dep\" | sed -e 's/^X-L//'`\n+                                                                                                                                                                if test \"X$additional_libdir\" != \"X/usr/lib\"; then\n+                      haveit=\n+                      if test \"X$additional_libdir\" = \"X/usr/local/lib\"; then\n+                        if test -n \"$GCC\"; then\n+                          case $host_os in\n+                            linux*) haveit=yes;;\n+                          esac\n+                        fi\n+                      fi\n+                      if test -z \"$haveit\"; then\n+                        haveit=\n+                        for x in $LDFLAGS $LIBXXHASH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n+                            haveit=yes\n+                            break\n+                          fi\n+                        done\n+                        if test -z \"$haveit\"; then\n+                          if test -d \"$additional_libdir\"; then\n+                                                        LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }-L$additional_libdir\"\n+                          fi\n+                        fi\n+                        haveit=\n+                        for x in $LDFLAGS $LTLIBXXHASH; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+                          if test \"X$x\" = \"X-L$additional_libdir\"; then\n+                            haveit=yes\n+                            break\n+                          fi\n+                        done\n+                        if test -z \"$haveit\"; then\n+                          if test -d \"$additional_libdir\"; then\n+                                                        LTLIBXXHASH=\"${LTLIBXXHASH}${LTLIBXXHASH:+ }-L$additional_libdir\"\n+                          fi\n+                        fi\n+                      fi\n+                    fi\n+                    ;;\n+                  -R*)\n+                    dir=`echo \"X$dep\" | sed -e 's/^X-R//'`\n+                    if test \"$enable_rpath\" != no; then\n+                                                                  haveit=\n+                      for x in $rpathdirs; do\n+                        if test \"X$x\" = \"X$dir\"; then\n+                          haveit=yes\n+                          break\n+                        fi\n+                      done\n+                      if test -z \"$haveit\"; then\n+                        rpathdirs=\"$rpathdirs $dir\"\n+                      fi\n+                                                                  haveit=\n+                      for x in $ltrpathdirs; do\n+                        if test \"X$x\" = \"X$dir\"; then\n+                          haveit=yes\n+                          break\n+                        fi\n+                      done\n+                      if test -z \"$haveit\"; then\n+                        ltrpathdirs=\"$ltrpathdirs $dir\"\n+                      fi\n+                    fi\n+                    ;;\n+                  -l*)\n+                                        names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's/^X-l//'`\n+                    ;;\n+                  *.la)\n+                                                                                names_next_round=\"$names_next_round \"`echo \"X$dep\" | sed -e 's,^X.*/,,' -e 's,^lib,,' -e 's,\\.la$,,'`\n+                    ;;\n+                  *)\n+                                        LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$dep\"\n+                    LTLIBXXHASH=\"${LTLIBXXHASH}${LTLIBXXHASH:+ }$dep\"\n+                    ;;\n+                esac\n+              done\n+            fi\n+          else\n+                                                            LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }-l$name\"\n+            LTLIBXXHASH=\"${LTLIBXXHASH}${LTLIBXXHASH:+ }-l$name\"\n+          fi\n+        fi\n+      fi\n+    done\n+  done\n+  if test \"X$rpathdirs\" != \"X\"; then\n+    if test -n \"$hardcode_libdir_separator\"; then\n+                        alldirs=\n+      for found_dir in $rpathdirs; do\n+        alldirs=\"${alldirs}${alldirs:+$hardcode_libdir_separator}$found_dir\"\n+      done\n+            acl_save_libdir=\"$libdir\"\n+      libdir=\"$alldirs\"\n+      eval flag=\\\"$hardcode_libdir_flag_spec\\\"\n+      libdir=\"$acl_save_libdir\"\n+      LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$flag\"\n+    else\n+            for found_dir in $rpathdirs; do\n+        acl_save_libdir=\"$libdir\"\n+        libdir=\"$found_dir\"\n+        eval flag=\\\"$hardcode_libdir_flag_spec\\\"\n+        libdir=\"$acl_save_libdir\"\n+        LIBXXHASH=\"${LIBXXHASH}${LIBXXHASH:+ }$flag\"\n+      done\n+    fi\n+  fi\n+  if test \"X$ltrpathdirs\" != \"X\"; then\n+            for found_dir in $ltrpathdirs; do\n+      LTLIBXXHASH=\"${LTLIBXXHASH}${LTLIBXXHASH:+ }-R$found_dir\"\n+    done\n+  fi\n+\n+\n+        ac_save_CPPFLAGS=\"$CPPFLAGS\"\n+\n+  for element in $INCXXHASH; do\n+    haveit=\n+    for x in $CPPFLAGS; do\n+\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  acl_save_exec_prefix=\"$exec_prefix\"\n+  exec_prefix=\"$acl_final_exec_prefix\"\n+  eval x=\\\"$x\\\"\n+  exec_prefix=\"$acl_save_exec_prefix\"\n+  prefix=\"$acl_save_prefix\"\n+\n+      if test \"X$x\" = \"X$element\"; then\n+        haveit=yes\n+        break\n+      fi\n+    done\n+    if test -z \"$haveit\"; then\n+      CPPFLAGS=\"${CPPFLAGS}${CPPFLAGS:+ }$element\"\n+    fi\n+  done\n+\n+\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for libxxhash\" >&5\n+$as_echo_n \"checking for libxxhash... \" >&6; }\n+if ${ac_cv_libxxhash+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+\n+    ac_save_LIBS=\"$LIBS\"\n+    LIBS=\"$LIBS $LIBXXHASH\"\n+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <xxhash.h>\n+int\n+main ()\n+{\n+XXH32(\"foo\", 3, 0);\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  ac_cv_libxxhash=yes\n+else\n+  ac_cv_libxxhash=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+    LIBS=\"$ac_save_LIBS\"\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_libxxhash\" >&5\n+$as_echo \"$ac_cv_libxxhash\" >&6; }\n+  if test \"$ac_cv_libxxhash\" = yes; then\n+    HAVE_LIBXXHASH=yes\n+\n+$as_echo \"#define HAVE_LIBXXHASH 1\" >>confdefs.h\n+\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking how to link with libxxhash\" >&5\n+$as_echo_n \"checking how to link with libxxhash... \" >&6; }\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $LIBXXHASH\" >&5\n+$as_echo \"$LIBXXHASH\" >&6; }\n+  else\n+    HAVE_LIBXXHASH=no\n+            CPPFLAGS=\"$ac_save_CPPFLAGS\"\n+    LIBXXHASH=\n+    LTLIBXXHASH=\n+  fi\n+\n+\n+\n+\n+\n+\n+  if test \"$HAVE_LIBXXHASH\" != yes; then\n+    if test \"$with_xxhash\" = yes; then\n+      as_fn_error $? \"xxhash is missing or unusable\" \"$LINENO\" 5\n+    fi\n+  fi\n+  if test \"x$with_xxhash\" = \"xauto\"; then\n+    with_xxhash=\"$HAVE_LIBXXHASH\"\n+  fi\n+fi\n+\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether to use xxhash\" >&5\n+$as_echo_n \"checking whether to use xxhash... \" >&6; }\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $with_xxhash\" >&5\n+$as_echo \"$with_xxhash\" >&6; }\n+\n NM_H=\n rm -f nm.h\n if test \"${nativefile}\" != \"\"; then"
    },
    {
      "sha": "629750210c66cb6dfce940dbcf396dc84d8a9363",
      "filename": "gdb/configure.ac",
      "status": "modified",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ccb1ba62299edce72053dd567b9d384814e11885/gdb/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ccb1ba62299edce72053dd567b9d384814e11885/gdb/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure.ac?ref=ccb1ba62299edce72053dd567b9d384814e11885",
      "patch": "@@ -2217,6 +2217,29 @@ else\n   fi\n fi\n \n+# Check for xxhash\n+AC_ARG_WITH(xxhash,\n+  AC_HELP_STRING([--with-xxhash], [use libxxhash for hashing (faster) (auto/yes/no)]),\n+  [], [with_xxhash=auto])\n+\n+if test \"x$with_xxhash\" != \"xno\"; then\n+  AC_LIB_HAVE_LINKFLAGS([xxhash], [],\n+\t\t\t[#include <xxhash.h>],\n+\t\t\t[XXH32(\"foo\", 3, 0);\n+\t\t\t])\n+  if test \"$HAVE_LIBXXHASH\" != yes; then\n+    if test \"$with_xxhash\" = yes; then\n+      AC_MSG_ERROR([xxhash is missing or unusable])\n+    fi\n+  fi\n+  if test \"x$with_xxhash\" = \"xauto\"; then\n+    with_xxhash=\"$HAVE_LIBXXHASH\"\n+  fi\n+fi\n+\n+AC_MSG_CHECKING([whether to use xxhash])\n+AC_MSG_RESULT([$with_xxhash])\n+\n NM_H=\n rm -f nm.h\n if test \"${nativefile}\" != \"\"; then"
    },
    {
      "sha": "1b62e55b57e5a15518f48b43ca474a7af68db0d0",
      "filename": "gdb/utils.c",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ccb1ba62299edce72053dd567b9d384814e11885/gdb/utils.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ccb1ba62299edce72053dd567b9d384814e11885/gdb/utils.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/utils.c?ref=ccb1ba62299edce72053dd567b9d384814e11885",
      "patch": "@@ -36,6 +36,10 @@\n #include <pc.h>\n #endif\n \n+#ifdef HAVE_LIBXXHASH\n+#include <xxhash.h>\n+#endif\n+\n #include <signal.h>\n #include \"gdbcmd.h\"\n #include \"serial.h\""
    },
    {
      "sha": "a8ad9d9c862a3b336167c07e487a05b04472ebe5",
      "filename": "gdb/utils.h",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ccb1ba62299edce72053dd567b9d384814e11885/gdb/utils.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ccb1ba62299edce72053dd567b9d384814e11885/gdb/utils.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/utils.h?ref=ccb1ba62299edce72053dd567b9d384814e11885",
      "patch": "@@ -574,7 +574,11 @@ extern void copy_bitwise (gdb_byte *dest, ULONGEST dest_offset,\n static inline unsigned int\n fast_hash (const char* str, size_t len)\n {\n+#ifdef HAVE_LIBXXHASH\n+  return XXH64 (str, len, 0);\n+#else\n   return iterative_hash (str, len, 0);\n+#endif\n }\n \n #endif /* UTILS_H */"
    }
  ]
}