{
  "sha": "18263be7565782a9c07045a7a72d80c507a5be09",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTgyNjNiZTc1NjU3ODJhOWMwNzA0NWE3YTcyZDgwYzUwN2E1YmUwOQ==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@efficios.com",
      "date": "2021-06-17T13:41:59Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2021-06-17T13:41:59Z"
    },
    "message": "gdb/testsuite: gdb.base/args.exp: add KFAIL for native-extended-gdbserver\n\nThis test tests passing arguments made of exactly two single-quotes\n('') or a single newline character through the --args argument of GDB.\nFor some reason, GDB adds some extra single quotes when transmitting the\narguments to GDBserver.  This produces some FAILs when testing with the\nnative-extended-gdbserver board:\n\n    FAIL: gdb.base/args.exp: argv[2] for one empty (with single quotes)\n    FAIL: gdb.base/args.exp: argv[2] for two empty (with single quotes)\n    FAIL: gdb.base/args.exp: argv[3] for two empty (with single quotes)\n    FAIL: gdb.base/args.exp: argv[2] for one newline\n    FAIL: gdb.base/args.exp: argv[2] for two newlines\n    FAIL: gdb.base/args.exp: argv[3] for two newlines\n\nThis is documented as PR 27989.  Add some appropriate KFAILs.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.base/args.exp: Check target, KFAIL if remote.\n\t(args_test): Add parameter and use it.\n\nChange-Id: I49225d1c7df7ebaba480ebdd596df80f8fbf62f0",
    "tree": {
      "sha": "13653998a640338b8834275203894ea0b88c626d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/13653998a640338b8834275203894ea0b88c626d"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/18263be7565782a9c07045a7a72d80c507a5be09",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/18263be7565782a9c07045a7a72d80c507a5be09",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/18263be7565782a9c07045a7a72d80c507a5be09",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/18263be7565782a9c07045a7a72d80c507a5be09/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d30e32637d2993aab95a2a1848b045b7bfd90473",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d30e32637d2993aab95a2a1848b045b7bfd90473",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d30e32637d2993aab95a2a1848b045b7bfd90473"
    }
  ],
  "stats": {
    "total": 28,
    "additions": 23,
    "deletions": 5
  },
  "files": [
    {
      "sha": "16a86b6df9f984e89f42e7633a8b89ed891776d3",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/18263be7565782a9c07045a7a72d80c507a5be09/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/18263be7565782a9c07045a7a72d80c507a5be09/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=18263be7565782a9c07045a7a72d80c507a5be09",
      "patch": "@@ -1,3 +1,8 @@\n+2021-06-17  Simon Marchi  <simon.marchi@efficios.com>\n+\n+\t* gdb.base/args.exp: Check target, KFAIL if remote.\n+\t(args_test): Add parameter and use it.\n+\n 2021-06-17  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* gdb.base/args.exp: Remove trailing parenthesis in test names."
    },
    {
      "sha": "36dd19e64df785c51e340507991153afab5e55e1",
      "filename": "gdb/testsuite/gdb.base/args.exp",
      "status": "modified",
      "additions": 18,
      "deletions": 5,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/18263be7565782a9c07045a7a72d80c507a5be09/gdb/testsuite/gdb.base/args.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/18263be7565782a9c07045a7a72d80c507a5be09/gdb/testsuite/gdb.base/args.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/args.exp?ref=18263be7565782a9c07045a7a72d80c507a5be09",
      "patch": "@@ -34,7 +34,10 @@ if {[build_executable $testfile.exp $testfile \\\n     return -1\n }\n \n-proc args_test { name arglist } {\n+# If SINGLE_QUOTES_NEWLINE_KFAIL true, arguments made of exactly '' or a\n+# newline character will fail, so kfail those tests.\n+\n+proc args_test { name arglist {single_quotes_newline_kfail false}} {\n     global srcdir\n     global subdir\n     global testfile\n@@ -52,6 +55,10 @@ proc args_test { name arglist } {\n \n     set i 1\n     foreach arg $arglist {\n+\tif { $single_quotes_newline_kfail\n+\t     && ($arg == {''} || $arg == {\\\\n}) } {\n+\t    setup_kfail \"gdb/27989\" \"*-*-*\"\n+\t}\n \tgdb_test \"print argv\\[$i\\]\" \"\\\\\\$$decimal = $hex \\\"$arg\\\"\" \\\n \t    \"argv\\[$i\\] for $name\"\n \tset i [expr $i + 1]\n@@ -65,6 +72,12 @@ proc args_test { name arglist } {\n save_vars { GDBFLAGS } {\n     set old_gdbflags $GDBFLAGS\n \n+    # Single quotes and newlines are not well handled by the extended-remote\n+    # target:  https://sourceware.org/bugzilla/show_bug.cgi?id=27989\n+    set single_quotes_newline_kfail \\\n+\t[expr { [target_info exists gdb_protocol] \\\n+\t        && [target_info gdb_protocol] == \"extended-remote\" }]\n+\n     set GDBFLAGS \"$old_gdbflags --args $binfile 1 3\"\n     args_test basic {{1} {3}}\n \n@@ -85,16 +98,16 @@ save_vars { GDBFLAGS } {\n     # Try with arguments containing literal single quotes.\n \n     set GDBFLAGS \"$old_gdbflags --args $binfile 1 '' 3\"\n-    args_test \"one empty with single quotes\" {{1} {''} {3}}\n+    args_test \"one empty with single quotes\" {{1} {''} {3}} $single_quotes_newline_kfail\n \n     set GDBFLAGS \"$old_gdbflags --args $binfile 1 '' '' 3\"\n-    args_test \"two empty with single quotes\" {{1} {''} {''} {3}}\n+    args_test \"two empty with single quotes\" {{1} {''} {''} {3}} $single_quotes_newline_kfail\n \n     # try with arguments containing literal newlines.\n \n     set GDBFLAGS \"$old_gdbflags --args $binfile 1 {\\n} 3\"\n-    args_test \"one newline\" {{1} {\\\\n} {3}}\n+    args_test \"one newline\" {{1} {\\\\n} {3}} $single_quotes_newline_kfail\n \n     set GDBFLAGS \"$old_gdbflags --args $binfile 1 {\\n} {\\n} 3\"\n-    args_test \"two newlines\" {{1} {\\\\n} {\\\\n} {3}}\n+    args_test \"two newlines\" {{1} {\\\\n} {\\\\n} {3}} $single_quotes_newline_kfail\n }"
    }
  ]
}