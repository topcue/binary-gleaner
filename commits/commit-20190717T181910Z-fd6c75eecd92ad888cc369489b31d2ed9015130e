{
  "sha": "fd6c75eecd92ad888cc369489b31d2ed9015130e",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZmQ2Yzc1ZWVjZDkyYWQ4ODhjYzM2OTQ4OWIzMWQyZWQ5MDE1MTMwZQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-06-29T05:17:24Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-07-17T18:19:10Z"
    },
    "message": "Merge refresh and refresh_window methods\n\nEarlier refactorings introduced the refresh and refresh_window\nmethods, following the previous TUI code.  However, these methods are\nessentially the same, so this patch merges them.  It also removes some\nredundant refresh_window calls, because the execution window is\nupdated automatically by the corresponding source (or disassembly)\nwindow.\n\ngdb/ChangeLog\n2019-07-17  Tom Tromey  <tom@tromey.com>\n\n\t* tui/tui-winsource.c (tui_show_exec_info_content): Don't call\n\trefresh_window.\n\t* tui/tui-wingeneral.c (tui_gen_win_info::refresh_window): Call\n\ttouchwin.\n\t(tui_data_window::refresh_window): Call refresh_window on data\n\titems.  Always call superclass refresh_window.\n\t(tui_win_info::refresh): Remove.\n\t(tui_source_window_base::refresh_window): Update.\n\t(tui_refresh_all): Update.\n\t* tui/tui-layout.c (show_source_disasm_command): Remove call to\n\trefresh_window.\n\t(show_source_or_disasm_and_command): Likewise.\n\t* tui/tui-data.h (struct tui_win_info) <refresh>: Remove.\n\t(struct tui_source_window_base) <refresh>: Likewise.",
    "tree": {
      "sha": "a24918acae65b8422a94842553e954cb1c5ff9eb",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/a24918acae65b8422a94842553e954cb1c5ff9eb"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/fd6c75eecd92ad888cc369489b31d2ed9015130e",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fd6c75eecd92ad888cc369489b31d2ed9015130e",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/fd6c75eecd92ad888cc369489b31d2ed9015130e",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fd6c75eecd92ad888cc369489b31d2ed9015130e/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "f6cc34a91c173634b6afcc1a48601a601fbace37",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f6cc34a91c173634b6afcc1a48601a601fbace37",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/f6cc34a91c173634b6afcc1a48601a601fbace37"
    }
  ],
  "stats": {
    "total": 58,
    "additions": 29,
    "deletions": 29
  },
  "files": [
    {
      "sha": "3e7bd9ec1297076a38acf5e4979a5d1453560573",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 17,
      "deletions": 0,
      "changes": 17,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=fd6c75eecd92ad888cc369489b31d2ed9015130e",
      "patch": "@@ -1,3 +1,20 @@\n+2019-07-17  Tom Tromey  <tom@tromey.com>\n+\n+\t* tui/tui-winsource.c (tui_show_exec_info_content): Don't call\n+\trefresh_window.\n+\t* tui/tui-wingeneral.c (tui_gen_win_info::refresh_window): Call\n+\ttouchwin.\n+\t(tui_data_window::refresh_window): Call refresh_window on data\n+\titems.  Always call superclass refresh_window.\n+\t(tui_win_info::refresh): Remove.\n+\t(tui_source_window_base::refresh_window): Update.\n+\t(tui_refresh_all): Update.\n+\t* tui/tui-layout.c (show_source_disasm_command): Remove call to\n+\trefresh_window.\n+\t(show_source_or_disasm_and_command): Likewise.\n+\t* tui/tui-data.h (struct tui_win_info) <refresh>: Remove.\n+\t(struct tui_source_window_base) <refresh>: Likewise.\n+\n 2019-07-17  Tom Tromey  <tom@tromey.com>\n \n \t* tui/tui-winsource.c (tui_clear_source_content)"
    },
    {
      "sha": "fcbb94072815414f2208e75236ad0c21fe70d9a7",
      "filename": "gdb/tui/tui-data.h",
      "status": "modified",
      "additions": 1,
      "deletions": 4,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/tui/tui-data.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/tui/tui-data.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-data.h?ref=fd6c75eecd92ad888cc369489b31d2ed9015130e",
      "patch": "@@ -303,9 +303,6 @@ struct tui_win_info : public tui_gen_win_info\n     return false;\n   }\n \n-  /* Refresh this window and any associated windows.  */\n-  virtual void refresh ();\n-\n   /* Called after all the TUI windows are refreshed, to let this\n      window have a chance to update itself further.  */\n   virtual void refresh_all ()\n@@ -380,7 +377,7 @@ struct tui_source_window_base : public tui_win_info\n   }\n \n   void make_visible (bool visible) override;\n-  void refresh () override;\n+  void refresh_window () override;\n   void refresh_all () override;\n \n   /* Refill the source window's source cache and update it.  If this"
    },
    {
      "sha": "a02c157b87e89d33aa18c657ff15531a0f6a8a9c",
      "filename": "gdb/tui/tui-layout.c",
      "status": "modified",
      "additions": 0,
      "deletions": 2,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/tui/tui-layout.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/tui/tui-layout.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-layout.c?ref=fd6c75eecd92ad888cc369489b31d2ed9015130e",
      "patch": "@@ -683,7 +683,6 @@ show_source_disasm_command (void)\n \t\t\t      TUI_CMD_WIN->origin.y);\n \t  tui_make_visible (TUI_CMD_WIN);\n \t}\n-      TUI_CMD_WIN->refresh_window ();\n       tui_set_current_layout_to (SRC_DISASSEM_COMMAND);\n     }\n }\n@@ -924,7 +923,6 @@ show_source_or_disasm_and_command (enum tui_layout_type layout_type)\n \t{\n \t  tui_win_list[CMD_WIN] = make_command_window (cmd_height,\n \t\t\t\t\t\t       src_height);\n-\t  TUI_CMD_WIN->refresh_window ();\n \t}\n       else\n \t{"
    },
    {
      "sha": "2902b8006b75621c371ec3a1fc1072aa1c1d5a48",
      "filename": "gdb/tui/tui-wingeneral.c",
      "status": "modified",
      "additions": 11,
      "deletions": 22,
      "changes": 33,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/tui/tui-wingeneral.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/tui/tui-wingeneral.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-wingeneral.c?ref=fd6c75eecd92ad888cc369489b31d2ed9015130e",
      "patch": "@@ -37,7 +37,10 @@ void\n tui_gen_win_info::refresh_window ()\n {\n   if (handle != NULL)\n-    wrefresh (handle);\n+    {\n+      touchwin (handle);\n+      wrefresh (handle);\n+    }\n }\n \n /* See tui-data.h.  */\n@@ -49,12 +52,11 @@ tui_data_window::refresh_window ()\n     {\n       for (auto &&win : regs_content)\n \t{\n-\t  if (win != NULL && win->handle != NULL)\n-\t    wrefresh (win->handle);\n+\t  if (win != NULL)\n+\t    win->refresh_window ();\n \t}\n     }\n-  else\n-    tui_gen_win_info::refresh_window ();\n+  tui_gen_win_info::refresh_window ();\n }\n \n /* Function to delete the curses window, checking for NULL.  */\n@@ -231,20 +233,10 @@ tui_make_all_invisible (void)\n /* See tui-data.h.  */\n \n void\n-tui_win_info::refresh ()\n-{\n-  touchwin (handle);\n-  refresh_window ();\n-}\n-\n-/* See tui-data.h.  */\n-\n-void\n-tui_source_window_base::refresh ()\n+tui_source_window_base::refresh_window ()\n {\n-  touchwin (execution_info->handle);\n   execution_info->refresh_window ();\n-  tui_win_info::refresh ();\n+  tui_win_info::refresh_window ();\n }\n \n /* Function to refresh all the windows currently displayed.  */\n@@ -257,13 +249,10 @@ tui_refresh_all ()\n   for (tui_win_info *win_info : all_tui_windows ())\n     {\n       if (win_info->is_visible)\n-\twin_info->refresh ();\n+\twin_info->refresh_window ();\n     }\n   if (locator->is_visible)\n-    {\n-      touchwin (locator->handle);\n-      locator->refresh_window ();\n-    }\n+    locator->refresh_window ();\n }\n \n "
    },
    {
      "sha": "38d5532912d76bdd5917d1a2ef0236d8eeff83df",
      "filename": "gdb/tui/tui-winsource.c",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/tui/tui-winsource.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fd6c75eecd92ad888cc369489b31d2ed9015130e/gdb/tui/tui-winsource.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-winsource.c?ref=fd6c75eecd92ad888cc369489b31d2ed9015130e",
      "patch": "@@ -513,7 +513,6 @@ tui_show_exec_info_content (struct tui_source_window_base *win_info)\n   const tui_exec_info_content *content = exec_info->get_content ();\n \n   werase (exec_info->handle);\n-  exec_info->refresh_window ();\n   for (int cur_line = 1; cur_line <= win_info->content.size (); cur_line++)\n     mvwaddstr (exec_info->handle,\n \t       cur_line,"
    }
  ]
}