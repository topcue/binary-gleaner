{
  "sha": "163b2c58bdbf0cba9a085574ae88d4c757c6567d",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTYzYjJjNThiZGJmMGNiYTlhMDg1NTc0YWU4OGQ0Yzc1N2M2NTY3ZA==",
  "commit": {
    "author": {
      "name": "Barnaby Wilks",
      "email": "barnaby.wilks@arm.com",
      "date": "2019-07-02T13:09:52Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-07-02T13:11:14Z"
    },
    "message": "This patch fixes a bug in the AArch64 assembler where an incorrect structural load/store by element instruction would generate the wrong error message.\n\nFor example, when provided with the (incorrect) instruction\n\nst4 {v0.16b-v3.16b}[4],[x0]\n\ncurrently assembler provides the following error message\n\"Error: comma expected between operands at operand 2 -- `st4 {v0.16b-v3.16b}[4],[x0]'\".\n\nThis was due to the assembler consuming the {v0.16b-v3.16b} as the first operand leaving\n[4],[x0] as what it believed to be the second operand.\n\nThe actual error is that the first operand should be of element type and not\nvector type (as provided). The new diagnostic for this error is\n\"Error: expected element type rather than vector type at operand 1 -- `st4 {v0.16b-v3.16b}[4],[x0]'.\n\nAdded testcases to check for the correct diagnostic message as well as checking that\nvariations of the structural load/store by element instruction also generate the error\nwhen they have the same problem.\n\n\t* config/tc-aarch64.c (parse_operands): Add error check.\n\t* testsuite/gas/aarch64/diagnostic.l: New test.\n\t* testsuite/gas/aarch64/diagnostic.s: New test.\n\t* testsuite/gas/aarch64/illegal.l: New tests.\n\t* testsuite/gas/aarch64/illegal.s: New tests.",
    "tree": {
      "sha": "45a745b466ef6e57cb5a5248894702324852fe58",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/45a745b466ef6e57cb5a5248894702324852fe58"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/163b2c58bdbf0cba9a085574ae88d4c757c6567d",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/163b2c58bdbf0cba9a085574ae88d4c757c6567d",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/163b2c58bdbf0cba9a085574ae88d4c757c6567d",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/163b2c58bdbf0cba9a085574ae88d4c757c6567d/comments",
  "author": null,
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "4d83e8d97e3b15dcd7b5c58f4199e9f5bd6fca3d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4d83e8d97e3b15dcd7b5c58f4199e9f5bd6fca3d",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/4d83e8d97e3b15dcd7b5c58f4199e9f5bd6fca3d"
    }
  ],
  "stats": {
    "total": 30,
    "additions": 29,
    "deletions": 1
  },
  "files": [
    {
      "sha": "21346074af6967da149f038ac39a162fb4b8e207",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=163b2c58bdbf0cba9a085574ae88d4c757c6567d",
      "patch": "@@ -1,3 +1,11 @@\n+2019-07-02  Barnaby Wilks  <barnaby.wilks@arm.com>\n+\n+\t* config/tc-aarch64.c (parse_operands): Add error check.\n+\t* testsuite/gas/aarch64/diagnostic.l: New test.\n+\t* testsuite/gas/aarch64/diagnostic.s: New test.\n+\t* testsuite/gas/aarch64/illegal.l: New tests.\n+\t* testsuite/gas/aarch64/illegal.s: New tests.\n+\n 2019-07-02  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* testsuite/gas/aarch64/sve-movprfx_27.s,"
    },
    {
      "sha": "47af14389ee54129bd05212c9119184b93fac1d4",
      "filename": "gas/config/tc-aarch64.c",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/config/tc-aarch64.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/config/tc-aarch64.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-aarch64.c?ref=163b2c58bdbf0cba9a085574ae88d4c757c6567d",
      "patch": "@@ -5733,11 +5733,20 @@ parse_operands (char *str, const aarch64_opcode *opcode)\n \t      val = parse_vector_reg_list (&str, reg_type, &vectype);\n \t      if (val == PARSE_FAIL)\n \t\tgoto failure;\n+\n \t      if (! reg_list_valid_p (val, /* accept_alternate */ 0))\n \t\t{\n \t\t  set_fatal_syntax_error (_(\"invalid register list\"));\n \t\t  goto failure;\n \t\t}\n+\n+\t      if (vectype.width != 0 && *str != ',')\n+\t\t{\n+\t\t  set_fatal_syntax_error\n+\t\t    (_(\"expected element type rather than vector type\"));\n+\t\t  goto failure;\n+\t\t}\n+\n \t      info->reglist.first_regno = (val >> 2) & 0x1f;\n \t      info->reglist.num_regs = (val & 0x3) + 1;\n \t    }"
    },
    {
      "sha": "b5f304af70b35da0e488fe363eab9d040d5b95d5",
      "filename": "gas/testsuite/gas/aarch64/diagnostic.l",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/testsuite/gas/aarch64/diagnostic.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/testsuite/gas/aarch64/diagnostic.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/diagnostic.l?ref=163b2c58bdbf0cba9a085574ae88d4c757c6567d",
      "patch": "@@ -182,3 +182,4 @@\n [^:]*:311: Warning: unpredictable: identical transfer and status registers --`stlxr w26,x26,\\[x3\\]'\n [^:]*:312: Warning: unpredictable: identical transfer and status registers --`ldxp x26,x26,\\[x5\\]'\n [^:]*:313: Warning: unpredictable: identical transfer and status registers --`ldxp x26,x1,\\[x26\\]'\n+[^:]*:314: Error: expected element type rather than vector type at operand 1 -- `st4 {v0\\.16b-v3\\.16b}\\[4\\],\\[x0\\]'"
    },
    {
      "sha": "21cbc53d8972bdf542a8c2088729af1591973cf1",
      "filename": "gas/testsuite/gas/aarch64/diagnostic.s",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/testsuite/gas/aarch64/diagnostic.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/testsuite/gas/aarch64/diagnostic.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/diagnostic.s?ref=163b2c58bdbf0cba9a085574ae88d4c757c6567d",
      "patch": "@@ -311,3 +311,4 @@\n \tstlxr\tw26, x26, [x3]\n \tldxp\tx26, x26, [x5]\n \tldxp\tx26, x1, [x26]\n+\tst4\t{v0.16b-v3.16b}[4], [x0]"
    },
    {
      "sha": "75ef830a8f1e2e35574fb9c96d9c9c3a8683bb17",
      "filename": "gas/testsuite/gas/aarch64/illegal.l",
      "status": "modified",
      "additions": 5,
      "deletions": 1,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/testsuite/gas/aarch64/illegal.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/testsuite/gas/aarch64/illegal.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/illegal.l?ref=163b2c58bdbf0cba9a085574ae88d4c757c6567d",
      "patch": "@@ -575,4 +575,8 @@\n [^:]*:585: Error: .*`fcmgt v0\\.2d,v0\\.2d,#-0\\.0'\n [^:]*:589: Error: .*`fmov s9,x0'\n [^:]*:590: Error: .*`fmov d7,w1'\n-[^:]*:592: Error: .*\n+[^:]*:592: Error: .*`st1 {v0\\.16b}\\[0\\],\\[x0\\]'\n+[^:]*:593: Error: .*`st2 {v0\\.16b-v1\\.16b}\\[1\\],\\[x0\\]'\n+[^:]*:594: Error: .*`st3 {v0\\.16b-v2\\.16b}\\[2\\],\\[x0\\]'\n+[^:]*:595: Error: .*`st4 {v0\\.8b-v3\\.8b}\\[4\\],\\[x0\\]'\n+[^:]*:597: Error: .*"
    },
    {
      "sha": "ef03cc95aae71fb1b5d620ec2f06ba78724d9727",
      "filename": "gas/testsuite/gas/aarch64/illegal.s",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/testsuite/gas/aarch64/illegal.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/163b2c58bdbf0cba9a085574ae88d4c757c6567d/gas/testsuite/gas/aarch64/illegal.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/illegal.s?ref=163b2c58bdbf0cba9a085574ae88d4c757c6567d",
      "patch": "@@ -589,4 +589,9 @@ one_label:\n \tfmov \ts9, x0\n \tfmov\td7, w1\n \n+\tst1 {v0.16b}[0],[x0]\n+\tst2 {v0.16b-v1.16b}[1],[x0]\n+\tst3 {v0.16b-v2.16b}[2],[x0]\n+\tst4 {v0.8b-v3.8b}[4],[x0]\n+\n \t// End (for errors during literal pool generation)"
    }
  ]
}