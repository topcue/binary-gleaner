{
  "sha": "a50bdb99afe3ce2374407cbe7ddc625c1a0b74f7",
  "node_id": "C_kwDOANOeidoAKGE1MGJkYjk5YWZlM2NlMjM3NDQwN2NiZTdkZGM2MjVjMWEwYjc0Zjc",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-11-02T18:08:49Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-11-02T18:08:49Z"
    },
    "message": "[gdb/tdep, rs6000] Don't skip system call in skip_prologue\n\nI ran into a case where a breakpoint on _exit never triggered, because it was\nset past the end of the _exit prologue, past the end of the exit_group system\ncall (which does not return).\n\nMore concretely, the breakpoint was set at the last insn show here:\n...\nDump of assembler code for function _exit:\n   0x00007ffff7e42ea0 <+0>:     12 00 4c 3c     addis   r2,r12,18\n   0x00007ffff7e42ea4 <+4>:     60 43 42 38     addi    r2,r2,17248\n   0x00007ffff7e42ea8 <+8>:     00 00 00 60     nop\n   0x00007ffff7e42eac <+12>:    f8 ff e1 fb     std     r31,-8(r1)\n   0x00007ffff7e42eb0 <+16>:    78 1b 7f 7c     mr      r31,r3\n   0x00007ffff7e42eb4 <+20>:    f0 ff c1 fb     std     r30,-16(r1)\n   0x00007ffff7e42eb8 <+24>:    ea 00 00 38     li      r0,234\n   0x00007ffff7e42ebc <+28>:    a0 8b 22 e9     ld      r9,-29792(r2)\n   0x00007ffff7e42ec0 <+32>:    78 fb e3 7f     mr      r3,r31\n   0x00007ffff7e42ec4 <+36>:    14 6a c9 7f     add     r30,r9,r13\n   0x00007ffff7e42ec8 <+40>:    02 00 00 44     sc\n   0x00007ffff7e42ecc <+44>:    26 00 00 7c     mfcr    r0\n   0x00007ffff7e42ed0 <+48>:    00 10 09 74     andis.  r9,r0,4096\n...\n\nFix this by treating system calls the same as branches in skip_prologue:\nby default, don't skip, such that the breakpoint is set at 0x00007ffff7e42eb8\ninstead.\n\nTested on ppc64le-linux, on a power 8 machine.\n\nBug: https://sourceware.org/bugzilla/show_bug.cgi?id=28527",
    "tree": {
      "sha": "eaa237363bf33d5bcc90fab03cb1037da8c72893",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/eaa237363bf33d5bcc90fab03cb1037da8c72893"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/a50bdb99afe3ce2374407cbe7ddc625c1a0b74f7",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a50bdb99afe3ce2374407cbe7ddc625c1a0b74f7",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/a50bdb99afe3ce2374407cbe7ddc625c1a0b74f7",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a50bdb99afe3ce2374407cbe7ddc625c1a0b74f7/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d74dfa8f63c2bb951609ab671773354536543ac2",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d74dfa8f63c2bb951609ab671773354536543ac2",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d74dfa8f63c2bb951609ab671773354536543ac2"
    }
  ],
  "stats": {
    "total": 6,
    "additions": 6,
    "deletions": 0
  },
  "files": [
    {
      "sha": "4830ed225935d4e8f581c92eb0e941ebbe1dd6be",
      "filename": "gdb/rs6000-tdep.c",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a50bdb99afe3ce2374407cbe7ddc625c1a0b74f7/gdb/rs6000-tdep.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a50bdb99afe3ce2374407cbe7ddc625c1a0b74f7/gdb/rs6000-tdep.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/rs6000-tdep.c?ref=a50bdb99afe3ce2374407cbe7ddc625c1a0b74f7",
      "patch": "@@ -2137,6 +2137,12 @@ skip_prologue (struct gdbarch *gdbarch, CORE_ADDR pc, CORE_ADDR lim_pc,\n \t    /* Never skip branches.  */\n \t    break;\n \n+\t  /* Test based on opcode and mask values of\n+\t     powerpc_opcodes[svc..svcla] in opcodes/ppc-opc.c.  */\n+\t  if ((op & 0xffff0000) == 0x44000000)\n+\t    /* Never skip system calls.  */\n+\t    break;\n+\n \t  if (num_skip_non_prologue_insns++ > max_skip_non_prologue_insns)\n \t    /* Do not scan too many insns, scanning insns is expensive with\n \t       remote targets.  */"
    }
  ]
}