{
  "sha": "ddbe6976d51240c806488beb53b708858d8a3a67",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZGRiZTY5NzZkNTEyNDBjODA2NDg4YmViNTNiNzA4ODU4ZDhhM2E2Nw==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-08-05T09:52:08Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-08-05T11:17:09Z"
    },
    "message": "PR28167, vms-alpha build_module_list\n\n\tPR 28167\n\t* vms-alpha.c (build_module_list): Malloc and free section contents.\n\tDon't read past end of section.",
    "tree": {
      "sha": "f3b38d242b52a01e7283d37da11ab7f1c3adae6a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/f3b38d242b52a01e7283d37da11ab7f1c3adae6a"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ddbe6976d51240c806488beb53b708858d8a3a67",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ddbe6976d51240c806488beb53b708858d8a3a67",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ddbe6976d51240c806488beb53b708858d8a3a67",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ddbe6976d51240c806488beb53b708858d8a3a67/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "6ecfe4abfd14e9c04075435210ca383a1a0191ac",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6ecfe4abfd14e9c04075435210ca383a1a0191ac",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/6ecfe4abfd14e9c04075435210ca383a1a0191ac"
    }
  ],
  "stats": {
    "total": 11,
    "additions": 4,
    "deletions": 7
  },
  "files": [
    {
      "sha": "83a103ae63b2216421b37ece27c5f7ced098a338",
      "filename": "bfd/vms-alpha.c",
      "status": "modified",
      "additions": 4,
      "deletions": 7,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ddbe6976d51240c806488beb53b708858d8a3a67/bfd/vms-alpha.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ddbe6976d51240c806488beb53b708858d8a3a67/bfd/vms-alpha.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/vms-alpha.c?ref=ddbe6976d51240c806488beb53b708858d8a3a67",
      "patch": "@@ -4796,18 +4796,14 @@ build_module_list (bfd *abfd)\n       bfd_size_type size = bfd_section_size (dmt);\n       unsigned char *ptr, *end;\n \n-      ptr = (unsigned char *) bfd_alloc (abfd, size);\n-      if (! ptr)\n-\treturn NULL;\n-\n-      if (! bfd_get_section_contents (abfd, dmt, ptr, 0, size))\n+      if (! bfd_malloc_and_get_section (abfd, dmt, &ptr))\n \treturn NULL;\n \n       vms_debug2 ((2, \"DMT\\n\"));\n \n       end = ptr + size;\n \n-      while (ptr < end)\n+      while (end - ptr >= DBG_S_C_DMT_HEADER_SIZE)\n \t{\n \t  /* Each header declares a module with its start offset and size\n \t     of debug info in the DST section, as well as the count of\n@@ -4825,7 +4821,7 @@ build_module_list (bfd *abfd)\n \t     As a consequence, the actual debug info in the DST section is\n \t     shared and can be parsed multiple times; that doesn't seem to\n \t     cause problems in practice.  */\n-\t  while (count-- > 0)\n+\t  while (count-- > 0 && end - ptr >= DBG_S_C_DMT_PSECT_SIZE)\n \t    {\n \t      int start = bfd_getl32 (ptr + DBG_S_L_DMT_PSECT_START);\n \t      int length = bfd_getl32 (ptr + DBG_S_L_DMT_PSECT_LENGTH);\n@@ -4842,6 +4838,7 @@ build_module_list (bfd *abfd)\n \t\t\t   start, length));\n \t    }\n \t}\n+      free (ptr);\n     }\n   else\n     {"
    }
  ]
}