{
  "sha": "9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OWIwYWM1MWIyMmQwY2Y5MDBmMzllMTdlNjE1YmIyMmUzMjcyMGY2ZQ==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-08-10T12:17:28Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-08-10T12:17:41Z"
    },
    "message": "nm: Remove --with-symbol-versions\n\nSince\n\ncommit 7e6e972f74aeac0ebdbd95a7f905d871cd2581de\nAuthor: H.J. Lu <hjl.tools@gmail.com>\nDate:   Tue Mar 24 04:23:11 2020 -0700\n\n    bfd: Display symbol version for nm -D\n\nalways displays symbol version for nm, remove --with-symbol-versions and\nsilently accept it for backward compatibility.\n\nbinutils/\n\n\tPR binutils/26302\n\t* nm.c (with_symbol_versions): Removed.\n\t(long_option_values): Add OPTION_WITH_SYMBOL_VERSIONS.\n\t(long_options): Update --with-symbol-versions entry.\n\t(print_symbol): Remove the with_symbol_versions check.\n\t(main): Add OPTION_WITH_SYMBOL_VERSIONS for backward\n\tcompatibility.\n\t* doc/binutils.texi: Remove --with-symbol-versions.\n\nld/\n\n\tPR binutils/26302\n\t* testsuite/ld-elf/pr26302.nd: New file.\n\t* testsuite/ld-elf/pr26302.ver: Likewise.\n\t* testsuite/ld-elf/pr26302a.c: Likewise.\n\t* testsuite/ld-elf/pr26302b.c: Likewise.\n\t* testsuite/ld-elf/shared.exp: Run binutils/26302 tests.",
    "tree": {
      "sha": "39644cd7c9bdaf1c6d530f22c56d9c21c422d8d1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/39644cd7c9bdaf1c6d530f22c56d9c21c422d8d1"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "40f3419a8150eac5855ef89bc2ce3532b0372e57",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/40f3419a8150eac5855ef89bc2ce3532b0372e57",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/40f3419a8150eac5855ef89bc2ce3532b0372e57"
    }
  ],
  "stats": {
    "total": 93,
    "additions": 65,
    "deletions": 28
  },
  "files": [
    {
      "sha": "a536d325e5db97423ad966ccf32ef0e0ecaa5169",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -1,3 +1,14 @@\n+2020-08-10  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR binutils/26302\n+\t* nm.c (with_symbol_versions): Removed.\n+\t(long_option_values): Add OPTION_WITH_SYMBOL_VERSIONS.\n+\t(long_options): Update --with-symbol-versions entry.\n+\t(print_symbol): Remove the with_symbol_versions check.\n+\t(main): Add OPTION_WITH_SYMBOL_VERSIONS for backward\n+\tcompatibility.\n+\t* doc/binutils.texi: Remove --with-symbol-versions.\n+\n 2020-08-05  Alan Modra  <amodra@gmail.com>\n \n \tPR 26337"
    },
    {
      "sha": "0822b5c8b39966b9fdb68ad50f2ee4b9eaef27d0",
      "filename": "binutils/doc/binutils.texi",
      "status": "modified",
      "additions": 1,
      "deletions": 9,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/binutils/doc/binutils.texi",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/binutils/doc/binutils.texi",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/doc/binutils.texi?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -796,7 +796,7 @@ nm [@option{-A}|@option{-o}|@option{--print-file-name}] [@option{-a}|@option{--d\n    [@option{--plugin} @var{name}]\n    [@option{--no-recurse-limit}|@option{--recurse-limit}]]\n    [@option{--size-sort}] [@option{--special-syms}]\n-   [@option{--synthetic}] [@option{--with-symbol-versions}] [@option{--target=}@var{bfdname}]\n+   [@option{--synthetic}] [@option{--target=}@var{bfdname}]\n    [@var{objfile}@dots{}]\n @c man end\n @end smallexample\n@@ -1130,14 +1130,6 @@ Include synthetic symbols in the output.  These are special symbols\n created by the linker for various purposes.  They are not shown by\n default since they are not part of the binary's original source code.\n \n-@item --with-symbol-versions\n-Enables the display of symbol version information if any exists.  The\n-version string is displayed as a suffix to the symbol name, preceded by\n-an @@ character.  For example @samp{foo@@VER_1}.  If the version is\n-the default version to be used when resolving unversioned references\n-to the symbol then it is displayed as a suffix preceded by two @@\n-characters.  For example @samp{foo@@@@VER_2}.\n-\n @item --target=@var{bfdname}\n @cindex object code format\n Specify an object code format other than your system's default format."
    },
    {
      "sha": "69e697ae9252816fb1958eaebe3ccb8cc3a76cad",
      "filename": "binutils/nm.c",
      "status": "modified",
      "additions": 7,
      "deletions": 19,
      "changes": 26,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/binutils/nm.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/binutils/nm.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/nm.c?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -161,7 +161,6 @@ static int show_version = 0;\t/* Show the version number.  */\n static int show_synthetic = 0;\t/* Display synthesized symbols too.  */\n static int line_numbers = 0;\t/* Print line numbers for symbols.  */\n static int allow_special_symbols = 0;  /* Allow special symbols.  */\n-static int with_symbol_versions = 0; /* Include symbol version information in the output.  */\n \n static int demangle_flags = DMGL_ANSI | DMGL_PARAMS;\n \n@@ -192,7 +191,8 @@ enum long_option_values\n   OPTION_PLUGIN,\n   OPTION_SIZE_SORT,\n   OPTION_RECURSE_LIMIT,\n-  OPTION_NO_RECURSE_LIMIT\n+  OPTION_NO_RECURSE_LIMIT,\n+  OPTION_WITH_SYMBOL_VERSIONS\n };\n \n static struct option long_options[] =\n@@ -226,7 +226,8 @@ static struct option long_options[] =\n   {\"defined-only\", no_argument, &defined_only, 1},\n   {\"undefined-only\", no_argument, &undefined_only, 1},\n   {\"version\", no_argument, &show_version, 1},\n-  {\"with-symbol-versions\", no_argument, &with_symbol_versions, 1},\n+  {\"with-symbol-versions\", no_argument, NULL,\n+   OPTION_WITH_SYMBOL_VERSIONS},\n   {0, no_argument, 0, 0}\n };\n \f\n@@ -901,22 +902,6 @@ print_symbol (bfd *        abfd,\n \n   format->print_symbol_info (&info, abfd);\n \n-  if (with_symbol_versions)\n-    {\n-      const char *  version_string = NULL;\n-      bfd_boolean   hidden = FALSE;\n-\n-      if ((sym->flags & (BSF_SECTION_SYM | BSF_SYNTHETIC)) == 0)\n-\tversion_string = bfd_get_symbol_version_string (abfd, sym,\n-\t\t\t\t\t\t\tTRUE, &hidden);\n-\n-      if (bfd_is_und_section (bfd_asymbol_section (sym)))\n-\thidden = TRUE;\n-\n-      if (version_string && *version_string != '\\0')\n-\tprintf (hidden ? \"@%s\" : \"@@%s\", version_string);\n-    }\n-\n   if (line_numbers)\n     {\n       static asymbol **syms;\n@@ -1761,6 +1746,9 @@ main (int argc, char **argv)\n \tcase OPTION_NO_RECURSE_LIMIT:\n \t  demangle_flags |= DMGL_NO_RECURSE_LIMIT;\n \t  break;\n+\tcase OPTION_WITH_SYMBOL_VERSIONS:\n+\t  /* Ignored for backward compatibility.  */\n+\t  break;\n \tcase 'D':\n \t  dynamic = 1;\n \t  break;"
    },
    {
      "sha": "2539fad36b41a2ca9129bf9d4045fc55d0a467f2",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -1,3 +1,12 @@\n+2020-08-10  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR binutils/26302\n+\t* testsuite/ld-elf/pr26302.nd: New file.\n+\t* testsuite/ld-elf/pr26302.ver: Likewise.\n+\t* testsuite/ld-elf/pr26302a.c: Likewise.\n+\t* testsuite/ld-elf/pr26302b.c: Likewise.\n+\t* testsuite/ld-elf/shared.exp: Run binutils/26302 tests.\n+\n 2020-08-07  David Faust  <david.faust@oracle.com>\n \n \t* testsuite/ld-bpf/call-3.s: New file."
    },
    {
      "sha": "1f2fbdf9a3f70ec0446afc5022953989d5ab7f16",
      "filename": "ld/testsuite/ld-elf/pr26302.nd",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/pr26302.nd",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/pr26302.nd",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/pr26302.nd?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -0,0 +1,3 @@\n+#...\n+ +U foo@@FOO\n+#pass"
    },
    {
      "sha": "f2c03ac7a1324c9c872fe048df648bc0f50d9cf6",
      "filename": "ld/testsuite/ld-elf/pr26302.ver",
      "status": "added",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/pr26302.ver",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/pr26302.ver",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/pr26302.ver?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -0,0 +1,5 @@\n+FOO\n+{\n+global:\n+  foo;\n+};"
    },
    {
      "sha": "cd0130cacdfe9c2873c7bdf7c123be00dec9dd0d",
      "filename": "ld/testsuite/ld-elf/pr26302a.c",
      "status": "added",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/pr26302a.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/pr26302a.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/pr26302a.c?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -0,0 +1,4 @@\n+void\n+foo (void)\n+{\n+}"
    },
    {
      "sha": "eae278df96dca21b3c2e1e41be519c5ad267245b",
      "filename": "ld/testsuite/ld-elf/pr26302b.c",
      "status": "added",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/pr26302b.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/pr26302b.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/pr26302b.c?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -0,0 +1,7 @@\n+extern void foo (void);\n+\n+void\n+bar (void)\n+{\n+  foo ();\n+}"
    },
    {
      "sha": "014937175fc9985574016ff6cdeec8ce08ed9bb5",
      "filename": "ld/testsuite/ld-elf/shared.exp",
      "status": "modified",
      "additions": 18,
      "deletions": 0,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/shared.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b0ac51b22d0cf900f39e17e615bb22e32720f6e/ld/testsuite/ld-elf/shared.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/shared.exp?ref=9b0ac51b22d0cf900f39e17e615bb22e32720f6e",
      "patch": "@@ -843,6 +843,24 @@ run_cc_link_tests [list \\\n \t{{readelf {--dyn-syms --wide} pr26094-1b.rd}} \\\n \t\"pr26094-1\" \\\n     ] \\\n+    [list \\\n+\t\"Build pr26302a.so\" \\\n+\t\"-shared -Wl,--version-script=pr26302.ver\" \\\n+\t\"-fPIC\" \\\n+\t{pr26302a.c} \\\n+\t{} \\\n+\t\"pr26302a.so\"\n+    ] \\\n+    [list \\\n+\t\"Build pr26302b.so\" \\\n+\t\"-shared -Wl,--no-as-needed tmpdir/pr26302a.so\" \\\n+\t\"-fPIC\" \\\n+\t{pr26302b.c} \\\n+\t{{nm {-u} pr26302.nd} \\\n+\t {nm {-u -D} pr26302.nd} \\\n+\t {nm {-u -D --with-symbol-versions} pr26302.nd}} \\\n+\t\"pr26302b.so\" \\\n+    ] \\\n ]\n \n run_ld_link_tests [list \\"
    }
  ]
}