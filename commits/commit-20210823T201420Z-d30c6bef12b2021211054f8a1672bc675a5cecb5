{
  "sha": "d30c6bef12b2021211054f8a1672bc675a5cecb5",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDMwYzZiZWYxMmIyMDIxMjExMDU0ZjhhMTY3MmJjNjc1YTVjZWNiNQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2021-08-06T22:07:27Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2021-08-23T20:14:20Z"
    },
    "message": "Fix a latent bug in dw2-ranges-overlap.exp\n\ndw2-ranges-overlap.exp creates a program where a psymtab has two\naddress ranges, and a function without debug info whose address is\nbetween these two ranges.  Then it sets a breakpoint on this function\nand runs to it, expecting that the language should remain \"auto; c\"\nwhen stopped.\n\nHowever, this test case also has a \"main\" function described (briefly)\nin the DWARF, and this function is given language C++.  Also, a\nbreakpoint stop sets the current language to the language that was\nused when setting the breakpoint.\n\nMy new DWARF scanner decides that this \"main\" is the main program and\nsets the current language to C++ at startup, causing this test to\nfail.\n\nThis patch fixes the test in a simple way, by introducing a new\nfunction that takes the place of \"main\" in the DWARF.  I think this\nstill exercises the original problem, but also avoids problems with my\nbranch.\n\nIt seemed safe to me to submit this separately.",
    "tree": {
      "sha": "eff39c72319ad8b3314998bc25a42a00d2f77945",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/eff39c72319ad8b3314998bc25a42a00d2f77945"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d30c6bef12b2021211054f8a1672bc675a5cecb5",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d30c6bef12b2021211054f8a1672bc675a5cecb5",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d30c6bef12b2021211054f8a1672bc675a5cecb5",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d30c6bef12b2021211054f8a1672bc675a5cecb5/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a9680e0e54cfd8a12ddb1a583b4acb96dc2bbdbd",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a9680e0e54cfd8a12ddb1a583b4acb96dc2bbdbd",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/a9680e0e54cfd8a12ddb1a583b4acb96dc2bbdbd"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 13,
    "deletions": 6
  },
  "files": [
    {
      "sha": "e3d70f471dce3bced6eb48f3e05466a8265b50fa",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-ranges-overlap.c",
      "status": "modified",
      "additions": 8,
      "deletions": 1,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d30c6bef12b2021211054f8a1672bc675a5cecb5/gdb/testsuite/gdb.dwarf2/dw2-ranges-overlap.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d30c6bef12b2021211054f8a1672bc675a5cecb5/gdb/testsuite/gdb.dwarf2/dw2-ranges-overlap.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-ranges-overlap.c?ref=d30c6bef12b2021211054f8a1672bc675a5cecb5",
      "patch": "@@ -28,9 +28,16 @@ foo (int a)\n   return bar (a * 2) + 3;\n }\n \n+int\n+quux (int a)\n+{\n+  asm (\"quux_label: .globl quux_label\");\n+  return foo (a);\n+}\n+\n int\n main (void)\n {\n   asm (\"main_label: .globl main_label\");\n-  return foo (5) + 1;\n+  return quux (5) + 1;\n }"
    },
    {
      "sha": "5da60bf3a3338702fe3056cc54103e4b2136e85c",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-ranges-overlap.exp",
      "status": "modified",
      "additions": 5,
      "deletions": 5,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d30c6bef12b2021211054f8a1672bc675a5cecb5/gdb/testsuite/gdb.dwarf2/dw2-ranges-overlap.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d30c6bef12b2021211054f8a1672bc675a5cecb5/gdb/testsuite/gdb.dwarf2/dw2-ranges-overlap.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-ranges-overlap.exp?ref=d30c6bef12b2021211054f8a1672bc675a5cecb5",
      "patch": "@@ -44,10 +44,10 @@ Dwarf::assemble $asm_file {\n     declare_labels ranges_label\n \n     # Find start address and length for our functions.\n-    set main_func \\\n-\t[function_range main [list ${srcdir}/${subdir}/$srcfile]]\n     set foo_func \\\n \t[function_range foo [list ${srcdir}/${subdir}/$srcfile]]\n+    set quux_func \\\n+\t[function_range quux [list ${srcdir}/${subdir}/$srcfile]]\n     set bar_func \\\n \t[function_range bar [list ${srcdir}/${subdir}/$srcfile]]\n \n@@ -59,15 +59,15 @@ Dwarf::assemble $asm_file {\n \t} {\n \t    subprogram {\n \t\t{external 1 flag}\n-\t\t{name main}\n+\t\t{name quux}\n \t    }\n \t}\n     }\n \n     ranges {is_64 [is_64_target]} {\n \tranges_label: sequence {\n-\t    base [lindex $main_func 0]\n-\t    range 0 [lindex $main_func 1]\n+\t    base [lindex $quux_func 0]\n+\t    range 0 [lindex $quux_func 1]\n \t    base [lindex $bar_func 0]\n \t    range 0 [lindex $bar_func 1]\n \t}"
    }
  ]
}