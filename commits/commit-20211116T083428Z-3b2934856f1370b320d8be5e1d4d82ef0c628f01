{
  "sha": "3b2934856f1370b320d8be5e1d4d82ef0c628f01",
  "node_id": "C_kwDOANOeidoAKDNiMjkzNDg1NmYxMzcwYjMyMGQ4YmU1ZTFkNGQ4MmVmMGM2MjhmMDE",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-11-16T08:16:09Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-11-16T08:34:28Z"
    },
    "message": "sim: run: support concise env var settings\n\nSupport the same syntax as other common utilities where env vars can\nbe specified before the program to be run without an explicit option.\n\nThis behavior can be suppressed by using the -- marker.",
    "tree": {
      "sha": "79363ce155d2a34339bd3501699e6485e187108e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/79363ce155d2a34339bd3501699e6485e187108e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/3b2934856f1370b320d8be5e1d4d82ef0c628f01",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3b2934856f1370b320d8be5e1d4d82ef0c628f01",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/3b2934856f1370b320d8be5e1d4d82ef0c628f01",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3b2934856f1370b320d8be5e1d4d82ef0c628f01/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "35818ade9668f04ac99a68b10855a3ae45afc4b5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/35818ade9668f04ac99a68b10855a3ae45afc4b5",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/35818ade9668f04ac99a68b10855a3ae45afc4b5"
    }
  ],
  "stats": {
    "total": 25,
    "additions": 23,
    "deletions": 2
  },
  "files": [
    {
      "sha": "557a060e569120cedcd5c31690c24a2e423187be",
      "filename": "sim/common/nrun.c",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3b2934856f1370b320d8be5e1d4d82ef0c628f01/sim/common/nrun.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3b2934856f1370b320d8be5e1d4d82ef0c628f01/sim/common/nrun.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/nrun.c?ref=3b2934856f1370b320d8be5e1d4d82ef0c628f01",
      "patch": "@@ -229,7 +229,8 @@ main (int argc, char **argv)\n static void\n usage (void)\n {\n-  fprintf (stderr, \"Usage: %s [options] [--] program [program args]\\n\", myname);\n+  fprintf (stderr, \"Usage: %s [options] [VAR=VAL|--] program [program args]\\n\",\n+\t   myname);\n   fprintf (stderr, \"Run `%s --help' for full list of options.\\n\", myname);\n   exit (1);\n }"
    },
    {
      "sha": "8c9b7cfec370d43dac5b425bd43beab64150f7b4",
      "filename": "sim/common/sim-options.c",
      "status": "modified",
      "additions": 21,
      "deletions": 1,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3b2934856f1370b320d8be5e1d4d82ef0c628f01/sim/common/sim-options.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3b2934856f1370b320d8be5e1d4d82ef0c628f01/sim/common/sim-options.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/sim-options.c?ref=3b2934856f1370b320d8be5e1d4d82ef0c628f01",
      "patch": "@@ -719,6 +719,22 @@ sim_parse_args (SIM_DESC sd, char * const *argv)\n \t      free (STATE_PROG_FILE (sd));\n \t      STATE_PROG_FILE (sd) = NULL;\n \n+\t      /* Handle any inline variables if -- wasn't used.  */\n+\t      if (argv[optind] != NULL && optind > 0\n+\t\t  && strcmp (argv[optind - 1], \"--\") != 0)\n+\t\t{\n+\t\t  while (1)\n+\t\t    {\n+\t\t      const char *arg = argv[optind];\n+\n+\t\t      if (strchr (arg, '=') == NULL)\n+\t\t\tbreak;\n+\n+\t\t      env_set (sd, arg);\n+\t\t      ++optind;\n+\t\t    }\n+\t\t}\n+\n \t      new_argv = dupargv (argv + optind);\n \t      freeargv (STATE_PROG_ARGV (sd));\n \t      STATE_PROG_ARGV (sd) = new_argv;\n@@ -914,7 +930,8 @@ void\n sim_print_help (SIM_DESC sd, int is_command)\n {\n   if (STATE_OPEN_KIND (sd) == SIM_OPEN_STANDALONE)\n-    sim_io_printf (sd, \"Usage: %s [options] [--] program [program args]\\n\",\n+    sim_io_printf (sd,\n+\t\t   \"Usage: %s [options] [VAR=VAL|--] program [program args]\\n\",\n \t\t   STATE_MY_NAME (sd));\n \n   /* Initialize duplicate argument checker.  */\n@@ -950,6 +967,9 @@ sim_print_help (SIM_DESC sd, int is_command)\n   if (STATE_OPEN_KIND (sd) == SIM_OPEN_STANDALONE)\n     {\n       sim_io_printf (sd, \"\\n\");\n+      sim_io_printf (sd,\n+\t\t     \"VAR=VAL         Environment variables to set.  \"\n+\t\t     \"Ignored if -- is used.\\n\");\n       sim_io_printf (sd, \"program args    Arguments to pass to simulated program.\\n\");\n       sim_io_printf (sd, \"                Note: Very few simulators support this.\\n\");\n     }"
    }
  ]
}