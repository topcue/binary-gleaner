{
  "sha": "0e857c82883cff04ccc8868762c78b0e94ccde91",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MGU4NTdjODI4ODNjZmYwNGNjYzg4Njg3NjJjNzhiMGU5NGNjZGU5MQ==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-02-05T16:47:07Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-02-05T16:47:07Z"
    },
    "message": "[gdb/breakpoints] Fix segfault for catch syscall -1\n\nUsing a hello world a.out, I run into a segfault:\n...\n$ gcc hello.c\n$ gdb -batch a.out -ex \"catch syscall -1\" -ex r\nCatchpoint 1 (syscall -1)\nAborted (core dumped)\n...\n\nFix this by erroring out if a negative syscall number is used in the\ncatch syscall command.\n\nTested on x86_64-linux.\n\ngdb/ChangeLog:\n\n2021-02-05  Tom de Vries  <tdevries@suse.de>\n\n\tPR breakpoints/27313\n\t* break-catch-syscall.c (catch_syscall_split_args): Reject negative\n\tsyscall numbers.\n\ngdb/testsuite/ChangeLog:\n\n2021-02-05  Tom de Vries  <tdevries@suse.de>\n\n\tPR breakpoints/27313\n\t* gdb.base/catch-syscall.exp: Check that \"catch syscall -1\" is\n\trejected.",
    "tree": {
      "sha": "2da77697ed1016db5c8fadd40e36327f88d57085",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/2da77697ed1016db5c8fadd40e36327f88d57085"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0e857c82883cff04ccc8868762c78b0e94ccde91",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0e857c82883cff04ccc8868762c78b0e94ccde91",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0e857c82883cff04ccc8868762c78b0e94ccde91",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0e857c82883cff04ccc8868762c78b0e94ccde91/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "bdfea17ea9bbd9f92ad19a70d770af42473d9c07",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/bdfea17ea9bbd9f92ad19a70d770af42473d9c07",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/bdfea17ea9bbd9f92ad19a70d770af42473d9c07"
    }
  ],
  "stats": {
    "total": 17,
    "additions": 17,
    "deletions": 0
  },
  "files": [
    {
      "sha": "e4a5ed887826acdb4cdedb24f86a554c8cc3b6dc",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e857c82883cff04ccc8868762c78b0e94ccde91/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e857c82883cff04ccc8868762c78b0e94ccde91/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=0e857c82883cff04ccc8868762c78b0e94ccde91",
      "patch": "@@ -1,3 +1,9 @@\n+2021-02-05  Tom de Vries  <tdevries@suse.de>\n+\n+\tPR breakpoints/27313\n+\t* break-catch-syscall.c (catch_syscall_split_args): Reject negative\n+\tsyscall numbers.\n+\n 2021-02-05  Tom Tromey  <tom@tromey.com>\n \n \t* compile/compile-c-support.c (get_compile_context)"
    },
    {
      "sha": "7335377f8992e0f432265b12b8ed0806bd815366",
      "filename": "gdb/break-catch-syscall.c",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e857c82883cff04ccc8868762c78b0e94ccde91/gdb/break-catch-syscall.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e857c82883cff04ccc8868762c78b0e94ccde91/gdb/break-catch-syscall.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/break-catch-syscall.c?ref=0e857c82883cff04ccc8868762c78b0e94ccde91",
      "patch": "@@ -390,6 +390,8 @@ catch_syscall_split_args (const char *arg)\n       syscall_number = (int) strtol (cur_name, &endptr, 0);\n       if (*endptr == '\\0')\n \t{\n+\t  if (syscall_number < 0)\n+\t    error (_(\"Unknown syscall number '%d'.\"), syscall_number);\n \t  get_syscall_by_number (gdbarch, syscall_number, &s);\n \t  result.push_back (s.number);\n \t}"
    },
    {
      "sha": "5875843472c3fc98d2257fc0c767a22e2fa79e58",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e857c82883cff04ccc8868762c78b0e94ccde91/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e857c82883cff04ccc8868762c78b0e94ccde91/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=0e857c82883cff04ccc8868762c78b0e94ccde91",
      "patch": "@@ -1,3 +1,9 @@\n+2021-02-05  Tom de Vries  <tdevries@suse.de>\n+\n+\tPR breakpoints/27313\n+\t* gdb.base/catch-syscall.exp: Check that \"catch syscall -1\" is\n+\trejected.\n+\n 2021-02-05  Tom de Vries  <tdevries@suse.de>\n \n \t* gdb.dwarf2/main-subprogram.exp: Add KFAIL for PR symtab/24549."
    },
    {
      "sha": "a92730c05e6c3dca71a4c082fc3f6fc9db0a47b6",
      "filename": "gdb/testsuite/gdb.base/catch-syscall.exp",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0e857c82883cff04ccc8868762c78b0e94ccde91/gdb/testsuite/gdb.base/catch-syscall.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0e857c82883cff04ccc8868762c78b0e94ccde91/gdb/testsuite/gdb.base/catch-syscall.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/catch-syscall.exp?ref=0e857c82883cff04ccc8868762c78b0e94ccde91",
      "patch": "@@ -54,6 +54,9 @@ gdb_test_multiple \"continue\" $test {\n     }\n }\n \n+# Test-case for PR27313.  Verify that negative syscall numbers are refused.\n+gdb_test \"catch syscall -1\" \"Unknown syscall number '-1'\\\\.\"\n+\n # All (but the last) syscalls from the example code.  It is filled in\n # proc setup_all_syscalls.\n set all_syscalls { }"
    }
  ]
}