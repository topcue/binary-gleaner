{
  "sha": "e3839c100fdb15d05e6a2fd44557ffdd6fb921b8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZTM4MzljMTAwZmRiMTVkMDVlNmEyZmQ0NDU1N2ZmZGQ2ZmI5MjFiOA==",
  "commit": {
    "author": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2021-04-13T04:32:16Z"
    },
    "committer": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2021-04-13T04:49:51Z"
    },
    "message": "RISC-V: Don't report the mismatched version warning for the implicit extensions.\n\nbfd/\n    * elfnn-riscv.c (riscv_version_mismatch): Do not report the warning\n    when the version of input or output is RISCV_UNKNOWN_VERSION, since\n    the extension is added implicitly.\n    * elfxx-riscv.c: Updated the obsolete comments.\n    (RISCV_UNKNOWN_VERSION): Moved to elfxx-riscv.h.\n    * elfxx-riscv.h (RISCV_UNKNOWN_VERSION): Added.",
    "tree": {
      "sha": "12276e778432ad0ca3459ec5bc2fe3a59d385113",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/12276e778432ad0ca3459ec5bc2fe3a59d385113"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "8d85d1f53f28f5ec020add7326055f73dce6ced0",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8d85d1f53f28f5ec020add7326055f73dce6ced0",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/8d85d1f53f28f5ec020add7326055f73dce6ced0"
    }
  ],
  "stats": {
    "total": 50,
    "additions": 33,
    "deletions": 17
  },
  "files": [
    {
      "sha": "28c5791282c5cf5821555bca4f8f5748bef608c6",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=e3839c100fdb15d05e6a2fd44557ffdd6fb921b8",
      "patch": "@@ -1,3 +1,12 @@\n+2021-04-13  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* elfnn-riscv.c (riscv_version_mismatch): Do not report the warning\n+\twhen the version of input or output is RISCV_UNKNOWN_VERSION, since\n+\tthe extension is added implicitly.\n+\t* elfxx-riscv.c: Updated the obsolete comments.\n+\t(RISCV_UNKNOWN_VERSION): Moved to elfxx-riscv.h.\n+\t* elfxx-riscv.h (RISCV_UNKNOWN_VERSION): Added.\n+\n 2021-04-12  Alan Modra  <amodra@gmail.com>\n \n \t* elf-bfd.h (ENABLE_CHECKING): Define."
    },
    {
      "sha": "5e292785e9fc7a6bf11a23f301a79a1c095531b3",
      "filename": "bfd/elfnn-riscv.c",
      "status": "modified",
      "additions": 19,
      "deletions": 9,
      "changes": 28,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/bfd/elfnn-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/bfd/elfnn-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfnn-riscv.c?ref=e3839c100fdb15d05e6a2fd44557ffdd6fb921b8",
      "patch": "@@ -3332,15 +3332,25 @@ riscv_version_mismatch (bfd *ibfd,\n   if (in->major_version != out->major_version\n       || in->minor_version != out->minor_version)\n     {\n-      _bfd_error_handler\n-\t(_(\"warning: %pB: mis-matched ISA version %d.%d for '%s' \"\n-\t   \"extension, the output version is %d.%d\"),\n-\t ibfd,\n-\t in->major_version,\n-\t in->minor_version,\n-\t in->name,\n-\t out->major_version,\n-\t out->minor_version);\n+      if ((in->major_version == RISCV_UNKNOWN_VERSION\n+\t   && in->minor_version == RISCV_UNKNOWN_VERSION)\n+\t  || (out->major_version == RISCV_UNKNOWN_VERSION\n+\t      && out->minor_version == RISCV_UNKNOWN_VERSION))\n+\t{\n+\t  /* Do not report the warning when the version of input\n+\t     or output is RISCV_UNKNOWN_VERSION, since the extension\n+\t     is added implicitly.  */\n+\t}\n+      else\n+\t_bfd_error_handler\n+\t  (_(\"warning: %pB: mis-matched ISA version %d.%d for '%s' \"\n+\t     \"extension, the output version is %d.%d\"),\n+\t   ibfd,\n+\t   in->major_version,\n+\t   in->minor_version,\n+\t   in->name,\n+\t   out->major_version,\n+\t   out->minor_version);\n \n       /* Update the output ISA versions to the newest ones.  */\n       if ((in->major_version > out->major_version)"
    },
    {
      "sha": "3b381925758c1e46b4db7798022a8715a12d05c5",
      "filename": "bfd/elfxx-riscv.c",
      "status": "modified",
      "additions": 3,
      "deletions": 8,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/bfd/elfxx-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/bfd/elfxx-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-riscv.c?ref=e3839c100fdb15d05e6a2fd44557ffdd6fb921b8",
      "patch": "@@ -1026,8 +1026,6 @@ riscv_elf_add_sub_reloc (bfd *abfd,\n   return bfd_reloc_ok;\n }\n \n-#define RISCV_UNKNOWN_VERSION -1\n-\n /* Lists of prefixed class extensions that binutils should know about.\n    Whether or not a particular entry is in these lists will dictate if\n    gas/ld will accept its presence in the architecture string.\n@@ -1588,9 +1586,7 @@ riscv_parse_std_ext (riscv_parse_subset_t *rps,\n    Arguments:\n      `rps`: Hooks and status for parsing extensions.\n      `march`: Full ISA string.\n-     `p`: Curent parsing position.\n-     `config`: What class and predicate function to use for the\n-     extension.  */\n+     `p`: Curent parsing position.  */\n \n static const char *\n riscv_parse_prefixed_ext (riscv_parse_subset_t *rps,\n@@ -1640,9 +1636,8 @@ riscv_parse_prefixed_ext (riscv_parse_subset_t *rps,\n \n       /* Check if the prefix extension is known.\n \t For 'x', anything goes but it cannot simply be 'x'.\n-\t For 's', it must be known from a list and cannot simply be 's'.\n-\t For 'h', it must be known from a list and cannot simply be 'h'.\n-\t For 'z', it must be known from a list and cannot simply be 'z'.  */\n+\t For other prefixed extensions, it must be known from a list\n+\t and cannot simply be the prefixed name.  */\n \n       /* Check that the extension name is well-formed.  */\n       if (!riscv_valid_prefixed_ext (subset))"
    },
    {
      "sha": "ff18ff6f0b86d46fcb2c044c86d7adb0634155f9",
      "filename": "bfd/elfxx-riscv.h",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/bfd/elfxx-riscv.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e3839c100fdb15d05e6a2fd44557ffdd6fb921b8/bfd/elfxx-riscv.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-riscv.h?ref=e3839c100fdb15d05e6a2fd44557ffdd6fb921b8",
      "patch": "@@ -24,6 +24,8 @@\n #include \"elf/internal.h\"\n #include \"opcode/riscv.h\"\n \n+#define RISCV_UNKNOWN_VERSION -1\n+\n extern reloc_howto_type *\n riscv_reloc_name_lookup (bfd *, const char *);\n "
    }
  ]
}