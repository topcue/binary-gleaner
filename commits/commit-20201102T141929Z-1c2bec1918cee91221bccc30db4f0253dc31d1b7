{
  "sha": "1c2bec1918cee91221bccc30db4f0253dc31d1b7",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MWMyYmVjMTkxOGNlZTkxMjIxYmNjYzMwZGI0ZjAyNTNkYzMxZDFiNw==",
  "commit": {
    "author": {
      "name": "Gary Benson",
      "email": "gbenson@redhat.com",
      "date": "2020-11-02T14:19:29Z"
    },
    "committer": {
      "name": "Gary Benson",
      "email": "gbenson@redhat.com",
      "date": "2020-11-02T14:19:29Z"
    },
    "message": "Fix gdb.base/print-file-var.exp with Clang\n\nThe C++ parts of gdb.base/print-file-var.exp failed to build with\nClang because the \"-x c++\" option added by gdb_compile caused the\ncompiler to attempt to parse .so files as C++.  This commit splits\nthe compiler and linker options into separate lists, and switches\nto building via build_executable_from_specs which can accommodate\nthis separation.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.base/print-file-var.exp (test): Separate compiler and\n\tlinker options, and build using build_executable_from_specs\n\tto accommodate this.",
    "tree": {
      "sha": "162fcbf282fcb4d5b6b08cac316b0c32583d8490",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/162fcbf282fcb4d5b6b08cac316b0c32583d8490"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/1c2bec1918cee91221bccc30db4f0253dc31d1b7",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1c2bec1918cee91221bccc30db4f0253dc31d1b7",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/1c2bec1918cee91221bccc30db4f0253dc31d1b7",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1c2bec1918cee91221bccc30db4f0253dc31d1b7/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "6539a36d0e1a949f66ee2d58bb16c8db133c96a5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6539a36d0e1a949f66ee2d58bb16c8db133c96a5",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/6539a36d0e1a949f66ee2d58bb16c8db133c96a5"
    }
  ],
  "stats": {
    "total": 24,
    "additions": 16,
    "deletions": 8
  },
  "files": [
    {
      "sha": "69483785ca2a9b05ff221ab0af9b9465e59a9ba6",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c2bec1918cee91221bccc30db4f0253dc31d1b7/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c2bec1918cee91221bccc30db4f0253dc31d1b7/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=1c2bec1918cee91221bccc30db4f0253dc31d1b7",
      "patch": "@@ -1,3 +1,9 @@\n+2020-11-02  Gary Benson <gbenson@redhat.com>\n+\n+\t* gdb.base/print-file-var.exp (test): Separate compiler and\n+\tlinker options, and build using build_executable_from_specs\n+\tto accommodate this.\n+\n 2020-11-02  Gary Benson <gbenson@redhat.com>\n \n \t* lib/gdb.exp (gdb_compile): Inhibit passing \"-x c++\""
    },
    {
      "sha": "62e5f230ebeafc02e31d4ad4828103f09784849c",
      "filename": "gdb/testsuite/gdb.base/print-file-var.exp",
      "status": "modified",
      "additions": 10,
      "deletions": 8,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c2bec1918cee91221bccc30db4f0253dc31d1b7/gdb/testsuite/gdb.base/print-file-var.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c2bec1918cee91221bccc30db4f0253dc31d1b7/gdb/testsuite/gdb.base/print-file-var.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/print-file-var.exp?ref=1c2bec1918cee91221bccc30db4f0253dc31d1b7",
      "patch": "@@ -56,22 +56,24 @@ proc test {hidden dlopen version_id_main lang} {\n \treturn -1\n     }\n \n-    set main_opts [list debug shlib=${libobj1} $lang]\n+    set main_opts [list debug $lang]\n+    set link_opts [list debug shlib=${libobj1}]\n \n     if {$dlopen} {\n-\tlappend main_opts \"shlib_load\" \\\n-\t    \"additional_flags=-DSHLIB_NAME=\\\"$libobj2\\\"\"\n+\tlappend main_opts \"additional_flags=-DSHLIB_NAME=\\\"$libobj2\\\"\"\n+\tlappend link_opts \"shlib_load\"\n     } else {\n-\tlappend main_opts \"shlib=${libobj2}\"\n+\tlappend link_opts \"shlib=${libobj2}\"\n     }\n \n     lappend main_opts \"additional_flags=-DVERSION_ID_MAIN=$version_id_main\"\n \n-    if { [gdb_compile \"${srcdir}/${subdir}/${main}.c\" \\\n-\t      [standard_output_file ${executable}] \\\n-\t      executable \\\n+    if { [build_executable_from_specs ${main} \\\n+\t      $executable \\\n+\t      $link_opts \\\n+\t      ${main}.c \\\n \t      $main_opts]\n-\t != \"\"} {\n+\t != 0 } {\n \treturn -1\n     }\n "
    }
  ]
}