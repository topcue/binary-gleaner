{
  "sha": "b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YjczN2QzMDQ3Y2M1NmI1ZTJmYmI1YzgzOTBjNGVkMDMxZWFmNWVjMA==",
  "commit": {
    "author": {
      "name": "Rainer Orth",
      "email": "ro@CeBiTec.Uni-Bielefeld.DE",
      "date": "2021-07-07T11:44:31Z"
    },
    "committer": {
      "name": "Rainer Orth",
      "email": "ro@CeBiTec.Uni-Bielefeld.DE",
      "date": "2021-07-07T11:49:27Z"
    },
    "message": "Check for strnlen declaration to fix Solaris 10 build\n\nbinutils currently fails to compile on Solaris 10:\n\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/bfd/opncls.c: In function 'bfd_get_debug_link_info_1':\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/bfd/opncls.c:1231:16: error: implicit declaration of function 'strnlen' [-Werror=implicit-function-declaration]\n 1231 |\t  crc_offset = strnlen (name, size) + 1;\n      |\t\t       ^~~~~~~\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/bfd/opncls.c:1231:16: error: incompatible implicit declaration of built-in function 'strnlen' [-Werror]\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/bfd/opncls.c: In function 'bfd_get_alt_debug_link_info':\n/vol/src/gnu/binutils/hg/binutils-2.37-branch/git/bfd/opncls.c:1319:20: error: incompatible implicit declaration of built-in function 'strnlen' [-Werror]\n 1319 |\t  buildid_offset = strnlen (name, size) + 1;\n      |\t\t\t   ^~~~~~~\n\nand in a couple of other places.  The platform lacks strnlen, and while\nlibiberty.h can provide a fallback declaration, the necessary configure\ntest isn't run.\n\nFixed with the following patch.  Tested on i386-pc-solaris2.10.\n\n2021-07-06  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n\n\tbfd:\n\t* configure.ac: Check for strnlen declaration.\n\t* configure, config.in: Regenerate.\n\n\tbinutils:\n\t* configure.ac: Check for strnlen declaration.\n\t* configure, config.in: Regenerate.",
    "tree": {
      "sha": "652788169b81ba887dbb0d39c37070c61f3538b6",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/652788169b81ba887dbb0d39c37070c61f3538b6"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/comments",
  "author": {
    "login": "rorth",
    "id": 3930951,
    "node_id": "MDQ6VXNlcjM5MzA5NTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rorth",
    "html_url": "https://github.com/rorth",
    "followers_url": "https://api.github.com/users/rorth/followers",
    "following_url": "https://api.github.com/users/rorth/following{/other_user}",
    "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rorth/subscriptions",
    "organizations_url": "https://api.github.com/users/rorth/orgs",
    "repos_url": "https://api.github.com/users/rorth/repos",
    "events_url": "https://api.github.com/users/rorth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rorth/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "rorth",
    "id": 3930951,
    "node_id": "MDQ6VXNlcjM5MzA5NTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rorth",
    "html_url": "https://github.com/rorth",
    "followers_url": "https://api.github.com/users/rorth/followers",
    "following_url": "https://api.github.com/users/rorth/following{/other_user}",
    "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rorth/subscriptions",
    "organizations_url": "https://api.github.com/users/rorth/orgs",
    "repos_url": "https://api.github.com/users/rorth/repos",
    "events_url": "https://api.github.com/users/rorth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rorth/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ffa5352c0c0f735541e69fe6d9a192d82e7d418c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ffa5352c0c0f735541e69fe6d9a192d82e7d418c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/ffa5352c0c0f735541e69fe6d9a192d82e7d418c"
    }
  ],
  "stats": {
    "total": 42,
    "additions": 40,
    "deletions": 2
  },
  "files": [
    {
      "sha": "d96cc78870422b65cdecc8bbbd65154458632f44",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "patch": "@@ -1,3 +1,8 @@\n+2021-07-07  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* configure.ac: Check for strnlen declaration.\n+\t* configure, config.in: Regenerate.\n+\n 2021-07-07  Nick Clifton  <nickc@redhat.com>\n \n \tPR 28051"
    },
    {
      "sha": "f54a3cacbea7eeba286d363ee9dfcb1a55efccd1",
      "filename": "bfd/config.in",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/bfd/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/bfd/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/config.in?ref=b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "patch": "@@ -56,6 +56,10 @@\n    */\n #undef HAVE_DECL_STPCPY\n \n+/* Define to 1 if you have the declaration of `strnlen', and to 0 if you\n+   don't. */\n+#undef HAVE_DECL_STRNLEN\n+\n /* Define to 1 if you have the declaration of `vasprintf', and to 0 if you\n    don't. */\n #undef HAVE_DECL_VASPRINTF"
    },
    {
      "sha": "24171d00344a900d333bdb058fa02aa0f72f1176",
      "filename": "bfd/configure",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/bfd/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/bfd/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/configure?ref=b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "patch": "@@ -12890,6 +12890,16 @@ fi\n cat >>confdefs.h <<_ACEOF\n #define HAVE_DECL_VASPRINTF $ac_have_decl\n _ACEOF\n+ac_fn_c_check_decl \"$LINENO\" \"strnlen\" \"ac_cv_have_decl_strnlen\" \"$ac_includes_default\"\n+if test \"x$ac_cv_have_decl_strnlen\" = xyes; then :\n+  ac_have_decl=1\n+else\n+  ac_have_decl=0\n+fi\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_STRNLEN $ac_have_decl\n+_ACEOF\n \n \n "
    },
    {
      "sha": "fec067b21356799ecdb945f4ce172150624d3ec7",
      "filename": "bfd/configure.ac",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/bfd/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/bfd/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/configure.ac?ref=b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "patch": "@@ -260,7 +260,7 @@ AC_CHECK_HEADERS(fcntl.h sys/file.h sys/resource.h sys/stat.h sys/types.h \\\n AC_CHECK_FUNCS(fcntl fdopen fileno fls getgid getpagesize getrlimit getuid \\\n \t       sysconf)\n \n-AC_CHECK_DECLS([basename, ffs, stpcpy, asprintf, vasprintf])\n+AC_CHECK_DECLS([basename, ffs, stpcpy, asprintf, vasprintf, strnlen])\n \n BFD_BINARY_FOPEN\n "
    },
    {
      "sha": "be5fd77b8384be11940186fab592a6209ca591b5",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "patch": "@@ -1,3 +1,8 @@\n+2021-07-07  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* configure.ac: Check for strnlen declaration.\n+\t* configure, config.in: Regenerate.\n+\n 2021-07-05  Alan Modra  <amodra@gmail.com>\n \n \tPR 28047"
    },
    {
      "sha": "e6fa66fc41b61d9fd9b656e5c979f5955534802a",
      "filename": "binutils/config.in",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/binutils/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/binutils/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/config.in?ref=b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "patch": "@@ -55,6 +55,10 @@\n    */\n #undef HAVE_DECL_STPCPY\n \n+/* Define to 1 if you have the declaration of `strnlen', and to 0 if you\n+   don't. */\n+#undef HAVE_DECL_STRNLEN\n+\n /* Define to 1 if you have the <dlfcn.h> header file. */\n #undef HAVE_DLFCN_H\n "
    },
    {
      "sha": "82640b8b23468420a8a3735dbd4916a1c0529a21",
      "filename": "binutils/configure",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/binutils/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/binutils/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/configure?ref=b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "patch": "@@ -13642,6 +13642,16 @@ fi\n cat >>confdefs.h <<_ACEOF\n #define HAVE_DECL_STPCPY $ac_have_decl\n _ACEOF\n+ac_fn_c_check_decl \"$LINENO\" \"strnlen\" \"ac_cv_have_decl_strnlen\" \"$ac_includes_default\"\n+if test \"x$ac_cv_have_decl_strnlen\" = xyes; then :\n+  ac_have_decl=1\n+else\n+  ac_have_decl=0\n+fi\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_STRNLEN $ac_have_decl\n+_ACEOF\n \n \n # Link in zlib if we can.  This allows us to read compressed debug"
    },
    {
      "sha": "b2d0be00b60b073ea5b98af7290db2bde3106c6e",
      "filename": "binutils/configure.ac",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/binutils/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0/binutils/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/configure.ac?ref=b737d3047cc56b5e2fbb5c8390c4ed031eaf5ec0",
      "patch": "@@ -265,7 +265,7 @@ if test $bu_cv_header_utime_h = yes; then\n   AC_DEFINE(HAVE_GOOD_UTIME_H, 1, [Does <utime.h> define struct utimbuf?])\n fi\n \n-AC_CHECK_DECLS([asprintf, environ, getc_unlocked, sbrk, stpcpy])\n+AC_CHECK_DECLS([asprintf, environ, getc_unlocked, sbrk, stpcpy, strnlen])\n \n # Link in zlib if we can.  This allows us to read compressed debug\n # sections.  This is used only by readelf.c (objdump uses bfd for"
    }
  ]
}