{
  "sha": "853772cc1874a858406ad9b02cdb14cc8b88392a",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ODUzNzcyY2MxODc0YTg1ODQwNmFkOWIwMmNkYjE0Y2M4Yjg4MzkyYQ==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-07-16T13:34:00Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-07-16T13:34:00Z"
    },
    "message": "[gdb/testsuite] Add pseudo line number program instruction: line\n\nThere's an idiom in dwarf assembly test-cases:\n...\nset line1 [gdb_get_line_number \"line 1\"]\nset line2 [gdb_get_line_number \"line 2\"]\nset line3 [gdb_get_line_number \"line 3\"]\n  ...\n            {DW_LNS_advance_line [expr $line1 - 1]}\n  ...\n            {DW_LNS_advance_line [expr $line2 - $line1]}\n  ...\n            {DW_LNS_advance_line [expr $line3 - $line2]}\n...\n\nAdd a pseudo line number program instruction \"line\", such that we can simply\nwrite:\n...\n            {line $line1}\n  ...\n            {line $line2}\n  ...\n            {line $line3}\n...\n\nBuild and reg-tested on x86_64-linux.\n\ngdb/testsuite/ChangeLog:\n\n2020-07-16  Tom de Vries  <tdevries@suse.de>\n\n\t* lib/dwarf.exp (program): Initialize _line.\n\t(DW_LNE_end_sequence): Reinitialize _line.\n\t(DW_LNS_advance_line): Update _line.\n\t(line): New proc.\n\t* gdb.dwarf2/dw2-inline-many-frames.exp: Use line.\n\t* gdb.dwarf2/dw2-inline-small-func.exp: Same.\n\t* gdb.dwarf2/dw2-inline-stepping.exp: Same.\n\t* gdb.dwarf2/dw2-is-stmt-2.exp: Same.\n\t* gdb.dwarf2/dw2-is-stmt.exp: Same.\n\t* gdb.dwarf2/dw2-ranges-func.exp: Same.",
    "tree": {
      "sha": "97c0e0a36f490fbb1350c4640d1955819b5dbeb4",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/97c0e0a36f490fbb1350c4640d1955819b5dbeb4"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/853772cc1874a858406ad9b02cdb14cc8b88392a",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/853772cc1874a858406ad9b02cdb14cc8b88392a",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/853772cc1874a858406ad9b02cdb14cc8b88392a",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/853772cc1874a858406ad9b02cdb14cc8b88392a/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "8ed8e29f059739c431e67a116230c5c60049ebae",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8ed8e29f059739c431e67a116230c5c60049ebae",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/8ed8e29f059739c431e67a116230c5c60049ebae"
    }
  ],
  "stats": {
    "total": 199,
    "additions": 100,
    "deletions": 99
  },
  "files": [
    {
      "sha": "78344179649a28343950b44078aa78ee357d111f",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=853772cc1874a858406ad9b02cdb14cc8b88392a",
      "patch": "@@ -1,3 +1,16 @@\n+2020-07-16  Tom de Vries  <tdevries@suse.de>\n+\n+\t* lib/dwarf.exp (program): Initialize _line.\n+\t(DW_LNE_end_sequence): Reinitialize _line.\n+\t(DW_LNS_advance_line): Update _line.\n+\t(line): New proc.\n+\t* gdb.dwarf2/dw2-inline-many-frames.exp: Use line.\n+\t* gdb.dwarf2/dw2-inline-small-func.exp: Same.\n+\t* gdb.dwarf2/dw2-inline-stepping.exp: Same.\n+\t* gdb.dwarf2/dw2-is-stmt-2.exp: Same.\n+\t* gdb.dwarf2/dw2-is-stmt.exp: Same.\n+\t* gdb.dwarf2/dw2-ranges-func.exp: Same.\n+\n 2020-07-15  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* gdb.fortran/ptype-on-functions.exp: Make the result pattern more"
    },
    {
      "sha": "e826825eb4b2705960d45a03117db46f17ef2fb5",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-inline-many-frames.exp",
      "status": "modified",
      "additions": 24,
      "deletions": 24,
      "changes": 48,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-inline-many-frames.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-inline-many-frames.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-inline-many-frames.exp?ref=853772cc1874a858406ad9b02cdb14cc8b88392a",
      "patch": "@@ -188,91 +188,91 @@ Dwarf::assemble $asm_file {\n \n \tprogram {\n \t    {DW_LNE_set_address $main_start}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"main prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"main prologue\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"main set global_var\"] - [gdb_get_line_number \"main prologue\"]]}\n+\t    {line [gdb_get_line_number \"main set global_var\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"main call aaa\"] - [gdb_get_line_number \"main set global_var\"]]}\n+\t    {line [gdb_get_line_number \"main call aaa\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"aaa return\"] - [gdb_get_line_number \"main call aaa\"]]}\n+\t    {line [gdb_get_line_number \"aaa return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"bbb return\"] - [gdb_get_line_number \"aaa return\"]]}\n+\t    {line [gdb_get_line_number \"bbb return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"ccc return\"] - [gdb_get_line_number \"bbb return\"]]}\n+\t    {line [gdb_get_line_number \"ccc return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label3}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"main end\"] - [gdb_get_line_number \"ccc return\"]]}\n+\t    {line [gdb_get_line_number \"main end\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address $main_end}\n \t    {DW_LNE_end_sequence}\n \n \t    {DW_LNE_set_address $ddd_start}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"ddd prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"ddd prologue\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address ddd_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"ddd return\"] - [gdb_get_line_number \"ddd prologue\"]]}\n+\t    {line [gdb_get_line_number \"ddd return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address ddd_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"ddd end\"] - [gdb_get_line_number \"ddd return\"]]}\n+\t    {line [gdb_get_line_number \"ddd end\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address $ddd_end}\n \t    {DW_LNE_end_sequence}\n \n \t    {DW_LNE_set_address $eee_start}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"eee prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"eee prologue\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address eee_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"eee return\"] - [gdb_get_line_number \"eee prologue\"]]}\n+\t    {line [gdb_get_line_number \"eee return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address eee_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"eee end\"] - [gdb_get_line_number \"eee return\"]]}\n+\t    {line [gdb_get_line_number \"eee end\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address $eee_end}\n \t    {DW_LNE_end_sequence}\n \n \t    {DW_LNE_set_address $fff_start}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"fff prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"fff prologue\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address fff_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"fff return\"] - [gdb_get_line_number \"fff prologue\"]]}\n+\t    {line [gdb_get_line_number \"fff return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address fff_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"ggg return\"] - [gdb_get_line_number \"fff return\"]]}\n+\t    {line [gdb_get_line_number \"ggg return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address fff_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"hhh return\"] - [gdb_get_line_number \"ggg return\"]]}\n+\t    {line [gdb_get_line_number \"hhh return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address fff_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"iii return\"] - [gdb_get_line_number \"hhh return\"]]}\n+\t    {line [gdb_get_line_number \"iii return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address fff_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"fff end\"] - [gdb_get_line_number \"fff return\"]]}\n+\t    {line [gdb_get_line_number \"fff end\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address $fff_end}\n \t    {DW_LNE_end_sequence}\n \n \t    {DW_LNE_set_address $jjj_start}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"jjj prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"jjj prologue\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address jjj_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"jjj return\"] - [gdb_get_line_number \"jjj prologue\"]]}\n+\t    {line [gdb_get_line_number \"jjj return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address jjj_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"jjj end\"] - [gdb_get_line_number \"jjj return\"]]}\n+\t    {line [gdb_get_line_number \"jjj end\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address $jjj_end}\n \t    {DW_LNE_end_sequence}\n \n \t    {DW_LNE_set_address $kkk_start}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"kkk prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"kkk prologue\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address kkk_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"kkk return\"] - [gdb_get_line_number \"kkk prologue\"]]}\n+\t    {line [gdb_get_line_number \"kkk return\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address $kkk_end}\n \t    {DW_LNE_end_sequence}"
    },
    {
      "sha": "12a60a01edd5bed9db5e91100c4ad243ae430536",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-inline-small-func.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 4,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-inline-small-func.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-inline-small-func.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-inline-small-func.exp?ref=853772cc1874a858406ad9b02cdb14cc8b88392a",
      "patch": "@@ -95,22 +95,22 @@ Dwarf::assemble $asm_file {\n \n \tprogram {\n \t    {DW_LNE_set_address line_label_1}\n-\t    {DW_LNS_advance_line [expr $f1_l1 - 1]}\n+\t    {line $f1_l1}\n \t    {DW_LNS_copy}\n \n-\t    {DW_LNS_advance_line [expr ${f1_l2} - ${f1_l1}]}\n+\t    {line ${f1_l2}}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNS_set_file 2}\n-\t    {DW_LNS_advance_line [expr ${f2_l1} - ${f1_l2}]}\n+\t    {line ${f2_l1}}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNS_set_file 1}\n \t    {DW_LNE_set_address line_label_2}\n-\t    {DW_LNS_advance_line [expr ${f1_l3} - ${f2_l1}]}\n+\t    {line ${f1_l3}}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_3}"
    },
    {
      "sha": "1632d5e898985bea54c9e908c743de9aac39f4ca",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-inline-stepping.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 6,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-inline-stepping.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-inline-stepping.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-inline-stepping.exp?ref=853772cc1874a858406ad9b02cdb14cc8b88392a",
      "patch": "@@ -95,25 +95,25 @@ Dwarf::assemble $asm_file {\n \n \tprogram {\n \t    {DW_LNE_set_address $main_start}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"main prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"main prologue\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"main set global_var\"] - [gdb_get_line_number \"main prologue\"]]}\n+\t    {line [gdb_get_line_number \"main set global_var\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"main call foo\"] - [gdb_get_line_number \"main set global_var\"]]}\n+\t    {line [gdb_get_line_number \"main call foo\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address main_label2}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"foo call bar\"] - [gdb_get_line_number \"main call foo\"]]}\n+\t    {line [gdb_get_line_number \"foo call bar\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address $main_end}\n \t    {DW_LNE_end_sequence}\n \n \t    {DW_LNE_set_address $bar_start}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"bar prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"bar prologue\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address bar_label}\n-\t    {DW_LNS_advance_line [expr [gdb_get_line_number \"bar return global_var\"] - [gdb_get_line_number \"bar prologue\"]]}\n+\t    {line [gdb_get_line_number \"bar return global_var\"]}\n \t    {DW_LNS_copy}\n \t    {DW_LNE_set_address $bar_end}\n \t    {DW_LNE_end_sequence}"
    },
    {
      "sha": "745af0409fab1346e5f1f21f6b2cb7adb5aeb55d",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-is-stmt-2.exp",
      "status": "modified",
      "additions": 14,
      "deletions": 41,
      "changes": 55,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-is-stmt-2.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-is-stmt-2.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-is-stmt-2.exp?ref=853772cc1874a858406ad9b02cdb14cc8b88392a",
      "patch": "@@ -69,20 +69,15 @@ Dwarf::assemble $asm_file {\n \n \tprogram {\n \t    {DW_LNE_set_address main}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"main prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"main prologue\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_0}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"main start\"] \\\n-\t\t      - [gdb_get_line_number \"main prologue\"]]}\n+\t    {line [gdb_get_line_number \"main start\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_1}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 1\"] \\\n-\t\t      - [gdb_get_line_number \"main start\"]]}\n+\t    {line [gdb_get_line_number \"Line 1\"]}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n@@ -91,83 +86,61 @@ Dwarf::assemble $asm_file {\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_3}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 2\"] \\\n-\t\t      - [gdb_get_line_number \"Line 1\"]]}\n+\t    {line [gdb_get_line_number \"Line 2\"]}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_4}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 1\"] \\\n-\t\t      - [gdb_get_line_number \"Line 2\"]]}\n+\t    {line [gdb_get_line_number \"Line 1\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_5}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 3\"] \\\n-\t\t      - [gdb_get_line_number \"Line 1\"]]}\n+\t    {line [gdb_get_line_number \"Line 3\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_6}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 4\"] \\\n-\t\t      - [gdb_get_line_number \"Line 3\"]]}\n+\t    {line [gdb_get_line_number \"Line 4\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_7}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_8}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 2\"] \\\n-\t\t      - [gdb_get_line_number \"Line 4\"]]}\n+\t    {line [gdb_get_line_number \"Line 2\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_9}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_10}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 3\"] \\\n-\t\t      - [gdb_get_line_number \"Line 2\"]]}\n+\t    {line [gdb_get_line_number \"Line 3\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_11}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 5\"] \\\n-\t\t      - [gdb_get_line_number \"Line 3\"]]}\n+\t    {line [gdb_get_line_number \"Line 5\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_12}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_13}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 3\"] \\\n-\t\t      - [gdb_get_line_number \"Line 5\"]]}\n+\t    {line [gdb_get_line_number \"Line 3\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_14}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 4\"] \\\n-\t\t      - [gdb_get_line_number \"Line 3\"]]}\n+\t    {line [gdb_get_line_number \"Line 4\"]}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_15}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"Line 5\"] \\\n-\t\t      - [gdb_get_line_number \"Line 4\"]]}\n+\t    {line [gdb_get_line_number \"Line 5\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_16}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"main end\"] \\\n-\t\t      - [gdb_get_line_number \"Line 5\"]]}\n+\t    {line [gdb_get_line_number \"main end\"]}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n "
    },
    {
      "sha": "62e655a0ee8f9967a7994b22e59025afdc6322a0",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-is-stmt.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 11,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-is-stmt.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-is-stmt.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-is-stmt.exp?ref=853772cc1874a858406ad9b02cdb14cc8b88392a",
      "patch": "@@ -69,21 +69,16 @@ Dwarf::assemble $asm_file {\n \n \tprogram {\n \t    {DW_LNE_set_address main}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"main prologue\"] - 1]}\n+\t    {line [gdb_get_line_number \"main prologue\"]}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_1}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"main, set var to 99\"] \\\n-\t\t      - [gdb_get_line_number \"main prologue\"]]}\n+\t    {line [gdb_get_line_number \"main, set var to 99\"]}\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_2}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"main, set var to 0\"] \\\n-\t\t      - [gdb_get_line_number \"main, set var to 99\"]]}\n+\t    {line [gdb_get_line_number \"main, set var to 0\"]}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n \n@@ -96,9 +91,7 @@ Dwarf::assemble $asm_file {\n \t    {DW_LNS_copy}\n \n \t    {DW_LNE_set_address line_label_5}\n-\t    {DW_LNS_advance_line \\\n-\t\t [expr [gdb_get_line_number \"main end\"] \\\n-\t\t      - [gdb_get_line_number \"main, set var to 0\"]]}\n+\t    {line [gdb_get_line_number \"main end\"]}\n \t    {DW_LNS_negate_stmt}\n \t    {DW_LNS_copy}\n "
    },
    {
      "sha": "ac37b24285a138a8442a90ad5b461b42e92b483b",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-ranges-func.exp",
      "status": "modified",
      "additions": 13,
      "deletions": 13,
      "changes": 26,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-ranges-func.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/gdb.dwarf2/dw2-ranges-func.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-ranges-func.exp?ref=853772cc1874a858406ad9b02cdb14cc8b88392a",
      "patch": "@@ -134,60 +134,60 @@ proc do_test {suffix} {\n \t    # reasonably accurate as it made debugging the test case easier.\n \t    program {\n \t\t{DW_LNE_set_address $main_start}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"main prologue\"] - 1]}\n+\t\t{line [gdb_get_line_number \"main prologue\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address main_label}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"main foo call\"] - [gdb_get_line_number \"main prologue\"]]}\n+\t\t{line [gdb_get_line_number \"main foo call\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address main_label2}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"main return\"] - [gdb_get_line_number \"main foo call\"]]}\n+\t\t{line [gdb_get_line_number \"main return\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address $main_end}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"main end\"] - [gdb_get_line_number \"main return\"] + 1]}\n+\t\t{line [expr [gdb_get_line_number \"main end\"] + 1]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_end_sequence}\n \n \t\t{DW_LNE_set_address $foo_start}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"foo prologue\"] - 1] }\n+\t\t{line [gdb_get_line_number \"foo prologue\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address foo_label}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"foo bar call\"] - [gdb_get_line_number \"foo prologue\"]]}\n+\t\t{line [gdb_get_line_number \"foo bar call\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address foo_label2}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"foo foo_cold call\"] - [gdb_get_line_number \"foo bar call\"]]}\n+\t\t{line [gdb_get_line_number \"foo foo_cold call\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address foo_label3}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"foo end\"] - [gdb_get_line_number \"foo foo_cold call\"]]}\n+\t\t{line [gdb_get_line_number \"foo end\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address $foo_end}\n \t\t{DW_LNS_advance_line 1}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_end_sequence}\n \n \t\t{DW_LNE_set_address $bar_start}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"bar end\"] - 1]}\n+\t\t{line [gdb_get_line_number \"bar end\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNS_advance_pc $bar_len}\n \t\t{DW_LNS_advance_line 1}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_end_sequence}\n \n \t\t{DW_LNE_set_address $baz_start}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"baz end\"] - 1]}\n+\t\t{line [gdb_get_line_number \"baz end\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNS_advance_pc $baz_len}\n \t\t{DW_LNS_advance_line 1}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_end_sequence}\n \n \t\t{DW_LNE_set_address $foo_cold_start}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"foo_cold prologue\"] - 1]}\n+\t        {line [gdb_get_line_number \"foo_cold prologue\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address foo_cold_label}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"foo_cold baz call\"] - [gdb_get_line_number \"foo_cold prologue\"]]}\n+\t\t{line [gdb_get_line_number \"foo_cold baz call\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address foo_cold_label2}\n-\t\t{DW_LNS_advance_line [expr [gdb_get_line_number \"foo_cold end\"] - [gdb_get_line_number \"foo_cold baz call\"]]}\n+\t\t{line [gdb_get_line_number \"foo_cold end\"]}\n \t\t{DW_LNS_copy}\n \t\t{DW_LNE_set_address $foo_cold_end}\n \t\t{DW_LNS_advance_line 1}"
    },
    {
      "sha": "21dc0f62d4da0302b091fc9ac50801ff295738e3",
      "filename": "gdb/testsuite/lib/dwarf.exp",
      "status": "modified",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/lib/dwarf.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/853772cc1874a858406ad9b02cdb14cc8b88392a/gdb/testsuite/lib/dwarf.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/dwarf.exp?ref=853772cc1874a858406ad9b02cdb14cc8b88392a",
      "patch": "@@ -1423,6 +1423,9 @@ namespace eval Dwarf {\n \tproc program {statements} {\n \t    variable _line_saw_program\n \t    variable _line_header_end_label\n+\t    variable _line\n+\n+\t    set _line 1\n \n \t    if \"! $_line_saw_program\" {\n \t\t# Terminate the file list.\n@@ -1447,9 +1450,11 @@ namespace eval Dwarf {\n \t    }\n \n \t    proc DW_LNE_end_sequence {} {\n+\t\tvariable _line\n \t\t_op .byte 0\n \t\t_op .uleb128 1\n \t\t_op .byte 1\n+\t\tset _line 1\n \t    }\n \n \t    proc DW_LNS_copy {} {\n@@ -1466,8 +1471,25 @@ namespace eval Dwarf {\n \t    }\n \n \t    proc DW_LNS_advance_line {offset} {\n+\t\tvariable _line\n \t\t_op .byte 3\n \t\t_op .sleb128 ${offset}\n+\t\tset _line [expr $_line + $offset]\n+\t    }\n+\n+\t    # A pseudo line number program instruction, that can be used instead\n+\t    # of DW_LNS_advance_line.  Rather than writing:\n+\t    #   {DW_LNS_advance_line [expr $line1 - 1]}\n+\t    #   {DW_LNS_advance_line [expr $line2 - $line1]}\n+\t    #   {DW_LNS_advance_line [expr $line3 - $line2]}\n+\t    # we can just write:\n+\t    #   {line $line1}\n+\t    #   {line $line2}\n+\t    #   {line $line3}\n+\t    proc line {line} {\n+\t\tvariable _line\n+\t\tset offset [expr $line - $_line]\n+\t\tDW_LNS_advance_line $offset\n \t    }\n \n \t    proc DW_LNS_set_file {num} {"
    }
  ]
}