{
  "sha": "b55221abba07302964f697db7eb996ff33b26f5a",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YjU1MjIxYWJiYTA3MzAyOTY0ZjY5N2RiN2ViOTk2ZmYzM2IyNmY1YQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-10-29T21:04:33Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-10-29T21:04:36Z"
    },
    "message": "Remove current_target_sections macro\n\nThis removes the current_target_sections macro, replacing it with uses\nof the appropriate member from current_program_space.\n\ngdb/ChangeLog\n2020-10-29  Tom Tromey  <tom@tromey.com>\n\n\t* progspace.h (current_target_sections): Remove macro.\n\t* solib-svr4.c (scan_dyntag): Update.\n\t* solib-dsbt.c (scan_dyntag): Update.\n\t* exec.c (exec_target::close): Update.\n\t(add_target_sections, add_target_sections_of_objfile)\n\t(remove_target_sections, exec_target::get_section_table)\n\t(exec_target::files_info, set_section_command)\n\t(exec_set_section_address, exec_target::has_memory)\n\t(exec_target::has_memory): Update.",
    "tree": {
      "sha": "feb17b005f5243dc5e3463314c2627764f8f47e5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/feb17b005f5243dc5e3463314c2627764f8f47e5"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/b55221abba07302964f697db7eb996ff33b26f5a",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b55221abba07302964f697db7eb996ff33b26f5a",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/b55221abba07302964f697db7eb996ff33b26f5a",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b55221abba07302964f697db7eb996ff33b26f5a/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5a36e71525564fe8767bc9f00b29dcc0fec59837",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5a36e71525564fe8767bc9f00b29dcc0fec59837",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5a36e71525564fe8767bc9f00b29dcc0fec59837"
    }
  ],
  "stats": {
    "total": 38,
    "additions": 23,
    "deletions": 15
  },
  "files": [
    {
      "sha": "3ab3564b75248d55b1547f3718c8db86e5bb0110",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b55221abba07302964f697db7eb996ff33b26f5a/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b55221abba07302964f697db7eb996ff33b26f5a/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=b55221abba07302964f697db7eb996ff33b26f5a",
      "patch": "@@ -1,3 +1,15 @@\n+2020-10-29  Tom Tromey  <tom@tromey.com>\n+\n+\t* progspace.h (current_target_sections): Remove macro.\n+\t* solib-svr4.c (scan_dyntag): Update.\n+\t* solib-dsbt.c (scan_dyntag): Update.\n+\t* exec.c (exec_target::close): Update.\n+\t(add_target_sections, add_target_sections_of_objfile)\n+\t(remove_target_sections, exec_target::get_section_table)\n+\t(exec_target::files_info, set_section_command)\n+\t(exec_set_section_address, exec_target::has_memory)\n+\t(exec_target::has_memory): Update.\n+\n 2020-10-29  Tom Tromey  <tom@tromey.com>\n \n \t* source-cache.c (source_cache::get_plain_source_lines): Use"
    },
    {
      "sha": "2db207aafab74ab57ceca8ada26e9617f4cec273",
      "filename": "gdb/exec.c",
      "status": "modified",
      "additions": 9,
      "deletions": 9,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b55221abba07302964f697db7eb996ff33b26f5a/gdb/exec.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b55221abba07302964f697db7eb996ff33b26f5a/gdb/exec.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/exec.c?ref=b55221abba07302964f697db7eb996ff33b26f5a",
      "patch": "@@ -159,7 +159,7 @@ exec_target::close ()\n   for (struct program_space *ss : program_spaces)\n     {\n       set_current_program_space (ss);\n-      current_target_sections->clear ();\n+      ss->target_sections.clear ();\n       ss->exec_close ();\n     }\n }\n@@ -591,7 +591,7 @@ void\n add_target_sections (void *owner,\n \t\t     const target_section_table &sections)\n {\n-  target_section_table *table = current_target_sections;\n+  target_section_table *table = &current_program_space->target_sections;\n \n   if (!sections.empty ())\n     {\n@@ -626,7 +626,7 @@ add_target_sections (void *owner,\n void\n add_target_sections_of_objfile (struct objfile *objfile)\n {\n-  target_section_table *table = current_target_sections;\n+  target_section_table *table = &current_program_space->target_sections;\n   struct obj_section *osect;\n \n   gdb_assert (objfile != nullptr);\n@@ -649,7 +649,7 @@ add_target_sections_of_objfile (struct objfile *objfile)\n void\n remove_target_sections (void *owner)\n {\n-  target_section_table *table = current_target_sections;\n+  target_section_table *table = &current_program_space->target_sections;\n \n   gdb_assert (owner != NULL);\n \n@@ -893,7 +893,7 @@ section_table_xfer_memory_partial (gdb_byte *readbuf, const gdb_byte *writebuf,\n target_section_table *\n exec_target::get_section_table ()\n {\n-  return current_target_sections;\n+  return &current_program_space->target_sections;\n }\n \n enum target_xfer_status\n@@ -991,7 +991,7 @@ void\n exec_target::files_info ()\n {\n   if (exec_bfd)\n-    print_section_info (current_target_sections, exec_bfd);\n+    print_section_info (&current_program_space->target_sections, exec_bfd);\n   else\n     puts_filtered (_(\"\\t<no file loaded>\\n\"));\n }\n@@ -1015,7 +1015,7 @@ set_section_command (const char *args, int from_tty)\n   /* Parse out new virtual address.  */\n   secaddr = parse_and_eval_address (args);\n \n-  for (target_section &p : *current_target_sections)\n+  for (target_section &p : current_program_space->target_sections)\n     {\n       if (!strncmp (secname, bfd_section_name (p.the_bfd_section), seclen)\n \t  && bfd_section_name (p.the_bfd_section)[seclen] == '\\0')\n@@ -1041,7 +1041,7 @@ set_section_command (const char *args, int from_tty)\n void\n exec_set_section_address (const char *filename, int index, CORE_ADDR address)\n {\n-  for (target_section &p : *current_target_sections)\n+  for (target_section &p : current_program_space->target_sections)\n     {\n       if (filename_cmp (filename,\n \t\t\tbfd_get_filename (p.the_bfd_section->owner)) == 0\n@@ -1058,7 +1058,7 @@ exec_target::has_memory ()\n {\n   /* We can provide memory if we have any file/target sections to read\n      from.  */\n-  return !current_target_sections->empty ();\n+  return !current_program_space->target_sections.empty ();\n }\n \n gdb::unique_xmalloc_ptr<char>"
    },
    {
      "sha": "03634034ba08030be11aa2e88beadc43da233678",
      "filename": "gdb/progspace.h",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b55221abba07302964f697db7eb996ff33b26f5a/gdb/progspace.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b55221abba07302964f697db7eb996ff33b26f5a/gdb/progspace.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/progspace.h?ref=b55221abba07302964f697db7eb996ff33b26f5a",
      "patch": "@@ -365,10 +365,6 @@ struct address_space\n \n #define symfile_objfile current_program_space->symfile_object_file\n \n-/* The set of target sections matching the sections mapped into the\n-   current program space.  */\n-#define current_target_sections (&current_program_space->target_sections)\n-\n /* The list of all program spaces.  There's always at least one.  */\n extern std::vector<struct program_space *>program_spaces;\n "
    },
    {
      "sha": "6f610c511e0314359f3d5021c82a2a0c9801ef4b",
      "filename": "gdb/solib-dsbt.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b55221abba07302964f697db7eb996ff33b26f5a/gdb/solib-dsbt.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b55221abba07302964f697db7eb996ff33b26f5a/gdb/solib-dsbt.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/solib-dsbt.c?ref=b55221abba07302964f697db7eb996ff33b26f5a",
      "patch": "@@ -424,7 +424,7 @@ scan_dyntag (int dyntag, bfd *abfd, CORE_ADDR *ptr)\n     return 0;\n \n   bool found = false;\n-  for (target_section &target_section : *current_target_sections)\n+  for (target_section &target_section : current_program_space->target_sections)\n     if (sect == target_section.the_bfd_section)\n       {\n \tdyn_addr = target_section.addr;"
    },
    {
      "sha": "faaba471a191718301ad1f5df5e9508fb7c8dd2f",
      "filename": "gdb/solib-svr4.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b55221abba07302964f697db7eb996ff33b26f5a/gdb/solib-svr4.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b55221abba07302964f697db7eb996ff33b26f5a/gdb/solib-svr4.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/solib-svr4.c?ref=b55221abba07302964f697db7eb996ff33b26f5a",
      "patch": "@@ -608,7 +608,7 @@ scan_dyntag (const int desired_dyntag, bfd *abfd, CORE_ADDR *ptr,\n     return 0;\n \n   bool found = false;\n-  for (target_section &target_section : *current_target_sections)\n+  for (target_section &target_section : current_program_space->target_sections)\n     if (sect == target_section.the_bfd_section)\n       {\n \tdyn_addr = target_section.addr;"
    }
  ]
}