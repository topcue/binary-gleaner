{
  "sha": "10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTBmOTI0MTRkNmQ0YTVmOGViOGNiYjJiZjM5Y2E4NmMxZjljMWRhNQ==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-01-15T11:14:45Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-01-15T11:14:45Z"
    },
    "message": "[gdb/testsuite] Fix gdb.fortran/array-slices.exp with -m32\n\nWhen running test-case gdb.fortran/array-slices.exp with target board\nunix/-m32, we run into:\n...\n(gdb) print /x &array4d^M\n$69 = 0xffffb620^M\n(gdb) print /x (&array4d) + sizeof (array4d)^M\n$70 = 0x95c620^M\n(gdb) FAIL: gdb.fortran/array-slices.exp: repack=on: test 9: check sizes match\n...\nThe expressions calculate the start and end of an array, but the calculation\nof the end expression has an unexpected result (given that it lies before the\nstart of the array).  By printing \"sizeof (array4d)\" as a separate\nexpression:\n...\n(gdb) print /x sizeof (array4d)\n$1 = 0xc40\n...\nit becomes clear we expected to get 0xffffb620 + 0xc40 == 0xffffc260 instead.\n\nThe problem is that using the '&' returns a pointer type:\n...\n(gdb) p &array4d\n$5 = (PTR TO -> ( integer(kind=4) (-3:3,7:10,-3:3,-10:-7) )) 0xffffbe00\n...\nwhich has the consequence that the addition is done as pointer arithmetic.\n\nFix this by using the result of \"print /x &array4d\" instead of &array4d in the\naddition.\n\nTested on x86_64-linux.\n\ngdb/testsuite/ChangeLog:\n\n2021-01-15  Tom de Vries  <tdevries@suse.de>\n\n\tPR testsuite/26997\n\t* gdb.fortran/array-slices.exp (run_test): Avoid pointer arithmetic\n\twhen adding sizeof.",
    "tree": {
      "sha": "8c3581d9cfbf931a2eebe8d2134dcd98adc767a9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/8c3581d9cfbf931a2eebe8d2134dcd98adc767a9"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "4bb5732e27bb43c354f4c55312316604b62a3a0f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4bb5732e27bb43c354f4c55312316604b62a3a0f",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/4bb5732e27bb43c354f4c55312316604b62a3a0f"
    }
  ],
  "stats": {
    "total": 8,
    "additions": 7,
    "deletions": 1
  },
  "files": [
    {
      "sha": "49623b59acc728e0eb8a1e84300faabaf7de3494",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5",
      "patch": "@@ -1,3 +1,9 @@\n+2021-01-15  Tom de Vries  <tdevries@suse.de>\n+\n+\tPR testsuite/26997\n+\t* gdb.fortran/array-slices.exp (run_test): Avoid pointer arithmetic\n+\twhen adding sizeof.\n+\n 2021-01-14  Tom de Vries  <tdevries@suse.de>\n \n \tPR testsuite/24590"
    },
    {
      "sha": "45753d9baea70b8e8b9518e6bda2a2b4bc5ed65f",
      "filename": "gdb/testsuite/gdb.fortran/array-slices.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5/gdb/testsuite/gdb.fortran/array-slices.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5/gdb/testsuite/gdb.fortran/array-slices.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/array-slices.exp?ref=10f92414d6d4a5f8eb8cbb2bf39ca86c1f9c1da5",
      "patch": "@@ -208,7 +208,7 @@ proc run_test { repack } {\n \t    set start_addr [get_hexadecimal_valueof \"&${full_var_name}\" \\\n \t\t\t\t\"start unknown\"]\n \t    set end_addr [get_hexadecimal_valueof \\\n-\t\t\t      \"(&${full_var_name}) + sizeof (${full_var_name})\" \\\n+\t\t\t      \"$start_addr + sizeof (${full_var_name})\" \\\n \t\t\t      \"end unknown\"]\n \n \t    # The Fortran compiler can choose to either send a descriptor that"
    }
  ]
}