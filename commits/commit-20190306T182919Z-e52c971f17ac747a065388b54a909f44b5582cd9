{
  "sha": "e52c971f17ac747a065388b54a909f44b5582cd9",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZTUyYzk3MWYxN2FjNzQ3YTA2NTM4OGI1NGE5MDlmNDRiNTU4MmNkOQ==",
  "commit": {
    "author": {
      "name": "Pedro Alves",
      "email": "palves@redhat.com",
      "date": "2019-03-06T18:29:19Z"
    },
    "committer": {
      "name": "Pedro Alves",
      "email": "palves@redhat.com",
      "date": "2019-03-06T18:29:19Z"
    },
    "message": "linux-fork.c: rewrite inf_has_multiple_threads\n\nThere's no need to iterate over all threads of all inferiors here.\n\ngdb/ChangeLog:\n2019-03-06  Pedro Alves  <palves@redhat.com>\n\n\t* linux-fork.c (inf_has_multiple_thread_cb): Delete.\n\t(inf_has_multiple_threads): Return 'bool' and rewrite using\n\tinferior_info::threads().",
    "tree": {
      "sha": "6d797a4bcec7cd518fdd9313b644c385a4be5d8e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6d797a4bcec7cd518fdd9313b644c385a4be5d8e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e52c971f17ac747a065388b54a909f44b5582cd9",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e52c971f17ac747a065388b54a909f44b5582cd9",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e52c971f17ac747a065388b54a909f44b5582cd9",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e52c971f17ac747a065388b54a909f44b5582cd9/comments",
  "author": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "06974e6c05556edb7122f45239c95045e882dc76",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/06974e6c05556edb7122f45239c95045e882dc76",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/06974e6c05556edb7122f45239c95045e882dc76"
    }
  ],
  "stats": {
    "total": 35,
    "additions": 15,
    "deletions": 20
  },
  "files": [
    {
      "sha": "f423232d95fa94579ce35ccb918968284942f19b",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e52c971f17ac747a065388b54a909f44b5582cd9/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e52c971f17ac747a065388b54a909f44b5582cd9/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=e52c971f17ac747a065388b54a909f44b5582cd9",
      "patch": "@@ -1,3 +1,9 @@\n+2019-03-06  Pedro Alves  <palves@redhat.com>\n+\n+\t* linux-fork.c (inf_has_multiple_thread_cb): Delete.\n+\t(inf_has_multiple_threads): Return 'bool' and rewrite using\n+\tinferior_info::threads().\n+\n 2019-03-06  Pedro Alves  <palves@redhat.com>\n \n \t* linux-fork.c: Include <list>."
    },
    {
      "sha": "4bc454ba6dd9d570bf8f3667c70cd2ca3eae3fa1",
      "filename": "gdb/linux-fork.c",
      "status": "modified",
      "additions": 9,
      "deletions": 20,
      "changes": 29,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e52c971f17ac747a065388b54a909f44b5582cd9/gdb/linux-fork.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e52c971f17ac747a065388b54a909f44b5582cd9/gdb/linux-fork.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/linux-fork.c?ref=e52c971f17ac747a065388b54a909f44b5582cd9",
      "patch": "@@ -627,31 +627,20 @@ linux_fork_checkpointing_p (int pid)\n   return (checkpointing_pid == pid);\n }\n \n-/* Callback for iterate over threads.  Used to check whether\n-   the current inferior is multi-threaded.  Returns true as soon\n-   as it sees the second thread of the current inferior.  */\n-\n-static int\n-inf_has_multiple_thread_cb (struct thread_info *tp, void *data)\n-{\n-  int *count_p = (int *) data;\n-  \n-  if (current_inferior ()->pid == tp->ptid.pid ())\n-    (*count_p)++;\n-  \n-  /* Stop the iteration if multiple threads have been detected.  */\n-  return *count_p > 1;\n-}\n-\n /* Return true if the current inferior is multi-threaded.  */\n \n-static int\n-inf_has_multiple_threads (void)\n+static bool\n+inf_has_multiple_threads ()\n {\n   int count = 0;\n \n-  iterate_over_threads (inf_has_multiple_thread_cb, &count);\n-  return (count > 1);\n+  /* Return true as soon as we see the second thread of the current\n+     inferior.  */\n+  for (thread_info *tp ATTRIBUTE_UNUSED : current_inferior ()->threads ())\n+    if (++count > 1)\n+      return true;\n+\n+  return false;\n }\n \n static void"
    }
  ]
}