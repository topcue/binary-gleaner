{
  "sha": "d706b69e48268ccf3e95fd29b5374ac94c3a507b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDcwNmI2OWU0ODI2OGNjZjNlOTVmZDI5YjUzNzRhYzk0YzNhNTA3Yg==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-09-08T16:20:44Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-09-08T16:41:03Z"
    },
    "message": "Do not adjust mtime timezone on Windows\n\nPR win32/25302 notes that gdb will crash when trying to \"run\" even a\nsimple program on Windows.  The essential bug here is that the BFD\ncache can easily be corrupted -- I have sent a separate patch for\nthat.\n\nThe particular reason that the cache is corrupted on Windows is that\ngnulib overrides \"stat\" to make it do timezone adjustment -- but BFD\ndoes not use this version of stat.  The difference here triggers the\nlatent cache bug, but can also cause other bugs as well; in particular\nit can cause spurious warnings about source files being newer.\n\nThis patch simply removes the stat override on mingw, making gnulib\nand BFD agree.\n\nI tested this by backing out the local AdaCore changes to work around\nthis bug and then verifying that I could reproduce it.  Then, I\napplied this patch and verified that \"run\" works again.\n\n2020-09-08  Tom Tromey  <tromey@adacore.com>\n\n\tPR win32/25302:\n\t* update-gnulib.sh: Apply stat patch.\n\t* patches/0001-use-windows-stat: New file.\n\t* import/m4/stat.m4: Update.\n\t* configure: Rebuild.",
    "tree": {
      "sha": "d16e0e4a5c4d18ee5c944eaaec0defe30e369a28",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d16e0e4a5c4d18ee5c944eaaec0defe30e369a28"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d706b69e48268ccf3e95fd29b5374ac94c3a507b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d706b69e48268ccf3e95fd29b5374ac94c3a507b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d706b69e48268ccf3e95fd29b5374ac94c3a507b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d706b69e48268ccf3e95fd29b5374ac94c3a507b/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "03b0a45f15e44da7983dffea921c0c43a19250ff",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/03b0a45f15e44da7983dffea921c0c43a19250ff",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/03b0a45f15e44da7983dffea921c0c43a19250ff"
    }
  ],
  "stats": {
    "total": 28,
    "additions": 25,
    "deletions": 3
  },
  "files": [
    {
      "sha": "bf617428c4d60f36817ee73992f4da5fae7aa05a",
      "filename": "gnulib/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/ChangeLog?ref=d706b69e48268ccf3e95fd29b5374ac94c3a507b",
      "patch": "@@ -1,3 +1,11 @@\n+2020-09-08  Tom Tromey  <tromey@adacore.com>\n+\n+\tPR win32/25302:\n+\t* update-gnulib.sh: Apply stat patch.\n+\t* patches/0001-use-windows-stat: New file.\n+\t* import/m4/stat.m4: Update.\n+\t* configure: Rebuild.\n+\n 2020-08-26  Christian Biesinger  <cbiesinger@google.com>\n \t    Pedro Alves  <palves@redhat.com>\n \t    Joel Brobecker  <brobecker@adacore.com>"
    },
    {
      "sha": "5c6add6e37181096745e59c72740efe3fbaa3231",
      "filename": "gnulib/configure",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/configure?ref=d706b69e48268ccf3e95fd29b5374ac94c3a507b",
      "patch": "@@ -26907,8 +26907,7 @@ $as_echo \"#define ssize_t int\" >>confdefs.h\n \n   case \"$host_os\" in\n     mingw*)\n-                  REPLACE_STAT=1\n-      ;;\n+                        ;;\n     *)\n                         { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether stat handles trailing slashes on files\" >&5\n $as_echo_n \"checking whether stat handles trailing slashes on files... \" >&6; }"
    },
    {
      "sha": "8ef355f9407a017c57142299ab5c780365516aa6",
      "filename": "gnulib/import/m4/stat.m4",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/import/m4/stat.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/import/m4/stat.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/stat.m4?ref=d706b69e48268ccf3e95fd29b5374ac94c3a507b",
      "patch": "@@ -15,7 +15,7 @@ AC_DEFUN([gl_FUNC_STAT],\n     mingw*)\n       dnl On this platform, the original stat() returns st_atime, st_mtime,\n       dnl st_ctime values that are affected by the time zone.\n-      REPLACE_STAT=1\n+      dnl REPLACE_STAT=1\n       ;;\n     *)\n       dnl AIX 7.1, Solaris 9, mingw64 mistakenly succeed on stat(\"file/\")."
    },
    {
      "sha": "adf9638858da85acb1630e66eaef90f9fddc031c",
      "filename": "gnulib/patches/0001-use-windows-stat",
      "status": "added",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/patches/0001-use-windows-stat",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/patches/0001-use-windows-stat",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/patches/0001-use-windows-stat?ref=d706b69e48268ccf3e95fd29b5374ac94c3a507b",
      "patch": "@@ -0,0 +1,13 @@\n+diff --git a/gnulib/import/m4/stat.m4 b/gnulib/import/m4/stat.m4\n+index 46e9abceee7..8ef355f9407 100644\n+--- a/gnulib/import/m4/stat.m4\n++++ b/gnulib/import/m4/stat.m4\n+@@ -15,7 +15,7 @@ AC_DEFUN([gl_FUNC_STAT],\n+     mingw*)\n+       dnl On this platform, the original stat() returns st_atime, st_mtime,\n+       dnl st_ctime values that are affected by the time zone.\n+-      REPLACE_STAT=1\n++      dnl REPLACE_STAT=1\n+       ;;\n+     *)\n+       dnl AIX 7.1, Solaris 9, mingw64 mistakenly succeed on stat(\"file/\")."
    },
    {
      "sha": "ac5e3d56a29ca341718c319a74a4ec3aca81baf7",
      "filename": "gnulib/update-gnulib.sh",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/update-gnulib.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d706b69e48268ccf3e95fd29b5374ac94c3a507b/gnulib/update-gnulib.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/update-gnulib.sh?ref=d706b69e48268ccf3e95fd29b5374ac94c3a507b",
      "patch": "@@ -173,6 +173,8 @@ apply_patches ()\n     fi\n }\n \n+apply_patches \"patches/0001-use-windows-stat\"\n+\n # Regenerate all necessary files...\n aclocal &&\n autoconf &&"
    }
  ]
}