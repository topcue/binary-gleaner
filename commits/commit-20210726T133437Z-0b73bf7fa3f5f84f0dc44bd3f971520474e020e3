{
  "sha": "0b73bf7fa3f5f84f0dc44bd3f971520474e020e3",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MGI3M2JmN2ZhM2Y1Zjg0ZjBkYzQ0YmQzZjk3MTUyMDQ3NGUwMjBlMw==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2021-07-26T13:34:37Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2021-07-26T13:34:37Z"
    },
    "message": "Fix the Windows build\n\nThe gdb build was broken on Windows after the patch to change\nget_inferior_cwd.  This patch fixes the build.",
    "tree": {
      "sha": "932a1e939d66d16cb2dfaa1827a76256970c8c82",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/932a1e939d66d16cb2dfaa1827a76256970c8c82"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0b73bf7fa3f5f84f0dc44bd3f971520474e020e3",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0b73bf7fa3f5f84f0dc44bd3f971520474e020e3",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0b73bf7fa3f5f84f0dc44bd3f971520474e020e3",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0b73bf7fa3f5f84f0dc44bd3f971520474e020e3/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "c9bd98593b785d9bf5f39c7aa74ed0226a23b830",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c9bd98593b785d9bf5f39c7aa74ed0226a23b830",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c9bd98593b785d9bf5f39c7aa74ed0226a23b830"
    }
  ],
  "stats": {
    "total": 26,
    "additions": 14,
    "deletions": 12
  },
  "files": [
    {
      "sha": "0c2d55ef67bf7a54a6648ea3c6d557f892f3247f",
      "filename": "gdb/windows-nat.c",
      "status": "modified",
      "additions": 11,
      "deletions": 9,
      "changes": 20,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0b73bf7fa3f5f84f0dc44bd3f971520474e020e3/gdb/windows-nat.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0b73bf7fa3f5f84f0dc44bd3f971520474e020e3/gdb/windows-nat.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/windows-nat.c?ref=0b73bf7fa3f5f84f0dc44bd3f971520474e020e3",
      "patch": "@@ -2553,14 +2553,16 @@ windows_nat_target::create_inferior (const char *exec_file,\n   PROCESS_INFORMATION pi;\n   BOOL ret;\n   DWORD flags = 0;\n-  const char *inferior_tty = current_inferior ()->tty ();\n+  const std::string &inferior_tty = current_inferior ()->tty ();\n \n   if (!exec_file)\n     error (_(\"No executable specified, use `target exec'.\"));\n \n-  const char *inferior_cwd = current_inferior ()->cwd ();\n+  const char *inferior_cwd = current_inferior ()->cwd ().c_str ();\n   std::string expanded_infcwd;\n-  if (inferior_cwd != NULL)\n+  if (*inferior_cwd == '\\0')\n+    inferior_cwd = nullptr;\n+  else\n     {\n       expanded_infcwd = gdb_tilde_expand (inferior_cwd);\n       /* Mirror slashes on inferior's cwd.  */\n@@ -2652,14 +2654,14 @@ windows_nat_target::create_inferior (const char *exec_file,\n       w32_env = NULL;\n     }\n \n-  if (inferior_tty == nullptr)\n+  if (inferior_tty.empty ())\n     tty = ostdin = ostdout = ostderr = -1;\n   else\n     {\n-      tty = open (inferior_tty, O_RDWR | O_NOCTTY);\n+      tty = open (inferior_tty.c_str (), O_RDWR | O_NOCTTY);\n       if (tty < 0)\n \t{\n-\t  print_sys_errmsg (inferior_tty, errno);\n+\t  print_sys_errmsg (inferior_tty.c_str (), errno);\n \t  ostdin = ostdout = ostderr = -1;\n \t}\n       else\n@@ -2725,18 +2727,18 @@ windows_nat_target::create_inferior (const char *exec_file,\n     }\n   /* If not all the standard streams are redirected by the command\n      line, use INFERIOR_TTY for those which aren't.  */\n-  if (inferior_tty != nullptr\n+  if (!inferior_tty.empty ()\n       && !(fd_inp >= 0 && fd_out >= 0 && fd_err >= 0))\n     {\n       SECURITY_ATTRIBUTES sa;\n       sa.nLength = sizeof(sa);\n       sa.lpSecurityDescriptor = 0;\n       sa.bInheritHandle = TRUE;\n-      tty = CreateFileA (inferior_tty, GENERIC_READ | GENERIC_WRITE,\n+      tty = CreateFileA (inferior_tty.c_str (), GENERIC_READ | GENERIC_WRITE,\n \t\t\t 0, &sa, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);\n       if (tty == INVALID_HANDLE_VALUE)\n \twarning (_(\"Warning: Failed to open TTY %s, error %#x.\"),\n-\t\t inferior_tty, (unsigned) GetLastError ());\n+\t\t inferior_tty.c_str (), (unsigned) GetLastError ());\n     }\n   if (redirected || tty != INVALID_HANDLE_VALUE)\n     {"
    },
    {
      "sha": "1e97f91d954eef44a35b92427ec6392f47639a4a",
      "filename": "gdbserver/win32-low.cc",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0b73bf7fa3f5f84f0dc44bd3f971520474e020e3/gdbserver/win32-low.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0b73bf7fa3f5f84f0dc44bd3f971520474e020e3/gdbserver/win32-low.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/win32-low.cc?ref=0b73bf7fa3f5f84f0dc44bd3f971520474e020e3",
      "patch": "@@ -559,7 +559,7 @@ static BOOL\n create_process (const char *program, char *args,\n \t\tDWORD flags, PROCESS_INFORMATION *pi)\n {\n-  const char *inferior_cwd = get_inferior_cwd ();\n+  const std::string &inferior_cwd = get_inferior_cwd ();\n   BOOL ret;\n   size_t argslen, proglen;\n \n@@ -580,9 +580,9 @@ create_process (const char *program, char *args,\n \t\t\tflags,             /* start flags */\n \t\t\tNULL,              /* environment */\n \t\t\t/* current directory */\n-\t\t\t(inferior_cwd == NULL\n+\t\t\t(inferior_cwd.empty ()\n \t\t\t ? NULL\n-\t\t\t : gdb_tilde_expand (inferior_cwd).c_str()),\n+\t\t\t : gdb_tilde_expand (inferior_cwd.c_str ()).c_str()),\n \t\t\t&si,               /* start info */\n \t\t\tpi);               /* proc info */\n "
    }
  ]
}