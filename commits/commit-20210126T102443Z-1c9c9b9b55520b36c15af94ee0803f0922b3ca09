{
  "sha": "1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MWM5YzliOWI1NTUyMGIzNmMxNWFmOTRlZTA4MDNmMDkyMmIzY2EwOQ==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-01-26T00:18:09Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-01-26T10:24:43Z"
    },
    "message": "PR27226, ld.bfd contains huge .rodata section\n\nThis makes it possible to build ld without any compiled-in scripts,\nby setting COMPILE_IN=no in the environment.  pe, beos and pdp11\ntargets didn't support scripts from the file system, with pdp11\nnastily editing the ld/ldscripts file so that the built-in script\ndidn't match.\n\n\tPR 27226\n\t* emulparams/alphavms.sh: Don't set COMPILE_IN.\n\t* emulparams/elf64_ia64_vms.sh: Likewise.\n\t* emulparams/elf64mmix.sh: Likewise.\n\t* emulparams/elf_iamcu.sh: Likewise.\n\t* emulparams/elf_k1om.sh: Likewise.\n\t* emulparams/elf_l1om.sh: Likewise.\n\t* emulparams/mmo.sh: Likewise.\n\t* emulparams/pdp11.sh: Set DATA_SEG_ADDR.\n\t* scripttempl/pdp11.sc: Use it.\n\t* emultempl/pdp11.em: Don't edit .xn script for separate_code,\n\tinstead use .xe script.  Support scripts from file system.\n\t* emultempl/beos.em: Support scripts from file system.\n\t* emultempl/pe.em: Likewise.\n\t* emultempl/pep.em: Likewise.\n\t* testsuite/ld-bootstrap/bootstrap.exp: Make tmpdir/ldscripts link.",
    "tree": {
      "sha": "9f173d24144a20066955dc47b2e69201ab527656",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/9f173d24144a20066955dc47b2e69201ab527656"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a45ef9a30ba53836cbc4ae1e287c20aeb4b349f6",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a45ef9a30ba53836cbc4ae1e287c20aeb4b349f6",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/a45ef9a30ba53836cbc4ae1e287c20aeb4b349f6"
    }
  ],
  "stats": {
    "total": 159,
    "additions": 148,
    "deletions": 11
  },
  "files": [
    {
      "sha": "638f42df990f01c7e884c320a928deab24383aee",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 19,
      "deletions": 0,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -1,3 +1,22 @@\n+2021-01-26  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 27226\n+\t* emulparams/alphavms.sh: Don't set COMPILE_IN.\n+\t* emulparams/elf64_ia64_vms.sh: Likewise.\n+\t* emulparams/elf64mmix.sh: Likewise.\n+\t* emulparams/elf_iamcu.sh: Likewise.\n+\t* emulparams/elf_k1om.sh: Likewise.\n+\t* emulparams/elf_l1om.sh: Likewise.\n+\t* emulparams/mmo.sh: Likewise.\n+\t* emulparams/pdp11.sh: Set DATA_SEG_ADDR.\n+\t* scripttempl/pdp11.sc: Use it.\n+\t* emultempl/pdp11.em: Don't edit .xn script for separate_code,\n+\tinstead use .xe script.  Support scripts from file system.\n+\t* emultempl/beos.em: Support scripts from file system.\n+\t* emultempl/pe.em: Likewise.\n+\t* emultempl/pep.em: Likewise.\n+\t* testsuite/ld-bootstrap/bootstrap.exp: Make tmpdir/ldscripts link.\n+\n 2021-01-25  Fangrui Song  <maskray@google.com>\n \n \tPR ld/27230"
    },
    {
      "sha": "ab69c26e3eb552f018ff83398fb2ef487f8a3a59",
      "filename": "ld/emulparams/alphavms.sh",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/alphavms.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/alphavms.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emulparams/alphavms.sh?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -3,5 +3,4 @@ SCRIPT_NAME=alphavms\n OUTPUT_FORMAT=\"vms-alpha\"\n ARCH=alpha\n \n-COMPILE_IN=yes\n-EXTRA_EM_FILE=vms\n\\ No newline at end of file\n+EXTRA_EM_FILE=vms"
    },
    {
      "sha": "53a6a14d2d476697de783d05d1bfc9be55bb78ee",
      "filename": "ld/emulparams/elf64_ia64_vms.sh",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf64_ia64_vms.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf64_ia64_vms.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emulparams/elf64_ia64_vms.sh?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -3,5 +3,4 @@ SCRIPT_NAME=ia64vms\n OUTPUT_FORMAT=\"elf64-ia64-vms\"\n ARCH=ia64\n \n-COMPILE_IN=yes\n EXTRA_EM_FILE=vms"
    },
    {
      "sha": "fb7c4e31b3e8aaba8da91da4303f81d2a196ac69",
      "filename": "ld/emulparams/elf64mmix.sh",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf64mmix.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf64mmix.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emulparams/elf64mmix.sh?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -16,7 +16,6 @@ DATA_ADDR='DEFINED (__.MMIX.start..data) ? __.MMIX.start..data : 0x2000000000000\n MAXPAGESIZE=\"CONSTANT (MAXPAGESIZE)\"\n ARCH=mmix\n MACHINE=\n-COMPILE_IN=yes\n EXTRA_EM_FILE=mmixelf\n \n # The existence of a symbol __start (or _start) should overrule Main, so"
    },
    {
      "sha": "c1582235eda0faeb6ccbb7f4037a34e07dbffff2",
      "filename": "ld/emulparams/elf_iamcu.sh",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf_iamcu.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf_iamcu.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emulparams/elf_iamcu.sh?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -10,7 +10,6 @@ MAXPAGESIZE=\"CONSTANT (MAXPAGESIZE)\"\n COMMONPAGESIZE=\"CONSTANT (COMMONPAGESIZE)\"\n ARCH=iamcu\n MACHINE=\n-COMPILE_IN=yes\n TEMPLATE_NAME=elf\n EXTRA_EM_FILE=\"elf-x86\"\n GENERATE_SHLIB_SCRIPT=yes"
    },
    {
      "sha": "b27f5ea861afe8e6ef7089d48dd795dd48292f65",
      "filename": "ld/emulparams/elf_k1om.sh",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf_k1om.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf_k1om.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emulparams/elf_k1om.sh?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -11,7 +11,6 @@ MAXPAGESIZE=\"CONSTANT (MAXPAGESIZE)\"\n COMMONPAGESIZE=\"CONSTANT (COMMONPAGESIZE)\"\n ARCH=\"k1om\"\n MACHINE=\n-COMPILE_IN=yes\n TEMPLATE_NAME=elf\n EXTRA_EM_FILE=\"elf-x86\"\n GENERATE_SHLIB_SCRIPT=yes"
    },
    {
      "sha": "70d76829d7b436bc99a08cb5d262f73a11f5259c",
      "filename": "ld/emulparams/elf_l1om.sh",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf_l1om.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/elf_l1om.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emulparams/elf_l1om.sh?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -11,7 +11,6 @@ MAXPAGESIZE=\"CONSTANT (MAXPAGESIZE)\"\n COMMONPAGESIZE=\"CONSTANT (COMMONPAGESIZE)\"\n ARCH=\"l1om\"\n MACHINE=\n-COMPILE_IN=yes\n TEMPLATE_NAME=elf\n EXTRA_EM_FILE=\"elf-x86\"\n GENERATE_SHLIB_SCRIPT=yes"
    },
    {
      "sha": "6bd84d2e396c1eba52215aa6e61d058f15fac4f3",
      "filename": "ld/emulparams/mmo.sh",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/mmo.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/mmo.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emulparams/mmo.sh?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -7,5 +7,4 @@ DATA_ADDR='DEFINED (__.MMIX.start..data) ? __.MMIX.start..data : 0x2000000000000\n OUTPUT_FORMAT=mmo\n RELOCATEABLE_OUTPUT_FORMAT=elf64-mmix\n ARCH=mmix\n-COMPILE_IN=yes\n EXTRA_EM_FILE=mmo"
    },
    {
      "sha": "d79bb8355144be114869ef61b65993362f27b2ec",
      "filename": "ld/emulparams/pdp11.sh",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/pdp11.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emulparams/pdp11.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emulparams/pdp11.sh?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -4,3 +4,8 @@ TEXT_START_ADDR=0\n TARGET_PAGE_SIZE=8192\n EXTRA_EM_FILE=pdp11\n ARCH=pdp11\n+\n+case \"$LD_FLAG\" in\n+  *textonly) DATA_SEG_ADDR=0 ;;\n+  *) DATA_SEG_ADDR=$DATA_ALIGNMENT ;;\n+esac"
    },
    {
      "sha": "fc43ce146771fad0c63714f45fb732becdde9bdb",
      "filename": "ld/emultempl/beos.em",
      "status": "modified",
      "additions": 25,
      "deletions": 0,
      "changes": 25,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emultempl/beos.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emultempl/beos.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/beos.em?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -712,7 +712,11 @@ gld${EMULATION_NAME}_place_orphan (asection *s,\n static char *\n gld_${EMULATION_NAME}_get_script (int *isfile)\n EOF\n+\n+if test x\"$COMPILE_IN\" = xyes\n+then\n # Scripts compiled in.\n+\n # sed commands to quote an ld script as a C string.\n sc=\"-f stringify.sed\"\n \n@@ -734,6 +738,27 @@ echo '  ; else return'                                 >> e${EMULATION_NAME}.c\n sed $sc ldscripts/${EMULATION_NAME}.x                  >> e${EMULATION_NAME}.c\n echo '; }'                                             >> e${EMULATION_NAME}.c\n \n+else\n+# Scripts read from the filesystem.\n+\n+fragment <<EOF\n+{\n+  *isfile = 1;\n+\n+  if (bfd_link_relocatable (&link_info) && config.build_constructors)\n+    return \"ldscripts/${EMULATION_NAME}.xu\";\n+  else if (bfd_link_relocatable (&link_info))\n+    return \"ldscripts/${EMULATION_NAME}.xr\";\n+  else if (!config.text_read_only)\n+    return \"ldscripts/${EMULATION_NAME}.xbn\";\n+  else if (!config.magic_demand_paged)\n+    return \"ldscripts/${EMULATION_NAME}.xn\";\n+  else\n+    return \"ldscripts/${EMULATION_NAME}.x\";\n+}\n+EOF\n+fi\n+\n fragment <<EOF\n \n "
    },
    {
      "sha": "6a3cacb37038c5bccc989cd21b09fc75fb69b379",
      "filename": "ld/emultempl/pdp11.em",
      "status": "modified",
      "additions": 28,
      "deletions": 2,
      "changes": 30,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emultempl/pdp11.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emultempl/pdp11.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/pdp11.em?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -94,7 +94,11 @@ gld${EMULATION_NAME}_handle_option (int optc)\n static char *\n gld${EMULATION_NAME}_get_script (int *isfile)\n EOF\n+\n+if test x\"$COMPILE_IN\" = xyes\n+then\n # Scripts compiled in.\n+\n # sed commands to quote an ld script as a C string.\n sc=\"-f stringify.sed\"\n \n@@ -109,8 +113,7 @@ sed $sc ldscripts/${EMULATION_NAME}.xu\t\t\t>> e${EMULATION_NAME}.c\n echo '  ; else if (bfd_link_relocatable (&link_info)) return' >> e${EMULATION_NAME}.c\n sed $sc ldscripts/${EMULATION_NAME}.xr\t\t\t>> e${EMULATION_NAME}.c\n echo '  ; else if (link_info.separate_code) return'\t>> e${EMULATION_NAME}.c\n-sed $sc ldscripts/${EMULATION_NAME}.xn | \\\n-  sed -e \"s/ALIGN($TARGET_PAGE_SIZE)/0/\"\t\t>> e${EMULATION_NAME}.c\n+sed $sc ldscripts/${EMULATION_NAME}.xe\t\t\t>> e${EMULATION_NAME}.c\n echo '  ; else if (!config.text_read_only) return'\t>> e${EMULATION_NAME}.c\n sed $sc ldscripts/${EMULATION_NAME}.xbn\t\t\t>> e${EMULATION_NAME}.c\n echo '  ; else if (!config.magic_demand_paged) return'\t>> e${EMULATION_NAME}.c\n@@ -119,6 +122,29 @@ echo '  ; else return'\t\t\t\t\t>> e${EMULATION_NAME}.c\n sed $sc ldscripts/${EMULATION_NAME}.x\t\t\t>> e${EMULATION_NAME}.c\n echo '; }'\t\t\t\t\t\t>> e${EMULATION_NAME}.c\n \n+else\n+# Scripts read from the filesystem.\n+\n+fragment <<EOF\n+{\n+  *isfile = 1;\n+\n+  if (bfd_link_relocatable (&link_info) && config.build_constructors)\n+    return \"ldscripts/${EMULATION_NAME}.xu\";\n+  else if (bfd_link_relocatable (&link_info))\n+    return \"ldscripts/${EMULATION_NAME}.xr\";\n+  else if (link_info.separate_code)\n+    return \"ldscripts/${EMULATION_NAME}.xe\";\n+  else if (!config.text_read_only)\n+    return \"ldscripts/${EMULATION_NAME}.xbn\";\n+  else if (!config.magic_demand_paged)\n+    return \"ldscripts/${EMULATION_NAME}.xn\";\n+  else\n+    return \"ldscripts/${EMULATION_NAME}.x\";\n+}\n+EOF\n+fi\n+\n fragment <<EOF\n \n /* --- \\end{pdp11.em} */"
    },
    {
      "sha": "748a6b494128e140c846e8a6d550f40c6c0c452a",
      "filename": "ld/emultempl/pe.em",
      "status": "modified",
      "additions": 34,
      "deletions": 0,
      "changes": 34,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emultempl/pe.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emultempl/pe.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/pe.em?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -2355,7 +2355,11 @@ gld_${EMULATION_NAME}_find_potential_libraries\n static char *\n gld_${EMULATION_NAME}_get_script (int *isfile)\n EOF\n+\n+if test x\"$COMPILE_IN\" = xyes\n+then\n # Scripts compiled in.\n+\n # sed commands to quote an ld script as a C string.\n sc=\"-f stringify.sed\"\n \n@@ -2381,6 +2385,36 @@ echo '  ; else return'\t\t\t\t\t>> e${EMULATION_NAME}.c\n sed $sc ldscripts/${EMULATION_NAME}.x\t\t\t>> e${EMULATION_NAME}.c\n echo '; }'\t\t\t\t\t\t>> e${EMULATION_NAME}.c\n \n+else\n+# Scripts read from the filesystem.\n+\n+fragment <<EOF\n+{\n+  *isfile = 1;\n+\n+  if (bfd_link_relocatable (&link_info) && config.build_constructors)\n+    return \"ldscripts/${EMULATION_NAME}.xu\";\n+  else if (bfd_link_relocatable (&link_info))\n+    return \"ldscripts/${EMULATION_NAME}.xr\";\n+  else if (!config.text_read_only)\n+    return \"ldscripts/${EMULATION_NAME}.xbn\";\n+  else if (!config.magic_demand_paged)\n+    return \"ldscripts/${EMULATION_NAME}.xn\";\n+EOF\n+if test -n \"$GENERATE_AUTO_IMPORT_SCRIPT\" ; then\n+fragment <<EOF\n+  else if (link_info.pei386_auto_import == 1\n+\t   && (MERGE_RDATA_V2 || link_info.pei386_runtime_pseudo_reloc != 2))\n+    return \"ldscripts/${EMULATION_NAME}.xa\";\n+EOF\n+fi\n+fragment <<EOF\n+  else\n+    return \"ldscripts/${EMULATION_NAME}.x\";\n+}\n+EOF\n+fi\n+\n fragment <<EOF\n \n "
    },
    {
      "sha": "ff49c15c002af126beb20fa4a18577e0f7f0084f",
      "filename": "ld/emultempl/pep.em",
      "status": "modified",
      "additions": 34,
      "deletions": 0,
      "changes": 34,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emultempl/pep.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/emultempl/pep.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/pep.em?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -2175,7 +2175,11 @@ gld_${EMULATION_NAME}_find_potential_libraries\n static char *\n gld_${EMULATION_NAME}_get_script (int *isfile)\n EOF\n+\n+if test x\"$COMPILE_IN\" = xyes\n+then\n # Scripts compiled in.\n+\n # sed commands to quote an ld script as a C string.\n sc=\"-f stringify.sed\"\n \n@@ -2201,6 +2205,36 @@ echo '  ; else return'\t\t\t\t\t>> e${EMULATION_NAME}.c\n sed $sc ldscripts/${EMULATION_NAME}.x\t\t\t>> e${EMULATION_NAME}.c\n echo '; }'\t\t\t\t\t\t>> e${EMULATION_NAME}.c\n \n+else\n+# Scripts read from the filesystem.\n+\n+fragment <<EOF\n+{\n+  *isfile = 1;\n+\n+  if (bfd_link_relocatable (&link_info) && config.build_constructors)\n+    return \"ldscripts/${EMULATION_NAME}.xu\";\n+  else if (bfd_link_relocatable (&link_info))\n+    return \"ldscripts/${EMULATION_NAME}.xr\";\n+  else if (!config.text_read_only)\n+    return \"ldscripts/${EMULATION_NAME}.xbn\";\n+  else if (!config.magic_demand_paged)\n+    return \"ldscripts/${EMULATION_NAME}.xn\";\n+EOF\n+if test -n \"$GENERATE_AUTO_IMPORT_SCRIPT\" ; then\n+fragment <<EOF\n+  else if (link_info.pei386_auto_import == 1\n+\t   && link_info.pei386_runtime_pseudo_reloc != 2)\n+    return \"ldscripts/${EMULATION_NAME}.xa\";\n+EOF\n+fi\n+fragment <<EOF\n+  else\n+    return \"ldscripts/${EMULATION_NAME}.x\";\n+}\n+EOF\n+fi\n+\n fragment <<EOF\n \n "
    },
    {
      "sha": "8605ae7b7934970f229a6fae19dd50b11cd7b5df",
      "filename": "ld/scripttempl/pdp11.sc",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/scripttempl/pdp11.sc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/scripttempl/pdp11.sc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/scripttempl/pdp11.sc?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -35,7 +35,7 @@ SECTIONS\n     ${RELOCATING+__etext = .;}\n     ${PAD_TEXT+${RELOCATING+. = ${DATA_ALIGNMENT};}}\n   }\n-  ${RELOCATING+. = ${DATA_ALIGNMENT};}\n+  ${RELOCATING+. = ${DATA_SEG_ADDR};}\n   .data :\n   {\n     *(.data)"
    },
    {
      "sha": "2e4a09704ab0961d8979146ba496f0935ac8e283",
      "filename": "ld/testsuite/ld-bootstrap/bootstrap.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/testsuite/ld-bootstrap/bootstrap.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1c9c9b9b55520b36c15af94ee0803f0922b3ca09/ld/testsuite/ld-bootstrap/bootstrap.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-bootstrap/bootstrap.exp?ref=1c9c9b9b55520b36c15af94ee0803f0922b3ca09",
      "patch": "@@ -62,6 +62,7 @@ if { [istarget \"powerpc-*-*\"] } {\n \n set gcc_B_opt_save $gcc_B_opt\n \n+catch \"exec ln -s ../ldscripts tmpdir/ldscripts\" status\n foreach ldexe {ld1 ld2 ld3} {\n     if {![file isdirectory tmpdir/gcc$ldexe]} then {\n \tcatch \"exec mkdir tmpdir/gcc$ldexe\" status"
    }
  ]
}