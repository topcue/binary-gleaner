{
  "sha": "cdeebaab92676c3e433f1d225b304c78ba274fe1",
  "node_id": "C_kwDOANOeidoAKGNkZWViYWFiOTI2NzZjM2U0MzNmMWQyMjViMzA0Yzc4YmEyNzRmZTE",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-10-21T15:48:07Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-10-21T15:48:07Z"
    },
    "message": "[gdb/tui] Fix breakpoint display functionality\n\nIn commit 81e6b8eb208 \"Make tui-winsource not use breakpoint_chain\", a loop\nbody was transformed into a lambda function body:\n...\n-      for (bp = breakpoint_chain;\n-           bp != NULL;\n-           bp = bp->next)\n+      iterate_over_breakpoints ([&] (breakpoint *bp) -> bool\n...\nand consequently:\n- a continue was replaced by a return, and\n- a final return was added.\n\nThen in commit 240edef62f0 \"gdb: remove iterate_over_breakpoints function\", we\ntransformed back to a loop body:\n...\n-      iterate_over_breakpoints ([&] (breakpoint *bp) -> bool\n+      for (breakpoint *bp : all_breakpoints ())\n...\nbut without reverting the changes that introduced the two returns.\n\nConsequently, breakpoints no longer show up in the tui source window.\n\nFix this by reverting the changes that introduced the two returns.\n\nBuild on x86_64-linux, tested with all .exp test-cases that contain\ntuiterm_env.\n\nBug: https://sourceware.org/bugzilla/show_bug.cgi?id=28483",
    "tree": {
      "sha": "21be851a2345906f47fbcd9c8f6f394ff0f5e624",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/21be851a2345906f47fbcd9c8f6f394ff0f5e624"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/cdeebaab92676c3e433f1d225b304c78ba274fe1",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cdeebaab92676c3e433f1d225b304c78ba274fe1",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/cdeebaab92676c3e433f1d225b304c78ba274fe1",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cdeebaab92676c3e433f1d225b304c78ba274fe1/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e3e4224e79906a518a1446049de9924a60d05e7c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e3e4224e79906a518a1446049de9924a60d05e7c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e3e4224e79906a518a1446049de9924a60d05e7c"
    }
  ],
  "stats": {
    "total": 40,
    "additions": 38,
    "deletions": 2
  },
  "files": [
    {
      "sha": "de4821c570ab3171c49e4658ab326a39441b8f75",
      "filename": "gdb/testsuite/gdb.tui/break.exp",
      "status": "added",
      "additions": 37,
      "deletions": 0,
      "changes": 37,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cdeebaab92676c3e433f1d225b304c78ba274fe1/gdb/testsuite/gdb.tui/break.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cdeebaab92676c3e433f1d225b304c78ba274fe1/gdb/testsuite/gdb.tui/break.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/break.exp?ref=cdeebaab92676c3e433f1d225b304c78ba274fe1",
      "patch": "@@ -0,0 +1,37 @@\n+# Copyright 2021 Free Software Foundation, Inc.\n+\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+# Verify that breakpoint marker is shown.\n+\n+tuiterm_env\n+\n+standard_testfile tui-layout.c\n+\n+if {[build_executable \"failed to prepare\" ${testfile} ${srcfile}] == -1} {\n+    return -1\n+}\n+\n+Term::clean_restart 24 80 $testfile\n+if {![Term::enter_tui]} {\n+    unsupported \"TUI not supported\"\n+    return\n+}\n+\n+set text [Term::get_all_lines]\n+gdb_assert {![string match \"No Source Available\" $text]} \\\n+    \"initial source listing\"\n+\n+Term::command \"b main\"\n+Term::check_contents \"break marker present\" \"\\\\|b\\\\+\""
    },
    {
      "sha": "955b68901fe6c33c43b5ab7ee30313f36f5203d0",
      "filename": "gdb/tui/tui-winsource.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cdeebaab92676c3e433f1d225b304c78ba274fe1/gdb/tui/tui-winsource.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cdeebaab92676c3e433f1d225b304c78ba274fe1/gdb/tui/tui-winsource.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-winsource.c?ref=cdeebaab92676c3e433f1d225b304c78ba274fe1",
      "patch": "@@ -460,7 +460,7 @@ tui_source_window_base::update_breakpoint_info\n       for (breakpoint *bp : all_breakpoints ())\n \t{\n \t  if (bp == being_deleted)\n-\t    return false;\n+\t    continue;\n \n \t  for (bp_location *loc : bp->locations ())\n \t    {\n@@ -478,7 +478,6 @@ tui_source_window_base::update_breakpoint_info\n \t\t    mode |= TUI_BP_HARDWARE;\n \t\t}\n \t    }\n-\t  return false;\n \t}\n \n       if (line->break_mode != mode)"
    }
  ]
}