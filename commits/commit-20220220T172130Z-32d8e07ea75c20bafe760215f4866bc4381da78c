{
  "sha": "32d8e07ea75c20bafe760215f4866bc4381da78c",
  "node_id": "C_kwDOANOeidoAKDMyZDhlMDdlYTc1YzIwYmFmZTc2MDIxNWY0ODY2YmM0MzgxZGE3OGM",
  "commit": {
    "author": {
      "name": "Lancelot SIX",
      "email": "lancelot.six@amd.com",
      "date": "2022-02-17T09:25:59Z"
    },
    "committer": {
      "name": "Lancelot SIX",
      "email": "lancelot.six@amd.com",
      "date": "2022-02-20T17:21:30Z"
    },
    "message": "gdb: Only paginate for filtered output in fputs_maybe_filtered\n\nA\u202fhave had situation where a unfiltered output (done using\nfputs_unfiltered) ended up triggering pagination.  The backtrace for this was:\n\n    ...\n    #24 0x000055839377ee4e in check_async_event_handlers () at ../../gdb/async-event.c:335\n    #25 0x0000558394b67b57 in gdb_do_one_event () at ../../gdbsupport/event-loop.cc:216\n    #26 0x0000558394587454 in gdb_readline_wrapper (prompt=0x7ffd907712d0 \"--Type <RET> for more, q to quit, c to continue without paging--\") at ../../gdb/top.c:1148\n    #27 0x0000558394707270 in prompt_for_continue () at ../../gdb/utils.c:1438\n    #28 0x00005583947088b3 in fputs_maybe_filtered (linebuffer=0x60c0000f4000 \"   [...quite big message...]\", stream=0x60300028e9d0, filter=0) at ../../gdb/utils.c:1752\n    #29 0x0000558394708e57 in fputs_unfiltered (linebuffer=0x60c0000f4000 \"   [...quite big message...]\", stream=0x60300028e9d0) at ../../gdb/utils.c:1811\n    ...\n\nThis comes from what appears to be a oversight in fputs_maybe_filtered.  This\nfunction has a FILTER parameter which if true makes the function pause after\nevery screenful (i.e. triggers pagination).\n\nThe filter parameter is correctly used to guard the first place where\nprompt_for_continue.  There is a second place in the function which can call\nprompt_for_continue, but is currently unguarded.  I believe that this is an\noversight, this patch fixes that.\n\nTested on Linux-x86_64, no regression observed.\n\nChange-Id: Iad8ffd50a87cf20077500878e2564b5a7dc81ece",
    "tree": {
      "sha": "ed2b25de8b214e46e693dbeb5750160ec7f8338b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/ed2b25de8b214e46e693dbeb5750160ec7f8338b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/32d8e07ea75c20bafe760215f4866bc4381da78c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/32d8e07ea75c20bafe760215f4866bc4381da78c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/32d8e07ea75c20bafe760215f4866bc4381da78c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/32d8e07ea75c20bafe760215f4866bc4381da78c/comments",
  "author": {
    "login": "lancesix",
    "id": 98881381,
    "node_id": "U_kgDOBeTPZQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/98881381?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lancesix",
    "html_url": "https://github.com/lancesix",
    "followers_url": "https://api.github.com/users/lancesix/followers",
    "following_url": "https://api.github.com/users/lancesix/following{/other_user}",
    "gists_url": "https://api.github.com/users/lancesix/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lancesix/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lancesix/subscriptions",
    "organizations_url": "https://api.github.com/users/lancesix/orgs",
    "repos_url": "https://api.github.com/users/lancesix/repos",
    "events_url": "https://api.github.com/users/lancesix/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lancesix/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "lancesix",
    "id": 98881381,
    "node_id": "U_kgDOBeTPZQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/98881381?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lancesix",
    "html_url": "https://github.com/lancesix",
    "followers_url": "https://api.github.com/users/lancesix/followers",
    "following_url": "https://api.github.com/users/lancesix/following{/other_user}",
    "gists_url": "https://api.github.com/users/lancesix/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lancesix/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lancesix/subscriptions",
    "organizations_url": "https://api.github.com/users/lancesix/orgs",
    "repos_url": "https://api.github.com/users/lancesix/repos",
    "events_url": "https://api.github.com/users/lancesix/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lancesix/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d65aab93df9fa9010d2f7a2cd3f9ab07e0ac5f19",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d65aab93df9fa9010d2f7a2cd3f9ab07e0ac5f19",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d65aab93df9fa9010d2f7a2cd3f9ab07e0ac5f19"
    }
  ],
  "stats": {
    "total": 3,
    "additions": 2,
    "deletions": 1
  },
  "files": [
    {
      "sha": "505a88aa1cd451f1cc0561f53d110714903d7c77",
      "filename": "gdb/utils.c",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/32d8e07ea75c20bafe760215f4866bc4381da78c/gdb/utils.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/32d8e07ea75c20bafe760215f4866bc4381da78c/gdb/utils.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/utils.c?ref=32d8e07ea75c20bafe760215f4866bc4381da78c",
      "patch": "@@ -1744,7 +1744,8 @@ fputs_maybe_filtered (const char *linebuffer, struct ui_file *stream,\n \t      /* Possible new page.  Note that\n \t\t PAGINATION_DISABLED_FOR_COMMAND might be set during\n \t\t this loop, so we must continue to check it here.  */\n-\t      if (lines_printed >= lines_per_page - 1\n+\t      if (filter\n+\t\t  && lines_printed >= lines_per_page - 1\n \t\t  && !pagination_disabled_for_command)\n \t\t{\n \t\t  prompt_for_continue ();"
    }
  ]
}