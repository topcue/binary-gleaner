{
  "sha": "2c75ccb24cec32180e057aade6bd9141296860e0",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MmM3NWNjYjI0Y2VjMzIxODBlMDU3YWFkZTZiZDkxNDEyOTY4NjBlMA==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2020-10-20T11:38:42Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2020-12-23T20:53:14Z"
    },
    "message": "gdb: avoid accessing global C++ language implementation functions\n\nThe function c_printchar is called from two places; it provides the\nimplementation of language_defn::printchar and it is called from\ndwarf2_compute_name.\n\nIt would be nice to rename c_printchar as language_defn::printchar and\nso avoid the trampoline.\n\nTo achieve this, instead of calling c_printchar directly from the\nDWARF code, I lookup the C++ language object and call the printchar\nmember function.\n\nIn a later commit I can then rename c_printchar.\n\nThere should be no user visible changes after this commit.\n\ngdb/ChangeLog:\n\n\t* dwarf2/read.c (dwarf2_compute_name): Call methods on C++\n\tlanguage object instead of calling global functions directly.",
    "tree": {
      "sha": "c61eba8249f1c31268ecc38f59230c7d43f2ece5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c61eba8249f1c31268ecc38f59230c7d43f2ece5"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/2c75ccb24cec32180e057aade6bd9141296860e0",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2c75ccb24cec32180e057aade6bd9141296860e0",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/2c75ccb24cec32180e057aade6bd9141296860e0",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2c75ccb24cec32180e057aade6bd9141296860e0/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "016382f8a43a59eca49f68c7d8b8058f64eaf40f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/016382f8a43a59eca49f68c7d8b8058f64eaf40f",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/016382f8a43a59eca49f68c7d8b8058f64eaf40f"
    }
  ],
  "stats": {
    "total": 12,
    "additions": 9,
    "deletions": 3
  },
  "files": [
    {
      "sha": "9acbae8b8994590fe7bdf29485261d274bcb93bd",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2c75ccb24cec32180e057aade6bd9141296860e0/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2c75ccb24cec32180e057aade6bd9141296860e0/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=2c75ccb24cec32180e057aade6bd9141296860e0",
      "patch": "@@ -1,3 +1,8 @@\n+2020-12-23  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* dwarf2/read.c (dwarf2_compute_name): Call methods on C++\n+\tlanguage object instead of calling global functions directly.\n+\n 2020-12-23  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* valprint.c (print_char_chars): Delete definition."
    },
    {
      "sha": "5f8d8705e799c7c14c01fa449cef739f449aac4f",
      "filename": "gdb/dwarf2/read.c",
      "status": "modified",
      "additions": 4,
      "deletions": 3,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2c75ccb24cec32180e057aade6bd9141296860e0/gdb/dwarf2/read.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2c75ccb24cec32180e057aade6bd9141296860e0/gdb/dwarf2/read.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/dwarf2/read.c?ref=2c75ccb24cec32180e057aade6bd9141296860e0",
      "patch": "@@ -10549,6 +10549,7 @@ dwarf2_compute_name (const char *name,\n \t      struct attribute *attr;\n \t      struct die_info *child;\n \t      int first = 1;\n+\t      const language_defn *cplus_lang = language_def (cu->language);\n \n \t      die->building_fullname = 1;\n \n@@ -10583,8 +10584,8 @@ dwarf2_compute_name (const char *name,\n \n \t\t  if (child->tag == DW_TAG_template_type_param)\n \t\t    {\n-\t\t      c_print_type (type, \"\", &buf, -1, 0, cu->language,\n-\t\t\t\t    &type_print_raw_options);\n+\t\t      cplus_lang->print_type (type, \"\", &buf, -1, 0,\n+\t\t\t\t\t      &type_print_raw_options);\n \t\t      continue;\n \t\t    }\n \n@@ -10604,7 +10605,7 @@ dwarf2_compute_name (const char *name,\n \t\t  if (type->has_no_signedness ())\n \t\t    /* GDB prints characters as NUMBER 'CHAR'.  If that's\n \t\t       changed, this can use value_print instead.  */\n-\t\t    c_printchar (value, type, &buf);\n+\t\t    cplus_lang->printchar (value, type, &buf);\n \t\t  else\n \t\t    {\n \t\t      struct value_print_options opts;"
    }
  ]
}