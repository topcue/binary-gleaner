{
  "sha": "7c392d1de1400202eb86f7679628c4b7c14f8108",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6N2MzOTJkMWRlMTQwMDIwMmViODZmNzY3OTYyOGM0YjdjMTRmODEwOA==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-01-04T21:35:02Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-01-11T19:24:03Z"
    },
    "message": "Make TUI borders respect \"set style enabled\"\n\nWhen adding support for styling the TUI borders, I neglected to have\nthis code check cli_styling.  As a result, \"set style enabled off\"\ndoes not affect the borders.\n\nThis patch fixes this oversight.  While doing this, I found that\nrunning gdb without an executable, enabling the TUI, and then trying\n\"set style enabled off\" would fail with the mysterious \"No registers\".\nThe fix for this is to use deprecated_safe_get_selected_frame in\ntui_source_window_base::refill.\n\ngdb/ChangeLog\n2020-01-11  Tom Tromey  <tom@tromey.com>\n\n\t* tui/tui-wingeneral.c (box_win): Check cli_styling.\n\t* tui/tui-winsource.c (tui_source_window_base::refill): Use\n\tdeprecated_safe_get_selected_frame.\n\nChange-Id: I36acda25dd9014d994d366b4a0e8faee9d95d0f8",
    "tree": {
      "sha": "ec0d6e501239764317bfeffd2020997254b70bec",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/ec0d6e501239764317bfeffd2020997254b70bec"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/7c392d1de1400202eb86f7679628c4b7c14f8108",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7c392d1de1400202eb86f7679628c4b7c14f8108",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/7c392d1de1400202eb86f7679628c4b7c14f8108",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7c392d1de1400202eb86f7679628c4b7c14f8108/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ef96a356b87730e05257297ad853ae4225c90c61",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ef96a356b87730e05257297ad853ae4225c90c61",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/ef96a356b87730e05257297ad853ae4225c90c61"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 15,
    "deletions": 4
  },
  "files": [
    {
      "sha": "735c46bf70534707f0274db8f1f5a42e6d2cd36f",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7c392d1de1400202eb86f7679628c4b7c14f8108/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7c392d1de1400202eb86f7679628c4b7c14f8108/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=7c392d1de1400202eb86f7679628c4b7c14f8108",
      "patch": "@@ -1,3 +1,9 @@\n+2020-01-11  Tom Tromey  <tom@tromey.com>\n+\n+\t* tui/tui-wingeneral.c (box_win): Check cli_styling.\n+\t* tui/tui-winsource.c (tui_source_window_base::refill): Use\n+\tdeprecated_safe_get_selected_frame.\n+\n 2020-01-10  Tankut Baris Aktemur  <tankut.baris.aktemur@intel.com>\n \n \t* inferior.c (print_inferior): Switch inferior before printing it."
    },
    {
      "sha": "0a9fc5238d6121ca59a772bd8f5cb656a4774310",
      "filename": "gdb/tui/tui-wingeneral.c",
      "status": "modified",
      "additions": 4,
      "deletions": 3,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7c392d1de1400202eb86f7679628c4b7c14f8108/gdb/tui/tui-wingeneral.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7c392d1de1400202eb86f7679628c4b7c14f8108/gdb/tui/tui-wingeneral.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-wingeneral.c?ref=7c392d1de1400202eb86f7679628c4b7c14f8108",
      "patch": "@@ -55,9 +55,10 @@ box_win (struct tui_win_info *win_info,\n \n   /* tui_apply_style resets the style entirely, so be sure to call it\n      before applying ATTRS.  */\n-  tui_apply_style (win, (highlight_flag\n-\t\t\t ? tui_active_border_style.style ()\n-\t\t\t : tui_border_style.style ()));\n+  if (cli_styling)\n+    tui_apply_style (win, (highlight_flag\n+\t\t\t   ? tui_active_border_style.style ()\n+\t\t\t   : tui_border_style.style ()));\n   wattron (win, attrs);\n #ifdef HAVE_WBORDER\n   wborder (win, tui_border_vline, tui_border_vline,"
    },
    {
      "sha": "fbee2e3e1813bc8acbcc393f9a704bb1d5230406",
      "filename": "gdb/tui/tui-winsource.c",
      "status": "modified",
      "additions": 5,
      "deletions": 1,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7c392d1de1400202eb86f7679628c4b7c14f8108/gdb/tui/tui-winsource.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7c392d1de1400202eb86f7679628c4b7c14f8108/gdb/tui/tui-winsource.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-winsource.c?ref=7c392d1de1400202eb86f7679628c4b7c14f8108",
      "patch": "@@ -352,7 +352,11 @@ tui_source_window_base::refill ()\n     {\n       sal = get_current_source_symtab_and_line ();\n       if (sal.symtab == NULL)\n-\tsal = find_pc_line (get_frame_pc (get_selected_frame (NULL)), 0);\n+\t{\n+\t  struct frame_info *fi = deprecated_safe_get_selected_frame ();\n+\t  if (fi != nullptr)\n+\t    sal = find_pc_line (get_frame_pc (fi), 0);\n+\t}\n     }\n \n   if (sal.pspace == nullptr)"
    }
  ]
}