{
  "sha": "18c77628b1e97e412561029ec20195c1ffa61b2d",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MThjNzc2MjhiMWU5N2U0MTI1NjEwMjllYzIwMTk1YzFmZmE2MWIyZA==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2019-03-21T12:25:47Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2019-03-26T18:23:49Z"
    },
    "message": "gdb: Avoid trailing whitespace when pretty printing\n\nWhile writing a new test for 'set print pretty on' I spotted that GDB\nwill sometimes add a trailing whitespace character when pretty\nprinting.  This commit removes the trailing whitespace and updates the\nexpected results in one tests where this was an issue.\n\nI've added an extra test for 'set print pretty on' as it doesn't seem\nto have much testing.\n\ngdb/ChangeLog:\n\n\t* cp-valprint.c (cp_print_value_fields): Don't print trailing\n\twhitespace when pretty printing is on.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.base/finish-pretty.exp: Update expected results.\n\t* gdb.base/pretty-print.c: New file.\n\t* gdb.base/pretty-print.exp: New file.",
    "tree": {
      "sha": "6c79f1c4d04742d7a5380a3821de691f35647b6a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6c79f1c4d04742d7a5380a3821de691f35647b6a"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/18c77628b1e97e412561029ec20195c1ffa61b2d",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/18c77628b1e97e412561029ec20195c1ffa61b2d",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/18c77628b1e97e412561029ec20195c1ffa61b2d",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/18c77628b1e97e412561029ec20195c1ffa61b2d/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "53c973f200e39c4122e0db06a94e3a0079e6de80",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/53c973f200e39c4122e0db06a94e3a0079e6de80",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/53c973f200e39c4122e0db06a94e3a0079e6de80"
    }
  ],
  "stats": {
    "total": 132,
    "additions": 129,
    "deletions": 3
  },
  "files": [
    {
      "sha": "a31cf7041f294f4ad54ff5558124ac47e658c405",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=18c77628b1e97e412561029ec20195c1ffa61b2d",
      "patch": "@@ -1,3 +1,8 @@\n+2019-03-26  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* cp-valprint.c (cp_print_value_fields): Don't print trailing\n+\twhitespace when pretty printing is on.\n+\n 2019-03-26  Alan Hayward  <alan.hayward@arm.com>\n \n         * ppc-linux-nat.c: Add include."
    },
    {
      "sha": "443c3b06dac8986e5b07774d053eb75b2d92dc25",
      "filename": "gdb/cp-valprint.c",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/cp-valprint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/cp-valprint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/cp-valprint.c?ref=18c77628b1e97e412561029ec20195c1ffa61b2d",
      "patch": "@@ -235,7 +235,11 @@ cp_print_value_fields (struct type *type, struct type *real_type,\n \t    continue;\n \n \t  if (fields_seen)\n-\t    fprintf_filtered (stream, \", \");\n+\t    {\n+\t      fputs_filtered (\",\", stream);\n+\t      if (!options->prettyformat)\n+\t\tfputs_filtered (\" \", stream);\n+\t    }\n \t  else if (n_baseclasses > 0)\n \t    {\n \t      if (options->prettyformat)\n@@ -244,7 +248,7 @@ cp_print_value_fields (struct type *type, struct type *real_type,\n \t\t  print_spaces_filtered (2 + 2 * recurse, stream);\n \t\t  fputs_filtered (\"members of \", stream);\n \t\t  fputs_filtered (TYPE_NAME (type), stream);\n-\t\t  fputs_filtered (\": \", stream);\n+\t\t  fputs_filtered (\":\", stream);\n \t\t}\n \t    }\n \t  fields_seen = 1;"
    },
    {
      "sha": "a2b8f2428520948b0b05eca6758e49f180abe92f",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=18c77628b1e97e412561029ec20195c1ffa61b2d",
      "patch": "@@ -1,3 +1,9 @@\n+2019-03-26  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* gdb.base/finish-pretty.exp: Update expected results.\n+\t* gdb.base/pretty-print.c: New file.\n+\t* gdb.base/pretty-print.exp: New file.\n+\n 2019-03-25  Pedro Alves  <palves@redhat.com>\n \n \t* lib/gdb.exp (gdb_test_multiple): Split appends to $code and"
    },
    {
      "sha": "b1530cda59112c6832a042c62257222c197f8e37",
      "filename": "gdb/testsuite/gdb.base/finish-pretty.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/testsuite/gdb.base/finish-pretty.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/testsuite/gdb.base/finish-pretty.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/finish-pretty.exp?ref=18c77628b1e97e412561029ec20195c1ffa61b2d",
      "patch": "@@ -30,7 +30,7 @@ proc finish_pretty { } {\n     gdb_test_no_output \"set print pretty\" \\\n \t\"pretty printing switched on\"\n     gdb_test \"finish\" \\\n-\t{.*Value returned is \\$1 = \\{\\r\\n  a = 1, \\r\\n  b = 2\\r\\n\\}} \\\n+\t{.*Value returned is \\$1 = \\{\\r\\n  a = 1,\\r\\n  b = 2\\r\\n\\}} \\\n \t\"finish foo prettyprinted function result\"\n }\n "
    },
    {
      "sha": "9e241f8c678016da4b0b7e05d8dd7c84f784035e",
      "filename": "gdb/testsuite/gdb.base/pretty-print.c",
      "status": "added",
      "additions": 53,
      "deletions": 0,
      "changes": 53,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/testsuite/gdb.base/pretty-print.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/testsuite/gdb.base/pretty-print.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/pretty-print.c?ref=18c77628b1e97e412561029ec20195c1ffa61b2d",
      "patch": "@@ -0,0 +1,53 @@\n+/* This testcase is part of GDB, the GNU debugger.\n+\n+   Copyright 2019 Free Software Foundation, Inc.\n+\n+   This program is free software; you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n+\n+struct s1_t\n+{\n+  int one;\n+  int two;\n+\n+  struct\n+  {\n+    union {\n+      int three : 3;\n+      int four : 4;\n+    };\n+\n+    union {\n+      int five : 3;\n+      int six : 4;\n+    };\n+  } data;\n+} s1 = { .one = 1, .two = 2, .data = { .three = 3, .five = 5 } };\n+\n+struct s2_t\n+{\n+  int one;\n+  int two;\n+\n+  struct\n+  {\n+    int three;\n+    int four;\n+  };\n+} s2 = { .one = 1, .two = 2, .three = 3, .four = 4 };\n+\n+int\n+main ()\n+{\n+  return 0;\n+}"
    },
    {
      "sha": "91e685e17ca898c13452ec2f5afd37593f5c2e7b",
      "filename": "gdb/testsuite/gdb.base/pretty-print.exp",
      "status": "added",
      "additions": 58,
      "deletions": 0,
      "changes": 58,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/testsuite/gdb.base/pretty-print.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/18c77628b1e97e412561029ec20195c1ffa61b2d/gdb/testsuite/gdb.base/pretty-print.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/pretty-print.exp?ref=18c77628b1e97e412561029ec20195c1ffa61b2d",
      "patch": "@@ -0,0 +1,58 @@\n+# Copyright 2019 Free Software Foundation, Inc.\n+#\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+# Test pretty printing of structures and unions.\n+\n+standard_testfile\n+\n+if {[prepare_for_testing $testfile.exp $testfile $srcfile debug]} {\n+    untested $testfile.exp\n+    return -1\n+}\n+\n+if ![runto_main] {\n+    untested $testfile.exp\n+    return -1\n+}\n+\n+gdb_test_no_output \"set print pretty on\"\n+\n+gdb_test \"print s1\" \\\n+    [multi_line \\\n+\t \" = {\" \\\n+\t \"  one = 1,\" \\\n+\t \"  two = 2,\" \\\n+\t \"  data = {\" \\\n+\t \"    {\" \\\n+\t \"      three = 3,\" \\\n+\t \"      four = 3\" \\\n+\t \"    },\" \\\n+\t \"    {\" \\\n+\t \"      five = -3,\" \\\n+\t \"      six = 5\" \\\n+\t \"    }\" \\\n+\t \"  }\" \\\n+\t \"}\" ]\n+\n+gdb_test \"print s2\" \\\n+    [multi_line \\\n+\t \" = {\" \\\n+\t \"  one = 1,\" \\\n+\t \"  two = 2,\" \\\n+\t \"  {\" \\\n+\t \"    three = 3,\" \\\n+\t \"    four = 4\" \\\n+\t \"  }\" \\\n+\t \"}\" ]"
    }
  ]
}