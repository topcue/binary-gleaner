{
  "sha": "7e8c7130fe59473bcda83fca345907be7c43936b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6N2U4YzcxMzBmZTU5NDczYmNkYTgzZmNhMzQ1OTA3YmU3YzQzOTM2Yg==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2020-10-31T12:30:58Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2020-10-31T12:30:58Z"
    },
    "message": "gdbserver: modernize configure.ac\n\nRun autoupdate on gdbserver/configure.ac and then tweak it to use easier\nto read indentation.  This removes a few warnings when running\n`autoreconf -vf -Wall`.\n\n  * Replace AC_INIT with AC_INIT and no arguments plus AC_CONFIG_SRCDIR.\n  * Replace AC_GNU_SOURCE with AC_USE_SYSTEM_EXTENSIONS.\n  * Replace AC_TRY_COMPILE with AC_COMPILE_IFELSE.\n  * Replace AC_TRY_LINK with AC_LINK_IFELSE.\n\nautoupdate gets it right, except this one here:\n\n    --- a/gdbserver/configure.ac\n    +++ b/gdbserver/configure.ac\n    @@ -304,7 +304,7 @@ if test \"$srv_linux_thread_db\" = \"yes\"; then\n         AC_LINK_IFELSE([AC_LANG_PROGRAM([[]], [[]])],[found=\"-Wl,--dynamic-list\"\n                     RDYNAMIC='-Wl,--dynamic-list=$(srcdir)/proc-service.list'],[RDYNAMIC=\"-rdynamic\"\n                     LDFLAGS=\"$old_LDFLAGS $RDYNAMIC\"\n    -                AC_TRY_LINK([], [],\n    +                _au_m4_changequote([,])AC_TRY_LINK([], [],\n                                 [found=\"-rdynamic\"],\n                                 [found=\"no\"\n                                  RDYNAMIC=\"\"])])\n\n... which I had to convert manually.\n\nThe changes in the generated configure file only contain insignificant\nwhitespace changes, so that gives confidence that the conversion is\ncorrect.\n\ngdbserver/ChangeLog:\n\n\t* configure.ac: Modernize.\n\t* configure: Re-generate.\n\nChange-Id: Ia769aaec2aafac595504f477da955e91dffa4d8f",
    "tree": {
      "sha": "532904594e160fbbdf2fa2d265b9a2fe171497af",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/532904594e160fbbdf2fa2d265b9a2fe171497af"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/7e8c7130fe59473bcda83fca345907be7c43936b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7e8c7130fe59473bcda83fca345907be7c43936b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/7e8c7130fe59473bcda83fca345907be7c43936b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7e8c7130fe59473bcda83fca345907be7c43936b/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e41fda1d5fd0c6751591a547924d5013f267aa80",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e41fda1d5fd0c6751591a547924d5013f267aa80",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e41fda1d5fd0c6751591a547924d5013f267aa80"
    }
  ],
  "stats": {
    "total": 137,
    "additions": 94,
    "deletions": 43
  },
  "files": [
    {
      "sha": "2ee4af03989270f6f6ba512039fbe711629a87d3",
      "filename": "gdbserver/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7e8c7130fe59473bcda83fca345907be7c43936b/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7e8c7130fe59473bcda83fca345907be7c43936b/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/ChangeLog?ref=7e8c7130fe59473bcda83fca345907be7c43936b",
      "patch": "@@ -1,3 +1,8 @@\n+2020-10-31  Simon Marchi  <simon.marchi@polymtl.ca>\n+\n+\t* configure.ac: Modernize.\n+\t* configure: Re-generate.\n+\n 2020-10-31  Simon Marchi  <simon.marchi@polymtl.ca>\n \n \t* configure.ac: Use AC_CANONICAL_{BUILD,HOST,TARGET} instead of"
    },
    {
      "sha": "c91ce71c943e6da5a2d287167a2e0fb989d6034b",
      "filename": "gdbserver/configure",
      "status": "modified",
      "additions": 24,
      "deletions": 9,
      "changes": 33,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7e8c7130fe59473bcda83fca345907be7c43936b/gdbserver/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7e8c7130fe59473bcda83fca345907be7c43936b/gdbserver/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure?ref=7e8c7130fe59473bcda83fca345907be7c43936b",
      "patch": "@@ -2713,6 +2713,7 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu\n \n \n \n+\n ac_config_headers=\"$ac_config_headers config.h:config.in\"\n \n \n@@ -4245,7 +4246,6 @@ $as_echo \"$ac_cv_safe_to_define___extensions__\" >&6; }\n   $as_echo \"#define _TANDEM_SOURCE 1\" >>confdefs.h\n \n \n-\n # Check whether --enable-largefile was given.\n if test \"${enable_largefile+set}\" = set; then :\n   enableval=$enable_largefile;\n@@ -9653,18 +9653,22 @@ int\n main ()\n {\n \n+\n   ;\n   return 0;\n }\n _ACEOF\n if ac_fn_c_try_compile \"$LINENO\"; then :\n   { $as_echo \"$as_me:${as_lineno-$LINENO}: result: yes\" >&5\n $as_echo \"yes\" >&6; };\n+\n $as_echo \"#define HAVE_UST 1\" >>confdefs.h\n \n else\n   { $as_echo \"$as_me:${as_lineno-$LINENO}: result: no\" >&5\n-$as_echo \"no\" >&6; }; ustlibs= ; ustinc=\n+$as_echo \"no\" >&6; }\n+     ustlibs= ; ustinc=\n+\n fi\n rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n   CFLAGS=\"$saved_CFLAGS\"\n@@ -10314,8 +10318,10 @@ if ac_fn_c_try_compile \"$LINENO\"; then :\n   gdbsrv_cv_have_ptrace_getregs=yes\n else\n   gdbsrv_cv_have_ptrace_getregs=no\n+\n fi\n rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+\n fi\n \n   { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gdbsrv_cv_have_ptrace_getregs\" >&5\n@@ -10346,8 +10352,10 @@ if ac_fn_c_try_compile \"$LINENO\"; then :\n   gdbsrv_cv_have_ptrace_getfpxregs=yes\n else\n   gdbsrv_cv_have_ptrace_getfpxregs=no\n+\n fi\n rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+\n fi\n \n   { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gdbsrv_cv_have_ptrace_getfpxregs\" >&5\n@@ -10513,11 +10521,11 @@ main ()\n _ACEOF\n if ac_fn_c_try_link \"$LINENO\"; then :\n   found=\"-Wl,--dynamic-list\"\n-\t\t RDYNAMIC='-Wl,--dynamic-list=$(srcdir)/proc-service.list'\n+       RDYNAMIC='-Wl,--dynamic-list=$(srcdir)/proc-service.list'\n else\n   RDYNAMIC=\"-rdynamic\"\n-\t\t LDFLAGS=\"$old_LDFLAGS $RDYNAMIC\"\n-\t\t cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+       LDFLAGS=\"$old_LDFLAGS $RDYNAMIC\"\n+       cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n \n int\n@@ -10532,10 +10540,12 @@ if ac_fn_c_try_link \"$LINENO\"; then :\n   found=\"-rdynamic\"\n else\n   found=\"no\"\n-\t\t\t      RDYNAMIC=\"\"\n+\t  RDYNAMIC=\"\"\n+\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n     conftest$ac_exeext conftest.$ac_ext\n+\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n     conftest$ac_exeext conftest.$ac_ext\n@@ -10571,8 +10581,10 @@ if ac_fn_c_try_compile \"$LINENO\"; then :\n   gdbsrv_cv_have_td_version=yes\n else\n   gdbsrv_cv_have_td_version=no\n+\n fi\n rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+\n fi\n { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gdbsrv_cv_have_td_version\" >&5\n $as_echo \"$gdbsrv_cv_have_td_version\" >&6; }\n@@ -10619,14 +10631,15 @@ $as_echo_n \"checking whether the target supports __sync_*_compare_and_swap... \"\n if ${gdbsrv_cv_have_sync_builtins+:} false; then :\n   $as_echo_n \"(cached) \" >&6\n else\n-\n-cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n \n int\n main ()\n {\n-int foo, bar; bar = __sync_val_compare_and_swap(&foo, 0, 1);\n+int foo, bar;\n+\t bar = __sync_val_compare_and_swap(&foo, 0, 1);\n+\n   ;\n   return 0;\n }\n@@ -10635,9 +10648,11 @@ if ac_fn_c_try_link \"$LINENO\"; then :\n   gdbsrv_cv_have_sync_builtins=yes\n else\n   gdbsrv_cv_have_sync_builtins=no\n+\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n     conftest$ac_exeext conftest.$ac_ext\n+\n fi\n { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gdbsrv_cv_have_sync_builtins\" >&5\n $as_echo \"$gdbsrv_cv_have_sync_builtins\" >&6; }"
    },
    {
      "sha": "dd646cffa1a3c0586894cee9d0a01c817f17c435",
      "filename": "gdbserver/configure.ac",
      "status": "modified",
      "additions": 65,
      "deletions": 34,
      "changes": 99,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7e8c7130fe59473bcda83fca345907be7c43936b/gdbserver/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7e8c7130fe59473bcda83fca345907be7c43936b/gdbserver/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure.ac?ref=7e8c7130fe59473bcda83fca345907be7c43936b",
      "patch": "@@ -18,14 +18,15 @@ dnl along with this program.  If not, see <http://www.gnu.org/licenses/>.\n \n dnl Process this file with autoconf to produce a configure script.\n \n-AC_INIT(server.cc)\n+AC_INIT\n+AC_CONFIG_SRCDIR([server.cc])\n AC_CONFIG_HEADERS(config.h:config.in, [echo > stamp-h])\n \n AM_MAINTAINER_MODE\n \n AC_PROG_CC\n AC_PROG_CXX\n-AC_GNU_SOURCE\n+AC_USE_SYSTEM_EXTENSIONS\n AC_SYS_LARGEFILE\n AM_PROG_INSTALL_STRIP\n \n@@ -124,12 +125,19 @@ if test \"x$with_ust\" != \"xno\"; then\n   saved_CFLAGS=\"$CFLAGS\"\n   CFLAGS=\"$CFLAGS $ustinc\"\n   AC_MSG_CHECKING([for ust])\n-  AC_TRY_COMPILE([\n+  AC_COMPILE_IFELSE(\n+    [AC_LANG_PROGRAM(\n+       [\n #define CONFIG_UST_GDB_INTEGRATION\n #include <ust/ust.h>\n-  ],[],\n-  [AC_MSG_RESULT([yes]); AC_DEFINE(HAVE_UST, 1, [Define if UST is available])],\n-  [AC_MSG_RESULT([no]); ustlibs= ; ustinc= ])\n+       ],\n+       []\n+     )],\n+    [AC_MSG_RESULT([yes]);\n+     AC_DEFINE(HAVE_UST, 1, [Define if UST is available])],\n+    [AC_MSG_RESULT([no])\n+     ustlibs= ; ustinc= ]\n+  )\n   CFLAGS=\"$saved_CFLAGS\"\n fi\n \n@@ -249,11 +257,14 @@ if test \"${srv_linux_regsets}\" = \"yes\"; then\n \t    [Define if the target supports register sets.])\n \n   AC_MSG_CHECKING(for PTRACE_GETREGS)\n-  AC_CACHE_VAL(gdbsrv_cv_have_ptrace_getregs,\n-  [AC_TRY_COMPILE([#include <sys/ptrace.h>],\n-\t\t  [PTRACE_GETREGS;],\n-\t\t  [gdbsrv_cv_have_ptrace_getregs=yes],\n-\t\t  [gdbsrv_cv_have_ptrace_getregs=no])])\n+  AC_CACHE_VAL(\n+    [gdbsrv_cv_have_ptrace_getregs],\n+    [AC_COMPILE_IFELSE(\n+       [AC_LANG_PROGRAM([#include <sys/ptrace.h>], [PTRACE_GETREGS;])],\n+       [gdbsrv_cv_have_ptrace_getregs=yes],\n+       [gdbsrv_cv_have_ptrace_getregs=no]\n+     )]\n+  )\n   AC_MSG_RESULT($gdbsrv_cv_have_ptrace_getregs)\n   if test \"${gdbsrv_cv_have_ptrace_getregs}\" = \"yes\"; then\n     AC_DEFINE(HAVE_PTRACE_GETREGS, 1,\n@@ -262,11 +273,14 @@ if test \"${srv_linux_regsets}\" = \"yes\"; then\n   fi\n \n   AC_MSG_CHECKING(for PTRACE_GETFPXREGS)\n-  AC_CACHE_VAL(gdbsrv_cv_have_ptrace_getfpxregs,\n-  [AC_TRY_COMPILE([#include <sys/ptrace.h>],\n-\t\t  [PTRACE_GETFPXREGS;],\n-\t\t  [gdbsrv_cv_have_ptrace_getfpxregs=yes],\n-\t\t  [gdbsrv_cv_have_ptrace_getfpxregs=no])])\n+  AC_CACHE_VAL(\n+    [gdbsrv_cv_have_ptrace_getfpxregs],\n+    [AC_COMPILE_IFELSE(\n+       [AC_LANG_PROGRAM([#include <sys/ptrace.h>], [PTRACE_GETFPXREGS;])],\n+       [gdbsrv_cv_have_ptrace_getfpxregs=yes],\n+       [gdbsrv_cv_have_ptrace_getfpxregs=no]\n+     )]\n+  )\n   AC_MSG_RESULT($gdbsrv_cv_have_ptrace_getfpxregs)\n   if test \"${gdbsrv_cv_have_ptrace_getfpxregs}\" = \"yes\"; then\n     AC_DEFINE(HAVE_PTRACE_GETFPXREGS, 1,\n@@ -308,15 +322,19 @@ if test \"$srv_linux_thread_db\" = \"yes\"; then\n     # supported there.\n     RDYNAMIC=\"-Wl,--dynamic-list=${srcdir}/proc-service.list\"\n     LDFLAGS=\"$LDFLAGS $RDYNAMIC\"\n-    AC_TRY_LINK([], [],\n-\t\t[found=\"-Wl,--dynamic-list\"\n-\t\t RDYNAMIC='-Wl,--dynamic-list=$(srcdir)/proc-service.list'],\n-\t\t[RDYNAMIC=\"-rdynamic\"\n-\t\t LDFLAGS=\"$old_LDFLAGS $RDYNAMIC\"\n-\t\t AC_TRY_LINK([], [],\n-\t\t\t     [found=\"-rdynamic\"],\n-\t\t\t     [found=\"no\"\n-\t\t\t      RDYNAMIC=\"\"])])\n+    AC_LINK_IFELSE(\n+      [AC_LANG_PROGRAM([],[])],\n+      [found=\"-Wl,--dynamic-list\"\n+       RDYNAMIC='-Wl,--dynamic-list=$(srcdir)/proc-service.list'],\n+      [RDYNAMIC=\"-rdynamic\"\n+       LDFLAGS=\"$old_LDFLAGS $RDYNAMIC\"\n+       AC_LINK_IFELSE(\n+\t [AC_LANG_PROGRAM([], [])],\n+\t [found=\"-rdynamic\"],\n+\t [found=\"no\"\n+\t  RDYNAMIC=\"\"]\n+       )]\n+    )\n     AC_SUBST(RDYNAMIC)\n     LDFLAGS=\"$old_LDFLAGS\"\n     AC_MSG_RESULT($found)\n@@ -326,10 +344,15 @@ if test \"$srv_linux_thread_db\" = \"yes\"; then\n \n   srv_thread_depfiles=\"thread-db.o proc-service.o\"\n   AC_DEFINE(USE_THREAD_DB, 1, [Define if we should use libthread_db.])\n-  AC_CACHE_CHECK([for TD_VERSION], gdbsrv_cv_have_td_version,\n-  [AC_TRY_COMPILE([#include <thread_db.h>], [TD_VERSION;],\n-\t\t  [gdbsrv_cv_have_td_version=yes],\n-\t\t  [gdbsrv_cv_have_td_version=no])])\n+  AC_CACHE_CHECK(\n+    [for TD_VERSION],\n+    [gdbsrv_cv_have_td_version],\n+    [AC_COMPILE_IFELSE(\n+       [AC_LANG_PROGRAM([#include <thread_db.h>], [TD_VERSION;])],\n+       [gdbsrv_cv_have_td_version=yes],\n+       [gdbsrv_cv_have_td_version=no]\n+     )]\n+  )\n   if test \"$gdbsrv_cv_have_td_version\" = yes; then\n     AC_DEFINE(HAVE_TD_VERSION, 1, [Define if TD_VERSION is available.])\n   fi\n@@ -360,11 +383,19 @@ GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_dep\n GDBSERVER_LIBS=\"$srv_libs\"\n \n dnl Check whether the target supports __sync_*_compare_and_swap.\n-AC_CACHE_CHECK([whether the target supports __sync_*_compare_and_swap],\n-\t\tgdbsrv_cv_have_sync_builtins, [\n-AC_TRY_LINK([], [int foo, bar; bar = __sync_val_compare_and_swap(&foo, 0, 1);],\n-\t\tgdbsrv_cv_have_sync_builtins=yes,\n-\t\tgdbsrv_cv_have_sync_builtins=no)])\n+AC_CACHE_CHECK(\n+  [whether the target supports __sync_*_compare_and_swap],\n+  [gdbsrv_cv_have_sync_builtins],\n+  [AC_LINK_IFELSE(\n+     [AC_LANG_PROGRAM(\n+\t[],\n+\t[int foo, bar;\n+\t bar = __sync_val_compare_and_swap(&foo, 0, 1);]\n+      )],\n+     [gdbsrv_cv_have_sync_builtins=yes],\n+     [gdbsrv_cv_have_sync_builtins=no]\n+   )]\n+)\n if test \"$gdbsrv_cv_have_sync_builtins\" = yes; then\n   AC_DEFINE(HAVE_SYNC_BUILTINS, 1,\n     [Define to 1 if the target supports __sync_*_compare_and_swap])"
    }
  ]
}