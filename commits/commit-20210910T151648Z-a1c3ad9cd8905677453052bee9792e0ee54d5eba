{
  "sha": "a1c3ad9cd8905677453052bee9792e0ee54d5eba",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YTFjM2FkOWNkODkwNTY3NzQ1MzA1MmJlZTk3OTJlMGVlNTRkNWViYQ==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-09-10T15:16:48Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-09-10T15:16:48Z"
    },
    "message": "[gdb/testsuite] Fix DUPLICATE in gdb.base/skip-solib.exp\n\nFix DUPLICATE in gdb.base/skip-solib.exp by using with_test_prefix.\n\nAlso fix indentation style and long lines, remove outdated question/answer\nbits, and use multi_line.",
    "tree": {
      "sha": "44478e208a719ad637f34e2a9b449df4f83a29e9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/44478e208a719ad637f34e2a9b449df4f83a29e9"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/a1c3ad9cd8905677453052bee9792e0ee54d5eba",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a1c3ad9cd8905677453052bee9792e0ee54d5eba",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/a1c3ad9cd8905677453052bee9792e0ee54d5eba",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a1c3ad9cd8905677453052bee9792e0ee54d5eba/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e36788d135499f18ffc7e528c5ac4bd5a560a5b9",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e36788d135499f18ffc7e528c5ac4bd5a560a5b9",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e36788d135499f18ffc7e528c5ac4bd5a560a5b9"
    }
  ],
  "stats": {
    "total": 104,
    "additions": 49,
    "deletions": 55
  },
  "files": [
    {
      "sha": "a66272aeffbe8a3773c46977e8e4bc4229a6e5ab",
      "filename": "gdb/testsuite/gdb.base/skip-solib.exp",
      "status": "modified",
      "additions": 49,
      "deletions": 55,
      "changes": 104,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a1c3ad9cd8905677453052bee9792e0ee54d5eba/gdb/testsuite/gdb.base/skip-solib.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a1c3ad9cd8905677453052bee9792e0ee54d5eba/gdb/testsuite/gdb.base/skip-solib.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/skip-solib.exp?ref=a1c3ad9cd8905677453052bee9792e0ee54d5eba",
      "patch": "@@ -20,7 +20,8 @@\n #\n \n # This only works on GNU/Linux.\n-if { ![isnative] || [is_remote host] || ![istarget *-linux*] || [skip_shlib_tests]} {\n+if { ![isnative] || [is_remote host] || ![istarget *-linux*]\n+     || [skip_shlib_tests]} {\n     continue\n }\n \n@@ -39,82 +40,75 @@ set binfile_lib [standard_output_file ${libname}.so]\n # the main program.\n #\n \n-if {[gdb_compile_shlib ${srcdir}/${subdir}/${srcfile_lib} ${binfile_lib} [list debug -Wl,-soname,${libname}.so]] != \"\"} {\n+if {[gdb_compile_shlib ${srcdir}/${subdir}/${srcfile_lib} ${binfile_lib} \\\n+\t [list debug -Wl,-soname,${libname}.so]] != \"\"} {\n     return -1\n }\n \n-if {[gdb_compile \"${srcdir}/${subdir}/${srcfile_main}\" \"${binfile_main}.o\" object debug] != \"\"} {\n+if {[gdb_compile \"${srcdir}/${subdir}/${srcfile_main}\" \"${binfile_main}.o\" \\\n+\t object debug] != \"\"} {\n     return -1\n }\n \n set testobjdir [standard_output_file {}]\n if {[gdb_compile \"${binfile_main}.o\" \"${binfile_main}\" executable \\\n-                 [list debug \"additional_flags=-L$testobjdir -l${test} \\\n-                                               -Wl,-rpath=$testobjdir\"]] != \"\"} {\n+\t [list debug \"additional_flags=-L$testobjdir\" \\\n+\t      \"additional_flags=-l${test}\" \\\n+\t      \"additional_flags=-Wl,-rpath=$testobjdir\"]] != \"\"} {\n     return -1\n }\n \n-clean_restart ${executable_main}\n-\n #\n-# At this point, if we try to skip the file ${srcfile_lib} or the function\n-# multiply(), we should get a prompt asking us if we want to enable the\n-# skip entry pending a shared library load.\n+# Test ignoring of a file inside a solib.\n #\n+with_test_prefix \"ignoring solib file\" {\n \n-gdb_test \"skip file ${srcfile_lib}\" \\\n-  \"File ${srcfile_lib} will be skipped when stepping.\" \\\n-  \"ignoring file in solib\" \\\n-  \"No source file named ${srcfile_lib}.*\n-Ignore file pending future shared library load.*\" \\\n-  \"y\"\n+    clean_restart ${executable_main}\n \n-#\n-# Checkinfo skip list.\n-#\n-gdb_test \"info skip\" \\\n-  \"Num\\\\s+Enb\\\\s+Glob\\\\s+File\\\\s+RE\\\\s+Function\\\\s*\n-1\\\\s+y\\\\s+n\\\\s+${srcfile_lib}\\\\s+n\\\\s+<none>\\\\s*\" \\\n-  \"info skip with pending file\"\n+    gdb_test \"skip file ${srcfile_lib}\" \\\n+\t\"File ${srcfile_lib} will be skipped when stepping.\" \\\n+\t\"skip file\"\n \n-if ![runto_main] { fail \"skip tests suppressed\" }\n+    gdb_test \"info skip\" \\\n+\t[multi_line \\\n+\t     \"Num\\\\s+Enb\\\\s+Glob\\\\s+File\\\\s+RE\\\\s+Function\\\\s*\" \\\n+\t     \"1\\\\s+y\\\\s+n\\\\s+${srcfile_lib}\\\\s+n\\\\s+<none>\\\\s*\"]\n \n-#\n-# We shouldn't step into square(), since we skipped skip-solib-lib.c.\n-#\n-gdb_test \"step\" \"\"\n-gdb_test \"bt\" \"#0\\\\s+main.*\" \"step after ignoring solib file.\"\n+    if ![runto_main] { fail \"skip tests suppressed\" }\n+\n+    #\n+    # We shouldn't step into square(), since we skipped skip-solib-lib.c.\n+    #\n+    gdb_test \"step\" \"\"\n+    gdb_test \"bt\" \"#0\\\\s+main.*\"\n+}\n \n #\n-# Now restart gdb and testing ignoring of a function inside a solib.\n+# Now test ignoring of a function inside a solib.\n #\n-clean_restart ${executable_main}\n+with_test_prefix \"ignoring solib function\" {\n+    clean_restart ${executable_main}\n \n-gdb_test \"skip function multiply\" \\\n-  \"Function multiply will be skipped when stepping\\\\.\" \\\n-  \"ignoring function in solib\" \\\n-\"No function found named multiply..*\n-Ignore function pending future shared library load.*\" \\\n-  \"y\"\n+    gdb_test \"skip function multiply\" \\\n+\t\"Function multiply will be skipped when stepping\\\\.\" \\\n+\t\"skip function\"\n \n-if ![runto_main] { fail \"skip tests suppressed\" }\n+    if ![runto_main] { fail \"skip tests suppressed\" }\n \n-#\n-# Our first step should take us into square.\n-#\n-gdb_test \"step\" \"square.*\"\n+    #\n+    # Our first step should take us into square.\n+    #\n+    gdb_test \"step\" \"square.*\" \"step into other function\"\n \n-#\n-# Now our entry should no longer be pending.\n-#\n-gdb_test \"info skip\" \\\n-  \"Num\\\\s+Enb\\\\s+Glob\\\\s+File\\\\s+RE\\\\s+Function\\\\s*\n-1\\\\s+y\\\\s+n\\\\s+<none>\\\\s+n\\\\s+multiply\\\\s*\" \\\n-  \"info skip for function multiply\"\n+    gdb_test \"info skip\" \\\n+\t[multi_line \\\n+\t     \"Num\\\\s+Enb\\\\s+Glob\\\\s+File\\\\s+RE\\\\s+Function\\\\s*\" \\\n+\t     \"1\\\\s+y\\\\s+n\\\\s+<none>\\\\s+n\\\\s+multiply\\\\s*\"]\n \n-#\n-# This step shouldn't go into multiply -- we should skip it and go on to the\n-# last line of square.\n-#\n-gdb_test \"step\" \"\"\n-gdb_test \"bt\" \"#0\\\\s+square.*\"\n+    #\n+    # This step shouldn't go into multiply -- we should skip it and go on to\n+    # the last line of square.\n+    #\n+    gdb_test \"step\" \"\"\n+    gdb_test \"bt\" \"#0\\\\s+square.*\"\n+}"
    }
  ]
}