{
  "sha": "5a36e71525564fe8767bc9f00b29dcc0fec59837",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NWEzNmU3MTUyNTU2NGZlODc2N2JjOWYwMGIyOWRjYzBmZWM1OTgzNw==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-10-29T21:04:33Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-10-29T21:04:35Z"
    },
    "message": "Remove exec_bfd_mtime define\n\nThis removes the exec_bfd_mtime define, in favor of directly using the\nappropriate member of the current program space.\n\ngdb/ChangeLog\n2020-10-29  Tom Tromey  <tom@tromey.com>\n\n\t* source-cache.c (source_cache::get_plain_source_lines): Use\n\tcurrent_program_space.\n\t* corefile.c (reopen_exec_file): Use current_program_space.\n\t* exec.c (exec_file_attach): Use current_program_space.\n\t* exec.h (exec_bfd_mtime): Remove.",
    "tree": {
      "sha": "fd0bf48773db5a424b7e2cd9e5b18e0b08fc0770",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/fd0bf48773db5a424b7e2cd9e5b18e0b08fc0770"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/5a36e71525564fe8767bc9f00b29dcc0fec59837",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5a36e71525564fe8767bc9f00b29dcc0fec59837",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/5a36e71525564fe8767bc9f00b29dcc0fec59837",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5a36e71525564fe8767bc9f00b29dcc0fec59837/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "784c859246ae2cf3ffa07376cfe8ec60e4526e57",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/784c859246ae2cf3ffa07376cfe8ec60e4526e57",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/784c859246ae2cf3ffa07376cfe8ec60e4526e57"
    }
  ],
  "stats": {
    "total": 17,
    "additions": 13,
    "deletions": 4
  },
  "files": [
    {
      "sha": "b47133e7b354bff8d7db522fd087967a982b44f1",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=5a36e71525564fe8767bc9f00b29dcc0fec59837",
      "patch": "@@ -1,3 +1,11 @@\n+2020-10-29  Tom Tromey  <tom@tromey.com>\n+\n+\t* source-cache.c (source_cache::get_plain_source_lines): Use\n+\tcurrent_program_space.\n+\t* corefile.c (reopen_exec_file): Use current_program_space.\n+\t* exec.c (exec_file_attach): Use current_program_space.\n+\t* exec.h (exec_bfd_mtime): Remove.\n+\n 2020-10-29  Tom Tromey  <tom@tromey.com>\n \n \t* gcore.c (default_gcore_mach): Remove."
    },
    {
      "sha": "1586e9f175a0476e3a141f33378bcc88b7483607",
      "filename": "gdb/corefile.c",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/corefile.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/corefile.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/corefile.c?ref=5a36e71525564fe8767bc9f00b29dcc0fec59837",
      "patch": "@@ -115,7 +115,9 @@ reopen_exec_file (void)\n   std::string filename = bfd_get_filename (exec_bfd);\n   res = stat (filename.c_str (), &st);\n \n-  if (res == 0 && exec_bfd_mtime && exec_bfd_mtime != st.st_mtime)\n+  if (res == 0\n+      && current_program_space->ebfd_mtime\n+      && current_program_space->ebfd_mtime != st.st_mtime)\n     exec_file_attach (filename.c_str (), 0);\n   else\n     /* If we accessed the file since last opening it, close it now;"
    },
    {
      "sha": "4345f35b7f960737a212159a4b61f2436448d075",
      "filename": "gdb/exec.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/exec.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/exec.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/exec.c?ref=5a36e71525564fe8767bc9f00b29dcc0fec59837",
      "patch": "@@ -482,7 +482,7 @@ exec_file_attach (const char *filename, int from_tty)\n \n       target_section_table sections = build_section_table (exec_bfd);\n \n-      exec_bfd_mtime = bfd_get_mtime (exec_bfd);\n+      current_program_space->ebfd_mtime = bfd_get_mtime (exec_bfd);\n \n       validate_files ();\n "
    },
    {
      "sha": "658112a0f280f9b155a2f7bf6d485dcfeb364b36",
      "filename": "gdb/exec.h",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/exec.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/exec.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/exec.h?ref=5a36e71525564fe8767bc9f00b29dcc0fec59837",
      "patch": "@@ -31,7 +31,6 @@ struct bfd;\n struct objfile;\n \n #define exec_bfd current_program_space->ebfd\n-#define exec_bfd_mtime current_program_space->ebfd_mtime\n \n /* Builds a section table, given args BFD.  */\n "
    },
    {
      "sha": "c67d087c76d1f45cf51276f5922c66ce3f3c2ab6",
      "filename": "gdb/source-cache.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/source-cache.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a36e71525564fe8767bc9f00b29dcc0fec59837/gdb/source-cache.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/source-cache.c?ref=5a36e71525564fe8767bc9f00b29dcc0fec59837",
      "patch": "@@ -69,7 +69,7 @@ source_cache::get_plain_source_lines (struct symtab *s,\n   if (SYMTAB_OBJFILE (s) != NULL && SYMTAB_OBJFILE (s)->obfd != NULL)\n     mtime = SYMTAB_OBJFILE (s)->mtime;\n   else if (exec_bfd)\n-    mtime = exec_bfd_mtime;\n+    mtime = current_program_space->ebfd_mtime;\n \n   if (mtime && mtime < st.st_mtime)\n     warning (_(\"Source file is more recent than executable.\"));"
    }
  ]
}