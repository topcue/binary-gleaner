{
  "sha": "84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ODRkOWFiMzNmM2RjNTQyYzVmMjBhYmI5MDI2MjQwY2ZkNDhjY2Q5Nw==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-03-06T17:13:22Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-03-06T17:13:22Z"
    },
    "message": "Add support for a \".file 0\" directive if supporting DWARF 5 or higher.\n\n\tPR 25614\n\t* dwarf2dbg.c (dwarf2_directive_filename): Allow a file number of\n\t0 if the dwarf_level is 5 or more.  Complain if a filename follows\n\ta file 0.\n\t* testsuite/gas/elf/dwarf-5-file0.s: New test.\n\t* testsuite/gas/elf/dwarf-5-file0.d: New test driver.\n\t* testsuite/gas/elf/elf.exp: Run the new test.\n\n\tPR 25612\n\t* config/tc-ia64.h (DWARF2_VERISION): Fix typo.\n\t* doc/as.texi: Fix another typo.",
    "tree": {
      "sha": "cbdd933a1952a9f71c90f3e43e0265cb96390995",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/cbdd933a1952a9f71c90f3e43e0265cb96390995"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "436b5e99c8eef55433f2c1de35d8f960425aa4c1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/436b5e99c8eef55433f2c1de35d8f960425aa4c1",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/436b5e99c8eef55433f2c1de35d8f960425aa4c1"
    }
  ],
  "stats": {
    "total": 65,
    "additions": 57,
    "deletions": 8
  },
  "files": [
    {
      "sha": "c6a8a4f19b41009575716e1a495c8a82fb37f790",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
      "patch": "@@ -1,3 +1,17 @@\n+2020-03-06  Nick Clifton  <nickc@redhat.com>\n+\n+\tPR 25614\n+\t* dwarf2dbg.c (dwarf2_directive_filename): Allow a file number of\n+\t0 if the dwarf_level is 5 or more.  Complain if a filename follows\n+\ta file 0.\n+\t* testsuite/gas/elf/dwarf-5-file0.s: New test.\n+\t* testsuite/gas/elf/dwarf-5-file0.d: New test driver.\n+\t* testsuite/gas/elf/elf.exp: Run the new test.\n+\n+\tPR 25612\n+\t* config/tc-ia64.h (DWARF2_VERISION): Fix typo.\n+\t* doc/as.texi: Fix another typo.\n+\n 2020-03-06  Nick Clifton  <nickc@redhat.com>\n \n \tPR 25612"
    },
    {
      "sha": "e982e57b477c7b39fe0aa13463fb33144888299d",
      "filename": "gas/config/tc-ia64.h",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/config/tc-ia64.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/config/tc-ia64.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-ia64.h?ref=84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
      "patch": "@@ -325,5 +325,5 @@ typedef struct unwind_record\n \n /* VMS backtraces expect dwarf version 3.  */\n #ifdef TE_VMS\n-#define DWARF2_VERSION      (dwarf_level < 3 ? 3  : debug_level)\n+#define DWARF2_VERSION      (dwarf_level < 3 ? 3  : dwarf_level)\n #endif"
    },
    {
      "sha": "711578fc76238ffa3788b18b3f2638df17b87be0",
      "filename": "gas/doc/as.texi",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/doc/as.texi",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/doc/as.texi",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/doc/as.texi?ref=84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
      "patch": "@@ -780,7 +780,7 @@ per target basis.\n @item --gdwarf-5\n This option is the same as the @option{--gdwarf-2} option, except that it\n allows for the possibility of the generation of extra debug information as per\n-version 4 of the DWARF specification.  Note - enabling this option does not\n+version 5 of the DWARF specification.  Note - enabling this option does not\n guarantee the generation of any extra infortmation, the choice to do so is on a\n per target basis.\n "
    },
    {
      "sha": "181401300e6b54d5cc5f1e34f2d0c01a59074980",
      "filename": "gas/dwarf2dbg.c",
      "status": "modified",
      "additions": 16,
      "deletions": 6,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/dwarf2dbg.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/dwarf2dbg.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/dwarf2dbg.c?ref=84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
      "patch": "@@ -794,17 +794,27 @@ dwarf2_directive_filename (void)\n     }\n \n   num = get_absolute_expression ();\n-  filename = demand_copy_C_string (&filename_len);\n-  if (filename == NULL)\n-    return NULL;\n-  demand_empty_rest_of_line ();\n \n-  if ((offsetT) num < 1)\n+  if ((offsetT) num < 1 && dwarf_level < 5)\n     {\n       as_bad (_(\"file number less than one\"));\n+      ignore_rest_of_line ();\n       return NULL;\n     }\n \n+  if (num == 0)\n+    {\n+      demand_empty_rest_of_line ();\n+      return NULL;\n+    }\n+\n+  filename = demand_copy_C_string (&filename_len);\n+  if (filename == NULL)\n+    /* demand_copy_C_string will have already generated an error message.  */\n+    return NULL;\n+\n+  demand_empty_rest_of_line ();\n+\n   /* A .file directive implies compiler generated debug information is\n      being supplied.  Turn off gas generated debug info.  */\n   debug_type = DEBUG_NONE;\n@@ -821,7 +831,7 @@ dwarf2_directive_filename (void)\n       return NULL;\n     }\n \n-  get_filenum (filename, (unsigned int) num);\n+  (void) get_filenum (filename, (unsigned int) num);\n \n   return filename;\n }"
    },
    {
      "sha": "a3d1fdfb6e7f945790cc49e53b5fb202f8a26dfc",
      "filename": "gas/testsuite/gas/elf/dwarf-5-file0.d",
      "status": "added",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/testsuite/gas/elf/dwarf-5-file0.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/testsuite/gas/elf/dwarf-5-file0.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/elf/dwarf-5-file0.d?ref=84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
      "patch": "@@ -0,0 +1,6 @@\n+#as: --gdwarf-5\n+#name: DWARF5 .line 0\n+#readelf: -wl\n+\n+#pass\n+"
    },
    {
      "sha": "c00ec5e8bcfcec1478d3e6adc8b9c7ce34959b82",
      "filename": "gas/testsuite/gas/elf/dwarf-5-file0.s",
      "status": "added",
      "additions": 18,
      "deletions": 0,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/testsuite/gas/elf/dwarf-5-file0.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/testsuite/gas/elf/dwarf-5-file0.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/elf/dwarf-5-file0.s?ref=84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
      "patch": "@@ -0,0 +1,18 @@\n+\t.text\n+\n+.file 0\n+.line 1\n+\t.long 3\n+\n+.file 1 \"asdf\"\n+.line 2\n+\t.long 5\n+\n+.file 0\n+.line 4\n+\t.long 3\n+\n+.file 2 \"def\"\n+.line 5\n+\t.long 3\n+"
    },
    {
      "sha": "c80175cc51d7947a5b17385e52ea2e974c06e2e2",
      "filename": "gas/testsuite/gas/elf/elf.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/testsuite/gas/elf/elf.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/84d9ab33f3dc542c5f20abb9026240cfd48ccd97/gas/testsuite/gas/elf/elf.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/elf/elf.exp?ref=84d9ab33f3dc542c5f20abb9026240cfd48ccd97",
      "patch": "@@ -272,6 +272,7 @@ if { [is_elf_format] } then {\n     run_dump_test \"dwarf2-17\" $dump_opts\n     run_dump_test \"dwarf2-18\" $dump_opts\n     run_dump_test \"dwarf2-19\" $dump_opts\n+    run_dump_test \"dwarf-5-file0\" $dump_opts\n     run_dump_test \"bss\"\n     run_dump_test \"bad-bss\"\n     run_dump_test \"bad-section-flag\""
    }
  ]
}