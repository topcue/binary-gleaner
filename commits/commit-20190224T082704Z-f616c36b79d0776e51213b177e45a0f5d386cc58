{
  "sha": "f616c36b79d0776e51213b177e45a0f5d386cc58",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZjYxNmMzNmI3OWQwNzc2ZTUxMjEzYjE3N2U0NWEwZjVkMzg2Y2M1OA==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-02-24T06:14:48Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-02-24T08:27:04Z"
    },
    "message": "PR24144, pdp11-ld overwriting section data with zeros\n\nbfd/\n\tPR 24144\n\t* pdp11.c (set_section_contents): Revert 2015-02-24 change.\ngas/\n\tPR 24144\n\t* config/obj-aout.c (obj_aout_frob_file_before_fix): Write to end\n\tof section to ensure file contents cover aligned section size.",
    "tree": {
      "sha": "565d71b6f7fde2bacedacf2c8be9ddce7ce43b61",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/565d71b6f7fde2bacedacf2c8be9ddce7ce43b61"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/f616c36b79d0776e51213b177e45a0f5d386cc58",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f616c36b79d0776e51213b177e45a0f5d386cc58",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/f616c36b79d0776e51213b177e45a0f5d386cc58",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f616c36b79d0776e51213b177e45a0f5d386cc58/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "4323c5ad3cbcb2a3d2178d778278109f24071b26",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4323c5ad3cbcb2a3d2178d778278109f24071b26",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/4323c5ad3cbcb2a3d2178d778278109f24071b26"
    }
  ],
  "stats": {
    "total": 51,
    "additions": 32,
    "deletions": 19
  },
  "files": [
    {
      "sha": "e206629bd763f346a601e116ff527760b10baa97",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f616c36b79d0776e51213b177e45a0f5d386cc58/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f616c36b79d0776e51213b177e45a0f5d386cc58/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=f616c36b79d0776e51213b177e45a0f5d386cc58",
      "patch": "@@ -1,3 +1,8 @@\n+2019-02-24  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 24144\n+\t* pdp11.c (set_section_contents): Revert 2015-02-24 change.\n+\n 2019-02-20  Eric Tsai  <erictsai@cadence.com>\n \n \t* elf32-xtensa.c (is_resolvable_asm_expansion): Scan output"
    },
    {
      "sha": "b16c78f9399b606c975d55fea7a6c91cfbc648e1",
      "filename": "bfd/pdp11.c",
      "status": "modified",
      "additions": 0,
      "deletions": 8,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f616c36b79d0776e51213b177e45a0f5d386cc58/bfd/pdp11.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f616c36b79d0776e51213b177e45a0f5d386cc58/bfd/pdp11.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/pdp11.c?ref=f616c36b79d0776e51213b177e45a0f5d386cc58",
      "patch": "@@ -1146,14 +1146,6 @@ NAME (aout, set_section_contents) (bfd *abfd,\n       if (bfd_seek (abfd, section->filepos + offset, SEEK_SET) != 0\n \t  || bfd_bwrite (location, count, abfd) != count)\n \treturn FALSE;\n-\n-      /* If necessary, pad the section to its aligned size.  */\n-      if ((section == obj_datasec (abfd)\n-\t   || section == obj_textsec (abfd))\n-\t  && count < section->size\n-\t  && (bfd_seek (abfd, section->filepos + offset + section->size - 1, SEEK_SET) != 0\n-\t      || bfd_bwrite (\"\", 1, abfd) != 1))\n-\treturn FALSE;\n     }\n \n   return TRUE;"
    },
    {
      "sha": "03c9b4e9aec16990b0844d9fb4a0711d95c6f55c",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f616c36b79d0776e51213b177e45a0f5d386cc58/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f616c36b79d0776e51213b177e45a0f5d386cc58/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=f616c36b79d0776e51213b177e45a0f5d386cc58",
      "patch": "@@ -1,3 +1,9 @@\n+2019-02-24  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 24144\n+\t* config/obj-aout.c (obj_aout_frob_file_before_fix): Write to end\n+\tof section to ensure file contents cover aligned section size.\n+\n 2019-02-22  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* config/tc-arm.c (arm_cpus): Add neoverse-n1."
    },
    {
      "sha": "03e0ef3c0a481eef0deceebaf241fb72aa7f60f3",
      "filename": "gas/config/obj-aout.c",
      "status": "modified",
      "additions": 21,
      "deletions": 11,
      "changes": 32,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f616c36b79d0776e51213b177e45a0f5d386cc58/gas/config/obj-aout.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f616c36b79d0776e51213b177e45a0f5d386cc58/gas/config/obj-aout.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/obj-aout.c?ref=f616c36b79d0776e51213b177e45a0f5d386cc58",
      "patch": "@@ -118,17 +118,27 @@ obj_aout_frob_file_before_fix (void)\n {\n   /* Relocation processing may require knowing the VMAs of the sections.\n      Since writing to a section will cause the BFD back end to compute the\n-     VMAs, fake it out here....  */\n-  bfd_byte b = 0;\n-  bfd_boolean x = TRUE;\n-  if (bfd_section_size (stdoutput, text_section) != 0)\n-    x = bfd_set_section_contents (stdoutput, text_section, &b, (file_ptr) 0,\n-\t\t\t\t  (bfd_size_type) 1);\n-  else if (bfd_section_size (stdoutput, data_section) != 0)\n-    x = bfd_set_section_contents (stdoutput, data_section, &b, (file_ptr) 0,\n-\t\t\t\t  (bfd_size_type) 1);\n-\n-  gas_assert (x);\n+     VMAs, fake it out here....\n+     Writing to the end of the section ensures the file contents\n+     extend to cover the entire aligned size.  We possibly won't know\n+     the aligned size until after VMAs and sizes are set on the first\n+     bfd_set_section_contents call, so it might be necessary to repeat.  */\n+  asection *sec = NULL;\n+  if (data_section->size != 0)\n+    sec = data_section;\n+  else if (text_section->size != 0)\n+    sec = text_section;\n+  if (sec)\n+    {\n+      bfd_size_type size;\n+      do\n+\t{\n+\t  bfd_byte b = 0;\n+\t  size = sec->size;\n+\t  gas_assert (bfd_set_section_contents (stdoutput, sec, &b,\n+\t\t\t\t\t\tsize - 1, (bfd_size_type) 1));\n+\t} while (size != sec->size);\n+    }\n }\n \n static void"
    }
  ]
}