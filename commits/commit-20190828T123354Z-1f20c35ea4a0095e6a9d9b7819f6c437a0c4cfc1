{
  "sha": "1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MWYyMGMzNWVhNGEwMDk1ZTZhOWQ5Yjc4MTlmNmM0MzdhMGM0Y2ZjMQ==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2019-07-09T14:47:19Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2019-08-28T12:33:54Z"
    },
    "message": "gdb/fortran: Implement la_print_typedef for Fortran\n\nImplement an la_print_typedef method for Fortran, this allows 'info\ntypes' to work for Fortran.  The implementation is just copied from\nada_print_typedef (with the appropriate changes).\n\nTo support the testing of this patch I added a new proc,\nfortran_character1, to lib/fortran.exp which returns a regexp to match\na 1-byte character type.  The regexp returned is correct for current\nversions of gFortran.  All of the other regexp are guesses based on\nall of the other support procs in lib/fortran.exp, I haven't tested\nthem myself.\n\ngdb/ChangeLog:\n\n\t* f-lang.c (f_language_defn): Use f_print_typedef.\n\t* f-lang.h (f_print_typedef): Declare.\n\t* f-typeprint.c (f_print_typedef): Define.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.fortran/info-types.exp: New file.\n\t* gdb.fortran/info-types.f90: New file.\n\t* lib/fortran.exp (fortran_character1): New proc.",
    "tree": {
      "sha": "b65b098310de5ceb7dc0892d627a283626020821",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/b65b098310de5ceb7dc0892d627a283626020821"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "fa463e9fc644e7a3bad39aa73bf6be72ea865805",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fa463e9fc644e7a3bad39aa73bf6be72ea865805",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/fa463e9fc644e7a3bad39aa73bf6be72ea865805"
    }
  ],
  "stats": {
    "total": 112,
    "additions": 111,
    "deletions": 1
  },
  "files": [
    {
      "sha": "4767e03b7e083f527457c72fcdde5e884cf9f68b",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
      "patch": "@@ -1,3 +1,9 @@\n+2019-08-28  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* f-lang.c (f_language_defn): Use f_print_typedef.\n+\t* f-lang.h (f_print_typedef): Declare.\n+\t* f-typeprint.c (f_print_typedef): Define.\n+\n 2019-08-27  Christian Biesinger  <cbiesinger@google.com>\n \n \t* nat/linux-namespaces.c (mnsh_main): Initialize fd (to -1)."
    },
    {
      "sha": "ce7f1471c52d9c6f3338946841d7f4a7e3931d4a",
      "filename": "gdb/f-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/f-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/f-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/f-lang.c?ref=1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
      "patch": "@@ -644,7 +644,7 @@ extern const struct language_defn f_language_defn =\n   f_printstr,\t\t\t/* function to print string constant */\n   f_emit_char,\t\t\t/* Function to print a single character */\n   f_print_type,\t\t\t/* Print a type using appropriate syntax */\n-  default_print_typedef,\t/* Print a typedef using appropriate syntax */\n+  f_print_typedef,\t\t/* Print a typedef using appropriate syntax */\n   f_val_print,\t\t\t/* Print a value using appropriate syntax */\n   c_value_print,\t\t/* FIXME */\n   default_read_var_value,\t/* la_read_var_value */"
    },
    {
      "sha": "cf6024c4454a48bf967545a3035616f36cd1510e",
      "filename": "gdb/f-lang.h",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/f-lang.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/f-lang.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/f-lang.h?ref=1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
      "patch": "@@ -28,6 +28,11 @@ struct parser_state;\n \n extern int f_parse (struct parser_state *);\n \n+/* Implement the la_print_typedef language method for Fortran.  */\n+\n+extern void f_print_typedef (struct type *type, struct symbol *new_symbol,\n+\t\t\t     struct ui_file *stream);\n+\n extern void f_print_type (struct type *, const char *, struct ui_file *, int,\n \t\t\t  int, const struct type_print_options *);\n "
    },
    {
      "sha": "92b50938740a78ce59a998a9efe40c5984827562",
      "filename": "gdb/f-typeprint.c",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/f-typeprint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/f-typeprint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/f-typeprint.c?ref=1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
      "patch": "@@ -45,6 +45,17 @@ void f_type_print_varspec_prefix (struct type *, struct ui_file *,\n void f_type_print_base (struct type *, struct ui_file *, int, int);\n \f\n \n+/* See documentation in f-lang.h.  */\n+\n+void\n+f_print_typedef (struct type *type, struct symbol *new_symbol,\n+\t\t struct ui_file *stream)\n+{\n+  type = check_typedef (type);\n+  f_print_type (type, \"\", stream, 0, 0, &type_print_raw_options);\n+  fprintf_filtered (stream, \"\\n\");\n+}\n+\n /* LEVEL is the depth to indent lines by.  */\n \n void"
    },
    {
      "sha": "02a3c01667cbdc1af3cd361d14484d36498db62c",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
      "patch": "@@ -1,3 +1,9 @@\n+2019-08-28  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* gdb.fortran/info-types.exp: New file.\n+\t* gdb.fortran/info-types.f90: New file.\n+\t* lib/fortran.exp (fortran_character1): New proc.\n+\n 2019-08-27  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* gdb.base/info-fun.exp: Extend to test the -n flag for 'info"
    },
    {
      "sha": "9571dc455934d2d44a30e9a098f31e885e3bd48d",
      "filename": "gdb/testsuite/gdb.fortran/info-types.exp",
      "status": "added",
      "additions": 45,
      "deletions": 0,
      "changes": 45,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/testsuite/gdb.fortran/info-types.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/testsuite/gdb.fortran/info-types.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/info-types.exp?ref=1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
      "patch": "@@ -0,0 +1,45 @@\n+# Copyright 2019 Free Software Foundation, Inc.\n+#\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+# This file tests 'info types' for some Fortran types.\n+\n+load_lib \"fortran.exp\"\n+\n+if { [skip_fortran_tests] } { continue }\n+\n+standard_testfile .f90\n+\n+if { [prepare_for_testing \"failed to prepare\" $testfile $srcfile {debug f90}] } {\n+    return -1\n+}\n+\n+if { ![runto MAIN__] } {\n+    perror \"Could not run to breakpoint `MAIN__'.\"\n+    continue\n+}\n+\n+set integer4 [fortran_int4]\n+set logical4 [fortran_logical4]\n+set character1 [fortran_character1]\n+\n+gdb_test \"info types\" \\\n+    [multi_line \\\n+\t \"All defined types:\" \\\n+\t \"\" \\\n+\t \"File .*:\" \\\n+\t \"\\[\\t \\]+${character1}\" \\\n+\t \"\\[\\t \\]+${integer4}\" \\\n+\t \"\\[\\t \\]+${logical4}\" \\\n+\t \"16:\\[\\t \\]+Type s1;\" ]"
    },
    {
      "sha": "21c9d9df63c45bc3ce1434c4911b70412595640b",
      "filename": "gdb/testsuite/gdb.fortran/info-types.f90",
      "status": "added",
      "additions": 25,
      "deletions": 0,
      "changes": 25,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/testsuite/gdb.fortran/info-types.f90",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/testsuite/gdb.fortran/info-types.f90",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/info-types.f90?ref=1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
      "patch": "@@ -0,0 +1,25 @@\n+! Copyright 2019 Free Software Foundation, Inc.\n+!\n+! This program is free software; you can redistribute it and/or modify\n+! it under the terms of the GNU General Public License as published by\n+! the Free Software Foundation; either version 2 of the License, or\n+! (at your option) any later version.\n+!\n+! This program is distributed in the hope that it will be useful,\n+! but WITHOUT ANY WARRANTY; without even the implied warranty of\n+! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+! GNU General Public License for more details.\n+!\n+! You should have received a copy of the GNU General Public License\n+! along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+program info_types_test\n+  type :: s1\n+     integer :: a\n+  end type s1\n+\n+  logical :: l\n+  type (s1) :: var_a\n+  var_a%a = 1\n+  l = .FALSE.\n+end program info_types_test"
    },
    {
      "sha": "81811dbc3c9d2bc5fa119a7848e36999bdb7f1fc",
      "filename": "gdb/testsuite/lib/fortran.exp",
      "status": "modified",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/testsuite/lib/fortran.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1/gdb/testsuite/lib/fortran.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/fortran.exp?ref=1f20c35ea4a0095e6a9d9b7819f6c437a0c4cfc1",
      "patch": "@@ -88,3 +88,15 @@ proc fortran_logical4 {} {\n \treturn \"unknown\"\n     }\n }\n+\n+proc fortran_character1 {} {\n+    if {[test_compiler_info {gcc-4-[012]-*}]} {\n+\treturn \"character1\"\n+    } elseif {[test_compiler_info {gcc-*}]} {\n+\treturn \"character\\\\(kind=1\\\\)\"\n+    } elseif {[test_compiler_info {icc-*}]} {\n+\treturn \"CHARACTER\\\\(1\\\\)\"\n+    } else {\n+\treturn \"unknown\"\n+    }\n+}"
    }
  ]
}