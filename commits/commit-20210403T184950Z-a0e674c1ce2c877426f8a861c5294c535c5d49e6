{
  "sha": "a0e674c1ce2c877426f8a861c5294c535c5d49e6",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YTBlNjc0YzFjZTJjODc3NDI2ZjhhODYxYzUyOTRjNTM1YzVkNDllNg==",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-01-16T07:27:38Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-04-03T18:49:50Z"
    },
    "message": "sim: add preliminary support for --enable-targets\n\nThis doesn't actually create one `run` program like other projects,\nbut creates multiple `run-$arch` targets.  While it might not seem\nthat useful initially, this has some nice properties:\n- Allows us to quickly build all sim targets in a single tree.\n- Positions us better for converting targets over to a proper\n  multitarget build+install.\n\nWe don't have the ability to actually run tests against them, but\nthat's due to a limitation in gas: it doesn't support multitarget.\nIf that ever changes, we should be able to turn on our tests too.\nWe can improve the test framework to fallback to a system toolchain\nif available to help mitigate that.",
    "tree": {
      "sha": "4a567f1db4f4312c5ab30bd837b893c2ee2e3d88",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/4a567f1db4f4312c5ab30bd837b893c2ee2e3d88"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/a0e674c1ce2c877426f8a861c5294c535c5d49e6",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a0e674c1ce2c877426f8a861c5294c535c5d49e6",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/a0e674c1ce2c877426f8a861c5294c535c5d49e6",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a0e674c1ce2c877426f8a861c5294c535c5d49e6/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "b6b1c790843087e67e85e7cfd3327a872c03c6bc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b6b1c790843087e67e85e7cfd3327a872c03c6bc",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/b6b1c790843087e67e85e7cfd3327a872c03c6bc"
    }
  ],
  "stats": {
    "total": 520,
    "additions": 389,
    "deletions": 131
  },
  "files": [
    {
      "sha": "8e4d93275dddf231c58ffb5896e9b210d4278cfb",
      "filename": "sim/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/ChangeLog?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -1,3 +1,10 @@\n+2021-04-03  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* Makefile.am (SIM_PRIMARY_TARGET, AM_MAKEFLAGS): Define.\n+\t* configure.ac: Add --enable-targets option.  Define SIM_PRIMARY_TARGET\n+\tand SIM_TARGET.  Rewrite case statement with SIM_TARGET calls.\n+\t* Makefile.in, configure: Regenerate.\n+\n 2021-04-02  Mike Frysinger  <vapier@gentoo.org>\n \n \t* Makefile.am [SIM_ENABLE_IGEN]: Include igen/local.mk."
    },
    {
      "sha": "a121c1fed43d8b207b90ffff1f744e9eb34df479",
      "filename": "sim/Makefile.am",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/Makefile.am",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/Makefile.am",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/Makefile.am?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -22,6 +22,9 @@ srcroot = $(srcdir)/..\n \n SUBDIRS = @subdirs@\n \n+SIM_PRIMARY_TARGET = @SIM_PRIMARY_TARGET@\n+AM_MAKEFLAGS = SIM_PRIMARY_TARGET=$(SIM_PRIMARY_TARGET)\n+\n # We don't set some of these vars here, but we need to define them so they may\n # be used consistently in local.mk files we include below.\n noinst_LIBRARIES ="
    },
    {
      "sha": "21fc22bb4c78f611cfc91b4dc43f6ac5c79697f7",
      "filename": "sim/Makefile.in",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/Makefile.in?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -350,6 +350,7 @@ PATH_SEPARATOR = @PATH_SEPARATOR@\n RANLIB = @RANLIB@\n SET_MAKE = @SET_MAKE@\n SHELL = @SHELL@\n+SIM_PRIMARY_TARGET = @SIM_PRIMARY_TARGET@\n STRIP = @STRIP@\n VERSION = @VERSION@\n abs_builddir = @abs_builddir@\n@@ -411,6 +412,7 @@ AUTOMAKE_OPTIONS = dejagnu foreign no-dist subdir-objects\n ACLOCAL_AMFLAGS = -Im4 -I.. -I../config\n srcroot = $(srcdir)/..\n SUBDIRS = @subdirs@\n+AM_MAKEFLAGS = SIM_PRIMARY_TARGET=$(SIM_PRIMARY_TARGET)\n \n # We don't set some of these vars here, but we need to define them so they may\n # be used consistently in local.mk files we include below."
    },
    {
      "sha": "ded8bbf555811e13d9b32da28fb0e00a8f0270af",
      "filename": "sim/common/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/common/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/common/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/ChangeLog?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -1,3 +1,8 @@\n+2021-04-03  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* Make-common.in (install-common): Install as run-$arch and\n+\tlibsim-$arch.a when not the primary arch.\n+\n 2021-04-02  Mike Frysinger  <vapier@gentoo.org>\n \n \t* Make-common.in (CFLAGS_FOR_BUILD): Define."
    },
    {
      "sha": "c8445bce59eac58208209f99b109bd1db5c37fa0",
      "filename": "sim/common/Make-common.in",
      "status": "modified",
      "additions": 6,
      "deletions": 1,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/common/Make-common.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/common/Make-common.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/common/Make-common.in?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -467,9 +467,14 @@ CGEN_MAIN_CPU_DEPS = \\\n install: install-common $(SIM_EXTRA_INSTALL)\n \n install-common: installdirs\n+\ta=`basename \"$$(pwd)\"`; \\\n \tn=`echo run | sed '$(program_transform_name)'`; \\\n+\t[ \"$(SIM_PRIMARY_TARGET)\" = \"$$a\" ] || n=\"$$n-$$a\"; \\\n \t$(INSTALL_PROGRAM) run$(EXEEXT) $(DESTDIR)$(bindir)/$$n$(EXEEXT)\n-\tn=`echo libsim.a | sed s/libsim.a/lib$(target_alias)-sim.a/`; \\\n+\tn=\"$(target_alias)-sim\"; \\\n+\ta=`basename \"$$(pwd)\"`; \\\n+\t[ \"$(SIM_PRIMARY_TARGET)\" = \"$$a\" ] || n=\"$$n-$$a\"; \\\n+\tn=\"lib$$n.a\"; \\\n \t$(INSTALL_DATA) libsim.a $(DESTDIR)$(libdir)/$$n ; \\\n \t( cd $(DESTDIR)$(libdir) ; $(RANLIB) $$n )\n "
    },
    {
      "sha": "24e57ff3bd6d331c182cbf7c676a9b57a15fa73a",
      "filename": "sim/configure",
      "status": "modified",
      "additions": 297,
      "deletions": 32,
      "changes": 329,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/configure?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -630,6 +630,7 @@ LIBOBJS\n SIM_ENABLE_IGEN_FALSE\n SIM_ENABLE_IGEN_TRUE\n subdirs\n+SIM_PRIMARY_TARGET\n AM_BACKSLASH\n AM_DEFAULT_VERBOSITY\n AM_DEFAULT_V\n@@ -743,6 +744,7 @@ enable_maintainer_mode\n enable_dependency_tracking\n enable_silent_rules\n enable_sim\n+enable_targets\n '\n       ac_precious_vars='build_alias\n host_alias\n@@ -1412,6 +1414,7 @@ Optional Features:\n   --enable-silent-rules   less verbose build output (undo: \"make V=1\")\n   --disable-silent-rules  verbose build output (undo: \"make V=0\")\n   --enable-sim            Enable the GNU simulator\n+  --enable-targets        alternative target configurations\n \n Some influential environment variables:\n   CC          C compiler command\n@@ -4829,139 +4832,401 @@ esac\n fi\n \n \n+# Check whether --enable-targets was given.\n+if test \"${enable_targets+set}\" = set; then :\n+  enableval=$enable_targets; case \"${enableval}\" in\n+  yes | \"\") as_fn_error $? \"enable-targets option must specify target names or 'all'\" \"$LINENO\" 5\n+\t    ;;\n+  no)       enable_targets= ;;\n+  *)        enable_targets=$enableval ;;\n+esac\n+fi\n+\n+\n+SIM_PRIMARY_TARGET=\n+\n+\n+\n+\n if test \"${enable_sim}\" != no; then\n   sim_igen=no\n-  case \"${target}\" in\n-    aarch64*-*-*)\n+  for targ in `echo $target $enable_targets | sed 's/,/ /g'`\n+  do\n+\n+  case \"${targ}\" in\n+    all|aarch64*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=aarch64\n+      fi\n \n \n subdirs=\"$subdirs aarch64\"\n \n+\n       ;;\n-    arm*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|arm*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=arm\n+      fi\n       subdirs=\"$subdirs arm\"\n \n+\n       ;;\n-    avr*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|avr*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=avr\n+      fi\n       subdirs=\"$subdirs avr\"\n \n+\n       ;;\n-    bfin-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|bfin-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=bfin\n+      fi\n       subdirs=\"$subdirs bfin\"\n \n+\n       ;;\n-    bpf-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|bpf-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=bpf\n+      fi\n       subdirs=\"$subdirs bpf\"\n \n+\n       ;;\n-    cr16*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|cr16*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=cr16\n+      fi\n       subdirs=\"$subdirs cr16\"\n \n+\n       ;;\n-    cris-*-* | crisv32-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|cris-*-* | crisv32-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=cris\n+      fi\n       subdirs=\"$subdirs cris\"\n \n+\n       ;;\n-    d10v-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|d10v-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=d10v\n+      fi\n       subdirs=\"$subdirs d10v\"\n \n+\n       ;;\n-    frv-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|frv-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=frv\n+      fi\n       subdirs=\"$subdirs frv\"\n \n+\n       ;;\n-    h8300*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|h8300*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=h8300\n+      fi\n       subdirs=\"$subdirs h8300\"\n \n+\n       ;;\n-    iq2000-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|iq2000-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=iq2000\n+      fi\n       subdirs=\"$subdirs iq2000\"\n \n+\n       ;;\n-    lm32-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|lm32-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=lm32\n+      fi\n       subdirs=\"$subdirs lm32\"\n \n+\n       ;;\n-    m32c-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|m32c-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=m32c\n+      fi\n       subdirs=\"$subdirs m32c\"\n \n+\n       ;;\n-    m32r-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|m32r-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=m32r\n+      fi\n       subdirs=\"$subdirs m32r\"\n \n+\n       ;;\n-    m68hc11-*-*|m6811-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|m68hc11-*-*|m6811-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=m68hc11\n+      fi\n       subdirs=\"$subdirs m68hc11\"\n \n+\n       ;;\n-    mcore-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|mcore-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=mcore\n+      fi\n       subdirs=\"$subdirs mcore\"\n \n+\n       ;;\n-    microblaze-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|microblaze-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=microblaze\n+      fi\n       subdirs=\"$subdirs microblaze\"\n \n+\n       ;;\n-    mips*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|mips*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=mips\n+      fi\n       subdirs=\"$subdirs mips\"\n \n       sim_igen=yes\n       ;;\n-    mn10300*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|mn10300*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=mn10300\n+      fi\n       subdirs=\"$subdirs mn10300\"\n \n       sim_igen=yes\n       ;;\n-    moxie-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|moxie-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=moxie\n+      fi\n       subdirs=\"$subdirs moxie\"\n \n+\n       ;;\n-    msp430*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|msp430*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=msp430\n+      fi\n       subdirs=\"$subdirs msp430\"\n \n+\n       ;;\n-    or1k-*-* | or1knd-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|or1k-*-* | or1knd-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=or1k\n+      fi\n       subdirs=\"$subdirs or1k\"\n \n+\n       ;;\n-    pru*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|pru*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=pru\n+      fi\n       subdirs=\"$subdirs pru\"\n \n+\n       ;;\n-    riscv*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|riscv*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=riscv\n+      fi\n       subdirs=\"$subdirs riscv\"\n \n+\n       ;;\n-    rl78-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|rl78-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=rl78\n+      fi\n       subdirs=\"$subdirs rl78\"\n \n+\n       ;;\n-    rx-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|rx-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=rx\n+      fi\n       subdirs=\"$subdirs rx\"\n \n+\n       ;;\n-    sh*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|sh*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=sh\n+      fi\n       subdirs=\"$subdirs sh\"\n \n+\n       ;;\n-    sparc-*-rtems*|sparc-*-elf*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|sparc-*-rtems*|sparc-*-elf*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=erc32\n+      fi\n       subdirs=\"$subdirs erc32\"\n \n+\n       ;;\n-    powerpc*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|powerpc*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=ppc\n+      fi\n       subdirs=\"$subdirs ppc\"\n \n+\n       ;;\n-    ft32-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|ft32-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=ft32\n+      fi\n       subdirs=\"$subdirs ft32\"\n \n+\n       ;;\n-    v850*-*-*)\n+  esac\n+\n+\n+  case \"${targ}\" in\n+    all|v850*-*-*)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=v850\n+      fi\n       subdirs=\"$subdirs v850\"\n \n       sim_igen=yes\n       ;;\n   esac\n+\n+  done\n fi\n  if test \"$sim_igen\" = \"yes\"; then\n   SIM_ENABLE_IGEN_TRUE="
    },
    {
      "sha": "35101a0d6729e755d90546034fd519aa01d590ab",
      "filename": "sim/configure.ac",
      "status": "modified",
      "additions": 60,
      "deletions": 98,
      "changes": 158,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/configure.ac?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -19,110 +19,72 @@ yes | no) ;;\n *)\tAC_MSG_ERROR(bad value ${enableval} given for --enable-sim option) ;;\n esac])\n \n+AC_ARG_ENABLE(targets,\n+[  --enable-targets        alternative target configurations],\n+[case \"${enableval}\" in\n+  yes | \"\") AC_MSG_ERROR(enable-targets option must specify target names or 'all')\n+\t    ;;\n+  no)       enable_targets= ;;\n+  *)        enable_targets=$enableval ;;\n+esac])\n+\n+dnl Used to keep track of which target (if any) is the default one.  This is\n+dnl used when installing files to see if they need to be suffixed.\n+SIM_PRIMARY_TARGET=\n+AC_SUBST(SIM_PRIMARY_TARGET)\n+\n+m4_define([SIM_TARGET], [\n+  case \"${targ}\" in\n+    all|$1)\n+      if test \"${targ}\" = \"${target}\"; then\n+        SIM_PRIMARY_TARGET=$2\n+      fi\n+      AC_CONFIG_SUBDIRS($2)\n+      $3\n+      ;;\n+  esac\n+])\n+\n dnl WHEN ADDING ENTRIES TO THIS MATRIX:\n dnl Make sure that the left side always has two dashes.  Otherwise you can get\n dnl spurious matches.  Even for unambiguous cases, do this as a convention, else\n dnl the table becomes a real mess to understand and maintain.\n if test \"${enable_sim}\" != no; then\n   sim_igen=no\n-  case \"${target}\" in\n-    aarch64*-*-*)\n-      AC_CONFIG_SUBDIRS(aarch64)\n-      ;;\n-    arm*-*-*)\n-      AC_CONFIG_SUBDIRS(arm)\n-      ;;\n-    avr*-*-*)\n-      AC_CONFIG_SUBDIRS(avr)\n-      ;;\n-    bfin-*-*)\n-      AC_CONFIG_SUBDIRS(bfin)\n-      ;;\n-    bpf-*-*)\n-      AC_CONFIG_SUBDIRS(bpf)\n-      ;;\n-    cr16*-*-*)\n-      AC_CONFIG_SUBDIRS(cr16)\n-      ;;\n-    cris-*-* | crisv32-*-*)\n-      AC_CONFIG_SUBDIRS(cris)\n-      ;;\n-    d10v-*-*)\n-      AC_CONFIG_SUBDIRS(d10v)\n-      ;;\n-    frv-*-*)\n-      AC_CONFIG_SUBDIRS(frv)\n-      ;;\n-    h8300*-*-*)\n-      AC_CONFIG_SUBDIRS(h8300)\n-      ;;\n-    iq2000-*-*)\n-      AC_CONFIG_SUBDIRS(iq2000)\n-      ;;\n-    lm32-*-*)\n-      AC_CONFIG_SUBDIRS(lm32)\n-      ;;\n-    m32c-*-*)\n-      AC_CONFIG_SUBDIRS(m32c)\n-      ;;\n-    m32r-*-*)\n-      AC_CONFIG_SUBDIRS(m32r)\n-      ;;\n-    m68hc11-*-*|m6811-*-*)\n-      AC_CONFIG_SUBDIRS(m68hc11)\n-      ;;\n-    mcore-*-*)\n-      AC_CONFIG_SUBDIRS(mcore)\n-      ;;\n-    microblaze-*-*)\n-      AC_CONFIG_SUBDIRS(microblaze)\n-      ;;\n-    mips*-*-*)\n-      AC_CONFIG_SUBDIRS(mips)\n-      sim_igen=yes\n-      ;;\n-    mn10300*-*-*)\n-      AC_CONFIG_SUBDIRS(mn10300)\n-      sim_igen=yes\n-      ;;\n-    moxie-*-*)\n-      AC_CONFIG_SUBDIRS(moxie)\n-      ;;\n-    msp430*-*-*)\n-      AC_CONFIG_SUBDIRS(msp430)\n-      ;;\n-    or1k-*-* | or1knd-*-*)\n-      AC_CONFIG_SUBDIRS(or1k)\n-      ;;\n-    pru*-*-*)\n-      AC_CONFIG_SUBDIRS(pru)\n-      ;;\n-    riscv*-*-*)\n-      AC_CONFIG_SUBDIRS(riscv)\n-      ;;\n-    rl78-*-*)\n-      AC_CONFIG_SUBDIRS(rl78)\n-      ;;\n-    rx-*-*)\n-      AC_CONFIG_SUBDIRS(rx)\n-      ;;\n-    sh*-*-*)\n-      AC_CONFIG_SUBDIRS(sh)\n-      ;;\n-    sparc-*-rtems*|sparc-*-elf*)\n-      AC_CONFIG_SUBDIRS(erc32)\n-      ;;\n-    powerpc*-*-*)\n-      AC_CONFIG_SUBDIRS(ppc)\n-      ;;\n-    ft32-*-*)\n-      AC_CONFIG_SUBDIRS(ft32)\n-      ;;\n-    v850*-*-*)\n-      AC_CONFIG_SUBDIRS(v850)\n-      sim_igen=yes\n-      ;;\n-  esac\n+  for targ in `echo $target $enable_targets | sed 's/,/ /g'`\n+  do\n+    SIM_TARGET([aarch64*-*-*], [aarch64])\n+    SIM_TARGET([arm*-*-*], [arm])\n+    SIM_TARGET([avr*-*-*], [avr])\n+    SIM_TARGET([bfin-*-*], [bfin])\n+    SIM_TARGET([bpf-*-*], [bpf])\n+    SIM_TARGET([cr16*-*-*], [cr16])\n+    SIM_TARGET([cris-*-* | crisv32-*-*], [cris])\n+    SIM_TARGET([d10v-*-*], [d10v])\n+    SIM_TARGET([frv-*-*], [frv])\n+    SIM_TARGET([h8300*-*-*], [h8300])\n+    SIM_TARGET([iq2000-*-*], [iq2000])\n+    SIM_TARGET([lm32-*-*], [lm32])\n+    SIM_TARGET([m32c-*-*], [m32c])\n+    SIM_TARGET([m32r-*-*], [m32r])\n+    SIM_TARGET([m68hc11-*-*|m6811-*-*], [m68hc11])\n+    SIM_TARGET([mcore-*-*], [mcore])\n+    SIM_TARGET([microblaze-*-*], [microblaze])\n+    SIM_TARGET([mips*-*-*], [mips], [sim_igen=yes])\n+    SIM_TARGET([mn10300*-*-*], [mn10300], [sim_igen=yes])\n+    SIM_TARGET([moxie-*-*], [moxie])\n+    SIM_TARGET([msp430*-*-*], [msp430])\n+    SIM_TARGET([or1k-*-* | or1knd-*-*], [or1k])\n+    SIM_TARGET([pru*-*-*], [pru])\n+    SIM_TARGET([riscv*-*-*], [riscv])\n+    SIM_TARGET([rl78-*-*], [rl78])\n+    SIM_TARGET([rx-*-*], [rx])\n+    SIM_TARGET([sh*-*-*], [sh])\n+    SIM_TARGET([sparc-*-rtems*|sparc-*-elf*], [erc32])\n+    SIM_TARGET([powerpc*-*-*], [ppc])\n+    SIM_TARGET([ft32-*-*], [ft32])\n+    SIM_TARGET([v850*-*-*], [v850], [sim_igen=yes])\n+  done\n fi\n AM_CONDITIONAL([SIM_ENABLE_IGEN], [test \"$sim_igen\" = \"yes\"])\n "
    },
    {
      "sha": "539d3179ef8b83b7c422578f9b5ea085de36a033",
      "filename": "sim/ppc/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/ppc/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/ppc/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/ppc/ChangeLog?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -1,3 +1,8 @@\n+2021-04-03  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* Makefile.in (install): Install as run-ppc when not the primary arch.\n+\t(install-strip): Likewise.\n+\n 2021-03-13  Mike Frysinger  <vapier@gentoo.org>\n \n \t* Makefile.in (BUILD_LDFLAGS): Rename to ..."
    },
    {
      "sha": "d2bd1d317754d25022f4860bbecc98ff74e9af9f",
      "filename": "sim/ppc/Makefile.in",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/ppc/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0e674c1ce2c877426f8a861c5294c535c5d49e6/sim/ppc/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/sim/ppc/Makefile.in?ref=a0e674c1ce2c877426f8a861c5294c535c5d49e6",
      "patch": "@@ -885,11 +885,15 @@ config.status: configure\n check:\n \n install: installdirs\n+\ta=`basename \"$$(pwd)\"`; \\\n \tn=`echo run | sed '$(program_transform_name)'`; \\\n+\t[ \"$(SIM_PRIMARY_TARGET)\" = \"$$a\" ] || n=\"$$n-$$a\"; \\\n \t$(INSTALL_PROGRAM) run$(EXEEXT) $(DESTDIR)$(bindir)/$$n$(EXEEXT)\n \n install-strip: installdirs\n+\ta=`basename \"$$(pwd)\"`; \\\n \tn=`echo run | sed '$(program_transform_name)'`; \\\n+\t[ \"$(SIM_PRIMARY_TARGET)\" = \"$$a\" ] || n=\"$$n-$$a\"; \\\n \t$(INSTALL_PROGRAM) run$(EXEEXT) $(DESTDIR)$(bindir)/$$n$(EXEEXT)\n \t$(STRIP) $(DESTDIR)$(bindir)/$$n$(EXEEXT)\n "
    }
  ]
}