{
  "sha": "6b86da53d5ee2022b9065f445d23356190380746",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NmI4NmRhNTNkNWVlMjAyMmI5MDY1ZjQ0NWQyMzM1NjE5MDM4MDc0Ng==",
  "commit": {
    "author": {
      "name": "Luca Boccassi",
      "email": "luca.boccassi@microsoft.com",
      "date": "2021-07-21T13:32:03Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2021-07-21T13:36:02Z"
    },
    "message": "Allows linker scripts to set the SEC_READONLY flag.\n\n* ld.texi: Document new output section type.\n* ldgram.y: Add new token.\n* ldlang.c: Handle the new flag.\n* ldlang.h: Add readonly_section to list of section types.\n* ldlex.l: Add a new identifier.\n* testsuite/ld-scripts/output-section-types.t: New example linker script.\n* testsuite/ld-scripts/output-section-types.d: Test driver.\n* testsyute/ld-scripts/script.exp: Run the new test.",
    "tree": {
      "sha": "30672413b66483f04b1d54399cae642ae651eccc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/30672413b66483f04b1d54399cae642ae651eccc"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/6b86da53d5ee2022b9065f445d23356190380746",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6b86da53d5ee2022b9065f445d23356190380746",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/6b86da53d5ee2022b9065f445d23356190380746",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6b86da53d5ee2022b9065f445d23356190380746/comments",
  "author": {
    "login": "bluca",
    "id": 782193,
    "node_id": "MDQ6VXNlcjc4MjE5Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/782193?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bluca",
    "html_url": "https://github.com/bluca",
    "followers_url": "https://api.github.com/users/bluca/followers",
    "following_url": "https://api.github.com/users/bluca/following{/other_user}",
    "gists_url": "https://api.github.com/users/bluca/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bluca/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bluca/subscriptions",
    "organizations_url": "https://api.github.com/users/bluca/orgs",
    "repos_url": "https://api.github.com/users/bluca/repos",
    "events_url": "https://api.github.com/users/bluca/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bluca/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "8f5d31b8d1f80fd9fff4cef4acc4491a0d83fbed",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8f5d31b8d1f80fd9fff4cef4acc4491a0d83fbed",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/8f5d31b8d1f80fd9fff4cef4acc4491a0d83fbed"
    }
  ],
  "stats": {
    "total": 35,
    "additions": 34,
    "deletions": 1
  },
  "files": [
    {
      "sha": "60bb071fb79043e7cdef9f59b3b06f72b145a73f",
      "filename": "ld/ld.texi",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6b86da53d5ee2022b9065f445d23356190380746/ld/ld.texi",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6b86da53d5ee2022b9065f445d23356190380746/ld/ld.texi",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ld.texi?ref=6b86da53d5ee2022b9065f445d23356190380746",
      "patch": "@@ -5474,6 +5474,8 @@ parentheses.  The following types are defined:\n @item NOLOAD\n The section should be marked as not loadable, so that it will not be\n loaded into memory when the program is run.\n+@item READONLY\n+The section should be marked as read-only.\n @item DSECT\n @itemx COPY\n @itemx INFO"
    },
    {
      "sha": "31e0071c6fc92ad4988b3b913fad6e1e241871ed",
      "filename": "ld/ldgram.y",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6b86da53d5ee2022b9065f445d23356190380746/ld/ldgram.y",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6b86da53d5ee2022b9065f445d23356190380746/ld/ldgram.y",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldgram.y?ref=6b86da53d5ee2022b9065f445d23356190380746",
      "patch": "@@ -139,6 +139,7 @@ static int error_index;\n %token REGION_ALIAS\n %token LD_FEATURE\n %token NOLOAD DSECT COPY INFO OVERLAY\n+%token READONLY\n %token DEFINED TARGET_K SEARCH_DIR MAP ENTRY\n %token <integer> NEXT\n %token SIZEOF ALIGNOF ADDR LOADADDR MAX_K MIN_K\n@@ -1123,6 +1124,7 @@ type:\n \t|  COPY    { sectype = noalloc_section; }\n \t|  INFO    { sectype = noalloc_section; }\n \t|  OVERLAY { sectype = noalloc_section; }\n+\t|  READONLY { sectype = readonly_section; }\n \t;\n \n atype:"
    },
    {
      "sha": "2610be995cad0e960a494dffe77bf511efc4dd26",
      "filename": "ld/ldlang.c",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6b86da53d5ee2022b9065f445d23356190380746/ld/ldlang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6b86da53d5ee2022b9065f445d23356190380746/ld/ldlang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldlang.c?ref=6b86da53d5ee2022b9065f445d23356190380746",
      "patch": "@@ -2639,6 +2639,9 @@ lang_add_section (lang_statement_list_type *ptr,\n     case noalloc_section:\n       flags &= ~SEC_ALLOC;\n       break;\n+    case readonly_section:\n+      flags |= SEC_READONLY;\n+      break;\n     case noload_section:\n       flags &= ~SEC_LOAD;\n       flags |= SEC_NEVER_LOAD;\n@@ -4232,6 +4235,9 @@ map_input_to_output_sections\n \t    case noalloc_section:\n \t      flags = SEC_HAS_CONTENTS;\n \t      break;\n+\t    case readonly_section:\n+\t      flags |= SEC_READONLY;\n+\t      break;\n \t    case noload_section:\n \t      if (bfd_get_flavour (link_info.output_bfd)\n \t\t  == bfd_target_elf_flavour)"
    },
    {
      "sha": "f68ae27b409aee839a7bf1887bb46f728f36cdd3",
      "filename": "ld/ldlang.h",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6b86da53d5ee2022b9065f445d23356190380746/ld/ldlang.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6b86da53d5ee2022b9065f445d23356190380746/ld/ldlang.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldlang.h?ref=6b86da53d5ee2022b9065f445d23356190380746",
      "patch": "@@ -121,7 +121,8 @@ enum section_type\n   first_overlay_section,\n   overlay_section,\n   noload_section,\n-  noalloc_section\n+  noalloc_section,\n+  readonly_section\n };\n \n /* This structure holds a list of program headers describing"
    },
    {
      "sha": "25b4bcaae01daf319a8399324a497263bb90c30e",
      "filename": "ld/ldlex.l",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6b86da53d5ee2022b9065f445d23356190380746/ld/ldlex.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6b86da53d5ee2022b9065f445d23356190380746/ld/ldlex.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldlex.l?ref=6b86da53d5ee2022b9065f445d23356190380746",
      "patch": "@@ -294,6 +294,7 @@ V_IDENTIFIER [*?.$_a-zA-Z\\[\\]\\-\\!\\^\\\\]([*?.$_a-zA-Z0-9\\[\\]\\-\\!\\^\\\\]|::)*\n <BOTH,SCRIPT>\"SORT_BY_INIT_PRIORITY\"\t{ RTOKEN(SORT_BY_INIT_PRIORITY); }\n <BOTH,SCRIPT>\"SORT_NONE\"\t\t{ RTOKEN(SORT_NONE); }\n <EXPRESSION,BOTH,SCRIPT>\"NOLOAD\"\t{ RTOKEN(NOLOAD);}\n+<EXPRESSION,BOTH,SCRIPT>\"READONLY\"\t{ RTOKEN(READONLY);}\n <EXPRESSION,BOTH,SCRIPT>\"DSECT\"\t\t{ RTOKEN(DSECT);}\n <EXPRESSION,BOTH,SCRIPT>\"COPY\"\t\t{ RTOKEN(COPY);}\n <EXPRESSION,BOTH,SCRIPT>\"INFO\"\t\t{ RTOKEN(INFO);}"
    },
    {
      "sha": "ab124fa4dd7d3e6c2e37cd7028d201a9e0214543",
      "filename": "ld/testsuite/ld-scripts/output-section-types.d",
      "status": "added",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6b86da53d5ee2022b9065f445d23356190380746/ld/testsuite/ld-scripts/output-section-types.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6b86da53d5ee2022b9065f445d23356190380746/ld/testsuite/ld-scripts/output-section-types.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-scripts/output-section-types.d?ref=6b86da53d5ee2022b9065f445d23356190380746",
      "patch": "@@ -0,0 +1,13 @@\n+#ld: -Toutput-section-types.t\n+#source: align2a.s\n+#objdump: -h\n+#target: [is_elf_format]\n+\n+#...\n+  . \\.rom.*\n+[ \t]+ALLOC, READONLY\n+  . \\.ro.*\n+[ \t]+CONTENTS, ALLOC, LOAD, READONLY, DATA\n+  . \\.over.*\n+[ \t]+CONTENTS, READONLY\n+#pass"
    },
    {
      "sha": "d8fdfda1a0333d1f40382f1e68cf2d29de86a3ba",
      "filename": "ld/testsuite/ld-scripts/output-section-types.t",
      "status": "added",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6b86da53d5ee2022b9065f445d23356190380746/ld/testsuite/ld-scripts/output-section-types.t",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6b86da53d5ee2022b9065f445d23356190380746/ld/testsuite/ld-scripts/output-section-types.t",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-scripts/output-section-types.t?ref=6b86da53d5ee2022b9065f445d23356190380746",
      "patch": "@@ -0,0 +1,7 @@\n+SECTIONS {\n+  .rom  (NOLOAD)   : { LONG(1234); }\n+  .ro   (READONLY) : { LONG(5678); }\n+  .over (OVERLAY)  : { LONG(0123); }\n+  /DISCARD/        : { *(*) }\n+\n+}"
    },
    {
      "sha": "ff50199b3aec05aae844d263545f661dcabc1f53",
      "filename": "ld/testsuite/ld-scripts/script.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/6b86da53d5ee2022b9065f445d23356190380746/ld/testsuite/ld-scripts/script.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/6b86da53d5ee2022b9065f445d23356190380746/ld/testsuite/ld-scripts/script.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-scripts/script.exp?ref=6b86da53d5ee2022b9065f445d23356190380746",
      "patch": "@@ -229,6 +229,7 @@ foreach test_script $test_script_list {\n \n run_dump_test \"align-with-input\"\n run_dump_test \"pr20302\"\n+run_dump_test \"output-section-types\"\n \n run_dump_test \"segment-start\" {{name (default)}}\n run_dump_test \"segment-start\" {{name (overridden)} \\"
    }
  ]
}