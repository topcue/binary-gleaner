{
  "sha": "3d2357068b03edc850b3d84a27dbe6ad12a66d6f",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6M2QyMzU3MDY4YjAzZWRjODUwYjNkODRhMjdkYmU2YWQxMmE2NmQ2Zg==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-07-28T21:02:35Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-07-29T22:06:58Z"
    },
    "message": "Two fixes for test suite's terminal\n\nExactly which escape sequences are emitted by gdb in TUI mode are\ndetermined largely by the curses implementation.  Testing my latest\n(as yet unsubmitted) series to refactor the TUI showed a couple of\nfailures that I tracked to the test suite's terminal implementation.\n\nIn particular, the CSI \"@\" sequence was not implemented; and the CSI\n\"X\" sequence was implemented incorrectly.\n\nThis patch fixes both of these problems.  Tested on x86-64 Fedora 28.\n\ngdb/testsuite/ChangeLog\n2019-07-29  Tom Tromey  <tom@tromey.com>\n\n\t* lib/tuiterm.exp (Term::_csi_@): New proc.\n\t(Term::_csi_X): Don't move cursor.",
    "tree": {
      "sha": "0f254b2214f49c81c68e12075518850752f0bb75",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/0f254b2214f49c81c68e12075518850752f0bb75"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/3d2357068b03edc850b3d84a27dbe6ad12a66d6f",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3d2357068b03edc850b3d84a27dbe6ad12a66d6f",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/3d2357068b03edc850b3d84a27dbe6ad12a66d6f",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3d2357068b03edc850b3d84a27dbe6ad12a66d6f/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "bc4268a5d926c8f29e42d245322145dad131627f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/bc4268a5d926c8f29e42d245322145dad131627f",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/bc4268a5d926c8f29e42d245322145dad131627f"
    }
  ],
  "stats": {
    "total": 32,
    "additions": 31,
    "deletions": 1
  },
  "files": [
    {
      "sha": "a0b5862dd8bce892295857bbc43bb4fffb94b472",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3d2357068b03edc850b3d84a27dbe6ad12a66d6f/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3d2357068b03edc850b3d84a27dbe6ad12a66d6f/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=3d2357068b03edc850b3d84a27dbe6ad12a66d6f",
      "patch": "@@ -1,3 +1,8 @@\n+2019-07-29  Tom Tromey  <tom@tromey.com>\n+\n+\t* lib/tuiterm.exp (Term::_csi_@): New proc.\n+\t(Term::_csi_X): Don't move cursor.\n+\n 2019-07-29  Philippe Waroquiers  <philippe.waroquiers@skynet.be>\n \n \t* gdb.base/options.exp: Update backtrace - completion to"
    },
    {
      "sha": "d94fd431d8a0fbedd5d5082d53b62a000ff55e27",
      "filename": "gdb/testsuite/lib/tuiterm.exp",
      "status": "modified",
      "additions": 26,
      "deletions": 1,
      "changes": 27,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3d2357068b03edc850b3d84a27dbe6ad12a66d6f/gdb/testsuite/lib/tuiterm.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3d2357068b03edc850b3d84a27dbe6ad12a66d6f/gdb/testsuite/lib/tuiterm.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/tuiterm.exp?ref=3d2357068b03edc850b3d84a27dbe6ad12a66d6f",
      "patch": "@@ -104,6 +104,21 @@ namespace eval Term {\n \tset _cur_x 0\n     }\n \n+    # Make room for characters.\n+    proc _csi_@ {args} {\n+\tset n [_default [lindex $args 0] 1]\n+\tvariable _cur_x\n+\tvariable _cur_y\n+\tvariable _chars\n+\tset in_x $_cur_x\n+\tset out_x [expr {$_cur_x + $n}]\n+\tfor {set i 0} {$i < $n} {incr i} {\n+\t    set _chars($out_x,$_cur_y) $_chars($in_x,$_cur_y)\n+\t    incr in_x\n+\t    incr out_x\n+\t}\n+    }\n+\n     # Cursor Up.\n     proc _csi_A {args} {\n \tvariable _cur_y\n@@ -238,7 +253,17 @@ namespace eval Term {\n     # Erase chars.\n     proc _csi_X {args} {\n \tset n [_default [lindex $args 0] 1]\n-\t_insert [string repeat \" \" $n]\n+\t# Erase characters but don't move cursor.\n+\tvariable _cur_x\n+\tvariable _cur_y\n+\tvariable _attrs\n+\tvariable _chars\n+\tset lattr [array get _attrs]\n+\tset x $_cur_x\n+\tfor {set i 0} {$i < $n} {incr i} {\n+\t    set _chars($x,$_cur_y) [list \" \" $lattr]\n+\t    incr x\n+\t}\n     }\n \n     # Repeat."
    }
  ]
}