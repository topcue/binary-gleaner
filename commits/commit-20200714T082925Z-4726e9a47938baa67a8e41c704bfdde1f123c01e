{
  "sha": "4726e9a47938baa67a8e41c704bfdde1f123c01e",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NDcyNmU5YTQ3OTM4YmFhNjdhOGU0MWM3MDRiZmRkZTFmMTIzYzAxZQ==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2020-07-14T08:29:25Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2020-07-14T08:29:25Z"
    },
    "message": "x86: extend %BW use to VP{COMPRESS,EXPAND}{B,W}\n\nUnlike the earlier ones these also need their operands adjusted. Replace\nthe (mis-described: there's nothing \"scalar\" here) {b,w}_scalar_mode by\na single new mode, with the actual unit width controlled by EVEX.W.",
    "tree": {
      "sha": "d777a43281e7c1e7ce979d0ae229794f0a64995e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d777a43281e7c1e7ce979d0ae229794f0a64995e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4726e9a47938baa67a8e41c704bfdde1f123c01e",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4726e9a47938baa67a8e41c704bfdde1f123c01e",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4726e9a47938baa67a8e41c704bfdde1f123c01e",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4726e9a47938baa67a8e41c704bfdde1f123c01e/comments",
  "author": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "b24d668c078f65c8f092557ef4fca63a18df8280",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b24d668c078f65c8f092557ef4fca63a18df8280",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/b24d668c078f65c8f092557ef4fca63a18df8280"
    }
  ],
  "stats": {
    "total": 46,
    "additions": 22,
    "deletions": 24
  },
  "files": [
    {
      "sha": "f0b4d8c99a477615e6ed0e82841c33cfab96bb54",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4726e9a47938baa67a8e41c704bfdde1f123c01e/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4726e9a47938baa67a8e41c704bfdde1f123c01e/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=4726e9a47938baa67a8e41c704bfdde1f123c01e",
      "patch": "@@ -1,3 +1,16 @@\n+2020-07-14  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* i386-dis.c (EVEX_W_0F3862_P_2, EVEX_W_0F3863_P_2): Delete.\n+\t(EXbScalar, EXwScalar): Fold to ...\n+\t(EXbwUnit): ... this.\n+\t(b_scalar_mode, w_scalar_mode): Fold to ...\n+\t(bw_unit_mode): ... this.\n+\t(intel_operand_size, OP_E_memory): Replace b_scalar_mode /\n+\tw_scalar_mode handling by bw_unit_mode one.\n+\t* i386-dis-evex-w.h: Move entries for opcodes 0F3862 and 0F3863\n+\t...\n+\t* i386-dis-evex-prefix.h: ... here.\n+\n 2020-07-14  Jan Beulich  <jbeulich@suse.com>\n \n \t* i386-dis.c (PCMPESTR_Fixup): Delete."
    },
    {
      "sha": "04c93813c1053aaa26ebd940f3e9ec9fed663330",
      "filename": "opcodes/i386-dis-evex-prefix.h",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4726e9a47938baa67a8e41c704bfdde1f123c01e/opcodes/i386-dis-evex-prefix.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4726e9a47938baa67a8e41c704bfdde1f123c01e/opcodes/i386-dis-evex-prefix.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-dis-evex-prefix.h?ref=4726e9a47938baa67a8e41c704bfdde1f123c01e",
      "patch": "@@ -723,13 +723,13 @@\n   {\n     { Bad_Opcode },\n     { Bad_Opcode },\n-    { VEX_W_TABLE (EVEX_W_0F3862_P_2) },\n+    { \"vpexpand%BW\", { XM, EXbwUnit }, 0 },\n   },\n   /* PREFIX_EVEX_0F3863 */\n   {\n     { Bad_Opcode },\n     { Bad_Opcode },\n-    { VEX_W_TABLE (EVEX_W_0F3863_P_2) },\n+    { \"vpcompress%BW\",   { EXbwUnit, XM }, 0 },\n   },\n   /* PREFIX_EVEX_0F3864 */\n   {"
    },
    {
      "sha": "695cf8195d53ec9199e7b37b4667ce1ca92e195b",
      "filename": "opcodes/i386-dis-evex-w.h",
      "status": "modified",
      "additions": 0,
      "deletions": 10,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4726e9a47938baa67a8e41c704bfdde1f123c01e/opcodes/i386-dis-evex-w.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4726e9a47938baa67a8e41c704bfdde1f123c01e/opcodes/i386-dis-evex-w.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-dis-evex-w.h?ref=4726e9a47938baa67a8e41c704bfdde1f123c01e",
      "patch": "@@ -522,16 +522,6 @@\n     { MOD_TABLE (MOD_EVEX_0F385B_P_2_W_0) },\n     { MOD_TABLE (MOD_EVEX_0F385B_P_2_W_1) },\n   },\n-  /* EVEX_W_0F3862_P_2 */\n-  {\n-    { \"vpexpandb\", { XM, EXbScalar }, 0 },\n-    { \"vpexpandw\", { XM, EXwScalar }, 0 },\n-  },\n-  /* EVEX_W_0F3863_P_2 */\n-  {\n-    { \"vpcompressb\",   { EXbScalar, XM }, 0 },\n-    { \"vpcompressw\",   { EXwScalar, XM }, 0 },\n-  },\n   /* EVEX_W_0F3870_P_2 */\n   {\n     { Bad_Opcode },"
    },
    {
      "sha": "b68e737bd79ca8a45d1f25cc25267722cb538289",
      "filename": "opcodes/i386-dis.c",
      "status": "modified",
      "additions": 7,
      "deletions": 12,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4726e9a47938baa67a8e41c704bfdde1f123c01e/opcodes/i386-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4726e9a47938baa67a8e41c704bfdde1f123c01e/opcodes/i386-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-dis.c?ref=4726e9a47938baa67a8e41c704bfdde1f123c01e",
      "patch": "@@ -358,9 +358,8 @@ fetch_data (struct disassemble_info *info, bfd_byte *addr)\n #define EMS { OP_EM, v_swap_mode }\n #define EMd { OP_EM, d_mode }\n #define EMx { OP_EM, x_mode }\n-#define EXbScalar { OP_EX, b_scalar_mode }\n+#define EXbwUnit { OP_EX, bw_unit_mode }\n #define EXw { OP_EX, w_mode }\n-#define EXwScalar { OP_EX, w_scalar_mode }\n #define EXd { OP_EX, d_mode }\n #define EXdS { OP_EX, d_swap_mode }\n #define EXq { OP_EX, q_mode }\n@@ -488,6 +487,8 @@ enum\n   x_mode,\n   /* Similar to x_mode, but with different EVEX mem shifts.  */\n   evex_x_gscat_mode,\n+  /* Similar to x_mode, but with yet different EVEX mem shifts.  */\n+  bw_unit_mode,\n   /* Similar to x_mode, but with disabled broadcast.  */\n   evex_x_nobcst_mode,\n   /* Similar to x_mode, but with operands swapped and disabled broadcast\n@@ -579,10 +580,6 @@ enum\n \n   /* scalar, ignore vector length.  */\n   scalar_mode,\n-  /* like b_mode, ignore vector length.  */\n-  b_scalar_mode,\n-  /* like w_mode, ignore vector length.  */\n-  w_scalar_mode,\n   /* like d_swap_mode, ignore vector length.  */\n   d_scalar_swap_mode,\n   /* like q_swap_mode, ignore vector length.  */\n@@ -2183,8 +2180,6 @@ enum\n   EVEX_W_0F3859_P_2,\n   EVEX_W_0F385A_P_2,\n   EVEX_W_0F385B_P_2,\n-  EVEX_W_0F3862_P_2,\n-  EVEX_W_0F3863_P_2,\n   EVEX_W_0F3870_P_2,\n   EVEX_W_0F3872_P_1,\n   EVEX_W_0F3872_P_2,\n@@ -14109,8 +14104,7 @@ intel_operand_size (int bytemode, int sizeflag)\n     case x_swap_mode:\n     case evex_x_gscat_mode:\n     case evex_x_nobcst_mode:\n-    case b_scalar_mode:\n-    case w_scalar_mode:\n+    case bw_unit_mode:\n       if (need_vex)\n \t{\n \t  switch (vex.length)\n@@ -14592,11 +14586,12 @@ OP_E_memory (int bytemode, int sizeflag)\n \tcase d_scalar_swap_mode:\n \t  shift = 2;\n \t  break;\n-\tcase w_scalar_mode:\n+\tcase bw_unit_mode:\n+\t  shift = vex.w ? 1 : 0;\n+\t  break;\n \tcase xmm_mw_mode:\n \t  shift = 1;\n \t  break;\n-\tcase b_scalar_mode:\n \tcase xmm_mb_mode:\n \t  shift = 0;\n \t  break;"
    }
  ]
}