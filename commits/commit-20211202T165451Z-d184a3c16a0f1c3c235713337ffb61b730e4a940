{
  "sha": "d184a3c16a0f1c3c235713337ffb61b730e4a940",
  "node_id": "C_kwDOANOeidoAKGQxODRhM2MxNmEwZjFjM2MyMzU3MTMzMzdmZmI2MWI3MzBlNGE5NDA",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2021-12-02T15:28:40Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2021-12-02T16:54:51Z"
    },
    "message": "gdb/testsuite: update tests looking for \"DWARF 2\" debug format\n\nCommit ab557072b8ec (\"gdb: use actual DWARF version in compunit's\ndebugformat field\") changes the debug format string in \"info source\" to\nshow the actual DWARF version, rather than always show \"DWARF 2\".\n\nHowever, it failed to consider that some tests checked for the \"DWARF 2\"\nstring to see if the test program is compiled with DWARF debug\ninformation.  Since everything is compiled with DWARF 4 or 5 nowadays,\nthat changed the behavior of those tests.  Notably, it prevent the\ntests using skip_inline_var_tests to run.\n\nGrep through the testsuite for \"DWARF 2\" and change all occurrences I\ncould find to use \"DWARF [0-9]\" instead (that string is passed to TCL's\nstring match).\n\nChange-Id: Ic7fb0217fb9623880c6f155da6becba0f567a885",
    "tree": {
      "sha": "4a2f02ad49403385b446723832ed21f3964fec15",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/4a2f02ad49403385b446723832ed21f3964fec15"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d184a3c16a0f1c3c235713337ffb61b730e4a940",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d184a3c16a0f1c3c235713337ffb61b730e4a940",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d184a3c16a0f1c3c235713337ffb61b730e4a940",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d184a3c16a0f1c3c235713337ffb61b730e4a940/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "9a73e1cafedc2e3a466b6193a460cb8062fa0a59",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9a73e1cafedc2e3a466b6193a460cb8062fa0a59",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/9a73e1cafedc2e3a466b6193a460cb8062fa0a59"
    }
  ],
  "stats": {
    "total": 32,
    "additions": 16,
    "deletions": 16
  },
  "files": [
    {
      "sha": "776a69fe75791159a22f671b40ccaa97fb5d567b",
      "filename": "gdb/testsuite/gdb.base/complex.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/complex.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/complex.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/complex.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -26,7 +26,7 @@ if {[prepare_for_testing \"failed to prepare\" $testfile $srcfile debug]} {\n \n if [runto f2] then {\n     get_debug_format\n-    if { [test_compiler_info gcc-2-*] && [test_debug_format \"DWARF 2\"] } then {\n+    if { [test_compiler_info gcc-2-*] && [test_debug_format \"DWARF \\[0-9\\]\"] } then {\n \tsetup_xfail \"*-*-*\"\n     }\n     gdb_test \"p *y\" \"\\\\\\$\\[0-9\\]* = \\{c = 42 '\\\\*', f = 1 \\\\+ 0i\\}\" \\"
    },
    {
      "sha": "8d7bf6059798058cfed73fd9733ec1670e0aa865",
      "filename": "gdb/testsuite/gdb.base/constvars.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/constvars.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/constvars.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/constvars.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -59,7 +59,7 @@ get_debug_format\n proc local_compiler_xfail_check { } {\n     if { [test_compiler_info gcc-2-*] } then {\n \tif { ![test_debug_format \"HP\"] \\\n-\t\t&& ![test_debug_format \"DWARF 2\"] } then {\n+\t\t&& ![test_debug_format \"DWARF \\[0-9\\]\"] } then {\n \t    setup_xfail \"*-*-*\" \n \t}\n     }"
    },
    {
      "sha": "0c04362dcff232aad7fc6e67e1d2ef226bf338c8",
      "filename": "gdb/testsuite/gdb.base/included.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/included.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/included.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/included.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -22,7 +22,7 @@ gdb_test_no_output \"set listsize 1\"\n \n gdb_test \"list -q main\" \".*\"\n get_debug_format\n-set non_dwarf [expr ! [test_debug_format \"DWARF 2\"]]\n+set non_dwarf [expr ! [test_debug_format \"DWARF \\[0-9\\]\"]]\n \n # We should be able to find the source file containing the definition,\n # even though it was an included header."
    },
    {
      "sha": "0e4a7ec2cb1a09a7bab63bd5d5bfc2348aec1a99",
      "filename": "gdb/testsuite/gdb.base/structs.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 4,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/structs.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/structs.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/structs.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -232,8 +232,8 @@ proc test_struct_calls { n } {\n     set tests \"call $n ${testfile}\"\n \n     # Call fun${n}, checking the printed return-value.\n-    setup_compiler_kfails structs-tc-tll gcc-3-3-* \"DWARF 2\" i*86-*-* gdb/1455\n-    setup_compiler_kfails structs-tc-td gcc-3-3-* \"DWARF 2\" i*86-*-* gdb/1455\n+    setup_compiler_kfails structs-tc-tll gcc-3-3-* \"DWARF \\[0-9\\]\" i*86-*-* gdb/1455\n+    setup_compiler_kfails structs-tc-td gcc-3-3-* \"DWARF \\[0-9\\]\" i*86-*-* gdb/1455\n     gdb_test \"p/c fun${n}()\"  \"[foo ${n}]\" \"p/c fun<n>(); ${tests}\"\n \n     # Check that GDB can always pass a structure to an inferior function.\n@@ -244,8 +244,8 @@ proc test_struct_calls { n } {\n     # examining that global to confirm that the value is as expected.\n \n     gdb_test_no_output \"call Fun${n}(foo${n})\" \"call Fun<n>(foo<n>); ${tests}\"\n-    setup_compiler_kfails structs-tc-tll gcc-3-3-* \"DWARF 2\" i*86-*-* gdb/1455\n-    setup_compiler_kfails structs-tc-td gcc-3-3-* \"DWARF 2\" i*86-*-* gdb/1455\n+    setup_compiler_kfails structs-tc-tll gcc-3-3-* \"DWARF \\[0-9\\]\" i*86-*-* gdb/1455\n+    setup_compiler_kfails structs-tc-td gcc-3-3-* \"DWARF \\[0-9\\]\" i*86-*-* gdb/1455\n     gdb_test \"p/c L${n}\" [foo ${n}] \"p/c L<n>; ${tests}\"\n }\n "
    },
    {
      "sha": "212ceaf34d6635968197bd9d3ba6babf64b93ce8",
      "filename": "gdb/testsuite/gdb.base/volatile.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/volatile.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.base/volatile.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/volatile.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -60,7 +60,7 @@ get_debug_format\n proc local_compiler_xfail_check { } {\n     if { [test_compiler_info gcc-2-*] } then {\n \tif { ![test_debug_format \"HP\"] \\\n-\t\t&& ![test_debug_format \"DWARF 2\"] } then {\n+\t\t&& ![test_debug_format \"DWARF \\[0-9\\]\"] } then {\n \t    setup_xfail \"*-*-*\" \n \t}\n     }"
    },
    {
      "sha": "92715ddd29a4651d6eb1da86d52ed3764186fd8e",
      "filename": "gdb/testsuite/gdb.cp/class2.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.cp/class2.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.cp/class2.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.cp/class2.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -67,7 +67,7 @@ gdb_test_multiple \"print * aap\" \"print * aap at marker return 0\" {\n \tpass \"print * aap at marker return 0\"\n     }\n     -re \"= {.*a1 = .*}\\r\\n$gdb_prompt $\" {\n-\tif { [test_compiler_info gcc-2-*] && [test_debug_format \"DWARF 2\"] } {\n+\tif { [test_compiler_info gcc-2-*] && [test_debug_format \"DWARF \\[0-9\\]\"] } {\n \t    # gcc 2.95.3 -gdwarf-2\n \t    setup_kfail \"gdb/1465\" \"*-*-*\"\n \t}"
    },
    {
      "sha": "98df116e6ec7d811e66c18c0b02d59cd0a594051",
      "filename": "gdb/testsuite/gdb.cp/m-static.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.cp/m-static.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.cp/m-static.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.cp/m-static.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -48,7 +48,7 @@ if ![runto_main] then {\n }\n \n get_debug_format\n-set non_dwarf [expr ! [test_debug_format \"DWARF 2\"]]\n+set non_dwarf [expr ! [test_debug_format \"DWARF \\[0-9\\]\"]]\n \n # First, run to after we've constructed all the objects:\n "
    },
    {
      "sha": "26644a57b4405aded5d2eb687bf143ee90421094",
      "filename": "gdb/testsuite/gdb.dwarf2/pr10770.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.dwarf2/pr10770.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/gdb.dwarf2/pr10770.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/pr10770.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -25,9 +25,9 @@ if {![runto_main]} {\n     return -1\n }\n \n-# This test also requires DWARF 2.\n+# This test also requires DWARF.\n get_debug_format\n-if {![test_debug_format \"DWARF 2\"]} {\n+if {![test_debug_format \"DWARF \\[0-9\\]\"]} {\n     return -1\n }\n "
    },
    {
      "sha": "70fa2b3a8013540c992a6497914d1ba032313c6a",
      "filename": "gdb/testsuite/lib/gdb.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 4,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/lib/gdb.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d184a3c16a0f1c3c235713337ffb61b730e4a940/gdb/testsuite/lib/gdb.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/gdb.exp?ref=d184a3c16a0f1c3c235713337ffb61b730e4a940",
      "patch": "@@ -3683,8 +3683,8 @@ gdb_caching_proc skip_ifunc_tests {\n # backtraces.  Requires get_compiler_info and get_debug_format.\n \n proc skip_inline_frame_tests {} {\n-    # GDB only recognizes inlining information in DWARF 2 (DWARF 3).\n-    if { ! [test_debug_format \"DWARF 2\"] } {\n+    # GDB only recognizes inlining information in DWARF.\n+    if { ! [test_debug_format \"DWARF \\[0-9\\]\"] } {\n \treturn 1\n     }\n \n@@ -3702,8 +3702,8 @@ proc skip_inline_frame_tests {} {\n # inlined functions.  Requires get_compiler_info and get_debug_format.\n \n proc skip_inline_var_tests {} {\n-    # GDB only recognizes inlining information in DWARF 2 (DWARF 3).\n-    if { ! [test_debug_format \"DWARF 2\"] } {\n+    # GDB only recognizes inlining information in DWARF.\n+    if { ! [test_debug_format \"DWARF \\[0-9\\]\"] } {\n \treturn 1\n     }\n "
    }
  ]
}