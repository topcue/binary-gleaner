{
  "sha": "d9eebde01801427330b882d0104aa608788f268d",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDllZWJkZTAxODAxNDI3MzMwYjg4MmQwMTA0YWE2MDg3ODhmMjY4ZA==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-10-29T21:04:33Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-10-29T21:04:40Z"
    },
    "message": "Change add_target_sections_of_objfile to method on program_space\n\nThis changes add_target_sections_of_objfile to be a method on\nprogram_space.  It is renamed to be another overload of\nadd_target_sections, because they are semantically equivalent in a\nsense.\n\ngdb/ChangeLog\n2020-10-29  Tom Tromey  <tom@tromey.com>\n\n\t* symfile.c (add_symbol_file_command): Update.\n\t* exec.c (program_space::add_target_sections): Rename.\n\t* symfile-mem.c (symbol_file_add_from_memory): Update.\n\t* progspace.h (struct program_space) <add_target_sections>:\n\tDeclare new overload.\n\t* exec.h (add_target_sections_of_objfile): Don't declare.",
    "tree": {
      "sha": "a3bf28f764d63974498578f4b9e193a0480cbbad",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/a3bf28f764d63974498578f4b9e193a0480cbbad"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d9eebde01801427330b882d0104aa608788f268d",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d9eebde01801427330b882d0104aa608788f268d",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d9eebde01801427330b882d0104aa608788f268d",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d9eebde01801427330b882d0104aa608788f268d/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "3769e2277d352243fa0121d68efe31ae5edc10d5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3769e2277d352243fa0121d68efe31ae5edc10d5",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/3769e2277d352243fa0121d68efe31ae5edc10d5"
    }
  ],
  "stats": {
    "total": 31,
    "additions": 19,
    "deletions": 12
  },
  "files": [
    {
      "sha": "4096a1bff52b75eed1f53068f0fcf6c578717e47",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d9eebde01801427330b882d0104aa608788f268d/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d9eebde01801427330b882d0104aa608788f268d/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=d9eebde01801427330b882d0104aa608788f268d",
      "patch": "@@ -1,3 +1,12 @@\n+2020-10-29  Tom Tromey  <tom@tromey.com>\n+\n+\t* symfile.c (add_symbol_file_command): Update.\n+\t* exec.c (program_space::add_target_sections): Rename.\n+\t* symfile-mem.c (symbol_file_add_from_memory): Update.\n+\t* progspace.h (struct program_space) <add_target_sections>:\n+\tDeclare new overload.\n+\t* exec.h (add_target_sections_of_objfile): Don't declare.\n+\n 2020-10-29  Tom Tromey  <tom@tromey.com>\n \n \t* solib.c (solib_map_sections): Update."
    },
    {
      "sha": "9c4d9bef908afbb070f4bde421d195c0ad39dd25",
      "filename": "gdb/exec.c",
      "status": "modified",
      "additions": 4,
      "deletions": 5,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d9eebde01801427330b882d0104aa608788f268d/gdb/exec.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d9eebde01801427330b882d0104aa608788f268d/gdb/exec.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/exec.c?ref=d9eebde01801427330b882d0104aa608788f268d",
      "patch": "@@ -628,9 +628,8 @@ program_space::add_target_sections (void *owner,\n /* Add the sections of OBJFILE to the current set of target sections.  */\n \n void\n-add_target_sections_of_objfile (struct objfile *objfile)\n+program_space::add_target_sections (struct objfile *objfile)\n {\n-  target_section_table *table = &current_program_space->target_sections;\n   struct obj_section *osect;\n \n   gdb_assert (objfile != nullptr);\n@@ -641,9 +640,9 @@ add_target_sections_of_objfile (struct objfile *objfile)\n       if (bfd_section_size (osect->the_bfd_section) == 0)\n \tcontinue;\n \n-      table->emplace_back (obj_section_addr (osect),\n-\t\t\t   obj_section_endaddr (osect),\n-\t\t\t   osect->the_bfd_section, (void *) objfile);\n+      target_sections.emplace_back (obj_section_addr (osect),\n+\t\t\t\t    obj_section_endaddr (osect),\n+\t\t\t\t    osect->the_bfd_section, (void *) objfile);\n     }\n }\n "
    },
    {
      "sha": "4ddc6850be1fa4cf2c5fa9cabb06e352df026d64",
      "filename": "gdb/exec.h",
      "status": "modified",
      "additions": 0,
      "deletions": 5,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d9eebde01801427330b882d0104aa608788f268d/gdb/exec.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d9eebde01801427330b882d0104aa608788f268d/gdb/exec.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/exec.h?ref=d9eebde01801427330b882d0104aa608788f268d",
      "patch": "@@ -92,11 +92,6 @@ extern enum target_xfer_status\n /* Set the loaded address of a section.  */\n extern void exec_set_section_address (const char *, int, CORE_ADDR);\n \n-/* Add the sections of OBJFILE to the current set of target sections.\n- * OBJFILE owns the new target sections.  */\n-\n-extern void add_target_sections_of_objfile (struct objfile *objfile);\n-\n /* Prints info about all sections defined in the TABLE.  ABFD is\n    special cased --- it's filename is omitted; if it is the executable\n    file, its entry point is printed.  */"
    },
    {
      "sha": "c141731fa944450735f3551d2bf966af120d2257",
      "filename": "gdb/progspace.h",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d9eebde01801427330b882d0104aa608788f268d/gdb/progspace.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d9eebde01801427330b882d0104aa608788f268d/gdb/progspace.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/progspace.h?ref=d9eebde01801427330b882d0104aa608788f268d",
      "patch": "@@ -305,6 +305,10 @@ struct program_space\n   void add_target_sections (void *owner,\n \t\t\t    const target_section_table &sections);\n \n+  /* Add the sections of OBJFILE to the current set of target\n+     sections.  They are given OBJFILE as the \"owner\".  */\n+  void add_target_sections (struct objfile *objfile);\n+\n   /* Unique ID number.  */\n   int num = 0;\n "
    },
    {
      "sha": "914976ce72a9765e18d9f02763957f3c483f2752",
      "filename": "gdb/symfile-mem.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d9eebde01801427330b882d0104aa608788f268d/gdb/symfile-mem.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d9eebde01801427330b882d0104aa608788f268d/gdb/symfile-mem.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/symfile-mem.c?ref=d9eebde01801427330b882d0104aa608788f268d",
      "patch": "@@ -122,7 +122,7 @@ symbol_file_add_from_memory (struct bfd *templ, CORE_ADDR addr,\n   objf = symbol_file_add_from_bfd (nbfd, bfd_get_filename (nbfd),\n \t\t\t\t   add_flags, &sai, OBJF_SHARED, NULL);\n \n-  add_target_sections_of_objfile (objf);\n+  current_program_space->add_target_sections (objf);\n \n   /* This might change our ideas about frames already looked at.  */\n   reinit_frame_cache ();"
    },
    {
      "sha": "58ed660e52a5dcdddf4a386d4f39664109910424",
      "filename": "gdb/symfile.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d9eebde01801427330b882d0104aa608788f268d/gdb/symfile.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d9eebde01801427330b882d0104aa608788f268d/gdb/symfile.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/symfile.c?ref=d9eebde01801427330b882d0104aa608788f268d",
      "patch": "@@ -2323,7 +2323,7 @@ add_symbol_file_command (const char *args, int from_tty)\n   if (seen_offset)\n     set_objfile_default_section_offset (objf, section_addrs, offset);\n \n-  add_target_sections_of_objfile (objf);\n+  current_program_space->add_target_sections (objf);\n \n   /* Getting new symbols may change our opinion about what is\n      frameless.  */"
    }
  ]
}