{
  "sha": "62253a61473764b0d084b01eff06a93fb38bb2e3",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NjIyNTNhNjE0NzM3NjRiMGQwODRiMDFlZmYwNmE5M2ZiMzhiYjJlMw==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2019-04-11T22:51:48Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2019-04-12T08:28:16Z"
    },
    "message": "gdb: Remove LANG_MAGIC\n\nThe language_defn structure has an la_magic field, this used to be\nused as a basic check that the language_defn structure had the\nexpected layout - at least the end of the structure was where we\nexpected it to be.\n\nThis feature only really makes sense if we imagine GDB dynamically\nloading language support from dynamic libraries, where a version\nmismatch might cause problems.\n\nHowever, in current GDB language support is statically built into GDB,\nand since this commit:\n\n    commit 47e77640be31fc1a4eb3718f594ed5fd0faff065\n    Date:   Thu Jul 20 18:28:01 2017 +0100\n\n        Make language_def O(1)\n\nthe existing (if pointless) check of the la_magic field was removed.\n\nThere now appears to be no use of the la_magic field, and I propose\nthat we delete it.\n\nThere should be no user visible changes after this commit.\n\ngdb/ChangeLog:\n\n\t* ada-lang.c (ada_language_defn): Remove use of LANG_MAGIC.\n\t* c-lang.c (c_language_defn): Likewise.\n\t(cplus_language_defn): Likewise.\n\t(asm_language_defn): Likewise.\n\t(minimal_language_defn): Likewise.\n\t* d-lang.c (d_language_defn): Likewise.\n\t* f-lang.c (f_language_defn): Likewise.\n\t* go-lang.c (go_language_defn): Likewise.\n\t* language.c (unknown_language_defn): Likewise.\n\t(auto_language_defn): Likewise.\n\t* language.h (struct language_defn): Remove la_magic field.\n\t(LANG_MAGIC): Delete.\n\t* m2-lang.c (m2_language_defn): Remove use of LANG_MAGIC.\n\t* objc-lang.c (objc_language_defn): Likewise.\n\t* opencl-lang.c (opencl_language_defn): Likewise.\n\t* p-lang.c (pascal_language_defn): Likewise.\n\t* rust-lang.c (rust_language_defn): Likewise.",
    "tree": {
      "sha": "5c31da87c5f59d737da12b2b6eec015c898ce4f2",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/5c31da87c5f59d737da12b2b6eec015c898ce4f2"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/62253a61473764b0d084b01eff06a93fb38bb2e3",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/62253a61473764b0d084b01eff06a93fb38bb2e3",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/62253a61473764b0d084b01eff06a93fb38bb2e3",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/62253a61473764b0d084b01eff06a93fb38bb2e3/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "3822612df0694cc07597e534fa73b34aa2540812",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3822612df0694cc07597e534fa73b34aa2540812",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/3822612df0694cc07597e534fa73b34aa2540812"
    }
  ],
  "stats": {
    "total": 73,
    "additions": 35,
    "deletions": 38
  },
  "files": [
    {
      "sha": "33bcef307e83d63916385677541e59afcca3c590",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 20,
      "deletions": 0,
      "changes": 20,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -1,3 +1,23 @@\n+2019-04-12  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* ada-lang.c (ada_language_defn): Remove use of LANG_MAGIC.\n+\t* c-lang.c (c_language_defn): Likewise.\n+\t(cplus_language_defn): Likewise.\n+\t(asm_language_defn): Likewise.\n+\t(minimal_language_defn): Likewise.\n+\t* d-lang.c (d_language_defn): Likewise.\n+\t* f-lang.c (f_language_defn): Likewise.\n+\t* go-lang.c (go_language_defn): Likewise.\n+\t* language.c (unknown_language_defn): Likewise.\n+\t(auto_language_defn): Likewise.\n+\t* language.h (struct language_defn): Remove la_magic field.\n+\t(LANG_MAGIC): Delete.\n+\t* m2-lang.c (m2_language_defn): Remove use of LANG_MAGIC.\n+\t* objc-lang.c (objc_language_defn): Likewise.\n+\t* opencl-lang.c (opencl_language_defn): Likewise.\n+\t* p-lang.c (pascal_language_defn): Likewise.\n+\t* rust-lang.c (rust_language_defn): Likewise.\n+\n 2019-04-11  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* riscv-tdep.c (riscv_type_align): New function."
    },
    {
      "sha": "ccf8ed8039e93459a249cc3710424f2322b6ec5b",
      "filename": "gdb/ada-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/ada-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/ada-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ada-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -14380,8 +14380,7 @@ extern const struct language_defn ada_language_defn = {\n   default_search_name_hash,\n   &ada_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n /* Command-list for the \"set/show ada\" prefix command.  */"
    },
    {
      "sha": "33506f1d1ed14518fad7bee6d163d240c885385f",
      "filename": "gdb/c-lang.c",
      "status": "modified",
      "additions": 4,
      "deletions": 8,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/c-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/c-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/c-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -873,8 +873,7 @@ extern const struct language_defn c_language_defn =\n   default_search_name_hash,\n   &c_varobj_ops,\n   c_get_compile_context,\n-  c_compute_program,\n-  LANG_MAGIC\n+  c_compute_program\n };\n \n enum cplus_primitive_types {\n@@ -1018,8 +1017,7 @@ extern const struct language_defn cplus_language_defn =\n   cp_search_name_hash,\n   &cplus_varobj_ops,\n   cplus_get_compile_context,\n-  cplus_compute_program,\n-  LANG_MAGIC\n+  cplus_compute_program\n };\n \n static const char *asm_extensions[] =\n@@ -1072,8 +1070,7 @@ extern const struct language_defn asm_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n /* The following language_defn does not represent a real language.\n@@ -1126,6 +1123,5 @@ extern const struct language_defn minimal_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };"
    },
    {
      "sha": "08b638009ff06de4c40dad71bfffb1745e28652e",
      "filename": "gdb/d-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/d-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/d-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/d-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -250,8 +250,7 @@ extern const struct language_defn d_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n /* Build all D language types for the specified architecture.  */"
    },
    {
      "sha": "f3a806e7a6f68fa015545c51fcd613b9eaadfda2",
      "filename": "gdb/f-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/f-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/f-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/f-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -377,8 +377,7 @@ extern const struct language_defn f_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n static void *"
    },
    {
      "sha": "f74cee4ccd8b0e16cc54f453fb903f9aa8f2ae54",
      "filename": "gdb/go-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/go-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/go-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/go-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -611,8 +611,7 @@ extern const struct language_defn go_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n static void *"
    },
    {
      "sha": "954e4c200f09fa5abc13f324d1e6327f77735a64",
      "filename": "gdb/language.c",
      "status": "modified",
      "additions": 2,
      "deletions": 4,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/language.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/language.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/language.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -876,8 +876,7 @@ const struct language_defn unknown_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n /* These two structs define fake entries for the \"local\" and \"auto\"\n@@ -927,8 +926,7 @@ const struct language_defn auto_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n \f"
    },
    {
      "sha": "3e0bc9d0d462f1b223eee4a2496a389b584dc17a",
      "filename": "gdb/language.h",
      "status": "modified",
      "additions": 0,
      "deletions": 8,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/language.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/language.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/language.h?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -449,16 +449,8 @@ struct language_defn\n \t\t\t\t       struct gdbarch *gdbarch,\n \t\t\t\t       const struct block *expr_block,\n \t\t\t\t       CORE_ADDR expr_pc);\n-\n-    /* Add fields above this point, so the magic number is always last.  */\n-    /* Magic number for compat checking.  */\n-\n-    long la_magic;\n-\n   };\n \n-#define LANG_MAGIC\t910823L\n-\n /* Pointer to the language_defn for our current language.  This pointer\n    always points to *some* valid struct; it can be used without checking\n    it for validity."
    },
    {
      "sha": "b4eb2628571e4ea69b320167602f3a764590c231",
      "filename": "gdb/m2-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/m2-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/m2-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/m2-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -398,8 +398,7 @@ extern const struct language_defn m2_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n static void *"
    },
    {
      "sha": "1853a69e7542eb4c87c0cfdcdad1f943c0dad355",
      "filename": "gdb/objc-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/objc-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/objc-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/objc-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -408,8 +408,7 @@ extern const struct language_defn objc_language_defn = {\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n /*"
    },
    {
      "sha": "c1ea66eea3924a9c71d38ae9fea36e1da0e75c91",
      "filename": "gdb/opencl-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/opencl-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/opencl-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/opencl-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -1086,8 +1086,7 @@ extern const struct language_defn opencl_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };\n \n static void *"
    },
    {
      "sha": "9340861761b36bd14610c28bc96ff1e61a064c83",
      "filename": "gdb/p-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/p-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/p-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/p-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -459,6 +459,5 @@ extern const struct language_defn pascal_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };"
    },
    {
      "sha": "9a123c338ef5c1a6e4a22ad3a5d5c84fd88394bc",
      "filename": "gdb/rust-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/rust-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/62253a61473764b0d084b01eff06a93fb38bb2e3/gdb/rust-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/rust-lang.c?ref=62253a61473764b0d084b01eff06a93fb38bb2e3",
      "patch": "@@ -2141,6 +2141,5 @@ extern const struct language_defn rust_language_defn =\n   default_search_name_hash,\n   &default_varobj_ops,\n   NULL,\n-  NULL,\n-  LANG_MAGIC\n+  NULL\n };"
    }
  ]
}