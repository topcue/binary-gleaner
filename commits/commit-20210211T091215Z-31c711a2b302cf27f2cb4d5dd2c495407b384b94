{
  "sha": "31c711a2b302cf27f2cb4d5dd2c495407b384b94",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MzFjNzExYTJiMzAyY2YyN2YyY2I0ZDVkZDJjNDk1NDA3YjM4NGI5NA==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-02-11T06:26:22Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-02-11T09:12:15Z"
    },
    "message": "PR27294, avr OOM\n\n\tPR 27294\n\t* elf32-avr.c (avr_elf32_load_records_from_section): Use\n\tbfd_malloc_and_get_section.  Use bfd_byte* vars and remove then\n\tunnecessary casts.",
    "tree": {
      "sha": "77088bdbd9186f338321b4cd422be00e1169ae7e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/77088bdbd9186f338321b4cd422be00e1169ae7e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/31c711a2b302cf27f2cb4d5dd2c495407b384b94",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/31c711a2b302cf27f2cb4d5dd2c495407b384b94",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/31c711a2b302cf27f2cb4d5dd2c495407b384b94",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/31c711a2b302cf27f2cb4d5dd2c495407b384b94/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "1cfcf3004e1830f8fe9112cfcd15285508d2c2b7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1cfcf3004e1830f8fe9112cfcd15285508d2c2b7",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/1cfcf3004e1830f8fe9112cfcd15285508d2c2b7"
    }
  ],
  "stats": {
    "total": 23,
    "additions": 15,
    "deletions": 8
  },
  "files": [
    {
      "sha": "8fb42f9fd14172a5142d11c57a0799999ce89dee",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/31c711a2b302cf27f2cb4d5dd2c495407b384b94/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/31c711a2b302cf27f2cb4d5dd2c495407b384b94/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=31c711a2b302cf27f2cb4d5dd2c495407b384b94",
      "patch": "@@ -1,3 +1,10 @@\n+2021-02-11  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 27294\n+\t* elf32-avr.c (avr_elf32_load_records_from_section): Use\n+\tbfd_malloc_and_get_section.  Use bfd_byte* vars and remove then\n+\tunnecessary casts.\n+\n 2021-02-11  Alan Modra  <amodra@gmail.com>\n \n \tPR 27291"
    },
    {
      "sha": "ed38ff8bb02b25863c50bfabef396b3b466677ac",
      "filename": "bfd/elf32-avr.c",
      "status": "modified",
      "additions": 8,
      "deletions": 8,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/31c711a2b302cf27f2cb4d5dd2c495407b384b94/bfd/elf32-avr.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/31c711a2b302cf27f2cb4d5dd2c495407b384b94/bfd/elf32-avr.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf32-avr.c?ref=31c711a2b302cf27f2cb4d5dd2c495407b384b94",
      "patch": "@@ -4001,7 +4001,7 @@ avr_find_section_for_address (bfd *abfd ATTRIBUTE_UNUSED,\n static struct avr_property_record_list *\n avr_elf32_load_records_from_section (bfd *abfd, asection *sec)\n {\n-  char *contents = NULL, *ptr;\n+  bfd_byte *contents, *ptr;\n   bfd_size_type size, mem_size;\n   bfd_byte version, flags;\n   uint16_t record_count, i;\n@@ -4011,9 +4011,8 @@ avr_elf32_load_records_from_section (bfd *abfd, asection *sec)\n \n   fs_data.section = NULL;\n \n-  size = bfd_section_size (sec);\n-  contents = bfd_malloc (size);\n-  bfd_get_section_contents (abfd, sec, contents, 0, size);\n+  if (!bfd_malloc_and_get_section (abfd, sec, &contents))\n+    goto load_failed;\n   ptr = contents;\n \n   /* Load the relocations for the '.avr.prop' section if there are any, and\n@@ -4032,15 +4031,16 @@ avr_elf32_load_records_from_section (bfd *abfd, asection *sec)\n   */\n \n   /* Check we have at least got a headers worth of bytes.  */\n+  size = bfd_section_size (sec);\n   if (size < AVR_PROPERTY_SECTION_HEADER_SIZE)\n     goto load_failed;\n \n-  version = *((bfd_byte *) ptr);\n+  version = *ptr;\n   ptr++;\n-  flags = *((bfd_byte *) ptr);\n+  flags = *ptr;\n   ptr++;\n   record_count = bfd_get_16 (abfd, ptr);\n-  ptr+=2;\n+  ptr += 2;\n   BFD_ASSERT (ptr - contents == AVR_PROPERTY_SECTION_HEADER_SIZE);\n \n   /* Now allocate space for the list structure, and all of the list\n@@ -4135,7 +4135,7 @@ avr_elf32_load_records_from_section (bfd *abfd, asection *sec)\n \t    = address - bfd_section_vma (fs_data.section);\n \t}\n \n-      r_list->records [i].type = *((bfd_byte *) ptr);\n+      r_list->records [i].type = *ptr;\n       ptr += 1;\n       size -= 1;\n "
    }
  ]
}