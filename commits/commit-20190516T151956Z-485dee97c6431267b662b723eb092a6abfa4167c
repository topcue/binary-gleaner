{
  "sha": "485dee97c6431267b662b723eb092a6abfa4167c",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NDg1ZGVlOTdjNjQzMTI2N2I2NjJiNzIzZWIwOTJhNmFiZmE0MTY3Yw==",
  "commit": {
    "author": {
      "name": "Andre Vieira",
      "email": "andre.simoesdiasvieira@arm.com",
      "date": "2019-05-15T15:52:50Z"
    },
    "committer": {
      "name": "Andre Vieira",
      "email": "andre.simoesdiasvieira@arm.com",
      "date": "2019-05-16T15:19:56Z"
    },
    "message": "[PATCH 3/57][Arm][GAS] Add support for MVE instructions: vabs and vneg\n\ngas/ChangeLog:\n2019-05-16  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\t* config/tc-arm.c (do_neon_abs_neg): Make it accept MVE variant.\n\t(insns): Change vabs and vneg entries to accept MVE variants.\n\t* testsuite/gas/arm/mve-vabsneg-bad-1.d: New test.\n\t* testsuite/gas/arm/mve-vabsneg-bad-1.l: New test.\n\t* testsuite/gas/arm/mve-vabsneg-bad-1.s: New test.\n\t* testsuite/gas/arm/mve-vabsneg-bad-2.d: New test.\n\t* testsuite/gas/arm/mve-vabsneg-bad-2.l: New test.\n\t* testsuite/gas/arm/mve-vabsneg-bad-2.s: New test.",
    "tree": {
      "sha": "cab930e1494cab890d7114f1364b97b6916a9346",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/cab930e1494cab890d7114f1364b97b6916a9346"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/485dee97c6431267b662b723eb092a6abfa4167c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/485dee97c6431267b662b723eb092a6abfa4167c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/485dee97c6431267b662b723eb092a6abfa4167c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/485dee97c6431267b662b723eb092a6abfa4167c/comments",
  "author": {
    "login": "avieira-arm",
    "id": 68072104,
    "node_id": "MDQ6VXNlcjY4MDcyMTA0",
    "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/avieira-arm",
    "html_url": "https://github.com/avieira-arm",
    "followers_url": "https://api.github.com/users/avieira-arm/followers",
    "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}",
    "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions",
    "organizations_url": "https://api.github.com/users/avieira-arm/orgs",
    "repos_url": "https://api.github.com/users/avieira-arm/repos",
    "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/avieira-arm/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "avieira-arm",
    "id": 68072104,
    "node_id": "MDQ6VXNlcjY4MDcyMTA0",
    "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/avieira-arm",
    "html_url": "https://github.com/avieira-arm",
    "followers_url": "https://api.github.com/users/avieira-arm/followers",
    "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}",
    "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions",
    "organizations_url": "https://api.github.com/users/avieira-arm/orgs",
    "repos_url": "https://api.github.com/users/avieira-arm/repos",
    "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/avieira-arm/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5ee9134313f9cce06d38144f5bc77c59e04df884",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5ee9134313f9cce06d38144f5bc77c59e04df884",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5ee9134313f9cce06d38144f5bc77c59e04df884"
    }
  ],
  "stats": {
    "total": 167,
    "additions": 161,
    "deletions": 6
  },
  "files": [
    {
      "sha": "c94dd339e4d4cf6217c9d39f4d3840eed16011ad",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/485dee97c6431267b662b723eb092a6abfa4167c/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/485dee97c6431267b662b723eb092a6abfa4167c/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=485dee97c6431267b662b723eb092a6abfa4167c",
      "patch": "@@ -1,3 +1,14 @@\n+2019-05-16  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n+\n+\t* config/tc-arm.c (do_neon_abs_neg): Make it accept MVE variant.\n+\t(insns): Change vabs and vneg entries to accept MVE variants.\n+\t* testsuite/gas/arm/mve-vabsneg-bad-1.d: New test.\n+\t* testsuite/gas/arm/mve-vabsneg-bad-1.l: New test.\n+\t* testsuite/gas/arm/mve-vabsneg-bad-1.s: New test.\n+\t* testsuite/gas/arm/mve-vabsneg-bad-2.d: New test.\n+\t* testsuite/gas/arm/mve-vabsneg-bad-2.l: New test.\n+\t* testsuite/gas/arm/mve-vabsneg-bad-2.s: New test.\n+\n 2019-05-16  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n \n \t* config/tc-arm.c (enum it_instruction_type): Rename to..."
    },
    {
      "sha": "8b1e9fc62625dc3dbef2dc7e6cd6246c05c0b534",
      "filename": "gas/config/tc-arm.c",
      "status": "modified",
      "additions": 7,
      "deletions": 6,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/485dee97c6431267b662b723eb092a6abfa4167c/gas/config/tc-arm.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/485dee97c6431267b662b723eb092a6abfa4167c/gas/config/tc-arm.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-arm.c?ref=485dee97c6431267b662b723eb092a6abfa4167c",
      "patch": "@@ -15950,12 +15950,13 @@ do_neon_abs_neg (void)\n   if (try_vfp_nsyn (2, do_vfp_nsyn_abs_neg) == SUCCESS)\n     return;\n \n-  if (vfp_or_neon_is_neon (NEON_CHECK_CC | NEON_CHECK_ARCH) == FAIL)\n-    return;\n-\n   rs = neon_select_shape (NS_DD, NS_QQ, NS_NULL);\n   et = neon_check_type (2, rs, N_EQK, N_S_32 | N_F_16_32 | N_KEY);\n \n+  if (check_simd_pred_availability (et.type == NT_float,\n+\t\t\t\t    NEON_CHECK_ARCH | NEON_CHECK_CC))\n+    return;\n+\n   inst.instruction |= LOW4 (inst.operands[0].reg) << 12;\n   inst.instruction |= HI1 (inst.operands[0].reg) << 22;\n   inst.instruction |= LOW4 (inst.operands[1].reg);\n@@ -21909,9 +21910,6 @@ static const struct asm_opcode insns[] =\n  nCEF(vmla,     _vmla,    3, (RNSDQ, oRNSDQ, RNSDQ_RNSC), neon_mac_maybe_scalar),\n  nCEF(vmls,     _vmls,    3, (RNSDQ, oRNSDQ, RNSDQ_RNSC), neon_mac_maybe_scalar),\n \n- NCEF(vabs,     1b10300, 2, (RNSDQ, RNSDQ), neon_abs_neg),\n- NCEF(vneg,     1b10380, 2, (RNSDQ, RNSDQ), neon_abs_neg),\n-\n  NCE(vldm,      c900b00, 2, (RRnpctw, VRSDLST), neon_ldm_stm),\n  NCE(vldmia,    c900b00, 2, (RRnpctw, VRSDLST), neon_ldm_stm),\n  NCE(vldmdb,    d100b00, 2, (RRnpctw, VRSDLST), neon_ldm_stm),\n@@ -22643,6 +22641,9 @@ static const struct asm_opcode insns[] =\n  mnCEF(vadd,     _vadd,    3, (RNSDQMQ, oRNSDQMQ, RNSDQMQR), neon_addsub_if_i),\n  mnCEF(vsub,     _vsub,    3, (RNSDQMQ, oRNSDQMQ, RNSDQMQR), neon_addsub_if_i),\n \n+ MNCEF(vabs,  1b10300,\t2, (RNSDQMQ, RNSDQMQ),\tneon_abs_neg),\n+ MNCEF(vneg,  1b10380,\t2, (RNSDQMQ, RNSDQMQ),\tneon_abs_neg),\n+\n #undef ARM_VARIANT\n #define ARM_VARIANT & fpu_neon_ext_v1\n  mnUF(vabd,      _vabd,    3, (RNDQMQ, oRNDQMQ, RNDQMQ), neon_dyadic_if_su),"
    },
    {
      "sha": "493583356033700df415498c55f17a6e9c0be42f",
      "filename": "gas/testsuite/gas/arm/mve-vabsneg-bad-1.d",
      "status": "added",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-1.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-1.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/arm/mve-vabsneg-bad-1.d?ref=485dee97c6431267b662b723eb092a6abfa4167c",
      "patch": "@@ -0,0 +1,6 @@\n+#name: bad MVE VABS and VNEG instructions\n+#as: -march=armv8.1-m.main+mve\n+#error_output: mve-vabsneg-bad-1.l\n+\n+.*: +file format .*arm.*\n+"
    },
    {
      "sha": "46fda8b53f72aac4da99f02e88e5c7d95fdc1716",
      "filename": "gas/testsuite/gas/arm/mve-vabsneg-bad-1.l",
      "status": "added",
      "additions": 33,
      "deletions": 0,
      "changes": 33,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-1.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-1.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/arm/mve-vabsneg-bad-1.l?ref=485dee97c6431267b662b723eb092a6abfa4167c",
      "patch": "@@ -0,0 +1,33 @@\n+[^:]*: Assembler messages:\n+[^:]*:13: Error: bad type in SIMD instruction -- `vabs.p8 q0,q1'\n+[^:]*:14: Error: bad type in SIMD instruction -- `vabs.p16 q0,q1'\n+[^:]*:15: Error: bad type in SIMD instruction -- `vabs.u8 q0,q1'\n+[^:]*:16: Error: bad type in SIMD instruction -- `vabs.u16 q0,q1'\n+[^:]*:17: Error: bad type in SIMD instruction -- `vabs.u32 q0,q1'\n+[^:]*:18: Error: selected FPU does not support instruction -- `vabs.f16 q0,q1'\n+[^:]*:19: Error: selected FPU does not support instruction -- `vabs.f32 q0,q1'\n+[^:]*:20: Error: bad type in SIMD instruction -- `vabs.s64 q0,q1'\n+[^:]*:21: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:21: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:21: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:21: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:21: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:21: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:22: Error: bad type in SIMD instruction -- `vneg.p8 q0,q1'\n+[^:]*:23: Error: bad type in SIMD instruction -- `vneg.p16 q0,q1'\n+[^:]*:24: Error: bad type in SIMD instruction -- `vneg.u8 q0,q1'\n+[^:]*:25: Error: bad type in SIMD instruction -- `vneg.u16 q0,q1'\n+[^:]*:26: Error: bad type in SIMD instruction -- `vneg.u32 q0,q1'\n+[^:]*:27: Error: selected FPU does not support instruction -- `vneg.f16 q0,q1'\n+[^:]*:28: Error: selected FPU does not support instruction -- `vneg.f32 q0,q1'\n+[^:]*:29: Error: bad type in SIMD instruction -- `vneg.s64 q0,q1'\n+[^:]*:30: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:30: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:30: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:30: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:30: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:30: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:32: Error: syntax error -- `vnegeq.s32 q0,q1'\n+[^:]*:33: Error: syntax error -- `vnegeq.s32 q0,q1'\n+[^:]*:35: Error: instruction missing MVE vector predication code -- `vneg.s32 q0,q1'\n+[^:]*:36: Error: vector predicated instruction should be in VPT/VPST block -- `vnegt.s32 q0,q1'"
    },
    {
      "sha": "cda955ccc486300cc2e33bc50f5eee0517d9bdad",
      "filename": "gas/testsuite/gas/arm/mve-vabsneg-bad-1.s",
      "status": "added",
      "additions": 37,
      "deletions": 0,
      "changes": 37,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-1.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-1.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/arm/mve-vabsneg-bad-1.s?ref=485dee97c6431267b662b723eb092a6abfa4167c",
      "patch": "@@ -0,0 +1,37 @@\n+.macro cond op\n+.irp cond, eq, ne, gt, ge, lt, le\n+it \\cond\n+\\op\\().s32 q0, q1\n+.endr\n+.endm\n+\n+\n+\n+.syntax unified\n+.text\n+.thumb\n+vabs.p8 q0, q1\n+vabs.p16 q0, q1\n+vabs.u8 q0, q1\n+vabs.u16 q0, q1\n+vabs.u32 q0, q1\n+vabs.f16 q0, q1\n+vabs.f32 q0, q1\n+vabs.s64 q0, q1\n+cond vabs\n+vneg.p8 q0, q1\n+vneg.p16 q0, q1\n+vneg.u8 q0, q1\n+vneg.u16 q0, q1\n+vneg.u32 q0, q1\n+vneg.f16 q0, q1\n+vneg.f32 q0, q1\n+vneg.s64 q0, q1\n+cond vneg\n+it eq\n+vnegeq.s32 q0, q1\n+vnegeq.s32 q0, q1\n+vpst\n+vneg.s32 q0, q1\n+vnegt.s32 q0, q1\n+"
    },
    {
      "sha": "14d0137fd0b3188a255f885ffe8a810f81c15c7a",
      "filename": "gas/testsuite/gas/arm/mve-vabsneg-bad-2.d",
      "status": "added",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-2.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-2.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/arm/mve-vabsneg-bad-2.d?ref=485dee97c6431267b662b723eb092a6abfa4167c",
      "patch": "@@ -0,0 +1,6 @@\n+#name: bad MVE FP VABS and VNEG instructions\n+#as: -march=armv8.1-m.main+mve.fp\n+#error_output: mve-vabsneg-bad-2.l\n+\n+.*: +file format .*arm.*\n+"
    },
    {
      "sha": "26bd0f49c9f7603d310e3300405a96beec79943f",
      "filename": "gas/testsuite/gas/arm/mve-vabsneg-bad-2.l",
      "status": "added",
      "additions": 29,
      "deletions": 0,
      "changes": 29,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-2.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-2.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/arm/mve-vabsneg-bad-2.l?ref=485dee97c6431267b662b723eb092a6abfa4167c",
      "patch": "@@ -0,0 +1,29 @@\n+[^:]*: Assembler messages:\n+[^:]*:13: Error: bad type in SIMD instruction -- `vabs.p8 q0,q1'\n+[^:]*:14: Error: bad type in SIMD instruction -- `vabs.p16 q0,q1'\n+[^:]*:15: Error: bad type in SIMD instruction -- `vabs.u8 q0,q1'\n+[^:]*:16: Error: bad type in SIMD instruction -- `vabs.u16 q0,q1'\n+[^:]*:17: Error: bad type in SIMD instruction -- `vabs.u32 q0,q1'\n+[^:]*:18: Error: bad type in SIMD instruction -- `vabs.s64 q0,q1'\n+[^:]*:19: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:19: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:19: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:19: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:19: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:19: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:20: Error: bad type in SIMD instruction -- `vneg.p8 q0,q1'\n+[^:]*:21: Error: bad type in SIMD instruction -- `vneg.p16 q0,q1'\n+[^:]*:22: Error: bad type in SIMD instruction -- `vneg.u8 q0,q1'\n+[^:]*:23: Error: bad type in SIMD instruction -- `vneg.u16 q0,q1'\n+[^:]*:24: Error: bad type in SIMD instruction -- `vneg.u32 q0,q1'\n+[^:]*:25: Error: bad type in SIMD instruction -- `vneg.s64 q0,q1'\n+[^:]*:26: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:26: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:26: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:26: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:26: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:26: Warning: instruction is UNPREDICTABLE in an IT block\n+[^:]*:28: Error: syntax error -- `vnegeq.f32 q0,q1'\n+[^:]*:29: Error: syntax error -- `vnegeq.f32 q0,q1'\n+[^:]*:31: Error: instruction missing MVE vector predication code -- `vneg.f32 q0,q1'\n+[^:]*:32: Error: vector predicated instruction should be in VPT/VPST block -- `vnegt.f32 q0,q1'"
    },
    {
      "sha": "aff2e410ab0b934ea520b9ea63c84701f607a510",
      "filename": "gas/testsuite/gas/arm/mve-vabsneg-bad-2.s",
      "status": "added",
      "additions": 32,
      "deletions": 0,
      "changes": 32,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-2.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/485dee97c6431267b662b723eb092a6abfa4167c/gas/testsuite/gas/arm/mve-vabsneg-bad-2.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/arm/mve-vabsneg-bad-2.s?ref=485dee97c6431267b662b723eb092a6abfa4167c",
      "patch": "@@ -0,0 +1,32 @@\n+.macro cond op\n+.irp cond, eq, ne, gt, ge, lt, le\n+it \\cond\n+\\op\\().s32 q0, q1\n+.endr\n+.endm\n+\n+\n+\n+.syntax unified\n+.text\n+.thumb\n+vabs.p8 q0, q1\n+vabs.p16 q0, q1\n+vabs.u8 q0, q1\n+vabs.u16 q0, q1\n+vabs.u32 q0, q1\n+vabs.s64 q0, q1\n+cond vabs\n+vneg.p8 q0, q1\n+vneg.p16 q0, q1\n+vneg.u8 q0, q1\n+vneg.u16 q0, q1\n+vneg.u32 q0, q1\n+vneg.s64 q0, q1\n+cond vneg\n+it eq\n+vnegeq.f32 q0, q1\n+vnegeq.f32 q0, q1\n+vpst\n+vneg.f32 q0, q1\n+vnegt.f32 q0, q1"
    }
  ]
}