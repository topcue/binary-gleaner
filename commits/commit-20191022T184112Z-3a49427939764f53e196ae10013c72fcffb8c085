{
  "sha": "3a49427939764f53e196ae10013c72fcffb8c085",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6M2E0OTQyNzkzOTc2NGY1M2UxOTZhZTEwMDEzYzcyZmNmZmI4YzA4NQ==",
  "commit": {
    "author": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-10-22T18:37:37Z"
    },
    "committer": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-10-22T18:41:12Z"
    },
    "message": "Fix compile error & incorrect push\n\nI accidentally pushed the wrong version of the patch for commit\n7bb43059820c5febb4509b15202a93efde442bc6 (where the review\ncomments were not fixed), and I did a bad conflict resolution\nfor ccb1ba62299edce72053dd567b9d384814e11885 leading to a\ncompile error when libxxhash is available. This fixes both\nissues.\n\ngdb/ChangeLog:\n\n2019-10-22  Christian Biesinger  <cbiesinger@google.com>\n\n\t* symtab.c (struct demangled_name_entry): Add a constructor.\n\t(free_demangled_name_entry): New function to call the destructor\n\tfor demangled_name_entry.\n\t(create_demangled_names_hash): Pass free_demangled_name_entry to\n\thtab_create_alloc.\n\t(symbol_set_names): Call placement new for demangled_name_entry.\n\t* utils.c: No longer include xxhash.h here, now that fast_hash\n\tis inlined in the header.\n\t* utils.h: Instead, include it here.\n\nChange-Id: If776099d39a65a12733d42efcb859feca1b07a39",
    "tree": {
      "sha": "3fd19bc98d4e2d2b6b6cce5f182683c61d4f6d92",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/3fd19bc98d4e2d2b6b6cce5f182683c61d4f6d92"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/3a49427939764f53e196ae10013c72fcffb8c085",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3a49427939764f53e196ae10013c72fcffb8c085",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/3a49427939764f53e196ae10013c72fcffb8c085",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3a49427939764f53e196ae10013c72fcffb8c085/comments",
  "author": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ccb1ba62299edce72053dd567b9d384814e11885",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ccb1ba62299edce72053dd567b9d384814e11885",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/ccb1ba62299edce72053dd567b9d384814e11885"
    }
  ],
  "stats": {
    "total": 43,
    "additions": 34,
    "deletions": 9
  },
  "files": [
    {
      "sha": "8255a8540c9feb30d688fdcd931a45e85af31744",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3a49427939764f53e196ae10013c72fcffb8c085/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3a49427939764f53e196ae10013c72fcffb8c085/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=3a49427939764f53e196ae10013c72fcffb8c085",
      "patch": "@@ -1,3 +1,15 @@\n+2019-10-22  Christian Biesinger  <cbiesinger@google.com>\n+\n+\t* symtab.c (struct demangled_name_entry): Add a constructor.\n+\t(free_demangled_name_entry): New function to call the destructor\n+\tfor demangled_name_entry.\n+\t(create_demangled_names_hash): Pass free_demangled_name_entry to\n+\thtab_create_alloc.\n+\t(symbol_set_names): Call placement new for demangled_name_entry.\n+\t* utils.c: No longer include xxhash.h here, now that fast_hash\n+\tis inlined in the header.\n+\t* utils.h: Instead, include it here.\n+\n 2019-10-22  Christian Biesinger  <cbiesinger@google.com>\n \n \t* Makefile.in: Link with libxxhash."
    },
    {
      "sha": "ed55cecc730a38dcadf2afa325f332e72a8b337d",
      "filename": "gdb/symtab.c",
      "status": "modified",
      "additions": 18,
      "deletions": 5,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3a49427939764f53e196ae10013c72fcffb8c085/gdb/symtab.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3a49427939764f53e196ae10013c72fcffb8c085/gdb/symtab.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/symtab.c?ref=3a49427939764f53e196ae10013c72fcffb8c085",
      "patch": "@@ -715,6 +715,9 @@ symbol_set_language (struct general_symbol_info *gsymbol,\n /* Objects of this type are stored in the demangled name hash table.  */\n struct demangled_name_entry\n {\n+  demangled_name_entry (gdb::string_view mangled_name)\n+    : mangled (mangled_name) {}\n+\n   gdb::string_view mangled;\n   ENUM_BITFIELD(language) language : LANGUAGE_BITS;\n   char demangled[1];\n@@ -744,6 +747,15 @@ eq_demangled_name_entry (const void *a, const void *b)\n   return da->mangled == db->mangled;\n }\n \n+static void\n+free_demangled_name_entry (void *data)\n+{\n+  struct demangled_name_entry *e\n+    = (struct demangled_name_entry *) data;\n+\n+  e->~demangled_name_entry();\n+}\n+\n /* Create the hash table used for demangled names.  Each hash entry is\n    a pair of strings; one for the mangled name and one for the demangled\n    name.  The entry is hashed via just the mangled name.  */\n@@ -758,7 +770,7 @@ create_demangled_names_hash (struct objfile_per_bfd_storage *per_bfd)\n \n   per_bfd->demangled_names_hash.reset (htab_create_alloc\n     (256, hash_demangled_name_entry, eq_demangled_name_entry,\n-     NULL, xcalloc, xfree));\n+     free_demangled_name_entry, xcalloc, xfree));\n }\n \n /* Try to determine the demangled name for a symbol, based on the\n@@ -819,7 +831,6 @@ symbol_set_names (struct general_symbol_info *gsymbol,\n   struct demangled_name_entry **slot;\n   /* A 0-terminated copy of the linkage name.  */\n   const char *linkage_name_copy;\n-  struct demangled_name_entry entry;\n \n   if (gsymbol->language == language_ada)\n     {\n@@ -857,7 +868,7 @@ symbol_set_names (struct general_symbol_info *gsymbol,\n   else\n     linkage_name_copy = linkage_name;\n \n-  entry.mangled = gdb::string_view (linkage_name_copy, len);\n+  struct demangled_name_entry entry (gdb::string_view (linkage_name_copy, len));\n   slot = ((struct demangled_name_entry **)\n \t  htab_find_slot (per_bfd->demangled_names_hash.get (),\n \t\t\t  &entry, INSERT));\n@@ -890,7 +901,8 @@ symbol_set_names (struct general_symbol_info *gsymbol,\n \t       obstack_alloc (&per_bfd->storage_obstack,\n \t\t\t      offsetof (struct demangled_name_entry, demangled)\n \t\t\t      + demangled_len + 1));\n-\t  (*slot)->mangled = gdb::string_view (linkage_name, len);\n+\t  new (*slot) demangled_name_entry\n+\t    (gdb::string_view (linkage_name, len));\n \t}\n       else\n \t{\n@@ -906,7 +918,8 @@ symbol_set_names (struct general_symbol_info *gsymbol,\n \t\t\t      + len + demangled_len + 2));\n \t  mangled_ptr = &((*slot)->demangled[demangled_len + 1]);\n \t  strcpy (mangled_ptr, linkage_name_copy);\n-\t  (*slot)->mangled = gdb::string_view (mangled_ptr, len);\n+\t  new (*slot) demangled_name_entry\n+\t    (gdb::string_view (mangled_ptr, len));\n \t}\n       (*slot)->language = gsymbol->language;\n "
    },
    {
      "sha": "3afb8e5945f5b15d49b0c815d05d13c9467330a5",
      "filename": "gdb/utils.c",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3a49427939764f53e196ae10013c72fcffb8c085/gdb/utils.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3a49427939764f53e196ae10013c72fcffb8c085/gdb/utils.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/utils.c?ref=3a49427939764f53e196ae10013c72fcffb8c085",
      "patch": "@@ -36,10 +36,6 @@\n #include <pc.h>\n #endif\n \n-#ifdef HAVE_LIBXXHASH\n-#include <xxhash.h>\n-#endif\n-\n #include <signal.h>\n #include \"gdbcmd.h\"\n #include \"serial.h\""
    },
    {
      "sha": "e837621a2bdfdb483d81794c58cfa5b03c5abd20",
      "filename": "gdb/utils.h",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3a49427939764f53e196ae10013c72fcffb8c085/gdb/utils.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3a49427939764f53e196ae10013c72fcffb8c085/gdb/utils.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/utils.h?ref=3a49427939764f53e196ae10013c72fcffb8c085",
      "patch": "@@ -25,6 +25,10 @@\n #include \"gdbsupport/scoped_restore.h\"\n #include <chrono>\n \n+#ifdef HAVE_LIBXXHASH\n+#include <xxhash.h>\n+#endif\n+\n struct completion_match_for_lcd;\n class compiled_regex;\n "
    }
  ]
}