{
  "sha": "8f57f343104b8d3632e65ac1fbb12ee69891ef5f",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OGY1N2YzNDMxMDRiOGQzNjMyZTY1YWMxZmJiMTJlZTY5ODkxZWY1Zg==",
  "commit": {
    "author": {
      "name": "Pedro Alves",
      "email": "pedro@palves.net",
      "date": "2020-08-28T17:44:39Z"
    },
    "committer": {
      "name": "Pedro Alves",
      "email": "pedro@palves.net",
      "date": "2020-08-28T17:44:39Z"
    },
    "message": "Fix gdb.base/advance-until-multiple-locations.exp with some compilers\n\nThe tests in gdb.base/advance-until-multiple-locations.exp that expect\nthe program to stop at a caller fail on some systems, depending on\ncompiler.  E.g., with Clang 10, I see:\n\n advance ovld_func\n 0x00000000004011a3 in test () at /home/pedro/gdb/binutils-gdb/src/gdb/testsuite/gdb.base/advance-until-multiple-locations.cc:51\n 51        ovld_func ();\n (gdb) FAIL: gdb.base/advance-until-multiple-locations.exp: advance_overload: second advance stops at caller\n\nAnd Tom de Vries saw:\n\n ...\n (gdb) until ovld_func^M\n main () at advance-until-multiple-locations.cc:61^M\n 61      }^M\n (gdb) FAIL: gdb.base/advance-until-multiple-locations.exp:until_overload: until ovld_func\n ...\n\nWhich exact line the program stops is not important.  All we care\nabout here is that the program stopped at the caller function.\n\nSo fix it by adjusting the patterns to match the frame header/function\nreported by the breakpoint hits instead of the source lines text.\n\nTested against:\n\n - gcc {4.8, 4.9, 7.3.1, 9.3.0, trunk-20200828}\n - clang {5.0.2, 10}\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.base/advance-until-multiple-locations.exp\n\t(advance_overload, until_overload): Adjust to match the\n\tframe/function header instead of the source line text.",
    "tree": {
      "sha": "1854e250d8b41e568149b6333bcee41ff7dca7ff",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/1854e250d8b41e568149b6333bcee41ff7dca7ff"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/8f57f343104b8d3632e65ac1fbb12ee69891ef5f",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8f57f343104b8d3632e65ac1fbb12ee69891ef5f",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/8f57f343104b8d3632e65ac1fbb12ee69891ef5f",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8f57f343104b8d3632e65ac1fbb12ee69891ef5f/comments",
  "author": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e0814aae5f16c06d82fde23f8bea15eea205aa54",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e0814aae5f16c06d82fde23f8bea15eea205aa54",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e0814aae5f16c06d82fde23f8bea15eea205aa54"
    }
  ],
  "stats": {
    "total": 10,
    "additions": 8,
    "deletions": 2
  },
  "files": [
    {
      "sha": "af4444040b8dc13d112a78b99f49bec8f76cd33d",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8f57f343104b8d3632e65ac1fbb12ee69891ef5f/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8f57f343104b8d3632e65ac1fbb12ee69891ef5f/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=8f57f343104b8d3632e65ac1fbb12ee69891ef5f",
      "patch": "@@ -1,3 +1,9 @@\n+2020-08-28  Pedro Alves  <pedro@palves.net>\n+\n+\t* gdb.base/advance-until-multiple-locations.exp\n+\t(advance_overload, until_overload): Adjust to match the\n+\tframe/function header instead of the source line text.\n+\n 2020-08-28  Tom de Vries  <tdevries@suse.de>\n \n \t* gdb.base/label-without-address.c: New test."
    },
    {
      "sha": "0f919b46d4bb69008c8b64206139e734e42eaae2",
      "filename": "gdb/testsuite/gdb.base/advance-until-multiple-locations.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8f57f343104b8d3632e65ac1fbb12ee69891ef5f/gdb/testsuite/gdb.base/advance-until-multiple-locations.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8f57f343104b8d3632e65ac1fbb12ee69891ef5f/gdb/testsuite/gdb.base/advance-until-multiple-locations.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/advance-until-multiple-locations.exp?ref=8f57f343104b8d3632e65ac1fbb12ee69891ef5f",
      "patch": "@@ -104,7 +104,7 @@ proc_with_prefix advance_overload {} {\n     # Need to issue the advance twice, because advance also stops upon\n     # exit from the current stack frame.\n     gdb_test \"advance ovld_func\" \\\n-\t\"ovld_func \\\\(0\\\\);.*\" \\\n+\t\"test \\\\(\\\\) at .*\" \\\n \t\"second advance stops at caller\"\n \n     gdb_test \"advance ovld_func\" \\\n@@ -129,7 +129,7 @@ proc_with_prefix until_overload {} {\n     # ovld_func is a different frame, so it shouldn't cause a stop.\n     # Instead, the program should stop at the caller frame.\n     gdb_test \"until ovld_func\" \\\n-\t\"main .* at .*return test \\\\(\\\\);.*\"\n+\t\"main \\\\(\\\\) at .*\"\n }\n \n foreach_with_prefix cmd {\"until\" \"advance\"} {"
    }
  ]
}