{
  "sha": "4780e5e4933a2497a5aecc4ceabbbb8e82aaf822",
  "node_id": "C_kwDOANOeidoAKDQ3ODBlNWU0OTMzYTI0OTdhNWFlY2M0Y2VhYmJiYjhlODJhYWY4MjI",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-11-26T08:59:45Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-11-26T08:59:45Z"
    },
    "message": "[gas] Fix file 0 dir with -gdwarf-5\n\nIn out_dir_and_file_list, if file 0 is copied from file 1, only the filename\nis copied, and the dir and md5 fields are left to their default values.\n\nFix this by adding the copy of the dir and md5 fields.\n\ngas/ChangeLog:\n\n2021-11-26  Tom de Vries  <tdevries@suse.de>\n\n\tPR 28629\n\t* dwarf2dbg.c (out_dir_and_file_list): When copying file 1 to file 0,\n\talso copy dir and md5 fields.\n\t* testsuite/gas/i386/dwarf5-line-4.d: Adjust expected output.",
    "tree": {
      "sha": "27bd71b7c86c6e12faa9027fa7ee882e50ce68d2",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/27bd71b7c86c6e12faa9027fa7ee882e50ce68d2"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "c0f9d658279d4d352672e283df53c1072925fc97",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c0f9d658279d4d352672e283df53c1072925fc97",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c0f9d658279d4d352672e283df53c1072925fc97"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 16,
    "deletions": 3
  },
  "files": [
    {
      "sha": "c2886ee75573fa44f0ff950bf78e1a9ec0c19b2f",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=4780e5e4933a2497a5aecc4ceabbbb8e82aaf822",
      "patch": "@@ -1,3 +1,10 @@\n+2021-11-26  Tom de Vries  <tdevries@suse.de>\n+\n+\tPR 28629\n+\t* dwarf2dbg.c (out_dir_and_file_list): When copying file 1 to file 0,\n+\talso copy dir and md5 fields.\n+\t* testsuite/gas/i386/dwarf5-line-4.d: Adjust expected output.\n+\n 2021-11-18  Nick Clifton  <nickc@redhat.com>\n \n \t* as.c (parse_args): Add support for --multibyte-handling."
    },
    {
      "sha": "7300bfe26483d3819c9234c8d65d1ab45c84fbec",
      "filename": "gas/dwarf2dbg.c",
      "status": "modified",
      "additions": 8,
      "deletions": 2,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822/gas/dwarf2dbg.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822/gas/dwarf2dbg.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/dwarf2dbg.c?ref=4780e5e4933a2497a5aecc4ceabbbb8e82aaf822",
      "patch": "@@ -2123,7 +2123,7 @@ out_dir_and_file_list (segT line_seg, int sizeof_offset)\n   size_t size;\n   const char *dir;\n   char *cp;\n-  unsigned int i;\n+  unsigned int i, j;\n   bool emit_md5 = false;\n   bool emit_timestamps = true;\n   bool emit_filesize = true;\n@@ -2275,7 +2275,13 @@ out_dir_and_file_list (segT line_seg, int sizeof_offset)\n \t     .file 0 directive.  If that isn't used, but file 1 is,\n \t     then use that as main file name.  */\n \t  if (DWARF2_LINE_VERSION >= 5 && i == 0 && files_in_use >= 1 && files[0].filename == NULL)\n-\t    files[0].filename = files[1].filename;\n+\t    {\n+\t      files[0].filename = files[1].filename;\n+\t      files[0].dir = files[1].dir;\n+\t      if (emit_md5)\n+\t\tfor (j = 0; i < NUM_MD5_BYTES; ++j)\n+\t\t  files[0].md5[j] = files[1].md5[j];\n+\t    }\n \t  else\n \t    files[i].filename = \"\";\n \t  if (DWARF2_LINE_VERSION < 5 || i != 0)"
    },
    {
      "sha": "a3af48eda8ccaf753a27ed83181723dd84a08768",
      "filename": "gas/testsuite/gas/i386/dwarf5-line-4.d",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822/gas/testsuite/gas/i386/dwarf5-line-4.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4780e5e4933a2497a5aecc4ceabbbb8e82aaf822/gas/testsuite/gas/i386/dwarf5-line-4.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/dwarf5-line-4.d?ref=4780e5e4933a2497a5aecc4ceabbbb8e82aaf822",
      "patch": "@@ -38,7 +38,7 @@ Raw dump of debug contents of section \\.z?debug_line:\n \n  The File Name Table \\(offset 0x.*, lines 2, columns 2\\):\n   Entry\tDir\tName\n-  0\t0\t\\(indirect line string, offset: 0x.*\\): dwarf5-line-4.s\n+  0\t1\t\\(indirect line string, offset: 0x.*\\): dwarf5-line-4.s\n   1\t1\t\\(indirect line string, offset: 0x.*\\): dwarf5-line-4.s\n \n  Line Number Statements:"
    }
  ]
}