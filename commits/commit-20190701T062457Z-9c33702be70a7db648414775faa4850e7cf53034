{
  "sha": "9c33702be70a7db648414775faa4850e7cf53034",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OWMzMzcwMmJlNzBhN2RiNjQ4NDE0Nzc1ZmFhNDg1MGU3Y2Y1MzAzNA==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2019-07-01T06:24:57Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2019-07-01T06:24:57Z"
    },
    "message": "x86: warn about insns exceeding the 15-byte limit\n\nSuch insns will cause #UD when an attempt to execute them is made.\n\nSee also http://www.sandpile.org/x86/opc_enc.htm.",
    "tree": {
      "sha": "98134d3f024fc2aace411ec6e89a32d50116aa23",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/98134d3f024fc2aace411ec6e89a32d50116aa23"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/9c33702be70a7db648414775faa4850e7cf53034",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9c33702be70a7db648414775faa4850e7cf53034",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/9c33702be70a7db648414775faa4850e7cf53034",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9c33702be70a7db648414775faa4850e7cf53034/comments",
  "author": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "36cc073ef40f2cb9cb834cdb5d543fbb284f2b32",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/36cc073ef40f2cb9cb834cdb5d543fbb284f2b32",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/36cc073ef40f2cb9cb834cdb5d543fbb284f2b32"
    }
  ],
  "stats": {
    "total": 146,
    "additions": 146,
    "deletions": 0
  },
  "files": [
    {
      "sha": "b4bf405b98a96e5e92d50cc65663685cd82fd2d8",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9c33702be70a7db648414775faa4850e7cf53034/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9c33702be70a7db648414775faa4850e7cf53034/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=9c33702be70a7db648414775faa4850e7cf53034",
      "patch": "@@ -1,3 +1,13 @@\n+2019-07-01  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* tc-i386.c (encoding_length): New.\n+\t(output_insn): Use it.\n+\t* testsuite/gas/i386/oversized16.l,\n+\ttestsuite/gas/i386/oversized16.s,\n+\ttestsuite/gas/i386/oversized64.l,\n+\ttestsuite/gas/i386/oversized64.s: New.\n+\t* testsuite/gas/i386/i386.exp: Run new tests.\n+\n 2019-06-27  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR binutils/24719"
    },
    {
      "sha": "84c4bc5020a3a52deea881efe74fd142a73d474e",
      "filename": "gas/config/tc-i386.c",
      "status": "modified",
      "additions": 32,
      "deletions": 0,
      "changes": 32,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9c33702be70a7db648414775faa4850e7cf53034/gas/config/tc-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9c33702be70a7db648414775faa4850e7cf53034/gas/config/tc-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.c?ref=9c33702be70a7db648414775faa4850e7cf53034",
      "patch": "@@ -8123,6 +8123,25 @@ x86_cleanup (void)\n }\n #endif\n \n+static unsigned int\n+encoding_length (const fragS *start_frag, offsetT start_off,\n+\t\t const char *frag_now_ptr)\n+{\n+  unsigned int len = 0;\n+\n+  if (start_frag != frag_now)\n+    {\n+      const fragS *fr = start_frag;\n+\n+      do {\n+\tlen += fr->fr_fix;\n+\tfr = fr->fr_next;\n+      } while (fr && fr != frag_now);\n+    }\n+\n+  return len - start_off + (frag_now_ptr - frag_now->fr_literal);\n+}\n+\n static void\n output_insn (void)\n {\n@@ -8400,6 +8419,19 @@ output_insn (void)\n \n       if (i.imm_operands)\n \toutput_imm (insn_start_frag, insn_start_off);\n+\n+      /*\n+       * frag_now_fix () returning plain abs_section_offset when we're in the\n+       * absolute section, and abs_section_offset not getting updated as data\n+       * gets added to the frag breaks the logic below.\n+       */\n+      if (now_seg != absolute_section)\n+\t{\n+\t  j = encoding_length (insn_start_frag, insn_start_off, frag_more (0));\n+\t  if (j > 15)\n+\t    as_warn (_(\"instruction length of %u bytes exceeds the limit of 15\"),\n+\t\t     j);\n+\t}\n     }\n \n #ifdef DEBUG386"
    },
    {
      "sha": "1b4fcb6200b2897bb33075ac4b010b04770a1543",
      "filename": "gas/testsuite/gas/i386/i386.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/i386.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/i386.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/i386.exp?ref=9c33702be70a7db648414775faa4850e7cf53034",
      "patch": "@@ -130,6 +130,7 @@ if [expr ([istarget \"i*86-*-*\"] ||  [istarget \"x86_64-*-*\"]) && [gas_32_check]]\n     run_dump_test \"nops-7\"\n     run_dump_test \"addr16\"\n     run_dump_test \"addr32\"\n+    run_list_test \"oversized16\" \"-al\"\n     run_dump_test \"sse4_1\"\n     run_dump_test \"sse4_1-intel\"\n     run_dump_test \"sse4_2\"\n@@ -722,6 +723,7 @@ if [expr ([istarget \"i*86-*-*\"] || [istarget \"x86_64-*-*\"]) && [gas_64_check]] t\n     run_list_test \"x86-64-suffix-bad\"\n     run_list_test \"unspec64\" \"\"\n     run_list_test \"prefix64\" \"-al\"\n+    run_list_test \"oversized64\" \"-al\"\n     run_dump_test \"x86-64-fxsave\"\n     run_dump_test \"x86-64-fxsave-intel\"\n     run_dump_test \"x86-64-arch-1\""
    },
    {
      "sha": "3bf7e1d809561296930390574a4af94b76d2d1d3",
      "filename": "gas/testsuite/gas/i386/oversized16.l",
      "status": "added",
      "additions": 41,
      "deletions": 0,
      "changes": 41,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/oversized16.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/oversized16.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/oversized16.l?ref=9c33702be70a7db648414775faa4850e7cf53034",
      "patch": "@@ -0,0 +1,41 @@\n+.*: Assembler messages:\n+.*:6: Warning: instruction length.*\n+.*:7: Warning: instruction length.*\n+.*:8: Warning: instruction length.*\n+.*:10: Warning: instruction length.*\n+.*:11: Warning: instruction length.*\n+GAS LISTING .*\n+\n+\n+[ \t]*1[ \t]+\\.text\n+[ \t]*2[ \t]+\\.intel_syntax noprefix\n+[ \t]*3[ \t]+\\.code16\n+[ \t]*4[ \t]+\n+[ \t]*5[ \t]+long16:\n+[ \t]*6[ \t]+0000 26678FEA[ \t]+lwpins\teax, es:\\[eax\\*8\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*6[ \t]+781204C5[ \t]*\n+[ \t]*6[ \t]+00000000[ \t]*\n+[ \t]*6[ \t]+44332211[ \t]*\n+[ \t]*7[ \t]+0010 26678FEA[ \t]+lwpval\teax, es:\\[eax\\*4\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*7[ \t]+78120C85[ \t]*\n+[ \t]*7[ \t]+00000000[ \t]*\n+[ \t]*7[ \t]+44332211[ \t]*\n+[ \t]*8[ \t]+0020 26678FEA[ \t]+bextr\teax, es:\\[eax\\*2\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*8[ \t]+78100445[ \t]*\n+[ \t]*8[ \t]+00000000[ \t]*\n+[ \t]*8[ \t]+44332211[ \t]*\n+[ \t]*9[ \t]+\n+[ \t]*10[ \t]+0030 266766F2[ \t]+xacquire lock add dword ptr es:\\[eax\\*2\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*10[ \t]+F0810445[ \t]*\n+[ \t]*10[ \t]+00000000[ \t]*\n+[ \t]*10[ \t]+44332211[ \t]*\n+[ \t]*11[ \t]+0040 266766F3[ \t]+xrelease lock sub dword ptr es:\\[eax\\*2\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*11[ \t]+F0812C45[ \t]*\n+[ \t]*11[ \t]+00000000[ \t]*\n+[ \t]*11[ \t]+44332211[ \t]*\n+#pass"
    },
    {
      "sha": "8b250d018550cdf9f1aa5820e7d20f48fcd3bb9b",
      "filename": "gas/testsuite/gas/i386/oversized16.s",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/oversized16.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/oversized16.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/oversized16.s?ref=9c33702be70a7db648414775faa4850e7cf53034",
      "patch": "@@ -0,0 +1,11 @@\n+\t.text\n+\t.intel_syntax noprefix\n+\t.code16\n+\n+long16:\n+\tlwpins\teax, es:[eax*8], 0x11223344\n+\tlwpval\teax, es:[eax*4], 0x11223344\n+\tbextr\teax, es:[eax*2], 0x11223344\n+\n+\txacquire lock add dword ptr es:[eax*2], 0x11223344\n+\txrelease lock sub dword ptr es:[eax*2], 0x11223344"
    },
    {
      "sha": "dc63fb5ae7702066ce46bba21bb759bc4039e825",
      "filename": "gas/testsuite/gas/i386/oversized64.l",
      "status": "added",
      "additions": 40,
      "deletions": 0,
      "changes": 40,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/oversized64.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/oversized64.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/oversized64.l?ref=9c33702be70a7db648414775faa4850e7cf53034",
      "patch": "@@ -0,0 +1,40 @@\n+.*: Assembler messages:\n+.*:5: Warning: instruction length.*\n+.*:6: Warning: instruction length.*\n+.*:7: Warning: instruction length.*\n+.*:9: Warning: instruction length.*\n+.*:10: Warning: instruction length.*\n+GAS LISTING .*\n+\n+\n+[ \t]*1[ \t]+\\.text\n+[ \t]*2[ \t]+\\.intel_syntax noprefix\n+[ \t]*3[ \t]+\n+[ \t]*4[ \t]+long64:\n+[ \t]*5[ \t]+0000 64678FEA[ \t]+lwpins\trax, fs:\\[eax\\*8\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*5[ \t]+F81204C5[ \t]*\n+[ \t]*5[ \t]+00000000[ \t]*\n+[ \t]*5[ \t]+44332211[ \t]*\n+[ \t]*6[ \t]+0010 64678FEA[ \t]+lwpval\teax, fs:\\[eax\\*4\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*6[ \t]+78120C85[ \t]*\n+[ \t]*6[ \t]+00000000[ \t]*\n+[ \t]*6[ \t]+44332211[ \t]*\n+[ \t]*7[ \t]+0020 64678FEA[ \t]+bextr\trax, fs:\\[eax\\*2\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*7[ \t]+F8100445[ \t]*\n+[ \t]*7[ \t]+00000000[ \t]*\n+[ \t]*7[ \t]+44332211[ \t]*\n+[ \t]*8[ \t]+\n+[ \t]*9[ \t]+0030 6567F2F0[ \t]+xacquire lock add qword ptr gs:\\[eax\\*8\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*9[ \t]+488104C5[ \t]*\n+[ \t]*9[ \t]+00000000[ \t]*\n+[ \t]*9[ \t]+44332211[ \t]*\n+[ \t]*10[ \t]+0040 6567F3F0[ \t]+xrelease lock sub qword ptr gs:\\[eax\\*8\\], 0x11223344\n+\\*\\*\\*\\*  Warning: instruction length of 16 bytes exceeds the limit of 15\n+[ \t]*10[ \t]+48812CC5[ \t]*\n+[ \t]*10[ \t]+00000000[ \t]*\n+[ \t]*10[ \t]+44332211[ \t]*\n+#pass"
    },
    {
      "sha": "9db09af3f152d02ed6341320660f39504e8da79f",
      "filename": "gas/testsuite/gas/i386/oversized64.s",
      "status": "added",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/oversized64.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9c33702be70a7db648414775faa4850e7cf53034/gas/testsuite/gas/i386/oversized64.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/oversized64.s?ref=9c33702be70a7db648414775faa4850e7cf53034",
      "patch": "@@ -0,0 +1,10 @@\n+\t.text\n+\t.intel_syntax noprefix\n+\n+long64:\n+\tlwpins\trax, fs:[eax*8], 0x11223344\n+\tlwpval\teax, fs:[eax*4], 0x11223344\n+\tbextr\trax, fs:[eax*2], 0x11223344\n+\n+\txacquire lock add qword ptr gs:[eax*8], 0x11223344\n+\txrelease lock sub qword ptr gs:[eax*8], 0x11223344"
    }
  ]
}