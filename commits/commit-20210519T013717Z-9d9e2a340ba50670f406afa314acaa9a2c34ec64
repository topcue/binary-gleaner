{
  "sha": "9d9e2a340ba50670f406afa314acaa9a2c34ec64",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OWQ5ZTJhMzQwYmE1MDY3MGY0MDZhZmEzMTRhY2FhOWEyYzM0ZWM2NA==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-05-18T14:09:35Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-05-19T01:37:17Z"
    },
    "message": "PR27879, stack-buffer-overflow on sysdump\n\n\tPR 27879\n\t* sysdump.c (getBARRAY): Sanity check size against max.\n\t(getINT): Avoid UB shift left.",
    "tree": {
      "sha": "bcc32796dccb71d476a428b785d0a9ab5222f7af",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/bcc32796dccb71d476a428b785d0a9ab5222f7af"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/9d9e2a340ba50670f406afa314acaa9a2c34ec64",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9d9e2a340ba50670f406afa314acaa9a2c34ec64",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/9d9e2a340ba50670f406afa314acaa9a2c34ec64",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9d9e2a340ba50670f406afa314acaa9a2c34ec64/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "75933ce3d95005bf763fa5c1275725aa6c591dc1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/75933ce3d95005bf763fa5c1275725aa6c591dc1",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/75933ce3d95005bf763fa5c1275725aa6c591dc1"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 14,
    "deletions": 5
  },
  "files": [
    {
      "sha": "6767729d705bb29838d70351beba42347b84e978",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9d9e2a340ba50670f406afa314acaa9a2c34ec64/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9d9e2a340ba50670f406afa314acaa9a2c34ec64/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=9d9e2a340ba50670f406afa314acaa9a2c34ec64",
      "patch": "@@ -1,3 +1,9 @@\n+2021-05-19  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 27879\n+\t* sysdump.c (getBARRAY): Sanity check size against max.\n+\t(getINT): Avoid UB shift left.\n+\n 2021-05-15  Alan Modra  <amodra@gmail.com>\n \n \t* dwarf.c (process_cu_tu_index): Avoid pointer UB.  Use _mul_overflow."
    },
    {
      "sha": "35796e829a025b9032440207ca62fa7cd189cbf2",
      "filename": "binutils/sysdump.c",
      "status": "modified",
      "additions": 8,
      "deletions": 5,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9d9e2a340ba50670f406afa314acaa9a2c34ec64/binutils/sysdump.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9d9e2a340ba50670f406afa314acaa9a2c34ec64/binutils/sysdump.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/sysdump.c?ref=9d9e2a340ba50670f406afa314acaa9a2c34ec64",
      "patch": "@@ -131,19 +131,21 @@ fillup (unsigned char *ptr)\n }\n \n static barray\n-getBARRAY (unsigned char *ptr, int *idx, int dsize ATTRIBUTE_UNUSED,\n-\t   int max ATTRIBUTE_UNUSED)\n+getBARRAY (unsigned char *ptr, int *idx, int dsize ATTRIBUTE_UNUSED, int max)\n {\n   barray res;\n   int i;\n   int byte = *idx / 8;\n-  int size = ptr[byte++];\n+  int size = 0;\n+\n+  if (byte < max)\n+    size = ptr[byte++];\n \n   res.len = size;\n   res.data = (unsigned char *) xmalloc (size);\n \n   for (i = 0; i < size; i++)\n-    res.data[i] = ptr[byte++];\n+    res.data[i] = byte < max ? ptr[byte++] : 0;\n \n   return res;\n }\n@@ -179,7 +181,8 @@ getINT (unsigned char *ptr, int *idx, int size, int max)\n       n = (ptr[byte + 0] << 8) + ptr[byte + 1];\n       break;\n     case 4:\n-      n = (ptr[byte + 0] << 24) + (ptr[byte + 1] << 16) + (ptr[byte + 2] << 8) + (ptr[byte + 3]);\n+      n = (((unsigned) ptr[byte + 0] << 24) + (ptr[byte + 1] << 16)\n+\t   + (ptr[byte + 2] << 8) + (ptr[byte + 3]));\n       break;\n     default:\n       fatal (_(\"Unsupported read size: %d\"), size);"
    }
  ]
}