{
  "sha": "8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OGM3NGE3NjRmMmNmNWVhNWU2OTk3ZTM1YmEwZjc1NWZlMmMwOTg4OQ==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-06-12T11:29:43Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-06-12T11:29:43Z"
    },
    "message": "[gdb/testsuite] Don't leak tuiterm.exp spawn override\n\nIn lib/tuiterm.exp the builtin spawn is overridden by a tui-specific version.\n\nAfter running the first test-case that imports tuiterm.exp, the override\nremains active, so it can cause trouble in subsequent test-cases, even if they\ndo not import tuiterm.exp.  See f.i. commit c8d4f6dfd9 \"[gdb/testsuite] Fix\nspawn in tuiterm.exp\".\n\nFix this by:\n- adding a variable gdb_finish_hooks which is a list of procs to run during\n  gdb_finish\n- adding a proc tuiterm_env that is used in test-cases instead of\n  \"load_lib tuiterm.exp\".\n- letting tuiterm_env:\n  - install the tui-specific spawn version, and\n  - use the gdb_finish_hooks to schedule restoring the builtin spawn\n    version.\n\nTested on x86_64-linux.\n\ngdb/testsuite/ChangeLog:\n\n2020-06-12  Tom de Vries  <tdevries@suse.de>\n\n\t* lib/tuiterm.exp (spawn): Rename to ...\n\t(tui_spawn): ... this.\n\t(toplevel): Move rename of spawn ...\n\t(gdb_init_tuiterm): ... here.  New proc.\n\t(gdb_finish_tuiterm): New proc.\n\t* lib/gdb.exp (gdb_finish_hooks): New global var.\n\t(gdb_finish): Handle gdb_finish_hooks.\n\t(tuiterm_env): New proc.\n\t* gdb.python/tui-window.exp: Replace load_lib tuiterm.exp with\n\ttuiterm_env.\n\t* gdb.tui/basic.exp: Same.\n\t* gdb.tui/corefile-run.exp: Same.\n\t* gdb.tui/empty.exp: Same.\n\t* gdb.tui/list-before.exp: Same.\n\t* gdb.tui/list.exp: Same.\n\t* gdb.tui/main.exp: Same.\n\t* gdb.tui/new-layout.exp: Same.\n\t* gdb.tui/regs.exp: Same.\n\t* gdb.tui/resize.exp: Same.\n\t* gdb.tui/tui-layout-asm-short-prog.exp: Same.\n\t* gdb.tui/tui-layout-asm.exp: Same.\n\t* gdb.tui/tui-missing-src.exp: Same.\n\t* gdb.tui/winheight.exp: Same.",
    "tree": {
      "sha": "c845c9044ec75facfa8df2e9e7c5cc331ef7fe93",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c845c9044ec75facfa8df2e9e7c5cc331ef7fe93"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "26783bce15adc0316f9167a216519cebcf1ccac3",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/26783bce15adc0316f9167a216519cebcf1ccac3",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/26783bce15adc0316f9167a216519cebcf1ccac3"
    }
  ],
  "stats": {
    "total": 94,
    "additions": 78,
    "deletions": 16
  },
  "files": [
    {
      "sha": "ef36759304f2ba4c8446bc30071ff279cbbfa961",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 26,
      "deletions": 0,
      "changes": 26,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -1,3 +1,29 @@\n+2020-06-12  Tom de Vries  <tdevries@suse.de>\n+\n+\t* lib/tuiterm.exp (spawn): Rename to ...\n+\t(tui_spawn): ... this.\n+\t(toplevel): Move rename of spawn ...\n+\t(gdb_init_tuiterm): ... here.  New proc.\n+\t(gdb_finish_tuiterm): New proc.\n+\t* lib/gdb.exp (gdb_finish_hooks): New global var.\n+\t(gdb_finish): Handle gdb_finish_hooks.\n+\t(tuiterm_env): New proc.\n+\t* gdb.python/tui-window.exp: Replace load_lib tuiterm.exp with\n+\ttuiterm_env.\n+\t* gdb.tui/basic.exp: Same.\n+\t* gdb.tui/corefile-run.exp: Same.\n+\t* gdb.tui/empty.exp: Same.\n+\t* gdb.tui/list-before.exp: Same.\n+\t* gdb.tui/list.exp: Same.\n+\t* gdb.tui/main.exp: Same.\n+\t* gdb.tui/new-layout.exp: Same.\n+\t* gdb.tui/regs.exp: Same.\n+\t* gdb.tui/resize.exp: Same.\n+\t* gdb.tui/tui-layout-asm-short-prog.exp: Same.\n+\t* gdb.tui/tui-layout-asm.exp: Same.\n+\t* gdb.tui/tui-missing-src.exp: Same.\n+\t* gdb.tui/winheight.exp: Same.\n+\n 2020-06-12  Tom de Vries  <tdevries@suse.de>\n \n \tPR testsuite/26110"
    },
    {
      "sha": "503823a2296d6e45b77890aee275be4631f99e19",
      "filename": "gdb/testsuite/gdb.python/tui-window.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.python/tui-window.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.python/tui-window.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.python/tui-window.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -16,7 +16,7 @@\n # Test a TUI window implemented in Python.\n \n load_lib gdb-python.exp\n-load_lib tuiterm.exp\n+tuiterm_env\n \n # This test doesn't care about the inferior.\n standard_testfile py-arch.c"
    },
    {
      "sha": "3e013a95151c297cd7c4b40a5b19d766d6cf0f36",
      "filename": "gdb/testsuite/gdb.tui/basic.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/basic.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/basic.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/basic.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Basic TUI tests.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "1878770bdcd146d050a6c49f8b1ed27096aaf5f1",
      "filename": "gdb/testsuite/gdb.tui/corefile-run.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/corefile-run.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/corefile-run.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/corefile-run.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -18,7 +18,7 @@\n #\n # Ref.: https://bugzilla.redhat.com/show_bug.cgi?id=1765117\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "89f49d6b7f9a35107732111f878b88d2dae5cfd4",
      "filename": "gdb/testsuite/gdb.tui/empty.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/empty.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/empty.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/empty.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Test TUI resizing with empty windows.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile\n "
    },
    {
      "sha": "9c5eb5655ea93e48ec0bdb9e9a3489036f8a2679",
      "filename": "gdb/testsuite/gdb.tui/list-before.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/list-before.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/list-before.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/list-before.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Ensure that \"list\" before starting the TUI will affect the view.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "b1e59499c87e13a86cde047d87cad83cd1437215",
      "filename": "gdb/testsuite/gdb.tui/list.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/list.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/list.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/list.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Ensure that \"list\" will switch to the source view.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "fd3c2cd8157b04271998a39edc93e0c667555758",
      "filename": "gdb/testsuite/gdb.tui/main.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/main.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/main.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/main.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Test that \"file\" shows \"main\".\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "3ea4dd4069932b9c25a8b200f8c8e145c67eb1a4",
      "filename": "gdb/testsuite/gdb.tui/new-layout.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/new-layout.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/new-layout.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/new-layout.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Test \"tui new-layout\".\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "a9296a7d5faabd5bdf86fed9270bc06df73991de",
      "filename": "gdb/testsuite/gdb.tui/regs.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/regs.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/regs.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/regs.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Simple test of TUI register window.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "fd1b35088af0ae127b63f4bd9e43953b2cbe3c36",
      "filename": "gdb/testsuite/gdb.tui/resize.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/resize.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/resize.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/resize.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Test TUI resizing.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "50cb61f0faa2927bc4b5e8f2aae2af7c5f108ddb",
      "filename": "gdb/testsuite/gdb.tui/tui-layout-asm-short-prog.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/tui-layout-asm-short-prog.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/tui-layout-asm-short-prog.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/tui-layout-asm-short-prog.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -16,7 +16,7 @@\n # Ensure that 'layout asm' can scroll away from the last line of a\n # very short program using a page up sized scroll.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout-asm-short-prog.S\n "
    },
    {
      "sha": "44f7a3a3a4f5cbbdf3d7c8ebacf15de822402b08",
      "filename": "gdb/testsuite/gdb.tui/tui-layout-asm.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/tui-layout-asm.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/tui-layout-asm.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/tui-layout-asm.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -16,7 +16,7 @@\n # Ensure that 'layout asm' before starting the inferior puts us in the\n # asm layout and displays the disassembly for main.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "6b5c7fad4c414cf5dbcfa5557b4a9274909c3a19",
      "filename": "gdb/testsuite/gdb.tui/tui-missing-src.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/tui-missing-src.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/tui-missing-src.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/tui-missing-src.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -25,7 +25,7 @@\n #    layout must show the contents of f2.c.\n # 7. Going back to main() shall result in no contents again.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile\n "
    },
    {
      "sha": "8ac55f847236206b631a9ca038b6d38aba7b87c6",
      "filename": "gdb/testsuite/gdb.tui/winheight.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/winheight.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/gdb.tui/winheight.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/winheight.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -15,7 +15,7 @@\n \n # Test the \"winheight\" command.\n \n-load_lib \"tuiterm.exp\"\n+tuiterm_env\n \n standard_testfile tui-layout.c\n "
    },
    {
      "sha": "e7fce6fee0ba0b49f088dd96dfa73149f73cc0df",
      "filename": "gdb/testsuite/lib/gdb.exp",
      "status": "modified",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/lib/gdb.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/lib/gdb.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/gdb.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -25,6 +25,9 @@ if {$tool == \"\"} {\n     exit 2\n }\n \n+# List of procs to run in gdb_finish.\n+set gdb_finish_hooks [list]\n+\n load_lib libgloss.exp\n load_lib cache.exp\n load_lib gdb-utils.exp\n@@ -5241,6 +5244,12 @@ proc gdb_finish { } {\n \t}\n \tset banned_traced 0\n     }\n+\n+    global gdb_finish_hooks\n+    foreach gdb_finish_hook $gdb_finish_hooks {\n+\t$gdb_finish_hook\n+    }\n+    set gdb_finish_hooks [list]\n }\n \n global debug_format\n@@ -7259,5 +7268,19 @@ proc with_override { name override body } {\n     return $result\n }\n \n+# Setup tuiterm.exp environment.  To be used in test-cases instead of\n+# \"load_lib tuiterm.exp\".  Calls initialization function and schedules\n+# finalization function.\n+proc tuiterm_env { } {\n+    load_lib tuiterm.exp\n+\n+    # Do initialization.\n+    tuiterm_env_init\n+\n+    # Schedule finalization.\n+    global gdb_finish_hooks\n+    lappend gdb_finish_hooks tuiterm_env_finish\n+}\n+\n # Always load compatibility stuff.\n load_lib future.exp"
    },
    {
      "sha": "44cbc79730adfd2bd568e2c7757c603c66a94cbd",
      "filename": "gdb/testsuite/lib/tuiterm.exp",
      "status": "modified",
      "additions": 15,
      "deletions": 2,
      "changes": 17,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/lib/tuiterm.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/8c74a764f2cf5ea5e6997e35ba0f755fe2c09889/gdb/testsuite/lib/tuiterm.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/tuiterm.exp?ref=8c74a764f2cf5ea5e6997e35ba0f755fe2c09889",
      "patch": "@@ -19,8 +19,7 @@\n # array; but dejagnu doesn't export this globally.  So, we have to\n # wrap spawn with our own function, so that we can capture this value.\n # The value is later used in calls to stty.\n-rename spawn builtin_spawn\n-proc spawn {args} {\n+proc tuiterm_spawn { args } {\n     set result [uplevel builtin_spawn $args]\n     global gdb_spawn_name\n     upvar spawn_out spawn_out\n@@ -32,6 +31,20 @@ proc spawn {args} {\n     return $result\n }\n \n+# Initialize tuiterm.exp environment.\n+proc tuiterm_env_init { } {\n+    # Override spawn with tui_spawn.\n+    rename spawn builtin_spawn\n+    rename tuiterm_spawn spawn\n+}\n+\n+# Finalize tuiterm.exp environment.\n+proc tuiterm_env_finish { } {\n+    # Restore spawn.\n+    rename spawn tuiterm_spawn\n+    rename builtin_spawn spawn\n+}\n+\n namespace eval Term {\n     variable _rows\n     variable _cols"
    }
  ]
}