{
  "sha": "5a8edb756a56cdfb563006cbc39561994acf6d2d",
  "node_id": "C_kwDOANOeidoAKDVhOGVkYjc1NmE1NmNkZmI1NjMwMDZjYmMzOTU2MTk5NGFjZjZkMmQ",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2021-10-18T18:32:18Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2021-10-19T19:30:59Z"
    },
    "message": "Check index in type::field\n\nThis changes gdb to check the index that is passed to type::field.\nThis caught one bug in the Ada code when running the test suite\n(actually I found the bug first, then realized that the check would\nhave helped), so this patch fixes that as well.\n\nRegression tested on x86-64 Fedora 34.",
    "tree": {
      "sha": "58e9c09bd17adc4f1dcde2868f8b3c8c7478b21b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/58e9c09bd17adc4f1dcde2868f8b3c8c7478b21b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/5a8edb756a56cdfb563006cbc39561994acf6d2d",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5a8edb756a56cdfb563006cbc39561994acf6d2d",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/5a8edb756a56cdfb563006cbc39561994acf6d2d",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5a8edb756a56cdfb563006cbc39561994acf6d2d/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "775d36a916c1be042ceb67fc6ea22f53a9f5e331",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/775d36a916c1be042ceb67fc6ea22f53a9f5e331",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/775d36a916c1be042ceb67fc6ea22f53a9f5e331"
    }
  ],
  "stats": {
    "total": 5,
    "additions": 3,
    "deletions": 2
  },
  "files": [
    {
      "sha": "935358d02459b31d01af8422f2ab0084de56471a",
      "filename": "gdb/ada-lang.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a8edb756a56cdfb563006cbc39561994acf6d2d/gdb/ada-lang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a8edb756a56cdfb563006cbc39561994acf6d2d/gdb/ada-lang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ada-lang.c?ref=5a8edb756a56cdfb563006cbc39561994acf6d2d",
      "patch": "@@ -7539,7 +7539,7 @@ ada_template_to_fixed_record_type_1 (struct type *type,\n \t     that follow this one.  */\n \t  if (ada_is_aligner_type (field_type))\n \t    {\n-\t      long field_offset = TYPE_FIELD_BITPOS (field_type, f);\n+\t      long field_offset = TYPE_FIELD_BITPOS (type, f);\n \n \t      field_valaddr = cond_offset_host (field_valaddr, field_offset);\n \t      field_address = cond_offset_target (field_address, field_offset);"
    },
    {
      "sha": "b39d2b72348bec9d50734ee3409b91725d252459",
      "filename": "gdb/gdbtypes.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a8edb756a56cdfb563006cbc39561994acf6d2d/gdb/gdbtypes.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a8edb756a56cdfb563006cbc39561994acf6d2d/gdb/gdbtypes.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbtypes.c?ref=5a8edb756a56cdfb563006cbc39561994acf6d2d",
      "patch": "@@ -5842,11 +5842,11 @@ append_flags_type_field (struct type *type, int start_bitpos, int nr_bits,\n   gdb_assert (nr_bits >= 1 && (start_bitpos + nr_bits) <= type_bitsize);\n   gdb_assert (name != NULL);\n \n+  type->set_num_fields (type->num_fields () + 1);\n   type->field (field_nr).set_name (xstrdup (name));\n   type->field (field_nr).set_type (field_type);\n   type->field (field_nr).set_loc_bitpos (start_bitpos);\n   TYPE_FIELD_BITSIZE (type, field_nr) = nr_bits;\n-  type->set_num_fields (type->num_fields () + 1);\n }\n \n /* Special version of append_flags_type_field to add a flag field."
    },
    {
      "sha": "4324641eb0d573b1f453e4ef3def1733678bd423",
      "filename": "gdb/gdbtypes.h",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a8edb756a56cdfb563006cbc39561994acf6d2d/gdb/gdbtypes.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a8edb756a56cdfb563006cbc39561994acf6d2d/gdb/gdbtypes.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbtypes.h?ref=5a8edb756a56cdfb563006cbc39561994acf6d2d",
      "patch": "@@ -1047,6 +1047,7 @@ struct type\n   /* Get the field at index IDX.  */\n   struct field &field (int idx) const\n   {\n+    gdb_assert (idx >= 0 && idx < num_fields ());\n     return this->fields ()[idx];\n   }\n "
    }
  ]
}