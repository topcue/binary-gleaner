{
  "sha": "64c2e4a530837b13f987f5de386c49bac90aef43",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NjRjMmU0YTUzMDgzN2IxM2Y5ODdmNWRlMzg2YzQ5YmFjOTBhZWY0Mw==",
  "commit": {
    "author": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-05-29T16:10:38Z"
    },
    "committer": {
      "name": "Mike Frysinger",
      "email": "vapier@gentoo.org",
      "date": "2021-06-08T04:12:43Z"
    },
    "message": "gnulib: import chown\n\nA few sims use this to emulate chown syscalls.",
    "tree": {
      "sha": "9f8cbbfd563c4f249f14179e8884d8ae897dd517",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/9f8cbbfd563c4f249f14179e8884d8ae897dd517"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/64c2e4a530837b13f987f5de386c49bac90aef43",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/64c2e4a530837b13f987f5de386c49bac90aef43",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/64c2e4a530837b13f987f5de386c49bac90aef43",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/64c2e4a530837b13f987f5de386c49bac90aef43/comments",
  "author": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vapier",
    "id": 176950,
    "node_id": "MDQ6VXNlcjE3Njk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vapier",
    "html_url": "https://github.com/vapier",
    "followers_url": "https://api.github.com/users/vapier/followers",
    "following_url": "https://api.github.com/users/vapier/following{/other_user}",
    "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vapier/subscriptions",
    "organizations_url": "https://api.github.com/users/vapier/orgs",
    "repos_url": "https://api.github.com/users/vapier/repos",
    "events_url": "https://api.github.com/users/vapier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vapier/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e266dea99285eb7c43662ea2a01571dccf00d760",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e266dea99285eb7c43662ea2a01571dccf00d760",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e266dea99285eb7c43662ea2a01571dccf00d760"
    }
  ],
  "stats": {
    "total": 973,
    "additions": 892,
    "deletions": 81
  },
  "files": [
    {
      "sha": "f5a0a32cb4fb3cb9a0f95bb46c583897f0233622",
      "filename": "gnulib/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/ChangeLog?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -1,3 +1,11 @@\n+2021-06-08  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* update-gnulib.sh (IMPORTED_GNULIB_MODULES): Add chown.\n+\t* aclocal.m4, config.in, configure, Makefile.in, import/Makefile.am,\n+\timport/Makefile.in, import/m4/gnulib-cache.m4,\n+\timport/m4/gnulib-comp.m4: Regenerate.\n+\t* import/chown.c, import/fchown-stub.c, import/m4/chown.m4: New files.\n+\n 2021-05-24  Mike Frysinger  <vapier@gentoo.org>\n \n \t* update-gnulib.sh (IMPORTED_GNULIB_MODULES): Add ffs."
    },
    {
      "sha": "04dc454701e116d83e7304400e03a01463dae78c",
      "filename": "gnulib/Makefile.in",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/Makefile.in?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -121,6 +121,7 @@ am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \\\n \t$(top_srcdir)/import/m4/builtin-expect.m4 \\\n \t$(top_srcdir)/import/m4/canonicalize.m4 \\\n \t$(top_srcdir)/import/m4/chdir-long.m4 \\\n+\t$(top_srcdir)/import/m4/chown.m4 \\\n \t$(top_srcdir)/import/m4/clock_time.m4 \\\n \t$(top_srcdir)/import/m4/close.m4 \\\n \t$(top_srcdir)/import/m4/closedir.m4 \\"
    },
    {
      "sha": "d466a2666cacbd4db82a7b6ecf04761f598c5469",
      "filename": "gnulib/aclocal.m4",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/aclocal.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/aclocal.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/aclocal.m4?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -1193,6 +1193,7 @@ m4_include([import/m4/btowc.m4])\n m4_include([import/m4/builtin-expect.m4])\n m4_include([import/m4/canonicalize.m4])\n m4_include([import/m4/chdir-long.m4])\n+m4_include([import/m4/chown.m4])\n m4_include([import/m4/clock_time.m4])\n m4_include([import/m4/close.m4])\n m4_include([import/m4/closedir.m4])"
    },
    {
      "sha": "15abb17cb44545afdda9b3662e8c1c01bce99a05",
      "filename": "gnulib/config.in",
      "status": "modified",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/config.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/config.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/config.in?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -18,6 +18,19 @@\n /* Define to the number of bits in type 'wint_t'. */\n #undef BITSIZEOF_WINT_T\n \n+/* Define to 1 if chown fails to change ctime when at least one argument was\n+   not -1. */\n+#undef CHOWN_CHANGE_TIME_BUG\n+\n+/* Define if chown is not POSIX compliant regarding IDs of -1. */\n+#undef CHOWN_FAILS_TO_HONOR_ID_OF_NEGATIVE_ONE\n+\n+/* Define if chown modifies symlinks. */\n+#undef CHOWN_MODIFIES_SYMLINK\n+\n+/* Define to 1 if chown mishandles trailing slash. */\n+#undef CHOWN_TRAILING_SLASH_BUG\n+\n /* Define to 1 if using 'alloca.c'. */\n #undef C_ALLOCA\n \n@@ -140,6 +153,9 @@\n /* Define to 1 when the gnulib module chdir should be tested. */\n #undef GNULIB_TEST_CHDIR\n \n+/* Define to 1 when the gnulib module chown should be tested. */\n+#undef GNULIB_TEST_CHOWN\n+\n /* Define to 1 when the gnulib module cloexec should be tested. */\n #undef GNULIB_TEST_CLOEXEC\n \n@@ -355,6 +371,9 @@\n /* Define to 1 if you have the `catgets' function. */\n #undef HAVE_CATGETS\n \n+/* Define to 1 if you have the `chown' function. */\n+#undef HAVE_CHOWN\n+\n /* Define to 1 if you have the `clock_gettime' function. */\n #undef HAVE_CLOCK_GETTIME\n \n@@ -521,6 +540,9 @@\n /* Define to 1 if you have the `fchdir' function. */\n #undef HAVE_FCHDIR\n \n+/* Define to 1 if you have the `fchown' function. */\n+#undef HAVE_FCHOWN\n+\n /* Define to 1 if you have the `fcntl' function. */\n #undef HAVE_FCNTL\n "
    },
    {
      "sha": "827393a6d254e0c6fc8d070c7d3ee5859a2a4a3a",
      "filename": "gnulib/configure",
      "status": "modified",
      "additions": 414,
      "deletions": 68,
      "changes": 482,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/configure?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -3725,6 +3725,8 @@ as_fn_append ac_func_list \" faccessat\"\n as_fn_append ac_func_list \" realpath\"\n as_fn_append ac_header_list \" sys/param.h\"\n as_fn_append ac_header_list \" unistd.h\"\n+as_fn_append ac_func_list \" chown\"\n+as_fn_append ac_func_list \" fchown\"\n as_fn_append ac_func_list \" _set_invalid_parameter_handler\"\n as_fn_append ac_func_list \" fchdir\"\n as_fn_append ac_header_list \" dirent.h\"\n@@ -6685,6 +6687,7 @@ fi\n   # Code from module canonicalize-lgpl:\n   # Code from module chdir:\n   # Code from module chdir-long:\n+  # Code from module chown:\n   # Code from module clock-time:\n   # Code from module cloexec:\n   # Code from module close:\n@@ -8281,50 +8284,35 @@ done\n \n \n \n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for uid_t in sys/types.h\" >&5\n+$as_echo_n \"checking for uid_t in sys/types.h... \" >&6; }\n+if ${ac_cv_type_uid_t+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <sys/types.h>\n \n+_ACEOF\n+if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n+  $EGREP \"uid_t\" >/dev/null 2>&1; then :\n+  ac_cv_type_uid_t=yes\n+else\n+  ac_cv_type_uid_t=no\n+fi\n+rm -f conftest*\n \n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_type_uid_t\" >&5\n+$as_echo \"$ac_cv_type_uid_t\" >&6; }\n+if test $ac_cv_type_uid_t = no; then\n \n+$as_echo \"#define uid_t int\" >>confdefs.h\n \n-  if test $ac_cv_func__set_invalid_parameter_handler = yes; then\n-    HAVE_MSVC_INVALID_PARAMETER_HANDLER=1\n-\n-$as_echo \"#define HAVE_MSVC_INVALID_PARAMETER_HANDLER 1\" >>confdefs.h\n-\n-  else\n-    HAVE_MSVC_INVALID_PARAMETER_HANDLER=0\n-  fi\n-\n-\n-\n-\n-\n-     GNULIB_OPENDIR=0;\n-  GNULIB_READDIR=0;\n-  GNULIB_REWINDDIR=0;\n-  GNULIB_CLOSEDIR=0;\n-  GNULIB_DIRFD=0;\n-  GNULIB_FDOPENDIR=0;\n-  GNULIB_SCANDIR=0;\n-  GNULIB_ALPHASORT=0;\n-    HAVE_OPENDIR=1;\n-  HAVE_READDIR=1;\n-  HAVE_REWINDDIR=1;\n-  HAVE_CLOSEDIR=1;\n-  HAVE_DECL_DIRFD=1;\n-  HAVE_DECL_FDOPENDIR=1;\n-  HAVE_FDOPENDIR=1;\n-  HAVE_SCANDIR=1;\n-  HAVE_ALPHASORT=1;\n-  REPLACE_OPENDIR=0;\n-  REPLACE_CLOSEDIR=0;\n-  REPLACE_DIRFD=0;\n-  REPLACE_FDOPENDIR=0;\n-\n-\n-  GNULIB_ISBLANK=0;\n-    HAVE_ISBLANK=1;\n \n+$as_echo \"#define gid_t int\" >>confdefs.h\n \n+fi\n \n gl_mda_defines='\n #if defined _WIN32 && !defined __CYGWIN__\n@@ -8382,6 +8370,354 @@ gl_mda_defines='\n '\n \n \n+      for ac_header in unistd.h\n+do :\n+  ac_fn_c_check_header_mongrel \"$LINENO\" \"unistd.h\" \"ac_cv_header_unistd_h\" \"$ac_includes_default\"\n+if test \"x$ac_cv_header_unistd_h\" = xyes; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_UNISTD_H 1\n+_ACEOF\n+\n+fi\n+\n+done\n+\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for working chown\" >&5\n+$as_echo_n \"checking for working chown... \" >&6; }\n+if ${ac_cv_func_chown_works+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  if test \"$cross_compiling\" = yes; then :\n+  case \"$host_os\" in # ((\n+                           # Guess yes on Linux systems.\n+          linux-* | linux) ac_cv_func_chown_works=\"guessing yes\" ;;\n+                           # Guess yes on glibc systems.\n+          *-gnu* | gnu*)   ac_cv_func_chown_works=\"guessing yes\" ;;\n+                           # Guess no on native Windows.\n+          mingw*)          ac_cv_func_chown_works=\"guessing no\" ;;\n+                           # If we don't know, obey --enable-cross-guesses.\n+          *)               ac_cv_func_chown_works=\"$gl_cross_guess_normal\" ;;\n+        esac\n+\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+$ac_includes_default\n+           #include <fcntl.h>\n+\n+\n+$gl_mda_defines\n+\n+int\n+main ()\n+{\n+\n+            char *f = \"conftest.chown\";\n+            struct stat before, after;\n+\n+            if (creat (f, 0600) < 0)\n+              return 1;\n+            if (stat (f, &before) < 0)\n+              return 1;\n+            if (chown (f, (uid_t) -1, (gid_t) -1) == -1)\n+              return 1;\n+            if (stat (f, &after) < 0)\n+              return 1;\n+            return ! (before.st_uid == after.st_uid && before.st_gid == after.st_gid);\n+\n+  ;\n+  return 0;\n+}\n+\n+_ACEOF\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  ac_cv_func_chown_works=yes\n+else\n+  ac_cv_func_chown_works=no\n+fi\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n+fi\n+\n+     rm -f conftest.chown\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_chown_works\" >&5\n+$as_echo \"$ac_cv_func_chown_works\" >&6; }\n+  case \"$ac_cv_func_chown_works\" in\n+    *yes)\n+\n+$as_echo \"#define HAVE_CHOWN 1\" >>confdefs.h\n+\n+      ;;\n+  esac\n+\n+\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether chown dereferences symlinks\" >&5\n+$as_echo_n \"checking whether chown dereferences symlinks... \" >&6; }\n+if ${gl_cv_func_chown_follows_symlink+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+\n+      if test \"$cross_compiling\" = yes; then :\n+  gl_cv_func_chown_follows_symlink=\"guessing yes\"\n+\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#include <unistd.h>\n+#include <stdlib.h>\n+#include <errno.h>\n+\n+\n+$gl_mda_defines\n+\n+        int\n+        main ()\n+        {\n+          int result = 0;\n+          char const *dangling_symlink = \"conftest.dangle\";\n+\n+          unlink (dangling_symlink);\n+          if (symlink (\"conftest.no-such\", dangling_symlink))\n+            abort ();\n+\n+          /* Exit successfully on a conforming system,\n+             i.e., where chown must fail with ENOENT.  */\n+          if (chown (dangling_symlink, getuid (), getgid ()) == 0)\n+            result |= 1;\n+          if (errno != ENOENT)\n+            result |= 2;\n+          return result;\n+        }\n+\n+_ACEOF\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  gl_cv_func_chown_follows_symlink=yes\n+else\n+  gl_cv_func_chown_follows_symlink=no\n+fi\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n+fi\n+\n+\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_cv_func_chown_follows_symlink\" >&5\n+$as_echo \"$gl_cv_func_chown_follows_symlink\" >&6; }\n+\n+  case \"$gl_cv_func_chown_follows_symlink\" in\n+    *yes) ;;\n+    *)\n+\n+$as_echo \"#define CHOWN_MODIFIES_SYMLINK 1\" >>confdefs.h\n+\n+      ;;\n+  esac\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+    if test $ac_cv_func_chown = no; then\n+    HAVE_CHOWN=0\n+  else\n+        case \"$gl_cv_func_chown_follows_symlink\" in\n+      *yes) ;;\n+      *) REPLACE_CHOWN=1 ;;\n+    esac\n+\n+        case \"$ac_cv_func_chown_works\" in\n+      *no)\n+\n+$as_echo \"#define CHOWN_FAILS_TO_HONOR_ID_OF_NEGATIVE_ONE 1\" >>confdefs.h\n+\n+        REPLACE_CHOWN=1\n+        ;;\n+    esac\n+\n+                { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether chown honors trailing slash\" >&5\n+$as_echo_n \"checking whether chown honors trailing slash... \" >&6; }\n+if ${gl_cv_func_chown_slash_works+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  touch conftest.file && rm -f conftest.link\n+       if test \"$cross_compiling\" = yes; then :\n+  case \"$host_os\" in\n+                    # Guess yes on glibc systems.\n+           *-gnu*)  gl_cv_func_chown_slash_works=\"guessing yes\" ;;\n+                    # Guess yes on musl systems.\n+           *-musl*) gl_cv_func_chown_slash_works=\"guessing yes\" ;;\n+                    # If we don't know, obey --enable-cross-guesses.\n+           *)       gl_cv_func_chown_slash_works=\"$gl_cross_guess_normal\" ;;\n+         esac\n+\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#include <unistd.h>\n+#include <stdlib.h>\n+#include <errno.h>\n+\n+\n+$gl_mda_defines\n+\n+int\n+main ()\n+{\n+if (symlink (\"conftest.file\", \"conftest.link\")) return 1;\n+          if (chown (\"conftest.link/\", getuid (), getgid ()) == 0) return 2;\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  gl_cv_func_chown_slash_works=yes\n+else\n+  gl_cv_func_chown_slash_works=no\n+fi\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n+fi\n+\n+      rm -f conftest.link conftest.file\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_cv_func_chown_slash_works\" >&5\n+$as_echo \"$gl_cv_func_chown_slash_works\" >&6; }\n+    case \"$gl_cv_func_chown_slash_works\" in\n+      *yes) ;;\n+      *)\n+\n+$as_echo \"#define CHOWN_TRAILING_SLASH_BUG 1\" >>confdefs.h\n+\n+        REPLACE_CHOWN=1\n+        ;;\n+    esac\n+\n+        { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether chown always updates ctime\" >&5\n+$as_echo_n \"checking whether chown always updates ctime... \" >&6; }\n+if ${gl_cv_func_chown_ctime_works+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  if test \"$cross_compiling\" = yes; then :\n+  case \"$host_os\" in\n+                    # Guess yes on glibc systems.\n+           *-gnu*)  gl_cv_func_chown_ctime_works=\"guessing yes\" ;;\n+                    # Guess yes on musl systems.\n+           *-musl*) gl_cv_func_chown_ctime_works=\"guessing yes\" ;;\n+                    # If we don't know, obey --enable-cross-guesses.\n+           *)       gl_cv_func_chown_ctime_works=\"$gl_cross_guess_normal\" ;;\n+         esac\n+\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#include <unistd.h>\n+#include <stdlib.h>\n+#include <errno.h>\n+#include <fcntl.h>\n+#include <sys/stat.h>\n+\n+\n+$gl_mda_defines\n+\n+int\n+main ()\n+{\n+struct stat st1, st2;\n+          if (close (creat (\"conftest.file\", 0600))) return 1;\n+          if (stat (\"conftest.file\", &st1)) return 2;\n+          sleep (1);\n+          if (chown (\"conftest.file\", st1.st_uid, st1.st_gid)) return 3;\n+          if (stat (\"conftest.file\", &st2)) return 4;\n+          if (st2.st_ctime <= st1.st_ctime) return 5;\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  gl_cv_func_chown_ctime_works=yes\n+else\n+  gl_cv_func_chown_ctime_works=no\n+fi\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n+fi\n+\n+      rm -f conftest.file\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gl_cv_func_chown_ctime_works\" >&5\n+$as_echo \"$gl_cv_func_chown_ctime_works\" >&6; }\n+    case \"$gl_cv_func_chown_ctime_works\" in\n+      *yes) ;;\n+      *)\n+\n+$as_echo \"#define CHOWN_CHANGE_TIME_BUG 1\" >>confdefs.h\n+\n+        REPLACE_CHOWN=1\n+        ;;\n+    esac\n+  fi\n+\n+\n+\n+\n+\n+  if test $ac_cv_func__set_invalid_parameter_handler = yes; then\n+    HAVE_MSVC_INVALID_PARAMETER_HANDLER=1\n+\n+$as_echo \"#define HAVE_MSVC_INVALID_PARAMETER_HANDLER 1\" >>confdefs.h\n+\n+  else\n+    HAVE_MSVC_INVALID_PARAMETER_HANDLER=0\n+  fi\n+\n+\n+\n+\n+\n+     GNULIB_OPENDIR=0;\n+  GNULIB_READDIR=0;\n+  GNULIB_REWINDDIR=0;\n+  GNULIB_CLOSEDIR=0;\n+  GNULIB_DIRFD=0;\n+  GNULIB_FDOPENDIR=0;\n+  GNULIB_SCANDIR=0;\n+  GNULIB_ALPHASORT=0;\n+    HAVE_OPENDIR=1;\n+  HAVE_READDIR=1;\n+  HAVE_REWINDDIR=1;\n+  HAVE_CLOSEDIR=1;\n+  HAVE_DECL_DIRFD=1;\n+  HAVE_DECL_FDOPENDIR=1;\n+  HAVE_FDOPENDIR=1;\n+  HAVE_SCANDIR=1;\n+  HAVE_ALPHASORT=1;\n+  REPLACE_OPENDIR=0;\n+  REPLACE_CLOSEDIR=0;\n+  REPLACE_DIRFD=0;\n+  REPLACE_FDOPENDIR=0;\n+\n+\n+  GNULIB_ISBLANK=0;\n+    HAVE_ISBLANK=1;\n+\n+\n+\n+\n \n \n \n@@ -16208,36 +16544,6 @@ fi\n     HAVE_SIGSET_T=0\n   fi\n \n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for uid_t in sys/types.h\" >&5\n-$as_echo_n \"checking for uid_t in sys/types.h... \" >&6; }\n-if ${ac_cv_type_uid_t+:} false; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-#include <sys/types.h>\n-\n-_ACEOF\n-if (eval \"$ac_cpp conftest.$ac_ext\") 2>&5 |\n-  $EGREP \"uid_t\" >/dev/null 2>&1; then :\n-  ac_cv_type_uid_t=yes\n-else\n-  ac_cv_type_uid_t=no\n-fi\n-rm -f conftest*\n-\n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_type_uid_t\" >&5\n-$as_echo \"$ac_cv_type_uid_t\" >&6; }\n-if test $ac_cv_type_uid_t = no; then\n-\n-$as_echo \"#define uid_t int\" >>confdefs.h\n-\n-\n-$as_echo \"#define gid_t int\" >>confdefs.h\n-\n-fi\n-\n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for stdbool.h that conforms to C99\" >&5\n $as_echo_n \"checking for stdbool.h that conforms to C99... \" >&6; }\n if ${ac_cv_header_stdbool_h+:} false; then :\n@@ -17891,6 +18197,46 @@ $as_echo \"$gl_cv_have_unlimited_file_name_length\" >&6; }\n     :\n   fi\n \n+  if test $HAVE_CHOWN = 0 || test $REPLACE_CHOWN = 1; then\n+\n+\n+\n+\n+\n+\n+\n+\n+  gl_LIBOBJS=\"$gl_LIBOBJS chown.$ac_objext\"\n+\n+  fi\n+  if test $REPLACE_CHOWN = 1 && test $ac_cv_func_fchown = no; then\n+\n+\n+\n+\n+\n+\n+\n+\n+  gl_LIBOBJS=\"$gl_LIBOBJS fchown-stub.$ac_objext\"\n+\n+  fi\n+\n+\n+\n+\n+\n+          GNULIB_CHOWN=1\n+\n+\n+\n+\n+\n+$as_echo \"#define GNULIB_TEST_CHOWN 1\" >>confdefs.h\n+\n+\n+\n+\n \n \n   # Solaris 2.5.1 needs -lposix4 to get the clock_gettime function."
    },
    {
      "sha": "30b8afd2846373d38dfa7cecba7d66c1574ca2e4",
      "filename": "gnulib/import/Makefile.am",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/Makefile.am",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/Makefile.am",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/Makefile.am?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -35,6 +35,7 @@\n #  --no-vc-files \\\n #  alloca \\\n #  canonicalize-lgpl \\\n+#  chown \\\n #  count-one-bits \\\n #  dirent \\\n #  dirfd \\\n@@ -237,6 +238,15 @@ EXTRA_libgnu_a_SOURCES += chdir-long.c\n \n ## end   gnulib module chdir-long\n \n+## begin gnulib module chown\n+\n+\n+EXTRA_DIST += chown.c fchown-stub.c\n+\n+EXTRA_libgnu_a_SOURCES += chown.c fchown-stub.c\n+\n+## end   gnulib module chown\n+\n ## begin gnulib module cloexec\n \n libgnu_a_SOURCES += cloexec.c"
    },
    {
      "sha": "d8a31f83de465cc6ad3cdaf6ce1888c375634ff4",
      "filename": "gnulib/import/Makefile.in",
      "status": "modified",
      "additions": 18,
      "deletions": 13,
      "changes": 31,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/Makefile.in?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -49,6 +49,7 @@\n #  --no-vc-files \\\n #  alloca \\\n #  canonicalize-lgpl \\\n+#  chown \\\n #  count-one-bits \\\n #  dirent \\\n #  dirfd \\\n@@ -182,6 +183,7 @@ am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \\\n \t$(top_srcdir)/import/m4/builtin-expect.m4 \\\n \t$(top_srcdir)/import/m4/canonicalize.m4 \\\n \t$(top_srcdir)/import/m4/chdir-long.m4 \\\n+\t$(top_srcdir)/import/m4/chown.m4 \\\n \t$(top_srcdir)/import/m4/clock_time.m4 \\\n \t$(top_srcdir)/import/m4/close.m4 \\\n \t$(top_srcdir)/import/m4/closedir.m4 \\\n@@ -1787,12 +1789,12 @@ noinst_LTLIBRARIES =\n # No GNU Make output.\n EXTRA_DIST = m4/gnulib-cache.m4 alloca.c alloca.in.h arpa_inet.in.h \\\n \tassure.h attribute.h basename-lgpl.h btowc.c \\\n-\tcanonicalize-lgpl.c chdir-long.c chdir-long.h cloexec.h \\\n-\tclose.c closedir.c dirent-private.h count-one-bits.h \\\n-\tctype.in.h dirent.in.h dirfd.c dirname.h dup.c dup2.c \\\n-\teloop-threshold.h errno.in.h error.c error.h exitfail.h \\\n-\tfchdir.c fcntl.c fcntl.in.h fd-hook.h fdopendir.c ffs.c \\\n-\tfilename.h filenamecat.h flexmember.h float.c float.in.h \\\n+\tcanonicalize-lgpl.c chdir-long.c chdir-long.h chown.c \\\n+\tfchown-stub.c cloexec.h close.c closedir.c dirent-private.h \\\n+\tcount-one-bits.h ctype.in.h dirent.in.h dirfd.c dirname.h \\\n+\tdup.c dup2.c eloop-threshold.h errno.in.h error.c error.h \\\n+\texitfail.h fchdir.c fcntl.c fcntl.in.h fd-hook.h fdopendir.c \\\n+\tffs.c filename.h filenamecat.h flexmember.h float.c float.in.h \\\n \titold.c fnmatch.c fnmatch_loop.c fnmatch.c fnmatch.in.h \\\n \tfpucw.h free.c frexp.c frexp.c frexpl.c fstat.c stat-w32.c \\\n \tstat-w32.h at-func.c fstatat.c \\\n@@ -1876,13 +1878,14 @@ libgnu_a_SOURCES = openat-priv.h openat-proc.c basename-lgpl.c \\\n libgnu_a_LIBADD = $(gl_LIBOBJS) @ALLOCA@\n libgnu_a_DEPENDENCIES = $(gl_LIBOBJS) @ALLOCA@\n EXTRA_libgnu_a_SOURCES = alloca.c btowc.c canonicalize-lgpl.c \\\n-\tchdir-long.c close.c closedir.c dirfd.c dup.c dup2.c error.c \\\n-\tfchdir.c fcntl.c fdopendir.c ffs.c float.c itold.c fnmatch.c \\\n-\tfnmatch_loop.c fnmatch.c free.c frexp.c frexp.c frexpl.c \\\n-\tfstat.c stat-w32.c at-func.c fstatat.c getcwd.c getcwd-lgpl.c \\\n-\tgetdelim.c getdtablesize.c getline.c getlogin_r.c getrandom.c \\\n-\tgettimeofday.c glob.c glob_pattern_p.c globfree.c inet_ntop.c \\\n-\tisblank.c isnan.c isnand.c isnan.c isnanl.c lstat.c malloc.c \\\n+\tchdir-long.c chown.c fchown-stub.c close.c closedir.c dirfd.c \\\n+\tdup.c dup2.c error.c fchdir.c fcntl.c fdopendir.c ffs.c \\\n+\tfloat.c itold.c fnmatch.c fnmatch_loop.c fnmatch.c free.c \\\n+\tfrexp.c frexp.c frexpl.c fstat.c stat-w32.c at-func.c \\\n+\tfstatat.c getcwd.c getcwd-lgpl.c getdelim.c getdtablesize.c \\\n+\tgetline.c getlogin_r.c getrandom.c gettimeofday.c glob.c \\\n+\tglob_pattern_p.c globfree.c inet_ntop.c isblank.c isnan.c \\\n+\tisnand.c isnan.c isnanl.c lstat.c malloc.c \\\n \tlc-charset-dispatch.c mbrtowc.c mbtowc-lock.c mbsinit.c \\\n \tmbsrtowcs-state.c mbsrtowcs.c mbtowc.c memchr.c memmem.c \\\n \tmemmem.c mempcpy.c memrchr.c mkdir.c mkdtemp.c mkostemp.c \\\n@@ -2010,6 +2013,7 @@ distclean-compile:\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/btowc.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/canonicalize-lgpl.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/chdir-long.Po@am__quote@\n+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/chown.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/cloexec.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/close.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/closedir.Po@am__quote@\n@@ -2023,6 +2027,7 @@ distclean-compile:\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/error.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/exitfail.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/fchdir.Po@am__quote@\n+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/fchown-stub.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/fcntl.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/fd-hook.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/fd-safer-flag.Po@am__quote@"
    },
    {
      "sha": "9b8b36192c9524bb83f9bb8c53420dd6c5f5bf3d",
      "filename": "gnulib/import/chown.c",
      "status": "added",
      "additions": 151,
      "deletions": 0,
      "changes": 151,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/chown.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/chown.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/chown.c?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -0,0 +1,151 @@\n+/* provide consistent interface to chown for systems that don't interpret\n+   an ID of -1 as meaning \"don't change the corresponding ID\".\n+\n+   Copyright (C) 1997, 2004-2007, 2009-2021 Free Software Foundation, Inc.\n+\n+   This program is free software: you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <https://www.gnu.org/licenses/>.  */\n+\n+/* written by Jim Meyering */\n+\n+#include <config.h>\n+\n+/* Specification.  */\n+#include <unistd.h>\n+\n+#include <errno.h>\n+#include <fcntl.h>\n+#include <stdbool.h>\n+#include <string.h>\n+#include <sys/stat.h>\n+\n+#if !HAVE_CHOWN\n+\n+/* Simple stub that always fails with ENOSYS, for mingw.  */\n+int\n+chown (const char *file _GL_UNUSED, uid_t uid _GL_UNUSED,\n+       gid_t gid _GL_UNUSED)\n+{\n+  errno = ENOSYS;\n+  return -1;\n+}\n+\n+#else /* HAVE_CHOWN */\n+\n+/* Below we refer to the system's chown().  */\n+# undef chown\n+\n+/* Provide a more-closely POSIX-conforming version of chown on\n+   systems with one or both of the following problems:\n+   - chown doesn't treat an ID of -1 as meaning\n+   \"don't change the corresponding ID\".\n+   - chown doesn't dereference symlinks.  */\n+\n+int\n+rpl_chown (const char *file, uid_t uid, gid_t gid)\n+{\n+  struct stat st;\n+  bool stat_valid = false;\n+  int result;\n+\n+# if CHOWN_CHANGE_TIME_BUG\n+  if (gid != (gid_t) -1 || uid != (uid_t) -1)\n+    {\n+      if (stat (file, &st))\n+        return -1;\n+      stat_valid = true;\n+    }\n+# endif\n+\n+# if CHOWN_FAILS_TO_HONOR_ID_OF_NEGATIVE_ONE\n+  if (gid == (gid_t) -1 || uid == (uid_t) -1)\n+    {\n+      /* Stat file to get id(s) that should remain unchanged.  */\n+      if (!stat_valid && stat (file, &st))\n+        return -1;\n+      if (gid == (gid_t) -1)\n+        gid = st.st_gid;\n+      if (uid == (uid_t) -1)\n+        uid = st.st_uid;\n+    }\n+# endif\n+\n+# if CHOWN_MODIFIES_SYMLINK\n+  {\n+    /* Handle the case in which the system-supplied chown function\n+       does *not* follow symlinks.  Instead, it changes permissions\n+       on the symlink itself.  To work around that, we open the\n+       file (but this can fail due to lack of read or write permission) and\n+       use fchown on the resulting descriptor.  */\n+    int open_flags = O_NONBLOCK | O_NOCTTY | O_CLOEXEC;\n+    int fd = open (file, O_RDONLY | open_flags);\n+    if (0 <= fd\n+        || (errno == EACCES\n+            && 0 <= (fd = open (file, O_WRONLY | open_flags))))\n+      {\n+        int saved_errno;\n+        bool fchown_socket_failure;\n+\n+        result = fchown (fd, uid, gid);\n+        saved_errno = errno;\n+\n+        /* POSIX says fchown can fail with errno == EINVAL on sockets\n+           and pipes, so fall back on chown in that case.  */\n+        fchown_socket_failure =\n+          (result != 0 && saved_errno == EINVAL\n+           && fstat (fd, &st) == 0\n+           && (S_ISFIFO (st.st_mode) || S_ISSOCK (st.st_mode)));\n+\n+        close (fd);\n+\n+        if (! fchown_socket_failure)\n+          {\n+            errno = saved_errno;\n+            return result;\n+          }\n+      }\n+    else if (errno != EACCES)\n+      return -1;\n+  }\n+# endif\n+\n+# if CHOWN_TRAILING_SLASH_BUG\n+  if (!stat_valid)\n+    {\n+      size_t len = strlen (file);\n+      if (len && file[len - 1] == '/' && stat (file, &st))\n+        return -1;\n+    }\n+# endif\n+\n+  result = chown (file, uid, gid);\n+\n+# if CHOWN_CHANGE_TIME_BUG\n+  if (result == 0 && stat_valid\n+      && (uid == st.st_uid || uid == (uid_t) -1)\n+      && (gid == st.st_gid || gid == (gid_t) -1))\n+    {\n+      /* No change in ownership, but at least one argument was not -1,\n+         so we are required to update ctime.  Since chown succeeded,\n+         we assume that chmod will do likewise.  Fortunately, on all\n+         known systems where a 'no-op' chown skips the ctime update, a\n+         'no-op' chmod still does the trick.  */\n+      result = chmod (file, st.st_mode & (S_IRWXU | S_IRWXG | S_IRWXO\n+                                          | S_ISUID | S_ISGID | S_ISVTX));\n+    }\n+# endif\n+\n+  return result;\n+}\n+\n+#endif /* HAVE_CHOWN */"
    },
    {
      "sha": "f549ff300a4808e0972e484edea4edfd9da171b7",
      "filename": "gnulib/import/fchown-stub.c",
      "status": "added",
      "additions": 34,
      "deletions": 0,
      "changes": 34,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/fchown-stub.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/fchown-stub.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/fchown-stub.c?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -0,0 +1,34 @@\n+/* Change ownership of a file.\n+   Copyright (C) 2004-2021 Free Software Foundation, Inc.\n+\n+   This program is free software: you can redistribute it and/or modify\n+   it under the terms of the GNU General Public License as published by\n+   the Free Software Foundation; either version 3 of the License, or\n+   (at your option) any later version.\n+\n+   This program is distributed in the hope that it will be useful,\n+   but WITHOUT ANY WARRANTY; without even the implied warranty of\n+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+   GNU General Public License for more details.\n+\n+   You should have received a copy of the GNU General Public License\n+   along with this program.  If not, see <https://www.gnu.org/licenses/>.  */\n+\n+/* Written by Paul Eggert, 2004.  */\n+\n+#include <config.h>\n+\n+#include <sys/types.h>\n+#include <errno.h>\n+\n+/* A trivial substitute for 'fchown'.\n+\n+   DJGPP 2.03 and earlier (and perhaps later) don't have 'fchown',\n+   so we pretend no-one has permission for this operation. */\n+\n+int\n+fchown (int fd, uid_t uid, gid_t gid)\n+{\n+  errno = EPERM;\n+  return -1;\n+}"
    },
    {
      "sha": "d1c083175e6b8876141d36720245705f5e3c6fc2",
      "filename": "gnulib/import/m4/chown.m4",
      "status": "added",
      "additions": 218,
      "deletions": 0,
      "changes": 218,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/m4/chown.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/m4/chown.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/chown.m4?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -0,0 +1,218 @@\n+# serial 35\n+# Determine whether we need the chown wrapper.\n+\n+dnl Copyright (C) 1997-2001, 2003-2005, 2007, 2009-2021 Free Software\n+dnl Foundation, Inc.\n+\n+dnl This file is free software; the Free Software Foundation\n+dnl gives unlimited permission to copy and/or distribute it,\n+dnl with or without modifications, as long as this notice is preserved.\n+\n+# chown should accept arguments of -1 for uid and gid, and it should\n+# dereference symlinks.  If it doesn't, arrange to use the replacement\n+# function.\n+\n+# From Jim Meyering.\n+\n+# This is taken from the following Autoconf patch:\n+# https://git.savannah.gnu.org/gitweb/?p=autoconf.git;a=commitdiff;h=7fbb553727ed7e0e689a17594b58559ecf3ea6e9\n+AC_DEFUN([AC_FUNC_CHOWN],\n+[\n+  AC_REQUIRE([AC_TYPE_UID_T])dnl\n+  AC_REQUIRE([AC_CANONICAL_HOST])dnl for cross-compiles\n+  AC_CHECK_HEADERS([unistd.h])\n+  AC_CACHE_CHECK([for working chown],\n+    [ac_cv_func_chown_works],\n+    [AC_RUN_IFELSE(\n+       [AC_LANG_PROGRAM(\n+          [AC_INCLUDES_DEFAULT\n+           [#include <fcntl.h>\n+          ]GL_MDA_DEFINES],\n+          [[\n+            char *f = \"conftest.chown\";\n+            struct stat before, after;\n+\n+            if (creat (f, 0600) < 0)\n+              return 1;\n+            if (stat (f, &before) < 0)\n+              return 1;\n+            if (chown (f, (uid_t) -1, (gid_t) -1) == -1)\n+              return 1;\n+            if (stat (f, &after) < 0)\n+              return 1;\n+            return ! (before.st_uid == after.st_uid && before.st_gid == after.st_gid);\n+          ]])\n+       ],\n+       [ac_cv_func_chown_works=yes],\n+       [ac_cv_func_chown_works=no],\n+       [case \"$host_os\" in # ((\n+                           # Guess yes on Linux systems.\n+          linux-* | linux) ac_cv_func_chown_works=\"guessing yes\" ;;\n+                           # Guess yes on glibc systems.\n+          *-gnu* | gnu*)   ac_cv_func_chown_works=\"guessing yes\" ;;\n+                           # Guess no on native Windows.\n+          mingw*)          ac_cv_func_chown_works=\"guessing no\" ;;\n+                           # If we don't know, obey --enable-cross-guesses.\n+          *)               ac_cv_func_chown_works=\"$gl_cross_guess_normal\" ;;\n+        esac\n+       ])\n+     rm -f conftest.chown\n+    ])\n+  case \"$ac_cv_func_chown_works\" in\n+    *yes)\n+      AC_DEFINE([HAVE_CHOWN], [1],\n+        [Define to 1 if your system has a working `chown' function.])\n+      ;;\n+  esac\n+])# AC_FUNC_CHOWN\n+\n+AC_DEFUN_ONCE([gl_FUNC_CHOWN],\n+[\n+  AC_REQUIRE([gl_UNISTD_H_DEFAULTS])\n+  AC_REQUIRE([AC_TYPE_UID_T])\n+  AC_REQUIRE([AC_FUNC_CHOWN])\n+  AC_REQUIRE([gl_FUNC_CHOWN_FOLLOWS_SYMLINK])\n+  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n+  AC_CHECK_FUNCS_ONCE([chown fchown])\n+\n+  dnl mingw lacks chown altogether.\n+  if test $ac_cv_func_chown = no; then\n+    HAVE_CHOWN=0\n+  else\n+    dnl Some old systems treated chown like lchown.\n+    case \"$gl_cv_func_chown_follows_symlink\" in\n+      *yes) ;;\n+      *) REPLACE_CHOWN=1 ;;\n+    esac\n+\n+    dnl Some old systems tried to use uid/gid -1 literally.\n+    case \"$ac_cv_func_chown_works\" in\n+      *no)\n+        AC_DEFINE([CHOWN_FAILS_TO_HONOR_ID_OF_NEGATIVE_ONE], [1],\n+          [Define if chown is not POSIX compliant regarding IDs of -1.])\n+        REPLACE_CHOWN=1\n+        ;;\n+    esac\n+\n+    dnl Solaris 9 ignores trailing slash.\n+    dnl FreeBSD 7.2 mishandles trailing slash on symlinks.\n+    dnl Likewise for AIX 7.1.\n+    AC_CACHE_CHECK([whether chown honors trailing slash],\n+      [gl_cv_func_chown_slash_works],\n+      [touch conftest.file && rm -f conftest.link\n+       AC_RUN_IFELSE([AC_LANG_PROGRAM([[\n+#include <unistd.h>\n+#include <stdlib.h>\n+#include <errno.h>\n+]GL_MDA_DEFINES],\n+        [[if (symlink (\"conftest.file\", \"conftest.link\")) return 1;\n+          if (chown (\"conftest.link/\", getuid (), getgid ()) == 0) return 2;\n+        ]])],\n+        [gl_cv_func_chown_slash_works=yes],\n+        [gl_cv_func_chown_slash_works=no],\n+        [case \"$host_os\" in\n+                    # Guess yes on glibc systems.\n+           *-gnu*)  gl_cv_func_chown_slash_works=\"guessing yes\" ;;\n+                    # Guess yes on musl systems.\n+           *-musl*) gl_cv_func_chown_slash_works=\"guessing yes\" ;;\n+                    # If we don't know, obey --enable-cross-guesses.\n+           *)       gl_cv_func_chown_slash_works=\"$gl_cross_guess_normal\" ;;\n+         esac\n+        ])\n+      rm -f conftest.link conftest.file])\n+    case \"$gl_cv_func_chown_slash_works\" in\n+      *yes) ;;\n+      *)\n+        AC_DEFINE([CHOWN_TRAILING_SLASH_BUG], [1],\n+          [Define to 1 if chown mishandles trailing slash.])\n+        REPLACE_CHOWN=1\n+        ;;\n+    esac\n+\n+    dnl OpenBSD fails to update ctime if ownership does not change.\n+    AC_CACHE_CHECK([whether chown always updates ctime],\n+      [gl_cv_func_chown_ctime_works],\n+      [AC_RUN_IFELSE([AC_LANG_PROGRAM([[\n+#include <unistd.h>\n+#include <stdlib.h>\n+#include <errno.h>\n+#include <fcntl.h>\n+#include <sys/stat.h>\n+]GL_MDA_DEFINES],\n+        [[struct stat st1, st2;\n+          if (close (creat (\"conftest.file\", 0600))) return 1;\n+          if (stat (\"conftest.file\", &st1)) return 2;\n+          sleep (1);\n+          if (chown (\"conftest.file\", st1.st_uid, st1.st_gid)) return 3;\n+          if (stat (\"conftest.file\", &st2)) return 4;\n+          if (st2.st_ctime <= st1.st_ctime) return 5;\n+        ]])],\n+        [gl_cv_func_chown_ctime_works=yes],\n+        [gl_cv_func_chown_ctime_works=no],\n+        [case \"$host_os\" in\n+                    # Guess yes on glibc systems.\n+           *-gnu*)  gl_cv_func_chown_ctime_works=\"guessing yes\" ;;\n+                    # Guess yes on musl systems.\n+           *-musl*) gl_cv_func_chown_ctime_works=\"guessing yes\" ;;\n+                    # If we don't know, obey --enable-cross-guesses.\n+           *)       gl_cv_func_chown_ctime_works=\"$gl_cross_guess_normal\" ;;\n+         esac\n+        ])\n+      rm -f conftest.file])\n+    case \"$gl_cv_func_chown_ctime_works\" in\n+      *yes) ;;\n+      *)\n+        AC_DEFINE([CHOWN_CHANGE_TIME_BUG], [1], [Define to 1 if chown fails\n+          to change ctime when at least one argument was not -1.])\n+        REPLACE_CHOWN=1\n+        ;;\n+    esac\n+  fi\n+])\n+\n+# Determine whether chown follows symlinks (it should).\n+AC_DEFUN_ONCE([gl_FUNC_CHOWN_FOLLOWS_SYMLINK],\n+[\n+  AC_CACHE_CHECK(\n+    [whether chown dereferences symlinks],\n+    [gl_cv_func_chown_follows_symlink],\n+    [\n+      AC_RUN_IFELSE([AC_LANG_SOURCE([[\n+#include <unistd.h>\n+#include <stdlib.h>\n+#include <errno.h>\n+]GL_MDA_DEFINES[\n+        int\n+        main ()\n+        {\n+          int result = 0;\n+          char const *dangling_symlink = \"conftest.dangle\";\n+\n+          unlink (dangling_symlink);\n+          if (symlink (\"conftest.no-such\", dangling_symlink))\n+            abort ();\n+\n+          /* Exit successfully on a conforming system,\n+             i.e., where chown must fail with ENOENT.  */\n+          if (chown (dangling_symlink, getuid (), getgid ()) == 0)\n+            result |= 1;\n+          if (errno != ENOENT)\n+            result |= 2;\n+          return result;\n+        }\n+        ]])],\n+        [gl_cv_func_chown_follows_symlink=yes],\n+        [gl_cv_func_chown_follows_symlink=no],\n+        [gl_cv_func_chown_follows_symlink=\"guessing yes\"]\n+      )\n+    ]\n+  )\n+\n+  case \"$gl_cv_func_chown_follows_symlink\" in\n+    *yes) ;;\n+    *)\n+      AC_DEFINE([CHOWN_MODIFIES_SYMLINK], [1],\n+        [Define if chown modifies symlinks.])\n+      ;;\n+  esac\n+])"
    },
    {
      "sha": "d21f54296d62ffb9b51a0a661d9b270ebef16a48",
      "filename": "gnulib/import/m4/gnulib-cache.m4",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/m4/gnulib-cache.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/m4/gnulib-cache.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/gnulib-cache.m4?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -40,6 +40,7 @@\n #  --no-vc-files \\\n #  alloca \\\n #  canonicalize-lgpl \\\n+#  chown \\\n #  count-one-bits \\\n #  dirent \\\n #  dirfd \\\n@@ -85,6 +86,7 @@ gl_LOCAL_DIR([])\n gl_MODULES([\n   alloca\n   canonicalize-lgpl\n+  chown\n   count-one-bits\n   dirent\n   dirfd"
    },
    {
      "sha": "d4734854fbc10e0abff5b7bb8d5ffdde5d4642c7",
      "filename": "gnulib/import/m4/gnulib-comp.m4",
      "status": "modified",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/m4/gnulib-comp.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/import/m4/gnulib-comp.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/import/m4/gnulib-comp.m4?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -57,6 +57,7 @@ AC_DEFUN([gl_EARLY],\n   # Code from module canonicalize-lgpl:\n   # Code from module chdir:\n   # Code from module chdir-long:\n+  # Code from module chown:\n   # Code from module clock-time:\n   # Code from module cloexec:\n   # Code from module close:\n@@ -268,6 +269,14 @@ AC_DEFUN([gl_INIT],\n     AC_LIBOBJ([chdir-long])\n     gl_PREREQ_CHDIR_LONG\n   fi\n+  gl_FUNC_CHOWN\n+  if test $HAVE_CHOWN = 0 || test $REPLACE_CHOWN = 1; then\n+    AC_LIBOBJ([chown])\n+  fi\n+  if test $REPLACE_CHOWN = 1 && test $ac_cv_func_fchown = no; then\n+    AC_LIBOBJ([fchown-stub])\n+  fi\n+  gl_UNISTD_MODULE_INDICATOR([chown])\n   gl_CLOCK_TIME\n   gl_MODULE_INDICATOR_FOR_TESTS([cloexec])\n   gl_FUNC_CLOSE\n@@ -968,6 +977,7 @@ AC_DEFUN([gl_FILE_LIST], [\n   lib/cdefs.h\n   lib/chdir-long.c\n   lib/chdir-long.h\n+  lib/chown.c\n   lib/cloexec.c\n   lib/cloexec.h\n   lib/close.c\n@@ -991,6 +1001,7 @@ AC_DEFUN([gl_FILE_LIST], [\n   lib/exitfail.c\n   lib/exitfail.h\n   lib/fchdir.c\n+  lib/fchown-stub.c\n   lib/fcntl.c\n   lib/fcntl.in.h\n   lib/fd-hook.c\n@@ -1189,6 +1200,7 @@ AC_DEFUN([gl_FILE_LIST], [\n   m4/builtin-expect.m4\n   m4/canonicalize.m4\n   m4/chdir-long.m4\n+  m4/chown.m4\n   m4/clock_time.m4\n   m4/close.m4\n   m4/closedir.m4"
    },
    {
      "sha": "44e8db47e2ba53f2285e933c407c34d60c39fe68",
      "filename": "gnulib/update-gnulib.sh",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/update-gnulib.sh",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/64c2e4a530837b13f987f5de386c49bac90aef43/gnulib/update-gnulib.sh",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gnulib/update-gnulib.sh?ref=64c2e4a530837b13f987f5de386c49bac90aef43",
      "patch": "@@ -32,6 +32,7 @@\n IMPORTED_GNULIB_MODULES=\"\\\n     alloca \\\n     canonicalize-lgpl \\\n+    chown \\\n     count-one-bits \\\n     dirent \\\n     dirfd \\"
    }
  ]
}