{
  "sha": "202054aea670db6441f6b04c59ff58e6c3a1f8ca",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MjAyMDU0YWVhNjcwZGI2NDQxZjZiMDRjNTlmZjU4ZTZjM2ExZjhjYQ==",
  "commit": {
    "author": {
      "name": "Carl Love",
      "email": "cel@us.ibm.com",
      "date": "2021-06-16T17:07:39Z"
    },
    "committer": {
      "name": "Carl Love",
      "email": "cel@us.ibm.com",
      "date": "2021-06-25T16:08:47Z"
    },
    "message": "Add ISA 3.1 check to powerpc-plxv-norel.exp\n\nThis patch adds a file with the ISA 3.1 check.  The ISA 3.1 check is\nadded to the test to ensure the test is only run on ISA 3.1 or newer.\n\ngdb/testsuite/ChangeLog\n2021-06-25  Carl Love  <cel@us.ibm.com>\n\n\t* gdb.arch/powerpc-plxv-norel.exp: Add call to skip_power_isa_3_1_tests.\n\t* lib/gdb.exp(skip_power_isa_3_1_tests): New gdb_caching_proc test.",
    "tree": {
      "sha": "1853d09c46b22e02d7ac297985b470412aa06621",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/1853d09c46b22e02d7ac297985b470412aa06621"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/202054aea670db6441f6b04c59ff58e6c3a1f8ca",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/202054aea670db6441f6b04c59ff58e6c3a1f8ca",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/202054aea670db6441f6b04c59ff58e6c3a1f8ca",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/202054aea670db6441f6b04c59ff58e6c3a1f8ca/comments",
  "author": {
    "login": "carlelove",
    "id": 86435705,
    "node_id": "MDQ6VXNlcjg2NDM1NzA1",
    "avatar_url": "https://avatars.githubusercontent.com/u/86435705?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/carlelove",
    "html_url": "https://github.com/carlelove",
    "followers_url": "https://api.github.com/users/carlelove/followers",
    "following_url": "https://api.github.com/users/carlelove/following{/other_user}",
    "gists_url": "https://api.github.com/users/carlelove/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/carlelove/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/carlelove/subscriptions",
    "organizations_url": "https://api.github.com/users/carlelove/orgs",
    "repos_url": "https://api.github.com/users/carlelove/repos",
    "events_url": "https://api.github.com/users/carlelove/events{/privacy}",
    "received_events_url": "https://api.github.com/users/carlelove/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "carlelove",
    "id": 86435705,
    "node_id": "MDQ6VXNlcjg2NDM1NzA1",
    "avatar_url": "https://avatars.githubusercontent.com/u/86435705?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/carlelove",
    "html_url": "https://github.com/carlelove",
    "followers_url": "https://api.github.com/users/carlelove/followers",
    "following_url": "https://api.github.com/users/carlelove/following{/other_user}",
    "gists_url": "https://api.github.com/users/carlelove/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/carlelove/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/carlelove/subscriptions",
    "organizations_url": "https://api.github.com/users/carlelove/orgs",
    "repos_url": "https://api.github.com/users/carlelove/repos",
    "events_url": "https://api.github.com/users/carlelove/events{/privacy}",
    "received_events_url": "https://api.github.com/users/carlelove/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "50a6759f0f541ea965c7330bfbfe335cb8d66af8",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/50a6759f0f541ea965c7330bfbfe335cb8d66af8",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/50a6759f0f541ea965c7330bfbfe335cb8d66af8"
    }
  ],
  "stats": {
    "total": 57,
    "additions": 55,
    "deletions": 2
  },
  "files": [
    {
      "sha": "040a12fe879582253c1cfb9571c7b39135d8250c",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/202054aea670db6441f6b04c59ff58e6c3a1f8ca/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/202054aea670db6441f6b04c59ff58e6c3a1f8ca/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=202054aea670db6441f6b04c59ff58e6c3a1f8ca",
      "patch": "@@ -1,3 +1,9 @@\n+gdb/testsuite/ChangeLog\n+2021-06-25  Carl Love  <cel@us.ibm.com>\n+\n+\t* gdb.arch/powerpc-plxv-norel.exp: Add call to skip_power_isa_3_1_tests.\n+\t* lib/gdb.exp(skip_power_isa_3_1_tests): New gdb_caching_proc test.\n+\n 2021-06-25  Tom Tromey  <tromey@adacore.com>\n \n \t* gdb.ada/py_range.exp: Add type name test cases."
    },
    {
      "sha": "446b2bdd39aa182e57f64bd02f58ab66b4c865a6",
      "filename": "gdb/testsuite/gdb.arch/powerpc-plxv-nonrel.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/202054aea670db6441f6b04c59ff58e6c3a1f8ca/gdb/testsuite/gdb.arch/powerpc-plxv-nonrel.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/202054aea670db6441f6b04c59ff58e6c3a1f8ca/gdb/testsuite/gdb.arch/powerpc-plxv-nonrel.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.arch/powerpc-plxv-nonrel.exp?ref=202054aea670db6441f6b04c59ff58e6c3a1f8ca",
      "patch": "@@ -16,8 +16,8 @@\n # Test to see if gdb is properly single stepping over the\n # displaced plxv instruction.\n \n-if { ![istarget powerpc*-*] } {\n-    verbose \"Skipping powerpc plxv test.\"\n+if { ![istarget powerpc*-*] || [skip_power_isa_3_1_tests] } {\n+    verbose \"Skipping powerpc ISA 3.1 plxv test.\"\n     return\n }\n "
    },
    {
      "sha": "1013120045a34bf2cc36937da08f9dfbb4e16ca6",
      "filename": "gdb/testsuite/lib/gdb.exp",
      "status": "modified",
      "additions": 47,
      "deletions": 0,
      "changes": 47,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/202054aea670db6441f6b04c59ff58e6c3a1f8ca/gdb/testsuite/lib/gdb.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/202054aea670db6441f6b04c59ff58e6c3a1f8ca/gdb/testsuite/lib/gdb.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/gdb.exp?ref=202054aea670db6441f6b04c59ff58e6c3a1f8ca",
      "patch": "@@ -3129,6 +3129,53 @@ gdb_caching_proc skip_altivec_tests {\n     return $skip_vmx_tests\n }\n \n+# Run a test on the power target to see if it supports ISA 3.1 instructions\n+gdb_caching_proc skip_power_isa_3_1_tests {\n+    global srcdir subdir gdb_prompt inferior_exited_re\n+\n+    set me \"skip_power_isa_3_1_tests\"\n+\n+    # Compile a test program containing ISA 3.1 instructions.\n+    set src {\n+\tint main() {\n+\tasm volatile (\"pnop\"); // marker\n+\t\tasm volatile (\"nop\");\n+\t\treturn 0;\n+\t    }\n+\t}\n+\n+    if {![gdb_simple_compile $me $src executable ]} {\n+        return 1\n+    }\n+\n+    # No error message, compilation succeeded so now run it via gdb.\n+\n+    gdb_exit\n+    gdb_start\n+    gdb_reinitialize_dir $srcdir/$subdir\n+    gdb_load \"$obj\"\n+    gdb_run_cmd\n+    gdb_expect {\n+        -re \".*Illegal instruction.*${gdb_prompt} $\" {\n+            verbose -log \"\\n$me Power ISA 3.1 hardware not detected\"\n+            set skip_power_isa_3_1_tests 1\n+        }\n+        -re \".*$inferior_exited_re normally.*${gdb_prompt} $\" {\n+            verbose -log \"\\n$me: Power ISA 3.1 hardware detected\"\n+            set skip_power_isa_3_1_tests 0\n+        }\n+        default {\n+          warning \"\\n$me: default case taken\"\n+            set skip_power_isa_3_1_tests 1\n+        }\n+    }\n+    gdb_exit\n+    remote_file build delete $obj\n+\n+    verbose \"$me:  returning $skip_power_isa_3_1_tests\" 2\n+    return $skip_power_isa_3_1_tests\n+}\n+\n # Run a test on the target to see if it supports vmx hardware.  Return 0 if so,\n # 1 if it does not.  Based on 'check_vmx_hw_available' from the GCC testsuite.\n "
    }
  ]
}