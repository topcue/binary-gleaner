{
  "sha": "1773be9ea2207d42442222e6dc3c8fdbe638e28e",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTc3M2JlOWVhMjIwN2Q0MjQ0MjIyMmU2ZGMzYzhmZGJlNjM4ZTI4ZQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-03-20T13:15:08Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-03-20T14:28:52Z"
    },
    "message": "Fix column alignment in \"maint info line-table\"\n\nAndrew Burgess pointed out on irc that \"maint info line-table\" doesn't\nproperly align the table headers.  This patch fixes the problem by\nswitching the table to use ui-out.\n\nThis required a small tweak to one test case, as ui-out will pad a\nfield using spaces, even at the end of a line.\n\ngdb/ChangeLog\n2020-03-20  Tom Tromey  <tromey@adacore.com>\n\n\t* symmisc.c (maintenance_print_one_line_table): Use ui_out.\n\ngdb/testsuite/ChangeLog\n2020-03-20  Tom Tromey  <tromey@adacore.com>\n\n\t* gdb.dwarf2/dw2-ranges-base.exp: Update regular expressions.",
    "tree": {
      "sha": "d59c056f8da51ffa36d952d343bd7de018c1fa12",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d59c056f8da51ffa36d952d343bd7de018c1fa12"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/1773be9ea2207d42442222e6dc3c8fdbe638e28e",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1773be9ea2207d42442222e6dc3c8fdbe638e28e",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/1773be9ea2207d42442222e6dc3c8fdbe638e28e",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1773be9ea2207d42442222e6dc3c8fdbe638e28e/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "70304be939301a91dade0dc7d4234c081372bd24",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/70304be939301a91dade0dc7d4234c081372bd24",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/70304be939301a91dade0dc7d4234c081372bd24"
    }
  ],
  "stats": {
    "total": 43,
    "additions": 28,
    "deletions": 15
  },
  "files": [
    {
      "sha": "f1b007b1ba3de216837927cd71287e4345a367be",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1773be9ea2207d42442222e6dc3c8fdbe638e28e/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1773be9ea2207d42442222e6dc3c8fdbe638e28e/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=1773be9ea2207d42442222e6dc3c8fdbe638e28e",
      "patch": "@@ -1,3 +1,7 @@\n+2020-03-20  Tom Tromey  <tromey@adacore.com>\n+\n+\t* symmisc.c (maintenance_print_one_line_table): Use ui_out.\n+\n 2020-03-20  Tom Tromey  <tromey@adacore.com>\n \n \t* ada-valprint.c (print_variant_part): Remove parameters; switch"
    },
    {
      "sha": "3df526bddba73bcbc989f1f6333e1c5e9017db99",
      "filename": "gdb/symmisc.c",
      "status": "modified",
      "additions": 17,
      "deletions": 12,
      "changes": 29,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1773be9ea2207d42442222e6dc3c8fdbe638e28e/gdb/symmisc.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1773be9ea2207d42442222e6dc3c8fdbe638e28e/gdb/symmisc.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/symmisc.c?ref=1773be9ea2207d42442222e6dc3c8fdbe638e28e",
      "patch": "@@ -985,26 +985,31 @@ maintenance_print_one_line_table (struct symtab *symtab, void *data)\n     printf_filtered (_(\"Line table has no lines.\\n\"));\n   else\n     {\n-      int i;\n-\n       /* Leave space for 6 digits of index and line number.  After that the\n \t tables will just not format as well.  */\n-      printf_filtered (_(\"%-6s %6s %s %s\\n\"),\n-\t\t       _(\"INDEX\"), _(\"LINE\"), _(\"ADDRESS\"), _(\"IS-STMT\"));\n-\n-      for (i = 0; i < linetable->nitems; ++i)\n+      struct ui_out *uiout = current_uiout;\n+      ui_out_emit_table table_emitter (uiout, 4, -1, \"line-table\");\n+      uiout->table_header (6, ui_left, \"index\", _(\"INDEX\"));\n+      uiout->table_header (6, ui_left, \"line\", _(\"LINE\"));\n+      uiout->table_header (18, ui_left, \"address\", _(\"ADDRESS\"));\n+      uiout->table_header (1, ui_left, \"is-stmt\", _(\"IS-STMT\"));\n+      uiout->table_body ();\n+\n+      for (int i = 0; i < linetable->nitems; ++i)\n \t{\n \t  struct linetable_entry *item;\n \n \t  item = &linetable->item [i];\n-\t  printf_filtered (\"%-6d \", i);\n+\t  ui_out_emit_tuple tuple_emitter (uiout, nullptr);\n+\t  uiout->field_signed (\"index\", i);\n \t  if (item->line > 0)\n-\t    printf_filtered (\"%6d \", item->line);\n+\t    uiout->field_signed (\"line\", item->line);\n \t  else\n-\t    printf_filtered (\"%6s \", _(\"END\"));\n-\t  printf_filtered (\"%s%s\\n\",\n-\t\t\t   core_addr_to_string (item->pc),\n-\t\t\t   (item->is_stmt ? \" Y\" : \"\"));\n+\t    uiout->field_string (\"line\", _(\"END\"));\n+\t  uiout->field_core_addr (\"address\", get_objfile_arch (objfile),\n+\t\t\t\t  item->pc);\n+\t  uiout->field_string (\"is-stmt\", item->is_stmt ? \"Y\" : \"\");\n+\t  uiout->text (\"\\n\");\n \t}\n     }\n "
    },
    {
      "sha": "e7613f0416b8b068c752092fc5b4349cd2f3f683",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1773be9ea2207d42442222e6dc3c8fdbe638e28e/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1773be9ea2207d42442222e6dc3c8fdbe638e28e/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=1773be9ea2207d42442222e6dc3c8fdbe638e28e",
      "patch": "@@ -1,3 +1,7 @@\n+2020-03-20  Tom Tromey  <tromey@adacore.com>\n+\n+\t* gdb.dwarf2/dw2-ranges-base.exp: Update regular expressions.\n+\n 2020-03-20  Tom Tromey  <tromey@adacore.com>\n \n \t* gdb.ada/sub_variant/subv.adb: New file."
    },
    {
      "sha": "92f8f6cecbed908721244dbd769b3c5f715668ef",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-ranges-base.exp",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1773be9ea2207d42442222e6dc3c8fdbe638e28e/gdb/testsuite/gdb.dwarf2/dw2-ranges-base.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1773be9ea2207d42442222e6dc3c8fdbe638e28e/gdb/testsuite/gdb.dwarf2/dw2-ranges-base.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-ranges-base.exp?ref=1773be9ea2207d42442222e6dc3c8fdbe638e28e",
      "patch": "@@ -146,10 +146,10 @@ gdb_test \"info line frame3\" \\\n set end_seq_count 0\n gdb_test_multiple \"maint info line-table gdb.dwarf2/dw2-ranges-base.c\" \\\n     \"count END markers in line table\" {\n-\t-re \"^$decimal\\[ \\t\\]+$decimal\\[ \\t\\]+$hex\\(\\[ \\t\\]+Y\\)?\\r\\n\" {\n+\t-re \"^$decimal\\[ \\t\\]+$decimal\\[ \\t\\]+$hex\\(\\[ \\t\\]+Y\\)? *\\r\\n\" {\n \t    exp_continue\n \t}\n-\t-re \"^$decimal\\[ \\t\\]+END\\[ \\t\\]+$hex\\(\\[ \\t\\]+Y\\)?\\r\\n\" {\n+\t-re \"^$decimal\\[ \\t\\]+END\\[ \\t\\]+$hex\\(\\[ \\t\\]+Y\\)? *\\r\\n\" {\n \t    incr end_seq_count\n \t    exp_continue\n \t}\n@@ -159,7 +159,7 @@ gdb_test_multiple \"maint info line-table gdb.dwarf2/dw2-ranges-base.c\" \\\n \t-re \".*linetable: \\\\(\\\\(struct linetable \\\\*\\\\) 0x0\\\\):\\r\\nNo line table.\\r\\n\" {\n \t    exp_continue\n \t}\n-\t-re \".*linetable: \\\\(\\\\(struct linetable \\\\*\\\\) $hex\\\\):\\r\\nINDEX\\[ \\t\\]+LINE\\[ \\t\\]+ADDRESS\\[ \\t\\]+IS-STMT\\r\\n\" {\n+\t-re \".*linetable: \\\\(\\\\(struct linetable \\\\*\\\\) $hex\\\\):\\r\\nINDEX\\[ \\t\\]+LINE\\[ \\t\\]+ADDRESS\\[ \\t\\]+IS-STMT *\\r\\n\" {\n \t    exp_continue\n \t}\n     }"
    }
  ]
}