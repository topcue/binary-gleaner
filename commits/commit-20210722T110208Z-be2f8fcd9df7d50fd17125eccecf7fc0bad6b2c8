{
  "sha": "be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YmUyZjhmY2Q5ZGY3ZDUwZmQxNzEyNWVjY2VjZjdmYzBiYWQ2YjJjOA==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2021-07-22T11:02:08Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2021-07-22T11:02:08Z"
    },
    "message": "x86: correct VCVT{,U}SI2SD rounding mode handling\n\nWith EVEX.W clear the instruction doesn't ignore the rounding mode, but\n(like for other insns without rounding semantics) EVEX.b set causes #UD.\nHence the handling of EVEX.W needs to be done when processing\nevex_rounding_64_mode, not at the decode stages.\n\nDerive a new 64-bit testcase from the 32-bit one to cover the different\nEVEX.W treatment in both cases.",
    "tree": {
      "sha": "e1c5643331999a38a19673f39b70b19d505df876",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/e1c5643331999a38a19673f39b70b19d505df876"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/comments",
  "author": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d0579d4d1c724b524da43ad164ce140218497ead",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d0579d4d1c724b524da43ad164ce140218497ead",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d0579d4d1c724b524da43ad164ce140218497ead"
    }
  ],
  "stats": {
    "total": 47,
    "additions": 31,
    "deletions": 16
  },
  "files": [
    {
      "sha": "b02bca39098edcd076dd418871495486be44777f",
      "filename": "gas/testsuite/gas/i386/evex.d",
      "status": "modified",
      "additions": 4,
      "deletions": 1,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/gas/testsuite/gas/i386/evex.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/gas/testsuite/gas/i386/evex.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/evex.d?ref=be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
      "patch": "@@ -1,5 +1,5 @@\n #objdump: -dw -Msuffix\n-#name: i386 EVX insns\n+#name: i386 EVEX insns\n \n .*: +file format .*\n \n@@ -8,9 +8,12 @@ Disassembly of section .text:\n \n 0+ <_start>:\n  +[a-f0-9]+:\t62 f1 d6 38 2a f0    \tvcvtsi2ssl %eax,\\{rd-sae\\},%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 57 38 2a f0    \tvcvtsi2sdl %eax,\\(bad\\),%xmm5,%xmm6\n  +[a-f0-9]+:\t62 f1 d7 38 2a f0    \tvcvtsi2sdl %eax,\\(bad\\),%xmm5,%xmm6\n  +[a-f0-9]+:\t62 f1 d6 08 7b f0    \tvcvtusi2ssl %eax,%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 57 08 7b f0    \tvcvtusi2sdl %eax,%xmm5,%xmm6\n  +[a-f0-9]+:\t62 f1 d7 08 7b f0    \tvcvtusi2sdl %eax,%xmm5,%xmm6\n  +[a-f0-9]+:\t62 f1 d6 38 7b f0    \tvcvtusi2ssl %eax,\\{rd-sae\\},%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 57 38 7b f0    \tvcvtusi2sdl %eax,\\(bad\\),%xmm5,%xmm6\n  +[a-f0-9]+:\t62 f1 d7 38 7b f0    \tvcvtusi2sdl %eax,\\(bad\\),%xmm5,%xmm6\n #pass"
    },
    {
      "sha": "90c635a27b6ca706e78245c876db00eb768e9547",
      "filename": "gas/testsuite/gas/i386/evex.s",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/gas/testsuite/gas/i386/evex.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/gas/testsuite/gas/i386/evex.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/evex.s?ref=be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
      "patch": "@@ -4,8 +4,11 @@\n \t.text\n _start:\n \t.byte 0x62, 0xf1, 0xd6, 0x38, 0x2a, 0xf0\n+\t.byte 0x62, 0xf1, 0x57, 0x38, 0x2a, 0xf0\n \t.byte 0x62, 0xf1, 0xd7, 0x38, 0x2a, 0xf0\n \t.byte 0x62, 0xf1, 0xd6, 0x08, 0x7b, 0xf0\n+\t.byte 0x62, 0xf1, 0x57, 0x08, 0x7b, 0xf0\n \t.byte 0x62, 0xf1, 0xd7, 0x08, 0x7b, 0xf0\n \t.byte 0x62, 0xf1, 0xd6, 0x38, 0x7b, 0xf0\n+\t.byte 0x62, 0xf1, 0x57, 0x38, 0x7b, 0xf0\n \t.byte 0x62, 0xf1, 0xd7, 0x38, 0x7b, 0xf0"
    },
    {
      "sha": "6f9543eec3a2e5e182ff1084af46334545907339",
      "filename": "gas/testsuite/gas/i386/i386.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/gas/testsuite/gas/i386/i386.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/gas/testsuite/gas/i386/i386.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/i386.exp?ref=be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
      "patch": "@@ -929,6 +929,7 @@ if [gas_64_check] then {\n     run_dump_test \"x86-64-avx512er-intel\"\n     run_dump_test \"x86-64-avx512pf\"\n     run_dump_test \"x86-64-avx512pf-intel\"\n+    run_dump_test \"x86-64-evex\"\n     run_dump_test \"x86-64-evex-lig256\"\n     run_dump_test \"x86-64-evex-lig512\"\n     run_dump_test \"x86-64-evex-lig256-intel\""
    },
    {
      "sha": "b360aa74a173e12ff2d5c7695babbafe927c0299",
      "filename": "gas/testsuite/gas/i386/x86-64-evex.d",
      "status": "added",
      "additions": 20,
      "deletions": 0,
      "changes": 20,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/gas/testsuite/gas/i386/x86-64-evex.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/gas/testsuite/gas/i386/x86-64-evex.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-evex.d?ref=be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
      "patch": "@@ -0,0 +1,20 @@\n+#objdump: -dw\n+#name: x86-64 EVEX insns\n+#source: evex.s\n+\n+.*: +file format .*\n+\n+\n+Disassembly of section .text:\n+\n+0+ <_start>:\n+ +[a-f0-9]+:\t62 f1 d6 38 2a f0    \tvcvtsi2ss %rax,\\{rd-sae\\},%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 57 38 2a f0    \tvcvtsi2sd %eax,\\(bad\\),%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 d7 38 2a f0    \tvcvtsi2sd %rax,\\{rd-sae\\},%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 d6 08 7b f0    \tvcvtusi2ss %rax,%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 57 08 7b f0    \tvcvtusi2sd %eax,%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 d7 08 7b f0    \tvcvtusi2sd %rax,%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 d6 38 7b f0    \tvcvtusi2ss %rax,\\{rd-sae\\},%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 57 38 7b f0    \tvcvtusi2sd %eax,\\(bad\\),%xmm5,%xmm6\n+ +[a-f0-9]+:\t62 f1 d7 38 7b f0    \tvcvtusi2sd %rax,\\{rd-sae\\},%xmm5,%xmm6\n+#pass"
    },
    {
      "sha": "9ad9372a2213e18c800a5dca5af907a01de2d746",
      "filename": "opcodes/i386-dis-evex-prefix.h",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/opcodes/i386-dis-evex-prefix.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/opcodes/i386-dis-evex-prefix.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-dis-evex-prefix.h?ref=be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
      "patch": "@@ -30,7 +30,7 @@\n     { Bad_Opcode },\n     { \"vcvtsi2ss{%LQ|}\",\t{ XMScalar, VexScalar, EXxEVexR, Edq }, 0 },\n     { Bad_Opcode },\n-    { VEX_W_TABLE (EVEX_W_0F2A_P_3) },\n+    { \"vcvtsi2sd{%LQ|}\",\t{ XMScalar, VexScalar, EXxEVexR64, Edq }, 0 },\n   },\n   /* PREFIX_EVEX_0F51 */\n   {\n@@ -134,7 +134,7 @@\n     { Bad_Opcode },\n     { \"vcvtusi2ss{%LQ|}\",\t{ XMScalar, VexScalar, EXxEVexR, Edq }, 0 },\n     { VEX_W_TABLE (EVEX_W_0F7B_P_2) },\n-    { VEX_W_TABLE (EVEX_W_0F7B_P_3) },\n+    { \"vcvtusi2sd{%LQ|}\",\t{ XMScalar, VexScalar, EXxEVexR64, Edq }, 0 },\n   },\n   /* PREFIX_EVEX_0F7E */\n   {"
    },
    {
      "sha": "8af4695a0049f6b7278a2169eadfa828d430d794",
      "filename": "opcodes/i386-dis-evex-w.h",
      "status": "modified",
      "additions": 0,
      "deletions": 10,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/opcodes/i386-dis-evex-w.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/opcodes/i386-dis-evex-w.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-dis-evex-w.h?ref=be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
      "patch": "@@ -37,11 +37,6 @@\n   {\n     { \"vmovshdup\",\t{ XM, EXx }, 0 },\n   },\n-  /* EVEX_W_0F2A_P_3 */\n-  {\n-    { \"vcvtsi2sd{%LQ|}\",\t{ XMScalar, VexScalar, Ed }, 0 },\n-    { \"vcvtsi2sd{%LQ|}\",\t{ XMScalar, VexScalar, EXxEVexR64, Edq }, 0 },\n-  },\n   /* EVEX_W_0F51_P_1 */\n   {\n     { \"vsqrtss\",\t{ XMScalar, VexScalar, EXxmm_md, EXxEVexR }, 0 },\n@@ -243,11 +238,6 @@\n     { \"vcvtps2qq\",\t{ XM, EXEvexHalfBcstXmmq, EXxEVexR }, 0 },\n     { \"vcvtpd2qq\",\t{ XM, EXx, EXxEVexR }, 0 },\n   },\n-  /* EVEX_W_0F7B_P_3 */\n-  {\n-    { \"vcvtusi2sd{%LQ|}\",\t{ XMScalar, VexScalar, Ed }, 0 },\n-    { \"vcvtusi2sd{%LQ|}\",\t{ XMScalar, VexScalar, EXxEVexR64, Edq }, 0 },\n-  },\n   /* EVEX_W_0F7E_P_1 */\n   {\n     { Bad_Opcode },"
    },
    {
      "sha": "ccc49ff023f7c90ba49da87f0a35f7befac9aa80",
      "filename": "opcodes/i386-dis.c",
      "status": "modified",
      "additions": 1,
      "deletions": 3,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/opcodes/i386-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8/opcodes/i386-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/i386-dis.c?ref=be2f8fcd9df7d50fd17125eccecf7fc0bad6b2c8",
      "patch": "@@ -1476,7 +1476,6 @@ enum\n   EVEX_W_0F12_P_3,\n   EVEX_W_0F16_P_0_M_1,\n   EVEX_W_0F16_P_1,\n-  EVEX_W_0F2A_P_3,\n   EVEX_W_0F51_P_1,\n   EVEX_W_0F51_P_3,\n   EVEX_W_0F58_P_1,\n@@ -1521,7 +1520,6 @@ enum\n   EVEX_W_0F7A_P_2,\n   EVEX_W_0F7A_P_3,\n   EVEX_W_0F7B_P_2,\n-  EVEX_W_0F7B_P_3,\n   EVEX_W_0F7E_P_1,\n   EVEX_W_0F7F_P_1,\n   EVEX_W_0F7F_P_2,\n@@ -13724,7 +13722,7 @@ OP_Rounding (int bytemode, int sizeflag ATTRIBUTE_UNUSED)\n     switch (bytemode)\n       {\n       case evex_rounding_64_mode:\n-\tif (address_mode != mode_64bit)\n+\tif (address_mode != mode_64bit || !vex.w)\n \t  {\n \t    oappend (\"(bad)\");\n \t    break;"
    }
  ]
}