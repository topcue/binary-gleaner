{
  "sha": "503648e41efa19dfb059757ffddf0206b6060520",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NTAzNjQ4ZTQxZWZhMTlkZmIwNTk3NTdmZmRkZjAyMDZiNjA2MDUyMA==",
  "commit": {
    "author": {
      "name": "liuhongt",
      "email": "hongtao.liu@intel.com",
      "date": "2020-05-09T07:02:50Z"
    },
    "committer": {
      "name": "liuhongt",
      "email": "hongtao.liu@intel.com",
      "date": "2020-05-18T02:23:59Z"
    },
    "message": "Don't handle lret/iret when -mlfence-before-ret=[or|not|shl|yes] since they are invalid in SGX enclaves.\n\ngas/ChangeLog\n\t* gas/config/tc-i386.c: Not handle lret/iret.\n\t* gas/testsuite/gas/i386/lfence-ret-a.d: Adjust testcase.\n\t* gas/testsuite/gas/i386/lfence-ret-b.d: Ditto.\n\t* gas/testsuite/gas/i386/lfence-ret-c.d: Ditto.\n\t* gas/testsuite/gas/i386/lfence-ret-d.d: Ditto.\n\t* gas/testsuite/gas/i386/lfence-ret.s: Ditto.\n\t* gas/testsuite/gas/i386/x86-64-lfence-ret-a.d: Ditto.\n\t* gas/testsuite/gas/i386/x86-64-lfence-ret-b.d: Ditto.\n\t* gas/testsuite/gas/i386/x86-64-lfence-ret-c.d: Ditto.\n\t* gas/testsuite/gas/i386/x86-64-lfence-ret-d.d: Ditto.\n\t* gas/testsuite/gas/i386/x86-64-lfence-ret-e.d: Ditto.\n\t* gas/testsuite/gas/i386/x86-64-lfence-ret.s: Ditto.\n\t* gas/testsuite/gas/i386/x86-64-lfence-ret.e: Deleted.",
    "tree": {
      "sha": "29a806712618bc2fedf880b6db9270e33557f966",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/29a806712618bc2fedf880b6db9270e33557f966"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/503648e41efa19dfb059757ffddf0206b6060520",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/503648e41efa19dfb059757ffddf0206b6060520",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/503648e41efa19dfb059757ffddf0206b6060520",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/503648e41efa19dfb059757ffddf0206b6060520/comments",
  "author": {
    "login": "algebra84",
    "id": 22926165,
    "node_id": "MDQ6VXNlcjIyOTI2MTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/algebra84",
    "html_url": "https://github.com/algebra84",
    "followers_url": "https://api.github.com/users/algebra84/followers",
    "following_url": "https://api.github.com/users/algebra84/following{/other_user}",
    "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions",
    "organizations_url": "https://api.github.com/users/algebra84/orgs",
    "repos_url": "https://api.github.com/users/algebra84/repos",
    "events_url": "https://api.github.com/users/algebra84/events{/privacy}",
    "received_events_url": "https://api.github.com/users/algebra84/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "algebra84",
    "id": 22926165,
    "node_id": "MDQ6VXNlcjIyOTI2MTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/algebra84",
    "html_url": "https://github.com/algebra84",
    "followers_url": "https://api.github.com/users/algebra84/followers",
    "following_url": "https://api.github.com/users/algebra84/following{/other_user}",
    "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions",
    "organizations_url": "https://api.github.com/users/algebra84/orgs",
    "repos_url": "https://api.github.com/users/algebra84/repos",
    "events_url": "https://api.github.com/users/algebra84/events{/privacy}",
    "received_events_url": "https://api.github.com/users/algebra84/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "07a78c595604b00908f06396aa221d446adbe6f8",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/07a78c595604b00908f06396aa221d446adbe6f8",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/07a78c595604b00908f06396aa221d446adbe6f8"
    }
  ],
  "stats": {
    "total": 204,
    "additions": 22,
    "deletions": 182
  },
  "files": [
    {
      "sha": "3b8ea166f0c2dd5ad710c01840a25cbf6a9680b0",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 16,
      "deletions": 0,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -1,3 +1,19 @@\n+2020-05-18  Hongtao Liu  <hongtao.liu@intel.com>\n+\n+\t* config/tc-i386.c: Not handle lret/iret.\n+\t* testsuite/gas/i386/lfence-ret-a.d: Adjust testcase.\n+\t* testsuite/gas/i386/lfence-ret-b.d: Ditto.\n+\t* testsuite/gas/i386/lfence-ret-c.d: Ditto.\n+\t* testsuite/gas/i386/lfence-ret-d.d: Ditto.\n+\t* testsuite/gas/i386/lfence-ret.s: Ditto.\n+\t* testsuite/gas/i386/x86-64-lfence-ret-a.d: Ditto.\n+\t* testsuite/gas/i386/x86-64-lfence-ret-b.d: Ditto.\n+\t* testsuite/gas/i386/x86-64-lfence-ret-c.d: Ditto.\n+\t* testsuite/gas/i386/x86-64-lfence-ret-d.d: Ditto.\n+\t* testsuite/gas/i386/x86-64-lfence-ret-e.d: Ditto.\n+\t* testsuite/gas/i386/x86-64-lfence-ret.s: Ditto.\n+\t* testsuite/gas/i386/x86-64-lfence-ret.e: Deleted.\n+\n 2020-05-15  Alan Modra  <amodra@gmail.com>\n \t    Alex Coplan  <alex.coplan@arm.com>\n "
    },
    {
      "sha": "ae1bd0d5bbc0fe3026e5de39949364999f8eef65",
      "filename": "gas/config/tc-i386.c",
      "status": "modified",
      "additions": 5,
      "deletions": 15,
      "changes": 20,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/config/tc-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/config/tc-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.c?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -4591,13 +4591,10 @@ insert_lfence_before (void)\n       return;\n     }\n \n-  /* Output or/not/shl and lfence before ret/lret/iret.  */\n+  /* Output or/not/shl and lfence before near ret.  */\n   if (lfence_before_ret != lfence_before_ret_none\n       && (i.tm.base_opcode == 0xc2\n-\t  || i.tm.base_opcode == 0xc3\n-\t  || i.tm.base_opcode == 0xca\n-\t  || i.tm.base_opcode == 0xcb\n-\t  || i.tm.base_opcode == 0xcf))\n+\t  || i.tm.base_opcode == 0xc3))\n     {\n       if (last_insn.kind != last_insn_other\n \t  && last_insn.seg == now_seg)\n@@ -4608,17 +4605,10 @@ insert_lfence_before (void)\n \t  return;\n \t}\n \n-      /* lret or iret.  */\n-      bfd_boolean lret = (i.tm.base_opcode | 0x5) == 0xcf;\n-      bfd_boolean has_rexw = i.prefix[REX_PREFIX] & REX_W;\n-      char prefix = 0x0;\n-      /* Default operand size for far return is 32 bits,\n-\t 64 bits for near return.  */\n       /* Near ret ingore operand size override under CPU64.  */\n-      if ((!lret && flag_code == CODE_64BIT) || has_rexw)\n-\tprefix = 0x48;\n-      else if (i.prefix[DATA_PREFIX])\n-\tprefix = 0x66;\n+      char prefix = flag_code == CODE_64BIT\n+\t\t    ? 0x48\n+\t\t    : i.prefix[DATA_PREFIX] ? 0x66 : 0x0;\n \n       if (lfence_before_ret == lfence_before_ret_not)\n \t{"
    },
    {
      "sha": "613d1d50a2c03a5476e55cf6ec37703f0e73538e",
      "filename": "gas/testsuite/gas/i386/lfence-ret-a.d",
      "status": "modified",
      "additions": 0,
      "deletions": 12,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret-a.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret-a.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/lfence-ret-a.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -21,16 +21,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%esp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\tc2 1e 00             \tret    \\$0x1e\n- +[a-f0-9]+:\t66 83 0c 24 00       \torw    \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 83 0c 24 00       \torw    \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n #pass"
    },
    {
      "sha": "e6dd4f4bf6b9414c98b1d4e2d91cc1e8e010a7a4",
      "filename": "gas/testsuite/gas/i386/lfence-ret-b.d",
      "status": "modified",
      "additions": 0,
      "deletions": 16,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret-b.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret-b.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/lfence-ret-b.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -25,20 +25,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%esp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\tc2 1e 00             \tret    \\$0x1e\n- +[a-f0-9]+:\t66 f7 14 24          \tnotw   \\(%esp\\)\n- +[a-f0-9]+:\t66 f7 14 24          \tnotw   \\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 f7 14 24          \tnotw   \\(%esp\\)\n- +[a-f0-9]+:\t66 f7 14 24          \tnotw   \\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%esp\\)\n- +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%esp\\)\n- +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n #pass"
    },
    {
      "sha": "02f57fee70261a3d2411d31dae13ae36da58e9a3",
      "filename": "gas/testsuite/gas/i386/lfence-ret-c.d",
      "status": "modified",
      "additions": 1,
      "deletions": 13,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret-c.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret-c.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/lfence-ret-c.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -1,7 +1,7 @@\n #source: lfence-ret.s\n #as: -mlfence-before-ret=or -mlfence-before-indirect-branch=all\n #objdump: -dw\n-\n+#name -mlfence-before-ret=or -mlfence-before-indirect-branch=all\n .*: +file format .*\n \n \n@@ -20,16 +20,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%esp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\tc2 1e 00             \tret    \\$0x1e\n- +[a-f0-9]+:\t66 83 0c 24 00       \torw    \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 83 0c 24 00       \torw    \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n #pass"
    },
    {
      "sha": "9078216e53e6047d3b6788ba9790666b5a097ef5",
      "filename": "gas/testsuite/gas/i386/lfence-ret-d.d",
      "status": "modified",
      "additions": 0,
      "deletions": 12,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret-d.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret-d.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/lfence-ret-d.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -21,16 +21,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\tc1 24 24 00          \tshll   \\$0x0,\\(%esp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\tc2 1e 00             \tret    \\$0x1e\n- +[a-f0-9]+:\t66 c1 24 24 00       \tshlw   \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 c1 24 24 00       \tshlw   \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\tc1 24 24 00          \tshll   \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\tc1 24 24 00          \tshll   \\$0x0,\\(%esp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n #pass"
    },
    {
      "sha": "5de4f08447e758727f250d3a02ee39c13f0f975f",
      "filename": "gas/testsuite/gas/i386/lfence-ret.s",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/lfence-ret.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/lfence-ret.s?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -4,7 +4,3 @@ _start:\n \tretw\t$20\n \tret\n \tret\t$30\n-\tlretw\n-\tlretw\t$40\n-\tlret\n-\tlret\t$40\t"
    },
    {
      "sha": "96881677b63758315b65e3fcd3699e3f7b8fdfbc",
      "filename": "gas/testsuite/gas/i386/x86-64-lfence-ret-a.d",
      "status": "modified",
      "additions": 0,
      "deletions": 19,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-a.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-a.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-lfence-ret-a.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -1,6 +1,5 @@\n #source: x86-64-lfence-ret.s\n #as: -mlfence-before-ret=or\n-#warning_output: x86-64-lfence-ret.e\n #objdump: -dw -Mintel64\n #name: x86-64 -mlfence-before-ret=or\n \n@@ -28,22 +27,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t48 83 0c 24 00       \torq    \\$0x0,\\(%rsp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\t66 48 c2 28 00       \tdata16 rex.W retq \\$0x28\n- +[a-f0-9]+:\t66 83 0c 24 00       \torw    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 83 0c 24 00       \torw    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n- +[a-f0-9]+:\t48 83 0c 24 00       \torq    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 cb                \tlretq  \n- +[a-f0-9]+:\t48 83 0c 24 00       \torq    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 ca 28 00          \tlretq  \\$0x28\n #pass"
    },
    {
      "sha": "4afad79bc64970941162b6f3c530f8d7014217d0",
      "filename": "gas/testsuite/gas/i386/x86-64-lfence-ret-b.d",
      "status": "modified",
      "additions": 0,
      "deletions": 25,
      "changes": 25,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-b.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-b.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-lfence-ret-b.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -1,6 +1,5 @@\n #source: x86-64-lfence-ret.s\n #as: -mlfence-before-ret=not\n-#warning_output: x86-64-lfence-ret.e\n #objdump: -dw -Mintel64\n #name: x86-64 -mlfence-before-ret=not\n \n@@ -34,28 +33,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t48 f7 14 24          \tnotq   \\(%rsp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\t66 48 c2 28 00       \tdata16 rex.W retq \\$0x28\n- +[a-f0-9]+:\t66 f7 14 24          \tnotw   \\(%rsp\\)\n- +[a-f0-9]+:\t66 f7 14 24          \tnotw   \\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 f7 14 24          \tnotw   \\(%rsp\\)\n- +[a-f0-9]+:\t66 f7 14 24          \tnotw   \\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%rsp\\)\n- +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%rsp\\)\n- +[a-f0-9]+:\tf7 14 24             \tnotl   \\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n- +[a-f0-9]+:\t48 f7 14 24          \tnotq   \\(%rsp\\)\n- +[a-f0-9]+:\t48 f7 14 24          \tnotq   \\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 cb                \tlretq  \n- +[a-f0-9]+:\t48 f7 14 24          \tnotq   \\(%rsp\\)\n- +[a-f0-9]+:\t48 f7 14 24          \tnotq   \\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 ca 28 00          \tlretq  \\$0x28\n #pass"
    },
    {
      "sha": "55b0ecb2f022d752a93c64e75ca0d236208ff076",
      "filename": "gas/testsuite/gas/i386/x86-64-lfence-ret-c.d",
      "status": "modified",
      "additions": 0,
      "deletions": 19,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-c.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-c.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-lfence-ret-c.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -1,6 +1,5 @@\n #source: x86-64-lfence-ret.s\n #as: -mlfence-before-ret=or -mlfence-before-indirect-branch=all\n-#warning_output: x86-64-lfence-ret.e\n #objdump: -dw -Mintel64\n \n .*: +file format .*\n@@ -27,22 +26,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t48 83 0c 24 00       \torq    \\$0x0,\\(%rsp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\t66 48 c2 28 00       \tdata16 rex.W retq \\$0x28\n- +[a-f0-9]+:\t66 83 0c 24 00       \torw    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 83 0c 24 00       \torw    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\t83 0c 24 00          \torl    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n- +[a-f0-9]+:\t48 83 0c 24 00       \torq    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 cb                \tlretq  \n- +[a-f0-9]+:\t48 83 0c 24 00       \torq    \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 ca 28 00          \tlretq  \\$0x28\n #pass"
    },
    {
      "sha": "efe928aceeda7aa7f0444db89984795e6a59b50c",
      "filename": "gas/testsuite/gas/i386/x86-64-lfence-ret-d.d",
      "status": "modified",
      "additions": 0,
      "deletions": 19,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-d.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-d.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-lfence-ret-d.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -1,6 +1,5 @@\n #source: x86-64-lfence-ret.s\n #as: -mlfence-before-ret=shl\n-#warning_output: x86-64-lfence-ret.e\n #objdump: -dw -Mintel64\n #name: x86-64 -mlfence-before-ret=shl\n \n@@ -28,22 +27,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t48 c1 24 24 00       \tshlq   \\$0x0,\\(%rsp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\t66 48 c2 28 00       \tdata16 rex.W retq \\$0x28\n- +[a-f0-9]+:\t66 c1 24 24 00       \tshlw   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 c1 24 24 00       \tshlw   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\tc1 24 24 00          \tshll   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\tc1 24 24 00          \tshll   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n- +[a-f0-9]+:\t48 c1 24 24 00       \tshlq   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 cb                \tlretq  \n- +[a-f0-9]+:\t48 c1 24 24 00       \tshlq   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 ca 28 00          \tlretq  \\$0x28\n #pass"
    },
    {
      "sha": "31286662de6f54fbc1493e7e8a79636c3f66697c",
      "filename": "gas/testsuite/gas/i386/x86-64-lfence-ret-e.d",
      "status": "modified",
      "additions": 0,
      "deletions": 19,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-e.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret-e.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-lfence-ret-e.d?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -1,6 +1,5 @@\n #source: x86-64-lfence-ret.s\n #as: -mlfence-before-ret=shl\n-#warning_output: x86-64-lfence-ret.e\n #objdump: -dw -Mintel64\n #name: x86-64 -mlfence-before-ret=yes\n \n@@ -28,22 +27,4 @@ Disassembly of section .text:\n  +[a-f0-9]+:\t48 c1 24 24 00       \tshlq   \\$0x0,\\(%rsp\\)\n  +[a-f0-9]+:\t0f ae e8             \tlfence \n  +[a-f0-9]+:\t66 48 c2 28 00       \tdata16 rex.W retq \\$0x28\n- +[a-f0-9]+:\t66 c1 24 24 00       \tshlw   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 cb                \tlretw  \n- +[a-f0-9]+:\t66 c1 24 24 00       \tshlw   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t66 ca 28 00          \tlretw  \\$0x28\n- +[a-f0-9]+:\tc1 24 24 00          \tshll   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tcb                   \tlret   \n- +[a-f0-9]+:\tc1 24 24 00          \tshll   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\tca 28 00             \tlret   \\$0x28\n- +[a-f0-9]+:\t48 c1 24 24 00       \tshlq   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 cb                \tlretq  \n- +[a-f0-9]+:\t48 c1 24 24 00       \tshlq   \\$0x0,\\(%rsp\\)\n- +[a-f0-9]+:\t0f ae e8             \tlfence \n- +[a-f0-9]+:\t48 ca 28 00          \tlretq  \\$0x28\n #pass"
    },
    {
      "sha": "13730e50e6feb309f12d95b84ff1101681d02269",
      "filename": "gas/testsuite/gas/i386/x86-64-lfence-ret.e",
      "status": "removed",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/07a78c595604b00908f06396aa221d446adbe6f8/gas/testsuite/gas/i386/x86-64-lfence-ret.e",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/07a78c595604b00908f06396aa221d446adbe6f8/gas/testsuite/gas/i386/x86-64-lfence-ret.e",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-lfence-ret.e?ref=07a78c595604b00908f06396aa221d446adbe6f8",
      "patch": "@@ -1,3 +0,0 @@\n-.*: Assembler messages:\n-.*:??: Warning: no instruction mnemonic suffix given and no register operands; using default for `lret'\n-.*:??: Warning: no instruction mnemonic suffix given and no register operands; using default for `lret'"
    },
    {
      "sha": "dd0961a49c9d8bb3629b1ccea047440bb4cf1e04",
      "filename": "gas/testsuite/gas/i386/x86-64-lfence-ret.s",
      "status": "modified",
      "additions": 0,
      "deletions": 6,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/503648e41efa19dfb059757ffddf0206b6060520/gas/testsuite/gas/i386/x86-64-lfence-ret.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-lfence-ret.s?ref=503648e41efa19dfb059757ffddf0206b6060520",
      "patch": "@@ -6,9 +6,3 @@ _start:\n \tret\t$30\n \tdata16 rex.w ret\n \tdata16 rex.w ret\t$40\n-\tlretw\n-\tlretw\t$40\n-\tlret\n-\tlret\t$40\n-\tlretq\n-\tlretq\t$40"
    }
  ]
}