{
  "sha": "e409c542cc3cedebf78c7827e976d36955d477bb",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZTQwOWM1NDJjYzNjZWRlYmY3OGM3ODI3ZTk3NmQzNjk1NWQ0NzdiYg==",
  "commit": {
    "author": {
      "name": "Alok Kumar Sharma",
      "email": "AlokKumar.Sharma@amd.com",
      "date": "2020-02-04T01:24:34Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2020-02-04T01:24:34Z"
    },
    "message": "Fixed gdb to print arrays with very high indexes\n\nIn the function f77_print_array_1, the variable 'i' which holds the\nindex is of datatype 'int', while bounds are of datatype LONGEST. Due to\nsize of int being smaller than LONGEST, the variable 'i' stores\nincorrect values for high indexes (higher than max limit of int).  Due\nto this issue in sources, two abnormal behaviors are seen while printing\narrays with high indexes (please check array-bounds-high.f90) For high\nindexes with negative sign, gdb prints empty array even if the array has\nelements.\n\n    (gdb) p arr\n    $1 = ()\n\nFor high indexes with positive sign, gdb crashes.  We have now changed\nthe datatype of 'i' to LONGEST which is same as datatype of bounds.\n\ngdb/ChangeLog:\n\n\t* f-valprint.c (f77_print_array_1): Changed datatype of index\n\tvariable to LONGEST from int to enable it to contain bound\n\tvalues correctly.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.fortran/array-bounds-high.exp: New file.\n\t* gdb.fortran/array-bounds-high.f90: New file.\n\nChange-Id: Ie2dce9380a249e634e2684b9c90f225e104369b7",
    "tree": {
      "sha": "a8231b01637b95ed9efb80cb7155e8241f4c86c1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/a8231b01637b95ed9efb80cb7155e8241f4c86c1"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e409c542cc3cedebf78c7827e976d36955d477bb",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e409c542cc3cedebf78c7827e976d36955d477bb",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e409c542cc3cedebf78c7827e976d36955d477bb",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e409c542cc3cedebf78c7827e976d36955d477bb/comments",
  "author": {
    "login": "alokkrsharma",
    "id": 60725621,
    "node_id": "MDQ6VXNlcjYwNzI1NjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/60725621?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alokkrsharma",
    "html_url": "https://github.com/alokkrsharma",
    "followers_url": "https://api.github.com/users/alokkrsharma/followers",
    "following_url": "https://api.github.com/users/alokkrsharma/following{/other_user}",
    "gists_url": "https://api.github.com/users/alokkrsharma/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alokkrsharma/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alokkrsharma/subscriptions",
    "organizations_url": "https://api.github.com/users/alokkrsharma/orgs",
    "repos_url": "https://api.github.com/users/alokkrsharma/repos",
    "events_url": "https://api.github.com/users/alokkrsharma/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alokkrsharma/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "6ec6b3c8abd0378ad6e750570c038b05b6e87703",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/6ec6b3c8abd0378ad6e750570c038b05b6e87703",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/6ec6b3c8abd0378ad6e750570c038b05b6e87703"
    }
  ],
  "stats": {
    "total": 75,
    "additions": 74,
    "deletions": 1
  },
  "files": [
    {
      "sha": "f9ef0e1508946607f0b73f56e13268068247299f",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=e409c542cc3cedebf78c7827e976d36955d477bb",
      "patch": "@@ -1,3 +1,9 @@\n+2020-02-03  Alok Kumar Sharma  <AlokKumar.Sharma@amd.com>\n+\n+\t* f-valprint.c (f77_print_array_1): Changed datatype of index\n+\tvariable to LONGEST from int to enable it to contain bound\n+\tvalues correctly.\n+\n 2020-02-03  Maciej W. Rozycki  <macro@wdc.com>\n \n \t* riscv-linux-nat.c [!NFPREG] (NFPREG): New macro."
    },
    {
      "sha": "71247a7143ddb6fe0e125ded3ed96e862aaf648f",
      "filename": "gdb/f-valprint.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/f-valprint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/f-valprint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/f-valprint.c?ref=e409c542cc3cedebf78c7827e976d36955d477bb",
      "patch": "@@ -115,7 +115,7 @@ f77_print_array_1 (int nss, int ndimensions, struct type *type,\n   struct type *range_type = TYPE_INDEX_TYPE (check_typedef (type));\n   CORE_ADDR addr = address + embedded_offset;\n   LONGEST lowerbound, upperbound;\n-  int i;\n+  LONGEST i;\n \n   get_discrete_bounds (range_type, &lowerbound, &upperbound);\n "
    },
    {
      "sha": "45eb88716cc10e0130b8c595f4f4d3ab3fd50ddd",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=e409c542cc3cedebf78c7827e976d36955d477bb",
      "patch": "@@ -1,3 +1,8 @@\n+2020-02-03  Alok Kumar Sharma  <AlokKumar.Sharma@amd.com>\n+\n+\t* gdb.fortran/array-bounds-high.exp: New file.\n+\t* gdb.fortran/array-bounds-high.f90: New file.\n+\n 2020-02-03  Lukas Durfina  <ldurfina@tachyum.com>  (tiny change)\n \n \t* gdb.base/fileio.c: Remove #include of <sys/errno.h>."
    },
    {
      "sha": "81e2f87b89f57d1ea381cf815ca550cec6d2de69",
      "filename": "gdb/testsuite/gdb.fortran/array-bounds-high.exp",
      "status": "added",
      "additions": 39,
      "deletions": 0,
      "changes": 39,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/testsuite/gdb.fortran/array-bounds-high.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/testsuite/gdb.fortran/array-bounds-high.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/array-bounds-high.exp?ref=e409c542cc3cedebf78c7827e976d36955d477bb",
      "patch": "@@ -0,0 +1,39 @@\n+# Copyright 2020 Free Software Foundation, Inc.\n+\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+# This file is part of the gdb testsuite.  It contains test to ensure that\n+# array bounds accept LONGEST.\n+\n+if { [skip_fortran_tests] } { return -1 }\n+\n+set testfile \"array-bounds-high\"\n+standard_testfile .f90\n+\n+if {[prepare_for_testing $testfile.exp $testfile $srcfile {f90 debug}]} {\n+    return -1\n+}\n+\n+if {![runto MAIN__]} {\n+    perror \"Could not run to breakpoint `MAIN__'.\"\n+    continue\n+}\n+\n+gdb_test \"until 21\" {21.*print.*}\n+\n+# Lets check whether too high (with - sign) indexed array are printed correctly\n+gdb_test \"print arr1\" {.*\\(11, 11\\).*}\n+\n+# Lets check whether too high (with + sign) indexed array are printed correctly\n+gdb_test \"print arr2\" {.*\\(22, 22\\).*}"
    },
    {
      "sha": "b72cd1bb2bccb4fd80c2d38bd85c799e75cdafa2",
      "filename": "gdb/testsuite/gdb.fortran/array-bounds-high.f90",
      "status": "added",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/testsuite/gdb.fortran/array-bounds-high.f90",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e409c542cc3cedebf78c7827e976d36955d477bb/gdb/testsuite/gdb.fortran/array-bounds-high.f90",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/array-bounds-high.f90?ref=e409c542cc3cedebf78c7827e976d36955d477bb",
      "patch": "@@ -0,0 +1,23 @@\n+! Copyright 2020 Free Software Foundation, Inc.\n+\n+! This program is free software; you can redistribute it and/or modify\n+! it under the terms of the GNU General Public License as published by\n+! the Free Software Foundation; either version 3 of the License, or\n+! (at your option) any later version.\n+!\n+! This program is distributed in the hope that it will be useful,\n+! but WITHOUT ANY WARRANTY; without even the implied warranty of\n+! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+! GNU General Public License for more details.\n+!\n+! You should have received a copy of the GNU General Public License\n+! along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+program main\n+      integer(4) :: arr1(-4294967297_8:-4294967296_8)\n+      integer(4) :: arr2(4294967296_8:4294967297_8)\n+      arr1 = 11\n+      arr2 = 22\n+      print *, 'arr1 = ', arr1\n+      print *, 'arr2 = ', arr2\n+end"
    }
  ]
}