{
  "sha": "cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6Y2Q4NTBiNDBjYzg0ZmYwOGM1MGI4YjE2YTA5NjhiM2NkNmIzMzY2NA==",
  "commit": {
    "author": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-11-13T03:55:15Z"
    },
    "committer": {
      "name": "Christian Biesinger",
      "email": "cbiesinger@google.com",
      "date": "2019-11-15T21:31:36Z"
    },
    "message": "Use gnulib's strerror_r on MinGW\n\nThere is no need to keep mingw-strerror around; we can just always use\nthe code from posix-strerror. The main reason we had that code, it\nseems, is to handle winsock error codes, but gnulib's version\nhandles those.\n\nUnfortunately the code can't be moved into common-utils.c because\nlibinproctrace.so uses common-utils but not gnulib.\n\ngdb/ChangeLog:\n\n2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n\n\t* Makefile.in: Replace {posix,mingw}-strerror.c with safe-strerror.c.\n\t* configure: Regenerate.\n\t* configure.ac: Don't source common.host.\n\t* gdbsupport/common.host: Remove.\n\t* gdbsupport/mingw-strerror.c: Remove.\n\t* gdbsupport/posix-strerror.c: Rename to...\n\t* gdbsupport/safe-strerror.c: ...this.\n\ngdb/gdbserver/ChangeLog:\n\n2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n\n\t* Makefile.in: Add safe-strerror.c.\n\t* configure: Regenerate.\n\t* configure.ac: Don't source common.host.\n\nChange-Id: I9e6d8a752fc398784201f370cafee65e0ea05474",
    "tree": {
      "sha": "d24cfd79997e75f5d8ba7c0d83faed583a47b523",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d24cfd79997e75f5d8ba7c0d83faed583a47b523"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/comments",
  "author": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "cbiesinger",
    "id": 1483109,
    "node_id": "MDQ6VXNlcjE0ODMxMDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1483109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbiesinger",
    "html_url": "https://github.com/cbiesinger",
    "followers_url": "https://api.github.com/users/cbiesinger/followers",
    "following_url": "https://api.github.com/users/cbiesinger/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbiesinger/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbiesinger/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbiesinger/subscriptions",
    "organizations_url": "https://api.github.com/users/cbiesinger/orgs",
    "repos_url": "https://api.github.com/users/cbiesinger/repos",
    "events_url": "https://api.github.com/users/cbiesinger/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbiesinger/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e176f82170871202640d53d8edc0caa5c450901f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e176f82170871202640d53d8edc0caa5c450901f",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e176f82170871202640d53d8edc0caa5c450901f"
    }
  ],
  "stats": {
    "total": 145,
    "additions": 23,
    "deletions": 122
  },
  "files": [
    {
      "sha": "90a2b64d3df2470e71e95033c4b9f0818f0f3c32",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -1,3 +1,13 @@\n+2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n+\n+\t* Makefile.in: Replace {posix,mingw}-strerror.c with safe-strerror.c.\n+\t* configure: Regenerate.\n+\t* configure.ac: Don't source common.host.\n+\t* gdbsupport/common.host: Remove.\n+\t* gdbsupport/mingw-strerror.c: Remove.\n+\t* gdbsupport/posix-strerror.c: Rename to...\n+\t* gdbsupport/safe-strerror.c: ...this.\n+\n 2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n \n \t* maint.c (scoped_command_stats::print_time): Use localtime_r"
    },
    {
      "sha": "5a4ffd5a818a1998e0c0c87fb0de3f2f2da097e2",
      "filename": "gdb/Makefile.in",
      "status": "modified",
      "additions": 2,
      "deletions": 3,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/Makefile.in?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -986,6 +986,7 @@ COMMON_SFILES = \\\n \tgdbsupport/ptid.c \\\n \tgdbsupport/rsp-low.c \\\n \tgdbsupport/run-time-clock.c \\\n+\tgdbsupport/safe-strerror.c \\\n \tgdbsupport/scoped_mmap.c \\\n \tgdbsupport/signals.c \\\n \tgdbsupport/signals-state-save-restore.c \\\n@@ -2344,9 +2345,7 @@ ALLDEPFILES = \\\n \txtensa-linux-nat.c \\\n \txtensa-linux-tdep.c \\\n \txtensa-tdep.c \\\n-\txtensa-xtregs.c \\\n-\tgdbsupport/mingw-strerror.c \\\n-\tgdbsupport/posix-strerror.c\n+\txtensa-xtregs.c\n \n # Some files need explicit build rules (due to -Werror problems) or due\n # to sub-directory fun 'n' games."
    },
    {
      "sha": "4afd7f9b96803bbd38c2d759d62ca71864dc3b37",
      "filename": "gdb/configure",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -6556,10 +6556,6 @@ fi\n \n . $srcdir/configure.host\n \n-# Add in the common host objects.\n-. $srcdir/gdbsupport/common.host\n-gdb_host_obs=\"$gdb_host_obs $common_host_obs\"\n-\n # Accumulate some settings from configure.tgt over all enabled targets\n \n TARGET_OBS="
    },
    {
      "sha": "6ba7c5cfa4f1d287255235e2929206df52efe7ef",
      "filename": "gdb/configure.ac",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure.ac?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -177,10 +177,6 @@ fi\n \n . $srcdir/configure.host\n \n-# Add in the common host objects.\n-. $srcdir/gdbsupport/common.host\n-gdb_host_obs=\"$gdb_host_obs $common_host_obs\"\n-\n # Accumulate some settings from configure.tgt over all enabled targets\n \n TARGET_OBS="
    },
    {
      "sha": "fde6abbecb3bbf15fc3eccce29df9e949856636d",
      "filename": "gdb/gdbserver/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbserver/ChangeLog?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -1,3 +1,9 @@\n+2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n+\n+\t* Makefile.in: Add safe-strerror.c.\n+\t* configure: Regenerate.\n+\t* configure.ac: Don't source common.host.\n+\n 2019-11-15  Christian Biesinger  <cbiesinger@google.com>\n \n \t* config.in: Regenerate."
    },
    {
      "sha": "16012dddcbc6ab2190ab2b228dd40ab989ce8948",
      "filename": "gdb/gdbserver/Makefile.in",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbserver/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbserver/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbserver/Makefile.in?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -220,6 +220,7 @@ SFILES = \\\n \t$(srcdir)/gdbsupport/print-utils.c \\\n \t$(srcdir)/gdbsupport/ptid.c \\\n \t$(srcdir)/gdbsupport/rsp-low.c \\\n+\t$(srcdir)/gdbsupport/safe-strerror.c \\\n \t$(srcdir)/gdbsupport/tdesc.c \\\n \t$(srcdir)/gdbsupport/xml-utils.c \\\n \t$(srcdir)/nat/aarch64-sve-linux-ptrace.c \\\n@@ -266,6 +267,7 @@ OBS = \\\n \tgdbsupport/print-utils.o \\\n \tgdbsupport/ptid.o \\\n \tgdbsupport/rsp-low.o \\\n+\tgdbsupport/safe-strerror.o \\\n \tgdbsupport/signals.o \\\n \tgdbsupport/signals-state-save-restore.o \\\n \tgdbsupport/tdesc.o \\"
    },
    {
      "sha": "d1d00a4cfed935c04b1ccb4341c52eb280fea1b3",
      "filename": "gdb/gdbserver/configure",
      "status": "modified",
      "additions": 1,
      "deletions": 5,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbserver/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbserver/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbserver/configure?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -7825,10 +7825,6 @@ esac\n \n . ${srcdir}/configure.srv\n \n-# Add in the common host objects.\n-. ${srcdir}/../gdbsupport/common.host\n-srv_host_obs=\"$common_host_obs\"\n-\n if test \"${srv_mingwce}\" = \"yes\"; then\n   LIBS=\"$LIBS -lws2\"\n elif test \"${srv_mingw}\" = \"yes\"; then\n@@ -8361,7 +8357,7 @@ $as_echo \"#define USE_XML 1\" >>confdefs.h\n   done\n fi\n \n-GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles $srv_host_obs $srv_selftest_objs\"\n+GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles $srv_selftest_objs\"\n GDBSERVER_LIBS=\"$srv_libs\"\n \n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether the target supports __sync_*_compare_and_swap\" >&5"
    },
    {
      "sha": "07c9bd7fa7535748e46ec1db3800b754c447d681",
      "filename": "gdb/gdbserver/configure.ac",
      "status": "modified",
      "additions": 1,
      "deletions": 5,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbserver/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbserver/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbserver/configure.ac?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -245,10 +245,6 @@ esac\n \n . ${srcdir}/configure.srv\n \n-# Add in the common host objects.\n-. ${srcdir}/../gdbsupport/common.host\n-srv_host_obs=\"$common_host_obs\"\n-\n if test \"${srv_mingwce}\" = \"yes\"; then\n   LIBS=\"$LIBS -lws2\"\n elif test \"${srv_mingw}\" = \"yes\"; then\n@@ -393,7 +389,7 @@ if test \"$srv_xmlfiles\" != \"\"; then\n   done\n fi\n \n-GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles $srv_host_obs $srv_selftest_objs\"\n+GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles $srv_selftest_objs\"\n GDBSERVER_LIBS=\"$srv_libs\"\n \n dnl Check whether the target supports __sync_*_compare_and_swap."
    },
    {
      "sha": "4839059e61048abe76cdf65a731d4b5b1a359b1b",
      "filename": "gdb/gdbsupport/common.host",
      "status": "removed",
      "additions": 0,
      "deletions": 36,
      "changes": 36,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e176f82170871202640d53d8edc0caa5c450901f/gdb/gdbsupport/common.host",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e176f82170871202640d53d8edc0caa5c450901f/gdb/gdbsupport/common.host",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbsupport/common.host?ref=e176f82170871202640d53d8edc0caa5c450901f",
      "patch": "@@ -1,36 +0,0 @@\n-# Common object files to include for each host.\n-#\n-# Copyright (C) 2015-2019 Free Software Foundation, Inc.\n-#\n-# This file is part of GDB.\n-#\n-# This program is free software; you can redistribute it and/or modify\n-# it under the terms of the GNU General Public License as published by\n-# the Free Software Foundation; either version 3 of the License, or\n-# (at your option) any later version.\n-#\n-# This program is distributed in the hope that it will be useful,\n-# but WITHOUT ANY WARRANTY; without even the implied warranty of\n-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-# GNU General Public License for more details.\n-#\n-# You should have received a copy of the GNU General Public License\n-# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n-\n-# Map host triplet into the common object files to be included by\n-# GDB/gdbserver.  This is invoked from the autoconf generated\n-# configure script.\n-\n-# This file sets the following shell variables:\n-#  common_host_obs\t\thost-specific .o files to include when building\n-#  \t\t\t\tGDB/gdbserver\n-\n-case \"${host}\" in\n-\n-*-mingw*)\tcommon_host_obs=gdbsupport/mingw-strerror.o\n-\t\t;;\n-*)\n-\t\tcommon_host_obs=gdbsupport/posix-strerror.o\n-\t\t;;\n-\n-esac"
    },
    {
      "sha": "893b7ca1779e4d8d2f94ed5d94d28cc486b6185e",
      "filename": "gdb/gdbsupport/mingw-strerror.c",
      "status": "removed",
      "additions": 0,
      "deletions": 64,
      "changes": 64,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e176f82170871202640d53d8edc0caa5c450901f/gdb/gdbsupport/mingw-strerror.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e176f82170871202640d53d8edc0caa5c450901f/gdb/gdbsupport/mingw-strerror.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbsupport/mingw-strerror.c?ref=e176f82170871202640d53d8edc0caa5c450901f",
      "patch": "@@ -1,64 +0,0 @@\n-/* Safe version of strerror for MinGW, for GDB, the GNU debugger.\n-\n-   Copyright (C) 2006-2019 Free Software Foundation, Inc.\n-\n-   This file is part of GDB.\n-\n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 3 of the License, or\n-   (at your option) any later version.\n-\n-   This program is distributed in the hope that it will be useful,\n-   but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n-\n-   You should have received a copy of the GNU General Public License\n-   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n-\n-#include \"common-defs.h\"\n-\n-#include <windows.h>\n-\n-/* Implementation of safe_strerror as defined in common-utils.h.\n-\n-   The Windows runtime implementation of strerror never returns NULL,\n-   but does return a useless string for anything above sys_nerr;\n-   unfortunately this includes all socket-related error codes.\n-   This replacement tries to find a system-provided error message.  */\n-\n-const char *\n-safe_strerror (int errnum)\n-{\n-  static char *buffer;\n-  int len;\n-\n-  if (errnum >= 0 && errnum < sys_nerr)\n-    return strerror (errnum);\n-\n-  if (buffer)\n-    {\n-      LocalFree (buffer);\n-      buffer = NULL;\n-    }\n-\n-  if (FormatMessage (FORMAT_MESSAGE_ALLOCATE_BUFFER\n-\t\t     | FORMAT_MESSAGE_FROM_SYSTEM,\n-\t\t     NULL, errnum,\n-\t\t     MAKELANGID (LANG_NEUTRAL, SUBLANG_DEFAULT),\n-\t\t     (LPTSTR) &buffer, 0, NULL) == 0)\n-    {\n-      static char buf[32];\n-      xsnprintf (buf, sizeof buf, \"(undocumented errno %d)\", errnum);\n-      return buf;\n-    }\n-\n-  /* Windows error messages end with a period and a CR-LF; strip that\n-     out.  */\n-  len = strlen (buffer);\n-  if (len > 3 && strcmp (buffer + len - 3, \".\\r\\n\") == 0)\n-    buffer[len - 3] = '\\0';\n-\n-  return buffer;\n-}"
    },
    {
      "sha": "c37db579f785c2c0ec2a9689f0e9b3225674c442",
      "filename": "gdb/gdbsupport/safe-strerror.c",
      "status": "renamed",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbsupport/safe-strerror.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cd850b40cc84ff08c50b8b16a0968b3cd6b33664/gdb/gdbsupport/safe-strerror.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/gdbsupport/safe-strerror.c?ref=cd850b40cc84ff08c50b8b16a0968b3cd6b33664",
      "patch": "@@ -1,4 +1,4 @@\n-/* Safe version of strerror for POSIX systems for GDB, the GNU debugger.\n+/* Safe version of strerror for GDB, the GNU debugger.\n \n    Copyright (C) 2006-2019 Free Software Foundation, Inc.\n ",
      "previous_filename": "gdb/gdbsupport/posix-strerror.c"
    }
  ]
}