{
  "sha": "7d155da3d945350fb40e12c64511e0d719df3137",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6N2QxNTVkYTNkOTQ1MzUwZmI0MGUxMmM2NDUxMWUwZDcxOWRmMzEzNw==",
  "commit": {
    "author": {
      "name": "Jon Turney",
      "email": "jon.turney@dronecode.org.uk",
      "date": "2020-06-29T15:20:13Z"
    },
    "committer": {
      "name": "Jon Turney",
      "email": "jon.turney@dronecode.org.uk",
      "date": "2020-09-18T16:12:08Z"
    },
    "message": "Add sniffer for Cygwin x86_64 core dumps\n\nSimilarly to existing i386_cygwin_core_osabi_sniffer()\n\ngdb/ChangeLog:\n\n2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n\n\t* amd64-windows-tdep.c (amd64_cygwin_core_osabi_sniffer): New.\n\t(_initialize_amd64_windows_tdep): Register amd64_cygwin_core_osabi_sniffer.",
    "tree": {
      "sha": "0a3a48d364c32d4d3bbd0de6875c648fdd0f65d7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/0a3a48d364c32d4d3bbd0de6875c648fdd0f65d7"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/7d155da3d945350fb40e12c64511e0d719df3137",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIcBAABAgAGBQJfZNxYAAoJEMfIbwNwKFyBi28P/ikagypL3d+5/51eb2d56MVB\n4CDNV+8eqsK117m9gq6I9cRtrqwEDAwHogJspjVDUMFIQV20fZb2u5BlWw8SCXKC\nPRQ7bPuo/E+ymF6HAsYm3QfUoS9T0QwcONFh0f4y/e9+kslC411b1FfQjW0uGCDq\ndiAC6sOhWNfVe14/0swqdFsHlMa9dNUkHrmZAvcskUUaqJ8H8muGXyjliOgSrBRn\nHXnLup6umDb0MKiRYPuDB1wym8EBko2l1Doh91INCzDBzoa73qdAwDCsEWjgQXUC\nzhAH0qL1fggEsP8nW8B5Fpt+mg1MFfBR7CsmYvMj90H2Rtdl3n3cLqhIbTw9STnL\nqLzCFh3Vn3HltdfYWKTAJVFbtZLpf7SxoC0me20GGS1a5Hmrwm9FJz0cZWmo8SGw\nA5M19gjFroLgrYY5KZVuunriQ4vw6Av3LZmbZjXQwqpsaFwdcfRhS1NBHEyPxujO\n36PFVjxgFarPY2Wm+iJty0JiGYvbFMU4hFmCNn+Ymho7t65rp9P2BuXeVyOnNblH\nWQdGLk19jNi5D+wW2s90ce3he3aITnfwRBPEkAtDa9MxZ91uoo9VMZF9/NUxMTEN\n44DevJqnL/ImBv+KtsNBW6RgxXJnbNK6w3Hk/NGio4IkCvI4IKYxU0jMmYMjbQua\nL8U4N1o+djNwwsXqLkF9\n=AIZ3\n-----END PGP SIGNATURE-----",
      "payload": "tree 0a3a48d364c32d4d3bbd0de6875c648fdd0f65d7\nparent e8ef12b99666ef6f84f4c7601dc76ae351e453f2\nauthor Jon Turney <jon.turney@dronecode.org.uk> 1593444013 +0100\ncommitter Jon Turney <jon.turney@dronecode.org.uk> 1600445528 +0100\n\nAdd sniffer for Cygwin x86_64 core dumps\n\nSimilarly to existing i386_cygwin_core_osabi_sniffer()\n\ngdb/ChangeLog:\n\n2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n\n\t* amd64-windows-tdep.c (amd64_cygwin_core_osabi_sniffer): New.\n\t(_initialize_amd64_windows_tdep): Register amd64_cygwin_core_osabi_sniffer.\n"
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7d155da3d945350fb40e12c64511e0d719df3137",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/7d155da3d945350fb40e12c64511e0d719df3137",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7d155da3d945350fb40e12c64511e0d719df3137/comments",
  "author": {
    "login": "jon-turney",
    "id": 3497232,
    "node_id": "MDQ6VXNlcjM0OTcyMzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3497232?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jon-turney",
    "html_url": "https://github.com/jon-turney",
    "followers_url": "https://api.github.com/users/jon-turney/followers",
    "following_url": "https://api.github.com/users/jon-turney/following{/other_user}",
    "gists_url": "https://api.github.com/users/jon-turney/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jon-turney/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jon-turney/subscriptions",
    "organizations_url": "https://api.github.com/users/jon-turney/orgs",
    "repos_url": "https://api.github.com/users/jon-turney/repos",
    "events_url": "https://api.github.com/users/jon-turney/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jon-turney/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jon-turney",
    "id": 3497232,
    "node_id": "MDQ6VXNlcjM0OTcyMzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3497232?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jon-turney",
    "html_url": "https://github.com/jon-turney",
    "followers_url": "https://api.github.com/users/jon-turney/followers",
    "following_url": "https://api.github.com/users/jon-turney/following{/other_user}",
    "gists_url": "https://api.github.com/users/jon-turney/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jon-turney/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jon-turney/subscriptions",
    "organizations_url": "https://api.github.com/users/jon-turney/orgs",
    "repos_url": "https://api.github.com/users/jon-turney/repos",
    "events_url": "https://api.github.com/users/jon-turney/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jon-turney/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e8ef12b99666ef6f84f4c7601dc76ae351e453f2",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e8ef12b99666ef6f84f4c7601dc76ae351e453f2",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e8ef12b99666ef6f84f4c7601dc76ae351e453f2"
    }
  ],
  "stats": {
    "total": 30,
    "additions": 30,
    "deletions": 0
  },
  "files": [
    {
      "sha": "b2f65bd654d574cfd5cf7a1d3f642c778500e4b5",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7d155da3d945350fb40e12c64511e0d719df3137/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7d155da3d945350fb40e12c64511e0d719df3137/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=7d155da3d945350fb40e12c64511e0d719df3137",
      "patch": "@@ -1,3 +1,8 @@\n+2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n+\n+\t* amd64-windows-tdep.c (amd64_cygwin_core_osabi_sniffer): New.\n+\t(_initialize_amd64_windows_tdep): Register amd64_cygwin_core_osabi_sniffer.\n+\n 2020-09-18  Pedro Alves  <pedro@palves.net>\n \n \tPR gdb/26631"
    },
    {
      "sha": "e55d021b6c0f17547e502e7f7d7532fe4b7c8f29",
      "filename": "gdb/amd64-windows-tdep.c",
      "status": "modified",
      "additions": 25,
      "deletions": 0,
      "changes": 25,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/7d155da3d945350fb40e12c64511e0d719df3137/gdb/amd64-windows-tdep.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/7d155da3d945350fb40e12c64511e0d719df3137/gdb/amd64-windows-tdep.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/amd64-windows-tdep.c?ref=7d155da3d945350fb40e12c64511e0d719df3137",
      "patch": "@@ -42,6 +42,8 @@ static int amd64_windows_dummy_call_integer_regs[] =\n   AMD64_R9_REGNUM            /* %r9 */\n };\n \n+#define AMD64_WINDOWS_SIZEOF_GREGSET 1232\n+\n /* Return nonzero if an argument of type TYPE should be passed\n    via one of the integer registers.  */\n \n@@ -1276,6 +1278,24 @@ amd64_windows_osabi_sniffer (bfd *abfd)\n   return GDB_OSABI_WINDOWS;\n }\n \n+static enum gdb_osabi\n+amd64_cygwin_core_osabi_sniffer (bfd *abfd)\n+{\n+  const char *target_name = bfd_get_target (abfd);\n+\n+  /* Cygwin uses elf core dumps.  Do not claim all ELF executables,\n+     check whether there is a .reg section of proper size.  */\n+  if (strcmp (target_name, \"elf64-x86-64\") == 0)\n+    {\n+      asection *section = bfd_get_section_by_name (abfd, \".reg\");\n+      if (section != nullptr\n+\t  && bfd_section_size (section) == AMD64_WINDOWS_SIZEOF_GREGSET)\n+\treturn GDB_OSABI_CYGWIN;\n+    }\n+\n+  return GDB_OSABI_UNKNOWN;\n+}\n+\n void _initialize_amd64_windows_tdep ();\n void\n _initialize_amd64_windows_tdep ()\n@@ -1287,4 +1307,9 @@ _initialize_amd64_windows_tdep ()\n \n   gdbarch_register_osabi_sniffer (bfd_arch_i386, bfd_target_coff_flavour,\n \t\t\t\t  amd64_windows_osabi_sniffer);\n+\n+  /* Cygwin uses elf core dumps.  */\n+  gdbarch_register_osabi_sniffer (bfd_arch_i386, bfd_target_elf_flavour,\n+\t\t\t\t  amd64_cygwin_core_osabi_sniffer);\n+\n }"
    }
  ]
}