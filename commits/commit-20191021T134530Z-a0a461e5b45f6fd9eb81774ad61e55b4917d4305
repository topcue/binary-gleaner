{
  "sha": "a0a461e5b45f6fd9eb81774ad61e55b4917d4305",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YTBhNDYxZTViNDVmNmZkOWViODE3NzRhZDYxZTU1YjQ5MTdkNDMwNQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-10-19T21:42:34Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-10-21T13:45:30Z"
    },
    "message": "Fix creation of nm.h when configure is changed\n\nMy earlier patch -- commit c5adaa192 (\"Fix creation of stamp-h by\ngdb's configure script\") -- broke the creation of nm.h.  In\nparticular, configure removes nm.h, so if you touch configure and\nrebuild, nothing will re-create the link, breaking the build.\n\nThis patch fixes the bug, and also updates configure.ac to use\nAC_CONFIG_LINKS, rather than the obsolete AC_LINK_FILES.\n\nFinally, I noticed that gcore is in generated_files in the\nMakefile.in.  I think this is incorrect, as generated_files is only\nneeded for files that can be the target of a #include.  So, this patch\nremoves it.\n\ngdb/ChangeLog\n2019-10-21  Tom Tromey  <tom@tromey.com>\n\n\t* configure.ac (nm.h): Conditionally create nm.h link.  Subst\n\tNM_H.   Use AC_CONFIG_LINKS.\n\t* configure: Rebuild.\n\t* Makefile.in (NM_H): New variable.\n\t(generated_files): Add NM_H.  Remove gcore.\n\t(nm.h, stamp-nmh): New targets.\n\nChange-Id: I8dd539785d52455e85389425e4bb996c8a127a0e",
    "tree": {
      "sha": "6d563aa9b1cfc93576519b685f05a5f751ecfa45",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6d563aa9b1cfc93576519b685f05a5f751ecfa45"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/a0a461e5b45f6fd9eb81774ad61e55b4917d4305",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a0a461e5b45f6fd9eb81774ad61e55b4917d4305",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/a0a461e5b45f6fd9eb81774ad61e55b4917d4305",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "94cb3754118669d46c8ad87c986d8d9c59fac65a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/94cb3754118669d46c8ad87c986d8d9c59fac65a",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/94cb3754118669d46c8ad87c986d8d9c59fac65a"
    }
  ],
  "stats": {
    "total": 61,
    "additions": 30,
    "deletions": 31
  },
  "files": [
    {
      "sha": "6f1a1c0c3f0f637d720f57c5172f9816c9277398",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=a0a461e5b45f6fd9eb81774ad61e55b4917d4305",
      "patch": "@@ -1,3 +1,12 @@\n+2019-10-21  Tom Tromey  <tom@tromey.com>\n+\n+\t* configure.ac (nm.h): Conditionally create nm.h link.  Subst\n+\tNM_H.   Use AC_CONFIG_LINKS.\n+\t* configure: Rebuild.\n+\t* Makefile.in (NM_H): New variable.\n+\t(generated_files): Add NM_H.  Remove gcore.\n+\t(nm.h, stamp-nmh): New targets.\n+\n 2019-10-20  Tom Tromey  <tom@tromey.com>\n \n \t* objfiles.h (unlink_objfile, put_objfile_before): Don't declare."
    },
    {
      "sha": "b6caa2c220b14f94f9417ae4cb7abc9a8c831b8a",
      "filename": "gdb/Makefile.in",
      "status": "modified",
      "additions": 7,
      "deletions": 2,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/gdb/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/gdb/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/Makefile.in?ref=a0a461e5b45f6fd9eb81774ad61e55b4917d4305",
      "patch": "@@ -812,6 +812,7 @@ LOADLIBES = @LOADLIBES@\n MH_CFLAGS = @MH_CFLAGS@\n XM_CLIBS = @XM_CLIBS@\n NAT_GENERATED_FILES = @NAT_GENERATED_FILES@\n+NM_H = @NM_H@\n HAVE_NATIVE_GCORE_HOST = @HAVE_NATIVE_GCORE_HOST@\n \n # Native-target dependent makefile fragment comes in here.\n@@ -1617,9 +1618,9 @@ DISTSTUFF = $(YYFILES)\n generated_files = \\\n \tada-lex.c \\\n \tconfig.h \\\n-\tgcore \\\n \tjit-reader.h \\\n-\t$(NAT_GENERATED_FILES)\n+\t$(NAT_GENERATED_FILES) \\\n+\t$(NM_H)\n \n # Flags needed to compile Python code\n PYTHON_CFLAGS = @PYTHON_CFLAGS@\n@@ -2021,6 +2022,10 @@ config.h: stamp-h ; @true\n stamp-h: $(srcdir)/config.in config.status\n \t$(SHELL) config.status config.h\n \n+nm.h: stamp-nmh ; @true\n+stamp-nmh: config.status\n+\t$(SHELL) config.status nm.h\n+\n config.status: $(srcdir)/configure configure.nat configure.tgt configure.host ../bfd/development.sh\n \t$(SHELL) config.status --recheck\n "
    },
    {
      "sha": "737b426058cbb4d19e6198aad67c9646d7c2c4c2",
      "filename": "gdb/configure",
      "status": "modified",
      "additions": 9,
      "deletions": 19,
      "changes": 28,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/gdb/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/gdb/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure?ref=a0a461e5b45f6fd9eb81774ad61e55b4917d4305",
      "patch": "@@ -626,6 +626,7 @@ LIBOBJS\n GCORE_TRANSFORM_NAME\n GDB_TRANSFORM_NAME\n XSLTPROC\n+NM_H\n GDB_NM_FILE\n LTLIBBABELTRACE\n LIBBABELTRACE\n@@ -17556,28 +17557,25 @@ $as_echo \"$as_me: WARNING: babeltrace is missing or unusable; GDB is unable to r\n   fi\n fi\n \n-# If nativefile (NAT_FILE) is not set in configure.nat, we link to an\n-# empty version.\n-\n-files=\n-links=\n-\n+NM_H=\n rm -f nm.h\n if test \"${nativefile}\" != \"\"; then\n     case \"${nativefile}\" in\n       nm-*.h ) GDB_NM_FILE=\"config/${gdb_host_cpu}/${nativefile}\" ;;\n       * ) GDB_NM_FILE=\"${nativefile}\"\n     esac\n-    files=\"${files} ${GDB_NM_FILE}\"\n-    links=\"${links} nm.h\"\n+    ac_config_links=\"$ac_config_links nm.h:$GDB_NM_FILE\"\n+\n \n cat >>confdefs.h <<_ACEOF\n #define GDB_NM_FILE \"${GDB_NM_FILE}\"\n _ACEOF\n \n+    NM_H=nm.h\n fi\n \n \n+\n for ac_prog in xsltproc\n do\n   # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n@@ -17631,16 +17629,6 @@ if test \"x$USE_MAINTAINER_MODE\" = xyes; then\n fi\n \n \n-ac_sources=\"$files\"\n-ac_dests=\"$links\"\n-while test -n \"$ac_sources\"; do\n-  set $ac_dests; ac_dest=$1; shift; ac_dests=$*\n-  set $ac_sources; ac_source=$1; shift; ac_sources=$*\n-  ac_config_links_1=\"$ac_config_links_1 $ac_dest:$ac_source\"\n-done\n-ac_config_links=\"$ac_config_links $ac_config_links_1\"\n-\n-\n \n \n \n@@ -18406,6 +18394,7 @@ cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1\n # INIT-COMMANDS\n #\n ac_aux_dir=$ac_aux_dir DEPDIR=$DEPDIR\n+GDB_NM_FILE=$GDB_NM_FILE\n \n _ACEOF\n \n@@ -18418,7 +18407,7 @@ do\n     \"config.h\") CONFIG_HEADERS=\"$CONFIG_HEADERS config.h:config.in\" ;;\n     \"depdir\") CONFIG_COMMANDS=\"$CONFIG_COMMANDS depdir\" ;;\n     \"jit-reader.h\") CONFIG_FILES=\"$CONFIG_FILES jit-reader.h:jit-reader.in\" ;;\n-    \"$ac_config_links_1\") CONFIG_LINKS=\"$CONFIG_LINKS $ac_config_links_1\" ;;\n+    \"nm.h\") CONFIG_LINKS=\"$CONFIG_LINKS nm.h:$GDB_NM_FILE\" ;;\n     \"gcore\") CONFIG_FILES=\"$CONFIG_FILES gcore\" ;;\n     \"Makefile\") CONFIG_FILES=\"$CONFIG_FILES Makefile\" ;;\n     \"gdb-gdb.gdb\") CONFIG_FILES=\"$CONFIG_FILES gdb-gdb.gdb\" ;;\n@@ -19053,6 +19042,7 @@ $as_echo \"$as_me: executing $ac_file commands\" >&6;}\n   case $ac_file$ac_mode in\n     \"config.h\":H) echo > stamp-h ;;\n     \"depdir\":C) $SHELL $ac_aux_dir/mkinstalldirs $DEPDIR ;;\n+    \"nm.h\":L) echo > stamp-nmh ;;\n     \"gcore\":F) chmod +x gcore ;;\n \n   esac"
    },
    {
      "sha": "dbe01509b9104b9f0baa7ef9c390e4bad5916720",
      "filename": "gdb/configure.ac",
      "status": "modified",
      "additions": 5,
      "deletions": 10,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/gdb/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a0a461e5b45f6fd9eb81774ad61e55b4917d4305/gdb/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure.ac?ref=a0a461e5b45f6fd9eb81774ad61e55b4917d4305",
      "patch": "@@ -2217,23 +2217,20 @@ else\n   fi\n fi\n \n-# If nativefile (NAT_FILE) is not set in configure.nat, we link to an\n-# empty version.\n-\n-files=\n-links=\n-\n+NM_H=\n rm -f nm.h\n if test \"${nativefile}\" != \"\"; then\n     case \"${nativefile}\" in\n       nm-*.h ) GDB_NM_FILE=\"config/${gdb_host_cpu}/${nativefile}\" ;;\n       * ) GDB_NM_FILE=\"${nativefile}\"\n     esac\n-    files=\"${files} ${GDB_NM_FILE}\"\n-    links=\"${links} nm.h\"\n+    AC_CONFIG_LINKS([nm.h:$GDB_NM_FILE], [echo > stamp-nmh],\n+                    [GDB_NM_FILE=$GDB_NM_FILE])\n     AC_DEFINE_UNQUOTED(GDB_NM_FILE, \"${GDB_NM_FILE}\", [nativefile])\n+    NM_H=nm.h\n fi\n AC_SUBST(GDB_NM_FILE)\n+AC_SUBST(NM_H)\n \n dnl Add dependency for xsltproc if building with maintainer-mode enabled.\n AC_PATH_PROGS(XSLTPROC, xsltproc, missing)\n@@ -2244,8 +2241,6 @@ if test \"x$USE_MAINTAINER_MODE\" = xyes; then\n fi\n AC_SUBST(XSLTPROC)\n \n-AC_LINK_FILES($files, $links)\n-\n dnl Check for exe extension set on certain hosts (e.g. Win32)\n AC_EXEEXT\n "
    }
  ]
}