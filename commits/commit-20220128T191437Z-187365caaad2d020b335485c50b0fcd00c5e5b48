{
  "sha": "187365caaad2d020b335485c50b0fcd00c5e5b48",
  "node_id": "C_kwDOANOeidoAKDE4NzM2NWNhYWFkMmQwMjBiMzM1NDg1YzUwYjBmY2QwMGM1ZTViNDg",
  "commit": {
    "author": {
      "name": "John Baldwin",
      "email": "jhb@FreeBSD.org",
      "date": "2022-01-28T19:14:37Z"
    },
    "committer": {
      "name": "John Baldwin",
      "email": "jhb@FreeBSD.org",
      "date": "2022-01-28T19:14:37Z"
    },
    "message": "Remove vestigal FreeBSD/i386 3.x support.\n\nThis was orphaned when a.out support was removed as the FreeBSD/i386\nELF support always used the register layouts from 4.0+.",
    "tree": {
      "sha": "137c5aee901c23413c140d8187f67f213c044b71",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/137c5aee901c23413c140d8187f67f213c044b71"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/187365caaad2d020b335485c50b0fcd00c5e5b48",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/187365caaad2d020b335485c50b0fcd00c5e5b48",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/187365caaad2d020b335485c50b0fcd00c5e5b48",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/187365caaad2d020b335485c50b0fcd00c5e5b48/comments",
  "author": {
    "login": "bsdjhb",
    "id": 8976613,
    "node_id": "MDQ6VXNlcjg5NzY2MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8976613?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bsdjhb",
    "html_url": "https://github.com/bsdjhb",
    "followers_url": "https://api.github.com/users/bsdjhb/followers",
    "following_url": "https://api.github.com/users/bsdjhb/following{/other_user}",
    "gists_url": "https://api.github.com/users/bsdjhb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bsdjhb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bsdjhb/subscriptions",
    "organizations_url": "https://api.github.com/users/bsdjhb/orgs",
    "repos_url": "https://api.github.com/users/bsdjhb/repos",
    "events_url": "https://api.github.com/users/bsdjhb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bsdjhb/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "bsdjhb",
    "id": 8976613,
    "node_id": "MDQ6VXNlcjg5NzY2MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8976613?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bsdjhb",
    "html_url": "https://github.com/bsdjhb",
    "followers_url": "https://api.github.com/users/bsdjhb/followers",
    "following_url": "https://api.github.com/users/bsdjhb/following{/other_user}",
    "gists_url": "https://api.github.com/users/bsdjhb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bsdjhb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bsdjhb/subscriptions",
    "organizations_url": "https://api.github.com/users/bsdjhb/orgs",
    "repos_url": "https://api.github.com/users/bsdjhb/repos",
    "events_url": "https://api.github.com/users/bsdjhb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bsdjhb/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5647d3e3dc18463240b6dbfac0bd0cf7d506c824",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5647d3e3dc18463240b6dbfac0bd0cf7d506c824",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5647d3e3dc18463240b6dbfac0bd0cf7d506c824"
    }
  ],
  "stats": {
    "total": 122,
    "additions": 32,
    "deletions": 90
  },
  "files": [
    {
      "sha": "a04478ac5a776a82df35f99d905e64f5633e8d64",
      "filename": "gdb/i386-bsd-nat.c",
      "status": "modified",
      "additions": 1,
      "deletions": 3,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/187365caaad2d020b335485c50b0fcd00c5e5b48/gdb/i386-bsd-nat.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/187365caaad2d020b335485c50b0fcd00c5e5b48/gdb/i386-bsd-nat.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/i386-bsd-nat.c?ref=187365caaad2d020b335485c50b0fcd00c5e5b48",
      "patch": "@@ -350,9 +350,7 @@ _initialize_i386bsd_nat ()\n      system header files and sysctl(3) to get at the relevant\n      information.  */\n \n-#if defined (__FreeBSD_version) && __FreeBSD_version >= 400011\n-#define SC_REG_OFFSET i386fbsd4_sc_reg_offset\n-#elif defined (__FreeBSD_version) && __FreeBSD_version >= 300005\n+#if defined (__FreeBSD_version)\n #define SC_REG_OFFSET i386fbsd_sc_reg_offset\n #elif defined (OpenBSD)\n #define SC_REG_OFFSET i386obsd_sc_reg_offset"
    },
    {
      "sha": "f09a4947e9895560505a6b4e92b5ef8414214167",
      "filename": "gdb/i386-fbsd-tdep.c",
      "status": "modified",
      "additions": 31,
      "deletions": 86,
      "changes": 117,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/187365caaad2d020b335485c50b0fcd00c5e5b48/gdb/i386-fbsd-tdep.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/187365caaad2d020b335485c50b0fcd00c5e5b48/gdb/i386-fbsd-tdep.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/i386-fbsd-tdep.c?ref=187365caaad2d020b335485c50b0fcd00c5e5b48",
      "patch": "@@ -186,17 +186,15 @@ i386fbsd_sigtramp_p (struct frame_info *this_frame)\n   return 1;\n }\n \n-/* FreeBSD 3.0-RELEASE or later.  */\n-\n /* From <machine/reg.h>.  */\n static int i386fbsd_r_reg_offset[] =\n {\n-  9 * 4, 8 * 4, 7 * 4, 6 * 4,\t/* %eax, %ecx, %edx, %ebx */\n-  15 * 4, 4 * 4,\t\t/* %esp, %ebp */\n-  3 * 4, 2 * 4,\t\t\t/* %esi, %edi */\n-  12 * 4, 14 * 4,\t\t/* %eip, %eflags */\n-  13 * 4, 16 * 4,\t\t/* %cs, %ss */\n-  1 * 4, 0 * 4, -1, -1\t\t/* %ds, %es, %fs, %gs */\n+  10 * 4, 9 * 4, 8 * 4, 7 * 4,\t/* %eax, %ecx, %edx, %ebx */\n+  16 * 4, 5 * 4,\t\t/* %esp, %ebp */\n+  4 * 4, 3 * 4,\t\t\t/* %esi, %edi */\n+  13 * 4, 15 * 4,\t\t/* %eip, %eflags */\n+  14 * 4, 17 * 4,\t\t/* %cs, %ss */\n+  2 * 4, 1 * 4, 0 * 4, 18 * 4\t/* %ds, %es, %fs, %gs */\n };\n \n /* Sigtramp routine location.  */\n@@ -206,22 +204,22 @@ CORE_ADDR i386fbsd_sigtramp_end_addr;\n /* From <machine/signal.h>.  */\n int i386fbsd_sc_reg_offset[] =\n {\n-  8 + 14 * 4,\t\t\t/* %eax */\n-  8 + 13 * 4,\t\t\t/* %ecx */\n-  8 + 12 * 4,\t\t\t/* %edx */\n-  8 + 11 * 4,\t\t\t/* %ebx */\n-  8 + 0 * 4,                    /* %esp */\n-  8 + 1 * 4,                    /* %ebp */\n-  8 + 10 * 4,                   /* %esi */\n-  8 + 9 * 4,                    /* %edi */\n-  8 + 3 * 4,                    /* %eip */\n-  8 + 4 * 4,                    /* %eflags */\n-  8 + 7 * 4,                    /* %cs */\n-  8 + 8 * 4,                    /* %ss */\n-  8 + 6 * 4,                    /* %ds */\n-  8 + 5 * 4,                    /* %es */\n-  8 + 15 * 4,\t\t\t/* %fs */\n-  8 + 16 * 4\t\t\t/* %gs */\n+  20 + 11 * 4,\t\t\t/* %eax */\n+  20 + 10 * 4,\t\t\t/* %ecx */\n+  20 + 9 * 4,\t\t\t/* %edx */\n+  20 + 8 * 4,\t\t\t/* %ebx */\n+  20 + 17 * 4,\t\t\t/* %esp */\n+  20 + 6 * 4,\t\t\t/* %ebp */\n+  20 + 5 * 4,\t\t\t/* %esi */\n+  20 + 4 * 4,\t\t\t/* %edi */\n+  20 + 14 * 4,\t\t\t/* %eip */\n+  20 + 16 * 4,\t\t\t/* %eflags */\n+  20 + 15 * 4,\t\t\t/* %cs */\n+  20 + 18 * 4,\t\t\t/* %ss */\n+  20 + 3 * 4,\t\t\t/* %ds */\n+  20 + 2 * 4,\t\t\t/* %es */\n+  20 + 1 * 4,\t\t\t/* %fs */\n+  20 + 0 * 4\t\t\t/* %gs */\n };\n \n /* Get XSAVE extended state xcr0 from core dump.  */\n@@ -351,14 +349,17 @@ i386fbsd_init_abi (struct gdbarch_info info, struct gdbarch *gdbarch)\n {\n   i386_gdbarch_tdep *tdep = (i386_gdbarch_tdep *) gdbarch_tdep (gdbarch);\n \n+  /* Generic FreeBSD support. */\n+  fbsd_init_abi (info, gdbarch);\n+\n   /* Obviously FreeBSD is BSD-based.  */\n   i386bsd_init_abi (info, gdbarch);\n \n   /* FreeBSD has a different `struct reg', and reserves some space for\n      its FPU emulator in `struct fpreg'.  */\n   tdep->gregset_reg_offset = i386fbsd_r_reg_offset;\n   tdep->gregset_num_regs = ARRAY_SIZE (i386fbsd_r_reg_offset);\n-  tdep->sizeof_gregset = 18 * 4;\n+  tdep->sizeof_gregset = 19 * 4;\n   tdep->sizeof_fpregset = 176;\n \n   /* FreeBSD uses -freg-struct-return by default.  */\n@@ -376,66 +377,6 @@ i386fbsd_init_abi (struct gdbarch_info info, struct gdbarch *gdbarch)\n \n   i386_elf_init_abi (info, gdbarch);\n \n-  /* FreeBSD uses SVR4-style shared libraries.  */\n-  set_solib_svr4_fetch_link_map_offsets\n-    (gdbarch, svr4_ilp32_fetch_link_map_offsets);\n-}\n-\n-/* FreeBSD 4.0-RELEASE or later.  */\n-\n-/* From <machine/reg.h>.  */\n-static int i386fbsd4_r_reg_offset[] =\n-{\n-  10 * 4, 9 * 4, 8 * 4, 7 * 4,\t/* %eax, %ecx, %edx, %ebx */\n-  16 * 4, 5 * 4,\t\t/* %esp, %ebp */\n-  4 * 4, 3 * 4,\t\t\t/* %esi, %edi */\n-  13 * 4, 15 * 4,\t\t/* %eip, %eflags */\n-  14 * 4, 17 * 4,\t\t/* %cs, %ss */\n-  2 * 4, 1 * 4, 0 * 4, 18 * 4\t/* %ds, %es, %fs, %gs */\n-};\n-\n-/* From <machine/signal.h>.  */\n-int i386fbsd4_sc_reg_offset[] =\n-{\n-  20 + 11 * 4,\t\t\t/* %eax */\n-  20 + 10 * 4,\t\t\t/* %ecx */\n-  20 + 9 * 4,\t\t\t/* %edx */\n-  20 + 8 * 4,\t\t\t/* %ebx */\n-  20 + 17 * 4,\t\t\t/* %esp */\n-  20 + 6 * 4,\t\t\t/* %ebp */\n-  20 + 5 * 4,\t\t\t/* %esi */\n-  20 + 4 * 4,\t\t\t/* %edi */\n-  20 + 14 * 4,\t\t\t/* %eip */\n-  20 + 16 * 4,\t\t\t/* %eflags */\n-  20 + 15 * 4,\t\t\t/* %cs */\n-  20 + 18 * 4,\t\t\t/* %ss */\n-  20 + 3 * 4,\t\t\t/* %ds */\n-  20 + 2 * 4,\t\t\t/* %es */\n-  20 + 1 * 4,\t\t\t/* %fs */\n-  20 + 0 * 4\t\t\t/* %gs */\n-};\n-\n-static void\n-i386fbsd4_init_abi (struct gdbarch_info info, struct gdbarch *gdbarch)\n-{\n-  i386_gdbarch_tdep *tdep = (i386_gdbarch_tdep *) gdbarch_tdep (gdbarch);\n-\n-  /* Generic FreeBSD support. */\n-  fbsd_init_abi (info, gdbarch);\n-\n-  /* Inherit stuff from older releases.  We assume that FreeBSD\n-     4.0-RELEASE always uses ELF.  */\n-  i386fbsd_init_abi (info, gdbarch);\n-\n-  /* FreeBSD 4.0 introduced a new `struct reg'.  */\n-  tdep->gregset_reg_offset = i386fbsd4_r_reg_offset;\n-  tdep->gregset_num_regs = ARRAY_SIZE (i386fbsd4_r_reg_offset);\n-  tdep->sizeof_gregset = 19 * 4;\n-\n-  /* FreeBSD 4.0 introduced a new `struct sigcontext'.  */\n-  tdep->sc_reg_offset = i386fbsd4_sc_reg_offset;\n-  tdep->sc_num_regs = ARRAY_SIZE (i386fbsd4_sc_reg_offset);\n-\n   tdep->xsave_xcr0_offset = I386_FBSD_XSAVE_XCR0_OFFSET;\n \n   /* Iterate over core file register note sections.  */\n@@ -445,6 +386,10 @@ i386fbsd4_init_abi (struct gdbarch_info info, struct gdbarch *gdbarch)\n   set_gdbarch_core_read_description (gdbarch,\n \t\t\t\t     i386fbsd_core_read_description);\n \n+  /* FreeBSD uses SVR4-style shared libraries.  */\n+  set_solib_svr4_fetch_link_map_offsets\n+    (gdbarch, svr4_ilp32_fetch_link_map_offsets);\n+\n   set_gdbarch_fetch_tls_load_module_address (gdbarch,\n \t\t\t\t\t     svr4_fetch_objfile_link_map);\n   set_gdbarch_get_thread_local_address (gdbarch,\n@@ -456,5 +401,5 @@ void\n _initialize_i386fbsd_tdep ()\n {\n   gdbarch_register_osabi (bfd_arch_i386, 0, GDB_OSABI_FREEBSD,\n-\t\t\t  i386fbsd4_init_abi);\n+\t\t\t  i386fbsd_init_abi);\n }"
    },
    {
      "sha": "5889933745876267c400bd5e29407b80f36b3aca",
      "filename": "gdb/i386-tdep.h",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/187365caaad2d020b335485c50b0fcd00c5e5b48/gdb/i386-tdep.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/187365caaad2d020b335485c50b0fcd00c5e5b48/gdb/i386-tdep.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/i386-tdep.h?ref=187365caaad2d020b335485c50b0fcd00c5e5b48",
      "patch": "@@ -476,7 +476,6 @@ extern CORE_ADDR i386fbsd_sigtramp_start_addr;\n extern CORE_ADDR i386fbsd_sigtramp_end_addr;\n extern CORE_ADDR i386obsd_sigtramp_start_addr;\n extern CORE_ADDR i386obsd_sigtramp_end_addr;\n-extern int i386fbsd4_sc_reg_offset[];\n extern int i386fbsd_sc_reg_offset[];\n extern int i386obsd_sc_reg_offset[];\n extern int i386bsd_sc_reg_offset[];"
    }
  ]
}