{
  "sha": "e7d612adc7496ce4bfa2cd31454701f99cb4df17",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZTdkNjEyYWRjNzQ5NmNlNGJmYTJjZDMxNDU0NzAxZjk5Y2I0ZGYxNw==",
  "commit": {
    "author": {
      "name": "Jon Turney",
      "email": "jon.turney@dronecode.org.uk",
      "date": "2020-06-29T16:11:51Z"
    },
    "committer": {
      "name": "Jon Turney",
      "email": "jon.turney@dronecode.org.uk",
      "date": "2020-09-18T16:12:12Z"
    },
    "message": "Add handling for 64-bit module addresses in Cygwin core dumps\n\nAdd handling for 64-bit module addresses when processing '.module' fake\nsections in Cygwin core dumps.\n\ngdb/ChangeLog:\n\n2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n\n\t* windows-tdep.c (NOTE_INFO_MODULE, NOTE_INFO_MODULE64): Define.\n\t(core_process_module_section): Handle NOTE_INFO_MODULE64.",
    "tree": {
      "sha": "12504ef629588edc90385eca9e55b254fe52091b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/12504ef629588edc90385eca9e55b254fe52091b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e7d612adc7496ce4bfa2cd31454701f99cb4df17",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIcBAABAgAGBQJfZNxdAAoJEMfIbwNwKFyBOloQAKJ5NNI9yosHmwPCZRtRPRnl\nnQaIY7YK9fICwlO5QSGRo8svMQ+RYNMpz4Wi1jUI8hNkzb8oVLdtjMKw2fw5HX4/\nA/A2tPpnOUOZCdvNYA7vredFEqjiGu2M/aVPm5Wz4HJjXkCETNOBSDh/i5z1RhM3\ni401xfNYOol2D/MNeUSc0UjENAYk4MLYPxcB0nlJsHzOBUpZmEuqG4dFkpqErtVG\nNJF0ujR7D9w+ND7gP0mQT90UJvPrdiAe0sK6wsRXeROSz1n3Rps+Wro7e3uWWy/z\n/o10PJKq/5AigY0wytQPFWu/TLAtLuLpcREOZhjXZEJ0n/hCy2H3mUPkdOMN8SID\n1oTXLJzMn7C5tMolH8IhBun0rv0JUraFR+YEqKVDWSRnXToGm+HKbG+c+nnSTlTN\nQ3JFs9k1O4HJOY1UZQSwQZ2C/4bcS0V2WO6I6/EO8tpve5R3uYnAcy31jXeYbKnP\nLVMzh4+FBtRjUt2+JnZW8PnQYu/RsBEjKM8JzSI4OEhqz8TF8r0e+MQhKyGFKen1\n5tr1VTQTwPd2hfKIkmNdH7aXQkXpYxgd/KyO0bg8Hdmj4Jl+FIKfV71Ks3TVbziZ\nNkuU7t9aj93IK/RR8Ntl4BcW9wZDjqORrdlzCeXd8pKEYpO+jWI3oRoG4QT7SGdG\n6B6amFKqQh0SgSKjScMX\n=pKtL\n-----END PGP SIGNATURE-----",
      "payload": "tree 12504ef629588edc90385eca9e55b254fe52091b\nparent 62a5151b6b47d9e31bc49599b3f83803421d5819\nauthor Jon Turney <jon.turney@dronecode.org.uk> 1593447111 +0100\ncommitter Jon Turney <jon.turney@dronecode.org.uk> 1600445532 +0100\n\nAdd handling for 64-bit module addresses in Cygwin core dumps\n\nAdd handling for 64-bit module addresses when processing '.module' fake\nsections in Cygwin core dumps.\n\ngdb/ChangeLog:\n\n2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n\n\t* windows-tdep.c (NOTE_INFO_MODULE, NOTE_INFO_MODULE64): Define.\n\t(core_process_module_section): Handle NOTE_INFO_MODULE64.\n"
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e7d612adc7496ce4bfa2cd31454701f99cb4df17",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e7d612adc7496ce4bfa2cd31454701f99cb4df17",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e7d612adc7496ce4bfa2cd31454701f99cb4df17/comments",
  "author": {
    "login": "jon-turney",
    "id": 3497232,
    "node_id": "MDQ6VXNlcjM0OTcyMzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3497232?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jon-turney",
    "html_url": "https://github.com/jon-turney",
    "followers_url": "https://api.github.com/users/jon-turney/followers",
    "following_url": "https://api.github.com/users/jon-turney/following{/other_user}",
    "gists_url": "https://api.github.com/users/jon-turney/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jon-turney/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jon-turney/subscriptions",
    "organizations_url": "https://api.github.com/users/jon-turney/orgs",
    "repos_url": "https://api.github.com/users/jon-turney/repos",
    "events_url": "https://api.github.com/users/jon-turney/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jon-turney/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jon-turney",
    "id": 3497232,
    "node_id": "MDQ6VXNlcjM0OTcyMzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3497232?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jon-turney",
    "html_url": "https://github.com/jon-turney",
    "followers_url": "https://api.github.com/users/jon-turney/followers",
    "following_url": "https://api.github.com/users/jon-turney/following{/other_user}",
    "gists_url": "https://api.github.com/users/jon-turney/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jon-turney/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jon-turney/subscriptions",
    "organizations_url": "https://api.github.com/users/jon-turney/orgs",
    "repos_url": "https://api.github.com/users/jon-turney/repos",
    "events_url": "https://api.github.com/users/jon-turney/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jon-turney/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "62a5151b6b47d9e31bc49599b3f83803421d5819",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/62a5151b6b47d9e31bc49599b3f83803421d5819",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/62a5151b6b47d9e31bc49599b3f83803421d5819"
    }
  ],
  "stats": {
    "total": 35,
    "additions": 28,
    "deletions": 7
  },
  "files": [
    {
      "sha": "4f8fee80307f28a0c6f26e3810d68c536569f158",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e7d612adc7496ce4bfa2cd31454701f99cb4df17/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e7d612adc7496ce4bfa2cd31454701f99cb4df17/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=e7d612adc7496ce4bfa2cd31454701f99cb4df17",
      "patch": "@@ -1,3 +1,8 @@\n+2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n+\n+\t* windows-tdep.c (NOTE_INFO_MODULE, NOTE_INFO_MODULE64): Define.\n+\t(core_process_module_section): Handle NOTE_INFO_MODULE64.\n+\n 2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n \n \t* windows-tdep.h: Add prototypes."
    },
    {
      "sha": "0c3fa911da1e04ddd1ed11198731dd0401892751",
      "filename": "gdb/windows-tdep.c",
      "status": "modified",
      "additions": 23,
      "deletions": 7,
      "changes": 30,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e7d612adc7496ce4bfa2cd31454701f99cb4df17/gdb/windows-tdep.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e7d612adc7496ce4bfa2cd31454701f99cb4df17/gdb/windows-tdep.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/windows-tdep.c?ref=e7d612adc7496ce4bfa2cd31454701f99cb4df17",
      "patch": "@@ -105,6 +105,10 @@ enum\n   CYGWIN_SIGUSR2 = 31,\n };\n \n+/* These constants are defined by Cygwin's core_dump.h */\n+static constexpr unsigned int NOTE_INFO_MODULE = 3;\n+static constexpr unsigned int NOTE_INFO_MODULE64 = 4;\n+\n struct cmd_list_element *info_w32_cmdlist;\n \n typedef struct thread_information_block_32\n@@ -1101,8 +1105,10 @@ core_process_module_section (bfd *abfd, asection *sect, void *obj)\n   struct cpms_data *data = (struct cpms_data *) obj;\n   enum bfd_endian byte_order = gdbarch_byte_order (data->gdbarch);\n \n+  unsigned int data_type;\n   char *module_name;\n   size_t module_name_size;\n+  size_t module_name_offset;\n   CORE_ADDR base_addr;\n \n   gdb_byte *buf = NULL;\n@@ -1123,16 +1129,26 @@ core_process_module_section (bfd *abfd, asection *sect, void *obj)\n \n \n   /* A DWORD (data_type) followed by struct windows_core_module_info.  */\n+  data_type = extract_unsigned_integer (buf, 4, byte_order);\n \n-  base_addr =\n-    extract_unsigned_integer (buf + 4, 4, byte_order);\n-\n-  module_name_size =\n-    extract_unsigned_integer (buf + 8, 4, byte_order);\n+  if (data_type == NOTE_INFO_MODULE)\n+    {\n+      base_addr = extract_unsigned_integer (buf + 4, 4, byte_order);\n+      module_name_size = extract_unsigned_integer (buf + 8, 4, byte_order);\n+      module_name_offset = 12;\n+    }\n+  else if (data_type == NOTE_INFO_MODULE64)\n+    {\n+      base_addr = extract_unsigned_integer (buf + 4, 8, byte_order);\n+      module_name_size = extract_unsigned_integer (buf + 12, 4, byte_order);\n+      module_name_offset = 16;\n+    }\n+  else\n+    goto out;\n \n-  if (12 + module_name_size > bfd_section_size (sect))\n+  if (module_name_offset + module_name_size > bfd_section_size (sect))\n     goto out;\n-  module_name = (char *) buf + 12;\n+  module_name = (char *) buf + module_name_offset;\n \n   /* The first module is the .exe itself.  */\n   if (data->module_count != 0)"
    }
  ]
}