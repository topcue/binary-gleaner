{
  "sha": "0256da25c04a5f797ccb210b2cb05a3fdb084495",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDI1NmRhMjVjMDRhNWY3OTdjY2IyMTBiMmNiMDVhM2ZkYjA4NDQ5NQ==",
  "commit": {
    "author": {
      "name": "Pedro Alves",
      "email": "pedro@palves.net",
      "date": "2021-04-12T19:23:54Z"
    },
    "committer": {
      "name": "Pedro Alves",
      "email": "pedro@palves.net",
      "date": "2021-04-13T12:26:44Z"
    },
    "message": "Remove process_stratum_target::hostio_last_error abstraction\n\nNow that the WinCE port is gone, all ports map host I/O errors from\nerrno, so this abstraction is no longer necessary.\n\nBasically undoes:\n  https://sourceware.org/pipermail/gdb-patches/2008-January/055511.html\n  https://sourceware.org/pipermail/gdb-patches/attachments/20080131/f44e7012/attachment.bin\n\ngdbserver/ChangeLog:\n\n\t* Makefile.in (SFILES): Remove hostio-errno.cc.\n\t* configure: Regenerate.\n\t* configure.ac (GDBSERVER_DEPFILES): No longer add\n\t$srv_hostio_err_objs.\n\t* configure.srv (srv_hostio_err_objs): Delete.\n\t* hostio-errno.cc: Delete.\n\t* hostio.cc (hostio_error): Inline hostio_last_error_from_errno\n\there.\n\t* hostio.h (hostio_last_error_from_errno): Delete.\n\t* target.cc (process_stratum_target::hostio_last_error): Delete.\n\t* target.h (class process_stratum_target) <hostio_last_error>:\n\tDelete.",
    "tree": {
      "sha": "d1d2022c34315bec94f050df771e369e6fef8b00",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d1d2022c34315bec94f050df771e369e6fef8b00"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0256da25c04a5f797ccb210b2cb05a3fdb084495",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0256da25c04a5f797ccb210b2cb05a3fdb084495",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0256da25c04a5f797ccb210b2cb05a3fdb084495",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0256da25c04a5f797ccb210b2cb05a3fdb084495/comments",
  "author": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d2f1139ef0c006f35210fac76cb034cfe8d57c2e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d2f1139ef0c006f35210fac76cb034cfe8d57c2e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d2f1139ef0c006f35210fac76cb034cfe8d57c2e"
    }
  ],
  "stats": {
    "total": 83,
    "additions": 22,
    "deletions": 61
  },
  "files": [
    {
      "sha": "dfaaa60419715a8c7a612389368019ec413b421a",
      "filename": "gdbserver/ChangeLog",
      "status": "modified",
      "additions": 15,
      "deletions": 0,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/ChangeLog?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -1,3 +1,18 @@\n+2021-04-13  Pedro Alves  <pedro@palves.net>\n+\n+\t* Makefile.in (SFILES): Remove hostio-errno.cc.\n+\t* configure: Regenerate.\n+\t* configure.ac (GDBSERVER_DEPFILES): No longer add\n+\t$srv_hostio_err_objs.\n+\t* configure.srv (srv_hostio_err_objs): Delete.\n+\t* hostio-errno.cc: Delete.\n+\t* hostio.cc (hostio_error): Inline hostio_last_error_from_errno\n+\there.\n+\t* hostio.h (hostio_last_error_from_errno): Delete.\n+\t* target.cc (process_stratum_target::hostio_last_error): Delete.\n+\t* target.h (class process_stratum_target) <hostio_last_error>:\n+\tDelete.\n+\n 2021-04-12  Simon Marchi  <simon.marchi@polymtl.ca>\n \n \t* win32-low.cc: Remove all code guarded by _WIN32_WCE."
    },
    {
      "sha": "f7ade7d61d5c9e1c9a6a4abfaeb9320d86a18c84",
      "filename": "gdbserver/Makefile.in",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/Makefile.in?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -186,7 +186,6 @@ SFILES = \\\n \t$(srcdir)/dll.cc \\\n \t$(srcdir)/gdbreplay.cc \\\n \t$(srcdir)/hostio.cc \\\n-\t$(srcdir)/hostio-errno.cc \\\n \t$(srcdir)/i387-fp.cc \\\n \t$(srcdir)/inferiors.cc \\\n \t$(srcdir)/linux-aarch64-low.cc \\"
    },
    {
      "sha": "032b4ae65bbc49c8ba10d8bfc947c35602b5db40",
      "filename": "gdbserver/configure",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -10633,7 +10633,7 @@ $as_echo \"#define USE_XML 1\" >>confdefs.h\n   done\n fi\n \n-GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles\"\n+GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_thread_depfiles\"\n GDBSERVER_LIBS=\"$srv_libs\"\n \n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether the target supports __sync_*_compare_and_swap\" >&5"
    },
    {
      "sha": "5ec222dfc6055695b5e06b1d8c99d5d5789c9b96",
      "filename": "gdbserver/configure.ac",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure.ac?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -379,7 +379,7 @@ if test \"$srv_xmlfiles\" != \"\"; then\n   done\n fi\n \n-GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles\"\n+GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_thread_depfiles\"\n GDBSERVER_LIBS=\"$srv_libs\"\n \n dnl Check whether the target supports __sync_*_compare_and_swap."
    },
    {
      "sha": "971f537bffa434dc4a7cf80056b1a94e23be1400",
      "filename": "gdbserver/configure.srv",
      "status": "modified",
      "additions": 0,
      "deletions": 5,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/configure.srv",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/configure.srv",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure.srv?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -8,8 +8,6 @@\n #   srv_regobj\t\tThe register protocol appropriate for this target.\n #   srv_tgtobj\t\tAny other target-specific modules appropriate\n #\t\t\tfor this target.\n-#   srv_hostio_err\tThe object implementing the hostio_last_error\n-#\t\t\ttarget method.\n #   srv_xmlfiles\tAll XML files which should be available for\n #\t\t\tgdbserver in this configuration.\n #   ipa_obj\t\tAny other target-specific modules appropriate\n@@ -24,9 +22,6 @@\n #   srv_linux_usrregs\tSet to \"yes\" if we can get at registers via\n #\t\t\tPTRACE_PEEKUSR / PTRACE_POKEUSR.\n \n-# Default hostio_last_error implementation\n-srv_hostio_err_objs=\"hostio-errno.o\"\n-\n ipa_ppc_linux_regobj=\"powerpc-32l-ipa.o powerpc-altivec32l-ipa.o powerpc-vsx32l-ipa.o powerpc-isa205-32l-ipa.o powerpc-isa205-altivec32l-ipa.o powerpc-isa205-vsx32l-ipa.o powerpc-isa205-ppr-dscr-vsx32l-ipa.o powerpc-isa207-vsx32l-ipa.o powerpc-isa207-htm-vsx32l-ipa.o powerpc-e500l-ipa.o powerpc-64l-ipa.o powerpc-altivec64l-ipa.o powerpc-vsx64l-ipa.o powerpc-isa205-64l-ipa.o powerpc-isa205-altivec64l-ipa.o powerpc-isa205-vsx64l-ipa.o powerpc-isa205-ppr-dscr-vsx64l-ipa.o powerpc-isa207-vsx64l-ipa.o powerpc-isa207-htm-vsx64l-ipa.o\"\n \n # Linux object files.  This is so we don't have to repeat"
    },
    {
      "sha": "4cb3922b92ed4b2b2ec68a8bd7513ab710d8e252",
      "filename": "gdbserver/hostio-errno.cc",
      "status": "removed",
      "additions": 0,
      "deletions": 36,
      "changes": 36,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d2f1139ef0c006f35210fac76cb034cfe8d57c2e/gdbserver/hostio-errno.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d2f1139ef0c006f35210fac76cb034cfe8d57c2e/gdbserver/hostio-errno.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/hostio-errno.cc?ref=d2f1139ef0c006f35210fac76cb034cfe8d57c2e",
      "patch": "@@ -1,36 +0,0 @@\n-/* Host file transfer support for gdbserver.\n-   Copyright (C) 2007-2021 Free Software Foundation, Inc.\n-\n-   Contributed by CodeSourcery.\n-\n-   This file is part of GDB.\n-\n-   This program is free software; you can redistribute it and/or modify\n-   it under the terms of the GNU General Public License as published by\n-   the Free Software Foundation; either version 3 of the License, or\n-   (at your option) any later version.\n-\n-   This program is distributed in the hope that it will be useful,\n-   but WITHOUT ANY WARRANTY; without even the implied warranty of\n-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-   GNU General Public License for more details.\n-\n-   You should have received a copy of the GNU General Public License\n-   along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n-\n-/* This file implements the hostio_last_error target callback\n-   on top of errno.  */\n-\n-#include \"server.h\"\n-\n-#include \"hostio.h\"\n-\n-#include \"gdbsupport/fileio.h\"\n-\n-void\n-hostio_last_error_from_errno (char *buf)\n-{\n-  int error = errno;\n-  int fileio_error = host_to_fileio_error (error);\n-  sprintf (buf, \"F-1,%x\", fileio_error);\n-}"
    },
    {
      "sha": "0654bba3a6fa5392685937c137a60ae9cfbd2f56",
      "filename": "gdbserver/hostio.cc",
      "status": "modified",
      "additions": 5,
      "deletions": 3,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/hostio.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/hostio.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/hostio.cc?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -191,12 +191,14 @@ require_valid_fd (int fd)\n   return -1;\n }\n \n-/* Fill in own_buf with the last hostio error packet, however it\n-   suitable for the target.  */\n+/* Fill BUF with an hostio error packet representing the last hostio\n+   error, from errno.  */\n+\n static void\n hostio_error (char *own_buf)\n {\n-  the_target->hostio_last_error (own_buf);\n+  int fileio_error = host_to_fileio_error (errno);\n+  sprintf (own_buf, \"F-1,%x\", fileio_error);\n }\n \n static void"
    },
    {
      "sha": "97c27c6b744584ae8d559d66b6a92e16deb57864",
      "filename": "gdbserver/hostio.h",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/hostio.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/hostio.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/hostio.h?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -22,10 +22,6 @@\n /* Per-connection setup.  */\n extern void hostio_handle_new_gdb_connection (void);\n \n-/* Functions from hostio.c.  */\n extern int handle_vFile (char *, int, int *);\n \n-/* Functions from hostio-errno.c.  */\n-extern void hostio_last_error_from_errno (char *own_buf);\n-\n #endif /* GDBSERVER_HOSTIO_H */"
    },
    {
      "sha": "6660cc04fd50f2ca23308110db778ad90a7c5b01",
      "filename": "gdbserver/target.cc",
      "status": "modified",
      "additions": 0,
      "deletions": 6,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/target.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/target.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/target.cc?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -505,12 +505,6 @@ process_stratum_target::get_tls_address (thread_info *thread,\n   gdb_assert_not_reached (\"target op get_tls_address not supported\");\n }\n \n-void\n-process_stratum_target::hostio_last_error (char *buf)\n-{\n-  hostio_last_error_from_errno (buf);\n-}\n-\n bool\n process_stratum_target::supports_qxfer_osdata ()\n {"
    },
    {
      "sha": "2c4393ec8c61a20d36392bb5f7e6277109a2d627",
      "filename": "gdbserver/target.h",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/target.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0256da25c04a5f797ccb210b2cb05a3fdb084495/gdbserver/target.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/target.h?ref=0256da25c04a5f797ccb210b2cb05a3fdb084495",
      "patch": "@@ -256,10 +256,6 @@ class process_stratum_target\n   virtual int get_tls_address (thread_info *thread, CORE_ADDR offset,\n \t\t\t       CORE_ADDR load_module, CORE_ADDR *address);\n \n-  /* Fill BUF with an hostio error packet representing the last hostio\n-     error.  */\n-  virtual void hostio_last_error (char *buf);\n-\n   /* Return true if the qxfer_osdata target op is supported.  */\n   virtual bool supports_qxfer_osdata ();\n "
    }
  ]
}