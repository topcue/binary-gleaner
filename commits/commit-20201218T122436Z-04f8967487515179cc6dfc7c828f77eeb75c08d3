{
  "sha": "04f8967487515179cc6dfc7c828f77eeb75c08d3",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MDRmODk2NzQ4NzUxNTE3OWNjNmRmYzdjODI4Zjc3ZWViNzVjMDhkMw==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-12-18T12:24:26Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-12-18T12:24:36Z"
    },
    "message": "elf: Copy elf_gnu_osabi_retain only for relocatable link\n\nCopy elf_gnu_osabi_retain from input only for relocatable link since\nSHF_GNU_RETAIN has no impact on non-relocatable outputs.\n\nbfd/\n\n\tPR ld/27091\n\t* elflink.c (elf_link_input_bfd): Copy elf_gnu_osabi_retain\n\tfrom input only for relocatable link.\n\nld/\n\n\tPR ld/27091\n\t* testsuite/ld-elf/retain7.s: New file.\n\t* testsuite/ld-elf/retain7a.d: Likewise.\n\t* testsuite/ld-elf/retain7b.d: Likewise.",
    "tree": {
      "sha": "e94cbcef29d4c243b02807377d5f9a98f2c3808c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/e94cbcef29d4c243b02807377d5f9a98f2c3808c"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/04f8967487515179cc6dfc7c828f77eeb75c08d3",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/04f8967487515179cc6dfc7c828f77eeb75c08d3",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/04f8967487515179cc6dfc7c828f77eeb75c08d3",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/04f8967487515179cc6dfc7c828f77eeb75c08d3/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "3fafa2e26ed651e3d3a50193b5bbf8f55779c7aa",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3fafa2e26ed651e3d3a50193b5bbf8f55779c7aa",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/3fafa2e26ed651e3d3a50193b5bbf8f55779c7aa"
    }
  ],
  "stats": {
    "total": 43,
    "additions": 42,
    "deletions": 1
  },
  "files": [
    {
      "sha": "582add86d20556dc31a13020c4e9047aad84b30b",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/04f8967487515179cc6dfc7c828f77eeb75c08d3/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/04f8967487515179cc6dfc7c828f77eeb75c08d3/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=04f8967487515179cc6dfc7c828f77eeb75c08d3",
      "patch": "@@ -1,3 +1,9 @@\n+2020-12-18  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/27091\n+\t* elflink.c (elf_link_input_bfd): Copy elf_gnu_osabi_retain\n+\tfrom input only for relocatable link.\n+\n 2020-12-18  Alan Modra  <amodra@gmail.com>\n \n \t* elf32-microblaze.c (dbg): Delete unused variable."
    },
    {
      "sha": "1b3398126f090507c50923180424bef626a4e24d",
      "filename": "bfd/elflink.c",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/04f8967487515179cc6dfc7c828f77eeb75c08d3/bfd/elflink.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/04f8967487515179cc6dfc7c828f77eeb75c08d3/bfd/elflink.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elflink.c?ref=04f8967487515179cc6dfc7c828f77eeb75c08d3",
      "patch": "@@ -10806,7 +10806,9 @@ elf_link_input_bfd (struct elf_final_link_info *flinfo, bfd *input_bfd)\n       || bed->elf_osabi == ELFOSABI_GNU\n       || bed->elf_osabi == ELFOSABI_FREEBSD)\n     elf_tdata (output_bfd)->has_gnu_osabi\n-      |= elf_tdata (input_bfd)->has_gnu_osabi;\n+      |= (elf_tdata (input_bfd)->has_gnu_osabi\n+\t  & (bfd_link_relocatable (flinfo->info)\n+\t     ? -1 : ~elf_gnu_osabi_retain));\n \n   /* Read the local symbols.  */\n   isymbuf = (Elf_Internal_Sym *) symtab_hdr->contents;"
    },
    {
      "sha": "392165b978a88d74a512f0cb979bf412af9ea628",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/04f8967487515179cc6dfc7c828f77eeb75c08d3/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/04f8967487515179cc6dfc7c828f77eeb75c08d3/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=04f8967487515179cc6dfc7c828f77eeb75c08d3",
      "patch": "@@ -1,3 +1,10 @@\n+2020-12-18  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/27091\n+\t* testsuite/ld-elf/retain7.s: New file.\n+\t* testsuite/ld-elf/retain7a.d: Likewise.\n+\t* testsuite/ld-elf/retain7b.d: Likewise.\n+\n 2020-12-16  Howard Chu <hyc@symas.com>\n \t    H.J. Lu  <hongjiu.lu@intel.com>\n "
    },
    {
      "sha": "a6cc86988c2f03337697cf4e30148bbf71ffd864",
      "filename": "ld/testsuite/ld-elf/retain7.s",
      "status": "added",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/04f8967487515179cc6dfc7c828f77eeb75c08d3/ld/testsuite/ld-elf/retain7.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/04f8967487515179cc6dfc7c828f77eeb75c08d3/ld/testsuite/ld-elf/retain7.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/retain7.s?ref=04f8967487515179cc6dfc7c828f77eeb75c08d3",
      "patch": "@@ -0,0 +1,5 @@\n+\t.type _start,\"function\"\n+\t.section .text,\"axR\",%progbits\n+\t.global _start\n+_start:\n+\t.nop"
    },
    {
      "sha": "544ff8a17356c9f1a284543368e6c2f7d4d86284",
      "filename": "ld/testsuite/ld-elf/retain7a.d",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/04f8967487515179cc6dfc7c828f77eeb75c08d3/ld/testsuite/ld-elf/retain7a.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/04f8967487515179cc6dfc7c828f77eeb75c08d3/ld/testsuite/ld-elf/retain7a.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/retain7a.d?ref=04f8967487515179cc6dfc7c828f77eeb75c08d3",
      "patch": "@@ -0,0 +1,11 @@\n+#name: SHF_GNU_RETAIN 7a\n+#source: retain7.s\n+#ld: -e _start --gc-sections\n+#notarget: ![supports_gnu_osabi] ![check_gc_sections_available]\n+#readelf: -h\n+\n+#failif\n+ELF Header:\n+#...\n+  OS/ABI:                            UNIX - GNU\n+#pass"
    },
    {
      "sha": "0e5b12b335afda64c83ffd06cbd9f8d764d692c8",
      "filename": "ld/testsuite/ld-elf/retain7b.d",
      "status": "added",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/04f8967487515179cc6dfc7c828f77eeb75c08d3/ld/testsuite/ld-elf/retain7b.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/04f8967487515179cc6dfc7c828f77eeb75c08d3/ld/testsuite/ld-elf/retain7b.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/retain7b.d?ref=04f8967487515179cc6dfc7c828f77eeb75c08d3",
      "patch": "@@ -0,0 +1,10 @@\n+#name: SHF_GNU_RETAIN 7a\n+#source: retain7.s\n+#ld: -r\n+#notarget: ![supports_gnu_osabi] ![check_gc_sections_available]\n+#readelf: -h\n+\n+ELF Header:\n+#...\n+  OS/ABI:                            UNIX - GNU\n+#pass"
    }
  ]
}