{
  "sha": "d04aee0f41da38682239b57af954bf294e26d9cb",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDA0YWVlMGY0MWRhMzg2ODIyMzliNTdhZjk1NGJmMjk0ZTI2ZDljYg==",
  "commit": {
    "author": {
      "name": "Cooper Qu",
      "email": "cooper.qu@linux.alibaba.com",
      "date": "2020-08-21T10:08:10Z"
    },
    "committer": {
      "name": "Lifang Xia",
      "email": "lifang_xia@c-sky.com",
      "date": "2020-08-24T02:25:03Z"
    },
    "message": "CSKY: Add ck803r2 series cpu.\n\ngas/\n        * config/tc-csky.c (CSKY_ISA_803R2): New.\n        (csky_archs): Add ck803r2 series.\n        (md_begin): Fix warning about -medsp.\n        (csky_get_freg_val): Support lowercase of fpu register name.\n        * testsuite/gas/csky/cskyv2_ck803r2.s: New file.\n        * testsuite/gas/csky/cskyv2_ck803r2.d: New file.\n\ninclude/\n        * csky.h (CSKYV2_ISA_3E3R2): New.\n\nopcodes/\n        * csky-opc.h (csky_v2_opcodes): Add instruction bnezad.",
    "tree": {
      "sha": "e9d0af2b5f1c696974221a5288e658fb483fb772",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/e9d0af2b5f1c696974221a5288e658fb483fb772"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d04aee0f41da38682239b57af954bf294e26d9cb",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d04aee0f41da38682239b57af954bf294e26d9cb",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d04aee0f41da38682239b57af954bf294e26d9cb",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d04aee0f41da38682239b57af954bf294e26d9cb/comments",
  "author": {
    "login": "Cooper-Qu",
    "id": 68842787,
    "node_id": "MDQ6VXNlcjY4ODQyNzg3",
    "avatar_url": "https://avatars.githubusercontent.com/u/68842787?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Cooper-Qu",
    "html_url": "https://github.com/Cooper-Qu",
    "followers_url": "https://api.github.com/users/Cooper-Qu/followers",
    "following_url": "https://api.github.com/users/Cooper-Qu/following{/other_user}",
    "gists_url": "https://api.github.com/users/Cooper-Qu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Cooper-Qu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Cooper-Qu/subscriptions",
    "organizations_url": "https://api.github.com/users/Cooper-Qu/orgs",
    "repos_url": "https://api.github.com/users/Cooper-Qu/repos",
    "events_url": "https://api.github.com/users/Cooper-Qu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Cooper-Qu/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "Lifang-XIA",
    "id": 22215568,
    "node_id": "MDQ6VXNlcjIyMjE1NTY4",
    "avatar_url": "https://avatars.githubusercontent.com/u/22215568?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Lifang-XIA",
    "html_url": "https://github.com/Lifang-XIA",
    "followers_url": "https://api.github.com/users/Lifang-XIA/followers",
    "following_url": "https://api.github.com/users/Lifang-XIA/following{/other_user}",
    "gists_url": "https://api.github.com/users/Lifang-XIA/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Lifang-XIA/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Lifang-XIA/subscriptions",
    "organizations_url": "https://api.github.com/users/Lifang-XIA/orgs",
    "repos_url": "https://api.github.com/users/Lifang-XIA/repos",
    "events_url": "https://api.github.com/users/Lifang-XIA/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Lifang-XIA/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "b9e188dc8ba81f99bb5e07ade6545ea3acc7ff3c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b9e188dc8ba81f99bb5e07ade6545ea3acc7ff3c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/b9e188dc8ba81f99bb5e07ade6545ea3acc7ff3c"
    }
  ],
  "stats": {
    "total": 99,
    "additions": 89,
    "deletions": 10
  },
  "files": [
    {
      "sha": "65b662dd142b30a1aa590c9ab4250a36ee3d7578",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d04aee0f41da38682239b57af954bf294e26d9cb/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d04aee0f41da38682239b57af954bf294e26d9cb/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=d04aee0f41da38682239b57af954bf294e26d9cb",
      "patch": "@@ -1,3 +1,12 @@\n+2020-08-21  Cooper Qu  <cooper.qu@linux.alibaba.com>\n+\n+\t* config/tc-csky.c (CSKY_ISA_803R2): New.\n+\t(csky_archs): Add ck803r2 series.\n+\t(md_begin): Fix warning about -medsp.\n+\t(csky_get_freg_val): Support lowercase of fpu register name.\n+\t* testsuite/gas/csky/cskyv2_ck803r2.s: New file.\n+\t* testsuite/gas/csky/cskyv2_ck803r2.d: New file.\n+\n 2020-08-23  Alan Modra  <amodra@gmail.com>\n \n \tPR 26513"
    },
    {
      "sha": "d16c448f050ef7432f1a737e32432805245ed066",
      "filename": "gas/config/tc-csky.c",
      "status": "modified",
      "additions": 44,
      "deletions": 8,
      "changes": 52,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d04aee0f41da38682239b57af954bf294e26d9cb/gas/config/tc-csky.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d04aee0f41da38682239b57af954bf294e26d9cb/gas/config/tc-csky.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-csky.c?ref=d04aee0f41da38682239b57af954bf294e26d9cb",
      "patch": "@@ -604,6 +604,7 @@ const struct csky_cpu_info csky_cpus[] =\n   /* CK803 series.  */\n #define CSKY_ISA_803    (CSKY_ISA_802 | CSKYV2_ISA_2E3 | CSKY_ISA_MP)\n #define CSKY_ISA_803R1  (CSKY_ISA_803 | CSKYV2_ISA_3E3R1)\n+#define CSKY_ISA_803R2  (CSKY_ISA_803 | CSKYV2_ISA_3E3R1 | CSKYV2_ISA_3E3R2)\n #define CSKY_ISA_FLOAT_803 (CSKY_ISA_FLOAT_E1 | CSKY_ISA_FLOAT_1E3)\n   {\"ck803\", CSKY_ARCH_803, CSKY_ISA_803 },\n   {\"ck803h\", CSKY_ARCH_803, CSKY_ISA_803 },\n@@ -636,6 +637,22 @@ const struct csky_cpu_info csky_cpus[] =\n   {\"ck803eftr1\", CSKY_ARCH_803 | CSKY_ARCH_DSP | CSKY_ARCH_FLOAT, CSKY_ISA_803R1 | CSKY_ISA_DSP_ENHANCE | CSKY_ISA_FLOAT_803 | CSKY_ISA_TRUST},\n   {\"ck803ehftr1\", CSKY_ARCH_803 | CSKY_ARCH_DSP | CSKY_ARCH_FLOAT, CSKY_ISA_803R1 | CSKY_ISA_DSP_ENHANCE | CSKY_ISA_FLOAT_803 | CSKY_ISA_TRUST},\n \n+  {\"ck803r2\", CSKY_ARCH_803, CSKY_ISA_803R2},\n+  {\"ck803hr2\", CSKY_ARCH_803, CSKY_ISA_803R2},\n+  {\"ck803tr2\", CSKY_ARCH_803, CSKY_ISA_803R2 | CSKY_ISA_TRUST},\n+  {\"ck803htr2\", CSKY_ARCH_803, CSKY_ISA_803R2 | CSKY_ISA_TRUST},\n+  {\"ck803fr2\", CSKY_ARCH_803 | CSKY_ARCH_FLOAT, CSKY_ISA_803R2 | CSKY_ISA_FLOAT_803},\n+  {\"ck803fhr2\", CSKY_ARCH_803 | CSKY_ARCH_FLOAT, CSKY_ISA_803R2 | CSKY_ISA_FLOAT_803},\n+  {\"ck803er2\", CSKY_ARCH_803 | CSKY_ARCH_DSP, CSKY_ISA_803R2 | CSKY_ISA_DSP_ENHANCE},\n+  {\"ck803ehr2\", CSKY_ARCH_803 | CSKY_ARCH_DSP, CSKY_ISA_803R2 | CSKY_ISA_DSP_ENHANCE},\n+  {\"ck803etr2\", CSKY_ARCH_803 | CSKY_ARCH_DSP, CSKY_ISA_803R2 | CSKY_ISA_DSP_ENHANCE | CSKY_ISA_TRUST},\n+  {\"ck803ehtr2\", CSKY_ARCH_803 | CSKY_ARCH_DSP, CSKY_ISA_803R2 | CSKY_ISA_DSP_ENHANCE | CSKY_ISA_TRUST},\n+  {\"ck803efr2\", CSKY_ARCH_803 | CSKY_ARCH_DSP | CSKY_ARCH_FLOAT, CSKY_ISA_803R2 | CSKY_ISA_DSP_ENHANCE | CSKY_ISA_FLOAT_803},\n+  {\"ck803efhr2\", CSKY_ARCH_803 | CSKY_ARCH_DSP | CSKY_ARCH_FLOAT, CSKY_ISA_803R2 | CSKY_ISA_DSP_ENHANCE | CSKY_ISA_FLOAT_803},\n+  {\"ck803ftr2\", CSKY_ARCH_803 | CSKY_ARCH_FLOAT, CSKY_ISA_803R2 | CSKY_ISA_FLOAT_803 | CSKY_ISA_TRUST},\n+  {\"ck803eftr2\", CSKY_ARCH_803 | CSKY_ARCH_DSP | CSKY_ARCH_FLOAT, CSKY_ISA_803R2 | CSKY_ISA_DSP_ENHANCE | CSKY_ISA_FLOAT_803 | CSKY_ISA_TRUST},\n+  {\"ck803efhtr2\", CSKY_ARCH_803 | CSKY_ARCH_DSP | CSKY_ARCH_FLOAT, CSKY_ISA_803R2 | CSKY_ISA_DSP_ENHANCE | CSKY_ISA_FLOAT_803 | CSKY_ISA_TRUST},\n+\n   {\"ck803s\", CSKY_ARCH_803, CSKY_ISA_803R1 },\n   {\"ck803se\", CSKY_ARCH_803 | CSKY_ARCH_DSP, CSKY_ISA_803R1 | CSKYV2_ISA_DSP},\n   {\"ck803sj\", CSKY_ARCH_803 | CSKY_ARCH_JAVA, CSKY_ISA_803R1 | CSKY_ISA_JAVA},\n@@ -1250,16 +1267,34 @@ md_begin (void)\n     {\n       if (IS_CSKY_ARCH_803 (mach_flag))\n \t{\n-\t  /* In 803, dspv1 is conflict with dspv2. We keep dspv2.  */\n-\t  if ((dsp_flag & CSKY_DSP_FLAG_V1) && (dsp_flag & CSKY_DSP_FLAG_V2))\n-\t    as_warn (_(\"option -mdsp conflicts with -medsp, only enabling -medsp\"));\n-\t  isa_flag &= ~(CSKY_ISA_MAC_DSP | CSKY_ISA_DSP);\n-\t  isa_flag |= CSKY_ISA_DSP_ENHANCE;\n+\t  if ((dsp_flag & CSKY_DSP_FLAG_V1))\n+\t    {\n+\t      isa_flag |= (CSKY_ISA_MAC_DSP | CSKY_ISA_DSP);\n+\t      isa_flag &= ~CSKY_ISA_DSP_ENHANCE;\n+\t    }\n+\n+\t  if ((dsp_flag & CSKY_DSP_FLAG_V2))\n+\t    {\n+\t      isa_flag &= ~(CSKY_ISA_MAC_DSP | CSKY_ISA_DSP);\n+\t      isa_flag |= CSKY_ISA_DSP_ENHANCE;\n+\t    }\n+\n+\t  if ((dsp_flag & CSKY_DSP_FLAG_V1)\n+\t      && (dsp_flag & CSKY_DSP_FLAG_V2))\n+\t    {\n+\t      /* In 803, dspv1 is conflict with dspv2. We keep dspv2.  */\n+\t      as_warn (\"option -mdsp conflicts with -medsp, only enabling -medsp\");\n+\t      isa_flag &= ~(CSKY_ISA_MAC_DSP | CSKY_ISA_DSP);\n+\t      isa_flag |= CSKY_ISA_DSP_ENHANCE;\n+\t    }\n \t}\n       else\n \t{\n-\t  isa_flag &= ~CSKY_ISA_DSP_ENHANCE;\n-\t  as_warn (_(\"-medsp option is only supported by ck803s, ignoring -medsp\"));\n+\t  if (dsp_flag & CSKY_DSP_FLAG_V2)\n+\t    {\n+\t      isa_flag &= ~CSKY_ISA_DSP_ENHANCE;\n+\t      as_warn (\"-medsp option is only supported by ck803s, ignoring -medsp\");\n+\t    }\n \t}\n       ;\n     }\n@@ -2330,7 +2365,8 @@ csky_get_freg_val (char *str, int *len)\n {\n   int reg = 0;\n   char *s = NULL;\n-  if ((str[0] == 'v' || str[0] == 'f') && (str[1] == 'r'))\n+  if ((TOLOWER(str[0]) == 'v' || TOLOWER(str[0]) == 'f')\n+      && (TOLOWER(str[1]) == 'r'))\n     {\n       /* It is fpu register.  */\n       s = &str[2];"
    },
    {
      "sha": "298022aefdb7131f52846cbc39869bf8965cde51",
      "filename": "gas/testsuite/gas/csky/cskyv2_ck803r2.d",
      "status": "added",
      "additions": 12,
      "deletions": 0,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d04aee0f41da38682239b57af954bf294e26d9cb/gas/testsuite/gas/csky/cskyv2_ck803r2.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d04aee0f41da38682239b57af954bf294e26d9cb/gas/testsuite/gas/csky/cskyv2_ck803r2.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/csky/cskyv2_ck803r2.d?ref=d04aee0f41da38682239b57af954bf294e26d9cb",
      "patch": "@@ -0,0 +1,12 @@\n+# name: csky - ck803r2\n+#as: -mcpu=ck803r2\n+#objdump: -D\n+\n+.*: +file format .*csky.*\n+\n+Disassembly of section \\.text:\n+#...\n+\\s*[0-9a-f]*:\\s*e8200002\\s*bnezad\\s*r0, 0x4.*\n+#...\n+\\s*[0-9a-f]*:\\s*6c03\\s*mov\\s*r0,\\s*r0\n+\\s*[0-9a-f]*:\\s*e820fffd\\s*bnezad\\s*r0,\\s*0.*"
    },
    {
      "sha": "4c9e923e98e05d2b4e9c8d95a2f40ec4f21ffc30",
      "filename": "gas/testsuite/gas/csky/cskyv2_ck803r2.s",
      "status": "added",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d04aee0f41da38682239b57af954bf294e26d9cb/gas/testsuite/gas/csky/cskyv2_ck803r2.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d04aee0f41da38682239b57af954bf294e26d9cb/gas/testsuite/gas/csky/cskyv2_ck803r2.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/csky/cskyv2_ck803r2.s?ref=d04aee0f41da38682239b57af954bf294e26d9cb",
      "patch": "@@ -0,0 +1,6 @@\n+ck803r2:\n+   bnezad r0, hello\n+\n+hello:\n+   nop\n+   bnezad r0, ck803r2"
    },
    {
      "sha": "22bf5a4c0417a387c36c1b0e1cee499aadcdcb1a",
      "filename": "include/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d04aee0f41da38682239b57af954bf294e26d9cb/include/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d04aee0f41da38682239b57af954bf294e26d9cb/include/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ChangeLog?ref=d04aee0f41da38682239b57af954bf294e26d9cb",
      "patch": "@@ -1,3 +1,7 @@\n+2020-08-21  Cooper Qu  <cooper.qu@linux.alibaba.com>\n+\n+\t* csky.h (CSKYV2_ISA_3E3R2): New.\n+\n 2020-08-21  Mark Wielaard  <mark@klomp.org>\n \n \t* diagnostics.h (DIAGNOSTIC_IGNORE_DEPRECATED_REGISTER): Also define"
    },
    {
      "sha": "9b9dcc3289e855542ed6135820b3c80499faa24a",
      "filename": "include/opcode/csky.h",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d04aee0f41da38682239b57af954bf294e26d9cb/include/opcode/csky.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d04aee0f41da38682239b57af954bf294e26d9cb/include/opcode/csky.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/opcode/csky.h?ref=d04aee0f41da38682239b57af954bf294e26d9cb",
      "patch": "@@ -29,6 +29,7 @@\n #define CSKYV2_ISA_3E7      (1 << 4)\n #define CSKYV2_ISA_7E10     (1 << 5)\n #define CSKYV2_ISA_3E3R1    (1 << 6)\n+#define CSKYV2_ISA_3E3R2    (1 << 7)\n \n #define CSKY_ISA_TRUST      (1 << 11)\n #define CSKY_ISA_CACHE      (1 << 12)"
    },
    {
      "sha": "effcd63845faedbe55397b48d40cf94fedee54e6",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d04aee0f41da38682239b57af954bf294e26d9cb/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d04aee0f41da38682239b57af954bf294e26d9cb/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=d04aee0f41da38682239b57af954bf294e26d9cb",
      "patch": "@@ -1,3 +1,7 @@\n+2020-08-21  Cooper Qu  <cooper.qu@linux.alibaba.com>\n+\n+\t* csky-opc.h (csky_v2_opcodes): Add instruction bnezad.\n+\n 2020-08-21  Nick Clifton  <nickc@redhat.com>\n \n \t* aarch64-dis.c (get_sym_code_type): Return FALSE for non-ELF"
    },
    {
      "sha": "30894033367a6bca5d9e1241bc962adbdd6cc230",
      "filename": "opcodes/csky-opc.h",
      "status": "modified",
      "additions": 9,
      "deletions": 2,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d04aee0f41da38682239b57af954bf294e26d9cb/opcodes/csky-opc.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d04aee0f41da38682239b57af954bf294e26d9cb/opcodes/csky-opc.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/csky-opc.h?ref=d04aee0f41da38682239b57af954bf294e26d9cb",
      "patch": "@@ -4565,12 +4565,19 @@ const struct csky_opcode csky_v2_opcodes[] =\n \t       OPCODE_INFO1 (0xe8400000,\n \t\t\t     (0_15, COND16b, OPRND_SHIFT_1_BIT)),\n \t       CSKYV2_ISA_1E2),\n+#undef _RELAX\n+#undef _RELOC16\n+#define _RELAX      0\n+#define _RELOC16    0\n+    OP32 (\"bnezad\",\n+\t  OPCODE_INFO2 (0xe8200000,\n+\t\t\t(16_20, AREG, OPRND_SHIFT_0_BIT),\n+\t\t\t(0_15, COND16b, OPRND_SHIFT_1_BIT)),\n+\t  CSKYV2_ISA_3E3R2),\n #undef _RELOC16\n #undef _RELOC32\n-#undef _RELAX\n #define _RELOC16    0\n #define _RELOC32    0\n-#define _RELAX      0\n #undef _TRANSFER\n #define _TRANSFER   1\n     OP16_WITH_WORK (\"jbr\","
    }
  ]
}