{
  "sha": "db6878ac5538661c8d66c916a533bd4268217fcb",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZGI2ODc4YWM1NTM4NjYxYzhkNjZjOTE2YTUzM2JkNDI2ODIxN2ZjYg==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@efficios.com",
      "date": "2020-03-12T18:18:00Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@efficios.com",
      "date": "2020-03-12T18:18:00Z"
    },
    "message": "Move sourcing of development.sh to GDB_AC_COMMON\n\nThe same is done for gdb, gdbserver and gdbsupport.  I therefore think\nit makes sense to move that to GDB_AC_COMMON.\n\nIt is required to move the call to GDB_AC_COMMON so it is before\nGDB_AC_SELFTEST in gdbserver/configure.ac, otherwise the $development\nvariable isn't set when the code behind GDB_AC_SELFTEST executes.\n\ngdb/ChangeLog:\n\n\t* configure.ac: Don't source bfd/development.sh.\n\t* selftest.m4: Modify comment.\n\t* configure: Re-generate.\n\ngdbserver/ChangeLog:\n\n\t* configure.ac: Don't source bfd/development.sh, move\n\tGDB_AC_COMMON higher.\n\t* configure: Re-generate.\n\ngdbsupport/ChangeLog:\n\n\t* configure.ac: Don't source bfd/development.sh.\n\t* common.m4: Source bfd/development.sh.\n\t* configure: Re-generate.",
    "tree": {
      "sha": "1f0b30bbbff5a962e890827730014bbcfdc573e5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/1f0b30bbbff5a962e890827730014bbcfdc573e5"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/db6878ac5538661c8d66c916a533bd4268217fcb",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/db6878ac5538661c8d66c916a533bd4268217fcb",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/db6878ac5538661c8d66c916a533bd4268217fcb",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/db6878ac5538661c8d66c916a533bd4268217fcb/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "4d696a5c686730d75623d7e41805e42ce5fcc60c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4d696a5c686730d75623d7e41805e42ce5fcc60c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/4d696a5c686730d75623d7e41805e42ce5fcc60c"
    }
  ],
  "stats": {
    "total": 1340,
    "additions": 678,
    "deletions": 662
  },
  "files": [
    {
      "sha": "eef1e6492cec68526ec7c5edcba8330b7edd5ebe",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -1,3 +1,9 @@\n+2020-03-12  Simon Marchi  <simon.marchi@efficios.com>\n+\n+\t* configure.ac: Don't source bfd/development.sh.\n+\t* selftest.m4: Modify comment.\n+\t* configure: Re-generate.\n+\n 2020-03-12  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* selftest.m4 (GDB_AC_SELFTEST): Error out if $development is"
    },
    {
      "sha": "f690cf86078dd087aaa39aa9e082724a2e1230a7",
      "filename": "gdb/configure",
      "status": "modified",
      "additions": 5,
      "deletions": 4,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdb/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdb/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -2988,9 +2988,6 @@ fi\n \n \n \n-# Set the 'development' global.\n-. $srcdir/../bfd/development.sh\n-\n ac_ext=c\n ac_cpp='$CPP $CPPFLAGS'\n ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n@@ -12434,6 +12431,9 @@ $as_echo \"$ac_cv_path_SED\" >&6; }\n   rm -f conftest.sed\n \n \n+  # Set the 'development' global.\n+  . $srcdir/../bfd/development.sh\n+\n   { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for ANSI C header files\" >&5\n $as_echo_n \"checking for ANSI C header files... \" >&6; }\n if ${ac_cv_header_stdc+:} false; then :\n@@ -19186,7 +19186,8 @@ $as_echo \"#define GDB_DEFAULT_HOST_CHARSET \\\"UTF-8\\\"\" >>confdefs.h\n #\n # The default value of this option changes depending whether we're on\n # development mode (in which case it's \"true\") or not (in which case\n-# it's \"false\").\n+# it's \"false\").  The $development variable is set by the GDB_AC_COMMON\n+# macro, which must therefore be used before GDB_AC_SELFTEST.\n \n if test \"x$development\" != xtrue && test \"x$development\" != xfalse; then :\n   as_fn_error $? \"Invalid value for \\$development, got \\\"$development\\\", expecting \\\"true\\\" or \\\"false\\\".\" \"$LINENO\" 5"
    },
    {
      "sha": "76c396c6ebc07df411518fcee7397553680c9488",
      "filename": "gdb/configure.ac",
      "status": "modified",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdb/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdb/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/configure.ac?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -24,9 +24,6 @@ AC_INIT(main.c)\n AC_CONFIG_HEADERS(config.h:config.in, [echo > stamp-h])\n AM_MAINTAINER_MODE\n \n-# Set the 'development' global.\n-. $srcdir/../bfd/development.sh\n-\n AC_PROG_CC\n AC_PROG_CXX\n "
    },
    {
      "sha": "3624f25f24ea41f50c3c1a549389286e2b14fb5c",
      "filename": "gdb/selftest.m4",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdb/selftest.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdb/selftest.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/selftest.m4?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -26,7 +26,8 @@ AC_DEFUN([GDB_AC_SELFTEST],[\n #\n # The default value of this option changes depending whether we're on\n # development mode (in which case it's \"true\") or not (in which case\n-# it's \"false\").\n+# it's \"false\").  The $development variable is set by the GDB_AC_COMMON\n+# macro, which must therefore be used before GDB_AC_SELFTEST.\n \n AS_IF([test \"x$development\" != xtrue && test \"x$development\" != xfalse],\n   [AC_MSG_ERROR([Invalid value for \\$development, got \"$development\", expecting \"true\" or \"false\".])])"
    },
    {
      "sha": "1cf8ddfa1b4cac7d153fe97ff83a6d047bf6f9ff",
      "filename": "gdbserver/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/ChangeLog?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -1,3 +1,9 @@\n+2020-03-12  Simon Marchi  <simon.marchi@efficios.com>\n+\n+\t* configure.ac: Don't source bfd/development.sh, move\n+\tGDB_AC_COMMON higher.\n+\t* configure: Re-generate.\n+\n 2020-03-12  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* configure: Re-generate."
    },
    {
      "sha": "7fa9ac925e51abc9582b229a1ad664b88dd6b000",
      "filename": "gdbserver/configure",
      "status": "modified",
      "additions": 644,
      "deletions": 643,
      "changes": 1287,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdbserver/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdbserver/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -637,6 +637,12 @@ WERROR_CFLAGS\n WARN_CFLAGS\n ustinc\n ustlibs\n+CCDEPMODE\n+CONFIG_SRC_SUBDIR\n+DEPDIR\n+am__leading_dot\n+host_noncanonical\n+target_noncanonical\n LTLIBIPT\n LIBIPT\n HAVE_LIBIPT\n@@ -646,12 +652,6 @@ PTHREAD_CC\n ax_pthread_config\n SED\n ALLOCA\n-CCDEPMODE\n-CONFIG_SRC_SUBDIR\n-DEPDIR\n-am__leading_dot\n-host_noncanonical\n-target_noncanonical\n CXX_DIALECT\n HAVE_CXX11\n RANLIB\n@@ -733,12 +733,12 @@ ac_user_opts='\n enable_option_checking\n enable_maintainer_mode\n enable_largefile\n-enable_unit_tests\n with_intel_pt\n with_gnu_ld\n enable_rpath\n with_libipt_prefix\n with_libipt_type\n+enable_unit_tests\n with_ust\n with_ust_include\n with_ust_lib\n@@ -1383,9 +1383,9 @@ Optional Features:\n                           enable make rules and dependencies not useful (and\n                           sometimes confusing) to the casual installer\n   --disable-largefile     omit support for large files\n+  --disable-rpath         do not hardcode runtime library paths\n   --enable-unit-tests     Enable the inclusion of unit tests when compiling\n                           GDB\n-  --disable-rpath         do not hardcode runtime library paths\n   --enable-werror         treat compile warnings as errors\n   --enable-build-warnings enable build-time compiler warnings if gcc is used\n   --enable-gdb-build-warnings\n@@ -6073,551 +6073,135 @@ $as_echo \"#define STDC_HEADERS 1\" >>confdefs.h\n fi\n \n \n-# Set the 'development' global.\n-. $srcdir/../bfd/development.sh\n-\n+ac_fn_c_check_type \"$LINENO\" \"size_t\" \"ac_cv_type_size_t\" \"$ac_includes_default\"\n+if test \"x$ac_cv_type_size_t\" = xyes; then :\n \n-# Check whether we will enable the inclusion of unit tests when\n-# compiling GDB.\n-#\n-# The default value of this option changes depending whether we're on\n-# development mode (in which case it's \"true\") or not (in which case\n-# it's \"false\").\n+else\n \n-if test \"x$development\" != xtrue && test \"x$development\" != xfalse; then :\n-  as_fn_error $? \"Invalid value for \\$development, got \\\"$development\\\", expecting \\\"true\\\" or \\\"false\\\".\" \"$LINENO\" 5\n-fi\n+cat >>confdefs.h <<_ACEOF\n+#define size_t unsigned int\n+_ACEOF\n \n-# Check whether --enable-unit-tests was given.\n-if test \"${enable_unit_tests+set}\" = set; then :\n-  enableval=$enable_unit_tests; case \"${enableval}\" in\n-  yes)  enable_unittests=true  ;;\n-  no)   enable_unittests=false ;;\n-  *)    as_fn_error $? \"bad value ${enableval} for --{enable,disable}-unit-tests option\" \"$LINENO\" 5 ;;\n-esac\n-else\n-  enable_unittests=$development\n fi\n \n \n-if $enable_unittests; then\n-\n-$as_echo \"#define GDB_SELF_TEST 1\" >>confdefs.h\n \n \n-  srv_selftest_objs=\"gdbsupport/selftest.o\"\n+  for ac_header in $ac_header_list\n+do :\n+  as_ac_Header=`$as_echo \"ac_cv_header_$ac_header\" | $as_tr_sh`\n+ac_fn_c_check_header_compile \"$LINENO\" \"$ac_header\" \"$as_ac_Header\" \"$ac_includes_default\n+\"\n+if eval test \\\"x\\$\"$as_ac_Header\"\\\" = x\"yes\"; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define `$as_echo \"HAVE_$ac_header\" | $as_tr_cpp` 1\n+_ACEOF\n \n fi\n \n+done\n \n- case ${build_alias} in\n-  \"\") build_noncanonical=${build} ;;\n-  *) build_noncanonical=${build_alias} ;;\n-esac\n-\n- case ${host_alias} in\n-  \"\") host_noncanonical=${build_noncanonical} ;;\n-  *) host_noncanonical=${host_alias} ;;\n-esac\n \n- case ${target_alias} in\n-  \"\") target_noncanonical=${host_noncanonical} ;;\n-  *) target_noncanonical=${target_alias} ;;\n-esac\n \n \n \n \n \n+ac_fn_c_check_type \"$LINENO\" \"pid_t\" \"ac_cv_type_pid_t\" \"$ac_includes_default\"\n+if test \"x$ac_cv_type_pid_t\" = xyes; then :\n \n-# Dependency checking.\n-rm -rf .tst 2>/dev/null\n-mkdir .tst 2>/dev/null\n-if test -d .tst; then\n-  am__leading_dot=.\n else\n-  am__leading_dot=_\n-fi\n-rmdir .tst 2>/dev/null\n-\n-DEPDIR=\"${am__leading_dot}deps\"\n-\n-ac_config_commands=\"$ac_config_commands depdir\"\n-\n-\n-\n-# Create sub-directories for objects and dependencies.\n-CONFIG_SRC_SUBDIR=\"arch gdbsupport nat target\"\n-\n-\n-ac_config_commands=\"$ac_config_commands gdbdepdir\"\n \n+cat >>confdefs.h <<_ACEOF\n+#define pid_t int\n+_ACEOF\n \n-depcc=\"$CC\"   am_compiler_list=\n+fi\n \n-am_depcomp=$ac_aux_dir/depcomp\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking dependency style of $depcc\" >&5\n-$as_echo_n \"checking dependency style of $depcc... \" >&6; }\n-if ${am_cv_CC_dependencies_compiler_type+:} false; then :\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for a sed that does not truncate output\" >&5\n+$as_echo_n \"checking for a sed that does not truncate output... \" >&6; }\n+if ${ac_cv_path_SED+:} false; then :\n   $as_echo_n \"(cached) \" >&6\n else\n-  if test -f \"$am_depcomp\"; then\n-  # We make a subdir and do the tests there.  Otherwise we can end up\n-  # making bogus files that we don't know about and never remove.  For\n-  # instance it was reported that on HP-UX the gcc test will end up\n-  # making a dummy file named `D' -- because `-MD' means `put the output\n-  # in D'.\n-  mkdir conftest.dir\n-  # Copy depcomp to subdir because otherwise we won't find it if we're\n-  # using a relative directory.\n-  cp \"$am_depcomp\" conftest.dir\n-  cd conftest.dir\n-  # We will build objects and dependencies in a subdirectory because\n-  # it helps to detect inapplicable dependency modes.  For instance\n-  # both Tru64's cc and ICC support -MD to output dependencies as a\n-  # side effect of compilation, but ICC will put the dependencies in\n-  # the current directory while Tru64 will put them in the object\n-  # directory.\n-  mkdir sub\n-\n-  am_cv_CC_dependencies_compiler_type=none\n-  if test \"$am_compiler_list\" = \"\"; then\n-     am_compiler_list=`sed -n 's/^\\([a-zA-Z0-9]*\\))$/\\1/p' < ./depcomp`\n-  fi\n-  for depmode in $am_compiler_list; do\n-    if test $depmode = none; then break; fi\n-\n-    $as_echo \"$as_me:$LINENO: trying $depmode\" >&5\n-    # Setup a source with many dependencies, because some compilers\n-    # like to wrap large dependency lists on column 80 (with \\), and\n-    # we should not choose a depcomp mode which is confused by this.\n-    #\n-    # We need to recreate these files for each test, as the compiler may\n-    # overwrite some of them when testing with obscure command lines.\n-    # This happens at least with the AIX C compiler.\n-    : > sub/conftest.c\n-    for i in 1 2 3 4 5 6; do\n-      echo '#include \"conftst'$i'.h\"' >> sub/conftest.c\n-      # Using `: > sub/conftst$i.h' creates only sub/conftst1.h with\n-      # Solaris 8's {/usr,}/bin/sh.\n-      touch sub/conftst$i.h\n-    done\n-    echo \"include sub/conftest.Po\" > confmf\n-\n-    # We check with `-c' and `-o' for the sake of the \"dashmstdout\"\n-    # mode.  It turns out that the SunPro C++ compiler does not properly\n-    # handle `-M -o', and we need to detect this.\n-    depcmd=\"depmode=$depmode \\\n-       source=sub/conftest.c object=sub/conftest.${OBJEXT-o} \\\n-       depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \\\n-       $SHELL ./depcomp $depcc -c -o sub/conftest.${OBJEXT-o} sub/conftest.c\"\n-    echo \"| $depcmd\" | sed -e 's/  */ /g' >&5\n-    if env $depcmd > conftest.err 2>&1 &&\n-       grep sub/conftst6.h sub/conftest.Po >>conftest.err 2>&1 &&\n-       grep sub/conftest.${OBJEXT-o} sub/conftest.Po >>conftest.err 2>&1 &&\n-       ${MAKE-make} -s -f confmf >>conftest.err 2>&1; then\n-      # icc doesn't choke on unknown options, it will just issue warnings\n-      # or remarks (even with -Werror).  So we grep stderr for any message\n-      # that says an option was ignored or not supported.\n-      # When given -MP, icc 7.0 and 7.1 complain thusly:\n-      #   icc: Command line warning: ignoring option '-M'; no argument required\n-      # The diagnosis changed in icc 8.0:\n-      #   icc: Command line remark: option '-MP' not supported\n-      if (grep 'ignoring option' conftest.err ||\n-          grep 'not supported' conftest.err) >/dev/null 2>&1; then :; else\n-        am_cv_CC_dependencies_compiler_type=$depmode\n-\t$as_echo \"$as_me:$LINENO: success\" >&5\n-        break\n-      fi\n+            ac_script=s/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa/bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb/\n+     for ac_i in 1 2 3 4 5 6 7; do\n+       ac_script=\"$ac_script$as_nl$ac_script\"\n+     done\n+     echo \"$ac_script\" 2>/dev/null | sed 99q >conftest.sed\n+     { ac_script=; unset ac_script;}\n+     if test -z \"$SED\"; then\n+  ac_path_SED_found=false\n+  # Loop through the user's path and test for each of PROGNAME-LIST\n+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR\n+for as_dir in $PATH\n+do\n+  IFS=$as_save_IFS\n+  test -z \"$as_dir\" && as_dir=.\n+    for ac_prog in sed gsed; do\n+    for ac_exec_ext in '' $ac_executable_extensions; do\n+      ac_path_SED=\"$as_dir/$ac_prog$ac_exec_ext\"\n+      as_fn_executable_p \"$ac_path_SED\" || continue\n+# Check for GNU ac_path_SED and select it if it is found.\n+  # Check for GNU $ac_path_SED\n+case `\"$ac_path_SED\" --version 2>&1` in\n+*GNU*)\n+  ac_cv_path_SED=\"$ac_path_SED\" ac_path_SED_found=:;;\n+*)\n+  ac_count=0\n+  $as_echo_n 0123456789 >\"conftest.in\"\n+  while :\n+  do\n+    cat \"conftest.in\" \"conftest.in\" >\"conftest.tmp\"\n+    mv \"conftest.tmp\" \"conftest.in\"\n+    cp \"conftest.in\" \"conftest.nl\"\n+    $as_echo '' >> \"conftest.nl\"\n+    \"$ac_path_SED\" -f conftest.sed < \"conftest.nl\" >\"conftest.out\" 2>/dev/null || break\n+    diff \"conftest.out\" \"conftest.nl\" >/dev/null 2>&1 || break\n+    as_fn_arith $ac_count + 1 && ac_count=$as_val\n+    if test $ac_count -gt ${ac_path_SED_max-0}; then\n+      # Best one so far, save it but keep looking for a better one\n+      ac_cv_path_SED=\"$ac_path_SED\"\n+      ac_path_SED_max=$ac_count\n     fi\n-    $as_echo \"$as_me:$LINENO: failure, diagnostics are:\" >&5\n-    sed -e 's/^/| /' < conftest.err >&5\n+    # 10*(2^10) chars as input seems more than enough\n+    test $ac_count -gt 10 && break\n   done\n+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;\n+esac\n \n-  cd ..\n-  rm -rf conftest.dir\n+      $ac_path_SED_found && break 3\n+    done\n+  done\n+  done\n+IFS=$as_save_IFS\n+  if test -z \"$ac_cv_path_SED\"; then\n+    as_fn_error $? \"no acceptable sed could be found in \\$PATH\" \"$LINENO\" 5\n+  fi\n else\n-  am_cv_CC_dependencies_compiler_type=none\n+  ac_cv_path_SED=$SED\n fi\n \n fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $am_cv_CC_dependencies_compiler_type\" >&5\n-$as_echo \"$am_cv_CC_dependencies_compiler_type\" >&6; }\n-if test x${am_cv_CC_dependencies_compiler_type-none} = xnone\n-then as_fn_error $? \"no usable dependency style found\" \"$LINENO\" 5\n-else CCDEPMODE=depmode=$am_cv_CC_dependencies_compiler_type\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_SED\" >&5\n+$as_echo \"$ac_cv_path_SED\" >&6; }\n+ SED=\"$ac_cv_path_SED\"\n+  rm -f conftest.sed\n \n-fi\n-\n-\n-for ac_header in termios.h sys/reg.h string.h \t\t sys/procfs.h linux/elf.h \t\t fcntl.h signal.h sys/file.h \t\t sys/ioctl.h netinet/in.h sys/socket.h netdb.h \t\t netinet/tcp.h arpa/inet.h\n-do :\n-  as_ac_Header=`$as_echo \"ac_cv_header_$ac_header\" | $as_tr_sh`\n-ac_fn_c_check_header_mongrel \"$LINENO\" \"$ac_header\" \"$as_ac_Header\" \"$ac_includes_default\"\n-if eval test \\\"x\\$\"$as_ac_Header\"\\\" = x\"yes\"; then :\n-  cat >>confdefs.h <<_ACEOF\n-#define `$as_echo \"HAVE_$ac_header\" | $as_tr_cpp` 1\n-_ACEOF\n-\n-fi\n-\n-done\n-\n-ac_fn_c_check_type \"$LINENO\" \"pid_t\" \"ac_cv_type_pid_t\" \"$ac_includes_default\"\n-if test \"x$ac_cv_type_pid_t\" = xyes; then :\n-\n-else\n-\n-cat >>confdefs.h <<_ACEOF\n-#define pid_t int\n-_ACEOF\n-\n-fi\n-\n-for ac_header in vfork.h\n-do :\n-  ac_fn_c_check_header_mongrel \"$LINENO\" \"vfork.h\" \"ac_cv_header_vfork_h\" \"$ac_includes_default\"\n-if test \"x$ac_cv_header_vfork_h\" = xyes; then :\n-  cat >>confdefs.h <<_ACEOF\n-#define HAVE_VFORK_H 1\n-_ACEOF\n-\n-fi\n-\n-done\n-\n-for ac_func in fork vfork\n-do :\n-  as_ac_var=`$as_echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n-ac_fn_c_check_func \"$LINENO\" \"$ac_func\" \"$as_ac_var\"\n-if eval test \\\"x\\$\"$as_ac_var\"\\\" = x\"yes\"; then :\n-  cat >>confdefs.h <<_ACEOF\n-#define `$as_echo \"HAVE_$ac_func\" | $as_tr_cpp` 1\n-_ACEOF\n-\n-fi\n-done\n-\n-if test \"x$ac_cv_func_fork\" = xyes; then\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for working fork\" >&5\n-$as_echo_n \"checking for working fork... \" >&6; }\n-if ${ac_cv_func_fork_works+:} false; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  if test \"$cross_compiling\" = yes; then :\n-  ac_cv_func_fork_works=cross\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-$ac_includes_default\n-int\n-main ()\n-{\n-\n-\t  /* By Ruediger Kuhlmann. */\n-\t  return fork () < 0;\n-\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-if ac_fn_c_try_run \"$LINENO\"; then :\n-  ac_cv_func_fork_works=yes\n-else\n-  ac_cv_func_fork_works=no\n-fi\n-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n-  conftest.$ac_objext conftest.beam conftest.$ac_ext\n-fi\n-\n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_fork_works\" >&5\n-$as_echo \"$ac_cv_func_fork_works\" >&6; }\n-\n-else\n-  ac_cv_func_fork_works=$ac_cv_func_fork\n-fi\n-if test \"x$ac_cv_func_fork_works\" = xcross; then\n-  case $host in\n-    *-*-amigaos* | *-*-msdosdjgpp*)\n-      # Override, as these systems have only a dummy fork() stub\n-      ac_cv_func_fork_works=no\n-      ;;\n-    *)\n-      ac_cv_func_fork_works=yes\n-      ;;\n-  esac\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: WARNING: result $ac_cv_func_fork_works guessed because of cross compilation\" >&5\n-$as_echo \"$as_me: WARNING: result $ac_cv_func_fork_works guessed because of cross compilation\" >&2;}\n-fi\n-ac_cv_func_vfork_works=$ac_cv_func_vfork\n-if test \"x$ac_cv_func_vfork\" = xyes; then\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for working vfork\" >&5\n-$as_echo_n \"checking for working vfork... \" >&6; }\n-if ${ac_cv_func_vfork_works+:} false; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  if test \"$cross_compiling\" = yes; then :\n-  ac_cv_func_vfork_works=cross\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-/* Thanks to Paul Eggert for this test.  */\n-$ac_includes_default\n-#include <sys/wait.h>\n-#ifdef HAVE_VFORK_H\n-# include <vfork.h>\n-#endif\n-/* On some sparc systems, changes by the child to local and incoming\n-   argument registers are propagated back to the parent.  The compiler\n-   is told about this with #include <vfork.h>, but some compilers\n-   (e.g. gcc -O) don't grok <vfork.h>.  Test for this by using a\n-   static variable whose address is put into a register that is\n-   clobbered by the vfork.  */\n-static void\n-#ifdef __cplusplus\n-sparc_address_test (int arg)\n-# else\n-sparc_address_test (arg) int arg;\n-#endif\n-{\n-  static pid_t child;\n-  if (!child) {\n-    child = vfork ();\n-    if (child < 0) {\n-      perror (\"vfork\");\n-      _exit(2);\n-    }\n-    if (!child) {\n-      arg = getpid();\n-      write(-1, \"\", 0);\n-      _exit (arg);\n-    }\n-  }\n-}\n-\n-int\n-main ()\n-{\n-  pid_t parent = getpid ();\n-  pid_t child;\n-\n-  sparc_address_test (0);\n-\n-  child = vfork ();\n-\n-  if (child == 0) {\n-    /* Here is another test for sparc vfork register problems.  This\n-       test uses lots of local variables, at least as many local\n-       variables as main has allocated so far including compiler\n-       temporaries.  4 locals are enough for gcc 1.40.3 on a Solaris\n-       4.1.3 sparc, but we use 8 to be safe.  A buggy compiler should\n-       reuse the register of parent for one of the local variables,\n-       since it will think that parent can't possibly be used any more\n-       in this routine.  Assigning to the local variable will thus\n-       munge parent in the parent process.  */\n-    pid_t\n-      p = getpid(), p1 = getpid(), p2 = getpid(), p3 = getpid(),\n-      p4 = getpid(), p5 = getpid(), p6 = getpid(), p7 = getpid();\n-    /* Convince the compiler that p..p7 are live; otherwise, it might\n-       use the same hardware register for all 8 local variables.  */\n-    if (p != p1 || p != p2 || p != p3 || p != p4\n-\t|| p != p5 || p != p6 || p != p7)\n-      _exit(1);\n-\n-    /* On some systems (e.g. IRIX 3.3), vfork doesn't separate parent\n-       from child file descriptors.  If the child closes a descriptor\n-       before it execs or exits, this munges the parent's descriptor\n-       as well.  Test for this by closing stdout in the child.  */\n-    _exit(close(fileno(stdout)) != 0);\n-  } else {\n-    int status;\n-    struct stat st;\n-\n-    while (wait(&status) != child)\n-      ;\n-    return (\n-\t /* Was there some problem with vforking?  */\n-\t child < 0\n-\n-\t /* Did the child fail?  (This shouldn't happen.)  */\n-\t || status\n-\n-\t /* Did the vfork/compiler bug occur?  */\n-\t || parent != getpid()\n-\n-\t /* Did the file descriptor bug occur?  */\n-\t || fstat(fileno(stdout), &st) != 0\n-\t );\n-  }\n-}\n-_ACEOF\n-if ac_fn_c_try_run \"$LINENO\"; then :\n-  ac_cv_func_vfork_works=yes\n-else\n-  ac_cv_func_vfork_works=no\n-fi\n-rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n-  conftest.$ac_objext conftest.beam conftest.$ac_ext\n-fi\n-\n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_vfork_works\" >&5\n-$as_echo \"$ac_cv_func_vfork_works\" >&6; }\n-\n-fi;\n-if test \"x$ac_cv_func_fork_works\" = xcross; then\n-  ac_cv_func_vfork_works=$ac_cv_func_vfork\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: WARNING: result $ac_cv_func_vfork_works guessed because of cross compilation\" >&5\n-$as_echo \"$as_me: WARNING: result $ac_cv_func_vfork_works guessed because of cross compilation\" >&2;}\n-fi\n-\n-if test \"x$ac_cv_func_vfork_works\" = xyes; then\n-\n-$as_echo \"#define HAVE_WORKING_VFORK 1\" >>confdefs.h\n-\n-else\n-\n-$as_echo \"#define vfork fork\" >>confdefs.h\n-\n-fi\n-if test \"x$ac_cv_func_fork_works\" = xyes; then\n-\n-$as_echo \"#define HAVE_WORKING_FORK 1\" >>confdefs.h\n-\n-fi\n-\n-for ac_func in pread pwrite pread64\n-do :\n-  as_ac_var=`$as_echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n-ac_fn_c_check_func \"$LINENO\" \"$ac_func\" \"$as_ac_var\"\n-if eval test \\\"x\\$\"$as_ac_var\"\\\" = x\"yes\"; then :\n-  cat >>confdefs.h <<_ACEOF\n-#define `$as_echo \"HAVE_$ac_func\" | $as_tr_cpp` 1\n-_ACEOF\n-\n-fi\n-done\n-\n-\n-ac_fn_c_check_type \"$LINENO\" \"size_t\" \"ac_cv_type_size_t\" \"$ac_includes_default\"\n-if test \"x$ac_cv_type_size_t\" = xyes; then :\n-\n-else\n-\n-cat >>confdefs.h <<_ACEOF\n-#define size_t unsigned int\n-_ACEOF\n-\n-fi\n \n-\n-\n-\n-  for ac_header in $ac_header_list\n-do :\n-  as_ac_Header=`$as_echo \"ac_cv_header_$ac_header\" | $as_tr_sh`\n-ac_fn_c_check_header_compile \"$LINENO\" \"$ac_header\" \"$as_ac_Header\" \"$ac_includes_default\n-\"\n-if eval test \\\"x\\$\"$as_ac_Header\"\\\" = x\"yes\"; then :\n-  cat >>confdefs.h <<_ACEOF\n-#define `$as_echo \"HAVE_$ac_header\" | $as_tr_cpp` 1\n-_ACEOF\n-\n-fi\n-\n-done\n-\n-\n-\n-\n-\n-\n-\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for a sed that does not truncate output\" >&5\n-$as_echo_n \"checking for a sed that does not truncate output... \" >&6; }\n-if ${ac_cv_path_SED+:} false; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-            ac_script=s/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa/bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb/\n-     for ac_i in 1 2 3 4 5 6 7; do\n-       ac_script=\"$ac_script$as_nl$ac_script\"\n-     done\n-     echo \"$ac_script\" 2>/dev/null | sed 99q >conftest.sed\n-     { ac_script=; unset ac_script;}\n-     if test -z \"$SED\"; then\n-  ac_path_SED_found=false\n-  # Loop through the user's path and test for each of PROGNAME-LIST\n-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR\n-for as_dir in $PATH\n-do\n-  IFS=$as_save_IFS\n-  test -z \"$as_dir\" && as_dir=.\n-    for ac_prog in sed gsed; do\n-    for ac_exec_ext in '' $ac_executable_extensions; do\n-      ac_path_SED=\"$as_dir/$ac_prog$ac_exec_ext\"\n-      as_fn_executable_p \"$ac_path_SED\" || continue\n-# Check for GNU ac_path_SED and select it if it is found.\n-  # Check for GNU $ac_path_SED\n-case `\"$ac_path_SED\" --version 2>&1` in\n-*GNU*)\n-  ac_cv_path_SED=\"$ac_path_SED\" ac_path_SED_found=:;;\n-*)\n-  ac_count=0\n-  $as_echo_n 0123456789 >\"conftest.in\"\n-  while :\n-  do\n-    cat \"conftest.in\" \"conftest.in\" >\"conftest.tmp\"\n-    mv \"conftest.tmp\" \"conftest.in\"\n-    cp \"conftest.in\" \"conftest.nl\"\n-    $as_echo '' >> \"conftest.nl\"\n-    \"$ac_path_SED\" -f conftest.sed < \"conftest.nl\" >\"conftest.out\" 2>/dev/null || break\n-    diff \"conftest.out\" \"conftest.nl\" >/dev/null 2>&1 || break\n-    as_fn_arith $ac_count + 1 && ac_count=$as_val\n-    if test $ac_count -gt ${ac_path_SED_max-0}; then\n-      # Best one so far, save it but keep looking for a better one\n-      ac_cv_path_SED=\"$ac_path_SED\"\n-      ac_path_SED_max=$ac_count\n-    fi\n-    # 10*(2^10) chars as input seems more than enough\n-    test $ac_count -gt 10 && break\n-  done\n-  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;\n-esac\n-\n-      $ac_path_SED_found && break 3\n-    done\n-  done\n-  done\n-IFS=$as_save_IFS\n-  if test -z \"$ac_cv_path_SED\"; then\n-    as_fn_error $? \"no acceptable sed could be found in \\$PATH\" \"$LINENO\" 5\n-  fi\n-else\n-  ac_cv_path_SED=$SED\n-fi\n-\n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_SED\" >&5\n-$as_echo \"$ac_cv_path_SED\" >&6; }\n- SED=\"$ac_cv_path_SED\"\n-  rm -f conftest.sed\n-\n-\n-      if test \"X$prefix\" = \"XNONE\"; then\n-    acl_final_prefix=\"$ac_default_prefix\"\n-  else\n-    acl_final_prefix=\"$prefix\"\n-  fi\n-  if test \"X$exec_prefix\" = \"XNONE\"; then\n-    acl_final_exec_prefix='${prefix}'\n-  else\n-    acl_final_exec_prefix=\"$exec_prefix\"\n-  fi\n-  acl_save_prefix=\"$prefix\"\n-  prefix=\"$acl_final_prefix\"\n-  eval acl_final_exec_prefix=\\\"$acl_final_exec_prefix\\\"\n-  prefix=\"$acl_save_prefix\"\n+      if test \"X$prefix\" = \"XNONE\"; then\n+    acl_final_prefix=\"$ac_default_prefix\"\n+  else\n+    acl_final_prefix=\"$prefix\"\n+  fi\n+  if test \"X$exec_prefix\" = \"XNONE\"; then\n+    acl_final_exec_prefix='${prefix}'\n+  else\n+    acl_final_exec_prefix=\"$exec_prefix\"\n+  fi\n+  acl_save_prefix=\"$prefix\"\n+  prefix=\"$acl_final_prefix\"\n+  eval acl_final_exec_prefix=\\\"$acl_final_exec_prefix\\\"\n+  prefix=\"$acl_save_prefix\"\n \n \n # Check whether --with-gnu-ld was given.\n@@ -6762,6 +6346,9 @@ fi\n \n \n \n+  # Set the 'development' global.\n+  . $srcdir/../bfd/development.sh\n+\n   { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for ANSI C header files\" >&5\n $as_echo_n \"checking for ANSI C header files... \" >&6; }\n if ${ac_cv_header_stdc+:} false; then :\n@@ -9061,25 +8648,173 @@ fpregset_t avar\n }\n _ACEOF\n if ac_fn_c_try_compile \"$LINENO\"; then :\n-  bfd_cv_have_sys_procfs_type_fpregset_t=yes\n+  bfd_cv_have_sys_procfs_type_fpregset_t=yes\n+else\n+  bfd_cv_have_sys_procfs_type_fpregset_t=no\n+\n+fi\n+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+\n+ if test $bfd_cv_have_sys_procfs_type_fpregset_t = yes; then\n+\n+$as_echo \"#define HAVE_FPREGSET_T 1\" >>confdefs.h\n+\n+ fi\n+ { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_fpregset_t\" >&5\n+$as_echo \"$bfd_cv_have_sys_procfs_type_fpregset_t\" >&6; }\n+\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for prgregset_t in sys/procfs.h\" >&5\n+$as_echo_n \"checking for prgregset_t in sys/procfs.h... \" >&6; }\n+ if ${bfd_cv_have_sys_procfs_type_prgregset_t+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#define _SYSCALL32\n+/* Needed for new procfs interface on sparc-solaris.  */\n+#define _STRUCTURED_PROC 1\n+#include <sys/procfs.h>\n+int\n+main ()\n+{\n+prgregset_t avar\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_compile \"$LINENO\"; then :\n+  bfd_cv_have_sys_procfs_type_prgregset_t=yes\n+else\n+  bfd_cv_have_sys_procfs_type_prgregset_t=no\n+\n+fi\n+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+\n+ if test $bfd_cv_have_sys_procfs_type_prgregset_t = yes; then\n+\n+$as_echo \"#define HAVE_PRGREGSET_T 1\" >>confdefs.h\n+\n+ fi\n+ { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_prgregset_t\" >&5\n+$as_echo \"$bfd_cv_have_sys_procfs_type_prgregset_t\" >&6; }\n+\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for prfpregset_t in sys/procfs.h\" >&5\n+$as_echo_n \"checking for prfpregset_t in sys/procfs.h... \" >&6; }\n+ if ${bfd_cv_have_sys_procfs_type_prfpregset_t+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#define _SYSCALL32\n+/* Needed for new procfs interface on sparc-solaris.  */\n+#define _STRUCTURED_PROC 1\n+#include <sys/procfs.h>\n+int\n+main ()\n+{\n+prfpregset_t avar\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_compile \"$LINENO\"; then :\n+  bfd_cv_have_sys_procfs_type_prfpregset_t=yes\n+else\n+  bfd_cv_have_sys_procfs_type_prfpregset_t=no\n+\n+fi\n+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+\n+ if test $bfd_cv_have_sys_procfs_type_prfpregset_t = yes; then\n+\n+$as_echo \"#define HAVE_PRFPREGSET_T 1\" >>confdefs.h\n+\n+ fi\n+ { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_prfpregset_t\" >&5\n+$as_echo \"$bfd_cv_have_sys_procfs_type_prfpregset_t\" >&6; }\n+\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for prgregset32_t in sys/procfs.h\" >&5\n+$as_echo_n \"checking for prgregset32_t in sys/procfs.h... \" >&6; }\n+ if ${bfd_cv_have_sys_procfs_type_prgregset32_t+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#define _SYSCALL32\n+/* Needed for new procfs interface on sparc-solaris.  */\n+#define _STRUCTURED_PROC 1\n+#include <sys/procfs.h>\n+int\n+main ()\n+{\n+prgregset32_t avar\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_compile \"$LINENO\"; then :\n+  bfd_cv_have_sys_procfs_type_prgregset32_t=yes\n+else\n+  bfd_cv_have_sys_procfs_type_prgregset32_t=no\n+\n+fi\n+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+\n+ if test $bfd_cv_have_sys_procfs_type_prgregset32_t = yes; then\n+\n+$as_echo \"#define HAVE_PRGREGSET32_T 1\" >>confdefs.h\n+\n+ fi\n+ { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_prgregset32_t\" >&5\n+$as_echo \"$bfd_cv_have_sys_procfs_type_prgregset32_t\" >&6; }\n+\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for lwpid_t in sys/procfs.h\" >&5\n+$as_echo_n \"checking for lwpid_t in sys/procfs.h... \" >&6; }\n+ if ${bfd_cv_have_sys_procfs_type_lwpid_t+:} false; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+\n+#define _SYSCALL32\n+/* Needed for new procfs interface on sparc-solaris.  */\n+#define _STRUCTURED_PROC 1\n+#include <sys/procfs.h>\n+int\n+main ()\n+{\n+lwpid_t avar\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_compile \"$LINENO\"; then :\n+  bfd_cv_have_sys_procfs_type_lwpid_t=yes\n else\n-  bfd_cv_have_sys_procfs_type_fpregset_t=no\n+  bfd_cv_have_sys_procfs_type_lwpid_t=no\n \n fi\n rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n \n- if test $bfd_cv_have_sys_procfs_type_fpregset_t = yes; then\n+ if test $bfd_cv_have_sys_procfs_type_lwpid_t = yes; then\n \n-$as_echo \"#define HAVE_FPREGSET_T 1\" >>confdefs.h\n+$as_echo \"#define HAVE_LWPID_T 1\" >>confdefs.h\n \n  fi\n- { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_fpregset_t\" >&5\n-$as_echo \"$bfd_cv_have_sys_procfs_type_fpregset_t\" >&6; }\n+ { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_lwpid_t\" >&5\n+$as_echo \"$bfd_cv_have_sys_procfs_type_lwpid_t\" >&6; }\n \n-    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for prgregset_t in sys/procfs.h\" >&5\n-$as_echo_n \"checking for prgregset_t in sys/procfs.h... \" >&6; }\n- if ${bfd_cv_have_sys_procfs_type_prgregset_t+:} false; then :\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for psaddr_t in sys/procfs.h\" >&5\n+$as_echo_n \"checking for psaddr_t in sys/procfs.h... \" >&6; }\n+ if ${bfd_cv_have_sys_procfs_type_psaddr_t+:} false; then :\n   $as_echo_n \"(cached) \" >&6\n else\n   cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n@@ -9092,31 +8827,31 @@ else\n int\n main ()\n {\n-prgregset_t avar\n+psaddr_t avar\n   ;\n   return 0;\n }\n _ACEOF\n if ac_fn_c_try_compile \"$LINENO\"; then :\n-  bfd_cv_have_sys_procfs_type_prgregset_t=yes\n+  bfd_cv_have_sys_procfs_type_psaddr_t=yes\n else\n-  bfd_cv_have_sys_procfs_type_prgregset_t=no\n+  bfd_cv_have_sys_procfs_type_psaddr_t=no\n \n fi\n rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n \n- if test $bfd_cv_have_sys_procfs_type_prgregset_t = yes; then\n+ if test $bfd_cv_have_sys_procfs_type_psaddr_t = yes; then\n \n-$as_echo \"#define HAVE_PRGREGSET_T 1\" >>confdefs.h\n+$as_echo \"#define HAVE_PSADDR_T 1\" >>confdefs.h\n \n  fi\n- { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_prgregset_t\" >&5\n-$as_echo \"$bfd_cv_have_sys_procfs_type_prgregset_t\" >&6; }\n+ { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_psaddr_t\" >&5\n+$as_echo \"$bfd_cv_have_sys_procfs_type_psaddr_t\" >&6; }\n \n-    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for prfpregset_t in sys/procfs.h\" >&5\n-$as_echo_n \"checking for prfpregset_t in sys/procfs.h... \" >&6; }\n- if ${bfd_cv_have_sys_procfs_type_prfpregset_t+:} false; then :\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for elf_fpregset_t in sys/procfs.h\" >&5\n+$as_echo_n \"checking for elf_fpregset_t in sys/procfs.h... \" >&6; }\n+ if ${bfd_cv_have_sys_procfs_type_elf_fpregset_t+:} false; then :\n   $as_echo_n \"(cached) \" >&6\n else\n   cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n@@ -9129,177 +8864,443 @@ else\n int\n main ()\n {\n-prfpregset_t avar\n+elf_fpregset_t avar\n   ;\n   return 0;\n }\n _ACEOF\n if ac_fn_c_try_compile \"$LINENO\"; then :\n-  bfd_cv_have_sys_procfs_type_prfpregset_t=yes\n+  bfd_cv_have_sys_procfs_type_elf_fpregset_t=yes\n else\n-  bfd_cv_have_sys_procfs_type_prfpregset_t=no\n+  bfd_cv_have_sys_procfs_type_elf_fpregset_t=no\n \n fi\n rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n \n- if test $bfd_cv_have_sys_procfs_type_prfpregset_t = yes; then\n+ if test $bfd_cv_have_sys_procfs_type_elf_fpregset_t = yes; then\n \n-$as_echo \"#define HAVE_PRFPREGSET_T 1\" >>confdefs.h\n+$as_echo \"#define HAVE_ELF_FPREGSET_T 1\" >>confdefs.h\n \n  fi\n- { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_prfpregset_t\" >&5\n-$as_echo \"$bfd_cv_have_sys_procfs_type_prfpregset_t\" >&6; }\n+ { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_elf_fpregset_t\" >&5\n+$as_echo \"$bfd_cv_have_sys_procfs_type_elf_fpregset_t\" >&6; }\n \n-    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for prgregset32_t in sys/procfs.h\" >&5\n-$as_echo_n \"checking for prgregset32_t in sys/procfs.h... \" >&6; }\n- if ${bfd_cv_have_sys_procfs_type_prgregset32_t+:} false; then :\n+  fi\n+\n+\n+\n+# Check whether we will enable the inclusion of unit tests when\n+# compiling GDB.\n+#\n+# The default value of this option changes depending whether we're on\n+# development mode (in which case it's \"true\") or not (in which case\n+# it's \"false\").  The $development variable is set by the GDB_AC_COMMON\n+# macro, which must therefore be used before GDB_AC_SELFTEST.\n+\n+if test \"x$development\" != xtrue && test \"x$development\" != xfalse; then :\n+  as_fn_error $? \"Invalid value for \\$development, got \\\"$development\\\", expecting \\\"true\\\" or \\\"false\\\".\" \"$LINENO\" 5\n+fi\n+\n+# Check whether --enable-unit-tests was given.\n+if test \"${enable_unit_tests+set}\" = set; then :\n+  enableval=$enable_unit_tests; case \"${enableval}\" in\n+  yes)  enable_unittests=true  ;;\n+  no)   enable_unittests=false ;;\n+  *)    as_fn_error $? \"bad value ${enableval} for --{enable,disable}-unit-tests option\" \"$LINENO\" 5 ;;\n+esac\n+else\n+  enable_unittests=$development\n+fi\n+\n+\n+if $enable_unittests; then\n+\n+$as_echo \"#define GDB_SELF_TEST 1\" >>confdefs.h\n+\n+\n+  srv_selftest_objs=\"gdbsupport/selftest.o\"\n+\n+fi\n+\n+\n+ case ${build_alias} in\n+  \"\") build_noncanonical=${build} ;;\n+  *) build_noncanonical=${build_alias} ;;\n+esac\n+\n+ case ${host_alias} in\n+  \"\") host_noncanonical=${build_noncanonical} ;;\n+  *) host_noncanonical=${host_alias} ;;\n+esac\n+\n+ case ${target_alias} in\n+  \"\") target_noncanonical=${host_noncanonical} ;;\n+  *) target_noncanonical=${target_alias} ;;\n+esac\n+\n+\n+\n+\n+\n+\n+# Dependency checking.\n+rm -rf .tst 2>/dev/null\n+mkdir .tst 2>/dev/null\n+if test -d .tst; then\n+  am__leading_dot=.\n+else\n+  am__leading_dot=_\n+fi\n+rmdir .tst 2>/dev/null\n+\n+DEPDIR=\"${am__leading_dot}deps\"\n+\n+ac_config_commands=\"$ac_config_commands depdir\"\n+\n+\n+\n+# Create sub-directories for objects and dependencies.\n+CONFIG_SRC_SUBDIR=\"arch gdbsupport nat target\"\n+\n+\n+ac_config_commands=\"$ac_config_commands gdbdepdir\"\n+\n+\n+depcc=\"$CC\"   am_compiler_list=\n+\n+am_depcomp=$ac_aux_dir/depcomp\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking dependency style of $depcc\" >&5\n+$as_echo_n \"checking dependency style of $depcc... \" >&6; }\n+if ${am_cv_CC_dependencies_compiler_type+:} false; then :\n   $as_echo_n \"(cached) \" >&6\n else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n+  if test -f \"$am_depcomp\"; then\n+  # We make a subdir and do the tests there.  Otherwise we can end up\n+  # making bogus files that we don't know about and never remove.  For\n+  # instance it was reported that on HP-UX the gcc test will end up\n+  # making a dummy file named `D' -- because `-MD' means `put the output\n+  # in D'.\n+  mkdir conftest.dir\n+  # Copy depcomp to subdir because otherwise we won't find it if we're\n+  # using a relative directory.\n+  cp \"$am_depcomp\" conftest.dir\n+  cd conftest.dir\n+  # We will build objects and dependencies in a subdirectory because\n+  # it helps to detect inapplicable dependency modes.  For instance\n+  # both Tru64's cc and ICC support -MD to output dependencies as a\n+  # side effect of compilation, but ICC will put the dependencies in\n+  # the current directory while Tru64 will put them in the object\n+  # directory.\n+  mkdir sub\n \n-#define _SYSCALL32\n-/* Needed for new procfs interface on sparc-solaris.  */\n-#define _STRUCTURED_PROC 1\n-#include <sys/procfs.h>\n-int\n-main ()\n-{\n-prgregset32_t avar\n-  ;\n-  return 0;\n-}\n+  am_cv_CC_dependencies_compiler_type=none\n+  if test \"$am_compiler_list\" = \"\"; then\n+     am_compiler_list=`sed -n 's/^\\([a-zA-Z0-9]*\\))$/\\1/p' < ./depcomp`\n+  fi\n+  for depmode in $am_compiler_list; do\n+    if test $depmode = none; then break; fi\n+\n+    $as_echo \"$as_me:$LINENO: trying $depmode\" >&5\n+    # Setup a source with many dependencies, because some compilers\n+    # like to wrap large dependency lists on column 80 (with \\), and\n+    # we should not choose a depcomp mode which is confused by this.\n+    #\n+    # We need to recreate these files for each test, as the compiler may\n+    # overwrite some of them when testing with obscure command lines.\n+    # This happens at least with the AIX C compiler.\n+    : > sub/conftest.c\n+    for i in 1 2 3 4 5 6; do\n+      echo '#include \"conftst'$i'.h\"' >> sub/conftest.c\n+      # Using `: > sub/conftst$i.h' creates only sub/conftst1.h with\n+      # Solaris 8's {/usr,}/bin/sh.\n+      touch sub/conftst$i.h\n+    done\n+    echo \"include sub/conftest.Po\" > confmf\n+\n+    # We check with `-c' and `-o' for the sake of the \"dashmstdout\"\n+    # mode.  It turns out that the SunPro C++ compiler does not properly\n+    # handle `-M -o', and we need to detect this.\n+    depcmd=\"depmode=$depmode \\\n+       source=sub/conftest.c object=sub/conftest.${OBJEXT-o} \\\n+       depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \\\n+       $SHELL ./depcomp $depcc -c -o sub/conftest.${OBJEXT-o} sub/conftest.c\"\n+    echo \"| $depcmd\" | sed -e 's/  */ /g' >&5\n+    if env $depcmd > conftest.err 2>&1 &&\n+       grep sub/conftst6.h sub/conftest.Po >>conftest.err 2>&1 &&\n+       grep sub/conftest.${OBJEXT-o} sub/conftest.Po >>conftest.err 2>&1 &&\n+       ${MAKE-make} -s -f confmf >>conftest.err 2>&1; then\n+      # icc doesn't choke on unknown options, it will just issue warnings\n+      # or remarks (even with -Werror).  So we grep stderr for any message\n+      # that says an option was ignored or not supported.\n+      # When given -MP, icc 7.0 and 7.1 complain thusly:\n+      #   icc: Command line warning: ignoring option '-M'; no argument required\n+      # The diagnosis changed in icc 8.0:\n+      #   icc: Command line remark: option '-MP' not supported\n+      if (grep 'ignoring option' conftest.err ||\n+          grep 'not supported' conftest.err) >/dev/null 2>&1; then :; else\n+        am_cv_CC_dependencies_compiler_type=$depmode\n+\t$as_echo \"$as_me:$LINENO: success\" >&5\n+        break\n+      fi\n+    fi\n+    $as_echo \"$as_me:$LINENO: failure, diagnostics are:\" >&5\n+    sed -e 's/^/| /' < conftest.err >&5\n+  done\n+\n+  cd ..\n+  rm -rf conftest.dir\n+else\n+  am_cv_CC_dependencies_compiler_type=none\n+fi\n+\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $am_cv_CC_dependencies_compiler_type\" >&5\n+$as_echo \"$am_cv_CC_dependencies_compiler_type\" >&6; }\n+if test x${am_cv_CC_dependencies_compiler_type-none} = xnone\n+then as_fn_error $? \"no usable dependency style found\" \"$LINENO\" 5\n+else CCDEPMODE=depmode=$am_cv_CC_dependencies_compiler_type\n+\n+fi\n+\n+\n+for ac_header in termios.h sys/reg.h string.h \t\t sys/procfs.h linux/elf.h \t\t fcntl.h signal.h sys/file.h \t\t sys/ioctl.h netinet/in.h sys/socket.h netdb.h \t\t netinet/tcp.h arpa/inet.h\n+do :\n+  as_ac_Header=`$as_echo \"ac_cv_header_$ac_header\" | $as_tr_sh`\n+ac_fn_c_check_header_mongrel \"$LINENO\" \"$ac_header\" \"$as_ac_Header\" \"$ac_includes_default\"\n+if eval test \\\"x\\$\"$as_ac_Header\"\\\" = x\"yes\"; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define `$as_echo \"HAVE_$ac_header\" | $as_tr_cpp` 1\n+_ACEOF\n+\n+fi\n+\n+done\n+\n+for ac_header in vfork.h\n+do :\n+  ac_fn_c_check_header_mongrel \"$LINENO\" \"vfork.h\" \"ac_cv_header_vfork_h\" \"$ac_includes_default\"\n+if test \"x$ac_cv_header_vfork_h\" = xyes; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_VFORK_H 1\n _ACEOF\n-if ac_fn_c_try_compile \"$LINENO\"; then :\n-  bfd_cv_have_sys_procfs_type_prgregset32_t=yes\n-else\n-  bfd_cv_have_sys_procfs_type_prgregset32_t=no\n \n-fi\n-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n \n- if test $bfd_cv_have_sys_procfs_type_prgregset32_t = yes; then\n+done\n \n-$as_echo \"#define HAVE_PRGREGSET32_T 1\" >>confdefs.h\n+for ac_func in fork vfork\n+do :\n+  as_ac_var=`$as_echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n+ac_fn_c_check_func \"$LINENO\" \"$ac_func\" \"$as_ac_var\"\n+if eval test \\\"x\\$\"$as_ac_var\"\\\" = x\"yes\"; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define `$as_echo \"HAVE_$ac_func\" | $as_tr_cpp` 1\n+_ACEOF\n \n- fi\n- { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_prgregset32_t\" >&5\n-$as_echo \"$bfd_cv_have_sys_procfs_type_prgregset32_t\" >&6; }\n+fi\n+done\n \n-    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for lwpid_t in sys/procfs.h\" >&5\n-$as_echo_n \"checking for lwpid_t in sys/procfs.h... \" >&6; }\n- if ${bfd_cv_have_sys_procfs_type_lwpid_t+:} false; then :\n+if test \"x$ac_cv_func_fork\" = xyes; then\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for working fork\" >&5\n+$as_echo_n \"checking for working fork... \" >&6; }\n+if ${ac_cv_func_fork_works+:} false; then :\n   $as_echo_n \"(cached) \" >&6\n+else\n+  if test \"$cross_compiling\" = yes; then :\n+  ac_cv_func_fork_works=cross\n else\n   cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n-\n-#define _SYSCALL32\n-/* Needed for new procfs interface on sparc-solaris.  */\n-#define _STRUCTURED_PROC 1\n-#include <sys/procfs.h>\n+$ac_includes_default\n int\n main ()\n {\n-lwpid_t avar\n+\n+\t  /* By Ruediger Kuhlmann. */\n+\t  return fork () < 0;\n+\n   ;\n   return 0;\n }\n _ACEOF\n-if ac_fn_c_try_compile \"$LINENO\"; then :\n-  bfd_cv_have_sys_procfs_type_lwpid_t=yes\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  ac_cv_func_fork_works=yes\n else\n-  bfd_cv_have_sys_procfs_type_lwpid_t=no\n-\n+  ac_cv_func_fork_works=no\n fi\n-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n fi\n \n- if test $bfd_cv_have_sys_procfs_type_lwpid_t = yes; then\n-\n-$as_echo \"#define HAVE_LWPID_T 1\" >>confdefs.h\n-\n- fi\n- { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_lwpid_t\" >&5\n-$as_echo \"$bfd_cv_have_sys_procfs_type_lwpid_t\" >&6; }\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_fork_works\" >&5\n+$as_echo \"$ac_cv_func_fork_works\" >&6; }\n \n-    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for psaddr_t in sys/procfs.h\" >&5\n-$as_echo_n \"checking for psaddr_t in sys/procfs.h... \" >&6; }\n- if ${bfd_cv_have_sys_procfs_type_psaddr_t+:} false; then :\n+else\n+  ac_cv_func_fork_works=$ac_cv_func_fork\n+fi\n+if test \"x$ac_cv_func_fork_works\" = xcross; then\n+  case $host in\n+    *-*-amigaos* | *-*-msdosdjgpp*)\n+      # Override, as these systems have only a dummy fork() stub\n+      ac_cv_func_fork_works=no\n+      ;;\n+    *)\n+      ac_cv_func_fork_works=yes\n+      ;;\n+  esac\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: WARNING: result $ac_cv_func_fork_works guessed because of cross compilation\" >&5\n+$as_echo \"$as_me: WARNING: result $ac_cv_func_fork_works guessed because of cross compilation\" >&2;}\n+fi\n+ac_cv_func_vfork_works=$ac_cv_func_vfork\n+if test \"x$ac_cv_func_vfork\" = xyes; then\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for working vfork\" >&5\n+$as_echo_n \"checking for working vfork... \" >&6; }\n+if ${ac_cv_func_vfork_works+:} false; then :\n   $as_echo_n \"(cached) \" >&6\n+else\n+  if test \"$cross_compiling\" = yes; then :\n+  ac_cv_func_vfork_works=cross\n else\n   cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n+/* Thanks to Paul Eggert for this test.  */\n+$ac_includes_default\n+#include <sys/wait.h>\n+#ifdef HAVE_VFORK_H\n+# include <vfork.h>\n+#endif\n+/* On some sparc systems, changes by the child to local and incoming\n+   argument registers are propagated back to the parent.  The compiler\n+   is told about this with #include <vfork.h>, but some compilers\n+   (e.g. gcc -O) don't grok <vfork.h>.  Test for this by using a\n+   static variable whose address is put into a register that is\n+   clobbered by the vfork.  */\n+static void\n+#ifdef __cplusplus\n+sparc_address_test (int arg)\n+# else\n+sparc_address_test (arg) int arg;\n+#endif\n+{\n+  static pid_t child;\n+  if (!child) {\n+    child = vfork ();\n+    if (child < 0) {\n+      perror (\"vfork\");\n+      _exit(2);\n+    }\n+    if (!child) {\n+      arg = getpid();\n+      write(-1, \"\", 0);\n+      _exit (arg);\n+    }\n+  }\n+}\n \n-#define _SYSCALL32\n-/* Needed for new procfs interface on sparc-solaris.  */\n-#define _STRUCTURED_PROC 1\n-#include <sys/procfs.h>\n int\n main ()\n {\n-psaddr_t avar\n-  ;\n-  return 0;\n+  pid_t parent = getpid ();\n+  pid_t child;\n+\n+  sparc_address_test (0);\n+\n+  child = vfork ();\n+\n+  if (child == 0) {\n+    /* Here is another test for sparc vfork register problems.  This\n+       test uses lots of local variables, at least as many local\n+       variables as main has allocated so far including compiler\n+       temporaries.  4 locals are enough for gcc 1.40.3 on a Solaris\n+       4.1.3 sparc, but we use 8 to be safe.  A buggy compiler should\n+       reuse the register of parent for one of the local variables,\n+       since it will think that parent can't possibly be used any more\n+       in this routine.  Assigning to the local variable will thus\n+       munge parent in the parent process.  */\n+    pid_t\n+      p = getpid(), p1 = getpid(), p2 = getpid(), p3 = getpid(),\n+      p4 = getpid(), p5 = getpid(), p6 = getpid(), p7 = getpid();\n+    /* Convince the compiler that p..p7 are live; otherwise, it might\n+       use the same hardware register for all 8 local variables.  */\n+    if (p != p1 || p != p2 || p != p3 || p != p4\n+\t|| p != p5 || p != p6 || p != p7)\n+      _exit(1);\n+\n+    /* On some systems (e.g. IRIX 3.3), vfork doesn't separate parent\n+       from child file descriptors.  If the child closes a descriptor\n+       before it execs or exits, this munges the parent's descriptor\n+       as well.  Test for this by closing stdout in the child.  */\n+    _exit(close(fileno(stdout)) != 0);\n+  } else {\n+    int status;\n+    struct stat st;\n+\n+    while (wait(&status) != child)\n+      ;\n+    return (\n+\t /* Was there some problem with vforking?  */\n+\t child < 0\n+\n+\t /* Did the child fail?  (This shouldn't happen.)  */\n+\t || status\n+\n+\t /* Did the vfork/compiler bug occur?  */\n+\t || parent != getpid()\n+\n+\t /* Did the file descriptor bug occur?  */\n+\t || fstat(fileno(stdout), &st) != 0\n+\t );\n+  }\n }\n _ACEOF\n-if ac_fn_c_try_compile \"$LINENO\"; then :\n-  bfd_cv_have_sys_procfs_type_psaddr_t=yes\n+if ac_fn_c_try_run \"$LINENO\"; then :\n+  ac_cv_func_vfork_works=yes\n else\n-  bfd_cv_have_sys_procfs_type_psaddr_t=no\n-\n+  ac_cv_func_vfork_works=no\n fi\n-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \\\n+  conftest.$ac_objext conftest.beam conftest.$ac_ext\n fi\n \n- if test $bfd_cv_have_sys_procfs_type_psaddr_t = yes; then\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_vfork_works\" >&5\n+$as_echo \"$ac_cv_func_vfork_works\" >&6; }\n \n-$as_echo \"#define HAVE_PSADDR_T 1\" >>confdefs.h\n+fi;\n+if test \"x$ac_cv_func_fork_works\" = xcross; then\n+  ac_cv_func_vfork_works=$ac_cv_func_vfork\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: WARNING: result $ac_cv_func_vfork_works guessed because of cross compilation\" >&5\n+$as_echo \"$as_me: WARNING: result $ac_cv_func_vfork_works guessed because of cross compilation\" >&2;}\n+fi\n \n- fi\n- { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_psaddr_t\" >&5\n-$as_echo \"$bfd_cv_have_sys_procfs_type_psaddr_t\" >&6; }\n+if test \"x$ac_cv_func_vfork_works\" = xyes; then\n \n-    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for elf_fpregset_t in sys/procfs.h\" >&5\n-$as_echo_n \"checking for elf_fpregset_t in sys/procfs.h... \" >&6; }\n- if ${bfd_cv_have_sys_procfs_type_elf_fpregset_t+:} false; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n+$as_echo \"#define HAVE_WORKING_VFORK 1\" >>confdefs.h\n \n-#define _SYSCALL32\n-/* Needed for new procfs interface on sparc-solaris.  */\n-#define _STRUCTURED_PROC 1\n-#include <sys/procfs.h>\n-int\n-main ()\n-{\n-elf_fpregset_t avar\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-if ac_fn_c_try_compile \"$LINENO\"; then :\n-  bfd_cv_have_sys_procfs_type_elf_fpregset_t=yes\n else\n-  bfd_cv_have_sys_procfs_type_elf_fpregset_t=no\n+\n+$as_echo \"#define vfork fork\" >>confdefs.h\n \n fi\n-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n-fi\n+if test \"x$ac_cv_func_fork_works\" = xyes; then\n \n- if test $bfd_cv_have_sys_procfs_type_elf_fpregset_t = yes; then\n+$as_echo \"#define HAVE_WORKING_FORK 1\" >>confdefs.h\n \n-$as_echo \"#define HAVE_ELF_FPREGSET_T 1\" >>confdefs.h\n+fi\n \n- fi\n- { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $bfd_cv_have_sys_procfs_type_elf_fpregset_t\" >&5\n-$as_echo \"$bfd_cv_have_sys_procfs_type_elf_fpregset_t\" >&6; }\n+for ac_func in pread pwrite pread64\n+do :\n+  as_ac_var=`$as_echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n+ac_fn_c_check_func \"$LINENO\" \"$ac_func\" \"$as_ac_var\"\n+if eval test \\\"x\\$\"$as_ac_var\"\\\" = x\"yes\"; then :\n+  cat >>confdefs.h <<_ACEOF\n+#define `$as_echo \"HAVE_$ac_func\" | $as_tr_cpp` 1\n+_ACEOF\n \n-  fi\n+fi\n+done\n \n \n # Check the return and argument types of ptrace."
    },
    {
      "sha": "db9d45715efb2dd765b5cd5728e87adf838f81d1",
      "filename": "gdbserver/configure.ac",
      "status": "modified",
      "additions": 1,
      "deletions": 4,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdbserver/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdbserver/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure.ac?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -43,8 +43,7 @@ AX_CXX_COMPILE_STDCXX(11, , mandatory)\n \n AC_HEADER_STDC\n \n-# Set the 'development' global.\n-. $srcdir/../bfd/development.sh\n+GDB_AC_COMMON\n \n GDB_AC_SELFTEST([\n   srv_selftest_objs=\"gdbsupport/selftest.o\"\n@@ -77,8 +76,6 @@ AC_CHECK_HEADERS(termios.h sys/reg.h string.h dnl\n AC_FUNC_FORK\n AC_CHECK_FUNCS(pread pwrite pread64)\n \n-GDB_AC_COMMON\n-\n # Check the return and argument types of ptrace.\n GDB_AC_PTRACE\n "
    },
    {
      "sha": "e7474e14182a6aa6a57c0d89a626d4a7edf792c7",
      "filename": "gdbsupport/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdbsupport/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdbsupport/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbsupport/ChangeLog?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -1,3 +1,9 @@\n+2020-03-12  Simon Marchi  <simon.marchi@efficios.com>\n+\n+\t* configure.ac: Don't source bfd/development.sh.\n+\t* common.m4: Source bfd/development.sh.\n+\t* configure: Re-generate.\n+\n 2020-03-12  Simon Marchi  <simon.marchi@efficios.com>\n \n \t* configure: Re-generate."
    },
    {
      "sha": "e67058632cab47a9dd5c532d355ba46493a3a8c6",
      "filename": "gdbsupport/common.m4",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdbsupport/common.m4",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdbsupport/common.m4",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbsupport/common.m4?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -18,6 +18,9 @@ dnl along with this program.  If not, see <http://www.gnu.org/licenses/>.\n \n dnl Invoke configury needed by the files in 'common'.\n AC_DEFUN([GDB_AC_COMMON], [\n+  # Set the 'development' global.\n+  . $srcdir/../bfd/development.sh\n+\n   AC_HEADER_STDC\n   AC_FUNC_ALLOCA\n "
    },
    {
      "sha": "2ffe539eb092cb125fd43b896633ae72de3deed2",
      "filename": "gdbsupport/configure",
      "status": "modified",
      "additions": 5,
      "deletions": 4,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdbsupport/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdbsupport/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbsupport/configure?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -6569,9 +6569,6 @@ fi\n am_cv_prog_cc_stdc=$ac_cv_prog_cc_stdc\n \n \n-# Set the 'development' global.\n-. $srcdir/../bfd/development.sh\n-\n # We require a C++11 compiler.  Check if one is available, and if\n # necessary, set CXX_DIALECT to some -std=xxx switch.\n \n@@ -8060,6 +8057,9 @@ fi\n \n \n \n+  # Set the 'development' global.\n+  . $srcdir/../bfd/development.sh\n+\n   { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for ANSI C header files\" >&5\n $as_echo_n \"checking for ANSI C header files... \" >&6; }\n if ${ac_cv_header_stdc+:} false; then :\n@@ -10605,7 +10605,8 @@ $as_echo \"$bfd_cv_have_sys_procfs_type_elf_fpregset_t\" >&6; }\n #\n # The default value of this option changes depending whether we're on\n # development mode (in which case it's \"true\") or not (in which case\n-# it's \"false\").\n+# it's \"false\").  The $development variable is set by the GDB_AC_COMMON\n+# macro, which must therefore be used before GDB_AC_SELFTEST.\n \n if test \"x$development\" != xtrue && test \"x$development\" != xfalse; then :\n   as_fn_error $? \"Invalid value for \\$development, got \\\"$development\\\", expecting \\\"true\\\" or \\\"false\\\".\" \"$LINENO\" 5"
    },
    {
      "sha": "401e16f821da462b81d39f9a949b0b419165780b",
      "filename": "gdbsupport/configure.ac",
      "status": "modified",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/db6878ac5538661c8d66c916a533bd4268217fcb/gdbsupport/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/db6878ac5538661c8d66c916a533bd4268217fcb/gdbsupport/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbsupport/configure.ac?ref=db6878ac5538661c8d66c916a533bd4268217fcb",
      "patch": "@@ -33,9 +33,6 @@ AC_USE_SYSTEM_EXTENSIONS\n ACX_LARGEFILE\n AM_PROG_CC_STDC\n \n-# Set the 'development' global.\n-. $srcdir/../bfd/development.sh\n-\n # We require a C++11 compiler.  Check if one is available, and if\n # necessary, set CXX_DIALECT to some -std=xxx switch.\n AX_CXX_COMPILE_STDCXX(11, , mandatory)"
    }
  ]
}