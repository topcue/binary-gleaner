{
  "sha": "4635ff975351603e64da3cbdeec3b999ee842ac8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NDYzNWZmOTc1MzUxNjAzZTY0ZGEzY2JkZWVjM2I5OTllZTg0MmFjOA==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-03-12T19:32:15Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-03-12T19:32:16Z"
    },
    "message": "Change gdbserver to use existing gdbsupport\n\nThis changes the gdbserver build to use the gdbsupport that was built\nfor gdb.\n\ngdbserver and gdbreplay now must use WIN32APILIBS (aka -lws2_32).\nBefore this change, gdbserver did not define USE_WIN32API when\nbuilding gdbsupport, but now this is always done.\n\nChangeLog\n2020-03-12  Tom Tromey  <tom@tromey.com>\n\n\t* Makefile.in: Rebuild.\n\t* Makefile.def (gdbserver): Depend on gdbsupport.\n\ngdbserver/ChangeLog\n2020-03-12  Tom Tromey  <tom@tromey.com>\n\n\t* configure: Rebuild.\n\t* configure.ac (GDBSERVER_DEPFILES): Remove srv_selftest_objs.\n\t(WIN32APILIBS): New subst.\n\t* Makefile.in (SFILES, OBS, TAGS, GDBREPLAY_OBS): Remove\n\tgdbsupport files.\n\t(gdbsupport/%.o): Remove target.\n\t(GDBSUPPORT_BUILDDIR, GDBSUPPORT): New variables.\n\t(gdbserver$(EXEEXT), gdbreplay$(EXEEXT)): Add GDBSUPPORT.\n\t(WIN32APILIBS): New variable.\n\t(gdbserver$(EXEEXT)): Add WIN32APILIBS.\n\t(gdbreplay$(EXEEXT)): Likewise.",
    "tree": {
      "sha": "2347ceabf8611e64b4e0e753651f3ce56e8922cd",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/2347ceabf8611e64b4e0e753651f3ce56e8922cd"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4635ff975351603e64da3cbdeec3b999ee842ac8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4635ff975351603e64da3cbdeec3b999ee842ac8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4635ff975351603e64da3cbdeec3b999ee842ac8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4635ff975351603e64da3cbdeec3b999ee842ac8/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "213291361b4ddb2d05b8c89bf47d23ca4306912e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/213291361b4ddb2d05b8c89bf47d23ca4306912e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/213291361b4ddb2d05b8c89bf47d23ca4306912e"
    }
  ],
  "stats": {
    "total": 124,
    "additions": 42,
    "deletions": 82
  },
  "files": [
    {
      "sha": "c8683661a7488d758aa7a1a01c6e38d0adbce7e9",
      "filename": "ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4635ff975351603e64da3cbdeec3b999ee842ac8/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4635ff975351603e64da3cbdeec3b999ee842ac8/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ChangeLog?ref=4635ff975351603e64da3cbdeec3b999ee842ac8",
      "patch": "@@ -1,3 +1,8 @@\n+2020-03-12  Tom Tromey  <tom@tromey.com>\n+\n+\t* Makefile.in: Rebuild.\n+\t* Makefile.def (gdbserver): Depend on gdbsupport.\n+\n 2020-03-12  Tom Tromey  <tom@tromey.com>\n \n \t* Makefile.in: Rebuild."
    },
    {
      "sha": "76d062bb671649040425f4835b958bc4780c1631",
      "filename": "Makefile.def",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4635ff975351603e64da3cbdeec3b999ee842ac8/Makefile.def",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4635ff975351603e64da3cbdeec3b999ee842ac8/Makefile.def",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/Makefile.def?ref=4635ff975351603e64da3cbdeec3b999ee842ac8",
      "patch": "@@ -412,6 +412,7 @@ dependencies = { module=all-gdb; on=all-libctf; };\n \n // Host modules specific to gdbserver.\n dependencies = { module=configure-gdbserver; on=all-gnulib; };\n+dependencies = { module=all-gdbserver; on=all-gdbsupport; };\n dependencies = { module=all-gdbserver; on=all-gnulib; };\n dependencies = { module=all-gdbserver; on=all-libiberty; };\n "
    },
    {
      "sha": "9dfd39fae1368dd4b065a7fe36d8c51b2961fcff",
      "filename": "Makefile.in",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4635ff975351603e64da3cbdeec3b999ee842ac8/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4635ff975351603e64da3cbdeec3b999ee842ac8/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/Makefile.in?ref=4635ff975351603e64da3cbdeec3b999ee842ac8",
      "patch": "@@ -51977,6 +51977,7 @@ all-gdb: maybe-all-build-bison\n all-gdb: maybe-all-sim\n all-gdb: maybe-all-libtermcap\n configure-gdbserver: maybe-all-gnulib\n+all-gdbserver: maybe-all-gdbsupport\n all-gdbserver: maybe-all-gnulib\n configure-libgui: maybe-configure-tcl\n configure-libgui: maybe-configure-tk"
    },
    {
      "sha": "5c3761a6713cb1864bf59357ac9a861ce57504e4",
      "filename": "gdbserver/ChangeLog",
      "status": "modified",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4635ff975351603e64da3cbdeec3b999ee842ac8/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4635ff975351603e64da3cbdeec3b999ee842ac8/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/ChangeLog?ref=4635ff975351603e64da3cbdeec3b999ee842ac8",
      "patch": "@@ -1,3 +1,17 @@\n+2020-03-12  Tom Tromey  <tom@tromey.com>\n+\n+\t* configure: Rebuild.\n+\t* configure.ac (GDBSERVER_DEPFILES): Remove srv_selftest_objs.\n+\t(WIN32APILIBS): New subst.\n+\t* Makefile.in (SFILES, OBS, TAGS, GDBREPLAY_OBS): Remove\n+\tgdbsupport files.\n+\t(gdbsupport/%.o): Remove target.\n+\t(GDBSUPPORT_BUILDDIR, GDBSUPPORT): New variables.\n+\t(gdbserver$(EXEEXT), gdbreplay$(EXEEXT)): Add GDBSUPPORT.\n+\t(WIN32APILIBS): New variable.\n+\t(gdbserver$(EXEEXT)): Add WIN32APILIBS.\n+\t(gdbreplay$(EXEEXT)): Likewise.\n+\n 2020-03-12  Tom Tromey  <tom@tromey.com>\n \n \t* config.in, configure: Rebuild."
    },
    {
      "sha": "8c35c169d62bc41b420ede45fe3ef384d35c117f",
      "filename": "gdbserver/Makefile.in",
      "status": "modified",
      "additions": 13,
      "deletions": 75,
      "changes": 88,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4635ff975351603e64da3cbdeec3b999ee842ac8/gdbserver/Makefile.in",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4635ff975351603e64da3cbdeec3b999ee842ac8/gdbserver/Makefile.in",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/Makefile.in?ref=4635ff975351603e64da3cbdeec3b999ee842ac8",
      "patch": "@@ -102,6 +102,9 @@ INCLUDE_DEP = $$(INCLUDE_DIR)\n LIBIBERTY_BUILDDIR = ../libiberty\n LIBIBERTY = $(LIBIBERTY_BUILDDIR)/libiberty.a\n \n+GDBSUPPORT_BUILDDIR = ../gdbsupport\n+GDBSUPPORT = $(GDBSUPPORT_BUILDDIR)/libgdbsupport.a\n+\n # Where is ust?  These will be empty if ust was not available.\n ustlibs = @ustlibs@\n ustinc = @ustinc@\n@@ -152,6 +155,8 @@ CPPFLAGS = @CPPFLAGS@\n PTHREAD_CFLAGS = @PTHREAD_CFLAGS@\n PTHREAD_LIBS = @PTHREAD_LIBS@\n \n+WIN32APILIBS = @WIN32APILIBS@\n+\n # INTERNAL_CFLAGS is the aggregate of all other *CFLAGS macros.\n INTERNAL_CFLAGS_BASE = ${CXXFLAGS} ${GLOBAL_CFLAGS} \\\n \t${PROFILE_CFLAGS} ${INCLUDE_CFLAGS} ${CPPFLAGS} $(PTHREAD_CFLAGS)\n@@ -213,32 +218,6 @@ SFILES = \\\n \t$(srcdir)/../gdb/arch/arm-linux.c \\\n \t$(srcdir)/../gdb/arch/ppc-linux-common.c \\\n \t$(srcdir)/../gdb/arch/riscv.c \\\n-\t$(srcdir)/../gdbsupport/btrace-common.cc \\\n-\t$(srcdir)/../gdbsupport/buffer.cc \\\n-\t$(srcdir)/../gdbsupport/cleanups.cc \\\n-\t$(srcdir)/../gdbsupport/common-debug.cc \\\n-\t$(srcdir)/../gdbsupport/common-exceptions.cc \\\n-\t$(srcdir)/../gdbsupport/common-inferior.cc \\\n-\t$(srcdir)/../gdbsupport/common-regcache.cc \\\n-\t$(srcdir)/../gdbsupport/common-utils.cc \\\n-\t$(srcdir)/../gdbsupport/errors.cc \\\n-\t$(srcdir)/../gdbsupport/environ.cc \\\n-\t$(srcdir)/../gdbsupport/fileio.cc \\\n-\t$(srcdir)/../gdbsupport/filestuff.cc \\\n-\t$(srcdir)/../gdbsupport/job-control.cc \\\n-\t$(srcdir)/../gdbsupport/gdb-dlfcn.cc \\\n-\t$(srcdir)/../gdbsupport/gdb_tilde_expand.cc \\\n-\t$(srcdir)/../gdbsupport/gdb_vecs.cc \\\n-\t$(srcdir)/../gdbsupport/gdb_wait.cc \\\n-\t$(srcdir)/../gdbsupport/netstuff.cc \\\n-\t$(srcdir)/../gdbsupport/new-op.cc \\\n-\t$(srcdir)/../gdbsupport/pathstuff.cc \\\n-\t$(srcdir)/../gdbsupport/print-utils.cc \\\n-\t$(srcdir)/../gdbsupport/ptid.cc \\\n-\t$(srcdir)/../gdbsupport/rsp-low.cc \\\n-\t$(srcdir)/../gdbsupport/safe-strerror.cc \\\n-\t$(srcdir)/../gdbsupport/tdesc.cc \\\n-\t$(srcdir)/../gdbsupport/xml-utils.cc \\\n \t$(srcdir)/../gdb/nat/aarch64-sve-linux-ptrace.c \\\n \t$(srcdir)/../gdb/nat/linux-btrace.c \\\n \t$(srcdir)/../gdb/nat/linux-namespaces.c \\\n@@ -260,36 +239,6 @@ TAGFILES = $(SOURCES) ${HFILES} ${ALLPARAM} ${POSSLIBS}\n OBS = \\\n \talloc.o \\\n \tax.o \\\n-\tgdbsupport/agent.o \\\n-\tgdbsupport/btrace-common.o \\\n-\tgdbsupport/buffer.o \\\n-\tgdbsupport/cleanups.o \\\n-\tgdbsupport/common-debug.o \\\n-\tgdbsupport/common-exceptions.o \\\n-\tgdbsupport/common-inferior.o \\\n-\tgdbsupport/job-control.o \\\n-\tgdbsupport/common-regcache.o \\\n-\tgdbsupport/common-utils.o \\\n-\tgdbsupport/errors.o \\\n-\tgdbsupport/environ.o \\\n-\tgdbsupport/fileio.o \\\n-\tgdbsupport/filestuff.o \\\n-\tgdbsupport/format.o \\\n-\tgdbsupport/gdb-dlfcn.o \\\n-\tgdbsupport/gdb_tilde_expand.o \\\n-\tgdbsupport/gdb_vecs.o \\\n-\tgdbsupport/gdb_wait.o \\\n-\tgdbsupport/netstuff.o \\\n-\tgdbsupport/new-op.o \\\n-\tgdbsupport/pathstuff.o \\\n-\tgdbsupport/print-utils.o \\\n-\tgdbsupport/ptid.o \\\n-\tgdbsupport/rsp-low.o \\\n-\tgdbsupport/safe-strerror.o \\\n-\tgdbsupport/signals.o \\\n-\tgdbsupport/signals-state-save-restore.o \\\n-\tgdbsupport/tdesc.o \\\n-\tgdbsupport/xml-utils.o \\\n \tdebug.o \\\n \tdll.o \\\n \tevent-loop.o \\\n@@ -312,14 +261,6 @@ OBS = \\\n \t$(XML_BUILTIN)\n \n GDBREPLAY_OBS = \\\n-\tgdbsupport/cleanups.o \\\n-\tgdbsupport/common-exceptions.o \\\n-\tgdbsupport/common-utils.o \\\n-\tgdbsupport/rsp-low.o \\\n-\tgdbsupport/errors.o \\\n-\tgdbsupport/netstuff.o \\\n-\tgdbsupport/print-utils.o \\\n-\tgdbsupport/safe-strerror.o \\\n \tgdbreplay.o \\\n \tutils.o \\\n \tversion.o\n@@ -412,18 +353,20 @@ install-html:\n clean-info:\n \n gdbserver$(EXEEXT): $(sort $(OBS)) ${CDEPS} $(LIBGNU) $(LIBIBERTY) \\\n-\t\t$(INTL_DEPS)\n+\t\t$(INTL_DEPS) $(GDBSUPPORT)\n \t$(SILENCE) rm -f gdbserver$(EXEEXT)\n \t$(ECHO_CXXLD) $(CC_LD) $(INTERNAL_CFLAGS) $(INTERNAL_LDFLAGS) \\\n-\t\t-o gdbserver$(EXEEXT) $(OBS) $(LIBGNU) $(LIBIBERTY) \\\n-\t\t$(INTL) $(GDBSERVER_LIBS) $(XM_CLIBS)\n+\t\t-o gdbserver$(EXEEXT) $(OBS) $(GDBSUPPORT) $(LIBGNU) \\\n+\t\t$(LIBIBERTY) $(INTL) $(GDBSERVER_LIBS) $(XM_CLIBS) \\\n+\t\t$(WIN32APILIBS)\n \n gdbreplay$(EXEEXT): $(sort $(GDBREPLAY_OBS)) $(LIBGNU) $(LIBIBERTY) \\\n-\t\t$(INTL_DEPS)\n+\t\t$(INTL_DEPS) $(GDBSUPPORT)\n \t$(SILENCE) rm -f gdbreplay$(EXEEXT)\n \t$(ECHO_CXXLD) $(CC_LD) $(INTERNAL_CFLAGS) $(INTERNAL_LDFLAGS) \\\n-\t\t-o gdbreplay$(EXEEXT) $(GDBREPLAY_OBS) $(XM_CLIBS) $(LIBGNU) \\\n-\t\t$(LIBIBERTY) $(INTL)\n+\t\t-o gdbreplay$(EXEEXT) $(GDBREPLAY_OBS) $(XM_CLIBS) \\\n+\t\t$(GDBSUPPORT) $(LIBGNU) $(LIBIBERTY) $(INTL) \\\n+\t\t$(WIN32APILIBS)\n \n IPA_OBJS = \\\n \talloc-ipa.o \\\n@@ -459,7 +402,6 @@ TAGS:\t${TAGFILES}\n \t     if [ x$$i != xyzzy ]; then \\\n \t       echo ${srcdir}/$$i | sed -e 's/\\.o$$/\\.cc/' \\\n \t\t -e 's,/\\(arch\\|nat\\|target\\)/,/../\\1/,' \\\n-\t\t -e 's,/\\(gdbsupport\\)/,/../../\\1/,'; \\\n \t     fi; \\\n \t   done` \\\n \t  ${TAGFILES}\n@@ -595,10 +537,6 @@ arch/%.o: ../gdb/arch/%.c\n \t$(COMPILE) -x c++ $<\n \t$(POSTCOMPILE)\n \n-gdbsupport/%.o: ../gdbsupport/%.cc\n-\t$(COMPILE) $<\n-\t$(POSTCOMPILE)\n-\n %.o: %-generated.cc\n \t$(COMPILE) $<\n \t$(POSTCOMPILE)"
    },
    {
      "sha": "55cf2416b568357dc5dc6493ddebc330cbe94c74",
      "filename": "gdbserver/configure",
      "status": "modified",
      "additions": 4,
      "deletions": 3,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4635ff975351603e64da3cbdeec3b999ee842ac8/gdbserver/configure",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4635ff975351603e64da3cbdeec3b999ee842ac8/gdbserver/configure",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure?ref=4635ff975351603e64da3cbdeec3b999ee842ac8",
      "patch": "@@ -655,6 +655,7 @@ DEPDIR\n am__leading_dot\n host_noncanonical\n target_noncanonical\n+WIN32APILIBS\n LTLIBIPT\n LIBIPT\n HAVE_LIBIPT\n@@ -8900,6 +8901,8 @@ $as_echo \"$bfd_cv_have_sys_procfs_type_elf_fpregset_t\" >&6; }\n \n   fi\n \n+# This is set by GDB_AC_COMMON.\n+\n \n \n # Check whether we will enable the inclusion of unit tests when\n@@ -8931,8 +8934,6 @@ if $enable_unittests; then\n $as_echo \"#define GDB_SELF_TEST 1\" >>confdefs.h\n \n \n-  srv_selftest_objs=\"gdbsupport/selftest.o\"\n-\n fi\n \n \n@@ -10633,7 +10634,7 @@ $as_echo \"#define USE_XML 1\" >>confdefs.h\n   done\n fi\n \n-GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles $srv_selftest_objs\"\n+GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles\"\n GDBSERVER_LIBS=\"$srv_libs\"\n \n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether the target supports __sync_*_compare_and_swap\" >&5"
    },
    {
      "sha": "755cc28cee9c0ca2f51dfb378ac55c3b0f3d69c0",
      "filename": "gdbserver/configure.ac",
      "status": "modified",
      "additions": 4,
      "deletions": 4,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4635ff975351603e64da3cbdeec3b999ee842ac8/gdbserver/configure.ac",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4635ff975351603e64da3cbdeec3b999ee842ac8/gdbserver/configure.ac",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/configure.ac?ref=4635ff975351603e64da3cbdeec3b999ee842ac8",
      "patch": "@@ -44,10 +44,10 @@ AX_CXX_COMPILE_STDCXX(11, , mandatory)\n AC_HEADER_STDC\n \n GDB_AC_COMMON\n+# This is set by GDB_AC_COMMON.\n+AC_SUBST(WIN32APILIBS)\n \n-GDB_AC_SELFTEST([\n-  srv_selftest_objs=\"gdbsupport/selftest.o\"\n-])\n+GDB_AC_SELFTEST\n \n ACX_NONCANONICAL_TARGET\n ACX_NONCANONICAL_HOST\n@@ -357,7 +357,7 @@ if test \"$srv_xmlfiles\" != \"\"; then\n   done\n fi\n \n-GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles $srv_selftest_objs\"\n+GDBSERVER_DEPFILES=\"$srv_regobj $srv_tgtobj $srv_hostio_err_objs $srv_thread_depfiles\"\n GDBSERVER_LIBS=\"$srv_libs\"\n \n dnl Check whether the target supports __sync_*_compare_and_swap."
    }
  ]
}