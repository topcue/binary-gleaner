{
  "sha": "d86d1fc7f988f52da4711a86c078194347ab6482",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDg2ZDFmYzdmOTg4ZjUyZGE0NzExYTg2YzA3ODE5NDM0N2FiNjQ4Mg==",
  "commit": {
    "author": {
      "name": "Matt Jacobson",
      "email": "mhjacobson@me.com",
      "date": "2021-08-11T09:03:19Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2021-08-11T09:03:19Z"
    },
    "message": "Add a -mno-dollar-line-separator command line option to the AVR assembler.\n\nSome frontends, like the gcc Objective-C frontend, emit symbols with $\ncharacters in them.  The AVR target code in gas treats $ as a line separator,\nso the code doesn?t assemble correctly.\n\nProvide a machine-specific option to disable treating $ as a line separator.\n\n\t* config/tc-avr.c (enum options): Add option flag.\n\t(struct option): Add option -mno-dollar-line-separator.\n\t(md_parse_option): Adjust treatment of $ when option is present.\n\t* config/tc-avr.h: Use avr_line_separator_chars.",
    "tree": {
      "sha": "1086243d3c10740164fefb19bfcacd42f72d8f6d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/1086243d3c10740164fefb19bfcacd42f72d8f6d"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d86d1fc7f988f52da4711a86c078194347ab6482",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d86d1fc7f988f52da4711a86c078194347ab6482",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d86d1fc7f988f52da4711a86c078194347ab6482",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d86d1fc7f988f52da4711a86c078194347ab6482/comments",
  "author": {
    "login": "mhjacobson",
    "id": 1477437,
    "node_id": "MDQ6VXNlcjE0Nzc0Mzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1477437?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mhjacobson",
    "html_url": "https://github.com/mhjacobson",
    "followers_url": "https://api.github.com/users/mhjacobson/followers",
    "following_url": "https://api.github.com/users/mhjacobson/following{/other_user}",
    "gists_url": "https://api.github.com/users/mhjacobson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mhjacobson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mhjacobson/subscriptions",
    "organizations_url": "https://api.github.com/users/mhjacobson/orgs",
    "repos_url": "https://api.github.com/users/mhjacobson/repos",
    "events_url": "https://api.github.com/users/mhjacobson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mhjacobson/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "bda3d9fbc86950e4661188161ee643f0987d032c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/bda3d9fbc86950e4661188161ee643f0987d032c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/bda3d9fbc86950e4661188161ee643f0987d032c"
    }
  ],
  "stats": {
    "total": 37,
    "additions": 33,
    "deletions": 4
  },
  "files": [
    {
      "sha": "dd19f3e57ed41671770304ff6264d76bcd0d6df3",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d86d1fc7f988f52da4711a86c078194347ab6482/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d86d1fc7f988f52da4711a86c078194347ab6482/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=d86d1fc7f988f52da4711a86c078194347ab6482",
      "patch": "@@ -1,3 +1,12 @@\n+2021-08-11  Matt Jacobson  <mhjacobson@me.com>\n+\n+\t* config/tc-avr.c (enum options): Add option flag.\n+\t(struct option): Add option -mno-dollar-line-separator.\n+\t(md_parse_option): Adjust treatment of $ when option is present.\n+\t(usage): Mention the new option.\n+\t* config/tc-avr.h: Use avr_line_separator_chars.\n+\t* doc/c-avr.texi: Document the new option.\n+\n 2021-08-11  Nick Clifton  <nickc@redhat.com>\n \n \t* config/tc-tic4x.c (tic4x_gen_to_words): Fix typo."
    },
    {
      "sha": "e731ea9b7d9d482e43aeb54d0bcad8c7d29fc51e",
      "filename": "gas/config/tc-avr.c",
      "status": "modified",
      "additions": 12,
      "deletions": 2,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d86d1fc7f988f52da4711a86c078194347ab6482/gas/config/tc-avr.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d86d1fc7f988f52da4711a86c078194347ab6482/gas/config/tc-avr.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-avr.c?ref=d86d1fc7f988f52da4711a86c078194347ab6482",
      "patch": "@@ -157,7 +157,9 @@ static struct avr_opcodes_s *avr_gccisr_opcode;\n \n const char comment_chars[] = \";\";\n const char line_comment_chars[] = \"#\";\n-const char line_separator_chars[] = \"$\";\n+\n+const char *avr_line_separator_chars = \"$\";\n+static const char *avr_line_separator_chars_no_dollar = \"\";\n \n const char *md_shortopts = \"m:\";\n struct mcu_type_s\n@@ -565,7 +567,8 @@ enum options\n   OPTION_ISA_RMW,\n   OPTION_LINK_RELAX,\n   OPTION_NO_LINK_RELAX,\n-  OPTION_HAVE_GCCISR\n+  OPTION_HAVE_GCCISR,\n+  OPTION_NO_DOLLAR_LINE_SEPARATOR,\n };\n \n struct option md_longopts[] =\n@@ -578,6 +581,7 @@ struct option md_longopts[] =\n   { \"mlink-relax\",  no_argument, NULL, OPTION_LINK_RELAX  },\n   { \"mno-link-relax\",  no_argument, NULL, OPTION_NO_LINK_RELAX  },\n   { \"mgcc-isr\",     no_argument, NULL, OPTION_HAVE_GCCISR },\n+  { \"mno-dollar-line-separator\", no_argument, NULL, OPTION_NO_DOLLAR_LINE_SEPARATOR },\n   { NULL, no_argument, NULL, 0 }\n };\n \n@@ -687,6 +691,8 @@ md_show_usage (FILE *stream)\n \t\"  -mlink-relax     generate relocations for linker relaxation (default)\\n\"\n \t\"  -mno-link-relax  don't generate relocations for linker relaxation.\\n\"\n \t\"  -mgcc-isr        accept the __gcc_isr pseudo-instruction.\\n\"\n+\t\"  -mno-dollar-line-separator\\n\"\n+        \"                   do not treat the $ character as a line separator.\\n\"\n         ));\n   show_mcu_list (stream);\n }\n@@ -756,6 +762,10 @@ md_parse_option (int c, const char *arg)\n     case OPTION_HAVE_GCCISR:\n       avr_opt.have_gccisr = 1;\n       return 1;\n+    case OPTION_NO_DOLLAR_LINE_SEPARATOR:\n+      avr_line_separator_chars = avr_line_separator_chars_no_dollar;\n+      lex_type['$'] = LEX_NAME | LEX_BEGIN_NAME;\n+      return 1;\n     }\n \n   return 0;"
    },
    {
      "sha": "58626970fa897121ffdd17b40b0914a09db9dcac",
      "filename": "gas/config/tc-avr.h",
      "status": "modified",
      "additions": 4,
      "deletions": 1,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d86d1fc7f988f52da4711a86c078194347ab6482/gas/config/tc-avr.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d86d1fc7f988f52da4711a86c078194347ab6482/gas/config/tc-avr.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-avr.h?ref=d86d1fc7f988f52da4711a86c078194347ab6482",
      "patch": "@@ -143,7 +143,7 @@ extern int avr_force_relocation (struct fix *);\n    would print `12 34 56 78'.  The default value is 4.  */\n #define LISTING_WORD_SIZE 2\n \n-/* AVR port uses `$' as a logical line separator.  */\n+/* AVR port uses `$' as a logical line separator by default. */\n #define LEX_DOLLAR 0\n \n /* An `.lcomm' directive with no explicit alignment parameter will\n@@ -244,3 +244,6 @@ struct avr_frag_data\n #define TC_FRAG_TYPE\t\t\tstruct avr_frag_data\n #define TC_FRAG_INIT(frag, max_bytes)\tavr_frag_init (frag)\n extern void avr_frag_init (fragS *);\n+\n+#define tc_line_separator_chars avr_line_separator_chars\n+extern const char *avr_line_separator_chars;"
    },
    {
      "sha": "f83cbe130012f00d9e285a7e8a59263a7fe2327e",
      "filename": "gas/doc/c-avr.texi",
      "status": "modified",
      "additions": 8,
      "deletions": 1,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d86d1fc7f988f52da4711a86c078194347ab6482/gas/doc/c-avr.texi",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d86d1fc7f988f52da4711a86c078194347ab6482/gas/doc/c-avr.texi",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/doc/c-avr.texi?ref=d86d1fc7f988f52da4711a86c078194347ab6482",
      "patch": "@@ -159,6 +159,12 @@ information.\n @item -mgcc-isr\n Enable the @code{__gcc_isr} pseudo instruction.\n \n+@cindex @code{-mno-dollar-line-separator} command line option, AVR\n+@item -mno-dollar-line-separator\n+Do not treat the @code{$} character as a line separator character.\n+This is for languages where @code{$} is valid character inside symbol\n+names.\n+\n @end table\n \n \n@@ -189,7 +195,8 @@ control command (@pxref{Preprocessing}).\n @cindex AVR line separator\n \n The @samp{$} character can be used instead of a newline to separate\n-statements.\n+statements.  Note: the @option{-mno-dollar-line-separator} option\n+disables this behaviour.\n \n @node AVR-Regs\n @subsection Register Names"
    }
  ]
}