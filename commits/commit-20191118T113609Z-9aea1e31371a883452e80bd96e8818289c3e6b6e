{
  "sha": "9aea1e31371a883452e80bd96e8818289c3e6b6e",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OWFlYTFlMzEzNzFhODgzNDUyZTgwYmQ5NmU4ODE4Mjg5YzNlNmI2ZQ==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-11-18T02:01:55Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-11-18T11:36:09Z"
    },
    "message": "PR25196, abort in rewrite_elf_program_header\n\nThis patch introduces a new \"sorry, cannot handle this file\" bfd error\nstatus.  The idea is to use this error in cases where bfd hasn't found\na bfd_bad_value error, ie. an input file or set of options that are\ninvalid, but rather an input file that is simply too difficult to\nprocess.  Typically this might happen with fuzzed object files such as\nthe one in the PR, a wildly improbable core file.  Some things are\njust not worth wasting time over to fix \"properly\".\n\n\tPR 25196\n\t* bfd.c (bfd_error_type): Add bfd_error_sorry.\n\t(bfd_errmsgs): Likewise.\n\t* elf.c (rewrite_elf_program_header): Don't abort on confused\n\tlma/alignment.  Replace bfd_error_bad_value with bfd_error_sorry.\n\t(_bfd_elf_validate_reloc): Use bfd_error_sorry.\n\t(_bfd_elf_final_write_processing): Likewise.\n\t* bfd-in2.h: Regenerate.",
    "tree": {
      "sha": "c1a28a6b86dfa423cef5cb9cc6057deb8df83264",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c1a28a6b86dfa423cef5cb9cc6057deb8df83264"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/9aea1e31371a883452e80bd96e8818289c3e6b6e",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9aea1e31371a883452e80bd96e8818289c3e6b6e",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/9aea1e31371a883452e80bd96e8818289c3e6b6e",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9aea1e31371a883452e80bd96e8818289c3e6b6e/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "66f8b2cbbb675ccbcae56e2bdb6dae485878ec00",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/66f8b2cbbb675ccbcae56e2bdb6dae485878ec00",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/66f8b2cbbb675ccbcae56e2bdb6dae485878ec00"
    }
  ],
  "stats": {
    "total": 23,
    "additions": 19,
    "deletions": 4
  },
  "files": [
    {
      "sha": "21842080380283a58eb2c19756123ec53ed6864e",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9aea1e31371a883452e80bd96e8818289c3e6b6e/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9aea1e31371a883452e80bd96e8818289c3e6b6e/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=9aea1e31371a883452e80bd96e8818289c3e6b6e",
      "patch": "@@ -1,3 +1,14 @@\n+2019-11-18  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 25196\n+\t* bfd.c (bfd_error_type): Add bfd_error_sorry.\n+\t(bfd_errmsgs): Likewise.\n+\t* elf.c (rewrite_elf_program_header): Don't abort on confused\n+\tlma/alignment.  Replace bfd_error_bad_value with bfd_error_sorry.\n+\t(_bfd_elf_validate_reloc): Use bfd_error_sorry.\n+\t(_bfd_elf_final_write_processing): Likewise.\n+\t* bfd-in2.h: Regenerate.\n+\n 2019-11-12  Jim Wilson  <jimw@sifive.com>\n \n \tPR 25181"
    },
    {
      "sha": "a00dfa35150528dbbe3e411b71c93d457c4cdda7",
      "filename": "bfd/bfd-in2.h",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9aea1e31371a883452e80bd96e8818289c3e6b6e/bfd/bfd-in2.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9aea1e31371a883452e80bd96e8818289c3e6b6e/bfd/bfd-in2.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/bfd-in2.h?ref=9aea1e31371a883452e80bd96e8818289c3e6b6e",
      "patch": "@@ -6964,6 +6964,7 @@ typedef enum bfd_error\n   bfd_error_bad_value,\n   bfd_error_file_truncated,\n   bfd_error_file_too_big,\n+  bfd_error_sorry,\n   bfd_error_on_input,\n   bfd_error_invalid_error_code\n }"
    },
    {
      "sha": "e92213b543eb5daaec392fd93cf0a17accbf684a",
      "filename": "bfd/bfd.c",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9aea1e31371a883452e80bd96e8818289c3e6b6e/bfd/bfd.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9aea1e31371a883452e80bd96e8818289c3e6b6e/bfd/bfd.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/bfd.c?ref=9aea1e31371a883452e80bd96e8818289c3e6b6e",
      "patch": "@@ -655,6 +655,7 @@ CODE_FRAGMENT\n .  bfd_error_bad_value,\n .  bfd_error_file_truncated,\n .  bfd_error_file_too_big,\n+.  bfd_error_sorry,\n .  bfd_error_on_input,\n .  bfd_error_invalid_error_code\n .}\n@@ -688,6 +689,7 @@ const char *const bfd_errmsgs[] =\n   N_(\"bad value\"),\n   N_(\"file truncated\"),\n   N_(\"file too big\"),\n+  N_(\"sorry, cannot handle this file\"),\n   N_(\"error reading %s: %s\"),\n   N_(\"#<invalid error code>\")\n };"
    },
    {
      "sha": "e10099842b805d9278d234ad8319063dc6285960",
      "filename": "bfd/elf.c",
      "status": "modified",
      "additions": 5,
      "deletions": 4,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9aea1e31371a883452e80bd96e8818289c3e6b6e/bfd/elf.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9aea1e31371a883452e80bd96e8818289c3e6b6e/bfd/elf.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf.c?ref=9aea1e31371a883452e80bd96e8818289c3e6b6e",
      "patch": "@@ -7324,7 +7324,7 @@ rewrite_elf_program_header (bfd *ibfd, bfd *obfd)\n \t\t\t\t\t  : 0),\n \t\t\t\t       output_section->alignment_power)\n \t\t\t  != output_section->lma)\n-\t\t\tabort ();\n+\t\t\tgoto sorry;\n \t\t    }\n \t\t  else\n \t\t    {\n@@ -7363,7 +7363,8 @@ rewrite_elf_program_header (bfd *ibfd, bfd *obfd)\n \t     negative size - or segments that do not contain any sections.  */\n \t  if (map->count == 0)\n \t    {\n-\t      bfd_set_error (bfd_error_bad_value);\n+\t    sorry:\n+\t      bfd_set_error (bfd_error_sorry);\n \t      free (sections);\n \t      return FALSE;\n \t    }\n@@ -9277,7 +9278,7 @@ _bfd_elf_validate_reloc (bfd *abfd, arelent *areloc)\n   /* xgettext:c-format */\n   _bfd_error_handler (_(\"%pB: %s unsupported\"),\n \t\t      abfd, areloc->howto->name);\n-  bfd_set_error (bfd_error_bad_value);\n+  bfd_set_error (bfd_error_sorry);\n   return FALSE;\n }\n \n@@ -12249,7 +12250,7 @@ _bfd_elf_final_write_processing (bfd *abfd)\n \t    _bfd_error_handler (_(\"symbol type STT_GNU_IFUNC is unsupported\"));\n \t  if (elf_tdata (abfd)->has_gnu_osabi & elf_gnu_osabi_unique)\n \t    _bfd_error_handler (_(\"symbol binding STB_GNU_UNIQUE is unsupported\"));\n-\t  bfd_set_error (bfd_error_bad_value);\n+\t  bfd_set_error (bfd_error_sorry);\n \t  return FALSE;\n \t}\n     }"
    }
  ]
}