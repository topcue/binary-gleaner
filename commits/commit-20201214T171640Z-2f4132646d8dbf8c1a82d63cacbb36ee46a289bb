{
  "sha": "2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MmY0MTMyNjQ2ZDhkYmY4YzFhODJkNjNjYWNiYjM2ZWU0NmEyODliYg==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-12-14T17:16:40Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-12-14T17:16:40Z"
    },
    "message": "[gdb/testsuite] Don't pass -fPIC to gdb_compile_shlib\n\nWhen running test-case gdb.base/info-shared.exp, I see in gdb.log:\n...\nExecuting on host: \\\n  gcc ... -fPIC -fpic -c -o info-shared-solib1.c.o info-shared-solib1.c\n...\n\nThe -fPIC comes from the test-case:\n...\nif { [gdb_compile_shlib $srcfile_lib1 $binfile_lib1 \\\n         [list additional_flags=-fPIC]] != \"\" } {\n...\nbut the -fpic, which overrides the -fPIC comes from gdb_compile_shlib.\n\nThe proc gdb_compile_shlib adds the -fpic or similar dependent on platform\nand compiler.  However, in some cases it doesn't add anything, which is\nprobably why all those test-case pass -fPIC.\n\nFix this by removing -fPIC from all the calls to gdb_compile_shlib, and\nensuring that gdb_compile_shlib takes care of adding it, if required.\n\nTested on x86_64-linux.\n\ngdb/testsuite/ChangeLog:\n\n2020-12-14  Tom de Vries  <tdevries@suse.de>\n\n\t* lib/gdb.exp (gdb_compile_shlib): Make sure it's not necessary to\n\tpass -fPIC.\n\t* gdb.ada/catch_ex_std.exp: Don't pass -fPIC to gdb_compile_shlib.\n\t* gdb.base/break-probes.exp: Same.\n\t* gdb.base/ctxobj.exp: Same.\n\t* gdb.base/dso2dso.exp: Same.\n\t* gdb.base/global-var-nested-by-dso.exp: Same.\n\t* gdb.base/info-shared.exp: Same.\n\t* gdb.base/jit-reader-simple.exp: Same.\n\t* gdb.base/print-file-var.exp: Same.\n\t* gdb.base/skip-solib.exp: Same.\n\t* gdb.btrace/dlopen.exp: Same.",
    "tree": {
      "sha": "07f08e58b9b458cf56003a2ecc0c50e0d8b5f1f7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/07f08e58b9b458cf56003a2ecc0c50e0d8b5f1f7"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a6f3c8a1a8353424f00946f073e11c321119a719",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a6f3c8a1a8353424f00946f073e11c321119a719",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/a6f3c8a1a8353424f00946f073e11c321119a719"
    }
  ],
  "stats": {
    "total": 61,
    "additions": 38,
    "deletions": 23
  },
  "files": [
    {
      "sha": "1c522e83193ed4fcf4264b6c35f03b38d35288c6",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 15,
      "deletions": 0,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -1,3 +1,18 @@\n+2020-12-14  Tom de Vries  <tdevries@suse.de>\n+\n+\t* lib/gdb.exp (gdb_compile_shlib): Make sure it's not necessary to\n+\tpass -fPIC.\n+\t* gdb.ada/catch_ex_std.exp: Don't pass -fPIC to gdb_compile_shlib.\n+\t* gdb.base/break-probes.exp: Same.\n+\t* gdb.base/ctxobj.exp: Same.\n+\t* gdb.base/dso2dso.exp: Same.\n+\t* gdb.base/global-var-nested-by-dso.exp: Same.\n+\t* gdb.base/info-shared.exp: Same.\n+\t* gdb.base/jit-reader-simple.exp: Same.\n+\t* gdb.base/print-file-var.exp: Same.\n+\t* gdb.base/skip-solib.exp: Same.\n+\t* gdb.btrace/dlopen.exp: Same.\n+\n 2020-12-14  Tom de Vries  <tdevries@suse.de>\n \n \tPR testsuite/26963"
    },
    {
      "sha": "d49cbab93df9127706431ff1c4e36795eeda7095",
      "filename": "gdb/testsuite/gdb.ada/catch_ex_std.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.ada/catch_ex_std.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.ada/catch_ex_std.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.ada/catch_ex_std.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -29,8 +29,7 @@ set sofile [standard_output_file libsome_package.so]\n set outdir [file dirname $binfile]\n \n # Create the shared library.\n-if {[gdb_compile_shlib $srcfile2 $sofile \\\n-\t {ada debug additional_flags=-fPIC}] != \"\"} {\n+if {[gdb_compile_shlib $srcfile2 $sofile {ada debug}] != \"\"} {\n     return -1\n }\n "
    },
    {
      "sha": "96ef93d9f569c6d6332a6079e66f816879a8fdfc",
      "filename": "gdb/testsuite/gdb.base/break-probes.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/break-probes.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/break-probes.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/break-probes.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -30,8 +30,7 @@ if { [istarget \"*bsd*\"] } {\n }\n set probes_bp \"dl_main\"\n \n-if { [gdb_compile_shlib $srcfile_lib $binfile_lib \\\n-\t  [list additional_flags=-fPIC]] != \"\" } {\n+if { [gdb_compile_shlib $srcfile_lib $binfile_lib {}] != \"\" } {\n     untested \"failed to compile shared library\"\n     return -1\n }"
    },
    {
      "sha": "faf209cc0da37fa4f2ee4c9fdcbde99e23f77daa",
      "filename": "gdb/testsuite/gdb.base/ctxobj.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/ctxobj.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/ctxobj.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/ctxobj.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -33,10 +33,10 @@ set libsrc [list \"${srcdir}/${subdir}/ctxobj-v.c\" \\\n set libobj1 [standard_output_file libctxobj1.so]\n set libobj2 [standard_output_file libctxobj2.so]\n \n-set libobj1_opts { debug additional_flags=-fPIC\n+set libobj1_opts { debug\n                    additional_flags=-DVERSION=104\n                    additional_flags=-DGET_VERSION=get_version_1 }\n-set libobj2_opts { debug additional_flags=-fPIC\n+set libobj2_opts { debug\n                    additional_flags=-DVERSION=203\n                    additional_flags=-DGET_VERSION=get_version_2 }\n "
    },
    {
      "sha": "4c0b27955d0ef33bc932780dca3b40ca40c08e23",
      "filename": "gdb/testsuite/gdb.base/dso2dso.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/dso2dso.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/dso2dso.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/dso2dso.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -40,13 +40,13 @@ set srcfile_libdso1 $srcdir/$subdir/$libdso1.c\n set binfile_libdso1 [standard_output_file $libdso1.so]\n \n if { [gdb_compile_shlib $srcfile_libdso2 $binfile_libdso2 \\\n-\t[list debug additional_flags=-fPIC]] != \"\" } {\n+\t[list debug]] != \"\" } {\n   untested \"failed to compile shared library 2\"\n   return -1\n }\n \n if { [gdb_compile_shlib $srcfile_libdso1 $binfile_libdso1 \\\n-\t[list debug additional_flags=-fPIC]] != \"\" } {\n+\t[list debug]] != \"\" } {\n   untested \"failed to compile shared library 1\"\n   return -1\n }"
    },
    {
      "sha": "c2775950155a4aa05df3fc3a39cb9ac91df1aaa2",
      "filename": "gdb/testsuite/gdb.base/global-var-nested-by-dso.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/global-var-nested-by-dso.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/global-var-nested-by-dso.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/global-var-nested-by-dso.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -28,13 +28,13 @@ set srcfile_lib2 $srcdir/$subdir/$lib2name.c\n set binfile_lib2 [standard_output_file $lib2name.so]\n \n if { [gdb_compile_shlib $srcfile_lib1 $binfile_lib1 \\\n-\t[list debug additional_flags=-fPIC]] != \"\" } {\n+\t[list debug]] != \"\" } {\n   untested \"failed to compile shared library 1\"\n   return -1\n }\n \n if { [gdb_compile_shlib $srcfile_lib2 $binfile_lib2 \\\n-\t[list debug additional_flags=-fPIC]] != \"\" } {\n+\t[list debug]] != \"\" } {\n   untested \"failed to compile shared library 2\"\n   return -1\n }"
    },
    {
      "sha": "7b8ce5b11e71ac81f088567a7a8c84c3b9ce0317",
      "filename": "gdb/testsuite/gdb.base/info-shared.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 4,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/info-shared.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/info-shared.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/info-shared.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -29,14 +29,12 @@ set srcfile_lib2 $srcdir/$subdir/$lib2name.c\n set binfile_lib2 [standard_output_file $lib2name.so]\n set define2 -DSHLIB2_NAME=\\\"$binfile_lib2\\\"\n \n-if { [gdb_compile_shlib $srcfile_lib1 $binfile_lib1 \\\n-\t  [list additional_flags=-fPIC]] != \"\" } {\n+if { [gdb_compile_shlib $srcfile_lib1 $binfile_lib1 {}] != \"\" } {\n     untested \"failed to compile shared library 1\"\n     return -1\n }\n \n-if { [gdb_compile_shlib $srcfile_lib2 $binfile_lib2 \\\n-\t  [list additional_flags=-fPIC]] != \"\" } {\n+if { [gdb_compile_shlib $srcfile_lib2 $binfile_lib2 {}] != \"\" } {\n     untested \"failed to compile shared library 2\"\n     return -1\n }"
    },
    {
      "sha": "99c4dcf7325c1986ccd963aca110ee9ae0b46e8f",
      "filename": "gdb/testsuite/gdb.base/jit-reader-simple.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/jit-reader-simple.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/jit-reader-simple.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/jit-reader-simple.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -56,7 +56,7 @@ proc build_shared_jit {{options \"\"}} {\n     global testfile\n     global srcfile_lib binfile_lib binfile_lib2\n \n-    lappend options \"debug additional_flags=-fPIC\"\n+    lappend options \"debug\"\n     if { [gdb_compile_shlib $srcfile_lib $binfile_lib $options] != \"\" } {\n \treturn -1\n     }"
    },
    {
      "sha": "219bedcde4360534bb14658653a8bc71b230791e",
      "filename": "gdb/testsuite/gdb.base/print-file-var.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/print-file-var.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/print-file-var.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/print-file-var.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -42,7 +42,7 @@ proc test {hidden dlopen version_id_main lang} {\n     set libobj1 [standard_output_file ${lib1}$suffix.so]\n     set libobj2 [standard_output_file ${lib2}$suffix.so]\n \n-    set lib_opts { debug additional_flags=-fPIC $lang }\n+    set lib_opts { debug $lang }\n     lappend lib_opts \"additional_flags=-DHIDDEN=$hidden\"\n \n     if { [gdb_compile_shlib ${srcdir}/${subdir}/${lib1}.c \\"
    },
    {
      "sha": "8ecba70aa05ca5b83e0b05728190880cb3a9ff88",
      "filename": "gdb/testsuite/gdb.base/skip-solib.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/skip-solib.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.base/skip-solib.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/skip-solib.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -39,7 +39,7 @@ set binfile_lib [standard_output_file ${libname}.so]\n # the main program.\n #\n \n-if {[gdb_compile_shlib ${srcdir}/${subdir}/${srcfile_lib} ${binfile_lib} [list debug additional_flags=-fPIC -Wl,-soname,${libname}.so]] != \"\"} {\n+if {[gdb_compile_shlib ${srcdir}/${subdir}/${srcfile_lib} ${binfile_lib} [list debug -Wl,-soname,${libname}.so]] != \"\"} {\n     return -1\n }\n "
    },
    {
      "sha": "6839b0f4f43954b7632f2c11c116bb00f2183843",
      "filename": "gdb/testsuite/gdb.btrace/dlopen.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 2,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.btrace/dlopen.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/gdb.btrace/dlopen.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.btrace/dlopen.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -31,8 +31,7 @@ set basename_lib dlopen-dso\n set srcfile_lib $srcdir/$subdir/$basename_lib.c\n set binfile_lib [standard_output_file $basename_lib.so]\n \n-if { [gdb_compile_shlib $srcfile_lib $binfile_lib \\\n-\t  [list additional_flags=-fPIC]] != \"\" } {\n+if { [gdb_compile_shlib $srcfile_lib $binfile_lib {}] != \"\" } {\n     untested \"failed to prepare shlib\"\n     return -1\n }"
    },
    {
      "sha": "94bdf1ac856fc49981f8a276f1d4522b75cdd9f3",
      "filename": "gdb/testsuite/lib/gdb.exp",
      "status": "modified",
      "additions": 9,
      "deletions": 4,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/lib/gdb.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f4132646d8dbf8c1a82d63cacbb36ee46a289bb/gdb/testsuite/lib/gdb.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/lib/gdb.exp?ref=2f4132646d8dbf8c1a82d63cacbb36ee46a289bb",
      "patch": "@@ -4304,17 +4304,21 @@ proc gdb_compile_shlib {sources dest options} {\n             lappend obj_options \"additional_flags=-qpic\"\n         }\n \t\"clang-*\" {\n-\t    if { !([istarget \"*-*-cygwin*\"]\n-\t\t   || [istarget \"*-*-mingw*\"]) } {\n+\t    if { [istarget \"*-*-cygwin*\"]\n+\t\t || [istarget \"*-*-mingw*\"] } {\n+\t\tlappend obj_options \"additional_flags=-fPIC\"\n+\t    } else {\n \t\tlappend obj_options \"additional_flags=-fpic\"\n \t    }\n \t}\n         \"gcc-*\" {\n-            if { !([istarget \"powerpc*-*-aix*\"]\n+            if { [istarget \"powerpc*-*-aix*\"]\n                    || [istarget \"rs6000*-*-aix*\"]\n                    || [istarget \"*-*-cygwin*\"]\n                    || [istarget \"*-*-mingw*\"]\n-                   || [istarget \"*-*-pe*\"]) } {\n+                   || [istarget \"*-*-pe*\"] } {\n+                lappend obj_options \"additional_flags=-fPIC\"\n+\t    } else {\n                 lappend obj_options \"additional_flags=-fpic\"\n             }\n         }\n@@ -4323,6 +4327,7 @@ proc gdb_compile_shlib {sources dest options} {\n         }\n         default {\n \t    # don't know what the compiler is...\n+\t    lappend obj_options \"additional_flags=-fPIC\"\n         }\n     }\n "
    }
  ]
}