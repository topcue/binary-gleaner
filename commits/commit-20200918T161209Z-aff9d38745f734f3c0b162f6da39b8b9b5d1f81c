{
  "sha": "aff9d38745f734f3c0b162f6da39b8b9b5d1f81c",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YWZmOWQzODc0NWY3MzRmM2MwYjE2MmY2ZGEzOWI4YjliNWQxZjgxYw==",
  "commit": {
    "author": {
      "name": "Jon Turney",
      "email": "jon.turney@dronecode.org.uk",
      "date": "2020-06-30T15:37:20Z"
    },
    "committer": {
      "name": "Jon Turney",
      "email": "jon.turney@dronecode.org.uk",
      "date": "2020-09-18T16:12:09Z"
    },
    "message": "Add amd64_windows_gregset_reg_offset\n\nRegister a gregset_reg_offset array for Cygwin x86_64 core dump parsing\n(this causes the generic i386_iterate_over_regset_sections() '.reg'\nsection iterator to get installed by i386_gdbarch_init()).\n\ngdb/ChangeLog:\n\n2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n\n\t* amd64-windows-tdep.c(amd64_windows_gregset_reg_offset): Add.\n\t(amd64_windows_init_abi_common): ... and register.",
    "tree": {
      "sha": "afb27454123922cfd8fd2a1594a2f060d6476a4b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/afb27454123922cfd8fd2a1594a2f060d6476a4b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/aff9d38745f734f3c0b162f6da39b8b9b5d1f81c",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIcBAABAgAGBQJfZNxaAAoJEMfIbwNwKFyBxbYQAN64cvfXS1H5okP3YtQnhdig\nb+dsr4L67ZCEJfRhG+87DgY5eqTSrc/LeaH8FepBmHl000GTMVMIUdtdw6JHzqpP\nqfRVoHvg5TfBw/c+fkPJ7e9BgIUppIg62cP1cqsb1aK//2he7qa38k6545QvARv3\ncH4/kKR2/JaNs9ZRJdN7iuMcjjbiWgbzFAqTQvrlBHd6WIjO/CU7S2EMqu4PiLYh\nsLA31o+IRRUKpJ5WYjKPLXSek0cWzhTJzLP3mVtb3irpjTH8wwHFLrPcoltOyzav\nou/wtzCzJXgMVnGINK+ljZc9eM705O7g67qqlc1zr8u8GdDMiaX/pSMOeQGcV5AN\nSzPSCEJU4fza1GrHRflEOkoAisr82Vr/Q6WQykw21Sv7FpvC136Jb/AZJ6HsRhQF\ndpteLGLi8r2UUvF19WSYtb/kCA9fEa+XTVcfjoCbl0mRJwqbSf0Gpwlou/lLvVLg\nHcx+bdgWOasB5A5WbzdbqgkvUtLstjGrgfsTVaqRI3wTsHCr6uGBndwoBSzrRUjR\nzksGuTalReb6bY8cq+YjSDJFRdkozh8tBgpL04perhL5YTVyCbvAanQ5JSlHxnwZ\nadkb1mONHZLaeZgW41c1R2zRG7jcH8FRFi1rHebHEvBplh709R6G0qUK0PHFCZgE\n3F8aCMBIxtTh6JLf678J\n=TT/b\n-----END PGP SIGNATURE-----",
      "payload": "tree afb27454123922cfd8fd2a1594a2f060d6476a4b\nparent 7d155da3d945350fb40e12c64511e0d719df3137\nauthor Jon Turney <jon.turney@dronecode.org.uk> 1593531440 +0100\ncommitter Jon Turney <jon.turney@dronecode.org.uk> 1600445529 +0100\n\nAdd amd64_windows_gregset_reg_offset\n\nRegister a gregset_reg_offset array for Cygwin x86_64 core dump parsing\n(this causes the generic i386_iterate_over_regset_sections() '.reg'\nsection iterator to get installed by i386_gdbarch_init()).\n\ngdb/ChangeLog:\n\n2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n\n\t* amd64-windows-tdep.c(amd64_windows_gregset_reg_offset): Add.\n\t(amd64_windows_init_abi_common): ... and register.\n"
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/aff9d38745f734f3c0b162f6da39b8b9b5d1f81c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/aff9d38745f734f3c0b162f6da39b8b9b5d1f81c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/aff9d38745f734f3c0b162f6da39b8b9b5d1f81c/comments",
  "author": {
    "login": "jon-turney",
    "id": 3497232,
    "node_id": "MDQ6VXNlcjM0OTcyMzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3497232?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jon-turney",
    "html_url": "https://github.com/jon-turney",
    "followers_url": "https://api.github.com/users/jon-turney/followers",
    "following_url": "https://api.github.com/users/jon-turney/following{/other_user}",
    "gists_url": "https://api.github.com/users/jon-turney/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jon-turney/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jon-turney/subscriptions",
    "organizations_url": "https://api.github.com/users/jon-turney/orgs",
    "repos_url": "https://api.github.com/users/jon-turney/repos",
    "events_url": "https://api.github.com/users/jon-turney/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jon-turney/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jon-turney",
    "id": 3497232,
    "node_id": "MDQ6VXNlcjM0OTcyMzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3497232?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jon-turney",
    "html_url": "https://github.com/jon-turney",
    "followers_url": "https://api.github.com/users/jon-turney/followers",
    "following_url": "https://api.github.com/users/jon-turney/following{/other_user}",
    "gists_url": "https://api.github.com/users/jon-turney/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jon-turney/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jon-turney/subscriptions",
    "organizations_url": "https://api.github.com/users/jon-turney/orgs",
    "repos_url": "https://api.github.com/users/jon-turney/repos",
    "events_url": "https://api.github.com/users/jon-turney/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jon-turney/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "7d155da3d945350fb40e12c64511e0d719df3137",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7d155da3d945350fb40e12c64511e0d719df3137",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/7d155da3d945350fb40e12c64511e0d719df3137"
    }
  ],
  "stats": {
    "total": 75,
    "additions": 75,
    "deletions": 0
  },
  "files": [
    {
      "sha": "dbac4255bb1c69a8b97b47b02736c1fbafe7f36f",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/aff9d38745f734f3c0b162f6da39b8b9b5d1f81c/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/aff9d38745f734f3c0b162f6da39b8b9b5d1f81c/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=aff9d38745f734f3c0b162f6da39b8b9b5d1f81c",
      "patch": "@@ -1,3 +1,8 @@\n+2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n+\n+\t* amd64-windows-tdep.c(amd64_windows_gregset_reg_offset): Add.\n+\t(amd64_windows_init_abi_common): ... and register.\n+\n 2020-07-01  Jon Turney  <jon.turney@dronecode.org.uk>\n \n \t* amd64-windows-tdep.c (amd64_cygwin_core_osabi_sniffer): New."
    },
    {
      "sha": "7bb98bd2bd2c5e9f9a18c043203966e09f115857",
      "filename": "gdb/amd64-windows-tdep.c",
      "status": "modified",
      "additions": 70,
      "deletions": 0,
      "changes": 70,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/aff9d38745f734f3c0b162f6da39b8b9b5d1f81c/gdb/amd64-windows-tdep.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/aff9d38745f734f3c0b162f6da39b8b9b5d1f81c/gdb/amd64-windows-tdep.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/amd64-windows-tdep.c?ref=aff9d38745f734f3c0b162f6da39b8b9b5d1f81c",
      "patch": "@@ -42,6 +42,69 @@ static int amd64_windows_dummy_call_integer_regs[] =\n   AMD64_R9_REGNUM            /* %r9 */\n };\n \n+/* This vector maps GDB's idea of a register's number into an offset into\n+   the Windows API CONTEXT structure.  */\n+static int amd64_windows_gregset_reg_offset[] =\n+{\n+  120, /* Rax */\n+  144, /* Rbx */\n+  128, /* Rcx */\n+  136, /* Rdx */\n+  168, /* Rsi */\n+  176, /* Rdi */\n+  160, /* Rbp */\n+  152, /* Rsp */\n+  184, /* R8 */\n+  192, /* R9 */\n+  200, /* R10 */\n+  208, /* R11 */\n+  216, /* R12 */\n+  224, /* R13 */\n+  232, /* R14 */\n+  240, /* R15 */\n+  248, /* Rip */\n+  68,  /* EFlags */\n+  56,  /* SegCs */\n+  66,  /* SegSs */\n+  58,  /* SegDs */\n+  60,  /* SegEs */\n+  62,  /* SegFs */\n+  64,  /* SegGs */\n+  288, /* FloatSave.FloatRegisters[0] */\n+  304, /* FloatSave.FloatRegisters[1] */\n+  320, /* FloatSave.FloatRegisters[2] */\n+  336, /* FloatSave.FloatRegisters[3] */\n+  352, /* FloatSave.FloatRegisters[4] */\n+  368, /* FloatSave.FloatRegisters[5] */\n+  384, /* FloatSave.FloatRegisters[6] */\n+  400, /* FloatSave.FloatRegisters[7] */\n+  256, /* FloatSave.ControlWord */\n+  258, /* FloatSave.StatusWord */\n+  260, /* FloatSave.TagWord */\n+  268, /* FloatSave.ErrorSelector */\n+  264, /* FloatSave.ErrorOffset */\n+  276, /* FloatSave.DataSelector */\n+  272, /* FloatSave.DataOffset */\n+  268, /* FloatSave.ErrorSelector */\n+  416, /* Xmm0 */\n+  432, /* Xmm1 */\n+  448, /* Xmm2 */\n+  464, /* Xmm3 */\n+  480, /* Xmm4 */\n+  496, /* Xmm5 */\n+  512, /* Xmm6 */\n+  528, /* Xmm7 */\n+  544, /* Xmm8 */\n+  560, /* Xmm9 */\n+  576, /* Xmm10 */\n+  592, /* Xmm11 */\n+  608, /* Xmm12 */\n+  624, /* Xmm13 */\n+  640, /* Xmm14 */\n+  656, /* Xmm15 */\n+  280, /* FloatSave.MxCsr */\n+};\n+\n #define AMD64_WINDOWS_SIZEOF_GREGSET 1232\n \n /* Return nonzero if an argument of type TYPE should be passed\n@@ -1215,6 +1278,8 @@ amd64_windows_auto_wide_charset (void)\n static void\n amd64_windows_init_abi_common (gdbarch_info info, struct gdbarch *gdbarch)\n {\n+  struct gdbarch_tdep *tdep = gdbarch_tdep (gdbarch);\n+\n   /* The dwarf2 unwinder (appended very early by i386_gdbarch_init) is\n      preferred over the SEH one.  The reasons are:\n      - binaries without SEH but with dwarf2 debug info are correctly handled\n@@ -1240,6 +1305,11 @@ amd64_windows_init_abi_common (gdbarch_info info, struct gdbarch *gdbarch)\n \n   set_gdbarch_skip_prologue (gdbarch, amd64_windows_skip_prologue);\n \n+  tdep->gregset_reg_offset = amd64_windows_gregset_reg_offset;\n+  tdep->gregset_num_regs = ARRAY_SIZE (amd64_windows_gregset_reg_offset);\n+  tdep->sizeof_gregset = AMD64_WINDOWS_SIZEOF_GREGSET;\n+  tdep->sizeof_fpregset = 0;\n+\n   set_gdbarch_auto_wide_charset (gdbarch, amd64_windows_auto_wide_charset);\n }\n "
    }
  ]
}