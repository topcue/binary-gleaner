{
  "sha": "1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MWUxMjliYmVmYWRiZjA5YWNlMGZjN2ZjYjNjZmNkYTEzNzAwZTNiOA==",
  "commit": {
    "author": {
      "name": "Faraz Shahbazker",
      "email": "fshahbazker@wavecomp.com",
      "date": "2019-05-24T01:16:08Z"
    },
    "committer": {
      "name": "Faraz Shahbazker",
      "email": "fshahbazker@wavecomp.com",
      "date": "2019-05-28T17:49:16Z"
    },
    "message": "MIPS/LD: Skip overflow check for %pcrel_hi relocations\n\nOverflow checks were removed for all hi16 relocations except PC-relative\nhigh relocations per PR ld/16720.  Remove overflow checks from %pcrel_hi\nrelocations so that we can correctly handle negative offsets from PC.\n\nbfd/\n\t* elfxx-mips.c (mips_elf_calculate_relocation) <R_MIPS_PCHI16>:\n\tRemove overflow check.\n\nld/\n\t* testsuite/ld-mips-elf/undefweak-overflow.s: Remove test case\n\tfor pcrel_hi/pcrel_lo.\n\t* testsuite/ld-mips-elf/undefweak-overflow.d: Update to match.\n\t* testsuite/ld-mips-elf/reloc-pcrel-r6.s: New test source.\n\t* testsuite/ld-mips-elf/reloc-pcrel-r6.d: New test linker script.\n\t* testsuite/ld-mips-elf/reloc-pcrel-r6.ld: New test.\n\t* testsuite/ld-mips-elf/mips-elf.exp: Run the new test.",
    "tree": {
      "sha": "fb8da25dcc2cc23c404b557906b0215e62dee631",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/fb8da25dcc2cc23c404b557906b0215e62dee631"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/comments",
  "author": {
    "login": "farazs-github",
    "id": 57776434,
    "node_id": "MDQ6VXNlcjU3Nzc2NDM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/57776434?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/farazs-github",
    "html_url": "https://github.com/farazs-github",
    "followers_url": "https://api.github.com/users/farazs-github/followers",
    "following_url": "https://api.github.com/users/farazs-github/following{/other_user}",
    "gists_url": "https://api.github.com/users/farazs-github/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/farazs-github/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/farazs-github/subscriptions",
    "organizations_url": "https://api.github.com/users/farazs-github/orgs",
    "repos_url": "https://api.github.com/users/farazs-github/repos",
    "events_url": "https://api.github.com/users/farazs-github/events{/privacy}",
    "received_events_url": "https://api.github.com/users/farazs-github/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "farazs-github",
    "id": 57776434,
    "node_id": "MDQ6VXNlcjU3Nzc2NDM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/57776434?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/farazs-github",
    "html_url": "https://github.com/farazs-github",
    "followers_url": "https://api.github.com/users/farazs-github/followers",
    "following_url": "https://api.github.com/users/farazs-github/following{/other_user}",
    "gists_url": "https://api.github.com/users/farazs-github/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/farazs-github/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/farazs-github/subscriptions",
    "organizations_url": "https://api.github.com/users/farazs-github/orgs",
    "repos_url": "https://api.github.com/users/farazs-github/repos",
    "events_url": "https://api.github.com/users/farazs-github/events{/privacy}",
    "received_events_url": "https://api.github.com/users/farazs-github/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a2f4b66c9eb5210f8ef6038d7194af1e5f314f97",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a2f4b66c9eb5210f8ef6038d7194af1e5f314f97",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/a2f4b66c9eb5210f8ef6038d7194af1e5f314f97"
    }
  ],
  "stats": {
    "total": 91,
    "additions": 78,
    "deletions": 13
  },
  "files": [
    {
      "sha": "a6157a4b426fe2687e3b0c3648913447a07155bc",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -1,3 +1,8 @@\n+2019-05-28  Faraz Shahbazker  <fshahbazker@wavecomp.com>\n+\n+\t* elfxx-mips.c (mips_elf_calculate_relocation) <R_MIPS_PCHI16>:\n+\tRemove overflow check.\n+\n 2019-05-28  Alan Modra  <amodra@gmail.com>\n \n \tPR 24596"
    },
    {
      "sha": "55f891d7be70b16f8f0fcebf7d3eca26b71212ad",
      "filename": "bfd/elfxx-mips.c",
      "status": "modified",
      "additions": 0,
      "deletions": 2,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/bfd/elfxx-mips.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/bfd/elfxx-mips.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-mips.c?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -6326,8 +6326,6 @@ mips_elf_calculate_relocation (bfd *abfd, bfd *input_bfd,\n \n     case R_MIPS_PCHI16:\n       value = mips_elf_high (symbol + addend - p);\n-      if (was_local_p || h->root.root.type != bfd_link_hash_undefweak)\n-\toverflowed_p = mips_elf_overflow_p (value, 16);\n       value &= howto->dst_mask;\n       break;\n "
    },
    {
      "sha": "54bc8746dcc1f9bcb3765e3d4089fe79af4ab287",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -1,3 +1,13 @@\n+2019-05-28  Faraz Shahbazker  <fshahbazker@wavecomp.com>\n+\n+\t* testsuite/ld-mips-elf/undefweak-overflow.s: Remove test case\n+\tfor pcrel_hi/pcrel_lo.\n+\t* testsuite/ld-mips-elf/undefweak-overflow.d: Update to match.\n+\t* testsuite/ld-mips-elf/reloc-pcrel-r6.s: New test source.\n+\t* testsuite/ld-mips-elf/reloc-pcrel-r6.d: New test linker script.\n+\t* testsuite/ld-mips-elf/reloc-pcrel-r6.ld: New test.\n+\t* testsuite/ld-mips-elf/mips-elf.exp: Run the new test.\n+\n 2019-05-28  Alan Modra  <amodra@gmail.com>\n \n \tPR 24596"
    },
    {
      "sha": "1fee8efb8476e45a69fcef50e8f12fb872114a98",
      "filename": "ld/testsuite/ld-mips-elf/mips-elf.exp",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/mips-elf.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/mips-elf.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-mips-elf/mips-elf.exp?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -1656,3 +1656,5 @@ run_dump_test_o32 \"pic-reloc-6\"\n run_dump_test_n64 \"pic-reloc-7\"\n run_dump_test_n64 \"pic-reloc-7\" [list [list name (microMIPS)] \\\n \t\t\t\t      [list as \"-mmicromips\"]]\n+\n+run_dump_test_o32 \"reloc-pcrel-r6\""
    },
    {
      "sha": "ad4ac9e0020ff15ee02d2aefce4f8a8de1c10ede",
      "filename": "ld/testsuite/ld-mips-elf/reloc-pcrel-r6.d",
      "status": "added",
      "additions": 18,
      "deletions": 0,
      "changes": 18,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.d?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -0,0 +1,18 @@\n+#name: MIPS r6 PC-relative hi+lo relocations\n+#ld: -Treloc-pcrel-r6.ld -e0\n+#as: -mips32r6\n+#objdump: -dr --prefix-addresses --show-raw-insn\n+#dump: reloc-pcrel-r6.d\n+\n+.*: +file format .*mips.*\n+\n+Disassembly of section \\.text:\n+[0-9a-f]+ <test> ec9ed000 \tauipc\ta0,0xd000\n+[0-9a-f]+ <[^>]*> 24840001 \taddiu\ta0,a0,1\n+[0-9a-f]+ <[^>]*> ec9e0000 \tauipc\ta0,0x0\n+[0-9a-f]+ <[^>]*> 2484eff8 \taddiu\ta0,a0,-4104\n+[0-9a-f]+ <[^>]*> ec9e0001 \tauipc\ta0,0x1\n+[0-9a-f]+ <[^>]*> 2484eff0 \taddiu\ta0,a0,-4112\n+[0-9a-f]+ <[^>]*> ec9e4000 \tauipc\ta0,0x4000\n+[0-9a-f]+ <[^>]*> 2484ffe9 \taddiu\ta0,a0,-23\n+\t\\.\\.\\."
    },
    {
      "sha": "a40c7048c2df0fa29dc50724efd38cee6243272f",
      "filename": "ld/testsuite/ld-mips-elf/reloc-pcrel-r6.ld",
      "status": "added",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.ld",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.ld",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.ld?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -0,0 +1,9 @@\n+SECTIONS\n+{\n+  x1 = 0x10000001;\t/* lower and far  */\n+  x2 = 0x3ffff000;\t/* lower and near  */\n+  . = 0x40000000;\n+  .text : { *(.text) }\n+  x3 = 0x4000f000;\t/* high and near  */\n+  x4 = 0x80000001;\t/* high and far  */\n+}"
    },
    {
      "sha": "3cc8850c9954a213b27527c4df2b579e48033beb",
      "filename": "ld/testsuite/ld-mips-elf/reloc-pcrel-r6.s",
      "status": "added",
      "additions": 27,
      "deletions": 0,
      "changes": 27,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-mips-elf/reloc-pcrel-r6.s?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -0,0 +1,27 @@\n+\t.text\n+\t.globl test\n+\t.globl x1\n+\t.globl x2\n+\t.globl x3\n+\t.globl x4\n+\t.ent test\n+test:\n+1:\n+\tauipc\t$a0,%pcrel_hi(x1)\n+2:\n+\taddiu\t$a0,$a0,%pcrel_lo(x1+(2b-1b))\n+1:\n+\tauipc\t$a0,%pcrel_hi(x2)\n+2:\n+\taddiu\t$a0,$a0, %pcrel_lo(x2+(2b-1b))\n+1:\n+\tauipc\t$a0,%pcrel_hi(x3)\n+2:\n+\taddiu\t$a0,$a0,%pcrel_lo(x3+(2b-1b))\n+1:\n+\tauipc\t$a0,%pcrel_hi(x4)\n+2:\n+\taddiu\t$a0,$a0,%pcrel_lo(x4+(2b-1b))\n+\t.end test\n+\t.align\t2, 0\n+\t.space\t8"
    },
    {
      "sha": "bbed9970dffe39d1469d18f5681328c1a4dda86f",
      "filename": "ld/testsuite/ld-mips-elf/undefweak-overflow.d",
      "status": "modified",
      "additions": 7,
      "deletions": 9,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/undefweak-overflow.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/undefweak-overflow.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-mips-elf/undefweak-overflow.d?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -10,33 +10,31 @@\n [ 0-9a-f]+:\tec4ffffd \tlwpc\tv0,20000000 <_ftext>\n [ 0-9a-f]+:\tec5bfffe \tldpc\tv0,20000000 <_ftext>\n [ 0-9a-f]+:\tcbfffffa \tbc\t20000000 <_ftext>\n-[ 0-9a-f]+:\tec9ee000 \tauipc\ta0,0xe000\n-[ 0-9a-f]+:\t2484ffe8 \taddiu\ta0,a0,-24\n-[ 0-9a-f]+:\t1000fff7 \tb\t20000000 <_ftext>\n+[ 0-9a-f]+:\t1000fff9 \tb\t20000000 <_ftext>\n [ 0-9a-f]+:\t00000000 \tnop\n-[ 0-9a-f]+:\t0411fff5 \tbal\t20000000 <_ftext>\n+[ 0-9a-f]+:\t0411fff7 \tbal\t20000000 <_ftext>\n [ 0-9a-f]+:\t3c...... \tlui\ta0,0x....\n [ 0-9a-f]+:\t0c000000 \tjal\t20000000 <_ftext>\n [ 0-9a-f]+:\t00000000 \tnop\n [ 0-9a-f]+:\t08000000 \tj\t20000000 <_ftext>\n [ 0-9a-f]+:\t00000000 \tnop\n \n [0-9a-f]+ <micro>:\n-[ 0-9a-f]+:\t8e5f      \tbeqz\ta0,20000000 <_ftext>\n+[ 0-9a-f]+:\t8e63      \tbeqz\ta0,20000000 <_ftext>\n [ 0-9a-f]+:\t0c00      \tnop\n-[ 0-9a-f]+:\tcfdd      \tb\t20000000 <_ftext>\n+[ 0-9a-f]+:\tcfe1      \tb\t20000000 <_ftext>\n [ 0-9a-f]+:\t0c00      \tnop\n-[ 0-9a-f]+:\t9400 ffda \tb\t20000000 <_ftext>\n+[ 0-9a-f]+:\t9400 ffde \tb\t20000000 <_ftext>\n [ 0-9a-f]+:\t0c00      \tnop\n-[ 0-9a-f]+:\t4060 ffd7 \tbal\t20000000 <_ftext>\n+[ 0-9a-f]+:\t4060 ffdb \tbal\t20000000 <_ftext>\n [ 0-9a-f]+:\t0000 0000 \tnop\n [ 0-9a-f]+:\tf400 0000 \tjal\t20000000 <_ftext>\n [ 0-9a-f]+:\t0000 0000 \tnop\n [ 0-9a-f]+:\td400 0000 \tj\t20000000 <_ftext>\n [ 0-9a-f]+:\t0c00      \tnop\n \n [0-9a-f]+ <mips16>:\n-[ 0-9a-f]+:\tf7df 100c \tb\t20000000 <_ftext>\n+[ 0-9a-f]+:\tf7df 1010 \tb\t20000000 <_ftext>\n [ 0-9a-f]+:\t1800 0000 \tjal\t20000000 <_ftext>\n [ 0-9a-f]+:\t6500      \tnop\n #pass"
    },
    {
      "sha": "d439d7c7c734de4ba5251d153e6e939154a32406",
      "filename": "ld/testsuite/ld-mips-elf/undefweak-overflow.s",
      "status": "modified",
      "additions": 0,
      "deletions": 2,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/undefweak-overflow.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8/ld/testsuite/ld-mips-elf/undefweak-overflow.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-mips-elf/undefweak-overflow.s?ref=1e129bbefadbf09ace0fc7fcb3cfcda13700e3b8",
      "patch": "@@ -13,8 +13,6 @@ start:\n \tlwpc\t$2, foo\n \tldpc\t$2, foo\n \tbc\tfoo\n-\tauipc\t$4, %pcrel_hi(foo)\n-\taddiu\t$4, $4, %pcrel_lo(foo+4)\n \n \tb\tfoo\n \tnop"
    }
  ]
}