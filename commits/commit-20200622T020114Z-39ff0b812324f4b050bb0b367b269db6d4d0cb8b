{
  "sha": "39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MzlmZjBiODEyMzI0ZjRiMDUwYmIwYjM2N2IyNjlkYjZkNGQwY2I4Yg==",
  "commit": {
    "author": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2020-06-12T15:06:49Z"
    },
    "committer": {
      "name": "Nelson Chu",
      "email": "nelson.chu@sifive.com",
      "date": "2020-06-22T02:01:14Z"
    },
    "message": "RISC-V: Report warning when linking the objects with different priv specs.\n\nWe do know some conflicts among different privileged specs.  For linker,\nthe safest approach is that don't allow the object linked with others which\nmay cause conflicts.  But this may cause inconvenience since not all objects\nwith conflicting priv specs are linked will cause problems.  But it is hard\nto know the detailed conflict cases for linker, so we probably need a option\nto tell linker that we do know there are no conflicts, or we are willing to\ntake risks to link the objects with conflicted priv specs.  But the option\nis still under discussion.\n\nTherefore, we can report warnings rather than errors when linking the objects\nwith conflicted priv specs.  This not only makes the linker more flexible,\nbut also warns people that the conflicts may happen.  We also need to update\nthe output priv spec version once the input priv spec is newer.\n\n\tbfd/\n\t* elfxx-riscv.c (struct priv_spec_t priv_specs[]): Move them from\n\topcodes/riscv-opc.c to bfd/elfxx-riscv.c, since we need it in linker.\n\t(riscv_get_priv_spec_class): Likewise.\n\t(riscv_get_priv_spec_name): Likewise.\n\t(riscv_get_priv_spec_class_from_numbers): New function, convert\n\tthe version numbers into string, then call riscv_get_priv_spec_class\n\tto get the priv spec class.\n\t* elfxx-riscv.h (riscv_get_priv_spec_class): Move forward declaration\n\tfrom include/opcode/riscv.h to bfd/elfxx-riscv.h.\n\t(riscv_get_priv_spec_name): Likewise.\n\t(riscv_get_priv_spec_class_from_numbers): New forward declaration.\n\t(opcode/riscv.h): Include it in the header rather than elfxx-riscv.c.\n\t* elfnn-riscv.c (riscv_merge_attributes):  Get the priv spec classes\n\tof input and output objects form their priv spec attributes by\n\triscv_get_priv_spec_class_from_numbers.  Report warning rather than\n\terrors when linking objects with differnet priv spec versions.  We do\n\tknow v1.9.1 may have conflicts to other versions, so report the\n\twarning, too.  After that, update the output priv spec version to the\n\tnewest one so far.\n\n\tgas/\n\t* config/tc-riscv.c (buf_size, buf): Remove the unused variables.\n\t(riscv_set_default_priv_spec): Get the priv spec version from the\n\tpriv spec attributes by riscv_get_priv_spec_class_from_numbers.\n\n\tinclude/\n\t* opcode/riscv.h (riscv_get_priv_spec_class): Move the function\n\tforward declarations to bfd/elfxx-riscv.h.\n\t(riscv_get_priv_spec_name): Likewise.\n\n\topcodes/\n\t* riscv-opc.c: Move the structures and functions to bfd/elfxx-riscv.c.\n\t* riscv-dis.c: Include elfxx-riscv.h.\n\n\tld/\n\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-01.d: Updated.\n\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-02.d: Updated.\n\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-03.d: Updated.\n\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-04.d: Updated.\n\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-05.d: Updated.\n\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-06.d: Updated.",
    "tree": {
      "sha": "d26141dff4583849bf6a8e99c6ea7458b9dcd0a8",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d26141dff4583849bf6a8e99c6ea7458b9dcd0a8"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "cbd7581f343d85b4216db2eefdf601f6d988062d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cbd7581f343d85b4216db2eefdf601f6d988062d",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/cbd7581f343d85b4216db2eefdf601f6d988062d"
    }
  ],
  "stats": {
    "total": 355,
    "additions": 256,
    "deletions": 99
  },
  "files": [
    {
      "sha": "6ac3c0fb67efc423a25dd12cad0daceccdc9b7ad",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -1,3 +1,25 @@\n+2020-06-22  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* elfxx-riscv.c (struct priv_spec_t priv_specs[]): Move them from\n+\topcodes/riscv-opc.c to bfd/elfxx-riscv.c, since we need it in linker.\n+\t(riscv_get_priv_spec_class): Likewise.\n+\t(riscv_get_priv_spec_name): Likewise.\n+\t(riscv_get_priv_spec_class_from_numbers): New function, convert\n+\tthe version numbers into string, then call riscv_get_priv_spec_class\n+\tto get the priv spec class.\n+\t* elfxx-riscv.h (riscv_get_priv_spec_class): Move forward declaration\n+\tfrom include/opcode/riscv.h to bfd/elfxx-riscv.h.\n+\t(riscv_get_priv_spec_name): Likewise.\n+\t(riscv_get_priv_spec_class_from_numbers): New forward declaration.\n+\t(opcode/riscv.h): Include it in the header rather than elfxx-riscv.c.\n+\t* elfnn-riscv.c (riscv_merge_attributes):  Get the priv spec classes\n+\tof input and output objects form their priv spec attributes by\n+\triscv_get_priv_spec_class_from_numbers.  Report warning rather than\n+\terrors when linking objects with differnet priv spec versions.  We do\n+\tknow v1.9.1 may have conflicts to other versions, so report the\n+\twarning, too.  After that, update the output priv spec version to the\n+\tnewest one so far.\n+\n 2020-06-22  Nelson Chu  <nelson.chu@sifive.com>\n \n \t* elfnn-riscv.c (riscv_merge_attributes): Once we meet one of the"
    },
    {
      "sha": "00553f774644d98ac30a2c358014c9a1c0b98137",
      "filename": "bfd/elfnn-riscv.c",
      "status": "modified",
      "additions": 36,
      "deletions": 11,
      "changes": 47,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/bfd/elfnn-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/bfd/elfnn-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfnn-riscv.c?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -3052,25 +3052,31 @@ riscv_merge_attributes (bfd *ibfd, struct bfd_link_info *info)\n \t    unsigned int Tag_a = Tag_RISCV_priv_spec;\n \t    unsigned int Tag_b = Tag_RISCV_priv_spec_minor;\n \t    unsigned int Tag_c = Tag_RISCV_priv_spec_revision;\n+\t    enum riscv_priv_spec_class in_priv_spec;\n+\t    enum riscv_priv_spec_class out_priv_spec;\n+\n+\t    /* Get the priv spec class from elf attribute numbers.  */\n+\t    riscv_get_priv_spec_class_from_numbers (in_attr[Tag_a].i,\n+\t\t\t\t\t\t    in_attr[Tag_b].i,\n+\t\t\t\t\t\t    in_attr[Tag_c].i,\n+\t\t\t\t\t\t    &in_priv_spec);\n+\t    riscv_get_priv_spec_class_from_numbers (out_attr[Tag_a].i,\n+\t\t\t\t\t\t    out_attr[Tag_b].i,\n+\t\t\t\t\t\t    out_attr[Tag_c].i,\n+\t\t\t\t\t\t    &out_priv_spec);\n \n \t    /* Allow to link the object without the priv specs.  */\n-\t    if (out_attr[Tag_a].i == 0\n-\t\t&& out_attr[Tag_b].i == 0\n-\t\t&& out_attr[Tag_c].i == 0)\n+\t    if (out_priv_spec == PRIV_SPEC_CLASS_NONE)\n \t      {\n \t\tout_attr[Tag_a].i = in_attr[Tag_a].i;\n \t\tout_attr[Tag_b].i = in_attr[Tag_b].i;\n \t\tout_attr[Tag_c].i = in_attr[Tag_c].i;\n \t      }\n-\t    else if ((in_attr[Tag_a].i != 0\n-\t\t      || in_attr[Tag_b].i != 0\n-\t\t      || in_attr[Tag_c].i != 0)\n-\t\t     && (out_attr[Tag_a].i != in_attr[Tag_a].i\n-\t\t\t || out_attr[Tag_b].i != in_attr[Tag_b].i\n-\t\t\t || out_attr[Tag_c].i != in_attr[Tag_c].i))\n+\t    else if (in_priv_spec != PRIV_SPEC_CLASS_NONE\n+\t\t     && in_priv_spec != out_priv_spec)\n \t      {\n \t\t_bfd_error_handler\n-\t\t  (_(\"error: %pB use privilege spec version %u.%u.%u but \"\n+\t\t  (_(\"warning: %pB use privilege spec version %u.%u.%u but \"\n \t\t     \"the output use version %u.%u.%u.\"),\n \t\t   ibfd,\n \t\t   in_attr[Tag_a].i,\n@@ -3079,7 +3085,26 @@ riscv_merge_attributes (bfd *ibfd, struct bfd_link_info *info)\n \t\t   out_attr[Tag_a].i,\n \t\t   out_attr[Tag_b].i,\n \t\t   out_attr[Tag_c].i);\n-\t\tresult = FALSE;\n+\n+\t\t/* The priv spec v1.9.1 can be linked with other spec\n+\t\t   versions since the conflicts.  We plan to drop the\n+\t\t   v1.9.1 in a year or two, so this confict should be\n+\t\t   removed in the future.  */\n+\t\tif (in_priv_spec == PRIV_SPEC_CLASS_1P9P1\n+\t\t    || out_priv_spec == PRIV_SPEC_CLASS_1P9P1)\n+\t\t  {\n+\t\t    _bfd_error_handler\n+\t\t      (_(\"warning: privilege spec version 1.9.1 can not be \"\n+\t\t\t \"linked with other spec versions.\"));\n+\t\t  }\n+\n+\t\t/* Update the output priv attributes to the newest.  */\n+\t\tif (in_priv_spec > out_priv_spec)\n+\t\t  {\n+\t\t    out_attr[Tag_a].i = in_attr[Tag_a].i;\n+\t\t    out_attr[Tag_b].i = in_attr[Tag_b].i;\n+\t\t    out_attr[Tag_c].i = in_attr[Tag_c].i;\n+\t\t  }\n \t      }\n \t    priv_attrs_merged = TRUE;\n \t  }"
    },
    {
      "sha": "fa46b06f8df9ddb12cff822d14885dbbf4a5b2e8",
      "filename": "bfd/elfxx-riscv.c",
      "status": "modified",
      "additions": 95,
      "deletions": 1,
      "changes": 96,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/bfd/elfxx-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/bfd/elfxx-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-riscv.c?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -25,7 +25,6 @@\n #include \"libbfd.h\"\n #include \"elf-bfd.h\"\n #include \"elf/riscv.h\"\n-#include \"opcode/riscv.h\"\n #include \"libiberty.h\"\n #include \"elfxx-riscv.h\"\n #include \"safe-ctype.h\"\n@@ -1750,3 +1749,98 @@ riscv_arch_str (unsigned xlen, const riscv_subset_list_t *subset)\n \n   return attr_str;\n }\n+\n+/* Record the priv spec version string and the corresponding class.  */\n+\n+struct priv_spec_t\n+{\n+  const char *name;\n+  enum riscv_priv_spec_class class;\n+};\n+\n+/* List for all supported privilege versions.  */\n+\n+static const struct priv_spec_t priv_specs[] =\n+{\n+  {\"1.9.1\", PRIV_SPEC_CLASS_1P9P1},\n+  {\"1.10\",  PRIV_SPEC_CLASS_1P10},\n+  {\"1.11\",  PRIV_SPEC_CLASS_1P11},\n+\n+/* Terminate the list.  */\n+  {NULL, 0}\n+};\n+\n+/* Get the corresponding CSR version class by giving a privilege\n+   version string.  */\n+\n+int\n+riscv_get_priv_spec_class (const char *s,\n+\t\t\t   enum riscv_priv_spec_class *class)\n+{\n+  const struct priv_spec_t *version;\n+\n+  if (s == NULL)\n+    return 0;\n+\n+  for (version = &priv_specs[0]; version->name != NULL; ++version)\n+    if (strcmp (version->name, s) == 0)\n+      {\n+\t*class = version->class;\n+\treturn 1;\n+      }\n+\n+  /* Can not find the supported privilege version.  */\n+  return 0;\n+}\n+\n+/* Get the corresponding CSR version class by giving privilege\n+   version numbers.  It is usually used to convert the priv\n+   attribute numbers into the corresponding class.  */\n+\n+int\n+riscv_get_priv_spec_class_from_numbers (unsigned int major,\n+\t\t\t\t\tunsigned int minor,\n+\t\t\t\t\tunsigned int revision,\n+\t\t\t\t\tenum riscv_priv_spec_class *class)\n+{\n+  size_t buf_size;\n+  char *buf;\n+  int result = 1;\n+\n+  if (major == 0 && minor == 0 && revision == 0)\n+    {\n+      *class = PRIV_SPEC_CLASS_NONE;\n+      return result;\n+    }\n+\n+  buf_size = riscv_estimate_digit (major)\n+\t     + 1 /* '.' */\n+\t     + riscv_estimate_digit (minor)\n+\t     + 1; /* string terminator */\n+  if (revision != 0)\n+    {\n+      buf_size += 1 /* '.' */\n+\t\t  + riscv_estimate_digit (revision);\n+      buf = xmalloc (buf_size);\n+      snprintf (buf, buf_size, \"%d.%d.%d\", major, minor, revision);\n+    }\n+  else\n+    {\n+      buf = xmalloc (buf_size);\n+      snprintf (buf, buf_size, \"%d.%d\", major, minor);\n+    }\n+\n+  result = riscv_get_priv_spec_class (buf, class);\n+  free (buf);\n+  return result;\n+}\n+\n+/* Get the corresponding privilege version string by giving a CSR\n+   version class.  */\n+\n+const char *\n+riscv_get_priv_spec_name (enum riscv_priv_spec_class class)\n+{\n+  /* The first enum is PRIV_SPEC_CLASS_NONE.  */\n+  return priv_specs[class - 1].name;\n+}"
    },
    {
      "sha": "c91b169e99e26fa5ece5c9289e2302409bffd094",
      "filename": "bfd/elfxx-riscv.h",
      "status": "modified",
      "additions": 13,
      "deletions": 0,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/bfd/elfxx-riscv.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/bfd/elfxx-riscv.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-riscv.h?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -22,6 +22,7 @@\n \n #include \"elf/common.h\"\n #include \"elf/internal.h\"\n+#include \"opcode/riscv.h\"\n \n extern reloc_howto_type *\n riscv_reloc_name_lookup (bfd *, const char *);\n@@ -109,3 +110,15 @@ typedef enum riscv_isa_ext_class\n \n riscv_isa_ext_class_t\n riscv_get_prefix_class (const char *);\n+\n+extern int\n+riscv_get_priv_spec_class (const char *, enum riscv_priv_spec_class *);\n+\n+extern int\n+riscv_get_priv_spec_class_from_numbers (unsigned int,\n+\t\t\t\t\tunsigned int,\n+\t\t\t\t\tunsigned int,\n+\t\t\t\t\tenum riscv_priv_spec_class *);\n+\n+extern const char *\n+riscv_get_priv_spec_name (enum riscv_priv_spec_class);"
    },
    {
      "sha": "25d47147d66dfa14cd5abcb64c6e720c137fefb5",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -1,3 +1,9 @@\n+2020-06-22  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* config/tc-riscv.c (buf_size, buf): Remove the unused variables.\n+\t(riscv_set_default_priv_spec): Get the priv spec version from the\n+\tpriv spec attributes by riscv_get_priv_spec_class_from_numbers.\n+\n 2020-06-20  Alan Modra  <amodra@gmail.com>\n \n \t* configure.tgt: Set bfd_gas for all SH targets."
    },
    {
      "sha": "b6c8c4eb23e7bb9ca6b7e4eae6bc0594d8296312",
      "filename": "gas/config/tc-riscv.c",
      "status": "modified",
      "additions": 9,
      "deletions": 27,
      "changes": 36,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/gas/config/tc-riscv.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/gas/config/tc-riscv.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-riscv.c?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -126,8 +126,6 @@ riscv_set_default_priv_spec (const char *s)\n   enum riscv_priv_spec_class class;\n   unsigned major, minor, revision;\n   obj_attribute *attr;\n-  size_t buf_size;\n-  char *buf;\n \n   /* Find the corresponding priv spec class.  */\n   if (riscv_get_priv_spec_class (s, &class))\n@@ -149,40 +147,24 @@ riscv_set_default_priv_spec (const char *s)\n   minor = (unsigned) attr[Tag_RISCV_priv_spec_minor].i;\n   revision = (unsigned) attr[Tag_RISCV_priv_spec_revision].i;\n \n-  /* The priv attributes setting 0.0.0 is meaningless.  We should have set\n-     the default_priv_spec by md_parse_option and riscv_after_parse_args,\n-     so just skip the following setting.  */\n-  if (major == 0 && minor == 0 && revision == 0)\n-    return 1;\n-\n-  buf_size = riscv_estimate_digit (major)\n-            + 1 /* '.' */\n-            + riscv_estimate_digit (minor)\n-            + 1; /* string terminator */\n-  if (revision != 0)\n+  if (riscv_get_priv_spec_class_from_numbers (major,\n+\t\t\t\t\t      minor,\n+\t\t\t\t\t      revision,\n+\t\t\t\t\t      &class))\n     {\n-      buf_size += 1 /* '.' */\n-                 + riscv_estimate_digit (revision);\n-      buf = xmalloc (buf_size);\n-      snprintf (buf, buf_size, \"%d.%d.%d\", major, minor, revision);\n-    }\n-  else\n-    {\n-      buf = xmalloc (buf_size);\n-      snprintf (buf, buf_size, \"%d.%d\", major, minor);\n-    }\n+      /* The priv attributes setting 0.0.0 is meaningless.  We should have set\n+\t the default_priv_spec by md_parse_option and riscv_after_parse_args,\n+\t so just skip the following setting.  */\n+      if (class == PRIV_SPEC_CLASS_NONE)\n+\treturn 1;\n \n-  if (riscv_get_priv_spec_class (buf, &class))\n-    {\n       default_priv_spec = class;\n-      free (buf);\n       return 1;\n     }\n \n   /* Still can not find the priv spec class.  */\n   as_bad (_(\"Unknown default privilege spec `%d.%d.%d' set by  \"\n            \"privilege attributes\"),  major, minor, revision);\n-  free (buf);\n   return 0;\n }\n "
    },
    {
      "sha": "65e8af867f9a18cf72099a6ab4192091fa7eeb3d",
      "filename": "include/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/include/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/include/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ChangeLog?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -1,3 +1,9 @@\n+2020-06-22  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* opcode/riscv.h (riscv_get_priv_spec_class): Move the function\n+\tforward declarations to bfd/elfxx-riscv.h.\n+\t(riscv_get_priv_spec_name): Likewise.\n+\n 2020-06-15  Max Filippov  <jcmvbkbc@gmail.com>\n \n \t* elf/xtensa.h (xtensa_abi_choice): New declaration."
    },
    {
      "sha": "ba993e7d34dd621bcb8da31bfbbadab7a9633a80",
      "filename": "include/opcode/riscv.h",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/include/opcode/riscv.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/include/opcode/riscv.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/opcode/riscv.h?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -490,9 +490,5 @@ extern const struct riscv_ext_version riscv_ext_version_table[];\n \n extern int\n riscv_get_isa_spec_class (const char *, enum riscv_isa_spec_class *);\n-extern int\n-riscv_get_priv_spec_class (const char *, enum riscv_priv_spec_class *);\n-extern const char *\n-riscv_get_priv_spec_name (enum riscv_priv_spec_class);\n \n #endif /* _RISCV_H_ */"
    },
    {
      "sha": "b67cd518a6a4ef797c7b898e27c195e88143c597",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -1,3 +1,12 @@\n+2020-06-22  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-01.d: Updated.\n+\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-02.d: Updated.\n+\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-03.d: Updated.\n+\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-04.d: Updated.\n+\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-05.d: Updated.\n+\t* testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-06.d: Updated.\n+\n 2020-06-21  Alan Modra  <amodra@gmail.com>\n \n \t* ldfile.c: Replace uses of ENABLE_PLUGINS with BFD_SUPPORTS_PLUGINS."
    },
    {
      "sha": "0d5d6dc4a02e3ffb975a92925cb74ba58e50a23b",
      "filename": "ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-01.d",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-01.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-01.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-01.d?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -2,4 +2,12 @@\n #source: attr-merge-priv-spec-c.s\n #as:\n #ld: -r\n-#error: .*use privilege spec version 1.11.0 but the output use version 1.9.1.\n+#warning: .*warning: .*use privilege spec version 1.11.0 but the output use version 1.9.1.\n+#warning: .*warning: .*privilege spec version 1.9.1 can not be linked with other spec versions.\n+#readelf: -A\n+\n+Attribute Section: riscv\n+File Attributes\n+  Tag_RISCV_arch: [a-zA-Z0-9_\\\"].*\n+  Tag_RISCV_priv_spec: 1\n+  Tag_RISCV_priv_spec_minor: 11"
    },
    {
      "sha": "f0f75b2ba5a951091bbcd420a707beb5b972c116",
      "filename": "ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-02.d",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-02.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-02.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-02.d?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -2,4 +2,12 @@\n #source: attr-merge-priv-spec-a.s\n #as:\n #ld: -r\n-#error: .*use privilege spec version 1.9.1 but the output use version 1.11.0.\n+#warning: .*warning: .*use privilege spec version 1.9.1 but the output use version 1.11.0.\n+#warning: .*warning: .*privilege spec version 1.9.1 can not be linked with other spec versions.\n+#readelf: -A\n+\n+Attribute Section: riscv\n+File Attributes\n+  Tag_RISCV_arch: [a-zA-Z0-9_\\\"].*\n+  Tag_RISCV_priv_spec: 1\n+  Tag_RISCV_priv_spec_minor: 11"
    },
    {
      "sha": "af5155271e3b87cdb5589962d8fead8a9da348d3",
      "filename": "ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-03.d",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-03.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-03.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-03.d?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -3,4 +3,12 @@\n #source: attr-merge-priv-spec-c.s\n #as:\n #ld: -r\n-#error: .*use privilege spec version 1.11.0 but the output use version 1.9.1.\n+#warning: .*warning: .*use privilege spec version 1.11.0 but the output use version 1.9.1.\n+#warning: .*warning: .*privilege spec version 1.9.1 can not be linked with other spec versions.\n+#readelf: -A\n+\n+Attribute Section: riscv\n+File Attributes\n+  Tag_RISCV_arch: [a-zA-Z0-9_\\\"].*\n+  Tag_RISCV_priv_spec: 1\n+  Tag_RISCV_priv_spec_minor: 11"
    },
    {
      "sha": "2328807086190abbd8147faf24c4d93423e3f65f",
      "filename": "ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-04.d",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-04.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-04.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-04.d?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -3,4 +3,12 @@\n #source: attr-merge-priv-spec-c.s\n #as:\n #ld: -r\n-#error: .*use privilege spec version 1.11.0 but the output use version 1.9.1.\n+#warning: .*warning: .*use privilege spec version 1.11.0 but the output use version 1.9.1.\n+#warning: .*warning: .*privilege spec version 1.9.1 can not be linked with other spec versions.\n+#readelf: -A\n+\n+Attribute Section: riscv\n+File Attributes\n+  Tag_RISCV_arch: [a-zA-Z0-9_\\\"].*\n+  Tag_RISCV_priv_spec: 1\n+  Tag_RISCV_priv_spec_minor: 11"
    },
    {
      "sha": "cabaab68f54607ae21572bbf15369e8d2d7eabec",
      "filename": "ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-05.d",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-05.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-05.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-05.d?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -3,4 +3,12 @@\n #source: attr-merge-priv-spec-a.s\n #as:\n #ld: -r\n-#error: .*use privilege spec version 1.9.1 but the output use version 1.11.0.\n+#warning: .*warning: .*use privilege spec version 1.9.1 but the output use version 1.11.0.\n+#warning: .*warning: .*privilege spec version 1.9.1 can not be linked with other spec versions.\n+#readelf: -A\n+\n+Attribute Section: riscv\n+File Attributes\n+  Tag_RISCV_arch: [a-zA-Z0-9_\\\"].*\n+  Tag_RISCV_priv_spec: 1\n+  Tag_RISCV_priv_spec_minor: 11"
    },
    {
      "sha": "e77474888806586055827a1061157c4ae80e5311",
      "filename": "ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-06.d",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-06.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-06.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-riscv-elf/attr-merge-priv-spec-failed-06.d?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -3,4 +3,12 @@\n #source: attr-merge-priv-spec-a.s\n #as:\n #ld: -r\n-#error: .*use privilege spec version 1.9.1 but the output use version 1.11.0.\n+#warning: .*warning: .*use privilege spec version 1.9.1 but the output use version 1.11.0.\n+#warning: .*warning: .*privilege spec version 1.9.1 can not be linked with other spec versions.\n+#readelf: -A\n+\n+Attribute Section: riscv\n+File Attributes\n+  Tag_RISCV_arch: [a-zA-Z0-9_\\\"].*\n+  Tag_RISCV_priv_spec: 1\n+  Tag_RISCV_priv_spec_minor: 11"
    },
    {
      "sha": "ba0febec558108a3dc46f6d71c4a58a0642644ae",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -1,3 +1,8 @@\n+2020-06-22  Nelson Chu  <nelson.chu@sifive.com>\n+\n+\t* riscv-opc.c: Move the structures and functions to bfd/elfxx-riscv.c.\n+\t* riscv-dis.c: Include elfxx-riscv.h.\n+\n 2020-06-18  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* i386-dis.c (prefix_table): Revert the last vmgexit change."
    },
    {
      "sha": "0855de39e8e847a340ad930180b63f4bae5743d5",
      "filename": "opcodes/riscv-dis.c",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/opcodes/riscv-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/opcodes/riscv-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/riscv-dis.c?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -27,6 +27,7 @@\n #include \"opintl.h\"\n #include \"elf-bfd.h\"\n #include \"elf/riscv.h\"\n+#include \"elfxx-riscv.h\"\n \n #include \"bfd_stdint.h\"\n #include <ctype.h>"
    },
    {
      "sha": "03e3bd7c054500f7e1ae523703143f768d7c137c",
      "filename": "opcodes/riscv-opc.c",
      "status": "modified",
      "additions": 0,
      "deletions": 50,
      "changes": 50,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/opcodes/riscv-opc.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/39ff0b812324f4b050bb0b367b269db6d4d0cb8b/opcodes/riscv-opc.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/riscv-opc.c?ref=39ff0b812324f4b050bb0b367b269db6d4d0cb8b",
      "patch": "@@ -977,53 +977,3 @@ riscv_get_isa_spec_class (const char *s,\n   /* Can not find the supported ISA spec.  */\n   return 0;\n }\n-\n-struct priv_spec_t\n-{\n-  const char *name;\n-  enum riscv_priv_spec_class class;\n-};\n-\n-/* List for all supported privilege versions.  */\n-static const struct priv_spec_t priv_specs[] =\n-{\n-  {\"1.9.1\", PRIV_SPEC_CLASS_1P9P1},\n-  {\"1.10\",  PRIV_SPEC_CLASS_1P10},\n-  {\"1.11\",  PRIV_SPEC_CLASS_1P11},\n-\n-/* Terminate the list.  */\n-  {NULL, 0}\n-};\n-\n-/* Get the corresponding CSR version class by giving a privilege\n-   version string.  */\n-\n-int\n-riscv_get_priv_spec_class (const char *s,\n-                          enum riscv_priv_spec_class *class)\n-{\n-  const struct priv_spec_t *version;\n-\n-  if (s == NULL)\n-    return 0;\n-\n-  for (version = &priv_specs[0]; version->name != NULL; ++version)\n-    if (strcmp (version->name, s) == 0)\n-      {\n-       *class = version->class;\n-       return 1;\n-      }\n-\n-  /* Can not find the supported privilege version.  */\n-  return 0;\n-}\n-\n-/* Get the corresponding privilege version string by giving a CSR\n-   version class.  */\n-\n-const char *\n-riscv_get_priv_spec_name (enum riscv_priv_spec_class class)\n-{\n-  /* The first enum is PRIV_SPEC_CLASS_NONE.  */\n-  return priv_specs[class - 1].name;\n-}"
    }
  ]
}