{
  "sha": "dc2c33e4562e0af441a9c8acff0400a78cb45d98",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZGMyYzMzZTQ1NjJlMGFmNDQxYTljOGFjZmYwNDAwYTc4Y2I0NWQ5OA==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-06-16T21:53:36Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2019-06-25T13:48:36Z"
    },
    "message": "Change tui_which_element::data_window to be a pointer\n\nA coming patch will add a constructor to tui_gen_win_info.  However,\nbecause the tui_which_element union contains an object of this type,\nfirst something must be done here in order to avoid having a union\nwith a member that has a constructor.  This patch changes this element\nto be a pointer instead.\n\ngdb/ChangeLog\n2019-06-25  Tom Tromey  <tom@tromey.com>\n\n\t* tui/tui-wingeneral.c (tui_refresh_win): Update.\n\t* tui/tui-windata.c (tui_first_data_item_displayed)\n\t(tui_delete_data_content_windows): Update.\n\t* tui/tui-win.c (tui_data_window::set_new_height): Update.\n\t* tui/tui-regs.c (tui_show_registers, tui_show_register_group)\n\t(tui_display_registers_from, tui_check_register_values): Update.\n\t* tui/tui-data.h (union tui_which_element) <data_window>: Now a\n\tpointer.\n\t* tui/tui-data.c (init_content_element): Update.  Allocate the new\n\twindow.\n\t(tui_free_data_content): Update.\n\t(free_content_elements) <case DATA_WIN>: Free the window.",
    "tree": {
      "sha": "db6725303251823e7fcab4872863763a054a05de",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/db6725303251823e7fcab4872863763a054a05de"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/dc2c33e4562e0af441a9c8acff0400a78cb45d98",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/dc2c33e4562e0af441a9c8acff0400a78cb45d98",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/dc2c33e4562e0af441a9c8acff0400a78cb45d98",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/dc2c33e4562e0af441a9c8acff0400a78cb45d98/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "214a5cbea656f3ffc1e7e525627c56849347c709",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/214a5cbea656f3ffc1e7e525627c56849347c709",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/214a5cbea656f3ffc1e7e525627c56849347c709"
    }
  ],
  "stats": {
    "total": 47,
    "additions": 32,
    "deletions": 15
  },
  "files": [
    {
      "sha": "3f394636e554ee53c050a9af9bcad79d98c6f305",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 15,
      "deletions": 0,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=dc2c33e4562e0af441a9c8acff0400a78cb45d98",
      "patch": "@@ -1,3 +1,18 @@\n+2019-06-25  Tom Tromey  <tom@tromey.com>\n+\n+\t* tui/tui-wingeneral.c (tui_refresh_win): Update.\n+\t* tui/tui-windata.c (tui_first_data_item_displayed)\n+\t(tui_delete_data_content_windows): Update.\n+\t* tui/tui-win.c (tui_data_window::set_new_height): Update.\n+\t* tui/tui-regs.c (tui_show_registers, tui_show_register_group)\n+\t(tui_display_registers_from, tui_check_register_values): Update.\n+\t* tui/tui-data.h (union tui_which_element) <data_window>: Now a\n+\tpointer.\n+\t* tui/tui-data.c (init_content_element): Update.  Allocate the new\n+\twindow.\n+\t(tui_free_data_content): Update.\n+\t(free_content_elements) <case DATA_WIN>: Free the window.\n+\n 2019-06-25  Tom Tromey  <tom@tromey.com>\n \n \t* tui/tui-wingeneral.c (tui_unhighlight_win, tui_highlight_win):"
    },
    {
      "sha": "5a742ac518951dda8a34a0a1a75d30d9d2dd0a91",
      "filename": "gdb/tui/tui-data.c",
      "status": "modified",
      "additions": 7,
      "deletions": 5,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-data.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-data.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-data.c?ref=dc2c33e4562e0af441a9c8acff0400a78cb45d98",
      "patch": "@@ -435,11 +435,12 @@ init_content_element (struct tui_win_element *element,\n       element->which_element.source.has_break = FALSE;\n       break;\n     case DATA_WIN:\n-      tui_init_generic_part (&element->which_element.data_window);\n-      element->which_element.data_window.type = DATA_ITEM_WIN;\n-      element->which_element.data_window.content =\n+      element->which_element.data_window = XNEW (struct tui_gen_win_info);\n+      tui_init_generic_part (element->which_element.data_window);\n+      element->which_element.data_window->type = DATA_ITEM_WIN;\n+      element->which_element.data_window->content =\n \ttui_alloc_content (1, DATA_ITEM_WIN);\n-      element->which_element.data_window.content_size = 1;\n+      element->which_element.data_window->content_size = 1;\n       break;\n     case CMD_WIN:\n       element->which_element.command.line = NULL;\n@@ -646,7 +647,7 @@ tui_free_data_content (tui_win_content content,\n   for (i = 0; i < content_size; i++)\n     {\n       struct tui_gen_win_info *generic_win\n-\t= &content[i]->which_element.data_window;\n+\t= content[i]->which_element.data_window;\n \n       if (generic_win != NULL)\n \t{\n@@ -710,6 +711,7 @@ free_content_elements (tui_win_content content,\n \t\t      xfree (element->which_element.source.line);\n \t\t      break;\n \t\t    case DATA_WIN:\n+\t\t      xfree (element->which_element.data_window);\n \t\t      xfree (element);\n \t\t      break;\n \t\t    case DATA_ITEM_WIN:"
    },
    {
      "sha": "09e2f289391fe21c54ca7bf236041da9a8f6e945",
      "filename": "gdb/tui/tui-data.h",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-data.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-data.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-data.h?ref=dc2c33e4562e0af441a9c8acff0400a78cb45d98",
      "patch": "@@ -212,7 +212,7 @@ typedef char tui_exec_info_content[TUI_EXECINFO_SIZE];\n union tui_which_element\n {\n   struct tui_source_element source;\t/* The source elements.  */\n-  struct tui_gen_win_info data_window;\t/* Data display elements.  */\n+  struct tui_gen_win_info *data_window;\t/* Data display elements.  */\n   struct tui_data_element data;\t\t/* Elements of data_window.  */\n   struct tui_command_element command;\t/* Command elements.  */\n   struct tui_locator_element locator;\t/* Locator elements.  */"
    },
    {
      "sha": "7367cf7c0cb3d6f423ad32665e3c44eff2930ac1",
      "filename": "gdb/tui/tui-regs.c",
      "status": "modified",
      "additions": 5,
      "deletions": 5,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-regs.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-regs.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-regs.c?ref=dc2c33e4562e0af441a9c8acff0400a78cb45d98",
      "patch": "@@ -165,7 +165,7 @@ tui_show_registers (struct reggroup *group)\n \t  struct tui_gen_win_info *data_item_win;\n           struct tui_win_element *win;\n \n-\t  data_item_win = &TUI_DATA_WIN->regs_content[i]\n+\t  data_item_win = TUI_DATA_WIN->regs_content[i]\n             ->which_element.data_window;\n           win = data_item_win->content[0];\n           win->which_element.data.highlight = FALSE;\n@@ -261,7 +261,7 @@ tui_show_register_group (struct reggroup *group,\n \t    continue;\n \n \t  data_item_win =\n-            &TUI_DATA_WIN->regs_content[pos]->which_element.data_window;\n+            TUI_DATA_WIN->regs_content[pos]->which_element.data_window;\n           data = &data_item_win->content[0]->which_element.data;\n           if (data)\n             {\n@@ -306,7 +306,7 @@ tui_display_registers_from (int start_element_no)\n           int len;\n \n           data_item_win\n-\t    = &TUI_DATA_WIN->regs_content[i]->which_element.data_window;\n+\t    = TUI_DATA_WIN->regs_content[i]->which_element.data_window;\n           data = &data_item_win->content[0]->which_element.data;\n           len = 0;\n           p = data->content;\n@@ -347,7 +347,7 @@ tui_display_registers_from (int start_element_no)\n \t      struct tui_data_element *data_element_ptr;\n \n \t      /* Create the window if necessary.  */\n-\t      data_item_win = &TUI_DATA_WIN->regs_content[i]\n+\t      data_item_win = TUI_DATA_WIN->regs_content[i]\n                 ->which_element.data_window;\n \t      data_element_ptr = &data_item_win->content[0]->which_element.data;\n               if (data_item_win->handle != NULL\n@@ -485,7 +485,7 @@ tui_check_register_values (struct frame_info *frame)\n \t      struct tui_gen_win_info *data_item_win_ptr;\n \t      int was_hilighted;\n \n-\t      data_item_win_ptr = &TUI_DATA_WIN->regs_content[i]->\n+\t      data_item_win_ptr = TUI_DATA_WIN->regs_content[i]->\n                 which_element.data_window;\n \t      data = &data_item_win_ptr->content[0]->which_element.data;\n \t      was_hilighted = data->highlight;"
    },
    {
      "sha": "e4c1522a62de4401f3360ab1daf4d394c96e9ca2",
      "filename": "gdb/tui/tui-win.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-win.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-win.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-win.c?ref=dc2c33e4562e0af441a9c8acff0400a78cb45d98",
      "patch": "@@ -1273,7 +1273,7 @@ tui_data_window::set_new_height (int height)\n   for (int i = 0; i < generic.content_size; i++)\n     {\n       struct tui_gen_win_info *gen_win_info\n-\t= &generic.content[i]->which_element.data_window;\n+\t= generic.content[i]->which_element.data_window;\n       tui_delete_win (gen_win_info->handle);\n       gen_win_info->handle = NULL;\n     }"
    },
    {
      "sha": "1647527e240a07eb3ec98c07795ed72722a2c78f",
      "filename": "gdb/tui/tui-windata.c",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-windata.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-windata.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-windata.c?ref=dc2c33e4562e0af441a9c8acff0400a78cb45d98",
      "patch": "@@ -54,7 +54,7 @@ tui_first_data_item_displayed (void)\n       struct tui_gen_win_info *data_item_win;\n \n       data_item_win\n-\t= &TUI_DATA_WIN->generic.content[i]->which_element.data_window;\n+\t= TUI_DATA_WIN->generic.content[i]->which_element.data_window;\n       if (data_item_win->handle != NULL\n \t  && data_item_win->is_visible)\n \telement_no = i;\n@@ -75,7 +75,7 @@ tui_delete_data_content_windows (void)\n   for (i = 0; (i < TUI_DATA_WIN->generic.content_size); i++)\n     {\n       data_item_win_ptr\n-\t= &TUI_DATA_WIN->generic.content[i]->which_element.data_window;\n+\t= TUI_DATA_WIN->generic.content[i]->which_element.data_window;\n       tui_delete_win (data_item_win_ptr->handle);\n       data_item_win_ptr->handle = NULL;\n       data_item_win_ptr->is_visible = false;"
    },
    {
      "sha": "ccee399057a94aa9c90824f0ef5113359f52d121",
      "filename": "gdb/tui/tui-wingeneral.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-wingeneral.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/dc2c33e4562e0af441a9c8acff0400a78cb45d98/gdb/tui/tui-wingeneral.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-wingeneral.c?ref=dc2c33e4562e0af441a9c8acff0400a78cb45d98",
      "patch": "@@ -43,7 +43,7 @@ tui_refresh_win (struct tui_gen_win_info *win_info)\n \t{\n \t  struct tui_gen_win_info *data_item_win_ptr;\n \n-\t  data_item_win_ptr = &win_info->content[i]->which_element.data_window;\n+\t  data_item_win_ptr = win_info->content[i]->which_element.data_window;\n \t  if (data_item_win_ptr != NULL\n \t      && data_item_win_ptr->handle != NULL)\n \t    wrefresh (data_item_win_ptr->handle);"
    }
  ]
}