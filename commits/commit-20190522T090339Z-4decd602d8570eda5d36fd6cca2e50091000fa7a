{
  "sha": "4decd602d8570eda5d36fd6cca2e50091000fa7a",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NGRlY2Q2MDJkODU3MGVkYTVkMzZmZDZjY2EyZTUwMDkxMDAwZmE3YQ==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-05-22T08:22:59Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-05-22T09:03:39Z"
    },
    "message": "bfdtest1 segfaults on hppa-hp-hpux10\n\nThe archive element cache needs tidying when closing an archive element.\nThis patch fixes these failures:\n-FAIL: ar long file names (bfdtest1)\n-FAIL: ar thin archive (bfdtest1)\n-FAIL: ar thin archive with nested archive (bfdtest1)\n\n\t* som.c (som_bfd_free_cached_info): Call\n\t_bfd_generic_close_and_cleanup.",
    "tree": {
      "sha": "de2bd28a6e1a0173a08914d85b7db83b9f2b019e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/de2bd28a6e1a0173a08914d85b7db83b9f2b019e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4decd602d8570eda5d36fd6cca2e50091000fa7a",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4decd602d8570eda5d36fd6cca2e50091000fa7a",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4decd602d8570eda5d36fd6cca2e50091000fa7a",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4decd602d8570eda5d36fd6cca2e50091000fa7a/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "22c6ccb89e0f38a70a42fb49eb167e7857d51f5c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/22c6ccb89e0f38a70a42fb49eb167e7857d51f5c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/22c6ccb89e0f38a70a42fb49eb167e7857d51f5c"
    }
  ],
  "stats": {
    "total": 35,
    "additions": 20,
    "deletions": 15
  },
  "files": [
    {
      "sha": "af7ae755ea11d4b43a0b14aaeb9bf3312f9bd7b9",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4decd602d8570eda5d36fd6cca2e50091000fa7a/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4decd602d8570eda5d36fd6cca2e50091000fa7a/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=4decd602d8570eda5d36fd6cca2e50091000fa7a",
      "patch": "@@ -1,3 +1,8 @@\n+2019-05-22  Alan Modra  <amodra@gmail.com>\n+\n+\t* som.c (som_bfd_free_cached_info): Call\n+\t_bfd_generic_close_and_cleanup.\n+\n 2019-05-21  Faraz Shahbazker  <fshahbazker@wavecomp.com>\n \n \t* elfxx-mips.c (_bfd_mips_elf_check_relocs): Generate error"
    },
    {
      "sha": "0d17b3278a4db5479829a410742c0bc1b823bcc0",
      "filename": "bfd/som.c",
      "status": "modified",
      "additions": 15,
      "deletions": 15,
      "changes": 30,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4decd602d8570eda5d36fd6cca2e50091000fa7a/bfd/som.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4decd602d8570eda5d36fd6cca2e50091000fa7a/bfd/som.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/som.c?ref=4decd602d8570eda5d36fd6cca2e50091000fa7a",
      "patch": "@@ -6695,25 +6695,25 @@ som_write_armap (bfd *abfd,\n static bfd_boolean\n som_bfd_free_cached_info (bfd *abfd)\n {\n-  asection *o;\n-\n-  if (bfd_get_format (abfd) != bfd_object)\n-    return TRUE;\n+  if (bfd_get_format (abfd) == bfd_object)\n+    {\n+      asection *o;\n \n #define FREE(x) if (x != NULL) { free (x); x = NULL; }\n-  /* Free the native string and symbol tables.  */\n-  FREE (obj_som_symtab (abfd));\n-  FREE (obj_som_stringtab (abfd));\n-  for (o = abfd->sections; o != NULL; o = o->next)\n-    {\n-      /* Free the native relocations.  */\n-      o->reloc_count = (unsigned) -1;\n-      FREE (som_section_data (o)->reloc_stream);\n-      /* Do not free the generic relocations as they are objalloc'ed.  */\n-    }\n+      /* Free the native string and symbol tables.  */\n+      FREE (obj_som_symtab (abfd));\n+      FREE (obj_som_stringtab (abfd));\n+      for (o = abfd->sections; o != NULL; o = o->next)\n+\t{\n+\t  /* Free the native relocations.  */\n+\t  o->reloc_count = (unsigned) -1;\n+\t  FREE (som_section_data (o)->reloc_stream);\n+\t  /* Do not free the generic relocations as they are objalloc'ed.  */\n+\t}\n #undef FREE\n+    }\n \n-  return TRUE;\n+  return _bfd_generic_close_and_cleanup (abfd);\n }\n \n /* End of miscellaneous support functions.  */"
    }
  ]
}