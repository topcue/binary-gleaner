{
  "sha": "d844f10ac2735da8e5643236d7007a81098cbc2b",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDg0NGYxMGFjMjczNWRhOGU1NjQzMjM2ZDcwMDdhODEwOThjYmMyYg==",
  "commit": {
    "author": {
      "name": "David Faust",
      "email": "david.faust@oracle.com",
      "date": "2020-08-07T18:36:47Z"
    },
    "committer": {
      "name": "Jose E. Marchesi",
      "email": "jose.marchesi@oracle.com",
      "date": "2020-08-07T18:36:47Z"
    },
    "message": "bpf: fix false overflow in eBPF ELF backend linker\n\nWhen performing DISP{16,32} relocations, the eBPF ELF backend linker\nneeds to convert the relocation from an address into a signed number\nof 64-bit words (minus one) to jump.\n\nBecause of this unsigned-to-signed conversion, special care needs to\nbe taken when dividing to ensure the sign bits remain correct.\nOtherwise, a false relocation overflow error can be triggered.\n\nbfd/ChangeLog\n\n2020-08-07  David Faust  <david.faust@oracle.com>\n\n\t* elf64-bpf.c (bpf_elf_relocate_section): Ensure signed division for\n\tDISP16 and DISP32 relocations.\n\nld/ChangeLog\n\n2020-08-07  David Faust  <david.faust@oracle.com>\n\n\t* testsuite/ld-bpf/call-3.s: New file.\n\t* testsuite/ld-bpf/call-3.d: Likewise.",
    "tree": {
      "sha": "540b048e134ea051c03c1876ee87340bb1081e0b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/540b048e134ea051c03c1876ee87340bb1081e0b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d844f10ac2735da8e5643236d7007a81098cbc2b",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d844f10ac2735da8e5643236d7007a81098cbc2b",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d844f10ac2735da8e5643236d7007a81098cbc2b",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d844f10ac2735da8e5643236d7007a81098cbc2b/comments",
  "author": {
    "login": "dafaust",
    "id": 4460334,
    "node_id": "MDQ6VXNlcjQ0NjAzMzQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4460334?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dafaust",
    "html_url": "https://github.com/dafaust",
    "followers_url": "https://api.github.com/users/dafaust/followers",
    "following_url": "https://api.github.com/users/dafaust/following{/other_user}",
    "gists_url": "https://api.github.com/users/dafaust/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dafaust/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dafaust/subscriptions",
    "organizations_url": "https://api.github.com/users/dafaust/orgs",
    "repos_url": "https://api.github.com/users/dafaust/repos",
    "events_url": "https://api.github.com/users/dafaust/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dafaust/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jemarch",
    "id": 7061875,
    "node_id": "MDQ6VXNlcjcwNjE4NzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7061875?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jemarch",
    "html_url": "https://github.com/jemarch",
    "followers_url": "https://api.github.com/users/jemarch/followers",
    "following_url": "https://api.github.com/users/jemarch/following{/other_user}",
    "gists_url": "https://api.github.com/users/jemarch/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jemarch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jemarch/subscriptions",
    "organizations_url": "https://api.github.com/users/jemarch/orgs",
    "repos_url": "https://api.github.com/users/jemarch/repos",
    "events_url": "https://api.github.com/users/jemarch/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jemarch/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "fe4c3d430b39d4a8760702c4ecc9e4c1803cb077",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fe4c3d430b39d4a8760702c4ecc9e4c1803cb077",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/fe4c3d430b39d4a8760702c4ecc9e4c1803cb077"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 15,
    "deletions": 4
  },
  "files": [
    {
      "sha": "69ebd1463a3018a92d441b563f4d4b76e9f7fd12",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d844f10ac2735da8e5643236d7007a81098cbc2b/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d844f10ac2735da8e5643236d7007a81098cbc2b/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=d844f10ac2735da8e5643236d7007a81098cbc2b",
      "patch": "@@ -1,3 +1,8 @@\n+2020-08-07  David Faust  <david.faust@oracle.com>\n+\n+\t* elf64-bpf.c (bpf_elf_relocate_section): Ensure signed division for\n+\tDISP16 and DISP32 relocations.\n+\n 2020-08-05  David Faust  <david.faust@oracle.com>\n \n \t* elf64-bpf.c (bpf_elf_generic_reloc): New function."
    },
    {
      "sha": "d5a160f8f14dfcad4a2562fcf02e2ad786f40bde",
      "filename": "bfd/elf64-bpf.c",
      "status": "modified",
      "additions": 5,
      "deletions": 4,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d844f10ac2735da8e5643236d7007a81098cbc2b/bfd/elf64-bpf.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d844f10ac2735da8e5643236d7007a81098cbc2b/bfd/elf64-bpf.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf64-bpf.c?ref=d844f10ac2735da8e5643236d7007a81098cbc2b",
      "patch": "@@ -442,10 +442,11 @@ bpf_elf_relocate_section (bfd *output_bfd ATTRIBUTE_UNUSED,\n         case R_BPF_INSN_DISP32:\n           {\n             /* Make the relocation PC-relative, and change its unit to\n-               64-bit words.  */\n-            relocation -= sec_addr (input_section) + rel->r_offset;\n-            /* Make it 64-bit words.  */\n-            relocation = relocation / 8;\n+               64-bit words.  Note we need *signed* arithmetic\n+               here.  */\n+            relocation = ((bfd_signed_vma) relocation\n+\t\t\t  - (sec_addr (input_section) + rel->r_offset));\n+            relocation = (bfd_signed_vma) relocation / 8;\n             \n             /* Get the addend from the instruction and apply it.  */\n             addend = bfd_get (howto->bitsize, input_bfd,"
    },
    {
      "sha": "db019e26a3a3542433e4b8dc82b7505c002987a3",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d844f10ac2735da8e5643236d7007a81098cbc2b/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d844f10ac2735da8e5643236d7007a81098cbc2b/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=d844f10ac2735da8e5643236d7007a81098cbc2b",
      "patch": "@@ -1,3 +1,8 @@\n+2020-08-07  David Faust  <david.faust@oracle.com>\n+\n+\t* testsuite/ld-bpf/call-3.s: New file.\n+\t* testsuite/ld-bpf/call-3.d: Likewise.\n+\n 2020-08-05  David Faust  <david.faust@oracle.com>\n \n \t* testsuite/ld-bpf/call-2.s: New file."
    }
  ]
}