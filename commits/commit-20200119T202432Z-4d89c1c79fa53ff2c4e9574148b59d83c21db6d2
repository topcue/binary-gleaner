{
  "sha": "4d89c1c79fa53ff2c4e9574148b59d83c21db6d2",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NGQ4OWMxYzc5ZmE1M2ZmMmM0ZTk1NzQxNDhiNTlkODNjMjFkYjZkMg==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-01-11T18:40:45Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tom@tromey.com",
      "date": "2020-01-19T20:24:32Z"
    },
    "message": "Call disassemble_free_target in gdb\n\nCommit 20135676fc4c3912297c313b3e0d3cbd6cc402e3 (\"PR24960, Memory leak\nfrom disassembler\") added \"disassemble_free_target\" to opcodes.  This\nis used to free target-specific data when finished with a\ndisassembler.\n\nThis patch changes gdb to call this function where needed.\n\ngdb/ChangeLog\n2020-01-19  Tom Tromey  <tom@tromey.com>\n\n\t* disasm.c (~gdb_disassembler): New destructor.\n\t(gdb_buffered_insn_length): Call disassemble_free_target.\n\t* disasm.h (class gdb_disassembler): Declare destructor.  Use\n\tDISABLE_COPY_AND_ASSIGN.\n\nChange-Id: I245ba5b7dec5e5d9f29cd21832c6e2b4fecef047",
    "tree": {
      "sha": "94022b7b116870b53b48e77ad9ab82d0e49cbd2d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/94022b7b116870b53b48e77ad9ab82d0e49cbd2d"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "c0ab21c22bb28a2e1a42195d3fe9b9de9e7fd66b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c0ab21c22bb28a2e1a42195d3fe9b9de9e7fd66b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c0ab21c22bb28a2e1a42195d3fe9b9de9e7fd66b"
    }
  ],
  "stats": {
    "total": 20,
    "additions": 19,
    "deletions": 1
  },
  "files": [
    {
      "sha": "93a125b3e7d32e43a78a5db4a3366e9cd2bfe56f",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=4d89c1c79fa53ff2c4e9574148b59d83c21db6d2",
      "patch": "@@ -1,3 +1,10 @@\n+2020-01-19  Tom Tromey  <tom@tromey.com>\n+\n+\t* disasm.c (~gdb_disassembler): New destructor.\n+\t(gdb_buffered_insn_length): Call disassemble_free_target.\n+\t* disasm.h (class gdb_disassembler): Declare destructor.  Use\n+\tDISABLE_COPY_AND_ASSIGN.\n+\n 2020-01-19  Tom Tromey  <tom@tromey.com>\n \n \t* dwarf2read.c (abbrev_table_up): Move typedef earlier."
    },
    {
      "sha": "e45c8400689b02fc9dd81e6322989a76e70310f7",
      "filename": "gdb/disasm.c",
      "status": "modified",
      "additions": 8,
      "deletions": 1,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2/gdb/disasm.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2/gdb/disasm.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/disasm.c?ref=4d89c1c79fa53ff2c4e9574148b59d83c21db6d2",
      "patch": "@@ -781,6 +781,11 @@ gdb_disassembler::gdb_disassembler (struct gdbarch *gdbarch,\n   disassemble_init_for_target (&m_di);\n }\n \n+gdb_disassembler::~gdb_disassembler ()\n+{\n+  disassemble_free_target (&m_di);\n+}\n+\n int\n gdb_disassembler::print_insn (CORE_ADDR memaddr,\n \t\t\t      int *branch_delay_insns)\n@@ -908,7 +913,9 @@ gdb_buffered_insn_length (struct gdbarch *gdbarch,\n   gdb_buffered_insn_length_init_dis (gdbarch, &di, insn, max_len, addr,\n \t\t\t\t     &disassembler_options_holder);\n \n-  return gdbarch_print_insn (gdbarch, addr, &di);\n+  int result = gdbarch_print_insn (gdbarch, addr, &di);\n+  disassemble_free_target (&di);\n+  return result;\n }\n \n char *"
    },
    {
      "sha": "b0f535eaa211607905b48751cb7ef71ceabb3166",
      "filename": "gdb/disasm.h",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2/gdb/disasm.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/4d89c1c79fa53ff2c4e9574148b59d83c21db6d2/gdb/disasm.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/disasm.h?ref=4d89c1c79fa53ff2c4e9574148b59d83c21db6d2",
      "patch": "@@ -47,6 +47,10 @@ class gdb_disassembler\n     : gdb_disassembler (gdbarch, file, dis_asm_read_memory)\n   {}\n \n+  ~gdb_disassembler ();\n+\n+  DISABLE_COPY_AND_ASSIGN (gdb_disassembler);\n+\n   int print_insn (CORE_ADDR memaddr, int *branch_delay_insns = NULL);\n \n   /* Return the gdbarch of gdb_disassembler.  */"
    }
  ]
}