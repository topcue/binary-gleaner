{
  "sha": "b818855549013ba43e730e07f790e5cbfd16a757",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YjgxODg1NTU0OTAxM2JhNDNlNzMwZTA3Zjc5MGU1Y2JmZDE2YTc1Nw==",
  "commit": {
    "author": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2021-04-26T08:35:51Z"
    },
    "committer": {
      "name": "Jan Beulich",
      "email": "jbeulich@suse.com",
      "date": "2021-04-26T08:35:51Z"
    },
    "message": "x86-64: have value properly checked when resolving fixup\n\nConstants not known at the time an individual insn gets assembled and\ngoing into a sign-extended field still shouldn't be silently truncated\nat the time the respective fixup gets resolved.",
    "tree": {
      "sha": "ae5d65b7fb1359fbceeca9d6f44dab75065d27ab",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/ae5d65b7fb1359fbceeca9d6f44dab75065d27ab"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/b818855549013ba43e730e07f790e5cbfd16a757",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b818855549013ba43e730e07f790e5cbfd16a757",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/b818855549013ba43e730e07f790e5cbfd16a757",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b818855549013ba43e730e07f790e5cbfd16a757/comments",
  "author": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jbeulich",
    "id": 5610135,
    "node_id": "MDQ6VXNlcjU2MTAxMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5610135?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jbeulich",
    "html_url": "https://github.com/jbeulich",
    "followers_url": "https://api.github.com/users/jbeulich/followers",
    "following_url": "https://api.github.com/users/jbeulich/following{/other_user}",
    "gists_url": "https://api.github.com/users/jbeulich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jbeulich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jbeulich/subscriptions",
    "organizations_url": "https://api.github.com/users/jbeulich/orgs",
    "repos_url": "https://api.github.com/users/jbeulich/repos",
    "events_url": "https://api.github.com/users/jbeulich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jbeulich/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "c290cb01face96fa9c2a4f96f7d57083da3c99f1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c290cb01face96fa9c2a4f96f7d57083da3c99f1",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c290cb01face96fa9c2a4f96f7d57083da3c99f1"
    }
  ],
  "stats": {
    "total": 66,
    "additions": 65,
    "deletions": 1
  },
  "files": [
    {
      "sha": "585c98b25210b773a127e8f635fe7dfc1604b65d",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 8,
      "deletions": 0,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b818855549013ba43e730e07f790e5cbfd16a757/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b818855549013ba43e730e07f790e5cbfd16a757/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=b818855549013ba43e730e07f790e5cbfd16a757",
      "patch": "@@ -1,3 +1,11 @@\n+2021-04-26  Jan Beulich  <jbeulich@suse.com>\n+\n+\t* config/tc-i386.c (md_apply_fix): Mark BFD_RELOC_X86_64_32S as\n+\tsigned.\n+\t* testsuite/gas/i386/x86-64-addr32-bad.s,\n+\ttestsuite/gas/i386/x86-64-addr32-bad.l: New.\n+\t* testsuite/gas/i386/i386.exp: Run new test.\n+\n 2021-04-23  Eric Botcazou<ebotcazou@adacore.com>\n \n \t* testsuite/gas/elf/section25.d: Run it everywhere."
    },
    {
      "sha": "1f9844dcb52aeeed2229c91fb0a69d40d3139665",
      "filename": "gas/config/tc-i386.c",
      "status": "modified",
      "additions": 12,
      "deletions": 1,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b818855549013ba43e730e07f790e5cbfd16a757/gas/config/tc-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b818855549013ba43e730e07f790e5cbfd16a757/gas/config/tc-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-i386.c?ref=b818855549013ba43e730e07f790e5cbfd16a757",
      "patch": "@@ -12576,7 +12576,18 @@ md_apply_fix (fixS *fixP, valueT *valP, segT seg ATTRIBUTE_UNUSED)\n \n   /* Are we finished with this relocation now?  */\n   if (fixP->fx_addsy == NULL)\n-    fixP->fx_done = 1;\n+    {\n+      fixP->fx_done = 1;\n+      switch (fixP->fx_r_type)\n+\t{\n+\tcase BFD_RELOC_X86_64_32S:\n+\t  fixP->fx_signed = 1;\n+\t  break;\n+\n+\tdefault:\n+\t  break;\n+\t}\n+    }\n #if defined (OBJ_COFF) && defined (TE_PE)\n   else if (fixP->fx_addsy != NULL && S_IS_WEAK (fixP->fx_addsy))\n     {"
    },
    {
      "sha": "a9a2a6403bbc090dae7a3ad03c6869cc862242b6",
      "filename": "gas/testsuite/gas/i386/i386.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b818855549013ba43e730e07f790e5cbfd16a757/gas/testsuite/gas/i386/i386.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b818855549013ba43e730e07f790e5cbfd16a757/gas/testsuite/gas/i386/i386.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/i386.exp?ref=b818855549013ba43e730e07f790e5cbfd16a757",
      "patch": "@@ -750,6 +750,7 @@ if [gas_64_check] then {\n     run_dump_test \"x86_64-intel\"\n     run_dump_test \"x86-64-addr32\"\n     run_dump_test \"x86-64-addr32-intel\"\n+    run_list_test \"x86-64-addr32-bad\" \"-al\"\n     run_dump_test \"x86-64-opcode\"\n     run_dump_test \"x86-64-intel64\"\n     if { ! [istarget \"*-*-*cygwin*\"] && ![istarget \"*-*-mingw*\"] } then {"
    },
    {
      "sha": "bddf0d143d6d117c0fc845046dd87ff641679f80",
      "filename": "gas/testsuite/gas/i386/x86-64-addr32-bad.l",
      "status": "added",
      "additions": 29,
      "deletions": 0,
      "changes": 29,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b818855549013ba43e730e07f790e5cbfd16a757/gas/testsuite/gas/i386/x86-64-addr32-bad.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b818855549013ba43e730e07f790e5cbfd16a757/gas/testsuite/gas/i386/x86-64-addr32-bad.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-addr32-bad.l?ref=b818855549013ba43e730e07f790e5cbfd16a757",
      "patch": "@@ -0,0 +1,29 @@\n+.*: Assembler messages:\n+.*:3: Error:.* [0x]*88888888 .*\n+.*:7: Error:.* [0x]*99999999 .*\n+.*:11: Error:.* [0x]*99999999 .*\n+GAS LISTING .*\n+\n+\n+[ \t]*[0-9]+[ \t]+\\.text\n+[ \t]*[0-9]+[ \t]+addr32:\n+[ \t]*[0-9]+[ \t]+lea\t0x88888888\\(%rax\\), %rax\n+[ \t]*[0-9]+[ \t]+\\?\\?\\?\\? 8D808888[ \t]+lea\t0x88888888\\(%rax\\), %eax\n+[ \t]*[0-9]+[ \t]+8888\n+[ \t]*[0-9]+[ \t]+\\?\\?\\?\\? 67488D80[ \t]+lea\t0x88888888\\(%eax\\), %rax\n+[ \t]*[0-9]+[ \t]+88888888 *\n+[ \t]*[0-9]+[ \t]*\n+[ \t]*[0-9]+[ \t]+\\?\\?\\?\\? 488D8099[ \t]+lea\tvalue\\(%rax\\), %rax\n+[ \t]*[0-9]+[ \t]+999999\n+[ \t]*[0-9]+[ \t]+\\?\\?\\?\\? 8D809999[ \t]+lea\tvalue\\(%rax\\), %eax\n+[ \t]*[0-9]+[ \t]+9999\n+[ \t]*[0-9]+[ \t]+\\?\\?\\?\\? 67488D80[ \t]+lea\tvalue\\(%eax\\), %rax\n+[ \t]*[0-9]+[ \t]+99999999 *\n+[ \t]*[0-9]+[ \t]*\n+[ \t]*[0-9]+[ \t]+\\?\\?\\?\\? 48C7C099[ \t]+mov\t\\$value, %rax\n+[ \t]*[0-9]+[ \t]+999999\n+[ \t]*[0-9]+[ \t]+\\?\\?\\?\\? B8999999[ \t]+mov\t\\$value, %eax\n+[ \t]*[0-9]+[ \t]+99\n+[ \t]*[0-9]+[ \t]*\n+[ \t]*[0-9]+[ \t]+\\.equ\tvalue, 0x99999999\n+#pass"
    },
    {
      "sha": "460be2012e0e9924ea98b9f8e10e1c79cd5419b4",
      "filename": "gas/testsuite/gas/i386/x86-64-addr32-bad.s",
      "status": "added",
      "additions": 15,
      "deletions": 0,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/b818855549013ba43e730e07f790e5cbfd16a757/gas/testsuite/gas/i386/x86-64-addr32-bad.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/b818855549013ba43e730e07f790e5cbfd16a757/gas/testsuite/gas/i386/x86-64-addr32-bad.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/i386/x86-64-addr32-bad.s?ref=b818855549013ba43e730e07f790e5cbfd16a757",
      "patch": "@@ -0,0 +1,15 @@\n+\t.text\n+addr32:\n+\tlea\t0x88888888(%rax), %rax\n+\tlea\t0x88888888(%rax), %eax\n+\tlea\t0x88888888(%eax), %rax\n+\n+\tlea\tvalue(%rax), %rax\n+\tlea\tvalue(%rax), %eax\n+\tlea\tvalue(%eax), %rax\n+\n+\tmov\t$value, %rax\n+\tmov\t$value, %eax\n+\n+\t.equ\tvalue, 0x99999999\n+\t.end"
    }
  ]
}