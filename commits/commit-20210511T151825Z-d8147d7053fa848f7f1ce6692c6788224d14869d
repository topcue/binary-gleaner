{
  "sha": "d8147d7053fa848f7f1ce6692c6788224d14869d",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDgxNDdkNzA1M2ZhODQ4ZjdmMWNlNjY5MmM2Nzg4MjI0ZDE0ODY5ZA==",
  "commit": {
    "author": {
      "name": "Richard Earnshaw",
      "email": "rearnsha@arm.com",
      "date": "2021-05-11T15:18:25Z"
    },
    "committer": {
      "name": "Richard Earnshaw",
      "email": "rearnsha@arm.com",
      "date": "2021-05-11T15:18:25Z"
    },
    "message": "arm: correctly decode Tag_THUMB_ISA_use=3 for thumb2 features\n\nThis was detected when a user accidentally tried to build a shared\nlibrary using armv8-m.main objects.  The resulting error was \"warning:\nthumb-1 mode PLT generation not currently supported\".  Something was\nclearly wrong because v8-m.main is a thumb-2 variant.\n\nIt turns out that the code to detect thumb-2 in object files hadn't\nbeen updated for the extended definition of Tag_THUMB_ISA_use to\nsupport the value 3, meaning 'work it out for yourself from the\narchitecture tag'; something that is now necessary given that the line\nbetween thumb-1 and thumb-2 has become blurred over time.\n\nAnother problem with the function doing this calculation was that the\nabsence of this tag (implying a default value 0) should mean use of\nthumb code was NOT permitted.  However, the code went on to look at\nthe architecture flags and decide that it could ignore this if the\narchitecture flags said that thumb2 features were available, thus\ncompletely ignoring the intended meaning.\n\nbfd/\n\n\t* elf32-arm.c (using_thumb2): Correctly handle Tag_THUMB_ISA_use\n\tvalues 0 and 3.",
    "tree": {
      "sha": "541fc885fddce6e96baccf98d83ba5f42b82237d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/541fc885fddce6e96baccf98d83ba5f42b82237d"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d8147d7053fa848f7f1ce6692c6788224d14869d",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d8147d7053fa848f7f1ce6692c6788224d14869d",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d8147d7053fa848f7f1ce6692c6788224d14869d",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d8147d7053fa848f7f1ce6692c6788224d14869d/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "d30182b51edd04b9f09b1a79d429fc286458b221",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d30182b51edd04b9f09b1a79d429fc286458b221",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d30182b51edd04b9f09b1a79d429fc286458b221"
    }
  ],
  "stats": {
    "total": 4,
    "additions": 3,
    "deletions": 1
  },
  "files": [
    {
      "sha": "cb567fe82ad0dbda1eee09368e2d5ce9d78f44d4",
      "filename": "bfd/elf32-arm.c",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d8147d7053fa848f7f1ce6692c6788224d14869d/bfd/elf32-arm.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d8147d7053fa848f7f1ce6692c6788224d14869d/bfd/elf32-arm.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf32-arm.c?ref=d8147d7053fa848f7f1ce6692c6788224d14869d",
      "patch": "@@ -3888,9 +3888,11 @@ using_thumb2 (struct elf32_arm_link_hash_table *globals)\n   int thumb_isa = bfd_elf_get_obj_attr_int (globals->obfd, OBJ_ATTR_PROC,\n \t\t\t\t\t    Tag_THUMB_ISA_use);\n \n-  if (thumb_isa)\n+  /* No use of thumb permitted, or a legacy thumb-1/2 definition.  */\n+  if (thumb_isa < 3)\n     return thumb_isa == 2;\n \n+  /* Variant of thumb is described by the architecture tag.  */\n   arch = bfd_elf_get_obj_attr_int (globals->obfd, OBJ_ATTR_PROC, Tag_CPU_arch);\n \n   /* Force return logic to be reviewed for each new architecture.  */"
    }
  ]
}