{
  "sha": "0bff75284e1067e22cbe88fad672362db06f22ee",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MGJmZjc1Mjg0ZTEwNjdlMjJjYmU4OGZhZDY3MjM2MmRiMDZmMjJlZQ==",
  "commit": {
    "author": {
      "name": "Gunther Nikl",
      "email": "gnikl@justmail.de",
      "date": "2020-06-03T14:24:58Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2020-06-03T14:24:58Z"
    },
    "message": "This patch set for the generic BFD a.out backend removes a dead #define and makes aoutx.h self-contained:  [PATCH 1/2]: bfd: remove unused NO_WRITE_HEADER_KLUDGE #define  [PATCH 2/2]: bfd: make aoutx.h self-contained\n\n\t* aout64.c (BMAGIC, QMAGIC): Do not define.\n\t* aoutx.h (N_IS_BMAGIC, N_SET_QMAGIC): New defines.\n\t(NAME (aout, some_aout_object_p)): Use N_IS_QMAGIC and N_IS_BMAGIC\n\tto check the file format.\n\t(adjust_z_magic): Use N_SET_QMAGIC to set file format.\n\t* i386aout.c (NO_WRITE_HEADER_KLUDGE): Delete define.\n\t* libaout.h (NO_WRITE_HEADER_KLUDGE): Do not define.",
    "tree": {
      "sha": "c3374d8a516b9800ad84481903259460ed3aae07",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c3374d8a516b9800ad84481903259460ed3aae07"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/0bff75284e1067e22cbe88fad672362db06f22ee",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0bff75284e1067e22cbe88fad672362db06f22ee",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/0bff75284e1067e22cbe88fad672362db06f22ee",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/0bff75284e1067e22cbe88fad672362db06f22ee/comments",
  "author": null,
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d49e5065ed43ec88627fd8cc6ab9e45fcc0e538a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d49e5065ed43ec88627fd8cc6ab9e45fcc0e538a",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/d49e5065ed43ec88627fd8cc6ab9e45fcc0e538a"
    }
  ],
  "stats": {
    "total": 41,
    "additions": 25,
    "deletions": 16
  },
  "files": [
    {
      "sha": "436eb5a2c7730673aa966f9a14d14dc0cdfea78f",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=0bff75284e1067e22cbe88fad672362db06f22ee",
      "patch": "@@ -1,3 +1,13 @@\n+2020-06-03  Gunther Nikl  <gnikl@justmail.de>\n+\n+\t* aout64.c (BMAGIC, QMAGIC): Do not define.\n+\t* aoutx.h (N_IS_BMAGIC, N_SET_QMAGIC): New defines.\n+\t(NAME (aout, some_aout_object_p)): Use N_IS_QMAGIC and N_IS_BMAGIC\n+\tto check the file format.\n+\t(adjust_z_magic): Use N_SET_QMAGIC to set file format.\n+\t* i386aout.c (NO_WRITE_HEADER_KLUDGE): Delete define.\n+\t* libaout.h (NO_WRITE_HEADER_KLUDGE): Do not define.\n+\n 2020-06-03  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* elf-bfd.h (_bfd_elf_maybe_set_textrel): New"
    },
    {
      "sha": "73e3cc7afee7db43f9d6813a4e7dbf59f6e406bc",
      "filename": "bfd/aout64.c",
      "status": "modified",
      "additions": 0,
      "deletions": 8,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/aout64.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/aout64.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/aout64.c?ref=0bff75284e1067e22cbe88fad672362db06f22ee",
      "patch": "@@ -21,12 +21,4 @@\n \n #define ARCH_SIZE 64\n \n-/* aoutx.h requires definitions for BMAGIC and QMAGIC.  */\n-#ifndef BMAGIC\n-#define BMAGIC 0\n-#endif\n-#ifndef QMAGIC\n-#define QMAGIC 0\n-#endif\n-\n #include \"aoutx.h\""
    },
    {
      "sha": "8fe2a62d21c76a60e2e219473156a8977cf68d2e",
      "filename": "bfd/aoutx.h",
      "status": "modified",
      "additions": 15,
      "deletions": 4,
      "changes": 19,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/aoutx.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/aoutx.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/aoutx.h?ref=0bff75284e1067e22cbe88fad672362db06f22ee",
      "patch": "@@ -128,6 +128,18 @@ DESCRIPTION\n #include \"aout/stab_gnu.h\"\n #include \"aout/ar.h\"\n \n+#ifdef BMAGIC\n+#define N_IS_BMAGIC(x) (N_MAGIC (x) == BMAGIC)\n+#else\n+#define N_IS_BMAGIC(x) (0)\n+#endif\n+\n+#ifdef QMAGIC\n+#define N_SET_QMAGIC(x) N_SET_MAGIC (x, QMAGIC)\n+#else\n+#define N_SET_QMAGIC(x) do { /**/ } while (0)\n+#endif\n+\n /*\n SUBSECTION\n \tRelocations\n@@ -492,7 +504,7 @@ NAME (aout, some_aout_object_p) (bfd *abfd,\n       abfd->flags |= D_PAGED | WP_TEXT;\n       adata (abfd).magic = z_magic;\n     }\n-  else if (N_MAGIC (execp) == QMAGIC)\n+  else if (N_IS_QMAGIC (execp))\n     {\n       abfd->flags |= D_PAGED | WP_TEXT;\n       adata (abfd).magic = z_magic;\n@@ -503,8 +515,7 @@ NAME (aout, some_aout_object_p) (bfd *abfd,\n       abfd->flags |= WP_TEXT;\n       adata (abfd).magic = n_magic;\n     }\n-  else if (N_MAGIC (execp) == OMAGIC\n-\t   || N_MAGIC (execp) == BMAGIC)\n+  else if (N_MAGIC (execp) == OMAGIC || N_IS_BMAGIC (execp))\n     adata (abfd).magic = o_magic;\n   else\n     /* Should have been checked with N_BADMAG before this routine\n@@ -1026,7 +1037,7 @@ adjust_z_magic (bfd *abfd, struct internal_exec *execp)\n   if (ztih && (!abdp || (abdp && !abdp->exec_header_not_counted)))\n     execp->a_text += adata (abfd).exec_bytes_size;\n   if (obj_aout_subformat (abfd) == q_magic_format)\n-    N_SET_MAGIC (execp, QMAGIC);\n+    N_SET_QMAGIC (execp);\n   else\n     N_SET_MAGIC (execp, ZMAGIC);\n "
    },
    {
      "sha": "61e0306f8d548472ced6521f28e4dae7cc3a516a",
      "filename": "bfd/i386aout.c",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/i386aout.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/i386aout.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/i386aout.c?ref=0bff75284e1067e22cbe88fad672362db06f22ee",
      "patch": "@@ -38,7 +38,6 @@\n    the tokens.  */\n #define MY(OP) CONCAT2 (i386_aout_,OP)\n #define TARGETNAME \"a.out-i386\"\n-#define NO_WRITE_HEADER_KLUDGE 1\n \n #include \"sysdep.h\"\n #include \"bfd.h\""
    },
    {
      "sha": "8e620727419dd543c73bf4054536c185a329eef5",
      "filename": "bfd/libaout.h",
      "status": "modified",
      "additions": 0,
      "deletions": 3,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/libaout.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/0bff75284e1067e22cbe88fad672362db06f22ee/bfd/libaout.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/libaout.h?ref=0bff75284e1067e22cbe88fad672362db06f22ee",
      "patch": "@@ -609,9 +609,6 @@ extern bfd_boolean NAME (aout, bfd_free_cached_info)\n #define\taout_32_get_section_contents\t_bfd_generic_get_section_contents\n \n #define\taout_64_get_section_contents\t_bfd_generic_get_section_contents\n-#ifndef NO_WRITE_HEADER_KLUDGE\n-#define NO_WRITE_HEADER_KLUDGE 0\n-#endif\n \n #ifndef aout_32_bfd_is_local_label_name\n #define aout_32_bfd_is_local_label_name bfd_generic_is_local_label_name"
    }
  ]
}