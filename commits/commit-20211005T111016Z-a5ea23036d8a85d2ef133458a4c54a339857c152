{
  "sha": "a5ea23036d8a85d2ef133458a4c54a339857c152",
  "node_id": "C_kwDOANOeidoAKGE1ZWEyMzAzNmQ4YTg1ZDJlZjEzMzQ1OGE0YzU0YTMzOTg1N2MxNTI",
  "commit": {
    "author": {
      "name": "Bhuvanendra Kumar N",
      "email": "Bhuvanendra.KumarN@amd.com",
      "date": "2021-10-05T11:10:16Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-10-05T11:10:16Z"
    },
    "message": "[gdb/testsuite] Use function_range in gdb.dwarf2/dw2-ref-missing-frame.exp\n\nFollowing 2 test points are failing with clang compiler\n\n(gdb) FAIL: gdb.dwarf2/dw2-ref-missing-frame.exp: func_nofb print\n(gdb) FAIL: gdb.dwarf2/dw2-ref-missing-frame.exp: func_loopfb print\n\nAs in commit f677852bbda \"[gdb/testsuite] Use function_range in\ngdb.dwarf2/dw2-abs-hi-pc.exp\", the problem is that the CU and functions\nhave an empty address range, due to using asm labels in global scope,\nwhich is a known source of problems, as explained in the comment of proc\nfunction_range in gdb/testsuite/lib/dwarf.exp.  Hence fix this also by\nusing function_range.\n\nTested on x86_64-linux with gcc and clang.",
    "tree": {
      "sha": "74fbc63e0edb067f2869caaf12a5882131cb415a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/74fbc63e0edb067f2869caaf12a5882131cb415a"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/a5ea23036d8a85d2ef133458a4c54a339857c152",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a5ea23036d8a85d2ef133458a4c54a339857c152",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/a5ea23036d8a85d2ef133458a4c54a339857c152",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a5ea23036d8a85d2ef133458a4c54a339857c152/comments",
  "author": {
    "login": "bhuvanendrakumarn",
    "id": 64949312,
    "node_id": "MDQ6VXNlcjY0OTQ5MzEy",
    "avatar_url": "https://avatars.githubusercontent.com/u/64949312?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bhuvanendrakumarn",
    "html_url": "https://github.com/bhuvanendrakumarn",
    "followers_url": "https://api.github.com/users/bhuvanendrakumarn/followers",
    "following_url": "https://api.github.com/users/bhuvanendrakumarn/following{/other_user}",
    "gists_url": "https://api.github.com/users/bhuvanendrakumarn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bhuvanendrakumarn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bhuvanendrakumarn/subscriptions",
    "organizations_url": "https://api.github.com/users/bhuvanendrakumarn/orgs",
    "repos_url": "https://api.github.com/users/bhuvanendrakumarn/repos",
    "events_url": "https://api.github.com/users/bhuvanendrakumarn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bhuvanendrakumarn/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "b1f0f2841871f407d116e3e7f0dfca3e410633d4",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/b1f0f2841871f407d116e3e7f0dfca3e410633d4",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/b1f0f2841871f407d116e3e7f0dfca3e410633d4"
    }
  ],
  "stats": {
    "total": 57,
    "additions": 25,
    "deletions": 32
  },
  "files": [
    {
      "sha": "90772d659937cc0e07d96ffc7d1587a10576e432",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame-func.c",
      "status": "modified",
      "additions": 2,
      "deletions": 20,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a5ea23036d8a85d2ef133458a4c54a339857c152/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame-func.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a5ea23036d8a85d2ef133458a4c54a339857c152/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame-func.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame-func.c?ref=a5ea23036d8a85d2ef133458a4c54a339857c152",
      "patch": "@@ -15,34 +15,16 @@\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.  */\n \n-asm (\".globl cu_text_start\");\n-asm (\"cu_text_start:\");\n-\n-asm (\".globl func_nofb_start\");\n-asm (\".p2align 4\");\n-asm (\"func_nofb_start:\");\n-\n void\n func_nofb (void)\n {\n+asm (\"func_nofb_label: .globl func_nofb_label\\n\");\n   /* int func_nofb_var; */\n }\n \n-asm (\".globl func_nofb_end\");\n-asm (\"func_nofb_end:\");\n-\n-asm (\".globl func_loopfb_start\");\n-asm (\".p2align 4\");\n-asm (\"func_loopfb_start:\");\n-\n void\n func_loopfb (void)\n {\n+asm (\"func_loopfb_label: .globl func_loopfb_label\\n\");\n   /* int func_loopfb_var; */\n }\n-\n-asm (\".globl func_loopfb_end\");\n-asm (\"func_loopfb_end:\");\n-\n-asm (\".globl cu_text_end\");\n-asm (\"cu_text_end:\");"
    },
    {
      "sha": "293eb0eca43d7edb95a0890d28f158fbf8f73e4a",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame.S",
      "status": "modified",
      "additions": 6,
      "deletions": 6,
      "changes": 12,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a5ea23036d8a85d2ef133458a4c54a339857c152/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame.S",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a5ea23036d8a85d2ef133458a4c54a339857c152/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame.S",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame.S?ref=a5ea23036d8a85d2ef133458a4c54a339857c152",
      "patch": "@@ -28,8 +28,8 @@\n \n \t/* CU die */\n \t.uleb128 1\t\t\t\t/* Abbrev: DW_TAG_compile_unit */\n-\t.4byte\tcu_text_end\t\t\t/* DW_AT_high_pc */\n-\t.4byte\tcu_text_start\t\t\t/* DW_AT_low_pc */\n+\t.4byte\tFUNC_LOOPFB_END\t\t\t/* DW_AT_high_pc */\n+\t.4byte\tFUNC_NOFB_START\t\t\t/* DW_AT_low_pc */\n \t.ascii\t\"file1.txt\\0\"\t\t\t/* DW_AT_name */\n \t.ascii\t\"GNU C 3.3.3\\0\"\t\t\t/* DW_AT_producer */\n \t.byte\t1\t\t\t\t/* DW_AT_language (C) */\n@@ -43,8 +43,8 @@\n \t/* func_nofb */\n \t.uleb128\t5\t\t\t/* Abbrev: DW_TAG_subprogram (no fb) */\n \t.ascii\t\t\"func_nofb\\0\"\t\t/* DW_AT_name */\n-\t.4byte\t\tfunc_nofb_start\t\t/* DW_AT_low_pc */\n-\t.4byte\t\tfunc_nofb_end\t\t/* DW_AT_high_pc */\n+\t.4byte          FUNC_NOFB_START         /* DW_AT_low_pc */\n+\t.4byte          FUNC_NOFB_END           /* DW_AT_high_pc */\n \n \t.uleb128\t7\t\t\t/* Abbrev: DW_TAG_variable (location) */\n \t.ascii\t\t\"func_nofb_var\\0\"\t/* DW_AT_name */\n@@ -58,8 +58,8 @@\n \t/* func_loopfb */\n \t.uleb128\t6\t\t\t/* Abbrev: DW_TAG_subprogram (loop fb) */\n \t.ascii\t\t\"func_loopfb\\0\"\t\t/* DW_AT_name */\n-\t.4byte\t\tfunc_loopfb_start\t/* DW_AT_low_pc */\n-\t.4byte\t\tfunc_loopfb_end\t\t/* DW_AT_high_pc */\n+\t.4byte\t\tFUNC_LOOPFB_START\t/* DW_AT_low_pc */\n+\t.4byte\t\tFUNC_LOOPFB_END\t\t/* DW_AT_high_pc */\n \t.byte\t\t2f - 1f\t\t\t/* DW_AT_frame_base */\n 1:\t.byte\t\t0x91\t\t\t/*   DW_OP_fbreg */\n \t.sleb128\t0\t\t\t/*   0 */"
    },
    {
      "sha": "e8d7c0ff28002c931ef45ead43f5641deba939a7",
      "filename": "gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame.exp",
      "status": "modified",
      "additions": 17,
      "deletions": 6,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a5ea23036d8a85d2ef133458a4c54a339857c152/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a5ea23036d8a85d2ef133458a4c54a339857c152/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.dwarf2/dw2-ref-missing-frame.exp?ref=a5ea23036d8a85d2ef133458a4c54a339857c152",
      "patch": "@@ -19,14 +19,25 @@ if {![dwarf2_support]} {\n     return 0  \n }\n \n-standard_testfile .S\n-set srcfuncfile ${testfile}-func.c\n-set srcmainfile ${testfile}-main.c\n+standard_testfile .S -func.c -main.c\n+lassign [function_range func_nofb \\\n+             \"${srcdir}/${subdir}/${srcfile2} ${srcdir}/${subdir}/${srcfile3}\"] \\\n+    func_nofb_start func_nofb_len\n+lassign [function_range func_loopfb \\\n+             \"${srcdir}/${subdir}/${srcfile2} ${srcdir}/${subdir}/${srcfile3}\"] \\\n+    func_loopfb_start func_loopfb_len\n+\n+set flags \\\n+    [list \\\n+         \"debug\" \\\n+         \"additional_flags=\\\"-DFUNC_NOFB_START=$func_nofb_start\\\"\" \\\n+         \"additional_flags=\\\"-DFUNC_NOFB_END=$func_nofb_start + $func_nofb_len\\\"\" \\\n+         \"additional_flags=\\\"-DFUNC_LOOPFB_START=$func_loopfb_start\\\"\" \\\n+         \"additional_flags=\\\"-DFUNC_LOOPFB_END=$func_loopfb_start + $func_loopfb_len\\\"\"]\n set executable ${testfile}\n \n-if {[prepare_for_testing_full \"failed to prepare\" \\\n-\t [list $testfile {} $srcfile {} $srcfuncfile {} \\\n-\t      $srcmainfile debug]]} {\n+if {[prepare_for_testing \"failed to prepare\" $testfile \\\n+         [list $srcfile3 $srcfile $srcfile2] $flags] == -1} {\n     return -1\n }\n "
    }
  ]
}