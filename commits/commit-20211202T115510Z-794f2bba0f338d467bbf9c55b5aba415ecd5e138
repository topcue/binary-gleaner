{
  "sha": "794f2bba0f338d467bbf9c55b5aba415ecd5e138",
  "node_id": "C_kwDOANOeidoAKDc5NGYyYmJhMGYzMzhkNDY3YmJmOWM1NWI1YWJhNDE1ZWNkNWUxMzg",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2021-12-01T12:55:24Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2021-12-02T11:55:10Z"
    },
    "message": "x86: Skip __[start|stop]_SECNAME for --gc-sections -z start-stop-gc\n\nDon't convert memory load to immediate load on __start_SECNAME and\n__stop_SECNAME for --gc-sections -z start-stop-gc if all SECNAME\nsections been garbage collected.\n\nbfd/\n\n\tPR ld/27491\n\t* elf32-i386.c (elf_i386_convert_load_reloc): Skip __start_SECNAME\n\tand __stop_SECNAME for --gc-sections -z start-stop-gc if the input\n\tsection been garbage collected.\n\t* elf64-x86-64.c (elf_x86_64_convert_load_reloc): Likewise.\n\t* elfxx-x86.h (elf_x86_start_stop_gc_p): New function.\n\nld/\n\tPR ld/27491\n\t* testsuite/ld-i386/i386.exp: Run PR ld/27491 tests.\n\t* testsuite/ld-x86-64/x86-64.exp: Likewise.\n\t* testsuite/ld-i386/pr27491-1.s: New file.\n\t* testsuite/ld-i386/pr27491-1a.d: Likewise.\n\t* testsuite/ld-i386/pr27491-1b.d: Likewise.\n\t* testsuite/ld-i386/pr27491-1c.d: Likewise.\n\t* testsuite/ld-i386/pr27491-2.d: Likewise.\n\t* testsuite/ld-i386/pr27491-2.s: Likewise.\n\t* testsuite/ld-i386/pr27491-3.d: Likewise.\n\t* testsuite/ld-i386/pr27491-3.s: Likewise.\n\t* testsuite/ld-i386/pr27491-4.d: Likewise.\n\t* testsuite/ld-i386/pr27491-4a.s: Likewise.\n\t* testsuite/ld-i386/pr27491-4b.s: Likewise.\n\t* testsuite/ld-x86-64/pr27491-1.s: Likewise.\n\t* testsuite/ld-x86-64/pr27491-1a.d: Likewise.\n\t* testsuite/ld-x86-64/pr27491-1b.d: Likewise.\n\t* testsuite/ld-x86-64/pr27491-1c.d: Likewise.\n\t* testsuite/ld-x86-64/pr27491-2.d: Likewise.\n\t* testsuite/ld-x86-64/pr27491-2.s: Likewise.\n\t* testsuite/ld-x86-64/pr27491-3.d: Likewise.\n\t* testsuite/ld-x86-64/pr27491-3.s: Likewise.\n\t* testsuite/ld-x86-64/pr27491-4.d: Likewise.\n\t* testsuite/ld-x86-64/pr27491-4a.s: Likewise.\n\t* testsuite/ld-x86-64/pr27491-4b.s: Likewise.",
    "tree": {
      "sha": "b36f058ec24e9f353d9dae0589fcd3d4f8a83dee",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/b36f058ec24e9f353d9dae0589fcd3d4f8a83dee"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/794f2bba0f338d467bbf9c55b5aba415ecd5e138",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/794f2bba0f338d467bbf9c55b5aba415ecd5e138",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/794f2bba0f338d467bbf9c55b5aba415ecd5e138",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/794f2bba0f338d467bbf9c55b5aba415ecd5e138/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "c808def421f383a226198751d93239ded2b0d21d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c808def421f383a226198751d93239ded2b0d21d",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c808def421f383a226198751d93239ded2b0d21d"
    }
  ],
  "stats": {
    "total": 391,
    "additions": 391,
    "deletions": 0
  },
  "files": [
    {
      "sha": "db6d1accdbc7e0143757206fea53cddfd709315b",
      "filename": "bfd/elf32-i386.c",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/bfd/elf32-i386.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/bfd/elf32-i386.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf32-i386.c?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -1393,6 +1393,11 @@ elf_i386_convert_load_reloc (bfd *abfd, Elf_Internal_Shdr *symtab_hdr,\n \t       || h->root.type == bfd_link_hash_defweak)\n \t      && local_ref))\n \t{\n+\t  /* Skip __start_SECNAME/__stop_SECNAME when --gc-sections\n+\t     -z start-stop-gc are used.  */\n+\t  if (elf_x86_start_stop_gc_p (link_info, h))\n+\t    return true;\n+\n \tconvert_load:\n \t  if (opcode == 0x8b)\n \t    {"
    },
    {
      "sha": "bb6df798d7b04db28756f9d4cad49325c6c18d26",
      "filename": "bfd/elf64-x86-64.c",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/bfd/elf64-x86-64.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/bfd/elf64-x86-64.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf64-x86-64.c?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -1643,6 +1643,11 @@ elf_x86_64_convert_load_reloc (bfd *abfd,\n \t\t\t   || h->root.type == bfd_link_hash_defweak)\n \t\t\t  && h->root.u.def.section == bfd_und_section_ptr))))\n \t    {\n+\t      /* Skip __start_SECNAME/__stop_SECNAME when --gc-sections\n+\t         -z start-stop-gc are used.  */\n+\t      if (elf_x86_start_stop_gc_p (link_info, h))\n+\t\treturn true;\n+\n \t      /* Skip since R_X86_64_32/R_X86_64_32S may overflow.  */\n \t      if (no_overflow)\n \t\treturn true;"
    },
    {
      "sha": "aab641ab751db9873cca55cfbbc23d67c430baad",
      "filename": "bfd/elfxx-x86.h",
      "status": "modified",
      "additions": 33,
      "deletions": 0,
      "changes": 33,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/bfd/elfxx-x86.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/bfd/elfxx-x86.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elfxx-x86.h?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -731,3 +731,36 @@ extern void _bfd_x86_elf_link_report_relative_reloc\n   _bfd_x86_elf_merge_gnu_properties\n #define elf_backend_fixup_gnu_properties \\\n   _bfd_x86_elf_link_fixup_gnu_properties\n+\n+/* Return true if H is a __start_SECNAME/__stop_SECNAME symbol for the\n+   SECNAME section which has been garbage collected by --gc-sections\n+   -z start-stop-gc.  */\n+\n+static inline bool\n+elf_x86_start_stop_gc_p (struct bfd_link_info *link_info,\n+\t\t\t struct elf_link_hash_entry *h)\n+{\n+  if (h->start_stop\n+      && link_info->gc_sections\n+      && link_info->start_stop_gc)\n+    {\n+      asection *s = h->root.u.def.section;\n+\n+      do\n+\t{\n+\t  /* Return false if any SECNAME section is kept.  */\n+\t  if (s->gc_mark)\n+\t    return false;\n+\t  s = bfd_get_next_section_by_name (s->owner, s);\n+\t}\n+      while (s != NULL);\n+\n+      /* Return true only if all SECNAME sections have been garbage\n+\t collected.  */\n+      return true;\n+    }\n+\n+  /* Return false if H isn't a __start_SECNAME/__stop_SECNAME symbol or\n+     --gc-sections or -z start-stop-gc isn't used.  */\n+  return false;\n+}"
    },
    {
      "sha": "23ab8544c79e81cea768075b2e6d54e77b984acc",
      "filename": "ld/testsuite/ld-i386/i386.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/i386.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/i386.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/i386.exp?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -493,6 +493,12 @@ run_dump_test \"property-x86-isa3\"\n run_dump_test \"property-x86-isa4\"\n run_dump_test \"pr26869\"\n run_dump_test \"code16\"\n+run_dump_test \"pr27491-1a\"\n+run_dump_test \"pr27491-1b\"\n+run_dump_test \"pr27491-1c\"\n+run_dump_test \"pr27491-2\"\n+run_dump_test \"pr27491-3\"\n+run_dump_test \"pr27491-4\"\n \n if { !([istarget \"i?86-*-linux*\"]\n        || [istarget \"i?86-*-gnu*\"]"
    },
    {
      "sha": "89155aee5f4880c5fcaff2567d551e077c5d0793",
      "filename": "ld/testsuite/ld-i386/pr27491-1.s",
      "status": "added",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-1.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-1.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-1.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,14 @@\n+\t.weak __start_xx\n+\t.weak __stop_xx\n+\n+\t.text\n+\t.global foo\n+foo:\n+\tmovl\t__start_xx@got(%ebx), %eax\n+\tmovl\t__stop_xx@got(%ebx), %eax\n+\n+\t.section xx,\"a\",unique,0\n+\t.byte 0\n+\n+\t.section xx,\"a\",unique,1\n+\t.byte 1"
    },
    {
      "sha": "006c17695c1c6fa6555d122c1762c0d0ed2746ef",
      "filename": "ld/testsuite/ld-i386/pr27491-1a.d",
      "status": "added",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-1a.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-1a.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-1a.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,14 @@\n+#source: pr27491-1.s\n+#as: --32\n+#ld: --gc-sections -melf_i386 -z start-stop-gc -shared\n+#objdump: -dw\n+\n+.*: +file format elf32-i386\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t8b 83 ([0-9a-f]{2} ){4}[ \\t]+mov +-0x[a-f0-9]+\\(%ebx\\),%eax\n+ +[a-f0-9]+:\t8b 83 ([0-9a-f]{2} ){4}[ \\t]+mov +-0x[a-f0-9]+\\(%ebx\\),%eax\n+#pass"
    },
    {
      "sha": "69b9ac3b08214dd6ea1f37509344e90a7e542fc0",
      "filename": "ld/testsuite/ld-i386/pr27491-1b.d",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-1b.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-1b.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-1b.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,11 @@\n+#source: pr27491-1.s\n+#as: --32\n+#ld: --gc-sections -melf_i386 -z start-stop-gc -shared\n+#nm: -n\n+\n+#failif\n+#...\n+[a-f0-9]+ R __start_xx\n+#...\n+[a-f0-9]+ R __stop_xx\n+#..."
    },
    {
      "sha": "730e975d1799a1f78ceafea428bfeed0d4a5d102",
      "filename": "ld/testsuite/ld-i386/pr27491-1c.d",
      "status": "added",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-1c.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-1c.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-1c.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,14 @@\n+#source: pr27491-1.s\n+#as: --32\n+#ld: --gc-sections -melf_i386 -shared\n+#objdump: -dw\n+\n+.*: +file format elf32-i386\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+#pass"
    },
    {
      "sha": "02b310aab6e5512b03a33b05270e010d98e4a59d",
      "filename": "ld/testsuite/ld-i386/pr27491-2.d",
      "status": "added",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-2.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-2.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-2.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,22 @@\n+#as: --32\n+#ld: --gc-sections -melf_i386 -z start-stop-gc -shared\n+#objdump: --syms -dw\n+\n+.*: +file format elf32-i386\n+\n+\n+SYMBOL TABLE:\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __stop_xx\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __start_xx\n+#...\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+#pass"
    },
    {
      "sha": "17871dddd76a6eb32b615b4b60925ad246aad021",
      "filename": "ld/testsuite/ld-i386/pr27491-2.s",
      "status": "added",
      "additions": 16,
      "deletions": 0,
      "changes": 16,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-2.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-2.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-2.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,16 @@\n+\t.weak __start_xx\n+\t.weak __stop_xx\n+\n+\t.text\n+\t.global foo\n+foo:\n+\tmovl\t__start_xx@got(%ebx), %eax\n+\tmovl\t__stop_xx@got(%ebx), %eax\n+\tleal\tbar1@got(%ebx), %eax\n+\n+\t.section xx,\"a\",unique,0\n+bar1:\n+\t.byte 0\n+\n+\t.section xx,\"a\",unique,1\n+\t.byte 1"
    },
    {
      "sha": "7749570168945097fc16bf30fb377e94a904eaf5",
      "filename": "ld/testsuite/ld-i386/pr27491-3.d",
      "status": "added",
      "additions": 21,
      "deletions": 0,
      "changes": 21,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-3.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-3.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-3.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,21 @@\n+#as: --32\n+#ld: --gc-sections -melf_i386 -z start-stop-gc -shared\n+#objdump: --syms -dw\n+\n+.*: +file format elf32-i386\n+\n+\n+SYMBOL TABLE:\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __stop_xx\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __start_xx\n+#...\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+#pass"
    },
    {
      "sha": "85fc3ddfffd5dc87d8868345e65601c2ed9d382c",
      "filename": "ld/testsuite/ld-i386/pr27491-3.s",
      "status": "added",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-3.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-3.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-3.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,14 @@\n+\t.weak __start_xx\n+\t.weak __stop_xx\n+\n+\t.text\n+\t.global foo\n+foo:\n+\tmovl\t__start_xx@got(%ebx), %eax\n+\tmovl\t__stop_xx@got(%ebx), %eax\n+\n+\t.section xx,\"a\",unique,0\n+\t.byte 0\n+\n+\t.section xx,\"aR\",unique,1\n+\t.byte 1"
    },
    {
      "sha": "4a305da1ead6c22240ad55e90aeabe9d648c6e2a",
      "filename": "ld/testsuite/ld-i386/pr27491-4.d",
      "status": "added",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-4.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-4.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-4.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,23 @@\n+#source: pr27491-4a.s\n+#source: pr27491-4b.s\n+#as: --32\n+#ld: --gc-sections -melf_i386 -z start-stop-gc -shared\n+#objdump: --syms -dw\n+\n+.*: +file format elf32-i386\n+\n+\n+SYMBOL TABLE:\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __stop_xx\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __start_xx\n+#...\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+ +[a-f0-9]+:\t8d 83 ([0-9a-f]{2} ){4}[ \\t]+lea +-0x[a-f0-9]+\\(%ebx\\),%eax\n+#pass"
    },
    {
      "sha": "a183b2f820bdba0db9ee4829d106e4271fb93dc2",
      "filename": "ld/testsuite/ld-i386/pr27491-4a.s",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-4a.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-4a.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-4a.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,11 @@\n+\t.weak __start_xx\n+\t.weak __stop_xx\n+\n+\t.text\n+\t.global foo\n+foo:\n+\tmovl\t__start_xx@got(%ebx), %eax\n+\tmovl\t__stop_xx@got(%ebx), %eax\n+\n+\t.section xx,\"a\",unique,0\n+\t.byte 0"
    },
    {
      "sha": "d0b83e92b6433d1c9d08751338d199af016ab783",
      "filename": "ld/testsuite/ld-i386/pr27491-4b.s",
      "status": "added",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-4b.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-i386/pr27491-4b.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-i386/pr27491-4b.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,2 @@\n+\t.section xx,\"aR\",unique,1\n+\t.byte 1"
    },
    {
      "sha": "0d5b7714d871d7a1159c80a4c058ae819d9c7e05",
      "filename": "ld/testsuite/ld-x86-64/pr27491-1.s",
      "status": "added",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-1.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-1.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-1.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,14 @@\n+\t.weak __start_xx\n+\t.weak __stop_xx\n+\n+\t.text\n+\t.global foo\n+foo:\n+\tmovq\t__start_xx@gotpcrel(%rip), %rax\n+\tmovq\t__stop_xx@gotpcrel(%rip), %rax\n+\n+\t.section xx,\"a\",unique,0\n+\t.byte 0\n+\n+\t.section xx,\"a\",unique,1\n+\t.byte 1"
    },
    {
      "sha": "ade5c6fa4f92ffbccf83f254b8afd1c0f8b43b05",
      "filename": "ld/testsuite/ld-x86-64/pr27491-1a.d",
      "status": "added",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-1a.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-1a.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-1a.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,14 @@\n+#source: pr27491-1.s\n+#as: --64\n+#ld: --gc-sections -melf_x86_64 -z start-stop-gc -shared\n+#objdump: -dw\n+\n+.*: +file format elf64-x86-64\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t48 8b 05 ([0-9a-f]{2} ){4}[ \\t]+mov +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <_DYNAMIC\\+0x[a-f0-9]+>\n+ +[a-f0-9]+:\t48 8b 05 ([0-9a-f]{2} ){4}[ \\t]+mov +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <_DYNAMIC\\+0x[a-f0-9]+>\n+#pass"
    },
    {
      "sha": "a6e21dac2196bb318e47f707dd0f7cf47211a191",
      "filename": "ld/testsuite/ld-x86-64/pr27491-1b.d",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-1b.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-1b.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-1b.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,11 @@\n+#source: pr27491-1.s\n+#as: --64\n+#ld: --gc-sections -melf_x86_64 -z start-stop-gc -shared\n+#nm: -n\n+\n+#failif\n+#...\n+[a-f0-9]+ R __start_xx\n+#...\n+[a-f0-9]+ R __stop_xx\n+#..."
    },
    {
      "sha": "1288361463d59e003f0b44b1cde1ae14cb7131ec",
      "filename": "ld/testsuite/ld-x86-64/pr27491-1c.d",
      "status": "added",
      "additions": 21,
      "deletions": 0,
      "changes": 21,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-1c.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-1c.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-1c.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,21 @@\n+#source: pr27491-1.s\n+#as: --64\n+#ld: --gc-sections -melf_x86_64 -shared\n+#objdump: --syms -dw\n+\n+.*: +file format elf64-x86-64\n+\n+SYMBOL TABLE:\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __stop_xx\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __start_xx\n+#...\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <__start_xx>\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <__stop_xx>\n+#pass"
    },
    {
      "sha": "753ebb64082f2b8f0c8f23a1e9d4f717429bb076",
      "filename": "ld/testsuite/ld-x86-64/pr27491-2.d",
      "status": "added",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-2.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-2.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-2.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,23 @@\n+#as: --64\n+#ld: --gc-sections -melf_x86_64 -z start-stop-gc -shared\n+#objdump: --syms -dw\n+\n+.*: +file format elf64-x86-64\n+\n+\n+SYMBOL TABLE:\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __stop_xx\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __start_xx\n+#...\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <__start_xx>\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <__stop_xx>\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <bar1>\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <bar2>\n+#pass"
    },
    {
      "sha": "a0975ff42c50c5f64102635769feb484380948dc",
      "filename": "ld/testsuite/ld-x86-64/pr27491-2.s",
      "status": "added",
      "additions": 20,
      "deletions": 0,
      "changes": 20,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-2.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-2.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-2.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,20 @@\n+\t.weak __start_xx\n+\t.weak __stop_xx\n+\n+\t.text\n+\t.global foo\n+foo:\n+\tmovq\t__start_xx@gotpcrel(%rip), %rax\n+\tmovq\t__stop_xx@gotpcrel(%rip), %rax\n+\tleaq\tbar1(%rip), %rax\n+\tleaq\tbar2(%rip), %rax\n+\n+\t.section xx,\"a\",unique,0\n+\t.byte 0\n+bar1:\n+\t.byte 0\n+bar2:\n+\t.byte 0\n+\n+\t.section xx,\"a\",unique,1\n+\t.byte 1"
    },
    {
      "sha": "6dda5424ffffd6c2926465412fc7a9a175e1cdf4",
      "filename": "ld/testsuite/ld-x86-64/pr27491-3.d",
      "status": "added",
      "additions": 21,
      "deletions": 0,
      "changes": 21,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-3.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-3.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-3.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,21 @@\n+#as: --64\n+#ld: --gc-sections -melf_x86_64 -z start-stop-gc -shared\n+#objdump: --syms -dw\n+\n+.*: +file format elf64-x86-64\n+\n+\n+SYMBOL TABLE:\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __stop_xx\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __start_xx\n+#...\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <__start_xx>\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <__stop_xx>\n+#pass"
    },
    {
      "sha": "efdcba401b3d5ab79a921bff33506f8ea9b6bb76",
      "filename": "ld/testsuite/ld-x86-64/pr27491-3.s",
      "status": "added",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-3.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-3.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-3.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,14 @@\n+\t.weak __start_xx\n+\t.weak __stop_xx\n+\n+\t.text\n+\t.global foo\n+foo:\n+\tmovq\t__start_xx@gotpcrel(%rip), %rax\n+\tmovq\t__stop_xx@gotpcrel(%rip), %rax\n+\n+\t.section xx,\"a\",unique,1\n+\t.byte 0\n+\n+\t.section xx,\"aR\",unique,0\n+\t.byte 1"
    },
    {
      "sha": "54542fd2d1a264871bacf166a78b420da337c82b",
      "filename": "ld/testsuite/ld-x86-64/pr27491-4.d",
      "status": "added",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-4.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-4.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-4.d?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,23 @@\n+#source: pr27491-4a.s\n+#source: pr27491-4b.s\n+#as: --64\n+#ld: --gc-sections -melf_x86_64 -z start-stop-gc -shared\n+#objdump: --syms -dw\n+\n+.*: +file format elf64-x86-64\n+\n+\n+SYMBOL TABLE:\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __stop_xx\n+#...\n+[a-f0-9]+ g       xx\t[a-f0-9]+ \\.protected __start_xx\n+#...\n+\n+\n+Disassembly of section .text:\n+\n+[a-f0-9]+ <foo>:\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <__start_xx>\n+ +[a-f0-9]+:\t48 8d 05 ([0-9a-f]{2} ){4}[ \\t]+lea +0x[a-f0-9]+\\(%rip\\),%rax[ \\t]+# [a-f0-9]+ <__stop_xx>\n+#pass"
    },
    {
      "sha": "3b17a813e841f8eaf8f2cf4463e19d2412ebfdc7",
      "filename": "ld/testsuite/ld-x86-64/pr27491-4a.s",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-4a.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-4a.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-4a.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,11 @@\n+\t.weak __start_xx\n+\t.weak __stop_xx\n+\n+\t.text\n+\t.global foo\n+foo:\n+\tmovq\t__start_xx@gotpcrel(%rip), %rax\n+\tmovq\t__stop_xx@gotpcrel(%rip), %rax\n+\n+\t.section xx,\"a\",unique,1\n+\t.byte 0"
    },
    {
      "sha": "2b46b21d3f0b0928dc52434e445938e75d497bbd",
      "filename": "ld/testsuite/ld-x86-64/pr27491-4b.s",
      "status": "added",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-4b.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/pr27491-4b.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/pr27491-4b.s?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -0,0 +1,2 @@\n+\t.section xx,\"aR\",unique,0\n+\t.byte 1"
    },
    {
      "sha": "ba065c0fe7f3a409a1a21ed9cce49625d0887d8a",
      "filename": "ld/testsuite/ld-x86-64/x86-64.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/x86-64.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/794f2bba0f338d467bbf9c55b5aba415ecd5e138/ld/testsuite/ld-x86-64/x86-64.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-x86-64/x86-64.exp?ref=794f2bba0f338d467bbf9c55b5aba415ecd5e138",
      "patch": "@@ -480,6 +480,12 @@ run_dump_test \"property-x86-isa3-x32\"\n run_dump_test \"property-x86-isa4\"\n run_dump_test \"property-x86-isa4-x32\"\n run_dump_test \"code16\"\n+run_dump_test \"pr27491-1a\"\n+run_dump_test \"pr27491-1b\"\n+run_dump_test \"pr27491-1c\"\n+run_dump_test \"pr27491-2\"\n+run_dump_test \"pr27491-3\"\n+run_dump_test \"pr27491-4\"\n \n if ![istarget \"x86_64-*-linux*\"] {\n     return"
    }
  ]
}