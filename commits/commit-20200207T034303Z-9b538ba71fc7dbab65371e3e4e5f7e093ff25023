{
  "sha": "9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6OWI1MzhiYTcxZmM3ZGJhYjY1MzcxZTNlNGU1ZjdlMDkzZmYyNTAyMw==",
  "commit": {
    "author": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-02-07T03:42:52Z"
    },
    "committer": {
      "name": "H.J. Lu",
      "email": "hjl.tools@gmail.com",
      "date": "2020-02-07T03:43:03Z"
    },
    "message": "ELF: Discard a section if any of its linked-to sections has been discarded\n\nAdd ldelf_before_place_orphans to call before lang_place_orphans to\ndiscard a section if any of its linked-to sections has been discarded.\n\n\tPR ld/25022\n\t* emultempl/aix.em (ld_${EMULATION_NAME}_emulation): Add\n\tbefore_place_orphans_default.\n\t* emultempl/armcoff.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/beos.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/generic.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/linux.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/msp430.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/pe.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/pep.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/ticoff.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/vanilla.em (ld_${EMULATION_NAME}_emulation): Likewise.\n\t* emultempl/elf.em (ld_${EMULATION_NAME}_emulation): Use\n\tldelf_before_place_orphans.\n\t* ldelf.c (ldelf_before_place_orphans): New.\n\t* ldelf.h (ldelf_before_place_orphans): Likewise.\n\t* ldemul.c (ldemul_before_place_orphans): Likewise.\n\t(before_place_orphans_default): Likewise.\n\t* ldemul.h (ldemul_before_place_orphans): Likewise.\n\t(before_place_orphans_default): Likewise.\n\t(ld_emulation_xfer_struct): Add before_place_orphans.\n\t* ldlang.c (lang_process): Call ldemul_before_place_orphans\n\tbefore lang_place_orphans.\n\t* testsuite/ld-elf/pr25022.d: New file.\n\t* testsuite/ld-elf/pr25022.s: Likewise.\n\t* testsuite/ld-elf/pr25022.t: Likewise.",
    "tree": {
      "sha": "da4c23f9a303106a0a01e1770034cfbeb112825d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/da4c23f9a303106a0a01e1770034cfbeb112825d"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/comments",
  "author": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "hjl-tools",
    "id": 1072356,
    "node_id": "MDQ6VXNlcjEwNzIzNTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hjl-tools",
    "html_url": "https://github.com/hjl-tools",
    "followers_url": "https://api.github.com/users/hjl-tools/followers",
    "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}",
    "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions",
    "organizations_url": "https://api.github.com/users/hjl-tools/orgs",
    "repos_url": "https://api.github.com/users/hjl-tools/repos",
    "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hjl-tools/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "5242a0a000ad7d3f2fa1cd0023f692d53261b302",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5242a0a000ad7d3f2fa1cd0023f692d53261b302",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/5242a0a000ad7d3f2fa1cd0023f692d53261b302"
    }
  ],
  "stats": {
    "total": 111,
    "additions": 111,
    "deletions": 0
  },
  "files": [
    {
      "sha": "221e2d3117f9173f811a4dd02d3304db9c69f269",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 29,
      "deletions": 0,
      "changes": 29,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -1,3 +1,32 @@\n+2020-02-06  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR ld/25022\n+\t* emultempl/aix.em (ld_${EMULATION_NAME}_emulation): Add\n+\tbefore_place_orphans_default.\n+\t* emultempl/armcoff.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/beos.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/generic.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/linux.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/msp430.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/pe.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/pep.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/ticoff.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/vanilla.em (ld_${EMULATION_NAME}_emulation): Likewise.\n+\t* emultempl/elf.em (ld_${EMULATION_NAME}_emulation): Use\n+\tldelf_before_place_orphans.\n+\t* ldelf.c (ldelf_before_place_orphans): New.\n+\t* ldelf.h (ldelf_before_place_orphans): Likewise.\n+\t* ldemul.c (ldemul_before_place_orphans): Likewise.\n+\t(before_place_orphans_default): Likewise.\n+\t* ldemul.h (ldemul_before_place_orphans): Likewise.\n+\t(before_place_orphans_default): Likewise.\n+\t(ld_emulation_xfer_struct): Add before_place_orphans.\n+\t* ldlang.c (lang_process): Call ldemul_before_place_orphans\n+\tbefore lang_place_orphans.\n+\t* testsuite/ld-elf/pr25022.d: New file.\n+\t* testsuite/ld-elf/pr25022.s: Likewise.\n+\t* testsuite/ld-elf/pr25022.t: Likewise.\n+\n 2020-02-06  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR ld/25490"
    },
    {
      "sha": "2da3870989906055bceeb7a44739b1c177c78931",
      "filename": "ld/emultempl/aix.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/aix.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/aix.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/aix.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -1541,6 +1541,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation = {\n   after_parse_default,\n   gld${EMULATION_NAME}_after_open,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   after_allocation_default,\n   gld${EMULATION_NAME}_set_output_arch,\n   gld${EMULATION_NAME}_choose_target,"
    },
    {
      "sha": "c539e2facca90f876dae7fb07b9b90d88fde8e8b",
      "filename": "ld/emultempl/armcoff.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/armcoff.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/armcoff.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/armcoff.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -263,6 +263,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   after_parse_default,\n   gld${EMULATION_NAME}_after_open,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   after_allocation_default,\n   set_output_arch_default,\n   ldemul_default_target,"
    },
    {
      "sha": "2c3e5e5370d039c8ff69e116dd7a134327625908",
      "filename": "ld/emultempl/beos.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/beos.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/beos.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/beos.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -763,6 +763,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   after_parse_default,\n   gld_${EMULATION_NAME}_after_open,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   after_allocation_default,\n   set_output_arch_default,\n   ldemul_default_target,"
    },
    {
      "sha": "bb7e5375303869c4150cd223cde51d6b622a808a",
      "filename": "ld/emultempl/elf.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/elf.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/elf.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/elf.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -880,6 +880,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   ${LDEMUL_AFTER_PARSE-ldelf_after_parse},\n   ${LDEMUL_AFTER_OPEN-gld${EMULATION_NAME}_after_open},\n   ${LDEMUL_AFTER_CHECK_RELOCS-after_check_relocs_default},\n+  ${LDEMUL_BEFORE_PLACE_ORPHANS-ldelf_before_place_orphans},\n   ${LDEMUL_AFTER_ALLOCATION-gld${EMULATION_NAME}_after_allocation},\n   ${LDEMUL_SET_OUTPUT_ARCH-set_output_arch_default},\n   ${LDEMUL_CHOOSE_TARGET-ldemul_default_target},"
    },
    {
      "sha": "a39c9332075852c61878e2e8f86c74897f169bf2",
      "filename": "ld/emultempl/generic.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/generic.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/generic.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/generic.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -138,6 +138,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   ${LDEMUL_AFTER_PARSE-after_parse_default},\n   ${LDEMUL_AFTER_OPEN-after_open_default},\n   ${LDEMUL_AFTER_CHECK_RELOCS-after_check_relocs_default},\n+  ${LDEMUL_BEFORE_PLACE_ORPHANS-before_place_orphans_default},\n   ${LDEMUL_AFTER_ALLOCATION-after_allocation_default},\n   ${LDEMUL_SET_OUTPUT_ARCH-set_output_arch_default},\n   ${LDEMUL_CHOOSE_TARGET-ldemul_default_target},"
    },
    {
      "sha": "f4ae6cfba2948d1edd9e08d12787f33806b4c627",
      "filename": "ld/emultempl/linux.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/linux.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/linux.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/linux.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -190,6 +190,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   after_parse_default,\n   after_open_default,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   after_allocation_default,\n   set_output_arch_default,\n   ldemul_default_target,"
    },
    {
      "sha": "861c1dcda0a1e5cbdd55e686c36a85cef66430dd",
      "filename": "ld/emultempl/msp430.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/msp430.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/msp430.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/msp430.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -825,6 +825,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   ${LDEMUL_AFTER_PARSE-after_parse_default},\n   msp430_elf_after_open,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   msp430_elf_after_allocation,\n   ${LDEMUL_SET_OUTPUT_ARCH-set_output_arch_default},\n   ${LDEMUL_CHOOSE_TARGET-ldemul_default_target},"
    },
    {
      "sha": "db23b221d66adc7ddc64b14aaa4881df9753482a",
      "filename": "ld/emultempl/pe.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/pe.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/pe.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/pe.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -2354,6 +2354,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   gld_${EMULATION_NAME}_after_parse,\n   gld_${EMULATION_NAME}_after_open,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   after_allocation_default,\n   set_output_arch_default,\n   ldemul_default_target,"
    },
    {
      "sha": "3d09a0a6b13244ad59d349ec912dee5ebcecde3b",
      "filename": "ld/emultempl/pep.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/pep.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/pep.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/pep.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -2153,6 +2153,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   gld_${EMULATION_NAME}_after_parse,\n   gld_${EMULATION_NAME}_after_open,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   after_allocation_default,\n   set_output_arch_default,\n   ldemul_default_target,"
    },
    {
      "sha": "60c0da9f1b16880efb93d74ebd322213a8684c8d",
      "filename": "ld/emultempl/ticoff.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/ticoff.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/ticoff.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/ticoff.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -163,6 +163,7 @@ struct ld_emulation_xfer_struct ld_${EMULATION_NAME}_emulation =\n   after_parse_default,\n   after_open_default,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   after_allocation_default,\n   set_output_arch_default,\n   ldemul_default_target,"
    },
    {
      "sha": "ae6f6e4175dcb1d788b4dd9346d3de5c0647a464",
      "filename": "ld/emultempl/vanilla.em",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/vanilla.em",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/emultempl/vanilla.em",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/emultempl/vanilla.em?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -64,6 +64,7 @@ struct ld_emulation_xfer_struct ld_vanilla_emulation =\n   after_parse_default,\n   after_open_default,\n   after_check_relocs_default,\n+  before_place_orphans_default,\n   after_allocation_default,\n   vanilla_set_output_arch,\n   ldemul_default_target,"
    },
    {
      "sha": "3ac3bb4e0a5093c2f6e860fccdaf86a9f2b69464",
      "filename": "ld/ldelf.c",
      "status": "modified",
      "additions": 29,
      "deletions": 0,
      "changes": 29,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldelf.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldelf.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldelf.c?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -2134,3 +2134,32 @@ ldelf_place_orphan (asection *s, const char *secname, int constraint)\n \n   return lang_insert_orphan (s, secname, constraint, after, place, NULL, NULL);\n }\n+\n+void\n+ldelf_before_place_orphans (void)\n+{\n+  bfd *abfd;\n+\n+  for (abfd = link_info.input_bfds;\n+       abfd != (bfd *) NULL; abfd = abfd->link.next)\n+    if (bfd_get_flavour (abfd) == bfd_target_elf_flavour\n+\t&& bfd_count_sections (abfd) != 0\n+\t&& !bfd_input_just_syms (abfd))\n+      {\n+\tasection *isec;\n+\tfor (isec = abfd->sections; isec != NULL; isec = isec->next)\n+\t  {\n+\t    /* Discard a section if any of its linked-to section has\n+\t       been discarded.  */\n+\t    asection *linked_to_sec;\n+\t    for (linked_to_sec = elf_linked_to_section (isec);\n+\t\t linked_to_sec != NULL;\n+\t\t linked_to_sec = elf_linked_to_section (linked_to_sec))\n+\t      if (discarded_section (linked_to_sec))\n+\t\t{\n+\t\t  isec->output_section = bfd_abs_section_ptr;\n+\t\t  break;\n+\t\t}\n+\t  }\n+      }\n+}"
    },
    {
      "sha": "2a58a0c1359a9c936e4d0ffa75855338505c6c2c",
      "filename": "ld/ldelf.h",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldelf.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldelf.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldelf.h?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -30,3 +30,4 @@ extern bfd_boolean ldelf_open_dynamic_archive\n   (const char *, search_dirs_type *, lang_input_statement_type *);\n extern lang_output_section_statement_type *ldelf_place_orphan\n   (asection *, const char *, int);\n+extern void ldelf_before_place_orphans (void);"
    },
    {
      "sha": "fa6dfdd18edfb199d4807d2766d02135272881b2",
      "filename": "ld/ldemul.c",
      "status": "modified",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldemul.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldemul.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldemul.c?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -71,6 +71,12 @@ ldemul_after_check_relocs (void)\n   ld_emulation->after_check_relocs ();\n }\n \n+void\n+ldemul_before_place_orphans (void)\n+{\n+  ld_emulation->before_place_orphans ();\n+}\n+\n void\n ldemul_after_allocation (void)\n {\n@@ -266,6 +272,11 @@ after_check_relocs_default (void)\n {\n }\n \n+void\n+before_place_orphans_default (void)\n+{\n+}\n+\n void\n after_allocation_default (void)\n {"
    },
    {
      "sha": "44e3a92aa7ef26436d71aa3dc6145ab8469e9d54",
      "filename": "ld/ldemul.h",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldemul.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldemul.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldemul.h?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -36,6 +36,8 @@ extern void ldemul_after_open\n   (void);\n extern void ldemul_after_check_relocs\n   (void);\n+extern void ldemul_before_place_orphans\n+  (void);\n extern void ldemul_after_allocation\n   (void);\n extern void ldemul_before_allocation\n@@ -80,6 +82,8 @@ extern void after_open_default\n   (void);\n extern void after_check_relocs_default\n   (void);\n+extern void before_place_orphans_default\n+  (void);\n extern void after_allocation_default\n   (void);\n extern void before_allocation_default\n@@ -129,6 +133,9 @@ typedef struct ld_emulation_xfer_struct {\n   /* Run after checking relocations.  */\n   void   (*after_check_relocs)  (void);\n \n+  /* Run before placing orphans.  */\n+  void   (*before_place_orphans)  (void);\n+\n   /* Run after allocating output sections.  */\n   void   (*after_allocation)  (void);\n "
    },
    {
      "sha": "528ed22c1bc0902c972e8145ef8d6f070dfd8208",
      "filename": "ld/ldlang.c",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldlang.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/ldlang.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldlang.c?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -7837,6 +7837,8 @@ lang_process (void)\n      output statement, so that it isn't reordered.  */\n   process_insert_statements (&lang_os_list.head->header.next);\n \n+  ldemul_before_place_orphans ();\n+\n   /* Find any sections not attached explicitly and handle them.  */\n   lang_place_orphans ();\n "
    },
    {
      "sha": "9a397523a317013d8eff3d9115c398e2a7233a70",
      "filename": "ld/testsuite/ld-elf/pr25022.d",
      "status": "added",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/testsuite/ld-elf/pr25022.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/testsuite/ld-elf/pr25022.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/pr25022.d?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -0,0 +1,9 @@\n+#ld: -T pr25022.t\n+#readelf: -SW\n+#xfail: msp*-*\n+# msp* doesn't use ldelf_before_place_orphans.\n+\n+#failif\n+#...\n+ +\\[ *[0-9]+\\] \\.(bar|moo|zed) +.*\n+#..."
    },
    {
      "sha": "ace4f25f2bc8e54ae0b3a0e41a442ed2d1e3f39e",
      "filename": "ld/testsuite/ld-elf/pr25022.s",
      "status": "added",
      "additions": 11,
      "deletions": 0,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/testsuite/ld-elf/pr25022.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/testsuite/ld-elf/pr25022.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/pr25022.s?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -0,0 +1,11 @@\n+\t.section .foo,\"a\"\n+\t.dc.a 0\n+\n+\t.section .moo,\"ao\",%progbits,.zed\n+\t.dc.a 0\n+\n+\t.section .bar,\"ao\",%progbits,.foo\n+\t.dc.a 0\n+\n+\t.section .zed,\"ao\",%progbits,.foo\n+\t.dc.a 0"
    },
    {
      "sha": "bb9aa81e0f307cddf23e586e177dcabf193cde00",
      "filename": "ld/testsuite/ld-elf/pr25022.t",
      "status": "added",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/testsuite/ld-elf/pr25022.t",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/9b538ba71fc7dbab65371e3e4e5f7e093ff25023/ld/testsuite/ld-elf/pr25022.t",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/pr25022.t?ref=9b538ba71fc7dbab65371e3e4e5f7e093ff25023",
      "patch": "@@ -0,0 +1 @@\n+SECTIONS { /DISCARD/ : { *(.foo) } }"
    }
  ]
}