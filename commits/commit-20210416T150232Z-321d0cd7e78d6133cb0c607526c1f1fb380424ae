{
  "sha": "321d0cd7e78d6133cb0c607526c1f1fb380424ae",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MzIxZDBjZDdlNzhkNjEzM2NiMGM2MDc1MjZjMWYxZmIzODA0MjRhZQ==",
  "commit": {
    "author": {
      "name": "Simon Marchi",
      "email": "simon.marchi@efficios.com",
      "date": "2021-04-16T15:01:26Z"
    },
    "committer": {
      "name": "Simon Marchi",
      "email": "simon.marchi@polymtl.ca",
      "date": "2021-04-16T15:02:32Z"
    },
    "message": "gdb/testsuite: use -gdwarf-4 in simavr board\n\nBy default, when using the -g switch, avr-gcc generates stabs debug\ninformation.  I think it would make more sense to test GDB against DWARF\ninformation, because stabs is obsolete by now, and nobody work on it.\nSo change the simavr board to pass -gdwarf-4 as the debug flag.\n\nThe downside is that users are probably more likely to use just -g, so\nwe don't test GDB the same way as users are likely to use it.  But in\nthis case, if somebody comes and asks for help with GDB for AVR, I\nsuggest we encourage them to use -gdwarf-4.\n\nI can't give stats about how that changes test results, because the\ntestsuite is too broken.  There is an internal error that happens quite\nfrequently that needs to be investigated:\n\n    /home/simark/src/wt/avr/gdb/trad-frame.h:143: internal-error: LONGEST trad_frame_saved_reg::addr() const: Assertion `m_kind == trad_frame_saved_reg_kind::ADDR' failed.\n\nI sent a question on the gcc mailing list, asking why stabs is the\ndefault:\n\n    https://gcc.gnu.org/pipermail/gcc/2021-April/235309.html\n\ngdb/testsuite/ChangeLog:\n\n\t* boards/simavr.exp: Set debug_flags.\n\nChange-Id: I70e471fad3a79ab1d79d13dda8436bb9eb666e0a",
    "tree": {
      "sha": "5ee1d34a99527d8ef8c32243cc76477cee349285",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/5ee1d34a99527d8ef8c32243cc76477cee349285"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/321d0cd7e78d6133cb0c607526c1f1fb380424ae",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/321d0cd7e78d6133cb0c607526c1f1fb380424ae",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/321d0cd7e78d6133cb0c607526c1f1fb380424ae",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/321d0cd7e78d6133cb0c607526c1f1fb380424ae/comments",
  "author": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "simark",
    "id": 1758287,
    "node_id": "MDQ6VXNlcjE3NTgyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simark",
    "html_url": "https://github.com/simark",
    "followers_url": "https://api.github.com/users/simark/followers",
    "following_url": "https://api.github.com/users/simark/following{/other_user}",
    "gists_url": "https://api.github.com/users/simark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simark/subscriptions",
    "organizations_url": "https://api.github.com/users/simark/orgs",
    "repos_url": "https://api.github.com/users/simark/repos",
    "events_url": "https://api.github.com/users/simark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simark/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "100e914da3da936fa057edf85f16f407cf3d682b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/100e914da3da936fa057edf85f16f407cf3d682b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/100e914da3da936fa057edf85f16f407cf3d682b"
    }
  ],
  "stats": {
    "total": 8,
    "additions": 8,
    "deletions": 0
  },
  "files": [
    {
      "sha": "212f2ae0c5bec67d29049aa27f926c6158fa53b5",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/321d0cd7e78d6133cb0c607526c1f1fb380424ae/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/321d0cd7e78d6133cb0c607526c1f1fb380424ae/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=321d0cd7e78d6133cb0c607526c1f1fb380424ae",
      "patch": "@@ -1,3 +1,7 @@\n+2021-04-16  Simon Marchi  <simon.marchi@efficios.com>\n+\n+\t* boards/simavr.exp: Set debug_flags.\n+\n 2021-04-16  Luis Machado  <luis.machado@linaro.org>\n \n \t* gdb.dwarf2/dw2-bfloat16.exp: New file."
    },
    {
      "sha": "06177330aa04df6cce8dabad24ca97663ac6d039",
      "filename": "gdb/testsuite/boards/simavr.exp",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/321d0cd7e78d6133cb0c607526c1f1fb380424ae/gdb/testsuite/boards/simavr.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/321d0cd7e78d6133cb0c607526c1f1fb380424ae/gdb/testsuite/boards/simavr.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/boards/simavr.exp?ref=321d0cd7e78d6133cb0c607526c1f1fb380424ae",
      "patch": "@@ -44,6 +44,10 @@ set_board_info c++compiler avr-g++\n set_board_info cflags \"-mmcu=${simavr_mcu}\"\n set_board_info ldflags \"-mmcu=${simavr_mcu}\"\n \n+# As of version 10, GCC produces stabs by default for AVR.  Force it to use\n+# DWARF.\n+set_board_info debug_flags \"-gdwarf-4\"\n+\n set_board_info use_gdb_stub 1\n set_board_info gdb_protocol \"remote\"\n set_board_info gdb,do_reload_on_run 1"
    }
  ]
}