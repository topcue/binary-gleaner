{
  "sha": "c5e20471be97e2dcd3498ac284487e2546715f66",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YzVlMjA0NzFiZTk3ZTJkY2QzNDk4YWMyODQ0ODdlMjU0NjcxNWY2Ng==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-07-24T00:41:08Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-07-24T06:42:01Z"
    },
    "message": "Re: ELF final_write_processing\n\nI missed some early exits from final_write_processing that mean\n_bfd_elf_final_write_processing could be missed.\n\n\t* elf-vxworks.c (elf_vxworks_final_write_processing): Don't return\n\tearly.\n\t* elf32-arc.c (arc_elf_final_write_processing): Likewise.\n\t* elf32-xtensa.c (elf_xtensa_final_write_processing): Likewise.",
    "tree": {
      "sha": "891ed12d3c1be17fc82f02ef4d1e44e6fbee88ca",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/891ed12d3c1be17fc82f02ef4d1e44e6fbee88ca"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/c5e20471be97e2dcd3498ac284487e2546715f66",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c5e20471be97e2dcd3498ac284487e2546715f66",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/c5e20471be97e2dcd3498ac284487e2546715f66",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c5e20471be97e2dcd3498ac284487e2546715f66/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "7613ca5e3885b8e79d9096a53f3e5492a5c06cd7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7613ca5e3885b8e79d9096a53f3e5492a5c06cd7",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/7613ca5e3885b8e79d9096a53f3e5492a5c06cd7"
    }
  ],
  "stats": {
    "total": 40,
    "additions": 20,
    "deletions": 20
  },
  "files": [
    {
      "sha": "1fe3860d9fa77d6fe9099ef48df3e50fa8d613a8",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c5e20471be97e2dcd3498ac284487e2546715f66/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c5e20471be97e2dcd3498ac284487e2546715f66/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=c5e20471be97e2dcd3498ac284487e2546715f66",
      "patch": "@@ -1,3 +1,10 @@\n+2019-07-24  Alan Modra  <amodra@gmail.com>\n+\n+\t* elf-vxworks.c (elf_vxworks_final_write_processing): Don't return\n+\tearly.\n+\t* elf32-arc.c (arc_elf_final_write_processing): Likewise.\n+\t* elf32-xtensa.c (elf_xtensa_final_write_processing): Likewise.\n+\n 2019-07-24  Alan Modra  <amodra@gmail.com>\n \n \t* elf32-visium.c (visium_elf_post_process_headers): Don't set"
    },
    {
      "sha": "4447b36511046b96e88b4abb0e2c40a20e4e3f4a",
      "filename": "bfd/elf-vxworks.c",
      "status": "modified",
      "additions": 7,
      "deletions": 6,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c5e20471be97e2dcd3498ac284487e2546715f66/bfd/elf-vxworks.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c5e20471be97e2dcd3498ac284487e2546715f66/bfd/elf-vxworks.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf-vxworks.c?ref=c5e20471be97e2dcd3498ac284487e2546715f66",
      "patch": "@@ -221,13 +221,14 @@ elf_vxworks_final_write_processing (bfd *abfd, bfd_boolean linker)\n   sec = bfd_get_section_by_name (abfd, \".rel.plt.unloaded\");\n   if (!sec)\n     sec = bfd_get_section_by_name (abfd, \".rela.plt.unloaded\");\n-  if (!sec)\n-    return;\n-  d = elf_section_data (sec);\n-  d->this_hdr.sh_link = elf_onesymtab (abfd);\n-  sec = bfd_get_section_by_name (abfd, \".plt\");\n   if (sec)\n-    d->this_hdr.sh_info = elf_section_data (sec)->this_idx;\n+    {\n+      d = elf_section_data (sec);\n+      d->this_hdr.sh_link = elf_onesymtab (abfd);\n+      sec = bfd_get_section_by_name (abfd, \".plt\");\n+      if (sec)\n+\td->this_hdr.sh_info = elf_section_data (sec)->this_idx;\n+    }\n   _bfd_elf_final_write_processing (abfd, linker);\n }\n "
    },
    {
      "sha": "fc4c3ae50a526962ab9cf53723c5778426218902",
      "filename": "bfd/elf32-arc.c",
      "status": "modified",
      "additions": 3,
      "deletions": 11,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c5e20471be97e2dcd3498ac284487e2546715f66/bfd/elf32-arc.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c5e20471be97e2dcd3498ac284487e2546715f66/bfd/elf32-arc.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf32-arc.c?ref=c5e20471be97e2dcd3498ac284487e2546715f66",
      "patch": "@@ -1026,20 +1026,12 @@ arc_elf_final_write_processing (bfd *abfd, bfd_boolean linker)\n \n   switch (bfd_get_mach (abfd))\n     {\n-    case bfd_mach_arc_arc600:\n-      emf = EM_ARC_COMPACT;\n-      break;\n-    case bfd_mach_arc_arc601:\n-      emf = EM_ARC_COMPACT;\n-      break;\n-    case bfd_mach_arc_arc700:\n-      emf = EM_ARC_COMPACT;\n-      break;\n     case bfd_mach_arc_arcv2:\n       emf = EM_ARC_COMPACT2;\n       break;\n     default:\n-      return;\n+      emf = EM_ARC_COMPACT;\n+      break;\n     }\n \n   elf_elfheader (abfd)->e_machine = emf;\n@@ -1050,7 +1042,7 @@ arc_elf_final_write_processing (bfd *abfd, bfd_boolean linker)\n   else\n     e_flags |= E_ARC_OSABI_V3;\n \n-  elf_elfheader (abfd)->e_flags |=  e_flags;\n+  elf_elfheader (abfd)->e_flags |= e_flags;\n   _bfd_elf_final_write_processing (abfd, linker);\n }\n "
    },
    {
      "sha": "40edb467e5ed335c358412b5e5ef0c6ab8b587db",
      "filename": "bfd/elf32-xtensa.c",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/c5e20471be97e2dcd3498ac284487e2546715f66/bfd/elf32-xtensa.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/c5e20471be97e2dcd3498ac284487e2546715f66/bfd/elf32-xtensa.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/elf32-xtensa.c?ref=c5e20471be97e2dcd3498ac284487e2546715f66",
      "patch": "@@ -3466,18 +3466,18 @@ static void\n elf_xtensa_final_write_processing (bfd *abfd, bfd_boolean linker)\n {\n   int mach;\n-  unsigned long val;\n+  unsigned long val = elf_elfheader (abfd)->e_flags & EF_XTENSA_MACH;\n \n   switch (mach = bfd_get_mach (abfd))\n     {\n     case bfd_mach_xtensa:\n       val = E_XTENSA_MACH;\n       break;\n     default:\n-      return;\n+      break;\n     }\n \n-  elf_elfheader (abfd)->e_flags &=  (~ EF_XTENSA_MACH);\n+  elf_elfheader (abfd)->e_flags &= ~EF_XTENSA_MACH;\n   elf_elfheader (abfd)->e_flags |= val;\n   _bfd_elf_final_write_processing (abfd, linker);\n }"
    }
  ]
}