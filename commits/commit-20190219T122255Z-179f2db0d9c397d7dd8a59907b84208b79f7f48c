{
  "sha": "179f2db0d9c397d7dd8a59907b84208b79f7f48c",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MTc5ZjJkYjBkOWMzOTdkN2RkOGE1OTkwN2I4NDIwOGI3OWY3ZjQ4Yw==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-02-19T12:18:44Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2019-02-19T12:22:55Z"
    },
    "message": "PR24235, Read memory violation in pei-x86_64.c\n\n\tPR 24235\n\t* pei-x86_64.c (pex64_bfd_print_pdata_section): Correct checks\n\tattempting to prevent read past end of section.",
    "tree": {
      "sha": "d5d6f959e97707dff173090be6f4d1ba43c9fbfe",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/d5d6f959e97707dff173090be6f4d1ba43c9fbfe"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/179f2db0d9c397d7dd8a59907b84208b79f7f48c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/179f2db0d9c397d7dd8a59907b84208b79f7f48c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/179f2db0d9c397d7dd8a59907b84208b79f7f48c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/179f2db0d9c397d7dd8a59907b84208b79f7f48c/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "c72e75a64030b0f6535a80481f37968ad55c333a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/c72e75a64030b0f6535a80481f37968ad55c333a",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/c72e75a64030b0f6535a80481f37968ad55c333a"
    }
  ],
  "stats": {
    "total": 15,
    "additions": 10,
    "deletions": 5
  },
  "files": [
    {
      "sha": "72c87c78a29a4d5fb4dc4ee6f78e1c3b1b0c6f42",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/179f2db0d9c397d7dd8a59907b84208b79f7f48c/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/179f2db0d9c397d7dd8a59907b84208b79f7f48c/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=179f2db0d9c397d7dd8a59907b84208b79f7f48c",
      "patch": "@@ -1,3 +1,9 @@\n+2019-02-19  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 24235\n+\t* pei-x86_64.c (pex64_bfd_print_pdata_section): Correct checks\n+\tattempting to prevent read past end of section.\n+\n 2019-02-18  Alan Modra  <amodra@gmail.com>\n \n \tPR 24225"
    },
    {
      "sha": "7e751049f73dec8eb5f76343683c0fe4db865cfb",
      "filename": "bfd/pei-x86_64.c",
      "status": "modified",
      "additions": 4,
      "deletions": 5,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/179f2db0d9c397d7dd8a59907b84208b79f7f48c/bfd/pei-x86_64.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/179f2db0d9c397d7dd8a59907b84208b79f7f48c/bfd/pei-x86_64.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/pei-x86_64.c?ref=179f2db0d9c397d7dd8a59907b84208b79f7f48c",
      "patch": "@@ -541,7 +541,7 @@ pex64_bfd_print_pdata_section (bfd *abfd, void *vfile, asection *pdata_section)\n   /* virt_size might be zero for objects.  */\n   if (stop == 0 && strcmp (abfd->xvec->name, \"pe-x86-64\") == 0)\n     {\n-      stop = (datasize / onaline) * onaline;\n+      stop = datasize;\n       virt_size_is_zero = TRUE;\n     }\n   else if (datasize < stop)\n@@ -551,8 +551,8 @@ pex64_bfd_print_pdata_section (bfd *abfd, void *vfile, asection *pdata_section)\n \t\t _(\"Warning: %s section size (%ld) is smaller than virtual size (%ld)\\n\"),\n \t\t pdata_section->name, (unsigned long) datasize,\n \t\t (unsigned long) stop);\n-\t/* Be sure not to read passed datasize.  */\n-\tstop = datasize / onaline;\n+\t/* Be sure not to read past datasize.  */\n+\tstop = datasize;\n       }\n \n   /* Display functions table.  */\n@@ -724,8 +724,7 @@ pex64_bfd_print_pdata_section (bfd *abfd, void *vfile, asection *pdata_section)\n \t      altent += imagebase;\n \n \t      if (altent >= pdata_vma\n-\t\t  && (altent + PDATA_ROW_SIZE <= pdata_vma\n-\t\t      + pei_section_data (abfd, pdata_section)->virt_size))\n+\t\t  && altent - pdata_vma + PDATA_ROW_SIZE <= stop)\n \t\t{\n \t\t  pex64_get_runtime_function\n \t\t    (abfd, &arf, &pdata[altent - pdata_vma]);"
    }
  ]
}