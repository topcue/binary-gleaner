{
  "sha": "ae61ef2c5615a06f829468b57249a17762a44220",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YWU2MWVmMmM1NjE1YTA2ZjgyOTQ2OGI1NzI0OWExNzc2MmE0NDIyMA==",
  "commit": {
    "author": {
      "name": "Shahab Vahedi",
      "email": "shahab@synopsys.com",
      "date": "2021-05-05T21:07:38Z"
    },
    "committer": {
      "name": "Shahab Vahedi",
      "email": "shahab@synopsys.com",
      "date": "2021-06-05T09:43:07Z"
    },
    "message": "arc: Add 'set disassembler-options' support\n\nImplement ARC target support for passing options to the disassembler\nthrough the command interface. e.g.:\n\ngdb> set disassembler-options cpu=hs38_linux ...\n\ngdb/ChangeLog:\n\n\t* NEWS: Document 'set disassembler-options' support for the ARC\n\ttarget.\n\t* arc-tdep.c (arc_gdbarch_init): Set\n\t'gdbarch_valid_disassembler_options'.\n\ngdb/doc/ChangeLog:\n\n\t* gdb.texinfo (Source and Machine Code): Document 'set\n\tdisassembler-options' support for the ARC target.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.arch/arc-disassembler-options.exp: New test.\n\t* gdb.arch/arc-disassembler-options.s: New test source.",
    "tree": {
      "sha": "6fc2e0e1ed9f3938530d4107760861352577e29b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6fc2e0e1ed9f3938530d4107760861352577e29b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ae61ef2c5615a06f829468b57249a17762a44220",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ae61ef2c5615a06f829468b57249a17762a44220",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ae61ef2c5615a06f829468b57249a17762a44220",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ae61ef2c5615a06f829468b57249a17762a44220/comments",
  "author": null,
  "committer": null,
  "parents": [
    {
      "sha": "30569fbb57f1e4fe1ffed6b94882d967f27cbb66",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/30569fbb57f1e4fe1ffed6b94882d967f27cbb66",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/30569fbb57f1e4fe1ffed6b94882d967f27cbb66"
    }
  ],
  "stats": {
    "total": 96,
    "additions": 92,
    "deletions": 4
  },
  "files": [
    {
      "sha": "9fc2310d144e4c4d4b907231f2eca03e068f88ee",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ae61ef2c5615a06f829468b57249a17762a44220/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ae61ef2c5615a06f829468b57249a17762a44220/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=ae61ef2c5615a06f829468b57249a17762a44220",
      "patch": "@@ -1,3 +1,10 @@\n+2021-06-05  Shahab Vahedi  <shahab@synopsys.com>\n+\n+\t* NEWS: Document 'set disassembler-options' support for the ARC\n+\ttarget.\n+\t* arc-tdep.c (arc_gdbarch_init): Set\n+\t'gdbarch_valid_disassembler_options'.\n+\n 2021-06-04  Tom Tromey  <tromey@adacore.com>\n \n \t* dwarf2/read.h (dwarf2_fetch_die_type_sect_off): Add 'var_name'"
    },
    {
      "sha": "56743fc9aeaadecc269e39b6346b51bd9b49dcf0",
      "filename": "gdb/NEWS",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ae61ef2c5615a06f829468b57249a17762a44220/gdb/NEWS",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ae61ef2c5615a06f829468b57249a17762a44220/gdb/NEWS",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/NEWS?ref=ae61ef2c5615a06f829468b57249a17762a44220",
      "patch": "@@ -3,6 +3,9 @@\n \n *** Changes since GDB 10\n \n+* The 'set disassembler-options' command now supports specifying options\n+  for the ARC target.\n+\n * GDB now supports general memory tagging functionality if the underlying\n   architecture supports the proper primitives and hooks.  Currently this is\n   enabled only for AArch64 MTE."
    },
    {
      "sha": "3afbf4264fe8122646fafddbf123619eb62a4c51",
      "filename": "gdb/arc-tdep.c",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ae61ef2c5615a06f829468b57249a17762a44220/gdb/arc-tdep.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ae61ef2c5615a06f829468b57249a17762a44220/gdb/arc-tdep.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/arc-tdep.c?ref=ae61ef2c5615a06f829468b57249a17762a44220",
      "patch": "@@ -2434,11 +2434,13 @@ arc_gdbarch_init (struct gdbarch_info info, struct gdbarch_list *arches)\n \t      arc_disassembler_options = NULL;\n \t      break;\n \t    }\n-\t  set_gdbarch_disassembler_options (gdbarch,\n-\t\t\t\t\t    &arc_disassembler_options);\n \t}\n     }\n \n+  set_gdbarch_disassembler_options (gdbarch, &arc_disassembler_options);\n+  set_gdbarch_valid_disassembler_options (gdbarch,\n+\t\t\t\t\t  disassembler_options_arc ());\n+\n   tdesc_use_registers (gdbarch, tdesc, std::move (tdesc_data));\n \n   return gdbarch;"
    },
    {
      "sha": "61d40b92e639f044f8edbe291871ad40f30ace80",
      "filename": "gdb/doc/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ae61ef2c5615a06f829468b57249a17762a44220/gdb/doc/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ae61ef2c5615a06f829468b57249a17762a44220/gdb/doc/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/doc/ChangeLog?ref=ae61ef2c5615a06f829468b57249a17762a44220",
      "patch": "@@ -1,3 +1,8 @@\n+2021-06-05  Shahab Vahedi  <shahab@synopsys.com>\n+\n+\t* gdb.texinfo (Source and Machine Code): Document 'set\n+\tdisassembler-options' support for the ARC target.\n+\n 2021-06-04  Hannes Domani  <ssbssa@yahoo.de>\n \n \t* python.texi (TUI Windows In Python): Document Window.click."
    },
    {
      "sha": "d09b86cda9599dbbea03e64496d9546caa9e8638",
      "filename": "gdb/doc/gdb.texinfo",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ae61ef2c5615a06f829468b57249a17762a44220/gdb/doc/gdb.texinfo",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ae61ef2c5615a06f829468b57249a17762a44220/gdb/doc/gdb.texinfo",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/doc/gdb.texinfo?ref=ae61ef2c5615a06f829468b57249a17762a44220",
      "patch": "@@ -9879,8 +9879,8 @@ The default value is the empty string.\n \n If it is necessary to specify more than one disassembler option, then\n multiple options can be placed together into a comma separated list.\n-Currently this command is only supported on targets ARM, MIPS, PowerPC\n-and S/390.\n+Currently this command is only supported on targets ARC, ARM, MIPS,\n+PowerPC and S/390.\n \n @kindex show disassembler-options\n @item show disassembler-options"
    },
    {
      "sha": "d78bf06d62ce33211ecac1ba2d4af37a0453bc04",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ae61ef2c5615a06f829468b57249a17762a44220/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ae61ef2c5615a06f829468b57249a17762a44220/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=ae61ef2c5615a06f829468b57249a17762a44220",
      "patch": "@@ -1,3 +1,8 @@\n+2021-06-05  Shahab Vahedi  <shahab@synopsys.com>\n+\n+\t* gdb.arch/arc-disassembler-options.exp: New test.\n+\t* gdb.arch/arc-disassembler-options.s: New test source.\n+\n 2021-06-04  Tom Tromey  <tromey@adacore.com>\n \n \t* gdb.ada/array_of_symbolic_length.exp: New file."
    },
    {
      "sha": "6bfe06b3d9d70b6240fb0c4638759bedfeed39d2",
      "filename": "gdb/testsuite/gdb.arch/arc-disassembler-options.exp",
      "status": "added",
      "additions": 45,
      "deletions": 0,
      "changes": 45,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ae61ef2c5615a06f829468b57249a17762a44220/gdb/testsuite/gdb.arch/arc-disassembler-options.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ae61ef2c5615a06f829468b57249a17762a44220/gdb/testsuite/gdb.arch/arc-disassembler-options.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.arch/arc-disassembler-options.exp?ref=ae61ef2c5615a06f829468b57249a17762a44220",
      "patch": "@@ -0,0 +1,45 @@\n+# Copyright 2021 Free Software Foundation, Inc.\n+\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+# Test ARC disassembler options.\n+\n+if { ![istarget \"arc-*-*\"] } then {\n+    verbose \"Skipping ARC disassembler option test.\"\n+    return\n+}\n+\n+standard_testfile .s\n+set objfile [standard_output_file ${testfile}.o]\n+\n+if { [gdb_compile \"${srcdir}/${subdir}/${srcfile}\" \"${objfile}\" object {}] \\\n+     != \"\" } {\n+    return\n+}\n+\n+clean_restart ${objfile}\n+\n+proc arc_disassemble_test { func insn mesg } {\n+    gdb_test \"disassemble $func\" \\\n+\t\"Dump of assembler code for function $func:\\r\\n\\\n+\t\\[^:\\]+:\\t$insn\\r\\nEnd of assembler dump\\.\" \\\n+\t$mesg\n+}\n+\n+# Verify defaults.\n+arc_disassemble_test foo \"lr\\tr0,\\\\\\[tlbpd0\\\\\\]\" \"disassemble default\"\n+\n+# Verify option overrides.\n+gdb_test \"set disassembler-options cpu=arcem\"\n+arc_disassemble_test foo \"lr\\tr0,\\\\\\[1120\\\\\\]\" \"disassemble cpu=arcem\""
    },
    {
      "sha": "9f64ce43a43163894c6f9fd77f4331cef027ebd3",
      "filename": "gdb/testsuite/gdb.arch/arc-disassembler-options.s",
      "status": "added",
      "additions": 21,
      "deletions": 0,
      "changes": 21,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ae61ef2c5615a06f829468b57249a17762a44220/gdb/testsuite/gdb.arch/arc-disassembler-options.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ae61ef2c5615a06f829468b57249a17762a44220/gdb/testsuite/gdb.arch/arc-disassembler-options.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.arch/arc-disassembler-options.s?ref=ae61ef2c5615a06f829468b57249a17762a44220",
      "patch": "@@ -0,0 +1,21 @@\n+#  This test is part of GDB, the GNU debugger.\n+#\n+#  Copyright 2021 Free Software Foundation, Inc.\n+#\n+#  This program is free software; you can redistribute it and/or modify\n+#  it under the terms of the GNU General Public License as published by\n+#  the Free Software Foundation; either version 3 of the License, or\n+#  (at your option) any later version.\n+#\n+#  This program is distributed in the hope that it will be useful,\n+#  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+#  GNU General Public License for more details.\n+#\n+#  You should have received a copy of the GNU General Public License\n+#  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+\n+.globl\tfoo\n+foo:\n+\tlr\tr0, [tlbpd0]\n+.end\tfoo"
    }
  ]
}