{
  "sha": "e264b5b7a57dab997776ae845f9e0b3e5f20c713",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZTI2NGI1YjdhNTdkYWI5OTc3NzZhZTg0NWY5ZTBiM2U1ZjIwYzcxMw==",
  "commit": {
    "author": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-11-07T11:56:54Z"
    },
    "committer": {
      "name": "Nick Clifton",
      "email": "nickc@redhat.com",
      "date": "2019-11-07T11:56:54Z"
    },
    "message": "Allow the --output option of the \"ar\" prorgam to extract files to locations outside of the current directory.\n\n\t* ar.c (open_output_file): Check for filename validity before\n\tprefixing with output directory.\n\tDisplay the constructed output filename if in verbose mode.\n\t(extract_file): Let open_output_file display the filename.",
    "tree": {
      "sha": "a80b6f31b2da2ab6debef8f6ff1c2bb66aa5aa8f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/a80b6f31b2da2ab6debef8f6ff1c2bb66aa5aa8f"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/e264b5b7a57dab997776ae845f9e0b3e5f20c713",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e264b5b7a57dab997776ae845f9e0b3e5f20c713",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/e264b5b7a57dab997776ae845f9e0b3e5f20c713",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e264b5b7a57dab997776ae845f9e0b3e5f20c713/comments",
  "author": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "nickclifton",
    "id": 31441682,
    "node_id": "MDQ6VXNlcjMxNDQxNjgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/31441682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nickclifton",
    "html_url": "https://github.com/nickclifton",
    "followers_url": "https://api.github.com/users/nickclifton/followers",
    "following_url": "https://api.github.com/users/nickclifton/following{/other_user}",
    "gists_url": "https://api.github.com/users/nickclifton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nickclifton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nickclifton/subscriptions",
    "organizations_url": "https://api.github.com/users/nickclifton/orgs",
    "repos_url": "https://api.github.com/users/nickclifton/repos",
    "events_url": "https://api.github.com/users/nickclifton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nickclifton/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ef07b8082ea5f9c48d0c6bcf0e4c1855ddf2c49b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ef07b8082ea5f9c48d0c6bcf0e4c1855ddf2c49b",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/ef07b8082ea5f9c48d0c6bcf0e4c1855ddf2c49b"
    }
  ],
  "stats": {
    "total": 45,
    "additions": 25,
    "deletions": 20
  },
  "files": [
    {
      "sha": "06823b27ab2a210a6f6186d21e156e39e385c80c",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e264b5b7a57dab997776ae845f9e0b3e5f20c713/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e264b5b7a57dab997776ae845f9e0b3e5f20c713/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=e264b5b7a57dab997776ae845f9e0b3e5f20c713",
      "patch": "@@ -1,3 +1,10 @@\n+2019-11-07  Nick Clifton  <nickc@redhat.com>\n+\n+\t* ar.c (open_output_file): Check for filename validity before\n+\tprefixing with output directory.\n+\tDisplay the constructed output filename if in verbose mode.\n+\t(extract_file): Let open_output_file display the filename.\n+\n 2019-11-07  Nick Clifton  <nickc@redhat.com>\n \n \t* objcopy.c (copy_object): Skip note sections that do not have"
    },
    {
      "sha": "b8342ce65a1b530cff68e3287e706ba13988b593",
      "filename": "binutils/ar.c",
      "status": "modified",
      "additions": 15,
      "deletions": 14,
      "changes": 29,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e264b5b7a57dab997776ae845f9e0b3e5f20c713/binutils/ar.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e264b5b7a57dab997776ae845f9e0b3e5f20c713/binutils/ar.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ar.c?ref=e264b5b7a57dab997776ae845f9e0b3e5f20c713",
      "patch": "@@ -1070,6 +1070,18 @@ open_output_file (bfd * abfd)\n {\n   output_filename = bfd_get_filename (abfd);\n \n+  /* PR binutils/17533: Do not allow directory traversal\n+     outside of the current directory tree - unless the\n+     user has explicitly specified an output directory.  */\n+  if (! is_valid_archive_path (output_filename))\n+    {\n+      char * base = (char *) lbasename (output_filename);\n+\n+      non_fatal (_(\"illegal output pathname for archive member: %s, using '%s' instead\"),\n+\t\t output_filename, base);\n+      output_filename = base;\n+    }\n+  \n   if (output_dir)\n     {\n       size_t len = strlen (output_dir);\n@@ -1083,18 +1095,10 @@ open_output_file (bfd * abfd)\n \t    output_filename = concat (output_dir, \"/\", output_filename, NULL);\n \t}\n     }\n-    \n-  /* PR binutils/17533: Do not allow directory traversal\n-     outside of the current directory tree.  */\n-  if (! is_valid_archive_path (output_filename))\n-    {\n-      char * base = (char *) lbasename (output_filename);\n-\n-      non_fatal (_(\"illegal output pathname for archive member: %s, using '%s' instead\"),\n-\t\t output_filename, base);\n-      output_filename = base;\n-    }\n \n+  if (verbose)\n+    printf (\"x - %s\\n\", output_filename);\n+  \n   FILE * ostream = fopen (output_filename, FOPEN_WB);\n   if (ostream == NULL)\n     {\n@@ -1126,9 +1130,6 @@ extract_file (bfd *abfd)\n     fatal (_(\"internal stat error on %s\"), bfd_get_filename (abfd));\n   size = buf.st_size;\n \n-  if (verbose)\n-    printf (\"x - %s\\n\", bfd_get_filename (abfd));\n-\n   bfd_seek (abfd, (file_ptr) 0, SEEK_SET);\n \n   output_file = NULL;"
    },
    {
      "sha": "11de2d3deb7977c826b8f35634b64badfab483ca",
      "filename": "binutils/doc/binutils.texi",
      "status": "modified",
      "additions": 3,
      "deletions": 6,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/e264b5b7a57dab997776ae845f9e0b3e5f20c713/binutils/doc/binutils.texi",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/e264b5b7a57dab997776ae845f9e0b3e5f20c713/binutils/doc/binutils.texi",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/doc/binutils.texi?ref=e264b5b7a57dab997776ae845f9e0b3e5f20c713",
      "patch": "@@ -390,7 +390,9 @@ are extracted.\n Files cannot be extracted from a thin archive, and there are\n restrictions on extracting from archives created with @option{P}: The\n paths must not be absolute, may not contain @code{..}, and any\n-subdirectories in the paths must exist.\n+subdirectories in the paths must exist.  If it is desired to avoid\n+these restrictions then used the @option{--output} option to specify\n+an output directory.\n @end table\n \n A number of modifiers (@var{mod}) may immediately follow the @var{p}\n@@ -589,11 +591,6 @@ Note - although the presence of this option does imply a @option{x}\n extraction operation that option must still be included on the command\n line.\n \n-Note - using this option does not allow archive members to be\n-extracted to locations outside of the current directory, or one of its \n-sub-directories.  This is a security feature to prevent archives\n-created with the @option{P} option from maliciously overwriting user\n-files.\n @end table\n @c man end\n "
    }
  ]
}