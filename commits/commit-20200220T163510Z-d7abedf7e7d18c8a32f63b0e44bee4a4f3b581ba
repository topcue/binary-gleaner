{
  "sha": "d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDdhYmVkZjdlN2QxOGM4YTMyZjYzYjBlNDRiZWU0YTRmM2I1ODFiYQ==",
  "commit": {
    "author": {
      "name": "Tankut Baris Aktemur",
      "email": "tankut.baris.aktemur@intel.com",
      "date": "2020-02-17T15:11:57Z"
    },
    "committer": {
      "name": "Tankut Baris Aktemur",
      "email": "tankut.baris.aktemur@intel.com",
      "date": "2020-02-20T16:35:10Z"
    },
    "message": "gdbserver: turn target op 'qxfer_siginfo' into a method\n\ngdbserver/ChangeLog:\n2020-02-20  Tankut Baris Aktemur  <tankut.baris.aktemur@intel.com>\n\n\tTurn process_stratum_target's qxfer_siginfo op into a method of\n\tprocess_target.\n\n\t* target.h (struct process_stratum_target): Remove the target op.\n\t(class process_target): Add the target op.  Also add\n\t'supports_qxfer_siginfo'.\n\t* target.cc (process_target::qxfer_siginfo): Define.\n\t(process_target::supports_qxfer_siginfo): Define.\n\n\tUpdate the derived classes and callers below.\n\n\t* server.cc (handle_qxfer_siginfo): Update.\n\t(handle_query): Update.\n\t* linux-low.cc (linux_target_ops): Update.\n\t(linux_process_target::supports_qxfer_siginfo): Define.\n\t(linux_xfer_siginfo): Turn into ...\n\t(linux_process_target::qxfer_siginfo): ... this.\n\t* linux-low.h (class linux_process_target): Update.\n\t* lynx-low.cc (lynx_target_ops): Update.\n\t* nto-low.cc (nto_target_ops): Update.\n\t* win32-low.cc (win32_target_ops): Update.",
    "tree": {
      "sha": "3b0abfef58440e64c900d6b8d53506d432a1f12b",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/3b0abfef58440e64c900d6b8d53506d432a1f12b"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/comments",
  "author": {
    "login": "barisaktemur",
    "id": 55686642,
    "node_id": "MDQ6VXNlcjU1Njg2NjQy",
    "avatar_url": "https://avatars.githubusercontent.com/u/55686642?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/barisaktemur",
    "html_url": "https://github.com/barisaktemur",
    "followers_url": "https://api.github.com/users/barisaktemur/followers",
    "following_url": "https://api.github.com/users/barisaktemur/following{/other_user}",
    "gists_url": "https://api.github.com/users/barisaktemur/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/barisaktemur/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/barisaktemur/subscriptions",
    "organizations_url": "https://api.github.com/users/barisaktemur/orgs",
    "repos_url": "https://api.github.com/users/barisaktemur/repos",
    "events_url": "https://api.github.com/users/barisaktemur/events{/privacy}",
    "received_events_url": "https://api.github.com/users/barisaktemur/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "barisaktemur",
    "id": 55686642,
    "node_id": "MDQ6VXNlcjU1Njg2NjQy",
    "avatar_url": "https://avatars.githubusercontent.com/u/55686642?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/barisaktemur",
    "html_url": "https://github.com/barisaktemur",
    "followers_url": "https://api.github.com/users/barisaktemur/followers",
    "following_url": "https://api.github.com/users/barisaktemur/following{/other_user}",
    "gists_url": "https://api.github.com/users/barisaktemur/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/barisaktemur/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/barisaktemur/subscriptions",
    "organizations_url": "https://api.github.com/users/barisaktemur/orgs",
    "repos_url": "https://api.github.com/users/barisaktemur/repos",
    "events_url": "https://api.github.com/users/barisaktemur/events{/privacy}",
    "received_events_url": "https://api.github.com/users/barisaktemur/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2d0795ee38d46bc820333ba1f0e9a836029d0151",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2d0795ee38d46bc820333ba1f0e9a836029d0151",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/2d0795ee38d46bc820333ba1f0e9a836029d0151"
    }
  ],
  "stats": {
    "total": 101,
    "additions": 83,
    "deletions": 18
  },
  "files": [
    {
      "sha": "e44108711bdfb3b4d69150b141726b87aa17f99c",
      "filename": "gdbserver/ChangeLog",
      "status": "modified",
      "additions": 24,
      "deletions": 0,
      "changes": 24,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/ChangeLog?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -1,3 +1,27 @@\n+2020-02-20  Tankut Baris Aktemur  <tankut.baris.aktemur@intel.com>\n+\n+\tTurn process_stratum_target's qxfer_siginfo op into a method of\n+\tprocess_target.\n+\n+\t* target.h (struct process_stratum_target): Remove the target op.\n+\t(class process_target): Add the target op.  Also add\n+\t'supports_qxfer_siginfo'.\n+\t* target.cc (process_target::qxfer_siginfo): Define.\n+\t(process_target::supports_qxfer_siginfo): Define.\n+\n+\tUpdate the derived classes and callers below.\n+\n+\t* server.cc (handle_qxfer_siginfo): Update.\n+\t(handle_query): Update.\n+\t* linux-low.cc (linux_target_ops): Update.\n+\t(linux_process_target::supports_qxfer_siginfo): Define.\n+\t(linux_xfer_siginfo): Turn into ...\n+\t(linux_process_target::qxfer_siginfo): ... this.\n+\t* linux-low.h (class linux_process_target): Update.\n+\t* lynx-low.cc (lynx_target_ops): Update.\n+\t* nto-low.cc (nto_target_ops): Update.\n+\t* win32-low.cc (win32_target_ops): Update.\n+\n 2020-02-20  Tankut Baris Aktemur  <tankut.baris.aktemur@intel.com>\n \n \tTurn process_stratum_target's qxfer_osdata op into a method of"
    },
    {
      "sha": "552c73524aa305f3a100cb67f9a53705ed122e91",
      "filename": "gdbserver/linux-low.cc",
      "status": "modified",
      "additions": 11,
      "deletions": 4,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/linux-low.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/linux-low.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/linux-low.cc?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -6182,9 +6182,17 @@ siginfo_fixup (siginfo_t *siginfo, gdb_byte *inf_siginfo, int direction)\n     }\n }\n \n-static int\n-linux_xfer_siginfo (const char *annex, unsigned char *readbuf,\n-\t\t    unsigned const char *writebuf, CORE_ADDR offset, int len)\n+bool\n+linux_process_target::supports_qxfer_siginfo ()\n+{\n+  return true;\n+}\n+\n+int\n+linux_process_target::qxfer_siginfo (const char *annex,\n+\t\t\t\t     unsigned char *readbuf,\n+\t\t\t\t     unsigned const char *writebuf,\n+\t\t\t\t     CORE_ADDR offset, int len)\n {\n   int pid;\n   siginfo_t siginfo;\n@@ -7421,7 +7429,6 @@ linux_get_hwcap2 (int wordsize)\n static linux_process_target the_linux_target;\n \n static process_stratum_target linux_target_ops = {\n-  linux_xfer_siginfo,\n   linux_supports_non_stop,\n   linux_async,\n   linux_start_non_stop,"
    },
    {
      "sha": "5a0e370dd8943686a11bba0c13f990f3733aa712",
      "filename": "gdbserver/linux-low.h",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/linux-low.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/linux-low.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/linux-low.h?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -351,6 +351,12 @@ class linux_process_target : public process_target\n   int qxfer_osdata (const char *annex, unsigned char *readbuf,\n \t\t    unsigned const char *writebuf,\n \t\t    CORE_ADDR offset, int len) override;\n+\n+  bool supports_qxfer_siginfo () override;\n+\n+  int qxfer_siginfo (const char *annex, unsigned char *readbuf,\n+\t\t     unsigned const char *writebuf,\n+\t\t     CORE_ADDR offset, int len) override;\n };\n \n #define get_thread_lwp(thr) ((struct lwp_info *) (thread_target_data (thr)))"
    },
    {
      "sha": "86e90df0086e6ba88291a0623f454b6f3589ee6f",
      "filename": "gdbserver/lynx-low.cc",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/lynx-low.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/lynx-low.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/lynx-low.cc?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -735,7 +735,6 @@ static lynx_process_target the_lynx_target;\n /* The LynxOS target_ops vector.  */\n \n static process_stratum_target lynx_target_ops = {\n-  NULL,  /* qxfer_siginfo */\n   NULL,  /* supports_non_stop */\n   NULL,  /* async */\n   NULL,  /* start_non_stop */"
    },
    {
      "sha": "78e8fd966b9cdde01e1f37ca5eb6c6f3b78b6884",
      "filename": "gdbserver/nto-low.cc",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/nto-low.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/nto-low.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/nto-low.cc?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -956,7 +956,6 @@ nto_sw_breakpoint_from_kind (int kind, int *size)\n static nto_process_target the_nto_target;\n \n static process_stratum_target nto_target_ops = {\n-  NULL, /* xfer_siginfo */\n   nto_supports_non_stop,\n   NULL, /* async */\n   NULL, /* start_non_stop */"
    },
    {
      "sha": "ece75f01868b5a022754d56ada10c12d3de2ead9",
      "filename": "gdbserver/server.cc",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/server.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/server.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/server.cc?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -1600,13 +1600,13 @@ handle_qxfer_siginfo (const char *annex,\n \t\t      gdb_byte *readbuf, const gdb_byte *writebuf,\n \t\t      ULONGEST offset, LONGEST len)\n {\n-  if (the_target->qxfer_siginfo == NULL)\n+  if (!the_target->pt->supports_qxfer_siginfo ())\n     return -2;\n \n   if (annex[0] != '\\0' || current_thread == NULL)\n     return -1;\n \n-  return (*the_target->qxfer_siginfo) (annex, readbuf, writebuf, offset, len);\n+  return the_target->pt->qxfer_siginfo (annex, readbuf, writebuf, offset, len);\n }\n \n /* Handle qXfer:statictrace:read.  */\n@@ -2377,7 +2377,7 @@ handle_query (char *own_buf, int packet_len, int *new_packet_len_p)\n       if (the_target->pt->supports_read_auxv ())\n \tstrcat (own_buf, \";qXfer:auxv:read+\");\n \n-      if (the_target->qxfer_siginfo != NULL)\n+      if (the_target->pt->supports_qxfer_siginfo ())\n \tstrcat (own_buf, \";qXfer:siginfo:read+;qXfer:siginfo:write+\");\n \n       if (the_target->read_loadmap != NULL)"
    },
    {
      "sha": "94bb45fcacef58aed4849a17cda9d83d4b5f3726",
      "filename": "gdbserver/target.cc",
      "status": "modified",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/target.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/target.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/target.cc?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -527,3 +527,17 @@ process_target::qxfer_osdata (const char *annex, unsigned char *readbuf,\n {\n   gdb_assert_not_reached (\"target op qxfer_osdata not supported\");\n }\n+\n+bool\n+process_target::supports_qxfer_siginfo ()\n+{\n+  return false;\n+}\n+\n+int\n+process_target::qxfer_siginfo (const char *annex, unsigned char *readbuf,\n+\t\t\t       unsigned const char *writebuf,\n+\t\t\t       CORE_ADDR offset, int len)\n+{\n+  gdb_assert_not_reached (\"target op qxfer_siginfo not supported\");\n+}"
    },
    {
      "sha": "1ad0005c8f404866dc8c3fcbd2d8fe42225283b0",
      "filename": "gdbserver/target.h",
      "status": "modified",
      "additions": 8,
      "deletions": 5,
      "changes": 13,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/target.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/target.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/target.h?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -70,11 +70,6 @@ class process_target;\n    shared code.  */\n struct process_stratum_target\n {\n-  /* Read/Write extra signal info.  */\n-  int (*qxfer_siginfo) (const char *annex, unsigned char *readbuf,\n-\t\t\tunsigned const char *writebuf,\n-\t\t\tCORE_ADDR offset, int len);\n-\n   int (*supports_non_stop) (void);\n \n   /* Enables async target events.  Returns the previous enable\n@@ -482,6 +477,14 @@ class process_target\n   virtual int qxfer_osdata (const char *annex, unsigned char *readbuf,\n \t\t\t    unsigned const char *writebuf,\n \t\t\t    CORE_ADDR offset, int len);\n+\n+  /* Return true if the qxfer_siginfo target op is supported.  */\n+  virtual bool supports_qxfer_siginfo ();\n+\n+  /* Read/Write extra signal info.  */\n+  virtual int qxfer_siginfo (const char *annex, unsigned char *readbuf,\n+\t\t\t     unsigned const char *writebuf,\n+\t\t\t     CORE_ADDR offset, int len);\n };\n \n extern process_stratum_target *the_target;"
    },
    {
      "sha": "23c23bc7ed8ea8d77e9e98c05b3fdf419aa6c6f1",
      "filename": "gdbserver/win32-low.cc",
      "status": "modified",
      "additions": 11,
      "deletions": 4,
      "changes": 15,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/win32-low.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/win32-low.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/win32-low.cc?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -1793,11 +1793,19 @@ win32_process_target::hostio_last_error (char *buf)\n }\n #endif\n \n+bool\n+win32_process_target::supports_qxfer_siginfo ()\n+{\n+  return true;\n+}\n+\n /* Write Windows signal info.  */\n \n-static int\n-win32_xfer_siginfo (const char *annex, unsigned char *readbuf,\n-\t\t    unsigned const char *writebuf, CORE_ADDR offset, int len)\n+int\n+win32_process_target::qxfer_siginfo (const char *annex,\n+\t\t\t\t     unsigned char *readbuf,\n+\t\t\t\t     unsigned const char *writebuf,\n+\t\t\t\t     CORE_ADDR offset, int len)\n {\n   if (siginfo_er.ExceptionCode == 0)\n     return -1;\n@@ -1844,7 +1852,6 @@ win32_sw_breakpoint_from_kind (int kind, int *size)\n static win32_process_target the_win32_target;\n \n static process_stratum_target win32_target_ops = {\n-  win32_xfer_siginfo,\n   NULL, /* supports_non_stop */\n   NULL, /* async */\n   NULL, /* start_non_stop */"
    },
    {
      "sha": "b259b1fbac1114e2b85a33a3fa20ce90e253f3de",
      "filename": "gdbserver/win32-low.h",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/win32-low.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba/gdbserver/win32-low.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/win32-low.h?ref=d7abedf7e7d18c8a32f63b0e44bee4a4f3b581ba",
      "patch": "@@ -156,6 +156,12 @@ class win32_process_target : public process_target\n #ifdef _WIN32_WCE\n   void hostio_last_error (char *buf) override;\n #endif\n+\n+  bool supports_qxfer_siginfo () override;\n+\n+  int qxfer_siginfo (const char *annex, unsigned char *readbuf,\n+\t\t     unsigned const char *writebuf,\n+\t\t     CORE_ADDR offset, int len) override;\n };\n \n /* Retrieve the context for this thread, if not already retrieved.  */"
    }
  ]
}