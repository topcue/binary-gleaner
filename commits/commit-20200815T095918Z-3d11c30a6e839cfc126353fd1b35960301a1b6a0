{
  "sha": "3d11c30a6e839cfc126353fd1b35960301a1b6a0",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6M2QxMWMzMGE2ZTgzOWNmYzEyNjM1M2ZkMWIzNTk2MDMwMWExYjZhMA==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-08-15T09:59:18Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-08-15T09:59:18Z"
    },
    "message": "[gdb/testsuite] Fix charlen type in mixed-lang-stack.c\n\nIn gdb.fortran/mixed-lang-stack.f90, we have fortran function mixed_func_1d:\n...\nsubroutine mixed_func_1d(a, b, c, d, str)\n  use, intrinsic :: iso_c_binding, only: c_int, c_float, c_double\n  use, intrinsic :: iso_c_binding, only: c_float_complex\n  implicit none\n  integer(c_int) :: a\n  real(c_float) :: b\n  real(c_double) :: c\n  complex(c_float_complex) :: d\n  character(len=*) :: str\n...\nwhich we declare in C in gdb.fortran/mixed-lang-stack.c like this:\n...\nextern void mixed_func_1d_ (int *, float *, double *, complex float *,\n                            char *, size_t);\n...\n\nThe fortran string parameter str is passed as a char *, and an additional\nargument str_ for the string length.  The type used for the string length\nargument is size_t, but for gcc 7 and earlier, the actual type is int\ninstead ( see\nhttps://gcc.gnu.org/onlinedocs/gfortran/Argument-passing-conventions.html ).\n\nFix this by declaring the string length type depending on the gcc version:\n...\n #if !defined (__GNUC__) || __GNUC__ > 7\n typedef size_t fortran_charlen_t;\n #else\n typedef int fortran_charlen_t;\n...\n\nTested on x86_64-linux, with gcc-7 and gcc-8.\n\ngdb/testsuite/ChangeLog:\n\n2020-08-15  Tom de Vries  <tdevries@suse.de>\n\n\t* gdb.fortran/mixed-lang-stack.c (fortran_charlen_t): New type.\n\t(mixed_func_1d_): Use fortran_charlen_t in decl.",
    "tree": {
      "sha": "9e1faee0287262554df1f1c3154474c1453dd674",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/9e1faee0287262554df1f1c3154474c1453dd674"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/3d11c30a6e839cfc126353fd1b35960301a1b6a0",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3d11c30a6e839cfc126353fd1b35960301a1b6a0",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/3d11c30a6e839cfc126353fd1b35960301a1b6a0",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/3d11c30a6e839cfc126353fd1b35960301a1b6a0/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "547ce8f00b4ef826bdc9bf9a74f119fe9768852e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/547ce8f00b4ef826bdc9bf9a74f119fe9768852e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/547ce8f00b4ef826bdc9bf9a74f119fe9768852e"
    }
  ],
  "stats": {
    "total": 15,
    "additions": 14,
    "deletions": 1
  },
  "files": [
    {
      "sha": "d8556159e5fc8de2a9da213f15e24c5b13a09ddd",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3d11c30a6e839cfc126353fd1b35960301a1b6a0/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3d11c30a6e839cfc126353fd1b35960301a1b6a0/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=3d11c30a6e839cfc126353fd1b35960301a1b6a0",
      "patch": "@@ -1,3 +1,8 @@\n+2020-08-15  Tom de Vries  <tdevries@suse.de>\n+\n+\t* gdb.fortran/mixed-lang-stack.c (fortran_charlen_t): New type.\n+\t(mixed_func_1d_): Use fortran_charlen_t in decl.\n+\n 2020-08-15  Tom de Vries  <tdevries@suse.de>\n \n \tPR backtrace/26390"
    },
    {
      "sha": "cd964198ef74a1eabbd92b29044951f05fd58169",
      "filename": "gdb/testsuite/gdb.fortran/mixed-lang-stack.c",
      "status": "modified",
      "additions": 9,
      "deletions": 1,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/3d11c30a6e839cfc126353fd1b35960301a1b6a0/gdb/testsuite/gdb.fortran/mixed-lang-stack.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/3d11c30a6e839cfc126353fd1b35960301a1b6a0/gdb/testsuite/gdb.fortran/mixed-lang-stack.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.fortran/mixed-lang-stack.c?ref=3d11c30a6e839cfc126353fd1b35960301a1b6a0",
      "patch": "@@ -22,8 +22,16 @@ struct some_struct\n   float a, b;\n };\n \n+/* See https://gcc.gnu.org/onlinedocs/gfortran/\\\n+     Argument-passing-conventions.html.  */\n+#if !defined (__GNUC__) || __GNUC__ > 7\n+typedef size_t fortran_charlen_t;\n+#else\n+typedef int fortran_charlen_t;\n+#endif\n+\n extern void mixed_func_1d_ (int *, float *, double *, complex float *,\n-\t\t\t    char *, size_t);\n+\t\t\t    char *, fortran_charlen_t);\n \n void\n mixed_func_1c (int a, float b, double c, complex float d, char *f,"
    }
  ]
}