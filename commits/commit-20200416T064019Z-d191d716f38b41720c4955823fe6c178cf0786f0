{
  "sha": "d191d716f38b41720c4955823fe6c178cf0786f0",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZDE5MWQ3MTZmMzhiNDE3MjBjNDk1NTgyM2ZlNmMxNzhjZjA3ODZmMA==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-04-16T06:40:19Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2020-04-16T06:40:19Z"
    },
    "message": "[gdb/testsuite] Fix maint-expand-symbols-header-file.exp for cc-with-gdb-index\n\nWith test-case gdb.base/maint-expand-symbols-header-file.exp and target board\ncc-with-gdb-index, we have:\n...\nFAIL: gdb.base/maint-expand-symbols-header-file.exp: \\\n  verify no symtabs are expanded\n...\n\nBy default, with partial symbols, we find the main function in the partial\nsymbols, and derive the initial language setting from that, without expanding\nany psymtab.\n\nBut that doesn't work with the indices, because the indices don't store the\nlanguage with the symbols.  So instead, the main psymtab is expanded to get\nthe language of main, which causes the FAIL.\n\nFix this by manually setting the language.\n\nTested on x86_64-linux.\n\ngdb/testsuite/ChangeLog:\n\n2020-04-16  Tom de Vries  <tdevries@suse.de>\n\n\t* gdb.base/maint-expand-symbols-header-file.exp: Set language before\n\tloading exec.",
    "tree": {
      "sha": "6460700095046d5466b15bb9f1dfad38467b02dc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/6460700095046d5466b15bb9f1dfad38467b02dc"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/d191d716f38b41720c4955823fe6c178cf0786f0",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d191d716f38b41720c4955823fe6c178cf0786f0",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/d191d716f38b41720c4955823fe6c178cf0786f0",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/d191d716f38b41720c4955823fe6c178cf0786f0/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2165dc8d90ef9618a1db9bc596f433b02b7cc54a",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2165dc8d90ef9618a1db9bc596f433b02b7cc54a",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/2165dc8d90ef9618a1db9bc596f433b02b7cc54a"
    }
  ],
  "stats": {
    "total": 13,
    "additions": 12,
    "deletions": 1
  },
  "files": [
    {
      "sha": "f12a5d7830183518dc30c580c90ed9457469c437",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d191d716f38b41720c4955823fe6c178cf0786f0/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d191d716f38b41720c4955823fe6c178cf0786f0/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=d191d716f38b41720c4955823fe6c178cf0786f0",
      "patch": "@@ -1,3 +1,8 @@\n+2020-04-16  Tom de Vries  <tdevries@suse.de>\n+\n+\t* gdb.base/maint-expand-symbols-header-file.exp: Set language before\n+\tloading exec.\n+\n 2020-04-15  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* gdb.base/many-completions.exp: New file."
    },
    {
      "sha": "05802b27190a4423b57a0ec681ddd68e99f07129",
      "filename": "gdb/testsuite/gdb.base/maint-expand-symbols-header-file.exp",
      "status": "modified",
      "additions": 7,
      "deletions": 1,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/d191d716f38b41720c4955823fe6c178cf0786f0/gdb/testsuite/gdb.base/maint-expand-symbols-header-file.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/d191d716f38b41720c4955823fe6c178cf0786f0/gdb/testsuite/gdb.base/maint-expand-symbols-header-file.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.base/maint-expand-symbols-header-file.exp?ref=d191d716f38b41720c4955823fe6c178cf0786f0",
      "patch": "@@ -18,10 +18,16 @@\n \n standard_testfile .c\n \n-if {[prepare_for_testing \"failed to prepare\" $testfile \\\n+if {[build_executable \"failed to prepare\" $testfile \\\n \t $srcfile {debug nowarnings}]} {\n     return -1\n }\n+clean_restart\n+\n+# Make sure that no symtabs are expanded, by setting language before\n+# loading exec.\n+gdb_test_no_output \"set language c\"\n+gdb_load ${binfile}\n \n set test \"verify no symtabs are expanded\"\n if { [readnow] } {"
    }
  ]
}