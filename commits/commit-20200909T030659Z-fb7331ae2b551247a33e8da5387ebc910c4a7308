{
  "sha": "fb7331ae2b551247a33e8da5387ebc910c4a7308",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZmI3MzMxYWUyYjU1MTI0N2EzM2U4ZGE1Mzg3ZWJjOTEwYzRhNzMwOA==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-09-09T02:46:23Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-09-09T03:06:59Z"
    },
    "message": "lto-18 test\n\nDemonstrates a reason to use IR symbols when deciding an --as-needed\nlibrary should be loaded.\n\n\t* testsuite/ld-plugin/lto-18a.c,\n\t* testsuite/ld-plugin/lto-18b.c,\n\t* testsuite/ld-plugin/lto-18c.c,\n\t* testsuite/ld-plugin/lto-18d.c,\n\t* testsuite/ld-plugin/lto-18.out: New test.\n\t* testsuite/ld-plugin/lto.exp: Run it.",
    "tree": {
      "sha": "63a9cb66e0e78845d346425e3df1894ae943fa64",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/63a9cb66e0e78845d346425e3df1894ae943fa64"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/fb7331ae2b551247a33e8da5387ebc910c4a7308",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fb7331ae2b551247a33e8da5387ebc910c4a7308",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/fb7331ae2b551247a33e8da5387ebc910c4a7308",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fb7331ae2b551247a33e8da5387ebc910c4a7308/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "7671fe54f3a0c8c41098ad8fc32588a9e281c92c",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7671fe54f3a0c8c41098ad8fc32588a9e281c92c",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/7671fe54f3a0c8c41098ad8fc32588a9e281c92c"
    }
  ],
  "stats": {
    "total": 78,
    "additions": 74,
    "deletions": 4
  },
  "files": [
    {
      "sha": "27df4a0e9dd44309daeb49e92629c1f4c91b8374",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=fb7331ae2b551247a33e8da5387ebc910c4a7308",
      "patch": "@@ -1,3 +1,12 @@\n+2020-09-09  Alan Modra  <amodra@gmail.com>\n+\n+\t* testsuite/ld-plugin/lto-18a.c,\n+\t* testsuite/ld-plugin/lto-18b.c,\n+\t* testsuite/ld-plugin/lto-18c.c,\n+\t* testsuite/ld-plugin/lto-18d.c,\n+\t* testsuite/ld-plugin/lto-18.out: New test.\n+\t* testsuite/ld-plugin/lto.exp: Run it.\n+\n 2020-09-08  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n \n \t* testsuite/ld-msp430-elf/msp430-elf.exp: Run new tests."
    },
    {
      "sha": "d00491fd7e5bb6fa28c517a0bb32b8b506539d4d",
      "filename": "ld/testsuite/ld-plugin/lto-18.out",
      "status": "added",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18.out",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18.out",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/lto-18.out?ref=fb7331ae2b551247a33e8da5387ebc910c4a7308",
      "patch": "@@ -0,0 +1 @@\n+1"
    },
    {
      "sha": "477386af8c69fe1f1e750f5b1e7797610ce968fe",
      "filename": "ld/testsuite/ld-plugin/lto-18a.c",
      "status": "added",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18a.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18a.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/lto-18a.c?ref=fb7331ae2b551247a33e8da5387ebc910c4a7308",
      "patch": "@@ -0,0 +1,22 @@\n+#include <stdio.h>\n+\n+extern int select ();\n+extern int f1 (int);\n+extern int f2 (int);\n+\n+int main (void)\n+{\n+  switch (select ())\n+    {\n+    case 1:\n+      printf (\"%d\\n\", f1 (3));\n+      break;\n+    case 2:\n+      printf (\"%d\\n\", f2 (4));\n+      break;\n+    default:\n+      printf (\"%d\\n\", f2 (0));\n+      break;\n+    }\n+  return 0;\n+}"
    },
    {
      "sha": "0ae3a20c146535ad78c061ce275d4368576d6f80",
      "filename": "ld/testsuite/ld-plugin/lto-18b.c",
      "status": "added",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18b.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18b.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/lto-18b.c?ref=fb7331ae2b551247a33e8da5387ebc910c4a7308",
      "patch": "@@ -0,0 +1,10 @@\n+int select (void) { return 1; }\n+\n+extern int f2 (int);\n+\n+int f1 (int x)\n+{\n+  if (x > 0)\n+    return x * f2 (x - 1);\n+  return 1;\n+}"
    },
    {
      "sha": "90cc81bea3465c77e66e04f3fa92ad3338574137",
      "filename": "ld/testsuite/ld-plugin/lto-18c.c",
      "status": "added",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18c.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18c.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/lto-18c.c?ref=fb7331ae2b551247a33e8da5387ebc910c4a7308",
      "patch": "@@ -0,0 +1,10 @@\n+int select (void) { return 2; }\n+\n+extern int f1 (int);\n+\n+int f2 (int x)\n+{\n+  if (x > 0)\n+    return x * f1 (x - 1);\n+  return 1;\n+}"
    },
    {
      "sha": "cfb27cf38a9b07d9b54a3919622095db7d6033ec",
      "filename": "ld/testsuite/ld-plugin/lto-18d.c",
      "status": "added",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18d.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto-18d.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/lto-18d.c?ref=fb7331ae2b551247a33e8da5387ebc910c4a7308",
      "patch": "@@ -0,0 +1 @@\n+int select (void) { return 0; }"
    },
    {
      "sha": "0479e3e40354e9f531257ad1b26e994892f78f15",
      "filename": "ld/testsuite/ld-plugin/lto.exp",
      "status": "modified",
      "additions": 21,
      "deletions": 4,
      "changes": 25,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fb7331ae2b551247a33e8da5387ebc910c4a7308/ld/testsuite/ld-plugin/lto.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-plugin/lto.exp?ref=fb7331ae2b551247a33e8da5387ebc910c4a7308",
      "patch": "@@ -404,6 +404,15 @@ set lto_link_elf_tests [list \\\n    \"-shared -Wl,--exclude-libs,ALL tmpdir/pr25618a.o tmpdir/pr25618.a\" \\\n    \"-fpic\" \\\n    {dummy.c} {{readelf {--dyn-syms --wide} pr25618.d}} \"pr25618.so\" \"c++\"] \\\n+  [list {liblto-18b.so} \\\n+   {-shared} {-O2 -fpic} \\\n+   {lto-18b.c} {} {liblto-18b.so}] \\\n+  [list {liblto-18c.so} \\\n+   {-shared} {-O2 -fpic} \\\n+   {lto-18c.c} {} {liblto-18c.so}] \\\n+  [list {lto-18d.o} \\\n+   {} {-flto -O2} \\\n+   {lto-18d.c} {} {}] \\\n ]\n \n # PR 14918 checks that libgcc is not spuriously included in a shared link of\n@@ -412,23 +421,23 @@ set lto_link_elf_tests [list \\\n # __aeabi_unwind_cpp_pr0@@GCC_3.5 which is provided by libgcc_s.so.1, so the\n # test fails.  Hence this code to skip the test.\n if { ! [istarget \"arm*-*-*\"] } {\n-    set lto_link_elf_tests [concat $lto_link_elf_tests [list \\\n+    lappend lto_link_elf_tests [list \\\n   [list \"PR ld/14918\" \\\n    \"-flto\" \"-flto\" \\\n    {pr14918.c} {{\"readelf\" {-d --wide} \"pr14918.d\"}} \"pr14918.exe\" \"c\"] \\\n-  ]]\n+  ]\n }\n \n # PR 12982 checks that an executable stack is not created by default\n # when using the LTO plugin.  The HPPA target however requires an\n # executable stack for syscall restarts and signal returns, so we\n # skip this test for that target.\n if { ! [istarget \"hppa*-*-*\"] } {\n-    set lto_link_elf_tests [concat $lto_link_elf_tests [list \\\n+    lappend lto_link_elf_tests [list \\\n   [list \"PR ld/12982\" \\\n    \"-O2 -flto -fuse-linker-plugin\" \"-O2 -flto\" \\\n    {pr12982.c} {{\"readelf\" {-l --wide} \"pr12982.d\"}} \"pr12982.exe\"] \\\n-  ]]\n+  ]\n }\n \n # Check final symbols in executables.\n@@ -569,6 +578,14 @@ set lto_run_elf_shared_tests [list \\\n   [list {pr22220b} \\\n    {-flto -fuse-linker-plugin -Wl,--no-as-needed tmpdir/pr22220lib.so tmpdir/pr22220main.o} {} \\\n    {dummy.c} {pr22220b.exe} {pass.out} {} {c++}] \\\n+  [list {lto-18 (1)} \\\n+   {-flto -fuse-linker-plugin} {} \\\n+   {lto-18a.c} {lto-18-1.exe} {lto-18.out} {-flto -O2} {c} {} \\\n+   {tmpdir/lto-18d.o -Wl,--as-needed,-R,tmpdir -Ltmpdir -llto-18b -llto-18c}] \\\n+  [list {lto-18 (2)} \\\n+   {-flto -fuse-linker-plugin} {} \\\n+   {lto-18a.c} {lto-18-2.exe} {lto-18.out} {-flto -O2} {c} {} \\\n+   {-Wl,--as-needed,-R,tmpdir -Ltmpdir -llto-18b -llto-18c tmpdir/lto-18d.o}] \\\n ]\n \n # LTO run-time tests for ELF"
    }
  ]
}