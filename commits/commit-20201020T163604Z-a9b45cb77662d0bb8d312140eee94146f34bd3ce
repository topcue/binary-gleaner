{
  "sha": "a9b45cb77662d0bb8d312140eee94146f34bd3ce",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6YTliNDVjYjc3NjYyZDBiYjhkMzEyMTQwZWVlOTQxNDZmMzRiZDNjZQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-10-20T16:28:58Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2020-10-20T16:36:04Z"
    },
    "message": "Fix undefined behavior in gdbserver\n\nPR gdb/26742 points out some undefined behavior in gdbserver.  The bug\nis that remove_thread does:\n\n  free_one_thread (thread);\n  if (current_thread == thread)\n    current_thread = NULL;\n\nHowever, the equality check is undefined, because \"thread\" has already\nbeen freed.\n\nThis patch fixes the bug by moving the check earlier.\n\nTested on x86-64 Fedora 32.\n\n2020-10-20  Tom Tromey  <tromey@adacore.com>\n\n\tPR gdb/26742:\n\t* inferiors.cc (remove_thread): Clear current_thread before\n\tfreeing the thread.",
    "tree": {
      "sha": "ac3f78889d431f8b80a364f4cb1904199ec6bceb",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/ac3f78889d431f8b80a364f4cb1904199ec6bceb"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/a9b45cb77662d0bb8d312140eee94146f34bd3ce",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a9b45cb77662d0bb8d312140eee94146f34bd3ce",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/a9b45cb77662d0bb8d312140eee94146f34bd3ce",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a9b45cb77662d0bb8d312140eee94146f34bd3ce/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e0c45dedd909c7a0a6621bdc9061051c185123bb",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/e0c45dedd909c7a0a6621bdc9061051c185123bb",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/e0c45dedd909c7a0a6621bdc9061051c185123bb"
    }
  ],
  "stats": {
    "total": 8,
    "additions": 7,
    "deletions": 1
  },
  "files": [
    {
      "sha": "fd0a4bfaa5483d6103b06e911259056f6694b513",
      "filename": "gdbserver/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a9b45cb77662d0bb8d312140eee94146f34bd3ce/gdbserver/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a9b45cb77662d0bb8d312140eee94146f34bd3ce/gdbserver/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/ChangeLog?ref=a9b45cb77662d0bb8d312140eee94146f34bd3ce",
      "patch": "@@ -1,3 +1,9 @@\n+2020-10-20  Tom Tromey  <tromey@adacore.com>\n+\n+\tPR gdb/26742:\n+\t* inferiors.cc (remove_thread): Clear current_thread before\n+\tfreeing the thread.\n+\n 2020-10-13  Kamil Rytarowski  <n54@gmx.com>x\n \n \t* netbsd-low.cc (netbsd_tdesc): Remove."
    },
    {
      "sha": "9a1280d039b42f847fe51bd87a3e77345fad7222",
      "filename": "gdbserver/inferiors.cc",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/a9b45cb77662d0bb8d312140eee94146f34bd3ce/gdbserver/inferiors.cc",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/a9b45cb77662d0bb8d312140eee94146f34bd3ce/gdbserver/inferiors.cc",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdbserver/inferiors.cc?ref=a9b45cb77662d0bb8d312140eee94146f34bd3ce",
      "patch": "@@ -103,9 +103,9 @@ remove_thread (struct thread_info *thread)\n \n   discard_queued_stop_replies (ptid_of (thread));\n   all_threads.remove (thread);\n-  free_one_thread (thread);\n   if (current_thread == thread)\n     current_thread = NULL;\n+  free_one_thread (thread);\n }\n \n void *"
    }
  ]
}