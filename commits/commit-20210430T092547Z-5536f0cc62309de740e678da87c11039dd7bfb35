{
  "sha": "5536f0cc62309de740e678da87c11039dd7bfb35",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NTUzNmYwY2M2MjMwOWRlNzQwZTY3OGRhODdjMTEwMzlkZDdiZmIzNQ==",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-04-30T09:25:47Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2021-04-30T09:25:47Z"
    },
    "message": "[gdb/testsuite] Make gdb.mi/mi-sym-info.exp more robust against timeouts\n\nOnce in a while, I run into this timeout:\n...\nFAIL: gdb.mi/mi-sym-info.exp: List all variables from debug information \\\n  only (timeout)\n...\n\nI can make the timeout reproducible by setting timeout to 8s (instead of the\ndefault 10s) for the duration of that test.\n\nMake the test-case more stable by fixing all timeouts caused by setting\ntimeout to 5, either by adding with_timeout_factor, or increasing its factor.\n\nTested on x86_64-linux.  Also tested in parallel with stress -c 5, to simulate\na busy system in another way.\n\ngdb/testsuite/ChangeLog:\n\n2021-04-30  Tom de Vries  <tdevries@suse.de>\n\n\t* gdb.mi/mi-sym-info.exp: Add with_timeout_factor, and increase\n\texisting timeout factors.",
    "tree": {
      "sha": "9ecfcc3f6c0b480193284bce3ca2ca95391148f8",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/9ecfcc3f6c0b480193284bce3ca2ca95391148f8"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/5536f0cc62309de740e678da87c11039dd7bfb35",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5536f0cc62309de740e678da87c11039dd7bfb35",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/5536f0cc62309de740e678da87c11039dd7bfb35",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5536f0cc62309de740e678da87c11039dd7bfb35/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "7f7f284dfeebd16f7f8a08a565cf9837c3322308",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/7f7f284dfeebd16f7f8a08a565cf9837c3322308",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/7f7f284dfeebd16f7f8a08a565cf9837c3322308"
    }
  ],
  "stats": {
    "total": 75,
    "additions": 42,
    "deletions": 33
  },
  "files": [
    {
      "sha": "8e021d2284bbd10c2d518b97537b9aab83f35dbd",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5536f0cc62309de740e678da87c11039dd7bfb35/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5536f0cc62309de740e678da87c11039dd7bfb35/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=5536f0cc62309de740e678da87c11039dd7bfb35",
      "patch": "@@ -1,3 +1,8 @@\n+2021-04-30  Tom de Vries  <tdevries@suse.de>\n+\n+\t* gdb.mi/mi-sym-info.exp: Add with_timeout_factor, and increase\n+\texisting timeout factors.\n+\n 2021-04-30  Tom de Vries  <tdevries@suse.de>\n \n \t* gdb.mi/mi-sym-info.exp: Remove duplicate test."
    },
    {
      "sha": "18f85182a7b1003ffba33557dadad789e2fa57ce",
      "filename": "gdb/testsuite/gdb.mi/mi-sym-info.exp",
      "status": "modified",
      "additions": 37,
      "deletions": 33,
      "changes": 70,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5536f0cc62309de740e678da87c11039dd7bfb35/gdb/testsuite/gdb.mi/mi-sym-info.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5536f0cc62309de740e678da87c11039dd7bfb35/gdb/testsuite/gdb.mi/mi-sym-info.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.mi/mi-sym-info.exp?ref=5536f0cc62309de740e678da87c11039dd7bfb35",
      "patch": "@@ -55,42 +55,46 @@ set type_syms \\\n \n # Fetch all functions, variables and types without any non-debug\n # symbols.\n-set testname \"List all functions from debug information only\"\n-set cmd \"111-symbol-info-functions\"\n-set state 0\n-gdb_test_multiple $cmd $testname -prompt \"${mi_gdb_prompt}$\" {\n-    -re \"111\\\\^done,symbols=\\{debug=\\\\\\[${symtab_re}\" {\n-\tif { $state == 0 } { incr state }\n-\texp_continue\n-    }\n-    -re \",${symtab_re}\" {\n-\texp_continue\n-    }\n-    -re \"\\\\\\]\\}\\r\\n${mi_gdb_prompt}$\" {\n-\tif { $state == 1 } {\n-\t    pass $gdb_test_name\n-\t} else {\n-\t    fail $gdb_test_name\n+with_timeout_factor 2 {\n+    set testname \"List all functions from debug information only\"\n+    set cmd \"111-symbol-info-functions\"\n+    set state 0\n+    gdb_test_multiple $cmd $testname -prompt \"${mi_gdb_prompt}$\" {\n+\t-re \"111\\\\^done,symbols=\\{debug=\\\\\\[${symtab_re}\" {\n+\t    if { $state == 0 } { incr state }\n+\t    exp_continue\n+\t}\n+\t-re \",${symtab_re}\" {\n+\t    exp_continue\n+\t}\n+\t-re \"\\\\\\]\\}\\r\\n${mi_gdb_prompt}$\" {\n+\t    if { $state == 1 } {\n+\t\tpass $gdb_test_name\n+\t    } else {\n+\t\tfail $gdb_test_name\n+\t    }\n \t}\n     }\n }\n \n-set testname \"List all variables from debug information only\"\n-set cmd \"112-symbol-info-variables\"\n-set state 0\n-gdb_test_multiple $cmd $testname -prompt \"${mi_gdb_prompt}$\" {\n-    -re \"112\\\\^done,symbols=\\{debug=\\\\\\[${symtab_re}\" {\n-\tif { $state == 0 } { incr state }\n-\texp_continue\n-    }\n-    -re \",${symtab_re}\" {\n-\texp_continue\n-    }\n-    -re \"\\\\\\]\\}\\r\\n${mi_gdb_prompt}$\" {\n-\tif { $state == 1 } {\n-\t    pass $gdb_test_name\n-\t} else {\n-\t    fail $gdb_test_name\n+with_timeout_factor 2 {\n+    set testname \"List all variables from debug information only\"\n+    set cmd \"112-symbol-info-variables\"\n+    set state 0\n+    gdb_test_multiple $cmd $testname -prompt \"${mi_gdb_prompt}$\" {\n+\t-re \"112\\\\^done,symbols=\\{debug=\\\\\\[${symtab_re}\" {\n+\t    if { $state == 0 } { incr state }\n+\t    exp_continue\n+\t}\n+\t-re \",${symtab_re}\" {\n+\t    exp_continue\n+\t}\n+\t-re \"\\\\\\]\\}\\r\\n${mi_gdb_prompt}$\" {\n+\t    if { $state == 1 } {\n+\t\tpass $gdb_test_name\n+\t    } else {\n+\t\tfail $gdb_test_name\n+\t    }\n \t}\n     }\n }\n@@ -150,7 +154,7 @@ gdb_test_multiple $cmd ${testname} -prompt \"${mi_gdb_prompt}$\" {\n     }\n }\n \n-with_timeout_factor 2 {\n+with_timeout_factor 4 {\n     set testname \"List all variables\"\n     set cmd \"115-symbol-info-variables --include-nondebug\"\n     set state 0"
    }
  ]
}