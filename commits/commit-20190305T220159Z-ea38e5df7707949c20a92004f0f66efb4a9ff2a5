{
  "sha": "ea38e5df7707949c20a92004f0f66efb4a9ff2a5",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZWEzOGU1ZGY3NzA3OTQ5YzIwYTkyMDA0ZjBmNjZlZmI0YTlmZjJhNQ==",
  "commit": {
    "author": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2019-03-05T21:58:24Z"
    },
    "committer": {
      "name": "Tom Tromey",
      "email": "tromey@adacore.com",
      "date": "2019-03-05T22:01:59Z"
    },
    "message": "Remove some Python 3 #ifs\n\nA recent patch from Kevin Buettner taught me that the PyBytes API is\navailable on Python 2.  This patch removes a couple of related #ifs in\nthe Python code.\n\nTested on x86-64 Fedora 29, using both Python 3.7 and Python 2.7.\n\ngdb/ChangeLog\n2019-03-05  Tom Tromey  <tromey@adacore.com>\n\n\t* python/py-prettyprint.c (print_string_repr): Remove #if.\n\t* python/py-utils.c (unicode_to_encoded_string): Remove #if.",
    "tree": {
      "sha": "3f1984782c941ea7d6fadcaf57d97761eb4c90c6",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/3f1984782c941ea7d6fadcaf57d97761eb4c90c6"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/ea38e5df7707949c20a92004f0f66efb4a9ff2a5",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ea38e5df7707949c20a92004f0f66efb4a9ff2a5",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/ea38e5df7707949c20a92004f0f66efb4a9ff2a5",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/ea38e5df7707949c20a92004f0f66efb4a9ff2a5/comments",
  "author": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "tromey",
    "id": 1557670,
    "node_id": "MDQ6VXNlcjE1NTc2NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tromey",
    "html_url": "https://github.com/tromey",
    "followers_url": "https://api.github.com/users/tromey/followers",
    "following_url": "https://api.github.com/users/tromey/following{/other_user}",
    "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tromey/subscriptions",
    "organizations_url": "https://api.github.com/users/tromey/orgs",
    "repos_url": "https://api.github.com/users/tromey/repos",
    "events_url": "https://api.github.com/users/tromey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tromey/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "06b5b831a09417bac37b44599dc35d4b904700c5",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/06b5b831a09417bac37b44599dc35d4b904700c5",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/06b5b831a09417bac37b44599dc35d4b904700c5"
    }
  ],
  "stats": {
    "total": 21,
    "additions": 7,
    "deletions": 14
  },
  "files": [
    {
      "sha": "7c4a06f83279ed8d6c34530eff614e6a9af0aa5b",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ea38e5df7707949c20a92004f0f66efb4a9ff2a5/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ea38e5df7707949c20a92004f0f66efb4a9ff2a5/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=ea38e5df7707949c20a92004f0f66efb4a9ff2a5",
      "patch": "@@ -1,3 +1,8 @@\n+2019-03-05  Tom Tromey  <tromey@adacore.com>\n+\n+\t* python/py-prettyprint.c (print_string_repr): Remove #if.\n+\t* python/py-utils.c (unicode_to_encoded_string): Remove #if.\n+\n 2019-03-05  Tom Tromey  <tromey@adacore.com>\n \n \t* target.c (the_dummy_target): Move later.  Change type to"
    },
    {
      "sha": "e64d1f88af892c38b7a2b97a572f62a25cada696",
      "filename": "gdb/python/py-prettyprint.c",
      "status": "modified",
      "additions": 0,
      "deletions": 5,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ea38e5df7707949c20a92004f0f66efb4a9ff2a5/gdb/python/py-prettyprint.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ea38e5df7707949c20a92004f0f66efb4a9ff2a5/gdb/python/py-prettyprint.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/python/py-prettyprint.c?ref=ea38e5df7707949c20a92004f0f66efb4a9ff2a5",
      "patch": "@@ -312,13 +312,8 @@ print_string_repr (PyObject *printer, const char *hint,\n \t      long length;\n \t      struct type *type;\n \n-#ifdef IS_PY3K\n \t      output = PyBytes_AS_STRING (string.get ());\n \t      length = PyBytes_GET_SIZE (string.get ());\n-#else\n-\t      output = PyString_AsString (string.get ());\n-\t      length = PyString_Size (string.get ());\n-#endif\n \t      type = builtin_type (gdbarch)->builtin_char;\n \n \t      if (hint && !strcmp (hint, \"string\"))"
    },
    {
      "sha": "d470000219589f7a9f40c6280f138becc367bd95",
      "filename": "gdb/python/py-utils.c",
      "status": "modified",
      "additions": 2,
      "deletions": 9,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/ea38e5df7707949c20a92004f0f66efb4a9ff2a5/gdb/python/py-utils.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/ea38e5df7707949c20a92004f0f66efb4a9ff2a5/gdb/python/py-utils.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/python/py-utils.c?ref=ea38e5df7707949c20a92004f0f66efb4a9ff2a5",
      "patch": "@@ -66,20 +66,13 @@ python_string_to_unicode (PyObject *obj)\n static gdb::unique_xmalloc_ptr<char>\n unicode_to_encoded_string (PyObject *unicode_str, const char *charset)\n {\n-  gdb::unique_xmalloc_ptr<char> result;\n-\n   /* Translate string to named charset.  */\n   gdbpy_ref<> string (PyUnicode_AsEncodedString (unicode_str, charset, NULL));\n   if (string == NULL)\n     return NULL;\n \n-#ifdef IS_PY3K\n-  result.reset (xstrdup (PyBytes_AsString (string.get ())));\n-#else\n-  result.reset (xstrdup (PyString_AsString (string.get ())));\n-#endif\n-\n-  return result;\n+  return gdb::unique_xmalloc_ptr<char>\n+    (xstrdup (PyBytes_AsString (string.get ())));\n }\n \n /* Returns a PyObject with the contents of the given unicode string"
    }
  ]
}