{
  "sha": "f5a7c406b1975cde626efed526960f2cf1bdaceb",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6ZjVhN2M0MDZiMTk3NWNkZTYyNmVmZWQ1MjY5NjBmMmNmMWJkYWNlYg==",
  "commit": {
    "author": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2020-01-07T11:39:17Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2020-01-09T23:11:47Z"
    },
    "message": "gdb/tui: Link source and assembler scrolling .... again\n\nUntil recently when the source window was scrolled the assembler\nwindow would scroll in sync - keeping the disassembly for the current\nline in view.\n\nThis was broken in commit:\n\n  commit b4b49dcbff6b437fa8b4e2fc0c3f27b457f11310\n  Date:   Wed Nov 13 16:47:58 2019 -0700\n\n      Don't call tui_show_source from tui_ui_out\n\nThis commit restores the synchronised scrolling and also maintains the\nhorizontal scroll within the source view when it is vertically\nscrolled, something that was broken before.\n\nThis commit does not mean that scrolling the assembler view scrolls\nthe source view.  The connection this way never existed, though maybe\nit should, but I'll leave adding this feature for a separate commit.\n\ngdb/ChangeLog:\n\n\t* tui/tui-source.c (tui_source_window::do_scroll_vertical): Update\n\tall source windows, and maintain horizontal scroll status while\n\tdoing so.\n\ngdb/testsuite/ChangeLog:\n\n\t* gdb.tui/basic.exp: Add more scrolling tests.\n\nChange-Id: I250114a3bc670040a6a759d41905776771b2f818",
    "tree": {
      "sha": "79e1814d89c4158fcab301d2c1891c891962e791",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/79e1814d89c4158fcab301d2c1891c891962e791"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/f5a7c406b1975cde626efed526960f2cf1bdaceb",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f5a7c406b1975cde626efed526960f2cf1bdaceb",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/f5a7c406b1975cde626efed526960f2cf1bdaceb",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/f5a7c406b1975cde626efed526960f2cf1bdaceb/comments",
  "author": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "9ae6bf640dc7c950e6f36097a3d2d760a132a542",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/9ae6bf640dc7c950e6f36097a3d2d760a132a542",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/9ae6bf640dc7c950e6f36097a3d2d760a132a542"
    }
  ],
  "stats": {
    "total": 41,
    "additions": 40,
    "deletions": 1
  },
  "files": [
    {
      "sha": "425bafa9b26a55133a020a31fca8649511490ec3",
      "filename": "gdb/ChangeLog",
      "status": "modified",
      "additions": 6,
      "deletions": 0,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f5a7c406b1975cde626efed526960f2cf1bdaceb/gdb/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f5a7c406b1975cde626efed526960f2cf1bdaceb/gdb/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/ChangeLog?ref=f5a7c406b1975cde626efed526960f2cf1bdaceb",
      "patch": "@@ -1,3 +1,9 @@\n+2020-01-09  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* tui/tui-source.c (tui_source_window::do_scroll_vertical): Update\n+\tall source windows, and maintain horizontal scroll status while\n+\tdoing so.\n+\n 2020-01-09  Tom Tromey  <tom@tromey.com>\n \n \tPR tui/18932:"
    },
    {
      "sha": "536a9649595535c5f60c723f99442c18c48d99b5",
      "filename": "gdb/testsuite/ChangeLog",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f5a7c406b1975cde626efed526960f2cf1bdaceb/gdb/testsuite/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f5a7c406b1975cde626efed526960f2cf1bdaceb/gdb/testsuite/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/ChangeLog?ref=f5a7c406b1975cde626efed526960f2cf1bdaceb",
      "patch": "@@ -1,3 +1,7 @@\n+2020-01-09  Andrew Burgess  <andrew.burgess@embecosm.com>\n+\n+\t* gdb.tui/basic.exp: Add more scrolling tests.\n+\n 2020-01-09  Tom Tromey  <tom@tromey.com>\n \n \tPR tui/18932:"
    },
    {
      "sha": "34e60384c4ede1fbf235173b97119ccd1daf1422",
      "filename": "gdb/testsuite/gdb.tui/basic.exp",
      "status": "modified",
      "additions": 27,
      "deletions": 0,
      "changes": 27,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f5a7c406b1975cde626efed526960f2cf1bdaceb/gdb/testsuite/gdb.tui/basic.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f5a7c406b1975cde626efed526960f2cf1bdaceb/gdb/testsuite/gdb.tui/basic.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/testsuite/gdb.tui/basic.exp?ref=f5a7c406b1975cde626efed526960f2cf1bdaceb",
      "patch": "@@ -48,6 +48,33 @@ if {[Term::wait_for [string_to_regexp $line]] \\\n     fail \"scroll up\"\n }\n \n+# Check the horizontal scrolling.  First confirm that 'main ()' is\n+# where we expect it to be.  This relies on the current way we\n+# position source code on the screen, which might change in the\n+# future.  The important part of this test is detecting the left/right\n+# scrolling, not which line main is actually on.\n+set line_num 6\n+set line [Term::get_line $line_num]\n+gdb_assert {[regexp -- \"19\\[\\\\t \\]+main \\\\(\\\\)\" $line]} \\\n+    \"check main is where we expect on the screen\"\n+set regexp \"19\\[\\\\t \\]+ain \\\\(\\\\)\"\n+# Send a right arrow.\n+send_gdb \"\\033\\[C\"\n+if {[Term::wait_for $regexp]} {\n+    pass \"scroll right\"\n+} else {\n+    fail \"scroll right\"\n+}\n+set line [Term::get_line $line_num]\n+# Send a down arrow.\n+send_gdb \"\\033\\[B\"\n+if {[Term::wait_for $regexp] \\\n+\t&& [Term::get_line [expr {$line_num - 1}]] == $line} {\n+    pass \"scroll down\"\n+} else {\n+    fail \"scroll down\"\n+}\n+\n Term::check_box \"source box\" 0 0 80 15\n \n Term::command \"layout asm\""
    },
    {
      "sha": "912eaa4544018b44988a55373149d561500c4fb1",
      "filename": "gdb/tui/tui-source.c",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/f5a7c406b1975cde626efed526960f2cf1bdaceb/gdb/tui/tui-source.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/f5a7c406b1975cde626efed526960f2cf1bdaceb/gdb/tui/tui-source.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-source.c?ref=f5a7c406b1975cde626efed526960f2cf1bdaceb",
      "patch": "@@ -158,7 +158,9 @@ tui_source_window::do_scroll_vertical (int num_to_scroll)\n \tline_no = 1;\n \n       cursal.line = line_no;\n-      update_source_window (arch, cursal);\n+      find_line_pc (cursal.symtab, cursal.line, &cursal.pc);\n+      for (struct tui_source_window_base *win_info : tui_source_windows ())\n+\twin_info->update_source_window_as_is (arch, cursal);\n     }\n }\n "
    }
  ]
}