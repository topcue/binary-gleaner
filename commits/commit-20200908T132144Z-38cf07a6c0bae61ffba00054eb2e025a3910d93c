{
  "sha": "38cf07a6c0bae61ffba00054eb2e025a3910d93c",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MzhjZjA3YTZjMGJhZTYxZmZiYTAwMDU0ZWIyZTAyNWEzOTEwZDkzYw==",
  "commit": {
    "author": {
      "name": "Alex Coplan",
      "email": "alex.coplan@arm.com",
      "date": "2020-09-08T13:21:44Z"
    },
    "committer": {
      "name": "Alex Coplan",
      "email": "alex.coplan@arm.com",
      "date": "2020-09-08T13:21:44Z"
    },
    "message": "aarch64: Add support for Armv8-R system registers\n\nThis patch adds support for the system registers introduced in Armv8-R\nAArch64.\n\ngas/ChangeLog:\n\n2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n\n\t* config/tc-aarch64.c (parse_sys_reg): Also pass sysreg name to\n\tvalidation function.\n\t(parse_sys_ins_reg): Likewise.\n\t(print_operands): Pass CPU features to aarch64_print_operand().\n\t* testsuite/gas/aarch64/v8-r-bad-sysregs.d: New test.\n\t* testsuite/gas/aarch64/v8-r-bad-sysregs.l: Error output.\n\t* testsuite/gas/aarch64/v8-r-bad-sysregs.s: Input.\n\t* testsuite/gas/aarch64/v8-r-sysregs-need-arch.d: New test.\n\t* testsuite/gas/aarch64/v8-r-sysregs-need-arch.l: Error output.\n\t* testsuite/gas/aarch64/v8-r-sysregs.d: New test.\n\t* testsuite/gas/aarch64/v8-r-sysregs.s: Input for previous two tests.\n\ninclude/ChangeLog:\n\n2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n\n\t* opcode/aarch64.h (aarch64_sys_ins_reg_supported_p): Also take\n\tsystem register name in order to simplify validation for v8-R.\n\t(aarch64_print_operand): Also take CPU feature set, as disassembly for\n\tsystem registers now depends on arch variant.\n\nopcodes/ChangeLog:\n\n2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n\n\t* aarch64-dis.c (print_operands): Pass CPU features to\n\taarch64_print_operand().\n\t* aarch64-opc.c (aarch64_print_operand): Use CPU features to determine\n\tpreferred disassembly of system registers.\n\t(SR_RNG): Refactor to use new SR_FEAT2 macro.\n\t(SR_FEAT2): New.\n\t(SR_V8_1_A): New.\n\t(SR_V8_4_A): New.\n\t(SR_V8_A): New.\n\t(SR_V8_R): New.\n\t(SR_EXPAND_ELx): New.\n\t(SR_EXPAND_EL12): New.\n\t(aarch64_sys_regs): Specify which registers are only on\n\tA-profile, add R-profile system registers.\n\t(ENC_BARLAR): New.\n\t(PRBARn_ELx): New.\n\t(PRLARn_ELx): New.\n\t(aarch64_sys_ins_reg_supported_p): Reject EL3 registers for\n\tArmv8-R AArch64.",
    "tree": {
      "sha": "75a79a84fe501e5219678206e063b29f15655030",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/75a79a84fe501e5219678206e063b29f15655030"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/38cf07a6c0bae61ffba00054eb2e025a3910d93c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/38cf07a6c0bae61ffba00054eb2e025a3910d93c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/38cf07a6c0bae61ffba00054eb2e025a3910d93c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/38cf07a6c0bae61ffba00054eb2e025a3910d93c/comments",
  "author": {
    "login": "acoplan-arm",
    "id": 86676934,
    "node_id": "MDQ6VXNlcjg2Njc2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/86676934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/acoplan-arm",
    "html_url": "https://github.com/acoplan-arm",
    "followers_url": "https://api.github.com/users/acoplan-arm/followers",
    "following_url": "https://api.github.com/users/acoplan-arm/following{/other_user}",
    "gists_url": "https://api.github.com/users/acoplan-arm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/acoplan-arm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/acoplan-arm/subscriptions",
    "organizations_url": "https://api.github.com/users/acoplan-arm/orgs",
    "repos_url": "https://api.github.com/users/acoplan-arm/repos",
    "events_url": "https://api.github.com/users/acoplan-arm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/acoplan-arm/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "acoplan-arm",
    "id": 86676934,
    "node_id": "MDQ6VXNlcjg2Njc2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/86676934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/acoplan-arm",
    "html_url": "https://github.com/acoplan-arm",
    "followers_url": "https://api.github.com/users/acoplan-arm/followers",
    "following_url": "https://api.github.com/users/acoplan-arm/following{/other_user}",
    "gists_url": "https://api.github.com/users/acoplan-arm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/acoplan-arm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/acoplan-arm/subscriptions",
    "organizations_url": "https://api.github.com/users/acoplan-arm/orgs",
    "repos_url": "https://api.github.com/users/acoplan-arm/repos",
    "events_url": "https://api.github.com/users/acoplan-arm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/acoplan-arm/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "03fb3142c71fde91531ca39f33413bdf50a8dfb3",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/03fb3142c71fde91531ca39f33413bdf50a8dfb3",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/03fb3142c71fde91531ca39f33413bdf50a8dfb3"
    }
  ],
  "stats": {
    "total": 613,
    "additions": 597,
    "deletions": 16
  },
  "files": [
    {
      "sha": "2c09ca22e82783cc1d6ffca70abec9887ee6f250",
      "filename": "gas/ChangeLog",
      "status": "modified",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/ChangeLog?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -1,3 +1,17 @@\n+2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n+\n+\t* config/tc-aarch64.c (parse_sys_reg): Also pass sysreg name to\n+\tvalidation function.\n+\t(parse_sys_ins_reg): Likewise.\n+\t(print_operands): Pass CPU features to aarch64_print_operand().\n+\t* testsuite/gas/aarch64/v8-r-bad-sysregs.d: New test.\n+\t* testsuite/gas/aarch64/v8-r-bad-sysregs.l: Error output.\n+\t* testsuite/gas/aarch64/v8-r-bad-sysregs.s: Input.\n+\t* testsuite/gas/aarch64/v8-r-sysregs-need-arch.d: New test.\n+\t* testsuite/gas/aarch64/v8-r-sysregs-need-arch.l: Error output.\n+\t* testsuite/gas/aarch64/v8-r-sysregs.d: New test.\n+\t* testsuite/gas/aarch64/v8-r-sysregs.s: Input for previous two tests.\n+\n 2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n \n \t* testsuite/gas/aarch64/dfb.d: New test."
    },
    {
      "sha": "b2a1683efd24dbbf7bc121429b10bde8c6004cc6",
      "filename": "gas/config/tc-aarch64.c",
      "status": "modified",
      "additions": 5,
      "deletions": 4,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/config/tc-aarch64.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/config/tc-aarch64.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/config/tc-aarch64.c?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -4141,8 +4141,8 @@ parse_sys_reg (char **str, htab_t sys_regs,\n \tas_bad (_(\"selected processor does not support PSTATE field \"\n \t\t  \"name '%s'\"), buf);\n       if (!pstatefield_p\n-\t  && !aarch64_sys_ins_reg_supported_p (cpu_variant, o->value,\n-\t\t\t\t\t       o->flags, o->features))\n+\t  && !aarch64_sys_ins_reg_supported_p (cpu_variant, o->name,\n+\t\t\t\t\t       o->value, o->flags, o->features))\n \tas_bad (_(\"selected processor does not support system register \"\n \t\t  \"name '%s'\"), buf);\n       if (aarch64_sys_reg_deprecated_p (o->flags))\n@@ -4183,7 +4183,8 @@ parse_sys_ins_reg (char **str, htab_t sys_ins_regs)\n   if (!o)\n     return NULL;\n \n-  if (!aarch64_sys_ins_reg_supported_p (cpu_variant, o->value, o->flags, 0))\n+  if (!aarch64_sys_ins_reg_supported_p (cpu_variant,\n+\t\t\t\t\to->name, o->value, o->flags, 0))\n     as_bad (_(\"selected processor does not support system register \"\n \t      \"name '%s'\"), buf);\n   if (aarch64_sys_reg_deprecated_p (o->flags))\n@@ -4715,7 +4716,7 @@ print_operands (char *buf, const aarch64_opcode *opcode,\n \n       /* Generate the operand string in STR.  */\n       aarch64_print_operand (str, sizeof (str), 0, opcode, opnds, i, NULL, NULL,\n-\t\t\t     NULL);\n+\t\t\t     NULL, cpu_variant);\n \n       /* Delimiter.  */\n       if (str[0] != '\\0')"
    },
    {
      "sha": "6677f3b6579786bcae91f0b7d2617df01bbc6ae9",
      "filename": "gas/testsuite/gas/aarch64/v8-r-bad-sysregs.d",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.d?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -0,0 +1,3 @@\n+#name: invalid system registers for Armv8-R AArch64\n+#source: v8-r-bad-sysregs.s\n+#error_output: v8-r-bad-sysregs.l"
    },
    {
      "sha": "51ac29852cd8cb305db1c13d2d6faadc4e6f9122",
      "filename": "gas/testsuite/gas/aarch64/v8-r-bad-sysregs.l",
      "status": "added",
      "additions": 14,
      "deletions": 0,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.l?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -0,0 +1,14 @@\n+[^:]*: Assembler messages:\n+.*: Error: selected processor does not support system register name 'sctlr_el3'\n+.*: Error: selected processor does not support system register name 'ttbr0_el3'\n+.*: Error: selected processor does not support system register name 'tcr_el3'\n+.*: Warning: specified register cannot be written to at operand 1 -- `msr mpuir_el1,x0'\n+.*: Warning: specified register cannot be written to at operand 1 -- `msr mpuir_el2,x0'\n+.*: Error: selected processor does not support system register name 'ttbr0_el2'\n+.*: Error: selected processor does not support system register name 'ttbr0_el2'\n+.*: Error: selected processor does not support system register name 'ttbr1_el2'\n+.*: Error: selected processor does not support system register name 'ttbr1_el2'\n+.*: Error: selected processor does not support system register name 'vsttbr_el2'\n+.*: Error: selected processor does not support system register name 'vsttbr_el2'\n+.*: Error: selected processor does not support system register name 'vttbr_el2'\n+.*: Error: selected processor does not support system register name 'vttbr_el2'"
    },
    {
      "sha": "1a8f488415d8487141f4b97e3eb5163e9d2d898d",
      "filename": "gas/testsuite/gas/aarch64/v8-r-bad-sysregs.s",
      "status": "added",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/v8-r-bad-sysregs.s?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -0,0 +1,23 @@\n+// Invalid system registers for Armv8-R AArch64\n+.arch armv8-r\n+\n+// No EL3 for Armv8-R\n+mrs x0, sctlr_el3\n+msr ttbr0_el3, x0\n+mrs x0, TCR_EL3\n+\n+msr mpuir_el1, x0 // write to read-only register\n+msr mpuir_el2, x0 // write to read-only register\n+\n+// Four sysregs are not in R-profile:\n+mrs x0, ttbr0_el2\n+msr ttbr0_el2, x0\n+\n+mrs x0, ttbr1_el2\n+msr ttbr1_el2, x0\n+\n+mrs x0, vsttbr_el2\n+msr vsttbr_el2, x0\n+\n+mrs x0, vttbr_el2\n+msr vttbr_el2, x0"
    },
    {
      "sha": "af8319697a7a3468a8861d8945254ed3184ec610",
      "filename": "gas/testsuite/gas/aarch64/v8-r-sysregs-need-arch.d",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-sysregs-need-arch.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-sysregs-need-arch.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/v8-r-sysregs-need-arch.d?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -0,0 +1,3 @@\n+#name: check that Armv8-R system registers are rejected without -march=armv8-r\n+#source: v8-r-sysregs.s\n+#error_output: v8-r-sysregs-need-arch.l"
    },
    {
      "sha": "a609afc724b450fbc42afffc96d1e31c136307d7",
      "filename": "gas/testsuite/gas/aarch64/v8-r-sysregs-need-arch.l",
      "status": "added",
      "additions": 141,
      "deletions": 0,
      "changes": 141,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-sysregs-need-arch.l",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-sysregs-need-arch.l",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/v8-r-sysregs-need-arch.l?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -0,0 +1,141 @@\n+[^:]*: Assembler messages:\n+.*: Error: selected processor does not support system register name 'mpuir_el1'\n+.*: Error: selected processor does not support system register name 'mpuir_el2'\n+.*: Error: selected processor does not support system register name 'prbar_el1'\n+.*: Error: selected processor does not support system register name 'prbar_el1'\n+.*: Error: selected processor does not support system register name 'prbar_el2'\n+.*: Error: selected processor does not support system register name 'prbar_el2'\n+.*: Error: selected processor does not support system register name 'prbar1_el1'\n+.*: Error: selected processor does not support system register name 'prbar1_el1'\n+.*: Error: selected processor does not support system register name 'prbar2_el1'\n+.*: Error: selected processor does not support system register name 'prbar2_el1'\n+.*: Error: selected processor does not support system register name 'prbar3_el1'\n+.*: Error: selected processor does not support system register name 'prbar3_el1'\n+.*: Error: selected processor does not support system register name 'prbar4_el1'\n+.*: Error: selected processor does not support system register name 'prbar4_el1'\n+.*: Error: selected processor does not support system register name 'prbar5_el1'\n+.*: Error: selected processor does not support system register name 'prbar5_el1'\n+.*: Error: selected processor does not support system register name 'prbar6_el1'\n+.*: Error: selected processor does not support system register name 'prbar6_el1'\n+.*: Error: selected processor does not support system register name 'prbar7_el1'\n+.*: Error: selected processor does not support system register name 'prbar7_el1'\n+.*: Error: selected processor does not support system register name 'prbar8_el1'\n+.*: Error: selected processor does not support system register name 'prbar8_el1'\n+.*: Error: selected processor does not support system register name 'prbar9_el1'\n+.*: Error: selected processor does not support system register name 'prbar9_el1'\n+.*: Error: selected processor does not support system register name 'prbar10_el1'\n+.*: Error: selected processor does not support system register name 'prbar10_el1'\n+.*: Error: selected processor does not support system register name 'prbar11_el1'\n+.*: Error: selected processor does not support system register name 'prbar11_el1'\n+.*: Error: selected processor does not support system register name 'prbar12_el1'\n+.*: Error: selected processor does not support system register name 'prbar12_el1'\n+.*: Error: selected processor does not support system register name 'prbar13_el1'\n+.*: Error: selected processor does not support system register name 'prbar13_el1'\n+.*: Error: selected processor does not support system register name 'prbar14_el1'\n+.*: Error: selected processor does not support system register name 'prbar14_el1'\n+.*: Error: selected processor does not support system register name 'prbar15_el1'\n+.*: Error: selected processor does not support system register name 'prbar15_el1'\n+.*: Error: selected processor does not support system register name 'prbar1_el2'\n+.*: Error: selected processor does not support system register name 'prbar1_el2'\n+.*: Error: selected processor does not support system register name 'prbar2_el2'\n+.*: Error: selected processor does not support system register name 'prbar2_el2'\n+.*: Error: selected processor does not support system register name 'prbar3_el2'\n+.*: Error: selected processor does not support system register name 'prbar3_el2'\n+.*: Error: selected processor does not support system register name 'prbar4_el2'\n+.*: Error: selected processor does not support system register name 'prbar4_el2'\n+.*: Error: selected processor does not support system register name 'prbar5_el2'\n+.*: Error: selected processor does not support system register name 'prbar5_el2'\n+.*: Error: selected processor does not support system register name 'prbar6_el2'\n+.*: Error: selected processor does not support system register name 'prbar6_el2'\n+.*: Error: selected processor does not support system register name 'prbar7_el2'\n+.*: Error: selected processor does not support system register name 'prbar7_el2'\n+.*: Error: selected processor does not support system register name 'prbar8_el2'\n+.*: Error: selected processor does not support system register name 'prbar8_el2'\n+.*: Error: selected processor does not support system register name 'prbar9_el2'\n+.*: Error: selected processor does not support system register name 'prbar9_el2'\n+.*: Error: selected processor does not support system register name 'prbar10_el2'\n+.*: Error: selected processor does not support system register name 'prbar10_el2'\n+.*: Error: selected processor does not support system register name 'prbar11_el2'\n+.*: Error: selected processor does not support system register name 'prbar11_el2'\n+.*: Error: selected processor does not support system register name 'prbar12_el2'\n+.*: Error: selected processor does not support system register name 'prbar12_el2'\n+.*: Error: selected processor does not support system register name 'prbar13_el2'\n+.*: Error: selected processor does not support system register name 'prbar13_el2'\n+.*: Error: selected processor does not support system register name 'prbar14_el2'\n+.*: Error: selected processor does not support system register name 'prbar14_el2'\n+.*: Error: selected processor does not support system register name 'prbar15_el2'\n+.*: Error: selected processor does not support system register name 'prbar15_el2'\n+.*: Error: selected processor does not support system register name 'prenr_el1'\n+.*: Error: selected processor does not support system register name 'prenr_el1'\n+.*: Error: selected processor does not support system register name 'prenr_el2'\n+.*: Error: selected processor does not support system register name 'prenr_el2'\n+.*: Error: selected processor does not support system register name 'prlar_el1'\n+.*: Error: selected processor does not support system register name 'prlar_el1'\n+.*: Error: selected processor does not support system register name 'prlar_el2'\n+.*: Error: selected processor does not support system register name 'prlar_el2'\n+.*: Error: selected processor does not support system register name 'prlar1_el1'\n+.*: Error: selected processor does not support system register name 'prlar1_el1'\n+.*: Error: selected processor does not support system register name 'prlar2_el1'\n+.*: Error: selected processor does not support system register name 'prlar2_el1'\n+.*: Error: selected processor does not support system register name 'prlar3_el1'\n+.*: Error: selected processor does not support system register name 'prlar3_el1'\n+.*: Error: selected processor does not support system register name 'prlar4_el1'\n+.*: Error: selected processor does not support system register name 'prlar4_el1'\n+.*: Error: selected processor does not support system register name 'prlar5_el1'\n+.*: Error: selected processor does not support system register name 'prlar5_el1'\n+.*: Error: selected processor does not support system register name 'prlar6_el1'\n+.*: Error: selected processor does not support system register name 'prlar6_el1'\n+.*: Error: selected processor does not support system register name 'prlar7_el1'\n+.*: Error: selected processor does not support system register name 'prlar7_el1'\n+.*: Error: selected processor does not support system register name 'prlar8_el1'\n+.*: Error: selected processor does not support system register name 'prlar8_el1'\n+.*: Error: selected processor does not support system register name 'prlar9_el1'\n+.*: Error: selected processor does not support system register name 'prlar9_el1'\n+.*: Error: selected processor does not support system register name 'prlar10_el1'\n+.*: Error: selected processor does not support system register name 'prlar10_el1'\n+.*: Error: selected processor does not support system register name 'prlar11_el1'\n+.*: Error: selected processor does not support system register name 'prlar11_el1'\n+.*: Error: selected processor does not support system register name 'prlar12_el1'\n+.*: Error: selected processor does not support system register name 'prlar12_el1'\n+.*: Error: selected processor does not support system register name 'prlar13_el1'\n+.*: Error: selected processor does not support system register name 'prlar13_el1'\n+.*: Error: selected processor does not support system register name 'prlar14_el1'\n+.*: Error: selected processor does not support system register name 'prlar14_el1'\n+.*: Error: selected processor does not support system register name 'prlar15_el1'\n+.*: Error: selected processor does not support system register name 'prlar15_el1'\n+.*: Error: selected processor does not support system register name 'prlar1_el2'\n+.*: Error: selected processor does not support system register name 'prlar1_el2'\n+.*: Error: selected processor does not support system register name 'prlar2_el2'\n+.*: Error: selected processor does not support system register name 'prlar2_el2'\n+.*: Error: selected processor does not support system register name 'prlar3_el2'\n+.*: Error: selected processor does not support system register name 'prlar3_el2'\n+.*: Error: selected processor does not support system register name 'prlar4_el2'\n+.*: Error: selected processor does not support system register name 'prlar4_el2'\n+.*: Error: selected processor does not support system register name 'prlar5_el2'\n+.*: Error: selected processor does not support system register name 'prlar5_el2'\n+.*: Error: selected processor does not support system register name 'prlar6_el2'\n+.*: Error: selected processor does not support system register name 'prlar6_el2'\n+.*: Error: selected processor does not support system register name 'prlar7_el2'\n+.*: Error: selected processor does not support system register name 'prlar7_el2'\n+.*: Error: selected processor does not support system register name 'prlar8_el2'\n+.*: Error: selected processor does not support system register name 'prlar8_el2'\n+.*: Error: selected processor does not support system register name 'prlar9_el2'\n+.*: Error: selected processor does not support system register name 'prlar9_el2'\n+.*: Error: selected processor does not support system register name 'prlar10_el2'\n+.*: Error: selected processor does not support system register name 'prlar10_el2'\n+.*: Error: selected processor does not support system register name 'prlar11_el2'\n+.*: Error: selected processor does not support system register name 'prlar11_el2'\n+.*: Error: selected processor does not support system register name 'prlar12_el2'\n+.*: Error: selected processor does not support system register name 'prlar12_el2'\n+.*: Error: selected processor does not support system register name 'prlar13_el2'\n+.*: Error: selected processor does not support system register name 'prlar13_el2'\n+.*: Error: selected processor does not support system register name 'prlar14_el2'\n+.*: Error: selected processor does not support system register name 'prlar14_el2'\n+.*: Error: selected processor does not support system register name 'prlar15_el2'\n+.*: Error: selected processor does not support system register name 'prlar15_el2'\n+.*: Error: selected processor does not support system register name 'prselr_el1'\n+.*: Error: selected processor does not support system register name 'prselr_el1'\n+.*: Error: selected processor does not support system register name 'prselr_el2'\n+.*: Error: selected processor does not support system register name 'prselr_el2'\n+.*: Error: selected processor does not support system register name 'vsctlr_el2'\n+.*: Error: selected processor does not support system register name 'vsctlr_el2'"
    },
    {
      "sha": "aa8321e187b2800922bfdf826ccf783a95f75d83",
      "filename": "gas/testsuite/gas/aarch64/v8-r-sysregs.d",
      "status": "added",
      "additions": 149,
      "deletions": 0,
      "changes": 149,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-sysregs.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-sysregs.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/v8-r-sysregs.d?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -0,0 +1,149 @@\n+#name: Exhaustive test of Armv8-R system registers\n+#as: -march=armv8-r\n+#objdump: -dr -m aarch64:armv8-r\n+\n+.*:     file format .*\n+\n+Disassembly of section \\.text:\n+\n+0+ <.*>:\n+.*:\td5380080 \tmrs\tx0, mpuir_el1\n+.*:\td53c0080 \tmrs\tx0, mpuir_el2\n+.*:\td5386800 \tmrs\tx0, prbar_el1\n+.*:\td5186800 \tmsr\tprbar_el1, x0\n+.*:\td53c6800 \tmrs\tx0, prbar_el2\n+.*:\td51c6800 \tmsr\tprbar_el2, x0\n+.*:\td5386880 \tmrs\tx0, prbar1_el1\n+.*:\td5186880 \tmsr\tprbar1_el1, x0\n+.*:\td5386900 \tmrs\tx0, prbar2_el1\n+.*:\td5186900 \tmsr\tprbar2_el1, x0\n+.*:\td5386980 \tmrs\tx0, prbar3_el1\n+.*:\td5186980 \tmsr\tprbar3_el1, x0\n+.*:\td5386a00 \tmrs\tx0, prbar4_el1\n+.*:\td5186a00 \tmsr\tprbar4_el1, x0\n+.*:\td5386a80 \tmrs\tx0, prbar5_el1\n+.*:\td5186a80 \tmsr\tprbar5_el1, x0\n+.*:\td5386b00 \tmrs\tx0, prbar6_el1\n+.*:\td5186b00 \tmsr\tprbar6_el1, x0\n+.*:\td5386b80 \tmrs\tx0, prbar7_el1\n+.*:\td5186b80 \tmsr\tprbar7_el1, x0\n+.*:\td5386c00 \tmrs\tx0, prbar8_el1\n+.*:\td5186c00 \tmsr\tprbar8_el1, x0\n+.*:\td5386c80 \tmrs\tx0, prbar9_el1\n+.*:\td5186c80 \tmsr\tprbar9_el1, x0\n+.*:\td5386d00 \tmrs\tx0, prbar10_el1\n+.*:\td5186d00 \tmsr\tprbar10_el1, x0\n+.*:\td5386d80 \tmrs\tx0, prbar11_el1\n+.*:\td5186d80 \tmsr\tprbar11_el1, x0\n+.*:\td5386e00 \tmrs\tx0, prbar12_el1\n+.*:\td5186e00 \tmsr\tprbar12_el1, x0\n+.*:\td5386e80 \tmrs\tx0, prbar13_el1\n+.*:\td5186e80 \tmsr\tprbar13_el1, x0\n+.*:\td5386f00 \tmrs\tx0, prbar14_el1\n+.*:\td5186f00 \tmsr\tprbar14_el1, x0\n+.*:\td5386f80 \tmrs\tx0, prbar15_el1\n+.*:\td5186f80 \tmsr\tprbar15_el1, x0\n+.*:\td53c6880 \tmrs\tx0, prbar1_el2\n+.*:\td51c6880 \tmsr\tprbar1_el2, x0\n+.*:\td53c6900 \tmrs\tx0, prbar2_el2\n+.*:\td51c6900 \tmsr\tprbar2_el2, x0\n+.*:\td53c6980 \tmrs\tx0, prbar3_el2\n+.*:\td51c6980 \tmsr\tprbar3_el2, x0\n+.*:\td53c6a00 \tmrs\tx0, prbar4_el2\n+.*:\td51c6a00 \tmsr\tprbar4_el2, x0\n+.*:\td53c6a80 \tmrs\tx0, prbar5_el2\n+.*:\td51c6a80 \tmsr\tprbar5_el2, x0\n+.*:\td53c6b00 \tmrs\tx0, prbar6_el2\n+.*:\td51c6b00 \tmsr\tprbar6_el2, x0\n+.*:\td53c6b80 \tmrs\tx0, prbar7_el2\n+.*:\td51c6b80 \tmsr\tprbar7_el2, x0\n+.*:\td53c6c00 \tmrs\tx0, prbar8_el2\n+.*:\td51c6c00 \tmsr\tprbar8_el2, x0\n+.*:\td53c6c80 \tmrs\tx0, prbar9_el2\n+.*:\td51c6c80 \tmsr\tprbar9_el2, x0\n+.*:\td53c6d00 \tmrs\tx0, prbar10_el2\n+.*:\td51c6d00 \tmsr\tprbar10_el2, x0\n+.*:\td53c6d80 \tmrs\tx0, prbar11_el2\n+.*:\td51c6d80 \tmsr\tprbar11_el2, x0\n+.*:\td53c6e00 \tmrs\tx0, prbar12_el2\n+.*:\td51c6e00 \tmsr\tprbar12_el2, x0\n+.*:\td53c6e80 \tmrs\tx0, prbar13_el2\n+.*:\td51c6e80 \tmsr\tprbar13_el2, x0\n+.*:\td53c6f00 \tmrs\tx0, prbar14_el2\n+.*:\td51c6f00 \tmsr\tprbar14_el2, x0\n+.*:\td53c6f80 \tmrs\tx0, prbar15_el2\n+.*:\td51c6f80 \tmsr\tprbar15_el2, x0\n+.*:\td5386120 \tmrs\tx0, prenr_el1\n+.*:\td5186120 \tmsr\tprenr_el1, x0\n+.*:\td53c6120 \tmrs\tx0, prenr_el2\n+.*:\td51c6120 \tmsr\tprenr_el2, x0\n+.*:\td5386820 \tmrs\tx0, prlar_el1\n+.*:\td5186820 \tmsr\tprlar_el1, x0\n+.*:\td53c6820 \tmrs\tx0, prlar_el2\n+.*:\td51c6820 \tmsr\tprlar_el2, x0\n+.*:\td53868a0 \tmrs\tx0, prlar1_el1\n+.*:\td51868a0 \tmsr\tprlar1_el1, x0\n+.*:\td5386920 \tmrs\tx0, prlar2_el1\n+.*:\td5186920 \tmsr\tprlar2_el1, x0\n+.*:\td53869a0 \tmrs\tx0, prlar3_el1\n+.*:\td51869a0 \tmsr\tprlar3_el1, x0\n+.*:\td5386a20 \tmrs\tx0, prlar4_el1\n+.*:\td5186a20 \tmsr\tprlar4_el1, x0\n+.*:\td5386aa0 \tmrs\tx0, prlar5_el1\n+.*:\td5186aa0 \tmsr\tprlar5_el1, x0\n+.*:\td5386b20 \tmrs\tx0, prlar6_el1\n+.*:\td5186b20 \tmsr\tprlar6_el1, x0\n+.*:\td5386ba0 \tmrs\tx0, prlar7_el1\n+.*:\td5186ba0 \tmsr\tprlar7_el1, x0\n+.*:\td5386c20 \tmrs\tx0, prlar8_el1\n+.*:\td5186c20 \tmsr\tprlar8_el1, x0\n+.*:\td5386ca0 \tmrs\tx0, prlar9_el1\n+.*:\td5186ca0 \tmsr\tprlar9_el1, x0\n+.*:\td5386d20 \tmrs\tx0, prlar10_el1\n+.*:\td5186d20 \tmsr\tprlar10_el1, x0\n+.*:\td5386da0 \tmrs\tx0, prlar11_el1\n+.*:\td5186da0 \tmsr\tprlar11_el1, x0\n+.*:\td5386e20 \tmrs\tx0, prlar12_el1\n+.*:\td5186e20 \tmsr\tprlar12_el1, x0\n+.*:\td5386ea0 \tmrs\tx0, prlar13_el1\n+.*:\td5186ea0 \tmsr\tprlar13_el1, x0\n+.*:\td5386f20 \tmrs\tx0, prlar14_el1\n+.*:\td5186f20 \tmsr\tprlar14_el1, x0\n+.*:\td5386fa0 \tmrs\tx0, prlar15_el1\n+.*:\td5186fa0 \tmsr\tprlar15_el1, x0\n+.*:\td53c68a0 \tmrs\tx0, prlar1_el2\n+.*:\td51c68a0 \tmsr\tprlar1_el2, x0\n+.*:\td53c6920 \tmrs\tx0, prlar2_el2\n+.*:\td51c6920 \tmsr\tprlar2_el2, x0\n+.*:\td53c69a0 \tmrs\tx0, prlar3_el2\n+.*:\td51c69a0 \tmsr\tprlar3_el2, x0\n+.*:\td53c6a20 \tmrs\tx0, prlar4_el2\n+.*:\td51c6a20 \tmsr\tprlar4_el2, x0\n+.*:\td53c6aa0 \tmrs\tx0, prlar5_el2\n+.*:\td51c6aa0 \tmsr\tprlar5_el2, x0\n+.*:\td53c6b20 \tmrs\tx0, prlar6_el2\n+.*:\td51c6b20 \tmsr\tprlar6_el2, x0\n+.*:\td53c6ba0 \tmrs\tx0, prlar7_el2\n+.*:\td51c6ba0 \tmsr\tprlar7_el2, x0\n+.*:\td53c6c20 \tmrs\tx0, prlar8_el2\n+.*:\td51c6c20 \tmsr\tprlar8_el2, x0\n+.*:\td53c6ca0 \tmrs\tx0, prlar9_el2\n+.*:\td51c6ca0 \tmsr\tprlar9_el2, x0\n+.*:\td53c6d20 \tmrs\tx0, prlar10_el2\n+.*:\td51c6d20 \tmsr\tprlar10_el2, x0\n+.*:\td53c6da0 \tmrs\tx0, prlar11_el2\n+.*:\td51c6da0 \tmsr\tprlar11_el2, x0\n+.*:\td53c6e20 \tmrs\tx0, prlar12_el2\n+.*:\td51c6e20 \tmsr\tprlar12_el2, x0\n+.*:\td53c6ea0 \tmrs\tx0, prlar13_el2\n+.*:\td51c6ea0 \tmsr\tprlar13_el2, x0\n+.*:\td53c6f20 \tmrs\tx0, prlar14_el2\n+.*:\td51c6f20 \tmsr\tprlar14_el2, x0\n+.*:\td53c6fa0 \tmrs\tx0, prlar15_el2\n+.*:\td51c6fa0 \tmsr\tprlar15_el2, x0\n+.*:\td5386220 \tmrs\tx0, prselr_el1\n+.*:\td5186220 \tmsr\tprselr_el1, x0\n+.*:\td53c6220 \tmrs\tx0, prselr_el2\n+.*:\td51c6220 \tmsr\tprselr_el2, x0\n+.*:\td53c2000 \tmrs\tx0, vsctlr_el2\n+.*:\td51c2000 \tmsr\tvsctlr_el2, x0"
    },
    {
      "sha": "76c80bd647076afc9e98581a94d6787da2ff345a",
      "filename": "gas/testsuite/gas/aarch64/v8-r-sysregs.s",
      "status": "added",
      "additions": 141,
      "deletions": 0,
      "changes": 141,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-sysregs.s",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/gas/testsuite/gas/aarch64/v8-r-sysregs.s",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gas/testsuite/gas/aarch64/v8-r-sysregs.s?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -0,0 +1,141 @@\n+// Armv8-R system registers\n+mrs x0, mpuir_el1\n+mrs x0, mpuir_el2\n+mrs x0, prbar_el1\n+msr prbar_el1, x0\n+mrs x0, prbar_el2\n+msr prbar_el2, x0\n+mrs x0, prbar1_el1\n+msr prbar1_el1, x0\n+mrs x0, prbar2_el1\n+msr prbar2_el1, x0\n+mrs x0, prbar3_el1\n+msr prbar3_el1, x0\n+mrs x0, prbar4_el1\n+msr prbar4_el1, x0\n+mrs x0, prbar5_el1\n+msr prbar5_el1, x0\n+mrs x0, prbar6_el1\n+msr prbar6_el1, x0\n+mrs x0, prbar7_el1\n+msr prbar7_el1, x0\n+mrs x0, prbar8_el1\n+msr prbar8_el1, x0\n+mrs x0, prbar9_el1\n+msr prbar9_el1, x0\n+mrs x0, prbar10_el1\n+msr prbar10_el1, x0\n+mrs x0, prbar11_el1\n+msr prbar11_el1, x0\n+mrs x0, prbar12_el1\n+msr prbar12_el1, x0\n+mrs x0, prbar13_el1\n+msr prbar13_el1, x0\n+mrs x0, prbar14_el1\n+msr prbar14_el1, x0\n+mrs x0, prbar15_el1\n+msr prbar15_el1, x0\n+mrs x0, prbar1_el2\n+msr prbar1_el2, x0\n+mrs x0, prbar2_el2\n+msr prbar2_el2, x0\n+mrs x0, prbar3_el2\n+msr prbar3_el2, x0\n+mrs x0, prbar4_el2\n+msr prbar4_el2, x0\n+mrs x0, prbar5_el2\n+msr prbar5_el2, x0\n+mrs x0, prbar6_el2\n+msr prbar6_el2, x0\n+mrs x0, prbar7_el2\n+msr prbar7_el2, x0\n+mrs x0, prbar8_el2\n+msr prbar8_el2, x0\n+mrs x0, prbar9_el2\n+msr prbar9_el2, x0\n+mrs x0, prbar10_el2\n+msr prbar10_el2, x0\n+mrs x0, prbar11_el2\n+msr prbar11_el2, x0\n+mrs x0, prbar12_el2\n+msr prbar12_el2, x0\n+mrs x0, prbar13_el2\n+msr prbar13_el2, x0\n+mrs x0, prbar14_el2\n+msr prbar14_el2, x0\n+mrs x0, prbar15_el2\n+msr prbar15_el2, x0\n+mrs x0, prenr_el1\n+msr prenr_el1, x0\n+mrs x0, prenr_el2\n+msr prenr_el2, x0\n+mrs x0, prlar_el1\n+msr prlar_el1, x0\n+mrs x0, prlar_el2\n+msr prlar_el2, x0\n+mrs x0, prlar1_el1\n+msr prlar1_el1, x0\n+mrs x0, prlar2_el1\n+msr prlar2_el1, x0\n+mrs x0, prlar3_el1\n+msr prlar3_el1, x0\n+mrs x0, prlar4_el1\n+msr prlar4_el1, x0\n+mrs x0, prlar5_el1\n+msr prlar5_el1, x0\n+mrs x0, prlar6_el1\n+msr prlar6_el1, x0\n+mrs x0, prlar7_el1\n+msr prlar7_el1, x0\n+mrs x0, prlar8_el1\n+msr prlar8_el1, x0\n+mrs x0, prlar9_el1\n+msr prlar9_el1, x0\n+mrs x0, prlar10_el1\n+msr prlar10_el1, x0\n+mrs x0, prlar11_el1\n+msr prlar11_el1, x0\n+mrs x0, prlar12_el1\n+msr prlar12_el1, x0\n+mrs x0, prlar13_el1\n+msr prlar13_el1, x0\n+mrs x0, prlar14_el1\n+msr prlar14_el1, x0\n+mrs x0, prlar15_el1\n+msr prlar15_el1, x0\n+mrs x0, prlar1_el2\n+msr prlar1_el2, x0\n+mrs x0, prlar2_el2\n+msr prlar2_el2, x0\n+mrs x0, prlar3_el2\n+msr prlar3_el2, x0\n+mrs x0, prlar4_el2\n+msr prlar4_el2, x0\n+mrs x0, prlar5_el2\n+msr prlar5_el2, x0\n+mrs x0, prlar6_el2\n+msr prlar6_el2, x0\n+mrs x0, prlar7_el2\n+msr prlar7_el2, x0\n+mrs x0, prlar8_el2\n+msr prlar8_el2, x0\n+mrs x0, prlar9_el2\n+msr prlar9_el2, x0\n+mrs x0, prlar10_el2\n+msr prlar10_el2, x0\n+mrs x0, prlar11_el2\n+msr prlar11_el2, x0\n+mrs x0, prlar12_el2\n+msr prlar12_el2, x0\n+mrs x0, prlar13_el2\n+msr prlar13_el2, x0\n+mrs x0, prlar14_el2\n+msr prlar14_el2, x0\n+mrs x0, prlar15_el2\n+msr prlar15_el2, x0\n+mrs x0, prselr_el1\n+msr prselr_el1, x0\n+mrs x0, prselr_el2\n+msr prselr_el2, x0\n+mrs x0, vsctlr_el2\n+msr vsctlr_el2, x0"
    },
    {
      "sha": "eff811641f11306f2c8185b131dbd372f19b6735",
      "filename": "include/ChangeLog",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/include/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/include/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/ChangeLog?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -1,3 +1,10 @@\n+2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n+\n+\t* opcode/aarch64.h (aarch64_sys_ins_reg_supported_p): Also take\n+\tsystem register name in order to simplify validation for v8-R.\n+\t(aarch64_print_operand): Also take CPU feature set, as disassembly for\n+\tsystem registers now depends on arch variant.\n+\n 2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n \n \t* opcode/aarch64.h (AARCH64_FEATURE_V8_A): New."
    },
    {
      "sha": "44626483c92a17bd949986e2d349bedec2c03f11",
      "filename": "include/opcode/aarch64.h",
      "status": "modified",
      "additions": 4,
      "deletions": 2,
      "changes": 6,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/include/opcode/aarch64.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/include/opcode/aarch64.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/include/opcode/aarch64.h?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -977,7 +977,8 @@ typedef struct\n \n extern bfd_boolean aarch64_sys_ins_reg_has_xt (const aarch64_sys_ins_reg *);\n extern bfd_boolean\n-aarch64_sys_ins_reg_supported_p (const aarch64_feature_set, aarch64_insn,\n+aarch64_sys_ins_reg_supported_p (const aarch64_feature_set,\n+\t\t\t\t const char *reg_name, aarch64_insn,\n                                  uint32_t, aarch64_feature_set);\n \n extern const aarch64_sys_ins_reg aarch64_sys_regs_ic [];\n@@ -1270,7 +1271,8 @@ aarch64_get_opcode (enum aarch64_op);\n extern void\n aarch64_print_operand (char *, size_t, bfd_vma, const aarch64_opcode *,\n \t\t       const aarch64_opnd_info *, int, int *, bfd_vma *,\n-\t\t       char **);\n+\t\t       char **,\n+\t\t       aarch64_feature_set features);\n \n /* Miscellaneous interface.  */\n "
    },
    {
      "sha": "adef90c8ba3d0026fa6fa513186aa42c7c87ef36",
      "filename": "opcodes/ChangeLog",
      "status": "modified",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/opcodes/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/opcodes/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/ChangeLog?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -1,3 +1,25 @@\n+2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n+\n+\t* aarch64-dis.c (print_operands): Pass CPU features to\n+\taarch64_print_operand().\n+\t* aarch64-opc.c (aarch64_print_operand): Use CPU features to determine\n+\tpreferred disassembly of system registers.\n+\t(SR_RNG): Refactor to use new SR_FEAT2 macro.\n+\t(SR_FEAT2): New.\n+\t(SR_V8_1_A): New.\n+\t(SR_V8_4_A): New.\n+\t(SR_V8_A): New.\n+\t(SR_V8_R): New.\n+\t(SR_EXPAND_ELx): New.\n+\t(SR_EXPAND_EL12): New.\n+\t(aarch64_sys_regs): Specify which registers are only on\n+\tA-profile, add R-profile system registers.\n+\t(ENC_BARLAR): New.\n+\t(PRBARn_ELx): New.\n+\t(PRLARn_ELx): New.\n+\t(aarch64_sys_ins_reg_supported_p): Reject EL3 registers for\n+\tArmv8-R AArch64.\n+\n 2020-09-08  Alex Coplan  <alex.coplan@arm.com>\n \n \t* aarch64-tbl.h (aarch64_feature_v8_r): New."
    },
    {
      "sha": "b6bc7e6235aa578b47361c353e94e00554d6bceb",
      "filename": "opcodes/aarch64-dis.c",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/opcodes/aarch64-dis.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/opcodes/aarch64-dis.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/aarch64-dis.c?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -3082,7 +3082,7 @@ print_operands (bfd_vma pc, const aarch64_opcode *opcode,\n \n       /* Generate the operand string in STR.  */\n       aarch64_print_operand (str, sizeof (str), pc, opcode, opnds, i, &pcrel_p,\n-\t\t\t     &info->target, &notes);\n+\t\t\t     &info->target, &notes, arch_variant);\n \n       /* Print the delimiter (taking account of omitted operand(s)).  */\n       if (str[0] != '\\0')"
    },
    {
      "sha": "22d69347946c4a7b37d07e632d9e57025ec26d23",
      "filename": "opcodes/aarch64-opc.c",
      "status": "modified",
      "additions": 70,
      "deletions": 9,
      "changes": 79,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/38cf07a6c0bae61ffba00054eb2e025a3910d93c/opcodes/aarch64-opc.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/38cf07a6c0bae61ffba00054eb2e025a3910d93c/opcodes/aarch64-opc.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/opcodes/aarch64-opc.c?ref=38cf07a6c0bae61ffba00054eb2e025a3910d93c",
      "patch": "@@ -3143,7 +3143,8 @@ void\n aarch64_print_operand (char *buf, size_t size, bfd_vma pc,\n \t\t       const aarch64_opcode *opcode,\n \t\t       const aarch64_opnd_info *opnds, int idx, int *pcrel_p,\n-\t\t       bfd_vma *address, char** notes)\n+\t\t       bfd_vma *address, char** notes,\n+\t\t       aarch64_feature_set features)\n {\n   unsigned int i, num_conds;\n   const char *name = NULL;\n@@ -3688,9 +3689,12 @@ aarch64_print_operand (char *buf, size_t size, bfd_vma pc,\n     case AARCH64_OPND_SYSREG:\n       for (i = 0; aarch64_sys_regs[i].name; ++i)\n \t{\n+\t  const aarch64_sys_reg *sr = aarch64_sys_regs + i;\n+\n \t  bfd_boolean exact_match\n-\t    = (aarch64_sys_regs[i].flags & opnd->sysreg.flags)\n-\t       == opnd->sysreg.flags;\n+\t    = (!(sr->flags & (F_REG_READ | F_REG_WRITE))\n+\t    || (sr->flags & opnd->sysreg.flags) == opnd->sysreg.flags)\n+\t    && AARCH64_CPU_HAS_FEATURE (features, sr->features);\n \n \t  /* Try and find an exact match, But if that fails, return the first\n \t     partial match that was found.  */\n@@ -3810,9 +3814,16 @@ aarch64_print_operand (char *buf, size_t size, bfd_vma pc,\n #define SR_FEAT(n,e,f,feat) \\\n   SYSREG ((n), (e), (f) | F_ARCHEXT, AARCH64_FEATURE_##feat)\n \n-#define SR_RNG(n,e,f) \\\n-  SYSREG ((n), (e), (f) | F_ARCHEXT, AARCH64_FEATURE_RNG | AARCH64_FEATURE_V8_5)\n+#define SR_FEAT2(n,e,f,fe1,fe2) \\\n+  SYSREG ((n), (e), (f) | F_ARCHEXT, \\\n+\t  AARCH64_FEATURE_##fe1 | AARCH64_FEATURE_##fe2)\n+\n+#define SR_RNG(n,e,f)\t SR_FEAT2(n,e,f,RNG,V8_5)\n+#define SR_V8_1_A(n,e,f) SR_FEAT2(n,e,f,V8_A,V8_1)\n+#define SR_V8_4_A(n,e,f) SR_FEAT2(n,e,f,V8_A,V8_4)\n \n+#define SR_V8_A(n,e,f)\t  SR_FEAT (n,e,f,V8_A)\n+#define SR_V8_R(n,e,f)\t  SR_FEAT (n,e,f,V8_R)\n #define SR_V8_1(n,e,f)\t  SR_FEAT (n,e,f,V8_1)\n #define SR_V8_2(n,e,f)\t  SR_FEAT (n,e,f,V8_2)\n #define SR_V8_3(n,e,f)\t  SR_FEAT (n,e,f,V8_3)\n@@ -3827,6 +3838,27 @@ aarch64_print_operand (char *buf, size_t size, bfd_vma pc,\n #define SR_MEMTAG(n,e,f)  SR_FEAT (n,e,f,MEMTAG)\n #define SR_SCXTNUM(n,e,f) SR_FEAT (n,e,f,SCXTNUM)\n \n+#define SR_EXPAND_ELx(f,x) \\\n+  f (x, 1),  \\\n+  f (x, 2),  \\\n+  f (x, 3),  \\\n+  f (x, 4),  \\\n+  f (x, 5),  \\\n+  f (x, 6),  \\\n+  f (x, 7),  \\\n+  f (x, 8),  \\\n+  f (x, 9),  \\\n+  f (x, 10), \\\n+  f (x, 11), \\\n+  f (x, 12), \\\n+  f (x, 13), \\\n+  f (x, 14), \\\n+  f (x, 15),\n+\n+#define SR_EXPAND_EL12(f) \\\n+  SR_EXPAND_ELx (f,1) \\\n+  SR_EXPAND_ELx (f,2)\n+\n /* TODO there is one more issues need to be resolved\n    1. handle cpu-implementation-defined system registers.\n \n@@ -3928,12 +3960,12 @@ const aarch64_sys_reg aarch64_sys_regs [] =\n   SR_SVE  (\"zidr_el1\",\t\tCPENC (3,0,C0,C0,7),\t0),\n   SR_CORE (\"ttbr0_el1\",\t\tCPENC (3,0,C2,C0,0),\t0),\n   SR_CORE (\"ttbr1_el1\",\t\tCPENC (3,0,C2,C0,1),\t0),\n-  SR_CORE (\"ttbr0_el2\",\t\tCPENC (3,4,C2,C0,0),\t0),\n-  SR_V8_1 (\"ttbr1_el2\",\t\tCPENC (3,4,C2,C0,1),\t0),\n+  SR_V8_A (\"ttbr0_el2\",\t\tCPENC (3,4,C2,C0,0),\t0),\n+  SR_V8_1_A (\"ttbr1_el2\",\tCPENC (3,4,C2,C0,1),\t0),\n   SR_CORE (\"ttbr0_el3\",\t\tCPENC (3,6,C2,C0,0),\t0),\n   SR_V8_1 (\"ttbr0_el12\",\tCPENC (3,5,C2,C0,0),\t0),\n   SR_V8_1 (\"ttbr1_el12\",\tCPENC (3,5,C2,C0,1),\t0),\n-  SR_CORE (\"vttbr_el2\",\t\tCPENC (3,4,C2,C1,0),\t0),\n+  SR_V8_A (\"vttbr_el2\",\t\tCPENC (3,4,C2,C1,0),\t0),\n   SR_CORE (\"tcr_el1\",\t\tCPENC (3,0,C2,C0,2),\t0),\n   SR_CORE (\"tcr_el2\",\t\tCPENC (3,4,C2,C0,2),\t0),\n   SR_CORE (\"tcr_el3\",\t\tCPENC (3,6,C2,C0,2),\t0),\n@@ -4231,7 +4263,7 @@ const aarch64_sys_reg aarch64_sys_regs [] =\n \n   SR_V8_4 (\"dit\",\t\tCPEN_ (3,C2,5),\t\t0),\n   SR_V8_4 (\"vstcr_el2\",\t\tCPENC (3,4,C2,C6,2),\t0),\n-  SR_V8_4 (\"vsttbr_el2\",\tCPENC (3,4,C2,C6,0),\t0),\n+  SR_V8_4_A (\"vsttbr_el2\",\tCPENC (3,4,C2,C6,0),\t0),\n   SR_V8_4 (\"cnthvs_tval_el2\",\tCPENC (3,4,C14,C4,0),\t0),\n   SR_V8_4 (\"cnthvs_cval_el2\",\tCPENC (3,4,C14,C4,2),\t0),\n   SR_V8_4 (\"cnthvs_ctl_el2\",\tCPENC (3,4,C14,C4,1),\t0),\n@@ -4258,6 +4290,27 @@ const aarch64_sys_reg aarch64_sys_regs [] =\n   SR_CORE (\"mpamvpm7_el2\",\tCPENC (3,4,C10,C6,7),\t0),\n   SR_CORE (\"mpamvpmv_el2\",\tCPENC (3,4,C10,C4,1),\t0),\n \n+  SR_V8_R (\"mpuir_el1\",\t\tCPENC (3,0,C0,C0,4),\tF_REG_READ),\n+  SR_V8_R (\"mpuir_el2\",\t\tCPENC (3,4,C0,C0,4),\tF_REG_READ),\n+  SR_V8_R (\"prbar_el1\",\t\tCPENC (3,0,C6,C8,0),\t0),\n+  SR_V8_R (\"prbar_el2\",\t\tCPENC (3,4,C6,C8,0),\t0),\n+\n+#define ENC_BARLAR(x,n,lar) \\\n+  CPENC (3, (x-1) << 2, C6, 8 | (n >> 1), ((n & 1) << 2) | lar)\n+\n+#define PRBARn_ELx(x,n) SR_V8_R (\"prbar\" #n \"_el\" #x, ENC_BARLAR (x,n,0), 0)\n+#define PRLARn_ELx(x,n) SR_V8_R (\"prlar\" #n \"_el\" #x, ENC_BARLAR (x,n,1), 0)\n+\n+  SR_EXPAND_EL12 (PRBARn_ELx)\n+  SR_V8_R (\"prenr_el1\",\t\tCPENC (3,0,C6,C1,1),\t0),\n+  SR_V8_R (\"prenr_el2\",\t\tCPENC (3,4,C6,C1,1),\t0),\n+  SR_V8_R (\"prlar_el1\",\t\tCPENC (3,0,C6,C8,1),\t0),\n+  SR_V8_R (\"prlar_el2\",\t\tCPENC (3,4,C6,C8,1),\t0),\n+  SR_EXPAND_EL12 (PRLARn_ELx)\n+  SR_V8_R (\"prselr_el1\",\tCPENC (3,0,C6,C2,1),\t0),\n+  SR_V8_R (\"prselr_el2\",\tCPENC (3,4,C6,C2,1),\t0),\n+  SR_V8_R (\"vsctlr_el2\",\tCPENC (3,4,C2,C0,0),\t0),\n+\n   { 0, CPENC (0,0,0,0,0), 0, 0 }\n };\n \n@@ -4462,10 +4515,18 @@ aarch64_sys_ins_reg_has_xt (const aarch64_sys_ins_reg *sys_ins_reg)\n \n extern bfd_boolean\n aarch64_sys_ins_reg_supported_p (const aarch64_feature_set features,\n+\t\t const char *reg_name,\n                  aarch64_insn reg_value,\n                  uint32_t reg_flags,\n                  aarch64_feature_set reg_features)\n {\n+  /* Armv8-R has no EL3.  */\n+  if (AARCH64_CPU_HAS_FEATURE (features, AARCH64_FEATURE_V8_R))\n+    {\n+      const char *suffix = strrchr (reg_name, '_');\n+      if (suffix && !strcmp (suffix, \"_el3\"))\n+\treturn FALSE;\n+    }\n \n   if (!(reg_flags & F_ARCHEXT))\n     return TRUE;"
    }
  ]
}