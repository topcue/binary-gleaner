{
  "sha": "2f267673f0fdee9287e6d404ecd4f2d29da0d2f2",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MmYyNjc2NzNmMGZkZWU5Mjg3ZTZkNDA0ZWNkNGYyZDI5ZGEwZDJmMg==",
  "commit": {
    "author": {
      "name": "Pedro Alves",
      "email": "palves@redhat.com",
      "date": "2020-01-11T01:37:26Z"
    },
    "committer": {
      "name": "Andrew Burgess",
      "email": "andrew.burgess@embecosm.com",
      "date": "2020-01-24T00:10:33Z"
    },
    "message": "gdb/tui: Prevent exceptions from trying to cross readline\n\nThis is triggered by simply scrolling off the end of the dissasembly\nwindow.  This commit doesn't fix the actual exception that is being\nthrown, which will still need to be fixed, but makes sure that we\ndon't ever throw an exception out to readline.\n\ngdb/ChangeLog:\nyyyy-mm-dd  Pedro Alves  <palves@redhat.com>\n\n        PR tui/9765\n        * tui/tui-io.c (tui_getc): Rename to ...\n        (tui_getc_1): ... this.\n        (tui_get): New, reimplent as try/catch wrapper around tui_getc_1.\n\nChange-Id: I2e32a401ab34404b2132ec82a3e1c17b9b723e41",
    "tree": {
      "sha": "c3bca4935c90db98be3db0b447883eaae28dd838",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/c3bca4935c90db98be3db0b447883eaae28dd838"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/2f267673f0fdee9287e6d404ecd4f2d29da0d2f2",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2f267673f0fdee9287e6d404ecd4f2d29da0d2f2",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/2f267673f0fdee9287e6d404ecd4f2d29da0d2f2",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/2f267673f0fdee9287e6d404ecd4f2d29da0d2f2/comments",
  "author": {
    "login": "palves",
    "id": 1202913,
    "node_id": "MDQ6VXNlcjEyMDI5MTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1202913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/palves",
    "html_url": "https://github.com/palves",
    "followers_url": "https://api.github.com/users/palves/followers",
    "following_url": "https://api.github.com/users/palves/following{/other_user}",
    "gists_url": "https://api.github.com/users/palves/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/palves/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/palves/subscriptions",
    "organizations_url": "https://api.github.com/users/palves/orgs",
    "repos_url": "https://api.github.com/users/palves/repos",
    "events_url": "https://api.github.com/users/palves/events{/privacy}",
    "received_events_url": "https://api.github.com/users/palves/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "T-J-Teru",
    "id": 475372,
    "node_id": "MDQ6VXNlcjQ3NTM3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/475372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/T-J-Teru",
    "html_url": "https://github.com/T-J-Teru",
    "followers_url": "https://api.github.com/users/T-J-Teru/followers",
    "following_url": "https://api.github.com/users/T-J-Teru/following{/other_user}",
    "gists_url": "https://api.github.com/users/T-J-Teru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/T-J-Teru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/T-J-Teru/subscriptions",
    "organizations_url": "https://api.github.com/users/T-J-Teru/orgs",
    "repos_url": "https://api.github.com/users/T-J-Teru/repos",
    "events_url": "https://api.github.com/users/T-J-Teru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/T-J-Teru/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a05d007dfee18aafc8f2c36ef7594e6554f2e1db",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/a05d007dfee18aafc8f2c36ef7594e6554f2e1db",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/a05d007dfee18aafc8f2c36ef7594e6554f2e1db"
    }
  ],
  "stats": {
    "total": 31,
    "additions": 28,
    "deletions": 3
  },
  "files": [
    {
      "sha": "d9f23334f57b707f70019ad2e51409dffee5747a",
      "filename": "gdb/tui/tui-io.c",
      "status": "modified",
      "additions": 28,
      "deletions": 3,
      "changes": 31,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/2f267673f0fdee9287e6d404ecd4f2d29da0d2f2/gdb/tui/tui-io.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/2f267673f0fdee9287e6d404ecd4f2d29da0d2f2/gdb/tui/tui-io.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/tui/tui-io.c?ref=2f267673f0fdee9287e6d404ecd4f2d29da0d2f2",
      "patch": "@@ -950,10 +950,12 @@ tui_dispatch_ctrl_char (unsigned int ch)\n   return 0;\n }\n \n-/* Get a character from the command window.  This is called from the\n-   readline package.  */\n+/* Main worker for tui_getc.  Get a character from the command window.\n+   This is called from the readline package, but wrapped in a\n+   try/catch by tui_getc.  */\n+\n static int\n-tui_getc (FILE *fp)\n+tui_getc_1 (FILE *fp)\n {\n   int ch;\n   WINDOW *w;\n@@ -1036,6 +1038,29 @@ tui_getc (FILE *fp)\n   return ch;\n }\n \n+/* Get a character from the command window.  This is called from the\n+   readline package.  */\n+\n+static int\n+tui_getc (FILE *fp)\n+{\n+  try\n+    {\n+      return tui_getc_1 (fp);\n+    }\n+  catch (const gdb_exception &ex)\n+    {\n+      /* Just in case, don't ever let an exception escape to readline.\n+\t This shouldn't ever happen, but if it does, print the\n+\t exception instead of just crashing GDB.  */\n+      exception_print (gdb_stderr, ex);\n+\n+      /* If we threw an exception, it's because we recognized the\n+\t character.  */\n+      return 0;\n+    }\n+}\n+\n /* See tui-io.h.  */\n \n gdb::unique_xmalloc_ptr<char>"
    }
  ]
}