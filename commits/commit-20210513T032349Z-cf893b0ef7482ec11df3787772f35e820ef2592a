{
  "sha": "cf893b0ef7482ec11df3787772f35e820ef2592a",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6Y2Y4OTNiMGVmNzQ4MmVjMTFkZjM3ODc3NzJmMzVlODIwZWYyNTkyYQ==",
  "commit": {
    "author": {
      "name": "Fangrui Song",
      "email": "maskray@google.com",
      "date": "2021-05-12T06:10:45Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-05-13T03:23:49Z"
    },
    "message": "ld: Add -Bno-symbolic\n\n\tPR 27834\n\t* ldlex.h (enum option_values): Add OPTION_NO_SYMBOLIC.\n\t* lexsup.c (ld_options): Add -Bno-symbolic.\n\t(parse_args): Handle -Bno-symbolic.\n\t* ld.texi: Document -Bno-symbolic.\n\t* NEWS: Mention -Bno-symbolic.\n\t* testsuite/ld-elf/shared.exp: Add a test.",
    "tree": {
      "sha": "77832443e8f794f951b402a1824b2151d107f999",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/77832443e8f794f951b402a1824b2151d107f999"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/cf893b0ef7482ec11df3787772f35e820ef2592a",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cf893b0ef7482ec11df3787772f35e820ef2592a",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/cf893b0ef7482ec11df3787772f35e820ef2592a",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/cf893b0ef7482ec11df3787772f35e820ef2592a/comments",
  "author": {
    "login": "MaskRay",
    "id": 416322,
    "node_id": "MDQ6VXNlcjQxNjMyMg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/416322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MaskRay",
    "html_url": "https://github.com/MaskRay",
    "followers_url": "https://api.github.com/users/MaskRay/followers",
    "following_url": "https://api.github.com/users/MaskRay/following{/other_user}",
    "gists_url": "https://api.github.com/users/MaskRay/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MaskRay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MaskRay/subscriptions",
    "organizations_url": "https://api.github.com/users/MaskRay/orgs",
    "repos_url": "https://api.github.com/users/MaskRay/repos",
    "events_url": "https://api.github.com/users/MaskRay/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MaskRay/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "4863cddb5079ce34007c5bebc0315b8eddb9ef6d",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4863cddb5079ce34007c5bebc0315b8eddb9ef6d",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/4863cddb5079ce34007c5bebc0315b8eddb9ef6d"
    }
  ],
  "stats": {
    "total": 30,
    "additions": 30,
    "deletions": 0
  },
  "files": [
    {
      "sha": "e9aae885988b39d2716a20a0f3d88993091deaa0",
      "filename": "ld/ChangeLog",
      "status": "modified",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ChangeLog?ref=cf893b0ef7482ec11df3787772f35e820ef2592a",
      "patch": "@@ -1,3 +1,13 @@\n+2021-05-13  Fangrui Song  <maskray@google.com>\n+\n+\tPR 27834\n+\t* ldlex.h (enum option_values): Add OPTION_NO_SYMBOLIC.\n+\t* lexsup.c (ld_options): Add -Bno-symbolic.\n+\t(parse_args): Handle -Bno-symbolic.\n+\t* ld.texi: Document -Bno-symbolic.\n+\t* NEWS: Mention -Bno-symbolic.\n+\t* testsuite/ld-elf/shared.exp: Add a test.\n+\n 2021-05-12  Richard Earnshaw  <rearnsha@arm.com>\n \n \t* testsuite/ld-arm/arm-elf.exp (farcall test for v8-m.mainline):"
    },
    {
      "sha": "a5ed9058c046ecd9279587dde53e8b0bf50aa221",
      "filename": "ld/NEWS",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/NEWS",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/NEWS",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/NEWS?ref=cf893b0ef7482ec11df3787772f35e820ef2592a",
      "patch": "@@ -8,6 +8,8 @@\n * Add -z start-stop-gc to disable special treatment of __start_*/__stop_*\n   references when --gc-sections.\n \n+* Add -Bno-symbolic to cancel -Bsymbolic and -Bsymbolic-functions.\n+\n Changes in 2.36:\n \n * Add libdep plugin, for linking dependencies of static libraries that"
    },
    {
      "sha": "29874688a73a427524c1fecc7f5e3898bfa0034c",
      "filename": "ld/ld.texi",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/ld.texi",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/ld.texi",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ld.texi?ref=cf893b0ef7482ec11df3787772f35e820ef2592a",
      "patch": "@@ -1633,6 +1633,11 @@ symbols to the definition within the shared library, if any.\n This option is only meaningful on ELF platforms which support shared\n libraries.\n \n+@kindex -Bno-symbolic\n+@item -Bno-symbolic\n+This option can cancel previously specified @samp{-Bsymbolic} and\n+@samp{-Bsymbolic-functions}.\n+\n @kindex --dynamic-list=@var{dynamic-list-file}\n @item --dynamic-list=@var{dynamic-list-file}\n Specify the name of a dynamic list file to the linker.  This is"
    },
    {
      "sha": "e0f0241d9cc92aca972b40cfa4d2fd37490bc729",
      "filename": "ld/ldlex.h",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/ldlex.h",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/ldlex.h",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/ldlex.h?ref=cf893b0ef7482ec11df3787772f35e820ef2592a",
      "patch": "@@ -54,6 +54,7 @@ enum option_values\n   OPTION_OFORMAT,\n   OPTION_RELAX,\n   OPTION_NO_RELAX,\n+  OPTION_NO_SYMBOLIC,\n   OPTION_RETAIN_SYMBOLS_FILE,\n   OPTION_RPATH,\n   OPTION_RPATH_LINK,"
    },
    {
      "sha": "dcb2d9d9ab39b8686ee868b79623363f984a0712",
      "filename": "ld/lexsup.c",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/lexsup.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/lexsup.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/lexsup.c?ref=cf893b0ef7482ec11df3787772f35e820ef2592a",
      "patch": "@@ -302,6 +302,8 @@ static const struct ld_option ld_options[] =\n     '\\0', NULL, NULL, ONE_DASH },\n   { {\"static\", no_argument, NULL, OPTION_NON_SHARED},\n     '\\0', NULL, NULL, ONE_DASH },\n+  { {\"Bno-symbolic\", no_argument, NULL, OPTION_NO_SYMBOLIC},\n+    '\\0', NULL, N_(\"Don't bind global references locally\"), ONE_DASH },\n   { {\"Bsymbolic\", no_argument, NULL, OPTION_SYMBOLIC},\n     '\\0', NULL, N_(\"Bind global references locally\"), ONE_DASH },\n   { {\"Bsymbolic-functions\", no_argument, NULL, OPTION_SYMBOLIC_FUNCTIONS},\n@@ -1301,6 +1303,9 @@ parse_args (unsigned argc, char **argv)\n \tcase OPTION_STATS:\n \t  config.stats = true;\n \t  break;\n+\tcase OPTION_NO_SYMBOLIC:\n+\t  opt_symbolic = symbolic_unset;\n+\t  break;\n \tcase OPTION_SYMBOLIC:\n \t  opt_symbolic = symbolic;\n \t  break;"
    },
    {
      "sha": "d00358e47ef595b9cdf6f87b2613f29fedbf3b99",
      "filename": "ld/testsuite/ld-elf/shared.exp",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/testsuite/ld-elf/shared.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/cf893b0ef7482ec11df3787772f35e820ef2592a/ld/testsuite/ld-elf/shared.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/ld/testsuite/ld-elf/shared.exp?ref=cf893b0ef7482ec11df3787772f35e820ef2592a",
      "patch": "@@ -618,6 +618,10 @@ set build_tests {\n   {\"Build libdl2k.so with --export-dynamic-symbol-list=dl2.list and -Bsymbolic\"\n    \"-shared -Wl,--export-dynamic-symbol-list=dl2.list,-Bsymbolic\" \"-fPIC\"\n    {dl2.c dl2xxx.c} {} \"libdl2k.so\"}\n+  # Check that -Bno-symbolic cancels -Bsymbolic.\n+  {\"Build libdl2l.so with -Bsymbolic -Bno-symbolic and --export-dynamic-symbol=foo\"\n+   \"-shared -Wl,-Bsymbolic,-Bno-symbolic,--export-dynamic-symbol=foo\" \"-fPIC\"\n+   {dl2.c dl2xxx.c} {} \"libdl2l.so\"}\n   {\"Build libdl4a.so with --dynamic-list=dl4.list\"\n    \"-shared -Wl,--dynamic-list=dl4.list\" \"-fPIC\"\n    {dl4.c dl4xxx.c} {} \"libdl4a.so\"}\n@@ -1028,6 +1032,9 @@ set run_tests [list \\\n     [list \"Run with libdl2k.so\" \\\n      \"-Wl,--no-as-needed tmpdir/libdl2k.so\" \"\" \\\n      {dl2main.c} \"dl2k\" \"dl2a.out\" ] \\\n+    [list \"Run with libdl2l.so\" \\\n+     \"-Wl,--no-as-needed tmpdir/libdl2l.so\" \"\" \\\n+     {dl2main.c} \"dl2l\" \"dl2b.out\" ] \\\n     [list \"Run with libdl4a.so\" \\\n      \"-Wl,--no-as-needed tmpdir/libdl4a.so\" \"\" \\\n      {dl4main.c} \"dl4a\" \"dl4a.out\" \"-fPIC\"] \\"
    }
  ]
}