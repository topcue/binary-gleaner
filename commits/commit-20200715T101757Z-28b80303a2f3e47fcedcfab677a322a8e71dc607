{
  "sha": "28b80303a2f3e47fcedcfab677a322a8e71dc607",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6MjhiODAzMDNhMmYzZTQ3ZmNlZGNmYWI2NzdhMzIyYThlNzFkYzYwNw==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-07-15T01:29:20Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-07-15T10:17:57Z"
    },
    "message": "PR26239, memory leak in _bfd_dwarf2_slurp_debug_info\n\n\tPR 26239\n\t* coffgen.c (_bfd_coff_close_and_cleanup): Free dwarf2 info.",
    "tree": {
      "sha": "468617d3fc11392e815232dd83de1f15c1fa2a1e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/468617d3fc11392e815232dd83de1f15c1fa2a1e"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/28b80303a2f3e47fcedcfab677a322a8e71dc607",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/28b80303a2f3e47fcedcfab677a322a8e71dc607",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/28b80303a2f3e47fcedcfab677a322a8e71dc607",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/28b80303a2f3e47fcedcfab677a322a8e71dc607/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "4fd8d5856435ff84de1f181381fc51754285af6f",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/4fd8d5856435ff84de1f181381fc51754285af6f",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/4fd8d5856435ff84de1f181381fc51754285af6f"
    }
  ],
  "stats": {
    "total": 19,
    "additions": 15,
    "deletions": 4
  },
  "files": [
    {
      "sha": "6532c53233cc66a65c12dd59dc318da1709824ed",
      "filename": "bfd/ChangeLog",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/28b80303a2f3e47fcedcfab677a322a8e71dc607/bfd/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/28b80303a2f3e47fcedcfab677a322a8e71dc607/bfd/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/ChangeLog?ref=28b80303a2f3e47fcedcfab677a322a8e71dc607",
      "patch": "@@ -1,3 +1,8 @@\n+2020-07-15  Alan Modra  <amodra@gmail.com>\n+\n+\tPR 26239\n+\t* coffgen.c (_bfd_coff_close_and_cleanup): Free dwarf2 info.\n+\n 2020-07-15  Nick Clifton  <nickc@redhat.com>\n \n \tPR26240"
    },
    {
      "sha": "c14e9db810be7e7b0fffba40d6e7019b8e0119e4",
      "filename": "bfd/coffgen.c",
      "status": "modified",
      "additions": 10,
      "deletions": 4,
      "changes": 14,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/28b80303a2f3e47fcedcfab677a322a8e71dc607/bfd/coffgen.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/28b80303a2f3e47fcedcfab677a322a8e71dc607/bfd/coffgen.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/bfd/coffgen.c?ref=28b80303a2f3e47fcedcfab677a322a8e71dc607",
      "patch": "@@ -3141,16 +3141,22 @@ bfd_coff_group_name (bfd *abfd, const asection *sec)\n bfd_boolean\n _bfd_coff_close_and_cleanup (bfd *abfd)\n {\n-  if (abfd->format == bfd_object\n-      && bfd_family_coff (abfd)\n-      && coff_data (abfd) != NULL)\n+  struct coff_tdata *tdata = coff_data (abfd);\n+\n+  if (tdata != NULL)\n     {\n       /* PR 25447:\n \t Do not clear the keep_syms and keep_strings flags.\n \t These may have been set by pe_ILF_build_a_bfd() indicating\n \t that the syms and strings pointers are not to be freed.  */\n-      if (!_bfd_coff_free_symbols (abfd))\n+      if (bfd_get_format (abfd) == bfd_object\n+\t  && bfd_family_coff (abfd)\n+\t  && !_bfd_coff_free_symbols (abfd))\n \treturn FALSE;\n+\n+      if (bfd_get_format (abfd) == bfd_object\n+\t  || bfd_get_format (abfd) == bfd_core)\n+\t_bfd_dwarf2_cleanup_debug_info (abfd, &tdata->dwarf2_find_line_info);\n     }\n   return _bfd_generic_close_and_cleanup (abfd);\n }"
    }
  ]
}