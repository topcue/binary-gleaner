{
  "sha": "45aec4e5ed84b69bcdedaed1024edf62bf96f138",
  "node_id": "C_kwDOANOeidoAKDQ1YWVjNGU1ZWQ4NGI2OWJjZGVkYWVkMTAyNGVkZjYyYmY5NmYxMzg",
  "commit": {
    "author": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2022-01-03T22:59:30Z"
    },
    "committer": {
      "name": "Tom de Vries",
      "email": "tdevries@suse.de",
      "date": "2022-01-03T22:59:30Z"
    },
    "message": "[gdb/cli] Improve show logging output\n\nBefore commit 3b6acaee895 \"Update more calls to add_prefix_cmd\" we had the\nfollowing output for \"show logging\":\n...\n$ gdb -q -batch -ex \"set trace-commands on\" \\\n    -ex \"set logging off\" \\\n    -ex \"show logging\" \\\n    -ex \"set logging on\" \\\n    -ex \"show logging\"\n+set logging off\n+show logging\nFuture logs will be written to gdb.txt.\nLogs will be appended to the log file.\nOutput will be logged and displayed.\nDebug output will be logged and displayed.\n+set logging on\n+show logging\nCurrently logging to \"gdb.txt\".\nLogs will be appended to the log file.\nOutput will be logged and displayed.\nDebug output will be logged and displayed.\n...\n\nAfter that commit we have instead:\n...\n+set logging off\n+show logging\ndebugredirect:  The logging output mode is off.\nfile:  The current logfile is \"gdb.txt\".\noverwrite:  Whether logging overwrites or appends to the log file is off.\nredirect:  The logging output mode is off.\n+set logging on\n+show logging\ndebugredirect:  The logging output mode is off.\nfile:  The current logfile is \"gdb.txt\".\noverwrite:  Whether logging overwrites or appends to the log file is off.\nredirect:  The logging output mode is off.\n...\nwhich gives less clear output for some subcommands.\n\nOTOH, it's explicit about whether boolean values are on or off.\n\nThe new text seems to have been chosen to match the set/show help texts:\n...\n(gdb) help show logging\nShow logging options.\n\nList of show logging subcommands:\n\nshow logging debugredirect -- Show the logging debug output mode.\nshow logging file -- Show the current logfile.\nshow logging overwrite -- \\\n  Show whether logging overwrites or appends to the log file.\nshow logging redirect -- Show the logging output mode.\n...\n\nMake the show logging messages more clear, while still keep the boolean\nvalues explicit, such that we have:\n...\n$ ./gdb.sh -q -batch -ex \"show logging\"\nlogging debugredirect:  off: \\\n  Debug output will go to both the screen and the log file.\nlogging enabled:  off: Logging is disabled.\nlogging file:  The current logfile is \"gdb.txt\".\nlogging overwrite:  off: Logging appends to the log file.\nlogging redirect:  off: Output will go to both the screen and the log file.\n...\n\nTested on x86_64-linux.",
    "tree": {
      "sha": "e5f4fe1f0fb7e5bac7b0e1b584a66077b43663d1",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/e5f4fe1f0fb7e5bac7b0e1b584a66077b43663d1"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/45aec4e5ed84b69bcdedaed1024edf62bf96f138",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/45aec4e5ed84b69bcdedaed1024edf62bf96f138",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/45aec4e5ed84b69bcdedaed1024edf62bf96f138",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/45aec4e5ed84b69bcdedaed1024edf62bf96f138/comments",
  "author": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "vries",
    "id": 4057235,
    "node_id": "MDQ6VXNlcjQwNTcyMzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vries",
    "html_url": "https://github.com/vries",
    "followers_url": "https://api.github.com/users/vries/followers",
    "following_url": "https://api.github.com/users/vries/following{/other_user}",
    "gists_url": "https://api.github.com/users/vries/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vries/subscriptions",
    "organizations_url": "https://api.github.com/users/vries/orgs",
    "repos_url": "https://api.github.com/users/vries/repos",
    "events_url": "https://api.github.com/users/vries/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vries/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "23bb7876f0d69a6f7c0356d7e557774b829a93dc",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/23bb7876f0d69a6f7c0356d7e557774b829a93dc",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/23bb7876f0d69a6f7c0356d7e557774b829a93dc"
    }
  ],
  "stats": {
    "total": 34,
    "additions": 26,
    "deletions": 8
  },
  "files": [
    {
      "sha": "193a87331db3244c209172fb663e0cbd0360bda8",
      "filename": "gdb/cli/cli-logging.c",
      "status": "modified",
      "additions": 26,
      "deletions": 8,
      "changes": 34,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/45aec4e5ed84b69bcdedaed1024edf62bf96f138/gdb/cli/cli-logging.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/45aec4e5ed84b69bcdedaed1024edf62bf96f138/gdb/cli/cli-logging.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/gdb/cli/cli-logging.c?ref=45aec4e5ed84b69bcdedaed1024edf62bf96f138",
      "patch": "@@ -56,10 +56,10 @@ static void\n show_logging_overwrite (struct ui_file *file, int from_tty,\n \t\t\tstruct cmd_list_element *c, const char *value)\n {\n-  fprintf_filtered (file,\n-\t\t    _(\"Whether logging overwrites or \"\n-\t\t      \"appends to the log file is %s.\\n\"),\n-\t\t    value);\n+  if (logging_overwrite)\n+    fprintf_filtered (file, _(\"on: Logging overwrites the log file.\\n\"));\n+  else\n+    fprintf_filtered (file, _(\"off: Logging appends to the log file.\\n\"));\n }\n \n /* Value as configured by the user.  */\n@@ -77,7 +77,25 @@ static void\n show_logging_redirect (struct ui_file *file, int from_tty,\n \t\t       struct cmd_list_element *c, const char *value)\n {\n-  fprintf_filtered (file, _(\"The logging output mode is %s.\\n\"), value);\n+  if (logging_redirect)\n+    fprintf_filtered(file, _(\"on: Output will go only to the log file.\\n\"));\n+  else\n+    fprintf_filtered\n+      (file,\n+       _(\"off: Output will go to both the screen and the log file.\\n\"));\n+}\n+\n+static void\n+show_logging_debug_redirect (struct ui_file *file, int from_tty,\n+\t\t       struct cmd_list_element *c, const char *value)\n+{\n+  if (debug_redirect)\n+    fprintf_filtered(file,\n+\t\t     _(\"on: Debug output will go only to the log file.\\n\"));\n+  else\n+    fprintf_filtered\n+      (file,\n+       _(\"off: Debug output will go to both the screen and the log file.\\n\"));\n }\n \n /* If we've pushed output files, close them and pop them.  */\n@@ -181,9 +199,9 @@ show_logging_enabled (struct ui_file *file, int from_tty,\n \t\t       struct cmd_list_element *c, const char *value)\n {\n   if (logging_enabled)\n-    fprintf_filtered (file, _(\"Logging is enabled.\\n\"));\n+    fprintf_unfiltered (_(\"on: Logging is enabled.\\n\"));\n   else\n-    fprintf_filtered (file, _(\"Logging is disabled.\\n\"));\n+    fprintf_unfiltered (_(\"off: Logging is disabled.\\n\"));\n }\n \n void _initialize_cli_logging ();\n@@ -226,7 +244,7 @@ Show the logging debug output mode.\"), _(\"\\\n If debug redirect is off, debug will go to both the screen and the log file.\\n\\\n If debug redirect is on, debug will go only to the log file.\"),\n \t\t\t   set_logging_redirect,\n-\t\t\t   show_logging_redirect,\n+\t\t\t   show_logging_debug_redirect,\n \t\t\t   &set_logging_cmdlist, &show_logging_cmdlist);\n \n   /* Set/show logging file.  */"
    }
  ]
}