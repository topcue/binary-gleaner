{
  "sha": "5a2296ac1b3c26cab589bddfded07a560e434d03",
  "node_id": "MDY6Q29tbWl0MTM4Njg2ODE6NWEyMjk2YWMxYjNjMjZjYWI1ODliZGRmZGVkMDdhNTYwZTQzNGQwMw==",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-07-07T02:00:12Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2020-07-07T08:56:33Z"
    },
    "message": "Use is_xcoff_format in binutils testsuite\n\nand restrict some other tests using is_*_format.\n\n\t* testsuite/binutils-all/ar.exp: Use is_xcoff_format.\n\t* testsuite/binutils-all/nm.exp: Likewise.\n\t* testsuite/binutils-all/copy-2.d: Run only for elf and pe targets.\n\t* testsuite/binutils-all/copy-3.d: Run only for elf targets.\n\t* testsuite/binutils-all/set-section-alignment.d: Likewise.\n\t* testsuite/binutils-all/copy-4.d: Don't run for xcoff.",
    "tree": {
      "sha": "1e4c22e5e8011bafa1df2e143e934559a151e4a7",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/1e4c22e5e8011bafa1df2e143e934559a151e4a7"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/5a2296ac1b3c26cab589bddfded07a560e434d03",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5a2296ac1b3c26cab589bddfded07a560e434d03",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/5a2296ac1b3c26cab589bddfded07a560e434d03",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/5a2296ac1b3c26cab589bddfded07a560e434d03/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "efd0ed580ed9f84ae095b592e5ae686e62eb9a3e",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/efd0ed580ed9f84ae095b592e5ae686e62eb9a3e",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/efd0ed580ed9f84ae095b592e5ae686e62eb9a3e"
    }
  ],
  "stats": {
    "total": 38,
    "additions": 26,
    "deletions": 12
  },
  "files": [
    {
      "sha": "55a75afab5f315d9e755862e69d3d00e0f635c96",
      "filename": "binutils/ChangeLog",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/ChangeLog",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/ChangeLog",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/ChangeLog?ref=5a2296ac1b3c26cab589bddfded07a560e434d03",
      "patch": "@@ -1,3 +1,12 @@\n+2020-07-07  Alan Modra  <amodra@gmail.com>\n+\n+\t* testsuite/binutils-all/ar.exp: Use is_xcoff_format.\n+\t* testsuite/binutils-all/nm.exp: Likewise.\n+\t* testsuite/binutils-all/copy-2.d: Run only for elf and pe targets.\n+\t* testsuite/binutils-all/copy-3.d: Run only for elf targets.\n+\t* testsuite/binutils-all/set-section-alignment.d: Likewise.\n+\t* testsuite/binutils-all/copy-4.d: Don't run for xcoff.\n+\n 2020-07-07  Alan Modra  <amodra@gmail.com>\n \n \t* testsuite/lib/binutils-common.exp (is_xcoff_format): New."
    },
    {
      "sha": "5a9d27c6d0b04b25be4bf3685ac62dd94335fe2f",
      "filename": "binutils/testsuite/binutils-all/ar.exp",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/ar.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/ar.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/testsuite/binutils-all/ar.exp?ref=5a2296ac1b3c26cab589bddfded07a560e434d03",
      "patch": "@@ -727,7 +727,7 @@ if { [file exists $base_dir/bfdtest1] && [file exists $base_dir/bfdtest2] } {\n     long_filenames $bfdtests\n \n     # xcoff, ecoff, and vms archive support doesn't handle thin archives\n-    if { ![istarget \"*-*-aix*\"]\n+    if { ![is_xcoff_format]\n \t && ![istarget \"*-*-*ecoff\"]\n \t && ![istarget \"*-*-vms\"] } {\n \tthin_archive $bfdtests"
    },
    {
      "sha": "8d066c53c5a7f23c53baf08016d94313e0e703f1",
      "filename": "binutils/testsuite/binutils-all/copy-2.d",
      "status": "modified",
      "additions": 3,
      "deletions": 4,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/copy-2.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/copy-2.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/testsuite/binutils-all/copy-2.d?ref=5a2296ac1b3c26cab589bddfded07a560e434d03",
      "patch": "@@ -3,10 +3,9 @@\n #objcopy: --set-section-flags foo=contents,alloc,load,code\n #name: copy with setting section flags 2\n #source: copytest.s\n-#notarget: *-*-*aout *-*-aix* h8300-*-* hppa*-*-hpux* mips-*-ultrix* mips-*-osf* mips-*-ecoff* mips-*-irix mips-*-irix[2-4] mips-*-riscos* ns32k-*-*\n-# Note - we use copytest.s and a section named \"foo\" rather\n-# than .text because for some file formats (eg PE) the .text\n-# section has a fixed set of flags and these cannot be changed.\n+# Many formats do not allow arbitrary section flags, just run for ELF and PE.\n+#target: [is_elf_format] [is_pecoff_format]\n+#xfail: h8300-*-*\n \n .*: +file format .*\n "
    },
    {
      "sha": "63e84c7163f175913536f72bcaf51b8ff75cc694",
      "filename": "binutils/testsuite/binutils-all/copy-3.d",
      "status": "modified",
      "additions": 4,
      "deletions": 3,
      "changes": 7,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/copy-3.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/copy-3.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/testsuite/binutils-all/copy-3.d?ref=5a2296ac1b3c26cab589bddfded07a560e434d03",
      "patch": "@@ -3,9 +3,10 @@\n #objcopy: --set-section-flags .text=alloc,data\n #name: copy with setting section flags 3\n #source: bintest.s\n-#notarget: *-*-*aout *-*-*coff *-*-cygwin* *-*-darwin *-*-mingw* *-*-go32 *-*-*pe hppa*-*-hpux* ns32k-*-* powerpc-*-aix* rs6000-*-* rx-*-*\n-# The .text # section in PE/COFF has a fixed set of flags and these\n-# cannot be changed.  We skip it for them.\n+# The .text section in most formats has a fixed set of flags which\n+# cannot be changed, just run for ELF.\n+#target: [is_elf_format]\n+#xfail: rx-*-*\n \n .*: +file format .*\n "
    },
    {
      "sha": "fa09182f235c5050229b82bd8b460a2f9b5de979",
      "filename": "binutils/testsuite/binutils-all/copy-4.d",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/copy-4.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/copy-4.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/testsuite/binutils-all/copy-4.d?ref=5a2296ac1b3c26cab589bddfded07a560e434d03",
      "patch": "@@ -2,7 +2,7 @@\n #source: bintest.s\n #strip: --strip-unneeded\n #nm: -n\n-#notarget: *-*-aix* *-*-linuxecoff\n+#notarget: [is_xcoff_format] *-*-linuxecoff\n #name: strip --strip-unneeded on common symbol\n \n #..."
    },
    {
      "sha": "96cb50a300ac7919d22f5cf937802d772764017e",
      "filename": "binutils/testsuite/binutils-all/nm.exp",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/nm.exp",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/nm.exp",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/testsuite/binutils-all/nm.exp?ref=5a2296ac1b3c26cab589bddfded07a560e434d03",
      "patch": "@@ -50,7 +50,9 @@ if {![binutils_assemble $srcdir/$subdir/bintest.s tmpdir/bintest.o]} then {\n \n     # This test does not work correctly on XCOFF targets, because XCOFF\n     # does not enter static symbols in the symbol table.\n-    setup_xfail \"*-*-aix*\"\n+    if [is_xcoff_format] {\n+\tsetup_xfail *-*-*\n+    }\n \n     set got [binutils_run $NM \"$NMFLAGS $tempfile\"]\n \n@@ -108,7 +110,9 @@ if {![binutils_assemble $srcdir/$subdir/bintest.s tmpdir/bintest.o]} then {\n \n     # This test does not work correctly on XCOFF targets, because XCOFF\n     # does not enter static symbols in the symbol table.\n-    setup_xfail \"*-*-aix*\"\n+    if [is_xcoff_format] {\n+\tsetup_xfail *-*-*\n+    }\n \n     set got [binutils_run $NM \"$NMFLAGS -P $tempfile\"]\n "
    },
    {
      "sha": "a193bb78973b285b1ddcf53f28de5b7f0ad94ce6",
      "filename": "binutils/testsuite/binutils-all/set-section-alignment.d",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/set-section-alignment.d",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/5a2296ac1b3c26cab589bddfded07a560e434d03/binutils/testsuite/binutils-all/set-section-alignment.d",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/testsuite/binutils-all/set-section-alignment.d?ref=5a2296ac1b3c26cab589bddfded07a560e434d03",
      "patch": "@@ -2,7 +2,8 @@\n #PROG: objcopy\n #objcopy: --set-section-alignment .text=16\n #objdump: --section-headers\n-#notarget: *-*-*aout *-*-*coff *-*-cygwin* *-*-darwin *-*-mingw* *-*-go32 *-*-*pe hppa*-*-hpux* ns32k-*-* powerpc-*-aix* rs6000-*-* rx-*-* *-*-vms\n+#target: [is_elf_format]\n+#xfail: rx-*-*\n \n #...\n .*\\.text.*2\\*\\*4"
    }
  ]
}