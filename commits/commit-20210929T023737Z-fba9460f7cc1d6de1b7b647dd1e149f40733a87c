{
  "sha": "fba9460f7cc1d6de1b7b647dd1e149f40733a87c",
  "node_id": "C_kwDOANOeidoAKGZiYTk0NjBmN2NjMWQ2ZGUxYjdiNjQ3ZGQxZTE0OWY0MDczM2E4N2M",
  "commit": {
    "author": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-09-25T01:22:05Z"
    },
    "committer": {
      "name": "Alan Modra",
      "email": "amodra@gmail.com",
      "date": "2021-09-29T02:37:37Z"
    },
    "message": "PR27202, readelf -wL doesn't work on \".loc 0\"\n\nFor DWARF revision 4 and earlier, display_debug_lines_decoded\npopulates the file_table array with entries read from .debug_line\nafter the directory table.  file_table[0] contains the first entry.\nDWARF rev 4 line number programs index this entry as file number one.\nDWARF revision 5 changes .debug_line format quite extensively, and in\nparticular gives file number zero a meaning.\n\n\tPR 27202\n\t* dwarf.c (display_debug_lines_decoded): Correct indexing used\n\tfor DWARF5 files.",
    "tree": {
      "sha": "0cde2d068f58757c0db07d81e86a439e111b1a68",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/git/trees/0cde2d068f58757c0db07d81e86a439e111b1a68"
    },
    "url": "https://api.github.com/repos/bminor/binutils-gdb/git/commits/fba9460f7cc1d6de1b7b647dd1e149f40733a87c",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fba9460f7cc1d6de1b7b647dd1e149f40733a87c",
  "html_url": "https://github.com/bminor/binutils-gdb/commit/fba9460f7cc1d6de1b7b647dd1e149f40733a87c",
  "comments_url": "https://api.github.com/repos/bminor/binutils-gdb/commits/fba9460f7cc1d6de1b7b647dd1e149f40733a87c/comments",
  "author": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "amodra",
    "id": 6006325,
    "node_id": "MDQ6VXNlcjYwMDYzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amodra",
    "html_url": "https://github.com/amodra",
    "followers_url": "https://api.github.com/users/amodra/followers",
    "following_url": "https://api.github.com/users/amodra/following{/other_user}",
    "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amodra/subscriptions",
    "organizations_url": "https://api.github.com/users/amodra/orgs",
    "repos_url": "https://api.github.com/users/amodra/repos",
    "events_url": "https://api.github.com/users/amodra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amodra/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "abe8cab7cb39e5db02d318e56595fa13677b52da",
      "url": "https://api.github.com/repos/bminor/binutils-gdb/commits/abe8cab7cb39e5db02d318e56595fa13677b52da",
      "html_url": "https://github.com/bminor/binutils-gdb/commit/abe8cab7cb39e5db02d318e56595fa13677b52da"
    }
  ],
  "stats": {
    "total": 11,
    "additions": 8,
    "deletions": 3
  },
  "files": [
    {
      "sha": "6e10281a6edc189a34b506d57b335984234a6784",
      "filename": "binutils/dwarf.c",
      "status": "modified",
      "additions": 8,
      "deletions": 3,
      "changes": 11,
      "blob_url": "https://github.com/bminor/binutils-gdb/blob/fba9460f7cc1d6de1b7b647dd1e149f40733a87c/binutils/dwarf.c",
      "raw_url": "https://github.com/bminor/binutils-gdb/raw/fba9460f7cc1d6de1b7b647dd1e149f40733a87c/binutils/dwarf.c",
      "contents_url": "https://api.github.com/repos/bminor/binutils-gdb/contents/binutils/dwarf.c?ref=fba9460f7cc1d6de1b7b647dd1e149f40733a87c",
      "patch": "@@ -5297,15 +5297,17 @@ display_debug_lines_decoded (struct dwarf_section *  section,\n \t\tstate_machine_regs.file = uladv;\n \n \t\t{\n-\t\t  unsigned file = state_machine_regs.file - 1;\n+\t\t  unsigned file = state_machine_regs.file;\n \t\t  unsigned dir;\n \n+\t\t  if (linfo.li_version < 5)\n+\t\t    --file;\n \t\t  if (file_table == NULL || n_files == 0)\n \t\t    printf (_(\"\\n [Use file table entry %d]\\n\"), file);\n \t\t  /* PR 20439 */\n \t\t  else if (file >= n_files)\n \t\t    {\n-\t\t      warn (_(\"file index %u > number of files %u\\n\"), file + 1, n_files);\n+\t\t      warn (_(\"file index %u > number of files %u\\n\"), file, n_files);\n \t\t      printf (_(\"\\n <over large file table index %u>\"), file);\n \t\t    }\n \t\t  else if ((dir = file_table[file].directory_index) == 0)\n@@ -5414,7 +5416,10 @@ display_debug_lines_decoded (struct dwarf_section *  section,\n \n \t      if (file_table)\n \t\t{\n-\t\t  unsigned indx = state_machine_regs.file - 1;\n+\t\t  unsigned indx = state_machine_regs.file;\n+\n+\t\t  if (linfo.li_version < 5)\n+\t\t    --indx;\n \t\t  /* PR 20439  */\n \t\t  if (indx >= n_files)\n \t\t    {"
    }
  ]
}